# Comparing `tmp/wwpdb.utils.nmr-0.26.tar.gz` & `tmp/wwpdb.utils.nmr-0.26.1.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "wwpdb.utils.nmr-0.26.tar", last modified: Sun Apr 30 13:17:12 2023, max compression
+gzip compressed data, was "wwpdb.utils.nmr-0.26.1.tar", last modified: Wed May 10 10:17:24 2023, max compression
```

## Comparing `wwpdb.utils.nmr-0.26.tar` & `wwpdb.utils.nmr-0.26.1.tar`

### file list

```diff
@@ -1,115 +1,115 @@
-drwxr-xr-x   0 vsts      (1001) docker     (123)        0 2023-04-30 13:17:12.456927 wwpdb.utils.nmr-0.26/
--rw-r--r--   0 vsts      (1001) docker     (123)      552 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/LICENSE
--rw-r--r--   0 vsts      (1001) docker     (123)      134 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/MANIFEST.in
--rw-r--r--   0 vsts      (1001) docker     (123)      704 2023-04-30 13:17:12.456927 wwpdb.utils.nmr-0.26/PKG-INFO
--rw-r--r--   0 vsts      (1001) docker     (123)       36 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/README.md
--rw-r--r--   0 vsts      (1001) docker     (123)      108 2023-04-30 13:17:12.456927 wwpdb.utils.nmr-0.26/setup.cfg
--rwxr-xr-x   0 vsts      (1001) docker     (123)     2814 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/setup.py
-drwxr-xr-x   0 vsts      (1001) docker     (123)        0 2023-04-30 13:17:12.428925 wwpdb.utils.nmr-0.26/wwpdb/
--rw-r--r--   0 vsts      (1001) docker     (123)       65 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/__init__.py
-drwxr-xr-x   0 vsts      (1001) docker     (123)        0 2023-04-30 13:17:12.428925 wwpdb.utils.nmr-0.26/wwpdb/utils/
--rw-r--r--   0 vsts      (1001) docker     (123)       65 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/__init__.py
-drwxr-xr-x   0 vsts      (1001) docker     (123)        0 2023-04-30 13:17:12.436926 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/
--rw-r--r--   0 vsts      (1001) docker     (123)   103259 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/AlignUtil.py
--rw-r--r--   0 vsts      (1001) docker     (123)    72301 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/BMRBChemShiftStat.py
--rw-r--r--   0 vsts      (1001) docker     (123)    11264 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/ChemCompUtil.py
--rw-r--r--   0 vsts      (1001) docker     (123)    26490 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/CifToNmrStar.py
-drwxr-xr-x   0 vsts      (1001) docker     (123)        0 2023-04-30 13:17:12.436926 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/NEFTranslator/
--rw-r--r--   0 vsts      (1001) docker     (123)   517554 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/NEFTranslator/NEFTranslator.py
--rw-r--r--   0 vsts      (1001) docker     (123)     4051 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/NEFTranslator/README.md
--rw-r--r--   0 vsts      (1001) docker     (123)        0 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/NEFTranslator/__init__.py
-drwxr-xr-x   0 vsts      (1001) docker     (123)        0 2023-04-30 13:17:12.436926 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/NEFTranslator/lib/
--rw-r--r--   0 vsts      (1001) docker     (123)    27217 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/NEFTranslator/lib/NEF_NMRSTAR_equivalence.csv
--rw-r--r--   0 vsts      (1001) docker     (123)     9863 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/NEFTranslator/lib/NEF_mandatory.csv
--rw-r--r--   0 vsts      (1001) docker     (123)    10176 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/NEFTranslator/lib/NMR-STAR_mandatory.csv
--rw-r--r--   0 vsts      (1001) docker     (123)   101944 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/NmrDpReport.py
--rw-r--r--   0 vsts      (1001) docker     (123)  2724427 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/NmrDpUtility.py
--rw-r--r--   0 vsts      (1001) docker     (123)    23027 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/NmrStarToCif.py
--rw-r--r--   0 vsts      (1001) docker     (123)   119213 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/NmrVrptUtility.py
--rw-r--r--   0 vsts      (1001) docker     (123)      150 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/__init__.py
-drwxr-xr-x   0 vsts      (1001) docker     (123)        0 2023-04-30 13:17:12.440926 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/bmrb_cs_stat/
--rwxr-xr-x   0 vsts      (1001) docker     (123)    10676 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/bmrb_cs_stat/aa_filt.csv
--rw-r--r--   0 vsts      (1001) docker     (123)    25729 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/bmrb_cs_stat/aa_filt.pkl
--rwxr-xr-x   0 vsts      (1001) docker     (123)    10656 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/bmrb_cs_stat/aa_full.csv
--rw-r--r--   0 vsts      (1001) docker     (123)    25737 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/bmrb_cs_stat/aa_full.pkl
--rwxr-xr-x   0 vsts      (1001) docker     (123)     3458 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/bmrb_cs_stat/dna_filt.csv
--rw-r--r--   0 vsts      (1001) docker     (123)     8739 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/bmrb_cs_stat/dna_filt.pkl
--rwxr-xr-x   0 vsts      (1001) docker     (123)     3495 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/bmrb_cs_stat/dna_full.csv
--rw-r--r--   0 vsts      (1001) docker     (123)     8742 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/bmrb_cs_stat/dna_full.pkl
--rwxr-xr-x   0 vsts      (1001) docker     (123)   170036 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/bmrb_cs_stat/others.csv
--rwxr-xr-x   0 vsts      (1001) docker     (123)     3573 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/bmrb_cs_stat/rna_filt.csv
--rw-r--r--   0 vsts      (1001) docker     (123)     8327 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/bmrb_cs_stat/rna_filt.pkl
--rwxr-xr-x   0 vsts      (1001) docker     (123)     3591 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/bmrb_cs_stat/rna_full.csv
--rw-r--r--   0 vsts      (1001) docker     (123)     8409 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/bmrb_cs_stat/rna_full.pkl
-drwxr-xr-x   0 vsts      (1001) docker     (123)        0 2023-04-30 13:17:12.440926 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/io/
--rw-r--r--   0 vsts      (1001) docker     (123)    12765 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/io/ChemCompIo.py
--rw-r--r--   0 vsts      (1001) docker     (123)    66525 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/io/CifReader.py
--rw-r--r--   0 vsts      (1001) docker     (123)        0 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/io/__init__.py
--rw-r--r--   0 vsts      (1001) docker     (123)    10214 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/io/mmCIFUtil.py
-drwxr-xr-x   0 vsts      (1001) docker     (123)        0 2023-04-30 13:17:12.456927 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/
--rw-r--r--   0 vsts      (1001) docker     (123)    79462 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/AmberMRLexer.py
--rw-r--r--   0 vsts      (1001) docker     (123)   233957 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/AmberMRParser.py
--rw-r--r--   0 vsts      (1001) docker     (123)   475516 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/AmberMRParserListener.py
--rw-r--r--   0 vsts      (1001) docker     (123)    20119 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/AmberMRReader.py
--rw-r--r--   0 vsts      (1001) docker     (123)    42777 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/AmberPTLexer.py
--rw-r--r--   0 vsts      (1001) docker     (123)   178190 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/AmberPTParser.py
--rw-r--r--   0 vsts      (1001) docker     (123)    79367 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/AmberPTParserListener.py
--rw-r--r--   0 vsts      (1001) docker     (123)     8445 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/AmberPTReader.py
--rw-r--r--   0 vsts      (1001) docker     (123)    11409 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/BiosymMRLexer.py
--rw-r--r--   0 vsts      (1001) docker     (123)    41669 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/BiosymMRParser.py
--rw-r--r--   0 vsts      (1001) docker     (123)   116082 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/BiosymMRParserListener.py
--rw-r--r--   0 vsts      (1001) docker     (123)     9557 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/BiosymMRReader.py
--rw-r--r--   0 vsts      (1001) docker     (123)    84136 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/CharmmMRLexer.py
--rw-r--r--   0 vsts      (1001) docker     (123)   212679 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/CharmmMRParser.py
--rw-r--r--   0 vsts      (1001) docker     (123)   275372 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/CharmmMRParserListener.py
--rw-r--r--   0 vsts      (1001) docker     (123)     8997 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/CharmmMRReader.py
--rw-r--r--   0 vsts      (1001) docker     (123)   151068 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/CnsMRLexer.py
--rw-r--r--   0 vsts      (1001) docker     (123)   417159 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/CnsMRParser.py
--rw-r--r--   0 vsts      (1001) docker     (123)   444201 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/CnsMRParserListener.py
--rw-r--r--   0 vsts      (1001) docker     (123)    13343 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/CnsMRReader.py
--rw-r--r--   0 vsts      (1001) docker     (123)    32899 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/CyanaMRLexer.py
--rw-r--r--   0 vsts      (1001) docker     (123)   166923 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/CyanaMRParser.py
--rw-r--r--   0 vsts      (1001) docker     (123)   429357 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/CyanaMRParserListener.py
--rw-r--r--   0 vsts      (1001) docker     (123)    18190 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/CyanaMRReader.py
--rw-r--r--   0 vsts      (1001) docker     (123)    50972 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/DynamoMRLexer.py
--rw-r--r--   0 vsts      (1001) docker     (123)   219341 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/DynamoMRParser.py
--rw-r--r--   0 vsts      (1001) docker     (123)   214243 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/DynamoMRParserListener.py
--rw-r--r--   0 vsts      (1001) docker     (123)     9605 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/DynamoMRReader.py
--rw-r--r--   0 vsts      (1001) docker     (123)    15500 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/GromacsMRLexer.py
--rw-r--r--   0 vsts      (1001) docker     (123)    43150 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/GromacsMRParser.py
--rw-r--r--   0 vsts      (1001) docker     (123)    77212 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/GromacsMRParserListener.py
--rw-r--r--   0 vsts      (1001) docker     (123)    10396 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/GromacsMRReader.py
--rw-r--r--   0 vsts      (1001) docker     (123)    27535 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/GromacsPTLexer.py
--rw-r--r--   0 vsts      (1001) docker     (123)   159229 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/GromacsPTParser.py
--rw-r--r--   0 vsts      (1001) docker     (123)    71351 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/GromacsPTParserListener.py
--rw-r--r--   0 vsts      (1001) docker     (123)     8270 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/GromacsPTReader.py
--rw-r--r--   0 vsts      (1001) docker     (123)    10640 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/IsdMRLexer.py
--rw-r--r--   0 vsts      (1001) docker     (123)     7446 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/IsdMRParser.py
--rw-r--r--   0 vsts      (1001) docker     (123)    75339 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/IsdMRParserListener.py
--rw-r--r--   0 vsts      (1001) docker     (123)     8786 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/IsdMRReader.py
--rw-r--r--   0 vsts      (1001) docker     (123)     3593 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/LexerErrorListener.py
--rw-r--r--   0 vsts      (1001) docker     (123)     4792 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/ParserErrorListener.py
--rw-r--r--   0 vsts      (1001) docker     (123)   389455 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/ParserListenerUtil.py
--rw-r--r--   0 vsts      (1001) docker     (123)    33530 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/RosettaMRLexer.py
--rw-r--r--   0 vsts      (1001) docker     (123)   119332 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/RosettaMRParser.py
--rw-r--r--   0 vsts      (1001) docker     (123)   198779 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/RosettaMRParserListener.py
--rw-r--r--   0 vsts      (1001) docker     (123)    10217 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/RosettaMRReader.py
--rw-r--r--   0 vsts      (1001) docker     (123)    11350 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/SybylMRLexer.py
--rw-r--r--   0 vsts      (1001) docker     (123)    10246 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/SybylMRParser.py
--rw-r--r--   0 vsts      (1001) docker     (123)    76352 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/SybylMRParserListener.py
--rw-r--r--   0 vsts      (1001) docker     (123)     9083 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/SybylMRReader.py
--rw-r--r--   0 vsts      (1001) docker     (123)   165077 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/XplorMRLexer.py
--rw-r--r--   0 vsts      (1001) docker     (123)   679237 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/XplorMRParser.py
--rw-r--r--   0 vsts      (1001) docker     (123)   655228 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/XplorMRParserListener.py
--rw-r--r--   0 vsts      (1001) docker     (123)    20087 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/XplorMRReader.py
--rw-r--r--   0 vsts      (1001) docker     (123)        0 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/__init__.py
-drwxr-xr-x   0 vsts      (1001) docker     (123)        0 2023-04-30 13:17:12.456927 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/rci/
--rw-r--r--   0 vsts      (1001) docker     (123)   361662 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/rci/RCI.py
--rw-r--r--   0 vsts      (1001) docker     (123)        0 2023-04-30 13:13:20.000000 wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/rci/__init__.py
-drwxr-xr-x   0 vsts      (1001) docker     (123)        0 2023-04-30 13:17:12.428925 wwpdb.utils.nmr-0.26/wwpdb.utils.nmr.egg-info/
--rw-r--r--   0 vsts      (1001) docker     (123)      704 2023-04-30 13:17:12.000000 wwpdb.utils.nmr-0.26/wwpdb.utils.nmr.egg-info/PKG-INFO
--rw-r--r--   0 vsts      (1001) docker     (123)     3774 2023-04-30 13:17:12.000000 wwpdb.utils.nmr-0.26/wwpdb.utils.nmr.egg-info/SOURCES.txt
--rw-r--r--   0 vsts      (1001) docker     (123)        1 2023-04-30 13:17:12.000000 wwpdb.utils.nmr-0.26/wwpdb.utils.nmr.egg-info/dependency_links.txt
--rw-r--r--   0 vsts      (1001) docker     (123)        1 2023-04-30 13:14:25.000000 wwpdb.utils.nmr-0.26/wwpdb.utils.nmr.egg-info/not-zip-safe
--rw-r--r--   0 vsts      (1001) docker     (123)      330 2023-04-30 13:17:12.000000 wwpdb.utils.nmr-0.26/wwpdb.utils.nmr.egg-info/requires.txt
--rw-r--r--   0 vsts      (1001) docker     (123)        6 2023-04-30 13:17:12.000000 wwpdb.utils.nmr-0.26/wwpdb.utils.nmr.egg-info/top_level.txt
+drwxr-xr-x   0 vsts      (1001) docker     (123)        0 2023-05-10 10:17:24.982009 wwpdb.utils.nmr-0.26.1/
+-rw-r--r--   0 vsts      (1001) docker     (123)      552 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/LICENSE
+-rw-r--r--   0 vsts      (1001) docker     (123)      134 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/MANIFEST.in
+-rw-r--r--   0 vsts      (1001) docker     (123)      706 2023-05-10 10:17:24.982009 wwpdb.utils.nmr-0.26.1/PKG-INFO
+-rw-r--r--   0 vsts      (1001) docker     (123)       36 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/README.md
+-rw-r--r--   0 vsts      (1001) docker     (123)      108 2023-05-10 10:17:24.982009 wwpdb.utils.nmr-0.26.1/setup.cfg
+-rwxr-xr-x   0 vsts      (1001) docker     (123)     2814 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/setup.py
+drwxr-xr-x   0 vsts      (1001) docker     (123)        0 2023-05-10 10:17:24.954009 wwpdb.utils.nmr-0.26.1/wwpdb/
+-rw-r--r--   0 vsts      (1001) docker     (123)       65 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/__init__.py
+drwxr-xr-x   0 vsts      (1001) docker     (123)        0 2023-05-10 10:17:24.958009 wwpdb.utils.nmr-0.26.1/wwpdb/utils/
+-rw-r--r--   0 vsts      (1001) docker     (123)       65 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/__init__.py
+drwxr-xr-x   0 vsts      (1001) docker     (123)        0 2023-05-10 10:17:24.962009 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/
+-rw-r--r--   0 vsts      (1001) docker     (123)   103238 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/AlignUtil.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    72301 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/BMRBChemShiftStat.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    11264 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/ChemCompUtil.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    26490 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/CifToNmrStar.py
+drwxr-xr-x   0 vsts      (1001) docker     (123)        0 2023-05-10 10:17:24.962009 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/NEFTranslator/
+-rw-r--r--   0 vsts      (1001) docker     (123)   517554 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/NEFTranslator/NEFTranslator.py
+-rw-r--r--   0 vsts      (1001) docker     (123)     4051 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/NEFTranslator/README.md
+-rw-r--r--   0 vsts      (1001) docker     (123)        0 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/NEFTranslator/__init__.py
+drwxr-xr-x   0 vsts      (1001) docker     (123)        0 2023-05-10 10:17:24.966009 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/NEFTranslator/lib/
+-rw-r--r--   0 vsts      (1001) docker     (123)    27217 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/NEFTranslator/lib/NEF_NMRSTAR_equivalence.csv
+-rw-r--r--   0 vsts      (1001) docker     (123)     9863 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/NEFTranslator/lib/NEF_mandatory.csv
+-rw-r--r--   0 vsts      (1001) docker     (123)    10176 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/NEFTranslator/lib/NMR-STAR_mandatory.csv
+-rw-r--r--   0 vsts      (1001) docker     (123)   102902 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/NmrDpReport.py
+-rw-r--r--   0 vsts      (1001) docker     (123)  2723472 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/NmrDpUtility.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    23027 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/NmrStarToCif.py
+-rw-r--r--   0 vsts      (1001) docker     (123)   123218 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/NmrVrptUtility.py
+-rw-r--r--   0 vsts      (1001) docker     (123)      152 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/__init__.py
+drwxr-xr-x   0 vsts      (1001) docker     (123)        0 2023-05-10 10:17:24.966009 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/bmrb_cs_stat/
+-rwxr-xr-x   0 vsts      (1001) docker     (123)    10676 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/bmrb_cs_stat/aa_filt.csv
+-rw-r--r--   0 vsts      (1001) docker     (123)    25729 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/bmrb_cs_stat/aa_filt.pkl
+-rwxr-xr-x   0 vsts      (1001) docker     (123)    10656 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/bmrb_cs_stat/aa_full.csv
+-rw-r--r--   0 vsts      (1001) docker     (123)    25737 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/bmrb_cs_stat/aa_full.pkl
+-rwxr-xr-x   0 vsts      (1001) docker     (123)     3458 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/bmrb_cs_stat/dna_filt.csv
+-rw-r--r--   0 vsts      (1001) docker     (123)     8739 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/bmrb_cs_stat/dna_filt.pkl
+-rwxr-xr-x   0 vsts      (1001) docker     (123)     3495 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/bmrb_cs_stat/dna_full.csv
+-rw-r--r--   0 vsts      (1001) docker     (123)     8742 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/bmrb_cs_stat/dna_full.pkl
+-rwxr-xr-x   0 vsts      (1001) docker     (123)   170036 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/bmrb_cs_stat/others.csv
+-rwxr-xr-x   0 vsts      (1001) docker     (123)     3573 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/bmrb_cs_stat/rna_filt.csv
+-rw-r--r--   0 vsts      (1001) docker     (123)     8327 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/bmrb_cs_stat/rna_filt.pkl
+-rwxr-xr-x   0 vsts      (1001) docker     (123)     3591 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/bmrb_cs_stat/rna_full.csv
+-rw-r--r--   0 vsts      (1001) docker     (123)     8409 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/bmrb_cs_stat/rna_full.pkl
+drwxr-xr-x   0 vsts      (1001) docker     (123)        0 2023-05-10 10:17:24.966009 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/io/
+-rw-r--r--   0 vsts      (1001) docker     (123)    12765 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/io/ChemCompIo.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    66525 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/io/CifReader.py
+-rw-r--r--   0 vsts      (1001) docker     (123)        0 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/io/__init__.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    10198 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/io/mmCIFUtil.py
+drwxr-xr-x   0 vsts      (1001) docker     (123)        0 2023-05-10 10:17:24.982009 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/
+-rw-r--r--   0 vsts      (1001) docker     (123)    79462 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/AmberMRLexer.py
+-rw-r--r--   0 vsts      (1001) docker     (123)   233957 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/AmberMRParser.py
+-rw-r--r--   0 vsts      (1001) docker     (123)   475822 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/AmberMRParserListener.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    20357 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/AmberMRReader.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    42777 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/AmberPTLexer.py
+-rw-r--r--   0 vsts      (1001) docker     (123)   178190 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/AmberPTParser.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    79367 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/AmberPTParserListener.py
+-rw-r--r--   0 vsts      (1001) docker     (123)     8445 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/AmberPTReader.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    11409 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/BiosymMRLexer.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    41669 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/BiosymMRParser.py
+-rw-r--r--   0 vsts      (1001) docker     (123)   116082 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/BiosymMRParserListener.py
+-rw-r--r--   0 vsts      (1001) docker     (123)     9557 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/BiosymMRReader.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    84136 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/CharmmMRLexer.py
+-rw-r--r--   0 vsts      (1001) docker     (123)   212679 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/CharmmMRParser.py
+-rw-r--r--   0 vsts      (1001) docker     (123)   275788 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/CharmmMRParserListener.py
+-rw-r--r--   0 vsts      (1001) docker     (123)     8997 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/CharmmMRReader.py
+-rw-r--r--   0 vsts      (1001) docker     (123)   151068 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/CnsMRLexer.py
+-rw-r--r--   0 vsts      (1001) docker     (123)   417159 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/CnsMRParser.py
+-rw-r--r--   0 vsts      (1001) docker     (123)   444617 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/CnsMRParserListener.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    13343 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/CnsMRReader.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    32899 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/CyanaMRLexer.py
+-rw-r--r--   0 vsts      (1001) docker     (123)   166923 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/CyanaMRParser.py
+-rw-r--r--   0 vsts      (1001) docker     (123)   429357 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/CyanaMRParserListener.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    18190 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/CyanaMRReader.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    50972 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/DynamoMRLexer.py
+-rw-r--r--   0 vsts      (1001) docker     (123)   219341 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/DynamoMRParser.py
+-rw-r--r--   0 vsts      (1001) docker     (123)   214575 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/DynamoMRParserListener.py
+-rw-r--r--   0 vsts      (1001) docker     (123)     9605 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/DynamoMRReader.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    15500 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/GromacsMRLexer.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    43150 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/GromacsMRParser.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    76657 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/GromacsMRParserListener.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    10396 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/GromacsMRReader.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    27535 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/GromacsPTLexer.py
+-rw-r--r--   0 vsts      (1001) docker     (123)   159229 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/GromacsPTParser.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    71351 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/GromacsPTParserListener.py
+-rw-r--r--   0 vsts      (1001) docker     (123)     8270 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/GromacsPTReader.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    10640 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/IsdMRLexer.py
+-rw-r--r--   0 vsts      (1001) docker     (123)     7446 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/IsdMRParser.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    75339 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/IsdMRParserListener.py
+-rw-r--r--   0 vsts      (1001) docker     (123)     8786 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/IsdMRReader.py
+-rw-r--r--   0 vsts      (1001) docker     (123)     3593 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/LexerErrorListener.py
+-rw-r--r--   0 vsts      (1001) docker     (123)     4792 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/ParserErrorListener.py
+-rw-r--r--   0 vsts      (1001) docker     (123)   390602 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/ParserListenerUtil.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    33530 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/RosettaMRLexer.py
+-rw-r--r--   0 vsts      (1001) docker     (123)   119332 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/RosettaMRParser.py
+-rw-r--r--   0 vsts      (1001) docker     (123)   198039 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/RosettaMRParserListener.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    10217 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/RosettaMRReader.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    11350 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/SybylMRLexer.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    10246 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/SybylMRParser.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    76352 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/SybylMRParserListener.py
+-rw-r--r--   0 vsts      (1001) docker     (123)     9083 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/SybylMRReader.py
+-rw-r--r--   0 vsts      (1001) docker     (123)   165077 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/XplorMRLexer.py
+-rw-r--r--   0 vsts      (1001) docker     (123)   679237 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/XplorMRParser.py
+-rw-r--r--   0 vsts      (1001) docker     (123)   655852 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/XplorMRParserListener.py
+-rw-r--r--   0 vsts      (1001) docker     (123)    20087 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/XplorMRReader.py
+-rw-r--r--   0 vsts      (1001) docker     (123)        0 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/__init__.py
+drwxr-xr-x   0 vsts      (1001) docker     (123)        0 2023-05-10 10:17:24.982009 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/rci/
+-rw-r--r--   0 vsts      (1001) docker     (123)   361662 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/rci/RCI.py
+-rw-r--r--   0 vsts      (1001) docker     (123)        0 2023-05-10 10:14:05.000000 wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/rci/__init__.py
+drwxr-xr-x   0 vsts      (1001) docker     (123)        0 2023-05-10 10:17:24.958009 wwpdb.utils.nmr-0.26.1/wwpdb.utils.nmr.egg-info/
+-rw-r--r--   0 vsts      (1001) docker     (123)      706 2023-05-10 10:17:24.000000 wwpdb.utils.nmr-0.26.1/wwpdb.utils.nmr.egg-info/PKG-INFO
+-rw-r--r--   0 vsts      (1001) docker     (123)     3774 2023-05-10 10:17:24.000000 wwpdb.utils.nmr-0.26.1/wwpdb.utils.nmr.egg-info/SOURCES.txt
+-rw-r--r--   0 vsts      (1001) docker     (123)        1 2023-05-10 10:17:24.000000 wwpdb.utils.nmr-0.26.1/wwpdb.utils.nmr.egg-info/dependency_links.txt
+-rw-r--r--   0 vsts      (1001) docker     (123)        1 2023-05-10 10:15:02.000000 wwpdb.utils.nmr-0.26.1/wwpdb.utils.nmr.egg-info/not-zip-safe
+-rw-r--r--   0 vsts      (1001) docker     (123)      330 2023-05-10 10:17:24.000000 wwpdb.utils.nmr-0.26.1/wwpdb.utils.nmr.egg-info/requires.txt
+-rw-r--r--   0 vsts      (1001) docker     (123)        6 2023-05-10 10:17:24.000000 wwpdb.utils.nmr-0.26.1/wwpdb.utils.nmr.egg-info/top_level.txt
```

### Comparing `wwpdb.utils.nmr-0.26/LICENSE` & `wwpdb.utils.nmr-0.26.1/LICENSE`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/PKG-INFO` & `wwpdb.utils.nmr-0.26.1/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: wwpdb.utils.nmr
-Version: 0.26
+Version: 0.26.1
 Summary: wwPDB NMR utilities
 Home-page: https://github.com/wwpdb/py-wwpdb_utils_nmr
 Author: Ezra Peisach
 Author-email: ezra.peisach@rcsb.org
 License: Apache 2.0
 Classifier: Development Status :: 3 - Alpha
 Classifier: Intended Audience :: Developers
```

### Comparing `wwpdb.utils.nmr-0.26/setup.py` & `wwpdb.utils.nmr-0.26.1/setup.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/AlignUtil.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/AlignUtil.py`

 * *Files 0% similar despite different names*

```diff
@@ -517,15 +517,15 @@
 
     for atomSelection in atomSelectionSet:
         if len(atomSelection) == 0:
             continue
         for atom in atomSelection:
             chainId = atom['chain_id']
             seqId = atom['seq_id']
-            compId = atom['comp_id'] if 'comp_id' in atom else '.'
+            compId = atom.get('comp_id', '.')
 
             updatePolySeqRst(polySeqRst, chainId, seqId, compId)
 
 
 def sortPolySeqRst(polySeqRst, nonPolyRemap=None):
     """ Sort polymer sequence of the current MR file by sequence number.
     """
```

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/BMRBChemShiftStat.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/BMRBChemShiftStat.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/ChemCompUtil.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/ChemCompUtil.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/CifToNmrStar.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/CifToNmrStar.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/NEFTranslator/NEFTranslator.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/NEFTranslator/NEFTranslator.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/NEFTranslator/README.md` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/NEFTranslator/README.md`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/NEFTranslator/lib/NEF_NMRSTAR_equivalence.csv` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/NEFTranslator/lib/NEF_NMRSTAR_equivalence.csv`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/NEFTranslator/lib/NEF_mandatory.csv` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/NEFTranslator/lib/NEF_mandatory.csv`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/NEFTranslator/lib/NMR-STAR_mandatory.csv` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/NEFTranslator/lib/NMR-STAR_mandatory.csv`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/NmrDpReport.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/NmrDpReport.py`

 * *Files 1% similar despite different names*

```diff
@@ -1300,14 +1300,50 @@
             rmsd = [s[rmsd_label] for s in poly_seq if s['auth_seq_id'] >= cif_beg_seq_id and s['auth_seq_id'] <= cif_end_seq_id and s[rmsd_label] is not None]
 
         if len(rmsd) == 0:
             return None
 
         return sum(rmsd) / len(rmsd)
 
+    def getNumberOfSubmittedConformers(self):
+        """ Return number of submitted conformers for the ensemble.
+        """
+
+        cif_polymer_sequence = self.getPolymerSequenceByInputSrcId(self.getInputSourceIdOfCoord())
+
+        if cif_polymer_sequence is None:
+            return None
+
+        total_models = []
+
+        for poly_seq in cif_polymer_sequence:
+
+            if poly_seq is None or 'type' not in poly_seq:
+                continue
+
+            stype = poly_seq['type']
+
+            if 'polypeptide' in stype:
+                rmsd_label = 'ca_rmsd'
+            elif 'ribonucleotide' in stype:
+                rmsd_label = 'p_rmsd'
+            else:
+                continue
+
+            if rmsd_label not in poly_seq:
+                continue
+
+            for rmsd in poly_seq[rmsd_label]:
+                total_models.append(rmsd['model_id'])
+
+        if len(total_models) == 0:
+            return None
+
+        return max(total_models)
+
     def getLabelSeqSchemeOf(self, auth_asym_id, auth_seq_id):
         """ Convert author sequence scheme to label sequence scheme of the coordinates.
         """
 
         src_id = self.getInputSourceIdOfCoord()
 
         if src_id == -1:
```

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/NmrDpUtility.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/NmrDpUtility.py`

 * *Files 1% similar despite different names*

```diff
@@ -413,14 +413,15 @@
 ANGLE_UNCERT_MAX = ANGLE_UNCERTAINTY_RANGE['max_inclusive']
 
 RDC_UNCERT_MAX = RDC_UNCERTAINTY_RANGE['max_inclusive']
 
 bmrb_nmr_star_file_name_pattern = re.compile(r'^bmr\d[0-9]{1,5}_3.str$')
 mr_file_name_pattern = re.compile(r'^([Pp][Dd][Bb]_)?([0-9]{4})?[0-9][0-9A-Za-z]{3}.mr$')
 pdb_id_pattern = re.compile(r'^([Pp][Dd][Bb]_)?([0-9]{4})?[0-9][0-9A-Za-z]{3}$')
+dep_id_pattern = re.compile(r'^D_[0-9]{6,10}$')
 
 datablock_pattern = re.compile(r'\s*data_(\S+)\s*')
 sf_anonymous_pattern = re.compile(r'\s*save_\S+\s*')
 save_pattern = re.compile(r'\s*save_\s*')
 loop_pattern = re.compile(r'\s*loop_\s*')
 stop_pattern = re.compile(r'\s*stop_\s*')
 cif_stop_pattern = re.compile(r'#\s*')
@@ -9127,15 +9128,15 @@
         if self.__combined_mode and file_list_id == 0 and file_type == 'nmr-star'\
            and 'constraint_statistics' in self.__sf_category_list\
            and '_Constraint_file' in self.__lp_category_list:
             _sf_data = self.__star_data[file_list_id].get_saveframes_by_category('constraint_statistics')[0]
             data_file_name = get_first_sf_tag(_sf_data, 'Data_file_name')
             if mr_file_name_pattern.match(data_file_name):
                 entry_id = get_first_sf_tag(_sf_data, 'Entry_ID')
-                if pdb_id_pattern.match(entry_id):
+                if pdb_id_pattern.match(entry_id) or dep_id_pattern.match(entry_id):
                     self.__remediation_mode = True
 
         is_valid, messages, corrections = self.__nefT.resolve_sf_names_for_cif(self.__star_data[file_list_id])  # DAOTHER-7389, issue #4
         self.__sf_name_corr.append(corrections)
 
         if not is_valid:
 
@@ -11277,15 +11278,15 @@
             pass
         else:
             return False
 
         err_message = err_desc['message']
         err_line_number = err_desc['line_number']
         err_column_position = err_desc['column_position']
-        err_input = err_desc['input'] if 'input' in err_desc else ''
+        err_input = err_desc.get('input', '')
 
         xplor_file_type = file_type in ('nm-res-xpl', 'nm-res-cns')
         amber_file_type = file_type == 'nm-res-amb'
         gromacs_file_type = file_type in ('nm-res-gro', 'nm-aux-gro')
         linear_mr_file_types = ['nm-res-cya', 'nm-res-ros', 'nm-res-bio', 'nm-res-syb']
 
         xplor_missing_end = xplor_file_type and err_message.startswith(xplor_missing_end_err_msg)
@@ -12195,15 +12196,15 @@
 
         if reader is None:
             return False
 
         err_message = err_desc['message']
         err_line_number = err_desc['line_number']
         err_column_position = err_desc['column_position']
-        err_input = err_desc['input'] if 'input' in err_desc else ''
+        err_input = err_desc.get('input', '')
 
         xplor_file_type = file_type in ('nm-res-xpl', 'nm-res-cns')
         amber_file_type = file_type = 'nm-res-amb'
         gromacs_file_type = file_type in ('nm-res-gro', 'nm-aux-gro')
 
         xplor_ends_wo_statement = xplor_file_type and (bool(xplor_extra_end_err_msg_pattern.match(err_message))
                                                        or (err_message.startswith(no_viable_alt_err_msg)
@@ -12592,15 +12593,15 @@
             pass
         else:
             return False
 
         err_message = err_desc['message']
         err_line_number = err_desc['line_number']
         err_column_position = err_desc['column_position']
-        err_input = err_desc['input'] if 'input' in err_desc else ''
+        err_input = err_desc.get('input', '')
 
         if err_column_position == 0 or len(err_input) == 0:
 
             if self.__mr_debug:
                 self.__lfh.write('DO-DIV-MR-EXIT #1\n')
 
             return False
@@ -24739,15 +24740,17 @@
                                         if content_subtype == 'dist_restraint':
                                             subtype_name = "distance restraint"
                                         elif content_subtype == 'dihed_restraint':
                                             subtype_name = "dihedral angle restraint"
                                         else:
                                             subtype_name = "RDC restraint"
 
-                                        if _atom_id_ in self.__csStat.getMethylAtoms(comp_id) and not self.__remediation_mode:
+                                        if _atom_id_ in self.__csStat.getMethylAtoms(comp_id)\
+                                           and content_subtype == 'dist_restraint'\
+                                           and not self.__remediation_mode:
 
                                             cs_atom_id_map = {'chain_id': chain_id, 'seq_id': seq_id, 'comp_id': comp_id,
                                                               'src_atom_id': gem_atom_id_w_cs, 'dst_atom_id': atom_id,
                                                               'content_subtype_name': subtype_name + 's'}
 
                                             if cs_atom_id_map not in missing_cs_atoms:
                                                 missing_cs_atoms.append(cs_atom_id_map)
@@ -27699,15 +27702,21 @@
 
                 sf_item['loop'] = lp
 
             if content_subtype == 'dist_restraint':
 
                 # MR parser for XPLOR-NIH/CNS/CHARMM already fills _Gen_dist_constraint.ID with genuine IDs
                 if sf_item['file_type'] not in ('nm-res-xpl', 'nm-res-cns', 'nm-res-cha'):
-                    self.__updateGenDistConstIdInMrStr(sf_item)
+                    if not self.__updateGenDistConstIdInMrStr(sf_item):
+                        err = 'Atoms in distance restraints can not be properly identified. Please re-upload the NMR-STAR file.'
+                        self.report.error.appendDescription('missing_mandatory_content',
+                                                            {'file_name': original_file_name,
+                                                             'sf_framecode': sf_framecode,
+                                                             'category': lp_category,
+                                                             'description': err})
 
                 sf_item['constraint_type'] = 'distance'
                 sf_item['constraint_subsubtype'] = 'simple'
                 constraint_type = get_first_sf_tag(sf, 'Constraint_type')
                 if len(constraint_type) > 0 and constraint_type not in emptyValue:
                     sf_item['constraint_subtype'] = constraint_type
 
@@ -28321,15 +28330,15 @@
                 _atom1 = _atom2 = {}
 
             _row[id_col] = sf_item['id']
             _row[member_id_col] = None
             lp.add_data(_row)
 
         if not modified and not has_member_id:
-            return
+            return True
 
         member_id_dict = {}
 
         def update_member_id_dict(rows):
             if len(rows) < 2:
                 return
 
@@ -28392,18 +28401,25 @@
         if len(member_id_dict) > 0:
             for row in lp:
                 index_id = row[index_id_col]
 
                 if index_id in member_id_dict:
                     row[member_id_col] = member_id_dict[index_id]
 
-        del sf_item['saveframe'][loop]
+        try:
+
+            del sf_item['saveframe'][loop]
 
-        sf_item['saveframe'].add_loop(lp)
-        sf_item['loop'] = lp
+            sf_item['saveframe'].add_loop(lp)
+            sf_item['loop'] = lp
+
+            return True
+
+        except ValueError:
+            return False
 
     def __mergeStrPk(self):
         """ Merge spectral peak lists in NMR-STAR restraint files.
         """
 
         if self.__combined_mode:
             return True
@@ -33378,28 +33394,28 @@
                                                   'struct_conf_1': self.__extractCoordStructConf(s['chain_id'], s['seq_id']),
                                                   'struct_conf_2': self.__extractCoordStructConf(t['chain_id'], t['seq_id'])})
 
             _rest_id = -1
             _atom1 = _atom2 = None
 
             for idx, row in enumerate(lp_data):
-                index = row[index_tag] if index_tag in row else None
-                combination_id = row[combination_id_name] if combination_id_name in row else None
-                member_id = row[member_id_name] if file_type == 'nmr-star' and member_id_name in row else None
-                member_logic_code = row[member_logic_code_name] if file_type == 'nmr-star' and member_logic_code_name in row else None
+                index = row.get(index_tag)
+                combination_id = row.get(combination_id_name)
+                member_id = row.get(member_id_name) if file_type == 'nmr-star' else None
+                member_logic_code = row.get(member_logic_code_name) if file_type == 'nmr-star' else None
 
                 chain_id_1 = row[chain_id_1_name]
                 chain_id_2 = row[chain_id_2_name]
                 seq_id_1 = row[seq_id_1_name]
                 seq_id_2 = row[seq_id_2_name]
                 comp_id_1 = row[comp_id_1_name]
                 comp_id_2 = row[comp_id_2_name]
                 atom_id_1 = row[atom_id_1_name]
                 atom_id_2 = row[atom_id_2_name]
-                weight = row[weight_name] if weight_name in row else None
+                weight = row.get(weight_name)
 
                 rest_id = row[id_tag]
                 set_id.add(id)
 
                 if (member_logic_code is not None and member_logic_code == 'OR') or rest_id == _rest_id:
                     atom1 = {'chain_id': chain_id_1,
                              'seq_id': int(seq_id_1) if seq_id_1 not in emptyValue else None,
@@ -33413,15 +33429,15 @@
                         if not isAmbigAtomSelection([_atom1, atom1], self.__csStat) and not isAmbigAtomSelection([_atom2, atom2], self.__csStat):
                             _rest_id, _atom1, _atom2 = rest_id, atom1, atom2
                             continue
                     _atom1, _atom2 = atom1, atom2
 
                 _rest_id = rest_id
 
-                target_value = row[target_value_name] if target_value_name in row else None
+                target_value = row.get(target_value_name)
 
                 upper_limit = None
                 lower_limit = None
 
                 if target_value is None:
 
                     if has_key_value(row, lower_limit_name)\
@@ -33597,19 +33613,19 @@
                 if weight is not None:
                     if data_type not in weights:
                         weights[data_type] = []
                     weights[data_type].append(weight)
 
                 # detect potential type
 
-                # targe_value = row[target_value_name] if target_value_name in row else None
-                lower_limit = row[lower_limit_name] if lower_limit_name in row else None
-                upper_limit = row[upper_limit_name] if upper_limit_name in row else None
-                lower_linear_limit = row[lower_linear_limit_name] if lower_linear_limit_name in row else None
-                upper_linear_limit = row[upper_linear_limit_name] if upper_linear_limit_name in row else None
+                # targe_value = row.get(target_value_name)
+                lower_limit = row.get(lower_limit_name)
+                upper_limit = row.get(upper_limit_name)
+                lower_linear_limit = row.get(lower_linear_limit_name)
+                upper_linear_limit = row.get(upper_linear_limit_name)
 
                 if (lower_limit is not None) and (upper_limit is not None)\
                         and lower_linear_limit is None and upper_linear_limit is None:
                     potential_type = 'square-well-parabolic'
                 elif (lower_limit is not None) and (upper_limit is not None)\
                         and (lower_linear_limit is not None) and (upper_linear_limit is not None):
                     potential_type = 'square-well-parabolic-linear'
@@ -33740,26 +33756,26 @@
 
                 _count = count.copy()
 
                 for k in count:
                     _count[k] = 0
 
                 for idx, row in enumerate(lp_data):
-                    member_id = row[member_id_name] if file_type == 'nmr-star' and member_id_name in row else None
+                    member_id = row.get(member_id_name) if file_type == 'nmr-star' else None
 
                     chain_id_1 = row[chain_id_1_name]
                     chain_id_2 = row[chain_id_2_name]
                     seq_id_1 = row[seq_id_1_name]
                     seq_id_2 = row[seq_id_2_name]
                     comp_id_1 = row[comp_id_1_name]
                     comp_id_2 = row[comp_id_2_name]
                     atom_id_1 = row[atom_id_1_name]
                     atom_id_2 = row[atom_id_2_name]
 
-                    target_value = row[target_value_name] if target_value_name in row else None
+                    target_value = row.get(target_value_name)
 
                     upper_limit = None
                     lower_limit = None
 
                     if target_value is None:
 
                         if has_key_value(row, lower_limit_name)\
@@ -33835,15 +33851,15 @@
 
                         for j in range(i + 1, len_id_set):
                             if id_set[j] >= len_lp_data:
                                 continue
                             row_1 = lp_data[id_set[i]]
                             row_2 = lp_data[id_set[j]]
 
-                            target_value_1 = row_1[target_value_name] if target_value_name in row_1 else None
+                            target_value_1 = row_1.get(target_value_name)
 
                             if target_value_1 is None:
 
                                 if has_key_value(row_1, lower_limit_name)\
                                         and has_key_value(row_1, upper_limit_name):
                                     target_value_1 = (row_1[lower_limit_name] + row_1[upper_limit_name]) / 2.0
 
@@ -33859,15 +33875,15 @@
 
                                 elif has_key_value(row_1, lower_linear_limit_name):
                                     target_value_1 = row_1[lower_linear_limit_name]
 
                                 elif has_key_value(row_1, lower_limit_name):
                                     target_value_1 = row_1[lower_limit_name]
 
-                            target_value_2 = row_2[target_value_name] if target_value_name in row_2 else None
+                            target_value_2 = row_2.get(target_value_name)
 
                             if target_value_2 is None:
 
                                 if has_key_value(row_2, lower_limit_name)\
                                         and has_key_value(row_2, upper_limit_name):
                                     target_value_2 = (row_2[lower_limit_name] + row_2[upper_limit_name]) / 2.0
 
@@ -33959,15 +33975,15 @@
                                     row_id_1 = id_set[i]
                                     row_id_2 = id_set[j]
                                     if row_id_2 >= len_lp_data:
                                         continue
                                     row_1 = lp_data[row_id_1]
                                     row_2 = lp_data[row_id_2]
 
-                                    target_value_1 = row_1[target_value_name] if target_value_name in row_1 else None
+                                    target_value_1 = row_1.get(target_value_name)
 
                                     if target_value_1 is None:
 
                                         if has_key_value(row_1, lower_limit_name)\
                                                 and has_key_value(row_1, upper_limit_name):
                                             target_value_1 = (row_1[lower_limit_name] + row_1[upper_limit_name]) / 2.0
 
@@ -33983,15 +33999,15 @@
 
                                         elif has_key_value(row_1, lower_linear_limit_name):
                                             target_value_1 = row_1[lower_linear_limit_name]
 
                                         elif has_key_value(row_1, lower_limit_name):
                                             target_value_1 = row_1[lower_limit_name]
 
-                                    target_value_2 = row_2[target_value_name] if target_value_name in row_2 else None
+                                    target_value_2 = row_2.get(target_value_name)
 
                                     if target_value_2 is None:
 
                                         if has_key_value(row_2, lower_limit_name)\
                                                 and has_key_value(row_2, upper_limit_name):
                                             target_value_2 = (row_2[lower_limit_name] + row_2[upper_limit_name]) / 2.0
 
@@ -34024,15 +34040,15 @@
                                     redundant = False
 
                                     discrepancy = abs(target_value_1 - target_value_2) / abs(target_value_1 + target_value_2) * 100.0
 
                                     if discrepancy < v or discrepancy >= v + scale:
                                         continue
 
-                                    target_value = row_1[target_value_name] if target_value_name in row_1 else None
+                                    target_value = row_1.get(target_value_name)
 
                                     upper_limit = None
                                     lower_limit = None
 
                                     if target_value is None:
 
                                         if has_key_value(row_1, lower_limit_name)\
@@ -34060,15 +34076,15 @@
                                         elif has_key_value(row_1, lower_limit_name):
                                             target_value = row_1[lower_limit_name]
                                             lower_limit = target_value
 
                                         else:
                                             continue
 
-                                    member_id = row_1[member_id_name] if file_type == 'nmr-star' and member_id_name in row_1 else None
+                                    member_id = row_1.get(member_id_name) if file_type == 'nmr-star' else None
 
                                     chain_id_1 = row_1[chain_id_1_name]
                                     chain_id_2 = row_1[chain_id_2_name]
                                     seq_id_1 = row_1[seq_id_1_name]
                                     seq_id_2 = row_1[seq_id_2_name]
                                     comp_id_1 = row_1[comp_id_1_name]
                                     comp_id_2 = row_1[comp_id_2_name]
@@ -34079,15 +34095,15 @@
                                                                                   member_id, chain_id_1, seq_id_1, comp_id_1, atom_id_1,
                                                                                   chain_id_2, seq_id_2, comp_id_2, atom_id_2)
 
                                     _count[data_type] += 1
 
                             if 0.0 <= v < scale and redundant:
 
-                                target_value = row_1[target_value_name] if target_value_name in row_1 else None
+                                target_value = row_1.get(target_value_name)
 
                                 upper_limit = None
                                 lower_limit = None
 
                                 if target_value is None:
 
                                     if has_key_value(row_1, lower_limit_name)\
@@ -34115,15 +34131,15 @@
                                     elif has_key_value(row_1, lower_limit_name):
                                         target_value = row_1[lower_limit_name]
                                         lower_limit = target_value
 
                                     else:
                                         continue
 
-                                member_id = row_1[member_id_name] if file_type == 'nmr-star' and member_id_name in row_1 else None
+                                member_id = row_1.get(member_id_name) if file_type == 'nmr-star' else None
 
                                 chain_id_1 = row_1[chain_id_1_name]
                                 chain_id_2 = row_1[chain_id_2_name]
                                 seq_id_1 = row_1[seq_id_1_name]
                                 seq_id_2 = row_1[seq_id_2_name]
                                 comp_id_1 = row_1[comp_id_1_name]
                                 comp_id_2 = row_1[comp_id_2_name]
@@ -35110,18 +35126,18 @@
 
                 for s in polymer_sequence:
                     struct_conf = self.__extractCoordStructConf(s['chain_id'], s['seq_id'])
                     value_per_residue.append({'chain_id': s['chain_id'], 'seq_id': s['seq_id'], 'comp_id': s['comp_id'],
                                               'struct_conf': struct_conf})
 
             for row in lp_data:
-                index = row[index_tag] if index_tag in row else None
-                combination_id = row[combination_id_name] if combination_id_name in row else None
+                index = row.get(index_tag)
+                combination_id = row.get(combination_id_name)
 
-                target_value = row[target_value_name] if target_value_name in row else None
+                target_value = row.get(target_value_name)
 
                 if target_value is None:
 
                     if has_key_value(row, lower_limit_name)\
                             and has_key_value(row, upper_limit_name):
                         target_value = (row[lower_limit_name] + row[upper_limit_name]) / 2.0
 
@@ -35186,15 +35202,15 @@
                 comp_id_3 = row[comp_id_3_name]
                 comp_id_4 = row[comp_id_4_name]
                 atom_id_1 = row[atom_id_1_name]
                 atom_id_2 = row[atom_id_2_name]
                 atom_id_3 = row[atom_id_3_name]
                 atom_id_4 = row[atom_id_4_name]
                 data_type = row[angle_type_name]
-                weight = row[weight_name] if weight_name in row else None
+                weight = row.get(weight_name)
                 set_id.add(row[id_tag])
 
                 peptide, nucleotide, carbohydrate = self.__csStat.getTypeOfCompId(comp_id_1)
 
                 data_type =\
                     self.__getTypeOfDihedralRestraint(data_type, peptide, nucleotide, carbohydrate,
                                                       chain_id_1, seq_id_1, atom_id_1, chain_id_2, seq_id_2, atom_id_2,
@@ -35304,19 +35320,19 @@
                 if weight is not None:
                     if data_type not in weights:
                         weights[data_type] = []
                     weights[data_type].append(weight)
 
                 # detect potential type
 
-                # targe_value = i[target_value_name] if target_value_name in i else None
-                lower_limit = row[lower_limit_name] if lower_limit_name in row else None
-                upper_limit = row[upper_limit_name] if upper_limit_name in row else None
-                lower_linear_limit = row[lower_linear_limit_name] if lower_linear_limit_name in row else None
-                upper_linear_limit = row[upper_linear_limit_name] if upper_linear_limit_name in row else None
+                # targe_value = row.get(target_value_name)
+                lower_limit = row.get(lower_limit_name)
+                upper_limit = row.get(upper_limit_name)
+                lower_linear_limit = row.get(lower_linear_limit_name)
+                upper_linear_limit = row.get(upper_linear_limit_name)
 
                 if (lower_limit is not None) and (upper_limit is not None)\
                         and lower_linear_limit is None and upper_linear_limit is None:
                     potential_type = 'square-well-parabolic'
                 elif (lower_limit is not None) and (upper_limit is not None)\
                         and (lower_linear_limit is not None) and (upper_linear_limit is not None):
                     potential_type = 'square-well-parabolic-linear'
@@ -35481,15 +35497,15 @@
 
                     for i in range(len_id_set - 1):
 
                         for j in range(i + 1, len_id_set):
                             row_1 = lp_data[id_set[i]]
                             row_2 = lp_data[id_set[j]]
 
-                            target_value_1 = row_1[target_value_name] if target_value_name in row_1 else None
+                            target_value_1 = row_1.get(target_value_name)
 
                             if target_value_1 is None:
 
                                 if has_key_value(row_1, lower_limit_name)\
                                         and has_key_value(row_1, upper_limit_name):
                                     target_value_1 = (row_1[lower_limit_name] + row_1[upper_limit_name]) / 2.0
 
@@ -35505,15 +35521,15 @@
 
                                 elif has_key_value(row_1, lower_linear_limit_name):
                                     target_value_1 = row_1[lower_linear_limit_name]
 
                                 elif has_key_value(row_1, lower_limit_name):
                                     target_value_1 = row_1[lower_limit_name]
 
-                            target_value_2 = row_2[target_value_name] if target_value_name in row_2 else None
+                            target_value_2 = row_2.get(target_value_name)
 
                             if target_value_2 is None:
 
                                 if has_key_value(row_2, lower_limit_name)\
                                         and has_key_value(row_2, upper_limit_name):
                                     target_value_2 = (row_2[lower_limit_name] + row_2[upper_limit_name]) / 2.0
 
@@ -35635,15 +35651,15 @@
 
                             for i in range(len_id_set - 1):
 
                                 for j in range(i + 1, len_id_set):
                                     row_1 = lp_data[id_set[i]]
                                     row_2 = lp_data[id_set[j]]
 
-                                    target_value_1 = row_1[target_value_name] if target_value_name in row_1 else None
+                                    target_value_1 = row_1.get(target_value_name)
 
                                     if target_value_1 is None:
 
                                         if has_key_value(row_1, lower_limit_name)\
                                                 and has_key_value(row_1, upper_limit_name):
                                             target_value_1 = (row_1[lower_limit_name] + row_1[upper_limit_name]) / 2.0
 
@@ -35659,15 +35675,15 @@
 
                                         elif has_key_value(row_1, lower_linear_limit_name):
                                             target_value_1 = row_1[lower_linear_limit_name]
 
                                         elif has_key_value(row_1, lower_limit_name):
                                             target_value_1 = row_1[lower_limit_name]
 
-                                    target_value_2 = row_2[target_value_name] if target_value_name in row_2 else None
+                                    target_value_2 = row_2.get(target_value_name)
 
                                     if target_value_2 is None:
 
                                         if has_key_value(row_2, lower_limit_name)\
                                                 and has_key_value(row_2, upper_limit_name):
                                             target_value_2 = (row_2[lower_limit_name] + row_2[upper_limit_name]) / 2.0
 
@@ -35844,15 +35860,15 @@
             max_val = 0.0
             min_val = 0.0
 
             max_val_ = -100.0
             min_val_ = 100.0
 
             for row in lp_data:
-                target_value = row[target_value_name] if target_value_name in row else None
+                target_value = row.get(target_value_name)
 
                 if target_value is None:
 
                     if has_key_value(row, lower_limit_name)\
                             and has_key_value(row, upper_limit_name):
                         target_value = (row[lower_limit_name] + row[upper_limit_name]) / 2.0
 
@@ -35916,22 +35932,22 @@
 
                 for s in polymer_sequence:
                     struct_conf = self.__extractCoordStructConf(s['chain_id'], s['seq_id'])
                     value_per_residue.append({'chain_id': s['chain_id'], 'seq_id': s['seq_id'], 'comp_id': s['comp_id'],
                                               'struct_conf': struct_conf})
 
             for row in lp_data:
-                index = row[index_tag] if index_tag in row else None
-                combination_id = row[combination_id_name] if combination_id_name in row else None
+                index = row.get(index_tag)
+                combination_id = row.get(combination_id_name)
 
                 chain_id_1 = row[chain_id_1_name]
                 seq_id_1 = row[seq_id_1_name]
                 atom_id_1 = row[atom_id_1_name]
                 atom_id_2 = row[atom_id_2_name]
-                weight = row[weight_name] if weight_name in row else None
+                weight = row.get(weight_name)
                 set_id.add(row[id_tag])
 
                 data_type = self.__getTypeOfRdcRestraint(atom_id_1, atom_id_2)
 
                 if data_type in count:
                     count[data_type] += 1
                 else:
@@ -35962,19 +35978,19 @@
                 if weight is not None:
                     if data_type not in weights:
                         weights[data_type] = []
                     weights[data_type].append(weight)
 
                 # detect potential type
 
-                targe_value = row[target_value_name] if target_value_name in row else None
-                lower_limit = row[lower_limit_name] if lower_limit_name in row else None
-                upper_limit = row[upper_limit_name] if upper_limit_name in row else None
-                lower_linear_limit = row[lower_linear_limit_name] if lower_linear_limit_name in row else None
-                upper_linear_limit = row[upper_linear_limit_name] if upper_linear_limit_name in row else None
+                targe_value = row.get(target_value_name)
+                lower_limit = row.get(lower_limit_name)
+                upper_limit = row.get(upper_limit_name)
+                lower_linear_limit = row.get(lower_linear_limit_name)
+                upper_linear_limit = row.get(upper_linear_limit_name)
 
                 if (lower_limit is not None) and (upper_limit is not None)\
                         and lower_linear_limit is None and upper_linear_limit is None:
                     potential_type = 'square-well-parabolic'
                 elif (lower_limit is not None) and (upper_limit is not None)\
                         and (lower_linear_limit is not None) and (upper_linear_limit is not None):
                     potential_type = 'square-well-parabolic-linear'
@@ -36075,15 +36091,15 @@
 
                 _count = count.copy()
 
                 for k in count:
                     _count[k] = 0
 
                 for row in lp_data:
-                    target_value = row[target_value_name] if target_value_name in row else None
+                    target_value = row.get(target_value_name)
 
                     if target_value is None:
 
                         if has_key_value(row, lower_limit_name)\
                                 and has_key_value(row, upper_limit_name):
                             target_value = (row[lower_limit_name] + row[upper_limit_name]) / 2.0
 
@@ -36149,15 +36165,15 @@
 
                     for i in range(len_id_set - 1):
 
                         for j in range(i + 1, len_id_set):
                             row_1 = lp_data[id_set[i]]
                             row_2 = lp_data[id_set[j]]
 
-                            target_value_1 = row_1[target_value_name] if target_value_name in row_1 else None
+                            target_value_1 = row_1.get(target_value_name)
 
                             if target_value_1 is None:
 
                                 if has_key_value(row_1, lower_limit_name)\
                                         and has_key_value(row_1, upper_limit_name):
                                     target_value_1 = (row_1[lower_limit_name] + row_1[upper_limit_name]) / 2.0
 
@@ -36173,15 +36189,15 @@
 
                                 elif has_key_value(row_1, lower_linear_limit_name):
                                     target_value_1 = row_1[lower_linear_limit_name]
 
                                 elif has_key_value(row_1, lower_limit_name):
                                     target_value_1 = row_1[lower_limit_name]
 
-                            target_value_2 = row_2[target_value_name] if target_value_name in row_2 else None
+                            target_value_2 = row_2.get(target_value_name)
 
                             if target_value_2 is None:
 
                                 if has_key_value(row_2, lower_limit_name)\
                                         and has_key_value(row_2, upper_limit_name):
                                     target_value_2 = (row_2[lower_limit_name] + row_2[upper_limit_name]) / 2.0
 
@@ -36262,15 +36278,15 @@
 
                             for i in range(len_id_set - 1):
 
                                 for j in range(i + 1, len_id_set):
                                     row_1 = lp_data[id_set[i]]
                                     row_2 = lp_data[id_set[j]]
 
-                                    target_value_1 = row_1[target_value_name] if target_value_name in row_1 else None
+                                    target_value_1 = row_1.get(target_value_name)
 
                                     if target_value_1 is None:
 
                                         if has_key_value(row_1, lower_limit_name)\
                                                 and has_key_value(row_1, upper_limit_name):
                                             target_value_1 = (row_1[lower_limit_name] + row_1[upper_limit_name]) / 2.0
 
@@ -36286,15 +36302,15 @@
 
                                         elif has_key_value(row_1, lower_linear_limit_name):
                                             target_value_1 = row_1[lower_linear_limit_name]
 
                                         elif has_key_value(row_1, lower_limit_name):
                                             target_value_1 = row_1[lower_limit_name]
 
-                                    target_value_2 = row_2[target_value_name] if target_value_name in row_2 else None
+                                    target_value_2 = row_2.get(target_value_name)
 
                                     if target_value_2 is None:
 
                                         if has_key_value(row_2, lower_limit_name)\
                                                 and has_key_value(row_2, upper_limit_name):
                                             target_value_2 = (row_2[lower_limit_name] + row_2[upper_limit_name]) / 2.0
 
@@ -41600,15 +41616,15 @@
                     for tag in tags:
                         eda_loop.add_tag(tag)
 
                     index = 1
 
                     for bond in bonds_w_leaving:
 
-                        leaving_flag = bond['pdbx_leaving_atom_flag'] if 'pdbx_leaving_atom_flag' in bond else ''
+                        leaving_flag = bond.get('pdbx_leaving_atom_flag', '')
 
                         if leaving_flag in ('one', 'both'):
                             leaving_atom_id = None
 
                             comp_id = bond['ptnr1_label_comp_id']
                             atom_id = bond['ptnr1_label_atom_id']
                             auth_asym_id = bond['ptnr1_auth_asym_id']
@@ -42201,15 +42217,15 @@
 
                 ent_name_syss = self.__cR.getDictList('entity_name_sys')
                 for ent_name_sys in ent_name_syss:
                     if int(ent_name_sys['entity_id']) == entity_id:
                         row = [None] * len(tags)
 
                         row[0], row[1], row[2], row[3] =\
-                            ent_name_sys['name'], ent_name_sys['system'] if 'system' in ent_name_sys else None, entity_id, self.__entry_id
+                            ent_name_sys['name'], ent_name_sys.get('system'), entity_id, self.__entry_id
 
                         esn_loop.add_data(row)
 
                 if not esn_loop.empty:
                     ent_sf.add_loop(esn_loop)
 
             # Refresh _Entity_keyword loop
@@ -45644,15 +45660,15 @@
                 chain_id_2 = row[chain_id_2_name]
                 seq_id_1 = row[seq_id_1_name]
                 seq_id_2 = row[seq_id_2_name]
 
                 if chain_id_1 == chain_id_2 and seq_id_1 == seq_id_2:
                     return False
 
-                target_value = row[target_value_name] if target_value_name in row else None
+                target_value = row.get(target_value_name)
 
                 upper_limit = None
                 lower_limit = None
 
                 if target_value is None:
 
                     if has_key_value(row, lower_limit_name)\
@@ -45778,15 +45794,15 @@
                 chain_id_2 = row[chain_id_2_name]
                 seq_id_1 = row[seq_id_1_name]
                 seq_id_2 = row[seq_id_2_name]
 
                 if chain_id_1 == chain_id_2 and seq_id_1 == seq_id_2:
                     return False
 
-                target_value = row[target_value_name] if target_value_name in row else None
+                target_value = row.get(target_value_name)
 
                 upper_limit = None
                 lower_limit = None
 
                 if target_value is None:
 
                     if has_key_value(row, lower_limit_name)\
@@ -48688,15 +48704,15 @@
                         constraint_subtype = None
                     if content_subtype == 'auto_relax_restraint' and get_first_sf_tag(sf, 'Common_relaxation_type_name') == 'paramagnetic relaxation enhancement':
                         constraint_subtype = 'PRE'
                     if sf_item['file_type'] == 'nm-res-sax':
                         constraint_subtype = 'SAXS'
                     if constraint_subtype is not None and constraint_subtype == 'RDC':
                         constraint_type = 'residual dipolar coupling'
-                    constraint_subsubtype = sf_item['constraint_subsubtype'] if 'constraint_subsubtype' in sf_item else None
+                    constraint_subsubtype = sf_item.get('constraint_subsubtype')
                     row[6], row[7], row[8], row[9] =\
                         constraint_type, constraint_subtype, constraint_subsubtype, sf_item['id']
                     row[10], row[11] = 1, self.__entry_id
 
                     cf_loop.add_data(row)
 
         ext_mr_sf_holder = []
```

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/NmrStarToCif.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/NmrStarToCif.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/NmrVrptUtility.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/NmrVrptUtility.py`

 * *Files 2% similar despite different names*

```diff
@@ -230,19 +230,20 @@
 
 
 class NmrVrptUtility:
     """ Wrapper class for NMR restraint validation.
     """
 
     def __init__(self, verbose=False, log=sys.stderr,
-                 ccU=None, csStat=None):
+                 cR=None, caC=None, ccU=None, csStat=None):
         self.__verbose = verbose
         self.__lfh = log
 
         self.__debug = False
+        self.__use_cache = cR is not None and caC is not None
 
         # auxiliary input resource
         self.__inputParamDict = {}
 
         # auxiliary output resource
         self.__outputParamDict = {}
 
@@ -267,27 +268,27 @@
         # hash code of the NMR data file
         self.__nmrDataHashCode = None
 
         # cache file name for results
         self.__resultsCacheName = None
 
         # CIF reader
-        self.__cR = None
+        self.__cR = cR
 
         # NMR data reader
         self.__rR = None
 
         # CCD accessing utility
         self.__ccU = ChemCompUtil(verbose, log) if ccU is None else ccU
 
         # BMRB chemical shift statistics
         self.__csStat = BMRBChemShiftStat(verbose, log, self.__ccU) if csStat is None else csStat
 
         # ParserListerUtil.coordAssemblyChecker()
-        self.__caC = None
+        self.__caC = caC
 
         # representative model id
         self.__representative_model_id = REPRESENTATIVE_MODEL_ID
         # total number of models
         self.__total_models = 0
 
         # atom id list for each model_id and atom key (auth_asym_id, auth_seq_id, auth_comp_id, auth_atom_id, PDB_ins_code)
@@ -368,14 +369,21 @@
 
     def setDebugMode(self, debug):
         """ Set debug mode.
         """
 
         self.__debug = debug
 
+    def useCache(self, use_cache):
+        """ Use cache file(s) of the previous run.
+            Do not enable this for generation of wwPDB validation report because of no performance improvement.
+        """
+
+        self.__use_cache = use_cache
+
     def getResults(self):
         """ Return NMR restraint validation result.
         """
 
         return self.__results
 
     def addInput(self, name=None, value=None, type='file'):  # pylint: disable=redefined-builtin
@@ -400,28 +408,30 @@
 
         try:
 
             if type == 'param':
                 self.__outputParamDict[name] = value
             elif type == 'file':
                 self.__outputParamDict[name] = os.path.abspath(value)
+                if name == 'result_pickle_file_path':
+                    self.__use_cache = True
             else:
                 raise ValueError(f"+NmrVrptUtility.addOutput() ++ Error  - Unknown output type {type}.")
 
             return True
 
         except Exception as e:
             raise ValueError("+NmrVrptUtility.addOutput() ++ Error  - " + str(e))
 
     def op(self, op):
         """ Perform a series of tasks for a given workflow operation.
         """
 
         if self.__verbose:
-            self.__lfh.write(f"+NmrVrptUtility.op() starting op {op}\n")
+            self.__lfh.write(f"+NmrVrptUtility.op() starting op {op}, use_cache {self.__use_cache}\n")
 
         if op not in self.__workFlowOps:
             raise KeyError(f"+NmrVrptUtility.op() ++ Error  - Unknown workflow operation {op}.")
 
         if op in self.__procTasksDict:
 
             for task in self.__procTasksDict[op]:
@@ -441,14 +451,34 @@
 
         return self.__results
 
     def __parseCoordinate(self):
         """ Parse coordinates.
         """
 
+        if self.__cR is not None:
+
+            self.__cifPath = self.__cR.getFilePath()
+
+            if self.__use_cache:
+
+                if self.__dirPath is None:
+                    self.__dirPath = os.path.dirname(self.__cifPath)
+
+                self.__sub_dir_name_for_cache = self.__cR.__sub_dir_name_for_cache  # pylint: disable=protected-access
+
+                self.__cacheDirPath = os.path.join(self.__dirPath, self.__sub_dir_name_for_cache)
+
+                if not os.path.isdir(self.__cacheDirPath):
+                    os.makedirs(self.__cacheDirPath)
+
+                self.__cifHashCode = self.__cR.getHashCode()
+
+            return True
+
         if not self.__checkCoordInputSource():
 
             if 'coordinate_file_path' in self.__inputParamDict:
 
                 err = f"No such {self.__inputParamDict['coordinate_file_path']!r} file."
 
                 if self.__verbose:
@@ -545,51 +575,56 @@
 
                         return False
 
                 fPath = _fPath
 
             try:
 
-                if self.__dirPath is None:
-                    self.__dirPath = os.path.dirname(fPath)
+                if self.__use_cache:
 
-                self.__cacheDirPath = os.path.join(self.__dirPath, self.__sub_dir_name_for_cache)
+                    if self.__dirPath is None:
+                        self.__dirPath = os.path.dirname(fPath)
 
-                if not os.path.isdir(self.__cacheDirPath):
-                    os.makedirs(self.__cacheDirPath)
+                    self.__cacheDirPath = os.path.join(self.__dirPath, self.__sub_dir_name_for_cache)
+
+                    if not os.path.isdir(self.__cacheDirPath):
+                        os.makedirs(self.__cacheDirPath)
 
                 self.__cR = CifReader(self.__verbose, self.__lfh,
-                                      use_cache=True,
+                                      use_cache=self.__use_cache,
                                       sub_dir_name_for_cache=self.__sub_dir_name_for_cache)
 
                 if self.__cR.parse(fPath):
                     self.__cifPath = fPath
-                    self.__cifHashCode = self.__cR.getHashCode()
+                    if self.__use_cache:
+                        self.__cifHashCode = self.__cR.getHashCode()
                     return True
 
             except Exception:
                 pass
 
         if 'coord_cif_reader_object' in self.__inputParamDict:
 
             self.__cR = self.__inputParamDict['coord_cif_reader_object']
 
             self.__cifPath = self.__cR.getFilePath()
 
-            if self.__dirPath is None:
-                self.__dirPath = os.path.dirname(self.__cifPath)
+            if self.__use_cache:
 
-            self.__sub_dir_name_for_cache = self.__cR.__sub_dir_name_for_cache  # pylint: disable=protected-access
+                if self.__dirPath is None:
+                    self.__dirPath = os.path.dirname(self.__cifPath)
 
-            self.__cacheDirPath = os.path.join(self.__dirPath, self.__sub_dir_name_for_cache)
+                self.__sub_dir_name_for_cache = self.__cR.__sub_dir_name_for_cache  # pylint: disable=protected-access
 
-            if not os.path.isdir(self.__cacheDirPath):
-                os.makedirs(self.__cacheDirPath)
+                self.__cacheDirPath = os.path.join(self.__dirPath, self.__sub_dir_name_for_cache)
 
-            self.__cifHashCode = self.__cR.getHashCode()
+                if not os.path.isdir(self.__cacheDirPath):
+                    os.makedirs(self.__cacheDirPath)
+
+                self.__cifHashCode = self.__cR.getHashCode()
 
             return True
 
         return False
 
     def __parseNmrData(self):
         """ Parse NMR data.
@@ -641,27 +676,29 @@
             try:
 
                 self.__rR = CifReader(self.__verbose, self.__lfh,
                                       use_cache=False)
 
                 if self.__rR.parse(fPath):
                     self.__nmrDataPath = fPath
-                    self.__nmrDataHashCode = self.__rR.getHashCode()
+                    if self.__use_cache:
+                        self.__nmrDataHashCode = self.__rR.getHashCode()
                     return True
 
             except Exception:
                 pass
 
         if 'nmr_cif_reader_object' in self.__inputParamDict:
 
             self.__rR = self.__inputParamDict['nmr_cif_reader_object']
 
             self.__nmrDataPath = self.__rR.getFilePath()
 
-            self.__nmrDataHashCode = self.__rR.getHashCode()
+            if self.__use_cache:
+                self.__nmrDataHashCode = self.__rR.getHashCode()
 
             return True
 
         def get_tempfile_name(suffix=''):
             return os.path.join(tempfile.gettempdir(), f"{next(tempfile._get_candidate_names())}{suffix}")  # pylint: disable=protected-access
 
         if 'nmr_str_file_path' in self.__inputParamDict:
@@ -685,16 +722,17 @@
 
                     myIo.writeFile(_fPath, containerList=containerList[1:])
 
                     self.__rR = CifReader(self.__verbose, self.__lfh,
                                           use_cache=False)
 
                     if self.__rR.parse(_fPath, self.__dirPath):
-                        self.__nmrDataPath = _fPath
-                        self.__nmrDataHashCode = self.__rR.getHashCode()
+                        self.__nmrDataPath = fPath
+                        if self.__use_cache:
+                            self.__nmrDataHashCode = self.__rR.getHashCode()
                         return True
 
             except Exception as e:
                 self.__lfh.write(f"+NmrVrptUtility.__checkNmrDataInputSource() ++ Error  - {str(e)}\n")
             finally:
                 try:
                     if os.path.exists(_fPath):
@@ -726,16 +764,17 @@
 
                     myIo.writeFile(__fPath, containerList=containerList[1:])
 
                     self.__rR = CifReader(self.__verbose, self.__lfh,
                                           use_cache=False)
 
                     if self.__rR.parse(__fPath, self.__dirPath):
-                        self.__nmrDataPath = __fPath
-                        self.__nmrDataHashCode = self.__rR.getHashCode()
+                        self.__nmrDataPath = _fPath
+                        if self.__use_cache:
+                            self.__nmrDataHashCode = self.__rR.getHashCode()
                         return True
 
             except Exception as e:
                 self.__lfh.write(f"+NmrVrptUtility.__checkNmrDataInputSource() ++ Error  - {str(e)}\n")
             finally:
                 try:
                     if os.path.exists(_fPath):
@@ -768,28 +807,38 @@
     def __retrieveCoordAssemblyChecker(self):
         """ Wrapper function for ParserListenerUtil.coordAssemblyChecker.
         """
 
         if self.__has_prev_results:
             return True
 
-        cache_path = None
-        if self.__cifHashCode is not None:
-            cache_path = os.path.join(self.__cacheDirPath, f"{self.__cifHashCode}_asm_chk.pkl")
-            self.__caC = load_from_pickle(cache_path)
+        if self.__caC is not None:
+            return True
 
-            if self.__caC is not None:
-                return True
+        if self.__use_cache:
 
-        self.__caC = coordAssemblyChecker(self.__verbose, self.__lfh,
-                                          self.__representative_model_id,
-                                          self.__cR, None)
+            cache_path = None
+            if self.__cifHashCode is not None:
+                cache_path = os.path.join(self.__cacheDirPath, f"{self.__cifHashCode}_asm_chk.pkl")
+                self.__caC = load_from_pickle(cache_path)
+
+                if self.__caC is not None:
+                    return True
 
-        if self.__caC is not None and cache_path:
-            write_as_pickle(self.__caC, cache_path)
+            self.__caC = coordAssemblyChecker(self.__verbose, self.__lfh,
+                                              self.__representative_model_id,
+                                              self.__cR, None)
+
+            if self.__caC is not None and cache_path:
+                write_as_pickle(self.__caC, cache_path)
+
+        else:
+            self.__caC = coordAssemblyChecker(self.__verbose, self.__lfh,
+                                              self.__representative_model_id,
+                                              self.__cR, None, False)
 
         return True
 
     def __extractCoordAtomSite(self):
         """ Extract atom_site of coordinate file.
             @author: Masashi Yokochi
             @note: Derived from wwpdb.apps.validation.src.RestraintValidation.BMRBRestraintsAnalysis.get_coordinates,
@@ -883,14 +932,15 @@
     def __extractGenDistConstraint(self):
         """ Extract Gen_dist_constraint category of NMR data file.
             @author: Masashi Yokochi
             @note: Derived from wwpdb.apps.validation.src.RestraintValidation.BMRBRestraintsAnalysis.get_restraints2,
                    written by Kumaran Baskaran
             @change: class method, use of wwpdb.utils.nmr.io.CifReader, improve readability of restraints,
                      support combinational restraints (_Gen_dist_constraint.Combination_ID, Member_ID)
+                     define bond types for deselenide bond and metal coordination (sebond, metal)
         """
 
         if self.__has_prev_results:
             return True
 
         if self.__nmrDataPath is None:
             return False
@@ -899,14 +949,16 @@
         self.__distRestSeqDict = {}
 
         lp_category = 'Gen_dist_constraint'
         sf_category = 'Gen_dist_constraint_list'
 
         try:
 
+            skipped = False
+
             for dBlock in self.__rR.getDataBlockList():
 
                 if not self.__rR.hasCategory(lp_category, dBlock.getName()):
                     continue
 
                 sf_tag = self.__rR.getDictList(sf_category)
 
@@ -965,19 +1017,19 @@
                     auth_asym_id_2 = r['auth_asym_id_2']
                     auth_seq_id_1 = r['auth_seq_id_1']
                     auth_seq_id_2 = r['auth_seq_id_2']
                     comp_id_1 = r['comp_id_1']
                     comp_id_2 = r['comp_id_2']
                     atom_id_1 = r['atom_id_1']
                     atom_id_2 = r['atom_id_2']
-                    member_id = r['member_id'] if has_member_id else None
-                    ins_code_1 = r['ins_code_1'] if has_pdb_ins_code_1 else '?'
-                    ins_code_2 = r['ins_code_2'] if has_pdb_ins_code_2 else '?'
-                    target_value = r['target_value'] if has_target_val else None
-                    target_value_uncertainty = r['target_value_uncertainty'] if has_target_val_uncertainty else None
+                    member_id = r.get('member_id')
+                    ins_code_1 = r.get('ins_code_1', '?')
+                    ins_code_2 = r.get('ins_code_2', '?')
+                    target_value = r.get('target_value')
+                    target_value_uncertainty = r.get('target_value_uncertainty')
 
                     offset = abs(auth_seq_id_1 - auth_seq_id_2)
 
                     if r['entity_asm_id_1'] != r['entity_asm_id_2']:
                         distance_type = 'interchain'
                     elif offset == 0:
                         distance_type = 'intraresidue'
@@ -999,15 +1051,17 @@
                         distance_sub_type = 'sidechain-sidechain'
 
                     lower_bound = r['lower_bound']
                     upper_bound = r['upper_bound']
 
                     if lower_bound is None and upper_bound is None:
                         if target_value is None:
-                            self.__lfh.write(f"+NmrVrptUtility.__extractGenDistConstraint() ++ Warning  - distance restraint {rest_key} {r} is not interpretable.\n")
+                            self.__lfh.write(f"+NmrVrptUtility.__extractGenDistConstraint() ++ Error  - distance restraint {rest_key} {r} is not interpretable, "
+                                             f"{os.path.basename(self.__nmrDataPath)}.\n")
+                            skipped = True
                             continue
                         if target_value_uncertainty is not None:
                             lower_bound = max(target_value - target_value_uncertainty, 0.0)
                             upper_bound = target_value + target_value_uncertainty
                         else:
                             lower_bound = upper_bound = target_value
 
@@ -1055,17 +1109,19 @@
                     seq_keys = set([seq_key_1, seq_key_2])
 
                     for seq_key in seq_keys:
                         if seq_key not in self.__distRestSeqDict:
                             self.__distRestSeqDict[seq_key] = []
                         self.__distRestSeqDict[seq_key].append(rest_key)
 
-            for k, v in self.__distRestDict.items():
-                if len(v) == 0:
-                    del self.__distRestDict[k]
+            if skipped:
+                __distRestDict__ = copy.copy(self.__distRestDict)
+                for k, v in __distRestDict__.items():
+                    if len(v) == 0:
+                        del self.__distRestDict[k]
 
             for v in self.__distRestSeqDict.values():
                 v = list(set(v))
 
             if len(self.__distRestDict) == 0:
                 self.__distRestDict = self.__distRestSeqDict = None
 
@@ -1081,16 +1137,16 @@
     def __extractTorsionAngleConstraint(self):
         """ Extract Torsion_angle_constraint category of NMR data file.
             @author: Masashi Yokochi
             @note: Derived from wwpdb.apps.validation.src.RestraintValidation.BMRBRestraintsAnalysis.get_restraints2,
                    written by Kumaran Baskaran
             @change: class method, use of wwpdb.utils.nmr.io.CifReader, improve readability of restraints,
                      support combinational restraints (_Torsion_angle_constraint.Combination_ID),
-                     support for the case target_value is not set,
-                     support for the case upper/lower linear limits are set, but missing upper/lower limits
+                     support for the case target_value is not set (i.e. AMBER restraint format),
+                     support for the case upper/lower linear limits are set, but missing upper/lower limits (i.e. XPLOR-NIH/CNS exponent parameter (ed) equals 1)
         """
 
         if self.__has_prev_results:
             return True
 
         if self.__nmrDataPath is None:
             return False
@@ -1099,14 +1155,16 @@
         self.__dihedRestSeqDict = {}
 
         lp_category = 'Torsion_angle_constraint'
         sf_category = 'Torsion_angle_constraint_list'
 
         try:
 
+            skipped = False
+
             for dBlock in self.__rR.getDataBlockList():
 
                 if not self.__rR.hasCategory(lp_category, dBlock.getName()):
                     continue
 
                 sf_tag = self.__rR.getDictList(sf_category)
 
@@ -1185,29 +1243,31 @@
                     comp_id_2 = r['comp_id_2']
                     comp_id_3 = r['comp_id_3']
                     comp_id_4 = r['comp_id_4']
                     atom_id_1 = r['atom_id_1']
                     atom_id_2 = r['atom_id_2']
                     atom_id_3 = r['atom_id_3']
                     atom_id_4 = r['atom_id_4']
-                    ins_code_1 = r['ins_code_1'] if has_pdb_ins_code_1 else '?'
-                    ins_code_2 = r['ins_code_2'] if has_pdb_ins_code_2 else '?'
-                    ins_code_3 = r['ins_code_3'] if has_pdb_ins_code_3 else '?'
-                    ins_code_4 = r['ins_code_4'] if has_pdb_ins_code_4 else '?'
+                    ins_code_1 = r.get('ins_code_1', '?')
+                    ins_code_2 = r.get('ins_code_2', '?')
+                    ins_code_3 = r.get('ins_code_3', '?')
+                    ins_code_4 = r.get('ins_code_4', '?')
 
                     lower_bound = r['lower_bound']
                     upper_bound = r['upper_bound']
                     target_value = r['target_value']
-                    lower_linear_limit = r['lower_linear_limit'] if has_lower_linear_limit else None
-                    upper_linear_limit = r['upper_linear_limit'] if has_upper_linear_limit else None
-                    target_value_uncertainty = r['target_value_uncertainty'] if has_target_val_err else None
+                    lower_linear_limit = r.get('lower_linear_limit')
+                    upper_linear_limit = r.get('upper_linear_limit')
+                    target_value_uncertainty = r.get('target_value_uncertainty')
 
                     if lower_bound is None and upper_bound is None and lower_linear_limit is None and upper_linear_limit is None:
                         if target_value is None:
-                            self.__lfh.write(f"+NmrVrptUtility.__extractTorsionAngleConstraint() ++ Warning  - dihedral angle restraint {rest_key} {r} is not interpretable.\n")
+                            self.__lfh.write(f"+NmrVrptUtility.__extractTorsionAngleConstraint() ++ Error  - dihedral angle restraint {rest_key} {r} is not interpretable, "
+                                             f"{os.path.basename(self.__nmrDataPath)}.\n")
+                            skipped = True
                             continue
                         if target_value_uncertainty is not None:
                             lower_bound = target_value - target_value_uncertainty
                             upper_bound = target_value + target_value_uncertainty
                         else:
                             lower_bound = upper_bound = target_value
 
@@ -1241,17 +1301,19 @@
                     seq_keys = set([seq_key_1, seq_key_2, seq_key_3, seq_key_4])
 
                     for seq_key in seq_keys:
                         if seq_key not in self.__dihedRestSeqDict:
                             self.__dihedRestSeqDict[seq_key] = []
                         self.__dihedRestSeqDict[seq_key].append(rest_key)
 
-            for k, v in self.__dihedRestDict.items():
-                if len(v) == 0:
-                    del self.__dihedRestDict[k]
+            if skipped:
+                __dihedRestDict__ = copy.copy(self.__dihedRestDict)
+                for k, v in __dihedRestDict__.items():
+                    if len(v) == 0:
+                        del self.__dihedRestDict[k]
 
             for v in self.__dihedRestSeqDict.values():
                 v = list(set(v))
 
             if len(self.__dihedRestDict) == 0:
                 self.__dihedRestDict = self.__dihedRestSeqDict = None
 
@@ -1278,14 +1340,16 @@
         self.__rdcRestSeqDict = {}
 
         lp_category = 'RDC_constraint'
         sf_category = 'RDC_constraint_list'
 
         try:
 
+            skipped = False
+
             for dBlock in self.__rR.getDataBlockList():
 
                 if not self.__rR.hasCategory(lp_category, dBlock.getName()):
                     continue
 
                 sf_tag = self.__rR.getDictList(sf_category)
 
@@ -1312,23 +1376,29 @@
                               {'name': 'Target_value_uncertainty', 'type': 'abs-float', 'alt_name': 'target_value_uncertainty'}
                               ]
 
                 tags = self.__rR.getItemTags(lp_category)
 
                 has_pdb_ins_code_1 = 'PDB_ins_code_1' in tags
                 has_pdb_ins_code_2 = 'PDB_ins_code_2' in tags
+                has_val = 'RDC_val' in tags
+                has_val_err = 'RDC_val_err' in tags
                 has_lower_bound = 'RDC_lower_bound' in tags
                 has_upper_bound = 'RDC_upper_bound' in tags
                 has_lower_linear_limit = 'RDC_lower_linear_limit' in tags
                 has_upper_linear_limit = 'RDC_upper_linear_limit' in tags
 
                 if has_pdb_ins_code_1:
                     data_items.append({'name': 'PDB_ins_code_1', 'type': 'str', 'alt_name': 'ins_code_1', 'default': '?'})
                 if has_pdb_ins_code_2:
                     data_items.append({'name': 'PDB_ins_code_2', 'type': 'str', 'alt_name': 'ins_code_2', 'default': '?'})
+                if has_val:
+                    data_items.append({'name': 'RDC_val', 'type': 'float', 'alt_name': 'value'})
+                if has_val_err:
+                    data_items.append({'name': 'RDC_val_err', 'type': 'abs-float', 'alt_name': 'value_uncertainty'})
                 if has_lower_bound:
                     data_items.append({'name': 'RDC_lower_bound', 'type': 'float', 'alt_name': 'lower_bound'})
                 if has_upper_bound:
                     data_items.append({'name': 'RDC_upper_bound', 'type': 'float', 'alt_name': 'upper_bound'})
                 if has_lower_linear_limit:
                     data_items.append({'name': 'RDC_lower_linear_limit', 'type': 'float', 'alt_name': 'lower_linear_limit'})
                 if has_upper_linear_limit:
@@ -1350,33 +1420,46 @@
                     auth_asym_id_2 = r['auth_asym_id_2']
                     auth_seq_id_1 = r['auth_seq_id_1']
                     auth_seq_id_2 = r['auth_seq_id_2']
                     comp_id_1 = r['comp_id_1']
                     comp_id_2 = r['comp_id_2']
                     atom_id_1 = r['atom_id_1']
                     atom_id_2 = r['atom_id_2']
-                    ins_code_1 = r['ins_code_1'] if has_pdb_ins_code_1 else '?'
-                    ins_code_2 = r['ins_code_2'] if has_pdb_ins_code_2 else '?'
+                    ins_code_1 = r.get('ins_code_1', '?')
+                    ins_code_2 = r.get('ins_code_2', '?')
 
                     target_value = r['target_value']
                     target_value_uncertainty = r['target_value_uncertainty']
-                    lower_bound = r['lower_bound'] if has_lower_bound else None
-                    upper_bound = r['upper_bound'] if has_upper_bound else None
-                    lower_linear_limit = r['lower_linear_limit'] if has_lower_linear_limit else None
-                    upper_linear_limit = r['upper_linear_limit'] if has_upper_linear_limit else None
+                    value = r.get('value')
+                    value_uncertainty = r.get('value_uncertainty')
+                    lower_bound = r.get('lower_bound')
+                    upper_bound = r.get('upper_bound')
+                    lower_linear_limit = r.get('lower_linear_limit')
+                    upper_linear_limit = r.get('upper_linear_limit')
 
                     if lower_bound is None and upper_bound is None and lower_linear_limit is None and upper_linear_limit is None:
-                        if target_value is None:
-                            self.__lfh.write(f"+NmrVrptUtility.__extractRdcConstraint() ++ Warning  - RDC restraint {rest_key} {r} is not interpretable.\n")
+                        if target_value is None and value is None:
+                            self.__lfh.write(f"+NmrVrptUtility.__extractRdcConstraint() ++ Error  - RDC restraint {rest_key} {r} is not interpretable, "
+                                             f"{os.path.basename(self.__nmrDataPath)}.\n")
+                            skipped = True
                             continue
-                        if target_value_uncertainty is not None:
-                            lower_bound = target_value - target_value_uncertainty
-                            upper_bound = target_value + target_value_uncertainty
+                        if target_value is not None:
+                            if target_value_uncertainty is not None:
+                                lower_bound = target_value - target_value_uncertainty
+                                upper_bound = target_value + target_value_uncertainty
+                            else:
+                                lower_bound = upper_bound = target_value
                         else:
-                            lower_bound = upper_bound = target_value
+                            target_value = value
+                            target_value_uncertainty = value_uncertainty
+                            if target_value_uncertainty is not None:
+                                lower_bound = target_value - target_value_uncertainty
+                                upper_bound = target_value + target_value_uncertainty
+                            else:
+                                lower_bound = upper_bound = target_value
 
                     if lower_bound is None and lower_linear_limit is not None:
                         lower_bound = lower_linear_limit
                     if upper_bound is None and upper_linear_limit is not None:
                         upper_bound = upper_linear_limit
 
                     if target_value is None:  # target values are not always filled (e.g. AMBER dihedral restraints)
@@ -1398,17 +1481,19 @@
                     seq_keys = set([seq_key_1, seq_key_2])
 
                     for seq_key in seq_keys:
                         if seq_key not in self.__rdcRestSeqDict:
                             self.__rdcRestSeqDict[seq_key] = []
                         self.__rdcRestSeqDict[seq_key].append(rest_key)
 
-            for k, v in self.__rdcRestDict.items():
-                if len(v) == 0:
-                    del self.__rdcRestDict[k]
+            if skipped:
+                __rdcRestDict__ = copy.copy(self.__rdcRestDict)
+                for k, v in __rdcRestDict__.items():
+                    if len(v) == 0:
+                        del self.__rdcRestDict[k]
 
             for v in self.__rdcRestSeqDict.values():
                 v = list(set(v))
 
             if len(self.__rdcRestDict) == 0:
                 self.__rdcRestDict = self.__rdcRestSeqDict = None
 
@@ -1460,28 +1545,31 @@
 
                         try:
                             pos_1 = self.__coordinates[model_id][atom_key_1]
                         except KeyError:
                             if self.__verbose:
                                 self.__lfh.write(f"Atom (auth_asym_id: {atom_key_1[0]}, auth_seq_id: {atom_key_1[1]}, "
                                                  f"comp_id: {atom_key_1[2]}, atom_id: {atom_key_1[3]}) "
-                                                 f"not found in the coordinates for distance restraint {rest_key}.")
+                                                 f"not found in the coordinates for distance restraint {rest_key}.\n")
                             atom_present = False
 
                         try:
                             pos_2 = self.__coordinates[model_id][atom_key_2]
                         except KeyError:
                             if self.__verbose:
                                 self.__lfh.write(f"Atom (auth_asym_id: {atom_key_2[0]}, auth_seq_id: {atom_key_2[1]}, "
                                                  f"comp_id: {atom_key_2[2]}, atom_id: {atom_key_2[3]}) "
-                                                 f"not found in the coordinates for distance restraint {rest_key}.")
+                                                 f"not found in the coordinates for distance restraint {rest_key}.\n")
                             atom_present = False
 
                         if atom_present:
                             d = distance(pos_1, pos_2)
+                            if d == 0.0:
+                                self.__lfh.write(f"+NmrVrptUtility.__calculateDistanceRestraintViolations() ++ Error  - distance restraint {rest_key} {r} does not make sense, "
+                                                 f"{os.path.basename(self.__nmrDataPath)}.\n")
                             dist_list.append(d)
                         else:
                             self.__distRestUnmapped.append(rest_key)
 
                     error = None
 
                     if len(dist_list) > 0:
@@ -1647,42 +1735,42 @@
 
                         try:
                             pos_1 = self.__coordinates[model_id][atom_key_1]
                         except KeyError:
                             if self.__verbose:
                                 self.__lfh.write(f"Atom (auth_asym_id: {atom_key_1[0]}, auth_seq_id: {atom_key_1[1]}, "
                                                  f"comp_id: {atom_key_1[2]}, atom_id: {atom_key_1[3]}) "
-                                                 f"not found in the coordinates for dihedral angle restraint {rest_key}.")
+                                                 f"not found in the coordinates for dihedral angle restraint {rest_key}.\n")
                             atom_present = False
 
                         try:
                             pos_2 = self.__coordinates[model_id][atom_key_2]
                         except KeyError:
                             if self.__verbose:
                                 self.__lfh.write(f"Atom (auth_asym_id: {atom_key_2[0]}, auth_seq_id: {atom_key_2[1]}, "
                                                  f"comp_id: {atom_key_2[2]}, atom_id: {atom_key_2[3]}) "
-                                                 f"not found in the coordinates for dihedral angle restraint {rest_key}.")
+                                                 f"not found in the coordinates for dihedral angle restraint {rest_key}.\n")
                             atom_present = False
 
                         try:
                             pos_3 = self.__coordinates[model_id][atom_key_3]
                         except KeyError:
                             if self.__verbose:
                                 self.__lfh.write(f"Atom (auth_asym_id: {atom_key_3[0]}, auth_seq_id: {atom_key_3[1]}, "
                                                  f"comp_id: {atom_key_3[2]}, atom_id: {atom_key_3[3]}) "
-                                                 f"not found in the coordinates for dihedral angle restraint {rest_key}.")
+                                                 f"not found in the coordinates for dihedral angle restraint {rest_key}.\n")
                             atom_present = False
 
                         try:
                             pos_4 = self.__coordinates[model_id][atom_key_4]
                         except KeyError:
                             if self.__verbose:
                                 self.__lfh.write(f"Atom (auth_asym_id: {atom_key_4[0]}, auth_seq_id: {atom_key_4[1]}, "
                                                  f"comp_id: {atom_key_4[2]}, atom_id: {atom_key_4[3]}) "
-                                                 f"not found in the coordinates for dihedral angle restraint {rest_key}.")
+                                                 f"not found in the coordinates for dihedral angle restraint {rest_key}.\n")
                             atom_present = False
 
                         if atom_present:
                             a = dihedral_angle(pos_1, pos_2, pos_3, pos_4)
                             angle_list.append(a)
                         else:
                             self.__dihedRestUnmapped.append(rest_key)
@@ -1800,28 +1888,28 @@
 
                         try:
                             pos_1 = self.__coordinates[model_id][atom_key_1]  # noqa: F841, pylint: disable='unused-variable'
                         except KeyError:
                             if self.__verbose:
                                 self.__lfh.write(f"Atom (auth_asym_id: {atom_key_1[0]}, auth_seq_id: {atom_key_1[1]}, "
                                                  f"comp_id: {atom_key_1[2]}, atom_id: {atom_key_1[3]}) "
-                                                 f"not found in the coordinates for RDC restraint {rest_key}.")
+                                                 f"not found in the coordinates for RDC restraint {rest_key}.\n")
                             atom_present = False
 
                         try:
                             pos_2 = self.__coordinates[model_id][atom_key_2]  # noqa: F841, pylint: disable='unused-variable'
                         except KeyError:
                             if self.__verbose:
                                 self.__lfh.write(f"Atom (auth_asym_id: {atom_key_2[0]}, auth_seq_id: {atom_key_2[1]}, "
                                                  f"comp_id: {atom_key_2[2]}, atom_id: {atom_key_2[3]}) "
-                                                 f"not found in the coordinates for RDC restraint {rest_key}.")
+                                                 f"not found in the coordinates for RDC restraint {rest_key}.\n")
                             atom_present = False
 
                         if atom_present:
-                            # """ TODO: rdc() returns calculated RDC value (RDC_calc) for a given vector using the RDC alignment tensor of rest_key[0], pylint: disable='fixme'
+                            # """ TODO: rdc() should return calculated RDC value for a given vector using the RDC alignment tensor of rest_key[0], pylint: disable='fixme'
                             # r = rdc(rest_key[0], pos_1, pos_2)
                             # rdc_list.append(r)
                             # """
                             pass
                         else:
                             self.__rdcRestUnmapped.append(rest_key)
 
@@ -2649,27 +2737,34 @@
 
         return False
 
     def __outputResultsAsPickleFileIfPossible(self):
         """ Output results if 'result_pickle_file_path' was set in output parameter.
         """
 
-        cache_path = None
-        if self.__resultsCacheName is not None:
-            cache_path = os.path.join(self.__cacheDirPath, self.__resultsCacheName)
+        if self.__use_cache:
 
-            if not os.path.exists(cache_path):
-                write_as_pickle(self.__results, cache_path)
+            cache_path = None
+            if self.__resultsCacheName is not None:
+                cache_path = os.path.join(self.__cacheDirPath, self.__resultsCacheName)
 
-        if 'result_pickle_file_path' in self.__outputParamDict:
-            pickle_file = self.__outputParamDict['result_pickle_file_path']
+                if not os.path.exists(cache_path):
+                    write_as_pickle(self.__results, cache_path)
 
-            if cache_path is None:
-                write_as_pickle(self.__results, pickle_file)
-                return True
+            if 'result_pickle_file_path' in self.__outputParamDict:
+                pickle_file = self.__outputParamDict['result_pickle_file_path']
+
+                if cache_path is None:
+                    write_as_pickle(self.__results, pickle_file)
+                    return True
 
-            if os.path.exists(pickle_file):
-                os.remove(pickle_file)
+                if os.path.exists(pickle_file):
+                    os.remove(pickle_file)
+
+                os.symlink(cache_path, pickle_file)
+
+        elif 'result_pickle_file_path' in self.__outputParamDict:
+            pickle_file = self.__outputParamDict['result_pickle_file_path']
 
-            os.symlink(cache_path, pickle_file)
+            write_as_pickle(self.__results, pickle_file)
 
         return True
```

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/bmrb_cs_stat/aa_filt.csv` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/bmrb_cs_stat/aa_filt.csv`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/bmrb_cs_stat/aa_filt.pkl` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/bmrb_cs_stat/aa_filt.pkl`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/bmrb_cs_stat/aa_full.csv` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/bmrb_cs_stat/aa_full.csv`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/bmrb_cs_stat/aa_full.pkl` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/bmrb_cs_stat/aa_full.pkl`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/bmrb_cs_stat/dna_filt.csv` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/bmrb_cs_stat/dna_filt.csv`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/bmrb_cs_stat/dna_filt.pkl` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/bmrb_cs_stat/dna_filt.pkl`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/bmrb_cs_stat/dna_full.csv` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/bmrb_cs_stat/dna_full.csv`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/bmrb_cs_stat/dna_full.pkl` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/bmrb_cs_stat/dna_full.pkl`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/bmrb_cs_stat/others.csv` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/bmrb_cs_stat/others.csv`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/bmrb_cs_stat/rna_filt.csv` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/bmrb_cs_stat/rna_filt.csv`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/bmrb_cs_stat/rna_filt.pkl` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/bmrb_cs_stat/rna_filt.pkl`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/bmrb_cs_stat/rna_full.csv` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/bmrb_cs_stat/rna_full.csv`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/bmrb_cs_stat/rna_full.pkl` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/bmrb_cs_stat/rna_full.pkl`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/io/ChemCompIo.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/io/ChemCompIo.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/io/CifReader.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/io/CifReader.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/io/mmCIFUtil.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/io/mmCIFUtil.py`

 * *Files 0% similar despite different names*

```diff
@@ -321,15 +321,15 @@
         #
         return catObj.getAttributeList()
 
     def GetDictList(self, blockName, catName):
         """ Get a list of dictionaries of a given Data Block and Category
         """
         dList, iList = self.GetValueAndItemByBlock(blockName, catName)
-        data = [[x[y] if y in x else None for y in iList] for x in dList]
+        data = [[x.get(y) for y in iList] for x in dList]
         #
         return {catName: {"Items": iList, "Values": data}}
 
     def GetDataBlock(self, blockName):
         """ Get a list of dictionaries of a given Data Block
         """
         data = {}
```

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/AmberMRLexer.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/AmberMRLexer.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/AmberMRParser.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/AmberMRParser.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/AmberMRParserListener.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/AmberMRParserListener.py`

 * *Files 2% similar despite different names*

```diff
@@ -60,14 +60,15 @@
     from wwpdb.utils.nmr.BMRBChemShiftStat import BMRBChemShiftStat
     from wwpdb.utils.nmr.NEFTranslator.NEFTranslator import NEFTranslator
     from wwpdb.utils.nmr.AlignUtil import (LARGE_ASYM_ID,
                                            monDict3,
                                            protonBeginCode,
                                            aminoProtonCode,
                                            rdcBbPairCode,
+                                           updatePolySeqRst,
                                            updatePolySeqRstFromAtomSelectionSet,
                                            sortPolySeqRst,
                                            alignPolymerSequence,
                                            assignPolymerSequence,
                                            trimSequenceAlignment,
                                            retrieveAtomIdentFromMRMap)
 except ImportError:
@@ -115,14 +116,15 @@
     from nmr.BMRBChemShiftStat import BMRBChemShiftStat
     from nmr.NEFTranslator.NEFTranslator import NEFTranslator
     from nmr.AlignUtil import (LARGE_ASYM_ID,
                                monDict3,
                                protonBeginCode,
                                aminoProtonCode,
                                rdcBbPairCode,
+                               updatePolySeqRst,
                                updatePolySeqRstFromAtomSelectionSet,
                                sortPolySeqRst,
                                alignPolymerSequence,
                                assignPolymerSequence,
                                trimSequenceAlignment,
                                retrieveAtomIdentFromMRMap)
 
@@ -762,14 +764,53 @@
                                     ps['chain_id'] = chain_mapping[ps['chain_id']]
 
                             self.__seqAlign, _ = alignPolymerSequence(self.__pA, self.__polySeq, self.__polySeqRst)
                             self.__chainAssign, _ = assignPolymerSequence(self.__pA, self.__ccU, self.__file_type, self.__polySeq, self.__polySeqRst, self.__seqAlign)
 
                     trimSequenceAlignment(self.__seqAlign, self.__chainAssign)
 
+                    if self.__atomNumberDict is None and self.__sanderAtomNumberDict is not None and len(self.__polySeqRst) == 0:
+
+                        for atomNum in self.__sanderAtomNumberDict.values():
+                            updatePolySeqRst(self.__polySeqRst, atomNum['chain_id'], atomNum['seq_id'],
+                                             atomNum['comp_id'], atomNum.get('auth_comp_id'))
+
+                        sortPolySeqRst(self.__polySeqRst)
+
+                        self.__seqAlign, _ = alignPolymerSequence(self.__pA, self.__polySeq, self.__polySeqRst)
+                        self.__chainAssign, message = assignPolymerSequence(self.__pA, self.__ccU, self.__file_type, self.__polySeq, self.__polySeqRst, self.__seqAlign)
+
+                        seq_id_mapping = {}
+
+                        for ca in self.__chainAssign:
+                            ref_chain_id = ca['ref_chain_id']
+                            test_chain_id = ca['test_chain_id']
+
+                            sa = next((sa for sa in self.__seqAlign
+                                       if sa['ref_chain_id'] == ref_chain_id
+                                       and sa['test_chain_id'] == test_chain_id), None)
+
+                            if sa is not None:
+                                for ref_auth_seq_id, test_seq_id in zip(sa['ref_auth_seq_id'] if 'ref_auth_seq_id' in sa else sa['ref_seq_id'],
+                                                                        sa['test_seq_id']):
+                                    seq_key = (test_chain_id, test_seq_id)
+                                    seq_id_mapping[seq_key] = (ref_chain_id, ref_auth_seq_id)
+
+                        for atomNum in self.__sanderAtomNumberDict.values():
+                            test_chain_id = atomNum['chain_id']
+                            test_seq_id = atomNum['seq_id']
+
+                            seq_key = (test_chain_id, test_seq_id)
+
+                            if seq_key in seq_id_mapping:
+                                ref_chain_id, ref_auth_seq_id = seq_id_mapping[seq_key]
+                                atomNum['chain_id'] = ref_chain_id
+                                atomNum['seq_id'] = ref_auth_seq_id
+                                atomNum['auth_seq_id'] = test_seq_id
+
                 if self.__reasons is None and any(f for f in self.__f if 'Missing data' in f):
                     if len(self.unambigAtomNameMapping) > 0:
                         if 'unambig_atom_id_remap' not in self.reasonsForReParsing:
                             self.reasonsForReParsing['unambig_atom_id_remap'] = self.unambigAtomNameMapping
                     if len(self.ambigAtomNameMapping) > 0:
                         if 'ambig_atom_id_remap' not in self.reasonsForReParsing:
                             self.reasonsForReParsing['ambig_atom_id_remap'] = self.ambigAtomNameMapping
@@ -1226,19 +1267,19 @@
                                     if self.__createSfDict and sf is not None:
                                         sf['index_id'] += 1
                                         sf['loop']['data'].append([sf['index_id'], sf['id'],
                                                                    atom1['chain_id'], atom1['seq_id'], atom1['comp_id'], atom1['atom_id'],
                                                                    atom2['chain_id'], atom2['seq_id'], atom2['comp_id'], atom2['atom_id'],
                                                                    atom3['chain_id'], atom3['seq_id'], atom3['comp_id'], atom3['atom_id'],
                                                                    atom4['chain_id'], atom4['seq_id'], atom4['comp_id'], atom4['atom_id'],
-                                                                   dstFunc['target_value'] if 'target_value' in dstFunc else None, None,
-                                                                   dstFunc['lower_linear_limit'] if 'lower_linear_limit' in dstFunc else None,
-                                                                   dstFunc['lower_limit'] if 'lower_limit' in dstFunc else None,
-                                                                   dstFunc['upper_limit'] if 'upper_limit' in dstFunc else None,
-                                                                   dstFunc['upper_linear_limit'] if 'upper_linear_limit' in dstFunc else None,
+                                                                   dstFunc.get('target_value'), None,
+                                                                   dstFunc.get('lower_linear_limit'),
+                                                                   dstFunc.get('lower_limit'),
+                                                                   dstFunc.get('upper_limit'),
+                                                                   dstFunc.get('upper_linear_limit'),
                                                                    self.inGenDist_weight[0], self.inGenDist_weight[1],
                                                                    sf['list_id'], self.__entryId])
 
                             # generalized distance 3
                             elif lenIat == COL_DIST_COORD3:
 
                                 if self.__createSfDict:
@@ -1275,19 +1316,19 @@
                                         sf['loop']['data'].append([sf['index_id'], sf['id'],
                                                                    atom1['chain_id'], atom1['seq_id'], atom1['comp_id'], atom1['atom_id'],
                                                                    atom2['chain_id'], atom2['seq_id'], atom2['comp_id'], atom2['atom_id'],
                                                                    atom3['chain_id'], atom3['seq_id'], atom3['comp_id'], atom3['atom_id'],
                                                                    atom4['chain_id'], atom4['seq_id'], atom4['comp_id'], atom4['atom_id'],
                                                                    atom5['chain_id'], atom5['seq_id'], atom5['comp_id'], atom5['atom_id'],
                                                                    atom6['chain_id'], atom6['seq_id'], atom6['comp_id'], atom6['atom_id'],
-                                                                   dstFunc['target_value'] if 'target_value' in dstFunc else None, None,
-                                                                   dstFunc['lower_linear_limit'] if 'lower_linear_limit' in dstFunc else None,
-                                                                   dstFunc['lower_limit'] if 'lower_limit' in dstFunc else None,
-                                                                   dstFunc['upper_limit'] if 'upper_limit' in dstFunc else None,
-                                                                   dstFunc['upper_linear_limit'] if 'upper_linear_limit' in dstFunc else None,
+                                                                   dstFunc.get('target_value'), None,
+                                                                   dstFunc.get('lower_linear_limit'),
+                                                                   dstFunc.get('lower_limit'),
+                                                                   dstFunc.get('upper_limit'),
+                                                                   dstFunc.get('upper_linear_limit'),
                                                                    self.inGenDist_weight[0], self.inGenDist_weight[1], self.inGenDist_weight[2],
                                                                    sf['list_id'], self.__entryId])
 
                             # generalized distance 4
                             else:
 
                                 if self.__createSfDict:
@@ -1331,20 +1372,21 @@
                                                                    atom2['chain_id'], atom2['seq_id'], atom2['comp_id'], atom2['atom_id'],
                                                                    atom3['chain_id'], atom3['seq_id'], atom3['comp_id'], atom3['atom_id'],
                                                                    atom4['chain_id'], atom4['seq_id'], atom4['comp_id'], atom4['atom_id'],
                                                                    atom5['chain_id'], atom5['seq_id'], atom5['comp_id'], atom5['atom_id'],
                                                                    atom6['chain_id'], atom6['seq_id'], atom6['comp_id'], atom6['atom_id'],
                                                                    atom7['chain_id'], atom7['seq_id'], atom7['comp_id'], atom7['atom_id'],
                                                                    atom8['chain_id'], atom8['seq_id'], atom8['comp_id'], atom8['atom_id'],
-                                                                   dstFunc['target_value'] if 'target_value' in dstFunc else None, None,
-                                                                   dstFunc['lower_linear_limit'] if 'lower_linear_limit' in dstFunc else None,
-                                                                   dstFunc['lower_limit'] if 'lower_limit' in dstFunc else None,
-                                                                   dstFunc['upper_limit'] if 'upper_limit' in dstFunc else None,
-                                                                   dstFunc['upper_linear_limit'] if 'upper_linear_limit' in dstFunc else None,
-                                                                   self.inGenDist_weight[0], self.inGenDist_weight[1], self.inGenDist_weight[2], self.inGenDist_weight[3],
+                                                                   dstFunc.get('target_value'), None,
+                                                                   dstFunc.get('lower_linear_limit'),
+                                                                   dstFunc.get('lower_limit'),
+                                                                   dstFunc.get('upper_limit'),
+                                                                   dstFunc.get('upper_linear_limit'),
+                                                                   self.inGenDist_weight[0], self.inGenDist_weight[1],
+                                                                   self.inGenDist_weight[2], self.inGenDist_weight[3],
                                                                    sf['list_id'], self.__entryId])
 
                             self.rstwt = [0.0, 0.0, 0.0, 0.0]
 
                     # angle
                     elif self.__cur_subtype == 'ang':
                         valid = True
@@ -1383,19 +1425,19 @@
                                       f"atom1={atom1} atom2={atom2} atom3={atom3} {dstFunc}")
                             if self.__createSfDict and sf is not None:
                                 sf['index_id'] += 1
                                 sf['loop']['data'].append([sf['index_id'], sf['id'],
                                                            atom1['chain_id'], atom1['seq_id'], atom1['comp_id'], atom1['atom_id'],
                                                            atom2['chain_id'], atom2['seq_id'], atom2['comp_id'], atom2['atom_id'],
                                                            atom3['chain_id'], atom3['seq_id'], atom3['comp_id'], atom3['atom_id'],
-                                                           dstFunc['target_value'] if 'target_value' in dstFunc else None, None,
-                                                           dstFunc['lower_linear_limit'] if 'lower_linear_limit' in dstFunc else None,
-                                                           dstFunc['lower_limit'] if 'lower_limit' in dstFunc else None,
-                                                           dstFunc['upper_limit'] if 'upper_limit' in dstFunc else None,
-                                                           dstFunc['upper_linear_limit'] if 'upper_linear_limit' in dstFunc else None,
+                                                           dstFunc.get('target_value'), None,
+                                                           dstFunc.get('lower_linear_limit'),
+                                                           dstFunc.get('lower_limit'),
+                                                           dstFunc.get('upper_limit'),
+                                                           dstFunc.get('upper_linear_limit'),
                                                            sf['list_id'], self.__entryId])
 
                     # torsional angle
                     elif self.__cur_subtype == 'dihed':
                         valid = True
                         for col, iat in enumerate(self.iat):
                             if iat < 0:
@@ -1491,19 +1533,19 @@
                                     sf['index_id'] += 1
                                     sf['loop']['data'].append([sf['index_id'], sf['id'],
                                                                atom1['chain_id'], atom1['seq_id'], atom1['comp_id'], atom1['atom_id'],
                                                                atom2['chain_id'], atom2['seq_id'], atom2['comp_id'], atom2['atom_id'],
                                                                atom3['chain_id'], atom3['seq_id'], atom3['comp_id'], atom3['atom_id'],
                                                                atom4['chain_id'], atom4['seq_id'], atom4['comp_id'], atom4['atom_id'],
                                                                atom5['chain_id'], atom5['seq_id'], atom5['comp_id'], atom5['atom_id'],
-                                                               dstFunc['target_value'] if 'target_value' in dstFunc else None, None,
-                                                               dstFunc['lower_linear_limit'] if 'lower_linear_limit' in dstFunc else None,
-                                                               dstFunc['lower_limit'] if 'lower_limit' in dstFunc else None,
-                                                               dstFunc['upper_limit'] if 'upper_limit' in dstFunc else None,
-                                                               dstFunc['upper_linear_limit'] if 'upper_linear_limit' in dstFunc else None,
+                                                               dstFunc.get('target_value'), None,
+                                                               dstFunc.get('lower_linear_limit'),
+                                                               dstFunc.get('lower_limit'),
+                                                               dstFunc.get('upper_limit'),
+                                                               dstFunc.get('upper_linear_limit'),
                                                                sf['list_id'], self.__entryId])
 
                         # plane-plane angle
                         else:
 
                             if self.__createSfDict:
                                 sf = self.__getSf('AMBER plane-plane angle restraint')
@@ -1542,19 +1584,19 @@
                                                                atom2['chain_id'], atom2['seq_id'], atom2['comp_id'], atom2['atom_id'],
                                                                atom3['chain_id'], atom3['seq_id'], atom3['comp_id'], atom3['atom_id'],
                                                                atom4['chain_id'], atom4['seq_id'], atom4['comp_id'], atom4['atom_id'],
                                                                atom5['chain_id'], atom5['seq_id'], atom5['comp_id'], atom5['atom_id'],
                                                                atom6['chain_id'], atom6['seq_id'], atom6['comp_id'], atom6['atom_id'],
                                                                atom7['chain_id'], atom7['seq_id'], atom7['comp_id'], atom7['atom_id'],
                                                                atom8['chain_id'], atom8['seq_id'], atom8['comp_id'], atom8['atom_id'],
-                                                               dstFunc['target_value'] if 'target_value' in dstFunc else None, None,
-                                                               dstFunc['lower_linear_limit'] if 'lower_linear_limit' in dstFunc else None,
-                                                               dstFunc['lower_limit'] if 'lower_limit' in dstFunc else None,
-                                                               dstFunc['upper_limit'] if 'upper_limit' in dstFunc else None,
-                                                               dstFunc['upper_linear_limit'] if 'upper_linear_limit' in dstFunc else None,
+                                                               dstFunc.get('target_value'), None,
+                                                               dstFunc.get('lower_linear_limit'),
+                                                               dstFunc.get('lower_limit'),
+                                                               dstFunc.get('upper_limit'),
+                                                               dstFunc.get('upper_linear_limit'),
                                                                sf['list_id'], self.__entryId])
 
                 # try to update AMBER atom number dictionary based on Sander comments
                 elif self.__hasPolySeq and self.iresid == 0:
 
                     self.__hasComments = True
 
@@ -2121,19 +2163,19 @@
                                     if self.__createSfDict and sf is not None:
                                         sf['index_id'] += 1
                                         sf['loop']['data'].append([sf['index_id'], sf['id'],
                                                                    atom1['chain_id'], atom1['seq_id'], atom1['comp_id'], atom1['atom_id'],
                                                                    atom2['chain_id'], atom2['seq_id'], atom2['comp_id'], atom2['atom_id'],
                                                                    atom3['chain_id'], atom3['seq_id'], atom3['comp_id'], atom3['atom_id'],
                                                                    atom4['chain_id'], atom4['seq_id'], atom4['comp_id'], atom4['atom_id'],
-                                                                   dstFunc['target_value'] if 'target_value' in dstFunc else None, None,
-                                                                   dstFunc['lower_linear_limit'] if 'lower_linear_limit' in dstFunc else None,
-                                                                   dstFunc['lower_limit'] if 'lower_limit' in dstFunc else None,
-                                                                   dstFunc['upper_limit'] if 'upper_limit' in dstFunc else None,
-                                                                   dstFunc['upper_linear_limit'] if 'upper_linear_limit' in dstFunc else None,
+                                                                   dstFunc.get('target_value'), None,
+                                                                   dstFunc.get('lower_linear_limit'),
+                                                                   dstFunc.get('lower_limit'),
+                                                                   dstFunc.get('upper_limit'),
+                                                                   dstFunc.get('upper_linear_limit'),
                                                                    self.inGenDist_weight[0], self.inGenDist_weight[1],
                                                                    sf['list_id'], self.__entryId])
 
                             # generalized distance 3
                             elif lenWeight == 3:
 
                                 if self.__createSfDict:
@@ -2170,19 +2212,19 @@
                                         sf['loop']['data'].append([sf['index_id'], sf['id'],
                                                                    atom1['chain_id'], atom1['seq_id'], atom1['comp_id'], atom1['atom_id'],
                                                                    atom2['chain_id'], atom2['seq_id'], atom2['comp_id'], atom2['atom_id'],
                                                                    atom3['chain_id'], atom3['seq_id'], atom3['comp_id'], atom3['atom_id'],
                                                                    atom4['chain_id'], atom4['seq_id'], atom4['comp_id'], atom4['atom_id'],
                                                                    atom5['chain_id'], atom5['seq_id'], atom5['comp_id'], atom5['atom_id'],
                                                                    atom6['chain_id'], atom6['seq_id'], atom6['comp_id'], atom6['atom_id'],
-                                                                   dstFunc['target_value'] if 'target_value' in dstFunc else None, None,
-                                                                   dstFunc['lower_linear_limit'] if 'lower_linear_limit' in dstFunc else None,
-                                                                   dstFunc['lower_limit'] if 'lower_limit' in dstFunc else None,
-                                                                   dstFunc['upper_limit'] if 'upper_limit' in dstFunc else None,
-                                                                   dstFunc['upper_linear_limit'] if 'upper_linear_limit' in dstFunc else None,
+                                                                   dstFunc.get('target_value'), None,
+                                                                   dstFunc.get('lower_linear_limit'),
+                                                                   dstFunc.get('lower_limit'),
+                                                                   dstFunc.get('upper_limit'),
+                                                                   dstFunc.get('upper_linear_limit'),
                                                                    self.inGenDist_weight[0], self.inGenDist_weight[1], self.inGenDist_weight[2],
                                                                    sf['list_id'], self.__entryId])
 
                             # generalized distance 4
                             else:
 
                                 if self.__createSfDict:
@@ -2226,20 +2268,21 @@
                                                                    atom2['chain_id'], atom2['seq_id'], atom2['comp_id'], atom2['atom_id'],
                                                                    atom3['chain_id'], atom3['seq_id'], atom3['comp_id'], atom3['atom_id'],
                                                                    atom4['chain_id'], atom4['seq_id'], atom4['comp_id'], atom4['atom_id'],
                                                                    atom5['chain_id'], atom5['seq_id'], atom5['comp_id'], atom5['atom_id'],
                                                                    atom6['chain_id'], atom6['seq_id'], atom6['comp_id'], atom6['atom_id'],
                                                                    atom7['chain_id'], atom7['seq_id'], atom7['comp_id'], atom7['atom_id'],
                                                                    atom8['chain_id'], atom8['seq_id'], atom8['comp_id'], atom8['atom_id'],
-                                                                   dstFunc['target_value'] if 'target_value' in dstFunc else None, None,
-                                                                   dstFunc['lower_linear_limit'] if 'lower_linear_limit' in dstFunc else None,
-                                                                   dstFunc['lower_limit'] if 'lower_limit' in dstFunc else None,
-                                                                   dstFunc['upper_limit'] if 'upper_limit' in dstFunc else None,
-                                                                   dstFunc['upper_linear_limit'] if 'upper_linear_limit' in dstFunc else None,
-                                                                   self.inGenDist_weight[0], self.inGenDist_weight[1], self.inGenDist_weight[2], self.inGenDist_weight[3],
+                                                                   dstFunc.get('target_value'), None,
+                                                                   dstFunc.get('lower_linear_limit'),
+                                                                   dstFunc.get('lower_limit'),
+                                                                   dstFunc.get('upper_limit'),
+                                                                   dstFunc.get('upper_linear_limit'),
+                                                                   self.inGenDist_weight[0], self.inGenDist_weight[1],
+                                                                   self.inGenDist_weight[2], self.inGenDist_weight[3],
                                                                    sf['list_id'], self.__entryId])
 
                             self.rstwt = [0.0, 0.0, 0.0, 0.0]
 
                     # angle
                     elif self.__cur_subtype == 'ang':
                         valid = True
@@ -2284,19 +2327,19 @@
                                       f"atom1={atom1} atom2={atom2} atom3={atom3} {dstFunc}")
                             if self.__createSfDict and sf is not None:
                                 sf['index_id'] += 1
                                 sf['loop']['data'].append([sf['index_id'], sf['id'],
                                                            atom1['chain_id'], atom1['seq_id'], atom1['comp_id'], atom1['atom_id'],
                                                            atom2['chain_id'], atom2['seq_id'], atom2['comp_id'], atom2['atom_id'],
                                                            atom3['chain_id'], atom3['seq_id'], atom3['comp_id'], atom3['atom_id'],
-                                                           dstFunc['target_value'] if 'target_value' in dstFunc else None, None,
-                                                           dstFunc['lower_linear_limit'] if 'lower_linear_limit' in dstFunc else None,
-                                                           dstFunc['lower_limit'] if 'lower_limit' in dstFunc else None,
-                                                           dstFunc['upper_limit'] if 'upper_limit' in dstFunc else None,
-                                                           dstFunc['upper_linear_limit'] if 'upper_linear_limit' in dstFunc else None,
+                                                           dstFunc.get('target_value'), None,
+                                                           dstFunc.get('lower_linear_limit'),
+                                                           dstFunc.get('lower_limit'),
+                                                           dstFunc.get('upper_limit'),
+                                                           dstFunc.get('upper_linear_limit'),
                                                            sf['list_id'], self.__entryId])
 
                     # torsional angle
                     elif self.__cur_subtype == 'dihed':
                         valid = True
                         for col, funcExpr in enumerate(self.funcExprs):
                             if isinstance(funcExpr, list):
@@ -2402,19 +2445,19 @@
                                     sf['index_id'] += 1
                                     sf['loop']['data'].append([sf['index_id'], sf['id'],
                                                                atom1['chain_id'], atom1['seq_id'], atom1['comp_id'], atom1['atom_id'],
                                                                atom2['chain_id'], atom2['seq_id'], atom2['comp_id'], atom2['atom_id'],
                                                                atom3['chain_id'], atom3['seq_id'], atom3['comp_id'], atom3['atom_id'],
                                                                atom4['chain_id'], atom4['seq_id'], atom4['comp_id'], atom4['atom_id'],
                                                                atom5['chain_id'], atom5['seq_id'], atom5['comp_id'], atom5['atom_id'],
-                                                               dstFunc['target_value'] if 'target_value' in dstFunc else None, None,
-                                                               dstFunc['lower_linear_limit'] if 'lower_linear_limit' in dstFunc else None,
-                                                               dstFunc['lower_limit'] if 'lower_limit' in dstFunc else None,
-                                                               dstFunc['upper_limit'] if 'upper_limit' in dstFunc else None,
-                                                               dstFunc['upper_linear_limit'] if 'upper_linear_limit' in dstFunc else None,
+                                                               dstFunc.get('target_value'), None,
+                                                               dstFunc.get('lower_linear_limit'),
+                                                               dstFunc.get('lower_limit'),
+                                                               dstFunc.get('upper_limit'),
+                                                               dstFunc.get('upper_linear_limit'),
                                                                sf['list_id'], self.__entryId])
 
                         # plane-plane angle
                         else:
 
                             # 2nd plane
                             for col, funcExpr in enumerate(self.inPlane_funcExprs2, 4):
@@ -2483,19 +2526,19 @@
                                                                atom2['chain_id'], atom2['seq_id'], atom2['comp_id'], atom2['atom_id'],
                                                                atom3['chain_id'], atom3['seq_id'], atom3['comp_id'], atom3['atom_id'],
                                                                atom4['chain_id'], atom4['seq_id'], atom4['comp_id'], atom4['atom_id'],
                                                                atom5['chain_id'], atom5['seq_id'], atom5['comp_id'], atom5['atom_id'],
                                                                atom6['chain_id'], atom6['seq_id'], atom6['comp_id'], atom6['atom_id'],
                                                                atom7['chain_id'], atom7['seq_id'], atom7['comp_id'], atom7['atom_id'],
                                                                atom8['chain_id'], atom8['seq_id'], atom8['comp_id'], atom8['atom_id'],
-                                                               dstFunc['target_value'] if 'target_value' in dstFunc else None, None,
-                                                               dstFunc['lower_linear_limit'] if 'lower_linear_limit' in dstFunc else None,
-                                                               dstFunc['lower_limit'] if 'lower_limit' in dstFunc else None,
-                                                               dstFunc['upper_limit'] if 'upper_limit' in dstFunc else None,
-                                                               dstFunc['upper_linear_limit'] if 'upper_linear_limit' in dstFunc else None,
+                                                               dstFunc.get('target_value'), None,
+                                                               dstFunc.get('lower_linear_limit'),
+                                                               dstFunc.get('lower_limit'),
+                                                               dstFunc.get('upper_limit'),
+                                                               dstFunc.get('upper_linear_limit'),
                                                                sf['list_id'], self.__entryId])
 
                 # try to update AMBER atom number dictionary based on Sander comments
                 elif self.__hasPolySeq:
 
                     if self.__cur_subtype == 'dist' and not self.inGenDist:
                         subtype_name = 'distance restraint'
```

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/AmberMRReader.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/AmberMRReader.py`

 * *Files 1% similar despite different names*

```diff
@@ -303,14 +303,20 @@
             if isFilePath and ifh is not None:
                 ifh.close()
 
 
 if __name__ == "__main__":
     reader = AmberMRReader(True)
     reader.setDebugMode(True)
+    reader.parse('../../tests-nmr/mock-data-remediation/2kwq/2kwq-trimmed.mr',
+                 '../../tests-nmr/mock-data-remediation/2kwq/2kwq.cif',
+                 None)
+
+    reader = AmberMRReader(True)
+    reader.setDebugMode(True)
     reader.parse('../../tests-nmr/mock-data-remediation/6sdw/RST_34_test',
                  '../../tests-nmr/mock-data-remediation/6sdw/6sdw.cif',
                  '../../tests-nmr/mock-data-remediation/6sdw/prmtop_34')
 
     reader = AmberMRReader(True)
     reader.setDebugMode(True)
     reader.parse('../../tests-nmr/mock-data-remediation/7n7e/dihedral.amber',
```

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/AmberPTLexer.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/AmberPTLexer.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/AmberPTParser.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/AmberPTParser.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/AmberPTParserListener.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/AmberPTParserListener.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/AmberPTReader.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/AmberPTReader.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/BiosymMRLexer.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/BiosymMRLexer.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/BiosymMRParser.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/BiosymMRParser.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/BiosymMRParserListener.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/BiosymMRParserListener.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/BiosymMRReader.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/BiosymMRReader.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/CharmmMRLexer.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/CharmmMRLexer.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/CharmmMRParser.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/CharmmMRParser.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/CharmmMRParserListener.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/CharmmMRParserListener.py`

 * *Files 0% similar despite different names*

```diff
@@ -2853,31 +2853,35 @@
                                         if _coordAtomSite is not None:
                                             _compId = _coordAtomSite['comp_id']
                                             _atomId = self.getAtomIdList(_factor, _compId, atomId)[0]
                                             if _atomId in _coordAtomSite['atom_id']:
                                                 _atom = {}
                                                 _atom['comp_id'] = _compId
                                                 _atom['type_symbol'] = _coordAtomSite['type_symbol'][_coordAtomSite['atom_id'].index(_atomId)]
+                                                """
                                                 self.__preferAuthSeq = False
                                                 self.__authSeqId = 'label_seq_id'
                                                 seqKey = _seqKey
                                                 chainId, seqId = seqKey
                                                 if len(self.atomSelectionSet) > 0:
                                                     self.__setLocalSeqScheme()
+                                                """
                                             elif 'alt_atom_id' in _coordAtomSite and _atomId in _coordAtomSite['alt_atom_id']:
                                                 _atom = {}
                                                 _atom['comp_id'] = _compId
                                                 _atom['type_symbol'] = _coordAtomSite['type_symbol'][_coordAtomSite['alt_atom_id'].index(_atomId)]
+                                                """
                                                 self.__preferAuthSeq = False
                                                 self.__authSeqId = 'label_seq_id'
                                                 self.__authAtomId = 'auth_atom_id'
                                                 seqKey = _seqKey
                                                 chainId, seqId = seqKey
                                                 if len(self.atomSelectionSet) > 0:
                                                     self.__setLocalSeqScheme()
+                                                """
                                     elif _seqId_ in ps['auth_seq_id'] and atomSpecified:
                                         self.__preferAuthSeq = True
                                         _seqKey, _coordAtomSite = self.getCoordAtomSiteOf(chainId, _seqId_, cifCheck)
                                         if _coordAtomSite is not None:
                                             _compId = _coordAtomSite['comp_id']
                                             _atomId = self.getAtomIdList(_factor, _compId, atomId)[0]
                                             if _atomId in _coordAtomSite['atom_id']:
@@ -2910,31 +2914,35 @@
                                         if _coordAtomSite is not None:
                                             _compId = _coordAtomSite['comp_id']
                                             _atomId = self.getAtomIdList(_factor, _compId, atomId)[0]
                                             if _atomId in _coordAtomSite['atom_id']:
                                                 _atom = {}
                                                 _atom['comp_id'] = _compId
                                                 _atom['type_symbol'] = _coordAtomSite['type_symbol'][_coordAtomSite['atom_id'].index(_atomId)]
+                                                """
                                                 self.__preferAuthSeq = False
                                                 self.__authSeqId = 'label_seq_id'
                                                 seqKey = _seqKey
                                                 chainId, seqId = seqKey
                                                 if len(self.atomSelectionSet) > 0:
                                                     self.__setLocalSeqScheme()
+                                                """
                                             elif 'alt_atom_id' in _coordAtomSite and _atomId in _coordAtomSite['alt_atom_id']:
                                                 _atom = {}
                                                 _atom['comp_id'] = _compId
                                                 _atom['type_symbol'] = _coordAtomSite['type_symbol'][_coordAtomSite['alt_atom_id'].index(_atomId)]
+                                                """
                                                 self.__preferAuthSeq = False
                                                 self.__authSeqId = 'label_seq_id'
                                                 self.__authAtomId = 'auth_atom_id'
                                                 seqKey = _seqKey
                                                 chainId, seqId = seqKey
                                                 if len(self.atomSelectionSet) > 0:
                                                     self.__setLocalSeqScheme()
+                                                """
                                 elif _seqId_ in ps['auth_seq_id'] and atomSpecified:
                                     if len(self.atomSelectionSet) == 0:
                                         self.__preferAuthSeq = True
                                         _seqKey, _coordAtomSite = self.getCoordAtomSiteOf(chainId, _seqId_, cifCheck)
                                         if _coordAtomSite is not None:
                                             _compId = _coordAtomSite['comp_id']
                                             _atomId = self.getAtomIdList(_factor, _compId, atomId)[0]
```

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/CharmmMRReader.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/CharmmMRReader.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/CnsMRLexer.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/CnsMRLexer.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/CnsMRParser.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/CnsMRParser.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/CnsMRParserListener.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/CnsMRParserListener.py`

 * *Files 0% similar despite different names*

```diff
@@ -5029,31 +5029,35 @@
                                         if _coordAtomSite is not None:
                                             _compId = _coordAtomSite['comp_id']
                                             _atomId = self.getAtomIdList(_factor, _compId, atomId)[0]
                                             if _atomId in _coordAtomSite['atom_id']:
                                                 _atom = {}
                                                 _atom['comp_id'] = _compId
                                                 _atom['type_symbol'] = _coordAtomSite['type_symbol'][_coordAtomSite['atom_id'].index(_atomId)]
+                                                """
                                                 self.__preferAuthSeq = False
                                                 self.__authSeqId = 'label_seq_id'
                                                 seqKey = _seqKey
                                                 chainId, seqId = seqKey
                                                 if len(self.atomSelectionSet) > 0:
                                                     self.__setLocalSeqScheme()
+                                                """
                                             elif 'alt_atom_id' in _coordAtomSite and _atomId in _coordAtomSite['alt_atom_id']:
                                                 _atom = {}
                                                 _atom['comp_id'] = _compId
                                                 _atom['type_symbol'] = _coordAtomSite['type_symbol'][_coordAtomSite['alt_atom_id'].index(_atomId)]
+                                                """
                                                 self.__preferAuthSeq = False
                                                 self.__authSeqId = 'label_seq_id'
                                                 self.__authAtomId = 'auth_atom_id'
                                                 seqKey = _seqKey
                                                 chainId, seqId = seqKey
                                                 if len(self.atomSelectionSet) > 0:
                                                     self.__setLocalSeqScheme()
+                                                """
                                     elif _seqId_ in ps['auth_seq_id'] and atomSpecified:
                                         self.__preferAuthSeq = True
                                         _seqKey, _coordAtomSite = self.getCoordAtomSiteOf(chainId, _seqId_, cifCheck)
                                         if _coordAtomSite is not None:
                                             _compId = _coordAtomSite['comp_id']
                                             _atomId = self.getAtomIdList(_factor, _compId, atomId)[0]
                                             if _atomId in _coordAtomSite['atom_id']:
@@ -5086,31 +5090,35 @@
                                         if _coordAtomSite is not None:
                                             _compId = _coordAtomSite['comp_id']
                                             _atomId = self.getAtomIdList(_factor, _compId, atomId)[0]
                                             if _atomId in _coordAtomSite['atom_id']:
                                                 _atom = {}
                                                 _atom['comp_id'] = _compId
                                                 _atom['type_symbol'] = _coordAtomSite['type_symbol'][_coordAtomSite['atom_id'].index(_atomId)]
+                                                """
                                                 self.__preferAuthSeq = False
                                                 self.__authSeqId = 'label_seq_id'
                                                 seqKey = _seqKey
                                                 chainId, seqId = seqKey
                                                 if len(self.atomSelectionSet) > 0:
                                                     self.__setLocalSeqScheme()
+                                                """
                                             elif 'alt_atom_id' in _coordAtomSite and _atomId in _coordAtomSite['alt_atom_id']:
                                                 _atom = {}
                                                 _atom['comp_id'] = _compId
                                                 _atom['type_symbol'] = _coordAtomSite['type_symbol'][_coordAtomSite['alt_atom_id'].index(_atomId)]
+                                                """
                                                 self.__preferAuthSeq = False
                                                 self.__authSeqId = 'label_seq_id'
                                                 self.__authAtomId = 'auth_atom_id'
                                                 seqKey = _seqKey
                                                 chainId, seqId = seqKey
                                                 if len(self.atomSelectionSet) > 0:
                                                     self.__setLocalSeqScheme()
+                                                """
                                 elif _seqId_ in ps['auth_seq_id'] and atomSpecified:
                                     if len(self.atomSelectionSet) == 0:
                                         self.__preferAuthSeq = True
                                         _seqKey, _coordAtomSite = self.getCoordAtomSiteOf(chainId, _seqId_, cifCheck)
                                         if _coordAtomSite is not None:
                                             _compId = _coordAtomSite['comp_id']
                                             _atomId = self.getAtomIdList(_factor, _compId, atomId)[0]
```

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/CnsMRReader.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/CnsMRReader.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/CyanaMRLexer.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/CyanaMRLexer.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/CyanaMRParser.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/CyanaMRParser.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/CyanaMRParserListener.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/CyanaMRParserListener.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/CyanaMRReader.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/CyanaMRReader.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/DynamoMRLexer.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/DynamoMRLexer.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/DynamoMRParser.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/DynamoMRParser.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/DynamoMRParserListener.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/DynamoMRParserListener.py`

 * *Files 0% similar despite different names*

```diff
@@ -3710,33 +3710,36 @@
                     ps = next(ps for ps in self.__polySeq if ps['auth_chain_id'] == chainId)
 
                     for atomId, offset in zip(atomNames, seqOffset):
 
                         atomSelection = []
 
                         _cifSeqId = cifSeqId + offset
-                        _cifCompId = cifCompId if offset == 0 else (ps['comp_id'][ps['auth_seq_id'].index(_cifSeqId)] if _cifSeqId in ps['auth_seq_id'] else None)
+                        _cifCompId = cifCompId if offset == 0 else (ps['comp_id'][ps['auth_seq_id'].index(_cifSeqId)]
+                                                                    if _cifSeqId in ps['auth_seq_id'] else None)
 
                         if _cifCompId is None:
                             try:
                                 _cifCompId = ps['comp_id'][ps['auth_seq_id'].index(cifSeqId) + offset]
                             except IndexError:
                                 pass
                             if _cifCompId is None:
                                 self.__f.append(f"[Sequence mismatch warning] {self.__getCurrentRestraint()}"
-                                                f"The residue number '{seqId+offset}' is not present in polymer sequence of chain {chainId} of the coordinates. "
+                                                f"The residue number '{seqId+offset}' is not present in polymer sequence "
+                                                f"of chain {chainId} of the coordinates. "
                                                 "Please update the sequence in the Macromolecules page.")
                                 return
                                 # _cifCompId = '.'
                             cifAtomId = atomId
 
                         else:
                             self.__ccU.updateChemCompDict(_cifCompId)
 
-                            cifAtomId = next((cca[self.__ccU.ccaAtomId] for cca in self.__ccU.lastAtomList if cca[self.__ccU.ccaAtomId] == atomId), None)
+                            cifAtomId = next((cca[self.__ccU.ccaAtomId] for cca in self.__ccU.lastAtomList
+                                              if cca[self.__ccU.ccaAtomId] == atomId), None)
 
                             if cifAtomId is None:
                                 self.__f.append(f"[Atom not found] {self.__getCurrentRestraint()}"
                                                 f"{seqId+offset}:{compId}:{atomId} is not present in the coordinates.")
                                 return
 
                         atomSelection.append({'chain_id': chainId, 'seq_id': _cifSeqId, 'comp_id': _cifCompId, 'atom_id': cifAtomId})
@@ -3887,33 +3890,36 @@
                     ps = next(ps for ps in self.__polySeq if ps['auth_chain_id'] == chainId)
 
                     for atomId, offset in zip(atomNames, seqOffset):
 
                         atomSelection = []
 
                         _cifSeqId = cifSeqId + offset
-                        _cifCompId = cifCompId if offset == 0 else (ps['comp_id'][ps['auth_seq_id'].index(_cifSeqId)] if _cifSeqId in ps['auth_seq_id'] else None)
+                        _cifCompId = cifCompId if offset == 0 else (ps['comp_id'][ps['auth_seq_id'].index(_cifSeqId)]
+                                                                    if _cifSeqId in ps['auth_seq_id'] else None)
 
                         if _cifCompId is None:
                             try:
                                 _cifCompId = ps['comp_id'][ps['auth_seq_id'].index(cifSeqId) + offset]
                             except IndexError:
                                 pass
                             if _cifCompId is None:
                                 self.__f.append(f"[Sequence mismatch warning] {self.__getCurrentRestraint()}"
-                                                f"The residue number '{seqId+offset}' is not present in polymer sequence of chain {chainId} of the coordinates. "
+                                                f"The residue number '{seqId+offset}' is not present in polymer sequence "
+                                                f"of chain {chainId} of the coordinates. "
                                                 "Please update the sequence in the Macromolecules page.")
                                 return
                                 # _cifCompId = '.'
                             cifAtomId = atomId
 
                         else:
                             self.__ccU.updateChemCompDict(_cifCompId)
 
-                            cifAtomId = next((cca[self.__ccU.ccaAtomId] for cca in self.__ccU.lastAtomList if cca[self.__ccU.ccaAtomId] == atomId), None)
+                            cifAtomId = next((cca[self.__ccU.ccaAtomId] for cca in self.__ccU.lastAtomList
+                                              if cca[self.__ccU.ccaAtomId] == atomId), None)
 
                             if cifAtomId is None:
                                 self.__f.append(f"[Atom not found] {self.__getCurrentRestraint()}"
                                                 f"{seqId+offset}:{compId}:{atomId} is not present in the coordinates.")
                                 return
 
                         atomSelection.append({'chain_id': chainId, 'seq_id': _cifSeqId, 'comp_id': _cifCompId, 'atom_id': cifAtomId})
```

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/DynamoMRReader.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/DynamoMRReader.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/GromacsMRLexer.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/GromacsMRLexer.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/GromacsMRParser.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/GromacsMRParser.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/GromacsMRParserListener.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/GromacsMRParserListener.py`

 * *Files 5% similar despite different names*

```diff
@@ -1189,19 +1189,19 @@
                               f"atom1={atom1} atom2={atom2} atom3={atom3} {dstFunc}")
                     if self.__createSfDict and sf is not None:
                         sf['index_id'] += 1
                         sf['loop']['data'].append([sf['index_id'], sf['id'],
                                                    atom1['chain_id'], atom1['seq_id'], atom1['comp_id'], atom1['atom_id'],
                                                    atom2['chain_id'], atom2['seq_id'], atom2['comp_id'], atom2['atom_id'],
                                                    atom3['chain_id'], atom3['seq_id'], atom3['comp_id'], atom3['atom_id'],
-                                                   dstFunc['target_value'] if 'target_value' in dstFunc else None, None,
-                                                   dstFunc['lower_linear_limit'] if 'lower_linear_limit' in dstFunc else None,
-                                                   dstFunc['lower_limit'] if 'lower_limit' in dstFunc else None,
-                                                   dstFunc['upper_limit'] if 'upper_limit' in dstFunc else None,
-                                                   dstFunc['upper_linear_limit'] if 'upper_linear_limit' in dstFunc else None,
+                                                   dstFunc.get('target_value'), None,
+                                                   dstFunc.get('lower_linear_limit'),
+                                                   dstFunc.get('lower_limit'),
+                                                   dstFunc.get('upper_limit'),
+                                                   dstFunc.get('upper_linear_limit'),
                                                    mult,
                                                    sf['list_id'], self.__entryId])
 
             else:
 
                 for atom1, atom2, atom3, atom4 in itertools.product(self.atomSelectionSet[0],
                                                                     self.atomSelectionSet[1],
@@ -1215,19 +1215,19 @@
                     if self.__createSfDict and sf is not None:
                         sf['index_id'] += 1
                         sf['loop']['data'].append([sf['index_id'], sf['id'],
                                                    atom1['chain_id'], atom1['seq_id'], atom1['comp_id'], atom1['atom_id'],
                                                    atom2['chain_id'], atom2['seq_id'], atom2['comp_id'], atom2['atom_id'],
                                                    atom3['chain_id'], atom3['seq_id'], atom3['comp_id'], atom3['atom_id'],
                                                    atom4['chain_id'], atom4['seq_id'], atom4['comp_id'], atom4['atom_id'],
-                                                   dstFunc['target_value'] if 'target_value' in dstFunc else None, None,
-                                                   dstFunc['lower_linear_limit'] if 'lower_linear_limit' in dstFunc else None,
-                                                   dstFunc['lower_limit'] if 'lower_limit' in dstFunc else None,
-                                                   dstFunc['upper_limit'] if 'upper_limit' in dstFunc else None,
-                                                   dstFunc['upper_linear_limit'] if 'upper_linear_limit' in dstFunc else None,
+                                                   dstFunc.get('target_value'), None,
+                                                   dstFunc.get('lower_linear_limit'),
+                                                   dstFunc.get('lower_limit'),
+                                                   dstFunc.get('upper_limit'),
+                                                   dstFunc.get('upper_linear_limit'),
                                                    mult,
                                                    sf['list_id'], self.__entryId])
 
         except ValueError:
             self.angRestraints -= 1
         finally:
             self.numberSelection.clear()
@@ -1343,19 +1343,19 @@
                     print(f"subtype={self.__cur_subtype} id={self.angRestraints} mult={mult} "
                           f"atom1={atom1} atom2={atom2} z-axis {dstFunc}")
                 if self.__createSfDict and sf is not None:
                     sf['index_id'] += 1
                     sf['loop']['data'].append([sf['index_id'], sf['id'],
                                                atom1['chain_id'], atom1['seq_id'], atom1['comp_id'], atom1['atom_id'],
                                                atom2['chain_id'], atom2['seq_id'], atom2['comp_id'], atom2['atom_id'],
-                                               dstFunc['target_value'] if 'target_value' in dstFunc else None, None,
-                                               dstFunc['lower_linear_limit'] if 'lower_linear_limit' in dstFunc else None,
-                                               dstFunc['lower_limit'] if 'lower_limit' in dstFunc else None,
-                                               dstFunc['upper_limit'] if 'upper_limit' in dstFunc else None,
-                                               dstFunc['upper_linear_limit'] if 'upper_linear_limit' in dstFunc else None,
+                                               dstFunc.get('target_value'), None,
+                                               dstFunc.get('lower_linear_limit'),
+                                               dstFunc.get('lower_limit'),
+                                               dstFunc.get('upper_limit'),
+                                               dstFunc.get('upper_linear_limit'),
                                                mult,
                                                sf['list_id'], self.__entryId])
 
         except ValueError:
             self.angRestraints -= 1
         finally:
             self.numberSelection.clear()
```

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/GromacsMRReader.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/GromacsMRReader.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/GromacsPTLexer.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/GromacsPTLexer.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/GromacsPTParser.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/GromacsPTParser.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/GromacsPTParserListener.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/GromacsPTParserListener.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/GromacsPTReader.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/GromacsPTReader.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/IsdMRLexer.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/IsdMRLexer.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/IsdMRParser.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/IsdMRParser.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/IsdMRParserListener.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/IsdMRParserListener.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/IsdMRReader.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/IsdMRReader.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/LexerErrorListener.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/LexerErrorListener.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/ParserErrorListener.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/ParserErrorListener.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/ParserListenerUtil.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/ParserListenerUtil.py`

 * *Files 0% similar despite different names*

```diff
@@ -2845,23 +2845,26 @@
         # """ do not use
         # if _compId.endswith('5') or _compId.endswith('3'):
         #     _compId = _compId[:-1]
         #
         #     if _compId in monDict3:
         #         return _compId
         # """
-    if compId in ('HIE', 'HIP', 'HID'):
+    if compId in ('HIE', 'HIP', 'HID', 'HIZ'):
         return 'HIS'
 
     if compId.startswith('CY') and ccU is not None:
         if ccU.updateChemCompDict(compId):
             if ccU.lastChemCompDict['_chem_comp.type'] == 'L-PEPTIDE LINKING'\
                and 'CYSTEINE' in ccU.lastChemCompDict['_chem_comp.name']:
                 return 'CYS'
 
+    if compId == 'CYZ':
+        return 'CYS'
+
     if len(compId) == 3:
         if compId == 'ADE' or compId.startswith('DA'):
             return 'DA'
         if compId == 'CYT' or compId.startswith('DC'):
             return 'DC'
         if compId == 'GUA' or compId.startswith('DG'):
             return 'DG'
@@ -4879,57 +4882,74 @@
             aux_lp.add_tag(tag)
 
         aux_lps.append(aux_lp)
 
     return aux_lps
 
 
-def getStarAtom(authToStarSeq, offsetHolder, atom):
+def getStarAtom(authToStarSeq, offsetHolder, atom, aux_atom=None):
     """ Return NMR-STAR sequence including entity ID for a given auth atom of the cooridnates.
         @return: a dictionary of NMR-STAR sequence/entity, None otherwise
     """
 
     starAtom = copy.copy(atom)
 
     chainId = atom['chain_id']
     seqId = atom['seq_id']
-    compId = atom['comp_id'] if 'comp_id' in atom else None
+    compId = atom.get('comp_id')
     seqKey = (chainId, seqId, compId)
     if 'atom_id' not in atom:
         starAtom['atom_id'] = None
 
-    if seqKey in authToStarSeq:
+    has_aux_atom = False
+    if aux_atom is not None:
+        auxChainId = aux_atom['chain_id']
+        auxSeqId = aux_atom['seq_id']
+        auxCompId = aux_atom.get('comp_id')
+        if chainId == auxChainId and seqId != auxSeqId:
+            auxSeqKey = (auxChainId, auxSeqId, auxCompId)
+            has_aux_atom = True
+
+    if seqKey in authToStarSeq and chainId not in offsetHolder:
         starAtom['chain_id'], starAtom['seq_id'], starAtom['entity_id'], _ = authToStarSeq[seqKey]
         return starAtom
 
     if chainId in offsetHolder:
         offset = offsetHolder[chainId]
         seqKey = (chainId, seqId + offset, compId)
-        if seqKey in authToStarSeq:
+        if has_aux_atom:
+            auxSeqKey = (auxChainId, auxSeqId + offset, auxCompId)
+        if seqKey in authToStarSeq and (not has_aux_atom or (has_aux_atom and auxSeqKey in authToStarSeq)):
             starAtom['chain_id'], starAtom['seq_id'], starAtom['entity_id'], _ = authToStarSeq[seqKey]
             atom['seq_id'] = seqId + offset
             return starAtom
 
     for offset in range(1, 1000):
         seqKey = (chainId, seqId + offset, compId)
-        if seqKey in authToStarSeq:
+        if has_aux_atom:
+            auxSeqKey = (auxChainId, auxSeqId + offset, auxCompId)
+        if seqKey in authToStarSeq and (not has_aux_atom or (has_aux_atom and auxSeqKey in authToStarSeq)):
             starAtom['chain_id'], starAtom['seq_id'], starAtom['entity_id'], _ = authToStarSeq[seqKey]
             offsetHolder[chainId] = offset
             atom['seq_id'] = seqId + offset
             return starAtom
         seqKey = (chainId, seqId - offset, compId)
-        if seqKey in authToStarSeq:
+        if has_aux_atom:
+            auxSeqKey = (auxChainId, auxSeqId + offset, auxCompId)
+        if seqKey in authToStarSeq and (not has_aux_atom or (has_aux_atom and auxSeqKey in authToStarSeq)):
             starAtom['chain_id'], starAtom['seq_id'], starAtom['entity_id'], _ = authToStarSeq[seqKey]
             offsetHolder[chainId] = -offset
             atom['seq_id'] = seqId - offset
             return starAtom
 
     _seqKey = next((_seqKey for _seqKey in authToStarSeq if chainId == _seqKey[0] and seqId == _seqKey[1]), None)
+    if has_aux_atom:
+        _auxSeqKey = next((_auxSeqKey for _auxSeqKey in authToStarSeq if auxChainId == _auxSeqKey[0] and auxSeqId == _auxSeqKey[1]), None)
 
-    if _seqKey is not None:
+    if _seqKey is not None and (not has_aux_atom or (has_aux_atom and _auxSeqKey is not None)):
         if compId in emptyValue or compId not in monDict3:
             starAtom['chain_id'], starAtom['seq_id'], starAtom['entity_id'], _ = authToStarSeq[_seqKey]
             if compId in emptyValue or compId != _seqKey[2]:
                 atom['comp_id'] = starAtom['comp_id'] = _seqKey[2]
             return starAtom
 
     return None
@@ -4941,15 +4961,15 @@
     """
 
     if authToInsCode is None:
         return None
 
     chainId = atom['chain_id']
     seqId = atom['seq_id']
-    compId = atom['comp_id'] if 'comp_id' in atom else None
+    compId = atom.get('comp_id')
     seqKey = (chainId, seqId, compId)
 
     if seqKey in authToInsCode:
         return authToInsCode[seqKey]
 
     if chainId in offsetHolder:
         offset = offsetHolder[chainId]
@@ -5004,33 +5024,33 @@
 
     row[0] = id
 
     star_atom1 = star_atom2 = star_atom3 = star_atom4 = star_atom4 = star_atom5 = None
     ins_code1 = ins_code2 = ins_code3 = ins_code4 = ins_code5 = None
 
     if atom1 is not None:
-        star_atom1 = getStarAtom(authToStarSeq, offsetHolder, atom1)
+        star_atom1 = getStarAtom(authToStarSeq, offsetHolder, atom1, atom2)
         if 'atom_id' not in atom1:
             atom1['atom_id'] = None
         if has_ins_code:
             ins_code1 = getInsCode(authToInsCode, offsetHolder, atom1)
     if atom2 is not None:
-        star_atom2 = getStarAtom(authToStarSeq, offsetHolder, atom2)
+        star_atom2 = getStarAtom(authToStarSeq, offsetHolder, atom2, atom3)
         if 'atom_id' not in atom2:
             atom2['atom_id'] = None
         if has_ins_code:
             ins_code2 = getInsCode(authToInsCode, offsetHolder, atom2)
     if atom3 is not None:
-        star_atom3 = getStarAtom(authToStarSeq, offsetHolder, atom3)
+        star_atom3 = getStarAtom(authToStarSeq, offsetHolder, atom3, atom3)
         if 'atom_id' not in atom3:
             atom3['atom_id'] = None
         if has_ins_code:
             ins_code3 = getInsCode(authToInsCode, offsetHolder, atom3)
     if atom4 is not None:
-        star_atom4 = getStarAtom(authToStarSeq, offsetHolder, atom4)
+        star_atom4 = getStarAtom(authToStarSeq, offsetHolder, atom4, atom5)
         if 'atom_id' not in atom4:
             atom4['atom_id'] = None
         if has_ins_code:
             ins_code4 = getInsCode(authToInsCode, offsetHolder, atom4)
     if atom5 is not None:
         star_atom5 = getStarAtom(authToStarSeq, offsetHolder, atom5)
         if 'atom_id' not in atom5:
@@ -5532,30 +5552,30 @@
     if atom5 is not None and isinstance(atom5, list):
         atom5 = atom5[0] if len(atom5) > 0 else None
 
     star_atom1 = star_atom2 = star_atom3 = star_atom4 = star_atom5 = None
     ins_code1 = ins_code2 = ins_code3 = ins_code4 = None
 
     if atom1 is not None:
-        star_atom1 = getStarAtom(authToStarSeq, offsetHolder, atom1)
+        star_atom1 = getStarAtom(authToStarSeq, offsetHolder, atom1, atom2)
         if 'atom_id' not in atom1:
             atom1['atom_id'] = None
         ins_code1 = getInsCode(authToInsCode, offsetHolder, atom1)
     if atom2 is not None:
-        star_atom2 = getStarAtom(authToStarSeq, offsetHolder, atom2)
+        star_atom2 = getStarAtom(authToStarSeq, offsetHolder, atom2, atom3)
         if 'atom_id' not in atom2:
             atom2['atom_id'] = None
         ins_code2 = getInsCode(authToInsCode, offsetHolder, atom2)
     if atom3 is not None:
-        star_atom3 = getStarAtom(authToStarSeq, offsetHolder, atom3)
+        star_atom3 = getStarAtom(authToStarSeq, offsetHolder, atom3, atom4)
         if 'atom_id' not in atom3:
             atom3['atom_id'] = None
         ins_code3 = getInsCode(authToInsCode, offsetHolder, atom3)
     if atom4 is not None:
-        star_atom4 = getStarAtom(authToStarSeq, offsetHolder, atom4)
+        star_atom4 = getStarAtom(authToStarSeq, offsetHolder, atom4, atom5)
         if 'atom_id' not in atom4:
             atom4['atom_id'] = None
         ins_code4 = getInsCode(authToInsCode, offsetHolder, atom4)
     if atom5 is not None:
         star_atom5 = getStarAtom(authToStarSeq, offsetHolder, atom5)
         if 'atom_id' not in atom5:
             atom5['atom_id'] = None
```

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/RosettaMRLexer.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/RosettaMRLexer.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/RosettaMRParser.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/RosettaMRParser.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/RosettaMRParserListener.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/RosettaMRParserListener.py`

 * *Files 2% similar despite different names*

```diff
@@ -5051,7374 +5051,7328 @@
 00013ba0: 696e 5f69 6427 5d2c 2061 746f 6d33 5b27  in_id'], atom3['
 00013bb0: 7365 715f 6964 275d 2c20 6174 6f6d 335b  seq_id'], atom3[
 00013bc0: 2763 6f6d 705f 6964 275d 2c20 6174 6f6d  'comp_id'], atom
 00013bd0: 335b 2761 746f 6d5f 6964 275d 2c0a 2020  3['atom_id'],.  
 00013be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00013bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00013c00: 2020 2020 2020 2020 2064 7374 4675 6e63           dstFunc
-00013c10: 5b27 7461 7267 6574 5f76 616c 7565 275d  ['target_value']
-00013c20: 2069 6620 2774 6172 6765 745f 7661 6c75   if 'target_valu
-00013c30: 6527 2069 6e20 6473 7446 756e 6320 656c  e' in dstFunc el
-00013c40: 7365 204e 6f6e 652c 204e 6f6e 652c 0a20  se None, None,. 
-00013c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013c70: 2020 2020 2020 2020 2020 6473 7446 756e            dstFun
-00013c80: 635b 276c 6f77 6572 5f6c 696e 6561 725f  c['lower_linear_
-00013c90: 6c69 6d69 7427 5d20 6966 2027 6c6f 7765  limit'] if 'lowe
-00013ca0: 725f 6c69 6e65 6172 5f6c 696d 6974 2720  r_linear_limit' 
-00013cb0: 696e 2064 7374 4675 6e63 2065 6c73 6520  in dstFunc else 
-00013cc0: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
+00013c10: 2e67 6574 2827 7461 7267 6574 5f76 616c  .get('target_val
+00013c20: 7565 2729 2c20 4e6f 6e65 2c0a 2020 2020  ue'), None,.    
+00013c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013c50: 2020 2020 2020 2064 7374 4675 6e63 2e67         dstFunc.g
+00013c60: 6574 2827 6c6f 7765 725f 6c69 6e65 6172  et('lower_linear
+00013c70: 5f6c 696d 6974 2729 2c0a 2020 2020 2020  _limit'),.      
+00013c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013ca0: 2020 2020 2064 7374 4675 6e63 2e67 6574       dstFunc.get
+00013cb0: 2827 6c6f 7765 725f 6c69 6d69 7427 292c  ('lower_limit'),
+00013cc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00013cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013cf0: 2064 7374 4675 6e63 5b27 6c6f 7765 725f   dstFunc['lower_
-00013d00: 6c69 6d69 7427 5d20 6966 2027 6c6f 7765  limit'] if 'lowe
-00013d10: 725f 6c69 6d69 7427 2069 6e20 6473 7446  r_limit' in dstF
-00013d20: 756e 6320 656c 7365 204e 6f6e 652c 0a20  unc else None,. 
-00013d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013d50: 2020 2020 2020 2020 2020 6473 7446 756e            dstFun
-00013d60: 635b 2775 7070 6572 5f6c 696d 6974 275d  c['upper_limit']
-00013d70: 2069 6620 2775 7070 6572 5f6c 696d 6974   if 'upper_limit
-00013d80: 2720 696e 2064 7374 4675 6e63 2065 6c73  ' in dstFunc els
-00013d90: 6520 4e6f 6e65 2c0a 2020 2020 2020 2020  e None,.        
-00013da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013dc0: 2020 2064 7374 4675 6e63 5b27 7570 7065     dstFunc['uppe
-00013dd0: 725f 6c69 6e65 6172 5f6c 696d 6974 275d  r_linear_limit']
-00013de0: 2069 6620 2775 7070 6572 5f6c 696e 6561   if 'upper_linea
-00013df0: 725f 6c69 6d69 7427 2069 6e20 6473 7446  r_limit' in dstF
-00013e00: 756e 6320 656c 7365 204e 6f6e 652c 0a20  unc else None,. 
-00013e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013e30: 2020 2020 2020 2020 2020 7366 5b27 6c69            sf['li
-00013e40: 7374 5f69 6427 5d2c 2073 656c 662e 5f5f  st_id'], self.__
-00013e50: 656e 7472 7949 645d 290a 0a20 2020 2064  entryId])..    d
-00013e60: 6566 2076 616c 6964 6174 6541 6e67 6c65  ef validateAngle
-00013e70: 5261 6e67 6528 7365 6c66 2c20 7765 6967  Range(self, weig
-00013e80: 6874 293a 0a20 2020 2020 2020 2022 2222  ht):.        """
-00013e90: 2056 616c 6964 6174 6520 616e 676c 6520   Validate angle 
-00013ea0: 7661 6c75 6520 7261 6e67 652e 0a20 2020  value range..   
-00013eb0: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-00013ec0: 2020 7461 7267 6574 5f76 616c 7565 203d    target_value =
-00013ed0: 204e 6f6e 650a 2020 2020 2020 2020 6c6f   None.        lo
-00013ee0: 7765 725f 6c69 6d69 7420 3d20 4e6f 6e65  wer_limit = None
-00013ef0: 0a20 2020 2020 2020 2075 7070 6572 5f6c  .        upper_l
-00013f00: 696d 6974 203d 204e 6f6e 650a 2020 2020  imit = None.    
-00013f10: 2020 2020 6c6f 7765 725f 6c69 6e65 6172      lower_linear
-00013f20: 5f6c 696d 6974 203d 204e 6f6e 650a 2020  _limit = None.  
-00013f30: 2020 2020 2020 7570 7065 725f 6c69 6e65        upper_line
-00013f40: 6172 5f6c 696d 6974 203d 204e 6f6e 650a  ar_limit = None.
-00013f50: 0a20 2020 2020 2020 2066 6972 7374 4675  .        firstFu
-00013f60: 6e63 203d 204e 6f6e 650a 2020 2020 2020  nc = None.      
-00013f70: 2020 7372 6346 756e 6320 3d20 4e6f 6e65    srcFunc = None
-00013f80: 0a0a 2020 2020 2020 2020 6c65 7665 6c20  ..        level 
-00013f90: 3d20 300a 2020 2020 2020 2020 7768 696c  = 0.        whil
-00013fa0: 6520 7365 6c66 2e73 7461 636b 4675 6e63  e self.stackFunc
-00013fb0: 733a 0a20 2020 2020 2020 2020 2020 2066  s:.            f
-00013fc0: 756e 6320 3d20 7365 6c66 2e73 7461 636b  unc = self.stack
-00013fd0: 4675 6e63 732e 706f 7028 290a 2020 2020  Funcs.pop().    
-00013fe0: 2020 2020 2020 2020 6966 2066 756e 6320          if func 
-00013ff0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+00013ce0: 2020 2020 2020 2020 2020 2020 6473 7446              dstF
+00013cf0: 756e 632e 6765 7428 2775 7070 6572 5f6c  unc.get('upper_l
+00013d00: 696d 6974 2729 2c0a 2020 2020 2020 2020  imit'),.        
+00013d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013d30: 2020 2064 7374 4675 6e63 2e67 6574 2827     dstFunc.get('
+00013d40: 7570 7065 725f 6c69 6e65 6172 5f6c 696d  upper_linear_lim
+00013d50: 6974 2729 2c0a 2020 2020 2020 2020 2020  it'),.          
+00013d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013d80: 2073 665b 276c 6973 745f 6964 275d 2c20   sf['list_id'], 
+00013d90: 7365 6c66 2e5f 5f65 6e74 7279 4964 5d29  self.__entryId])
+00013da0: 0a0a 2020 2020 6465 6620 7661 6c69 6461  ..    def valida
+00013db0: 7465 416e 676c 6552 616e 6765 2873 656c  teAngleRange(sel
+00013dc0: 662c 2077 6569 6768 7429 3a0a 2020 2020  f, weight):.    
+00013dd0: 2020 2020 2222 2220 5661 6c69 6461 7465      """ Validate
+00013de0: 2061 6e67 6c65 2076 616c 7565 2072 616e   angle value ran
+00013df0: 6765 2e0a 2020 2020 2020 2020 2222 220a  ge..        """.
+00013e00: 0a20 2020 2020 2020 2074 6172 6765 745f  .        target_
+00013e10: 7661 6c75 6520 3d20 4e6f 6e65 0a20 2020  value = None.   
+00013e20: 2020 2020 206c 6f77 6572 5f6c 696d 6974       lower_limit
+00013e30: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
+00013e40: 7570 7065 725f 6c69 6d69 7420 3d20 4e6f  upper_limit = No
+00013e50: 6e65 0a20 2020 2020 2020 206c 6f77 6572  ne.        lower
+00013e60: 5f6c 696e 6561 725f 6c69 6d69 7420 3d20  _linear_limit = 
+00013e70: 4e6f 6e65 0a20 2020 2020 2020 2075 7070  None.        upp
+00013e80: 6572 5f6c 696e 6561 725f 6c69 6d69 7420  er_linear_limit 
+00013e90: 3d20 4e6f 6e65 0a0a 2020 2020 2020 2020  = None..        
+00013ea0: 6669 7273 7446 756e 6320 3d20 4e6f 6e65  firstFunc = None
+00013eb0: 0a20 2020 2020 2020 2073 7263 4675 6e63  .        srcFunc
+00013ec0: 203d 204e 6f6e 650a 0a20 2020 2020 2020   = None..       
+00013ed0: 206c 6576 656c 203d 2030 0a20 2020 2020   level = 0.     
+00013ee0: 2020 2077 6869 6c65 2073 656c 662e 7374     while self.st
+00013ef0: 6163 6b46 756e 6373 3a0a 2020 2020 2020  ackFuncs:.      
+00013f00: 2020 2020 2020 6675 6e63 203d 2073 656c        func = sel
+00013f10: 662e 7374 6163 6b46 756e 6373 2e70 6f70  f.stackFuncs.pop
+00013f20: 2829 0a20 2020 2020 2020 2020 2020 2069  ().            i
+00013f30: 6620 6675 6e63 2069 7320 6e6f 7420 4e6f  f func is not No
+00013f40: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00013f50: 2020 2020 6966 2066 6972 7374 4675 6e63      if firstFunc
+00013f60: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00013f70: 2020 2020 2020 2020 2020 2020 2020 6669                fi
+00013f80: 7273 7446 756e 6320 3d20 636f 7079 2e63  rstFunc = copy.c
+00013f90: 6f70 7928 6675 6e63 290a 2020 2020 2020  opy(func).      
+00013fa0: 2020 2020 2020 2020 2020 6966 2066 756e            if fun
+00013fb0: 635b 276e 616d 6527 5d20 696e 2028 2753  c['name'] in ('S
+00013fc0: 4341 4c41 5257 4549 4748 5445 4446 554e  CALARWEIGHTEDFUN
+00013fd0: 4327 2c20 2753 554d 4655 4e43 2729 3a0a  C', 'SUMFUNC'):.
+00013fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013ff0: 2020 2020 636f 6e74 696e 7565 0a20 2020      continue.   
 00014000: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00014010: 6669 7273 7446 756e 6320 6973 204e 6f6e  firstFunc is Non
-00014020: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00014030: 2020 2020 2020 2066 6972 7374 4675 6e63         firstFunc
-00014040: 203d 2063 6f70 792e 636f 7079 2866 756e   = copy.copy(fun
-00014050: 6329 0a20 2020 2020 2020 2020 2020 2020  c).             
-00014060: 2020 2069 6620 6675 6e63 5b27 6e61 6d65     if func['name
-00014070: 275d 2069 6e20 2827 5343 414c 4152 5745  '] in ('SCALARWE
-00014080: 4947 4854 4544 4655 4e43 272c 2027 5355  IGHTEDFUNC', 'SU
-00014090: 4d46 554e 4327 293a 0a20 2020 2020 2020  MFUNC'):.       
-000140a0: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
-000140b0: 7469 6e75 650a 2020 2020 2020 2020 2020  tinue.          
-000140c0: 2020 2020 2020 6966 2027 6675 6e63 5f74        if 'func_t
-000140d0: 7970 6573 2720 696e 2066 6972 7374 4675  ypes' in firstFu
-000140e0: 6e63 3a0a 2020 2020 2020 2020 2020 2020  nc:.            
-000140f0: 2020 2020 2020 2020 6669 7273 7446 756e          firstFun
-00014100: 635b 2766 756e 635f 7479 7065 7327 5d2e  c['func_types'].
-00014110: 6170 7065 6e64 2866 756e 635b 276e 616d  append(func['nam
-00014120: 6527 5d29 0a20 2020 2020 2020 2020 2020  e']).           
-00014130: 2020 2020 2069 6620 7372 6346 756e 6320       if srcFunc 
-00014140: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00014150: 2020 2020 2020 2020 2020 2020 2073 7263               src
-00014160: 4675 6e63 203d 2063 6f70 792e 636f 7079  Func = copy.copy
-00014170: 2866 756e 6329 0a20 2020 2020 2020 2020  (func).         
-00014180: 2020 2020 2020 2069 6620 2774 6172 6765         if 'targe
-00014190: 745f 7661 6c75 6527 2069 6e20 6675 6e63  t_value' in func
-000141a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000141b0: 2020 2020 2020 7461 7267 6574 5f76 616c        target_val
-000141c0: 7565 203d 2066 756e 635b 2774 6172 6765  ue = func['targe
-000141d0: 745f 7661 6c75 6527 5d0a 2020 2020 2020  t_value'].      
-000141e0: 2020 2020 2020 2020 2020 2020 2020 6465                de
-000141f0: 6c20 7372 6346 756e 635b 2774 6172 6765  l srcFunc['targe
-00014200: 745f 7661 6c75 6527 5d0a 2020 2020 2020  t_value'].      
-00014210: 2020 2020 2020 2020 2020 6966 2027 6c6f            if 'lo
-00014220: 7765 725f 6c69 6d69 7427 2069 6e20 6675  wer_limit' in fu
-00014230: 6e63 3a0a 2020 2020 2020 2020 2020 2020  nc:.            
-00014240: 2020 2020 2020 2020 6c6f 7765 725f 6c69          lower_li
-00014250: 6d69 7420 3d20 6675 6e63 5b27 6c6f 7765  mit = func['lowe
-00014260: 725f 6c69 6d69 7427 5d0a 2020 2020 2020  r_limit'].      
-00014270: 2020 2020 2020 2020 2020 2020 2020 6465                de
-00014280: 6c20 7372 6346 756e 635b 276c 6f77 6572  l srcFunc['lower
-00014290: 5f6c 696d 6974 275d 0a20 2020 2020 2020  _limit'].       
-000142a0: 2020 2020 2020 2020 2069 6620 2775 7070           if 'upp
-000142b0: 6572 5f6c 696d 6974 2720 696e 2066 756e  er_limit' in fun
-000142c0: 633a 0a20 2020 2020 2020 2020 2020 2020  c:.             
-000142d0: 2020 2020 2020 2075 7070 6572 5f6c 696d         upper_lim
-000142e0: 6974 203d 2066 756e 635b 2775 7070 6572  it = func['upper
-000142f0: 5f6c 696d 6974 275d 0a20 2020 2020 2020  _limit'].       
-00014300: 2020 2020 2020 2020 2020 2020 2064 656c               del
-00014310: 2073 7263 4675 6e63 5b27 7570 7065 725f   srcFunc['upper_
-00014320: 6c69 6d69 7427 5d0a 2020 2020 2020 2020  limit'].        
-00014330: 2020 2020 2020 2020 6966 2027 6c6f 7765          if 'lowe
-00014340: 725f 6c69 6e65 6172 5f6c 696d 6974 2720  r_linear_limit' 
-00014350: 696e 2066 756e 633a 0a20 2020 2020 2020  in func:.       
-00014360: 2020 2020 2020 2020 2020 2020 206c 6f77               low
-00014370: 6572 5f6c 696e 6561 725f 6c69 6d69 7420  er_linear_limit 
-00014380: 3d20 6675 6e63 5b27 6c6f 7765 725f 6c69  = func['lower_li
-00014390: 6e65 6172 5f6c 696d 6974 275d 0a20 2020  near_limit'].   
-000143a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000143b0: 2064 656c 2073 7263 4675 6e63 5b27 6c6f   del srcFunc['lo
-000143c0: 7765 725f 6c69 6e65 6172 5f6c 696d 6974  wer_linear_limit
-000143d0: 275d 0a20 2020 2020 2020 2020 2020 2020  '].             
-000143e0: 2020 2069 6620 2775 7070 6572 5f6c 696e     if 'upper_lin
-000143f0: 6561 725f 6c69 6d69 7427 2069 6e20 6675  ear_limit' in fu
-00014400: 6e63 3a0a 2020 2020 2020 2020 2020 2020  nc:.            
-00014410: 2020 2020 2020 2020 7570 7065 725f 6c69          upper_li
-00014420: 6e65 6172 5f6c 696d 6974 203d 2066 756e  near_limit = fun
-00014430: 635b 2775 7070 6572 5f6c 696e 6561 725f  c['upper_linear_
-00014440: 6c69 6d69 7427 5d0a 2020 2020 2020 2020  limit'].        
-00014450: 2020 2020 2020 2020 2020 2020 6465 6c20              del 
-00014460: 7372 6346 756e 635b 2775 7070 6572 5f6c  srcFunc['upper_l
-00014470: 696e 6561 725f 6c69 6d69 7427 5d0a 2020  inear_limit'].  
-00014480: 2020 2020 2020 2020 2020 2020 2020 6c65                le
-00014490: 7665 6c20 2b3d 2031 0a0a 2020 2020 2020  vel += 1..      
-000144a0: 2020 6966 2073 7263 4675 6e63 2069 7320    if srcFunc is 
-000144b0: 4e6f 6e65 3a20 2023 2065 7272 6f72 7320  None:  # errors 
-000144c0: 6172 6520 616c 7265 6164 7920 6361 7567  are already caug
-000144d0: 6874 0a20 2020 2020 2020 2020 2020 2072  ht.            r
-000144e0: 6574 7572 6e20 4e6f 6e65 0a0a 2020 2020  eturn None..    
-000144f0: 2020 2020 6966 206c 6576 656c 203e 2031      if level > 1
-00014500: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00014510: 6c66 2e5f 5f66 2e61 7070 656e 6428 6622  lf.__f.append(f"
-00014520: 5b55 6e73 7570 706f 7274 6564 2064 6174  [Unsupported dat
-00014530: 615d 207b 7365 6c66 2e5f 5f67 6574 4375  a] {self.__getCu
-00014540: 7272 656e 7452 6573 7472 6169 6e74 2829  rrentRestraint()
-00014550: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
-00014560: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00014570: 2254 6f6f 2063 6f6d 706c 6578 2063 6f6e  "Too complex con
-00014580: 7374 7261 696e 7420 6675 6e63 7469 6f6e  straint function
-00014590: 207b 6669 7273 7446 756e 637d 2063 616e   {firstFunc} can
-000145a0: 206e 6f74 2062 6520 636f 6e76 6572 7465   not be converte
-000145b0: 6420 746f 204e 4546 2f4e 4d52 2d53 5441  d to NEF/NMR-STA
-000145c0: 5220 6461 7461 2e22 290a 2020 2020 2020  R data.").      
-000145d0: 2020 2020 2020 7265 7475 726e 204e 6f6e        return Non
-000145e0: 650a 0a20 2020 2020 2020 2069 6620 7461  e..        if ta
-000145f0: 7267 6574 5f76 616c 7565 2069 7320 4e6f  rget_value is No
-00014600: 6e65 2061 6e64 206c 6f77 6572 5f6c 696d  ne and lower_lim
-00014610: 6974 2069 7320 4e6f 6e65 2061 6e64 2075  it is None and u
-00014620: 7070 6572 5f6c 696d 6974 2069 7320 4e6f  pper_limit is No
-00014630: 6e65 5c0a 2020 2020 2020 2020 2020 2061  ne\.           a
-00014640: 6e64 206c 6f77 6572 5f6c 696e 6561 725f  nd lower_linear_
-00014650: 6c69 6d69 7420 6973 204e 6f6e 6520 616e  limit is None an
-00014660: 6420 7570 7065 725f 6c69 6e65 6172 5f6c  d upper_linear_l
-00014670: 696d 6974 2069 7320 4e6f 6e65 3a0a 2020  imit is None:.  
-00014680: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00014690: 5f66 2e61 7070 656e 6428 6622 5b55 6e73  _f.append(f"[Uns
-000146a0: 7570 706f 7274 6564 2064 6174 615d 207b  upported data] {
-000146b0: 7365 6c66 2e5f 5f67 6574 4375 7272 656e  self.__getCurren
-000146c0: 7452 6573 7472 6169 6e74 2829 7d22 0a20  tRestraint()}". 
-000146d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000146e0: 2020 2020 2020 2020 2020 2066 2254 6865             f"The
-000146f0: 2063 6f6e 7374 7261 696e 7420 6675 6e63   constraint func
-00014700: 7469 6f6e 207b 7372 6346 756e 637d 2063  tion {srcFunc} c
-00014710: 616e 206e 6f74 2062 6520 636f 6e76 6572  an not be conver
-00014720: 7465 6420 746f 204e 4546 2f4e 4d52 2d53  ted to NEF/NMR-S
-00014730: 5441 5220 6461 7461 2e22 290a 2020 2020  TAR data.").    
-00014740: 2020 2020 2020 2020 7265 7475 726e 204e          return N
-00014750: 6f6e 650a 0a20 2020 2020 2020 2076 616c  one..        val
-00014760: 6964 5261 6e67 6520 3d20 5472 7565 0a20  idRange = True. 
-00014770: 2020 2020 2020 2064 7374 4675 6e63 203d         dstFunc =
-00014780: 207b 2777 6569 6768 7427 3a20 7765 6967   {'weight': weig
-00014790: 6874 7d0a 0a20 2020 2020 2020 2069 6620  ht}..        if 
-000147a0: 7365 6c66 2e5f 5f63 6f72 7265 6374 4369  self.__correctCi
-000147b0: 7263 756c 6172 5368 6966 743a 0a20 2020  rcularShift:.   
-000147c0: 2020 2020 2020 2020 205f 6172 7261 7920           _array 
-000147d0: 3d20 6e75 6d70 792e 6172 7261 7928 5b74  = numpy.array([t
-000147e0: 6172 6765 745f 7661 6c75 652c 206c 6f77  arget_value, low
-000147f0: 6572 5f6c 696d 6974 2c20 7570 7065 725f  er_limit, upper_
-00014800: 6c69 6d69 742c 206c 6f77 6572 5f6c 696e  limit, lower_lin
-00014810: 6561 725f 6c69 6d69 742c 2075 7070 6572  ear_limit, upper
-00014820: 5f6c 696e 6561 725f 6c69 6d69 745d 2c0a  _linear_limit],.
-00014830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014850: 2064 7479 7065 3d66 6c6f 6174 290a 0a20   dtype=float).. 
-00014860: 2020 2020 2020 2020 2020 2073 6869 6674             shift
-00014870: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-00014880: 2020 2020 6966 206e 756d 7079 2e6e 616e      if numpy.nan
-00014890: 6d69 6e28 5f61 7272 6179 2920 3e3d 2054  min(_array) >= T
-000148a0: 4852 4553 4848 4f4c 445f 464f 525f 4349  HRESHHOLD_FOR_CI
-000148b0: 5243 554c 4152 5f53 4849 4654 3a0a 2020  RCULAR_SHIFT:.  
-000148c0: 2020 2020 2020 2020 2020 2020 2020 7368                sh
-000148d0: 6966 7420 3d20 2d28 6e75 6d70 792e 6e61  ift = -(numpy.na
-000148e0: 6e6d 6178 285f 6172 7261 7929 202f 2f20  nmax(_array) // 
-000148f0: 3336 3029 202a 2033 3630 0a20 2020 2020  360) * 360.     
-00014900: 2020 2020 2020 2065 6c69 6620 6e75 6d70         elif nump
-00014910: 792e 6e61 6e6d 6178 285f 6172 7261 7929  y.nanmax(_array)
-00014920: 203c 3d20 2d54 4852 4553 4848 4f4c 445f   <= -THRESHHOLD_
-00014930: 464f 525f 4349 5243 554c 4152 5f53 4849  FOR_CIRCULAR_SHI
-00014940: 4654 3a0a 2020 2020 2020 2020 2020 2020  FT:.            
-00014950: 2020 2020 7368 6966 7420 3d20 2d28 6e75      shift = -(nu
-00014960: 6d70 792e 6e61 6e6d 696e 285f 6172 7261  mpy.nanmin(_arra
-00014970: 7929 202f 2f20 3336 3029 202a 2033 3630  y) // 360) * 360
-00014980: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00014990: 7368 6966 7420 6973 206e 6f74 204e 6f6e  shift is not Non
-000149a0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000149b0: 2020 2073 656c 662e 5f5f 662e 6170 7065     self.__f.appe
-000149c0: 6e64 2866 225b 5261 6e67 6520 7661 6c75  nd(f"[Range valu
-000149d0: 6520 7761 726e 696e 675d 207b 7365 6c66  e warning] {self
-000149e0: 2e5f 5f67 6574 4375 7272 656e 7452 6573  .__getCurrentRes
-000149f0: 7472 6169 6e74 2829 7d22 0a20 2020 2020  traint()}".     
-00014a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014a10: 2020 2020 2020 2020 2020 2022 5468 6520             "The 
-00014a20: 7461 7267 6574 2f6c 696d 6974 2076 616c  target/limit val
-00014a30: 7565 7320 666f 7220 616e 2061 6e67 6c65  ues for an angle
-00014a40: 2072 6573 7472 6169 6e74 2068 6176 6520   restraint have 
-00014a50: 6265 656e 2063 6972 6375 6c61 726c 7920  been circularly 
-00014a60: 7368 6966 7465 6420 220a 2020 2020 2020  shifted ".      
-00014a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014a80: 2020 2020 2020 2020 2020 6622 746f 2066            f"to f
-00014a90: 6974 2077 6974 6869 6e20 7261 6e67 6520  it within range 
-00014aa0: 7b41 4e47 4c45 5f52 4553 5452 4149 4e54  {ANGLE_RESTRAINT
-00014ab0: 5f45 5252 4f52 7d2e 2229 0a20 2020 2020  _ERROR}.").     
-00014ac0: 2020 2020 2020 2020 2020 2069 6620 7461             if ta
-00014ad0: 7267 6574 5f76 616c 7565 2069 7320 6e6f  rget_value is no
-00014ae0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00014af0: 2020 2020 2020 2020 2020 2020 7461 7267              targ
-00014b00: 6574 5f76 616c 7565 202b 3d20 7368 6966  et_value += shif
-00014b10: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
-00014b20: 2020 6966 206c 6f77 6572 5f6c 696d 6974    if lower_limit
-00014b30: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-00014b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014b50: 2020 6c6f 7765 725f 6c69 6d69 7420 2b3d    lower_limit +=
-00014b60: 2073 6869 6674 0a20 2020 2020 2020 2020   shift.         
-00014b70: 2020 2020 2020 2069 6620 7570 7065 725f         if upper_
-00014b80: 6c69 6d69 7420 6973 206e 6f74 204e 6f6e  limit is not Non
-00014b90: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00014ba0: 2020 2020 2020 2075 7070 6572 5f6c 696d         upper_lim
-00014bb0: 6974 202b 3d20 7368 6966 740a 2020 2020  it += shift.    
-00014bc0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-00014bd0: 6f77 6572 5f6c 696e 6561 725f 6c69 6d69  ower_linear_limi
-00014be0: 7420 6973 206e 6f74 204e 6f6e 653a 0a20  t is not None:. 
-00014bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014c00: 2020 2075 7070 6572 5f6c 696e 6561 725f     upper_linear_
-00014c10: 6c69 6d69 7420 2b3d 2073 6869 6674 0a20  limit += shift. 
-00014c20: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00014c30: 6620 7570 7065 725f 6c69 6e65 6172 5f6c  f upper_linear_l
-00014c40: 696d 6974 2069 7320 6e6f 7420 4e6f 6e65  imit is not None
-00014c50: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00014c60: 2020 2020 2020 7570 7065 725f 6c69 6e65        upper_line
-00014c70: 6172 5f6c 696d 6974 202b 3d20 7368 6966  ar_limit += shif
-00014c80: 740a 0a20 2020 2020 2020 2069 6620 7461  t..        if ta
-00014c90: 7267 6574 5f76 616c 7565 2069 7320 6e6f  rget_value is no
-00014ca0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00014cb0: 2020 2020 6966 2041 4e47 4c45 5f45 5252      if ANGLE_ERR
-00014cc0: 4f52 5f4d 494e 203c 2074 6172 6765 745f  OR_MIN < target_
-00014cd0: 7661 6c75 6520 3c20 414e 474c 455f 4552  value < ANGLE_ER
-00014ce0: 524f 525f 4d41 583a 0a20 2020 2020 2020  ROR_MAX:.       
-00014cf0: 2020 2020 2020 2020 2064 7374 4675 6e63           dstFunc
-00014d00: 5b27 7461 7267 6574 5f76 616c 7565 275d  ['target_value']
-00014d10: 203d 2066 227b 7461 7267 6574 5f76 616c   = f"{target_val
-00014d20: 7565 7d22 0a20 2020 2020 2020 2020 2020  ue}".           
-00014d30: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00014d40: 2020 2020 2020 2076 616c 6964 5261 6e67         validRang
-00014d50: 6520 3d20 4661 6c73 650a 2020 2020 2020  e = False.      
-00014d60: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00014d70: 5f66 2e61 7070 656e 6428 6622 5b52 616e  _f.append(f"[Ran
-00014d80: 6765 2076 616c 7565 2065 7272 6f72 5d20  ge value error] 
-00014d90: 7b73 656c 662e 5f5f 6765 7443 7572 7265  {self.__getCurre
-00014da0: 6e74 5265 7374 7261 696e 7428 297d 220a  ntRestraint()}".
-00014db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014dd0: 6622 7b73 7263 4675 6e63 7d2c 2074 6865  f"{srcFunc}, the
-00014de0: 2074 6172 6765 7420 7661 6c75 653d 277b   target value='{
-00014df0: 7461 7267 6574 5f76 616c 7565 7d27 206d  target_value}' m
-00014e00: 7573 7420 6265 2077 6974 6869 6e20 7261  ust be within ra
-00014e10: 6e67 6520 7b41 4e47 4c45 5f52 4553 5452  nge {ANGLE_RESTR
-00014e20: 4149 4e54 5f45 5252 4f52 7d2e 2229 0a0a  AINT_ERROR}.")..
-00014e30: 2020 2020 2020 2020 6966 206c 6f77 6572          if lower
-00014e40: 5f6c 696d 6974 2069 7320 6e6f 7420 4e6f  _limit is not No
-00014e50: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00014e60: 6966 2041 4e47 4c45 5f45 5252 4f52 5f4d  if ANGLE_ERROR_M
-00014e70: 494e 203c 3d20 6c6f 7765 725f 6c69 6d69  IN <= lower_limi
-00014e80: 7420 3c20 414e 474c 455f 4552 524f 525f  t < ANGLE_ERROR_
-00014e90: 4d41 583a 0a20 2020 2020 2020 2020 2020  MAX:.           
-00014ea0: 2020 2020 2064 7374 4675 6e63 5b27 6c6f       dstFunc['lo
-00014eb0: 7765 725f 6c69 6d69 7427 5d20 3d20 6622  wer_limit'] = f"
-00014ec0: 7b6c 6f77 6572 5f6c 696d 6974 7d22 0a20  {lower_limit}". 
-00014ed0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00014ee0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014ef0: 2076 616c 6964 5261 6e67 6520 3d20 4661   validRange = Fa
-00014f00: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
-00014f10: 2020 2020 7365 6c66 2e5f 5f66 2e61 7070      self.__f.app
-00014f20: 656e 6428 6622 5b52 616e 6765 2076 616c  end(f"[Range val
-00014f30: 7565 2065 7272 6f72 5d20 7b73 656c 662e  ue error] {self.
-00014f40: 5f5f 6765 7443 7572 7265 6e74 5265 7374  __getCurrentRest
-00014f50: 7261 696e 7428 297d 220a 2020 2020 2020  raint()}".      
-00014f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014f70: 2020 2020 2020 2020 2020 6622 7b73 7263            f"{src
-00014f80: 4675 6e63 7d2c 2074 6865 206c 6f77 6572  Func}, the lower
-00014f90: 206c 696d 6974 2076 616c 7565 3d27 7b6c   limit value='{l
-00014fa0: 6f77 6572 5f6c 696d 6974 7d27 206d 7573  ower_limit}' mus
-00014fb0: 7420 6265 2077 6974 6869 6e20 7261 6e67  t be within rang
-00014fc0: 6520 7b41 4e47 4c45 5f52 4553 5452 4149  e {ANGLE_RESTRAI
-00014fd0: 4e54 5f45 5252 4f52 7d2e 2229 0a0a 2020  NT_ERROR}.")..  
-00014fe0: 2020 2020 2020 6966 2075 7070 6572 5f6c        if upper_l
-00014ff0: 696d 6974 2069 7320 6e6f 7420 4e6f 6e65  imit is not None
-00015000: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00015010: 2041 4e47 4c45 5f45 5252 4f52 5f4d 494e   ANGLE_ERROR_MIN
-00015020: 203c 2075 7070 6572 5f6c 696d 6974 203c   < upper_limit <
-00015030: 3d20 414e 474c 455f 4552 524f 525f 4d41  = ANGLE_ERROR_MA
-00015040: 583a 0a20 2020 2020 2020 2020 2020 2020  X:.             
-00015050: 2020 2064 7374 4675 6e63 5b27 7570 7065     dstFunc['uppe
-00015060: 725f 6c69 6d69 7427 5d20 3d20 6622 7b75  r_limit'] = f"{u
-00015070: 7070 6572 5f6c 696d 6974 7d22 0a20 2020  pper_limit}".   
-00015080: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00015090: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-000150a0: 616c 6964 5261 6e67 6520 3d20 4661 6c73  alidRange = Fals
-000150b0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-000150c0: 2020 7365 6c66 2e5f 5f66 2e61 7070 656e    self.__f.appen
-000150d0: 6428 6622 5b52 616e 6765 2076 616c 7565  d(f"[Range value
-000150e0: 2065 7272 6f72 5d20 7b73 656c 662e 5f5f   error] {self.__
-000150f0: 6765 7443 7572 7265 6e74 5265 7374 7261  getCurrentRestra
-00015100: 696e 7428 297d 220a 2020 2020 2020 2020  int()}".        
-00015110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015120: 2020 2020 2020 2020 6622 7b73 7263 4675          f"{srcFu
-00015130: 6e63 7d2c 2074 6865 2075 7070 6572 206c  nc}, the upper l
-00015140: 696d 6974 2076 616c 7565 3d27 7b75 7070  imit value='{upp
-00015150: 6572 5f6c 696d 6974 7d27 206d 7573 7420  er_limit}' must 
-00015160: 6265 2077 6974 6869 6e20 7261 6e67 6520  be within range 
-00015170: 7b41 4e47 4c45 5f52 4553 5452 4149 4e54  {ANGLE_RESTRAINT
-00015180: 5f45 5252 4f52 7d2e 2229 0a0a 2020 2020  _ERROR}.")..    
-00015190: 2020 2020 6966 206c 6f77 6572 5f6c 696e      if lower_lin
-000151a0: 6561 725f 6c69 6d69 7420 6973 206e 6f74  ear_limit is not
-000151b0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-000151c0: 2020 2069 6620 414e 474c 455f 4552 524f     if ANGLE_ERRO
-000151d0: 525f 4d49 4e20 3c3d 206c 6f77 6572 5f6c  R_MIN <= lower_l
-000151e0: 696e 6561 725f 6c69 6d69 7420 3c20 414e  inear_limit < AN
-000151f0: 474c 455f 4552 524f 525f 4d41 583a 0a20  GLE_ERROR_MAX:. 
-00015200: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00015210: 7374 4675 6e63 5b27 6c6f 7765 725f 6c69  stFunc['lower_li
-00015220: 6e65 6172 5f6c 696d 6974 275d 203d 2066  near_limit'] = f
-00015230: 227b 6c6f 7765 725f 6c69 6e65 6172 5f6c  "{lower_linear_l
-00015240: 696d 6974 7d22 0a20 2020 2020 2020 2020  imit}".         
-00015250: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00015260: 2020 2020 2020 2020 2076 616c 6964 5261           validRa
-00015270: 6e67 6520 3d20 4661 6c73 650a 2020 2020  nge = False.    
-00015280: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00015290: 2e5f 5f66 2e61 7070 656e 6428 6622 5b52  .__f.append(f"[R
-000152a0: 616e 6765 2076 616c 7565 2065 7272 6f72  ange value error
-000152b0: 5d20 7b73 656c 662e 5f5f 6765 7443 7572  ] {self.__getCur
-000152c0: 7265 6e74 5265 7374 7261 696e 7428 297d  rentRestraint()}
-000152d0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-000152e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000152f0: 2020 6622 7b73 7263 4675 6e63 7d2c 2074    f"{srcFunc}, t
-00015300: 6865 206c 6f77 6572 206c 696e 6561 7220  he lower linear 
-00015310: 6c69 6d69 7420 7661 6c75 653d 277b 6c6f  limit value='{lo
-00015320: 7765 725f 6c69 6e65 6172 5f6c 696d 6974  wer_linear_limit
-00015330: 7d27 206d 7573 7420 6265 2077 6974 6869  }' must be withi
-00015340: 6e20 7261 6e67 6520 7b41 4e47 4c45 5f52  n range {ANGLE_R
-00015350: 4553 5452 4149 4e54 5f45 5252 4f52 7d2e  ESTRAINT_ERROR}.
-00015360: 2229 0a0a 2020 2020 2020 2020 6966 2075  ")..        if u
-00015370: 7070 6572 5f6c 696e 6561 725f 6c69 6d69  pper_linear_limi
-00015380: 7420 6973 206e 6f74 204e 6f6e 653a 0a20  t is not None:. 
-00015390: 2020 2020 2020 2020 2020 2069 6620 414e             if AN
-000153a0: 474c 455f 4552 524f 525f 4d49 4e20 3c20  GLE_ERROR_MIN < 
-000153b0: 7570 7065 725f 6c69 6e65 6172 5f6c 696d  upper_linear_lim
-000153c0: 6974 203c 3d20 414e 474c 455f 4552 524f  it <= ANGLE_ERRO
-000153d0: 525f 4d41 583a 0a20 2020 2020 2020 2020  R_MAX:.         
-000153e0: 2020 2020 2020 2064 7374 4675 6e63 5b27         dstFunc['
-000153f0: 7570 7065 725f 6c69 6e65 6172 5f6c 696d  upper_linear_lim
-00015400: 6974 275d 203d 2066 227b 7570 7065 725f  it'] = f"{upper_
-00015410: 6c69 6e65 6172 5f6c 696d 6974 7d22 0a20  linear_limit}". 
-00015420: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00015430: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015440: 2076 616c 6964 5261 6e67 6520 3d20 4661   validRange = Fa
-00015450: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
-00015460: 2020 2020 7365 6c66 2e5f 5f66 2e61 7070      self.__f.app
-00015470: 656e 6428 6622 5b52 616e 6765 2076 616c  end(f"[Range val
-00015480: 7565 2065 7272 6f72 5d20 7b73 656c 662e  ue error] {self.
-00015490: 5f5f 6765 7443 7572 7265 6e74 5265 7374  __getCurrentRest
-000154a0: 7261 696e 7428 297d 220a 2020 2020 2020  raint()}".      
-000154b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000154c0: 2020 2020 2020 2020 2020 6622 7b73 7263            f"{src
-000154d0: 4675 6e63 7d2c 2074 6865 2075 7070 6572  Func}, the upper
-000154e0: 206c 696e 6561 7220 6c69 6d69 7420 7661   linear limit va
-000154f0: 6c75 653d 277b 7570 7065 725f 6c69 6e65  lue='{upper_line
-00015500: 6172 5f6c 696d 6974 7d27 206d 7573 7420  ar_limit}' must 
-00015510: 6265 2077 6974 6869 6e20 7261 6e67 6520  be within range 
-00015520: 7b41 4e47 4c45 5f52 4553 5452 4149 4e54  {ANGLE_RESTRAINT
-00015530: 5f45 5252 4f52 7d2e 2229 0a0a 2020 2020  _ERROR}.")..    
-00015540: 2020 2020 6966 206c 6f77 6572 5f6c 696d      if lower_lim
-00015550: 6974 2069 7320 6e6f 7420 4e6f 6e65 2061  it is not None a
-00015560: 6e64 206c 6f77 6572 5f6c 696e 6561 725f  nd lower_linear_
-00015570: 6c69 6d69 7420 6973 206e 6f74 204e 6f6e  limit is not Non
-00015580: 653a 0a20 2020 2020 2020 2020 2020 2069  e:.            i
-00015590: 6620 6c6f 7765 725f 6c69 6e65 6172 5f6c  f lower_linear_l
-000155a0: 696d 6974 203e 206c 6f77 6572 5f6c 696d  imit > lower_lim
-000155b0: 6974 3a0a 2020 2020 2020 2020 2020 2020  it:.            
-000155c0: 2020 2020 7661 6c69 6452 616e 6765 203d      validRange =
-000155d0: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
-000155e0: 2020 2020 2020 2073 656c 662e 5f5f 662e         self.__f.
-000155f0: 6170 7065 6e64 2866 225b 5261 6e67 6520  append(f"[Range 
-00015600: 7661 6c75 6520 6572 726f 725d 207b 7365  value error] {se
-00015610: 6c66 2e5f 5f67 6574 4375 7272 656e 7452  lf.__getCurrentR
-00015620: 6573 7472 6169 6e74 2829 7d22 0a20 2020  estraint()}".   
-00015630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015640: 2020 2020 2020 2020 2020 2020 2066 227b               f"{
-00015650: 7372 6346 756e 637d 2c20 7468 6520 6c6f  srcFunc}, the lo
-00015660: 7765 7220 6c69 6e65 6172 206c 696d 6974  wer linear limit
-00015670: 2076 616c 7565 3d27 7b6c 6f77 6572 5f6c   value='{lower_l
-00015680: 696e 6561 725f 6c69 6d69 747d 2720 6d75  inear_limit}' mu
-00015690: 7374 2062 6520 6c65 7373 2074 6861 6e20  st be less than 
-000156a0: 7468 6520 6c6f 7765 7220 6c69 6d69 7420  the lower limit 
-000156b0: 7661 6c75 6520 277b 6c6f 7765 725f 6c69  value '{lower_li
-000156c0: 6d69 747d 272e 2229 0a0a 2020 2020 2020  mit}'.")..      
-000156d0: 2020 6966 2075 7070 6572 5f6c 696d 6974    if upper_limit
-000156e0: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
-000156f0: 2075 7070 6572 5f6c 696e 6561 725f 6c69   upper_linear_li
-00015700: 6d69 7420 6973 206e 6f74 204e 6f6e 653a  mit is not None:
-00015710: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00015720: 7570 7065 725f 6c69 6d69 7420 3e20 7570  upper_limit > up
-00015730: 7065 725f 6c69 6e65 6172 5f6c 696d 6974  per_linear_limit
-00015740: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00015750: 2020 7661 6c69 6452 616e 6765 203d 2046    validRange = F
-00015760: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-00015770: 2020 2020 2073 656c 662e 5f5f 662e 6170       self.__f.ap
-00015780: 7065 6e64 2866 225b 5261 6e67 6520 7661  pend(f"[Range va
-00015790: 6c75 6520 6572 726f 725d 207b 7365 6c66  lue error] {self
-000157a0: 2e5f 5f67 6574 4375 7272 656e 7452 6573  .__getCurrentRes
-000157b0: 7472 6169 6e74 2829 7d22 0a20 2020 2020  traint()}".     
-000157c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000157d0: 2020 2020 2020 2020 2020 2066 227b 7372             f"{sr
-000157e0: 6346 756e 637d 2c20 7468 6520 7570 7065  cFunc}, the uppe
-000157f0: 7220 6c69 6d69 7420 7661 6c75 653d 277b  r limit value='{
-00015800: 7570 7065 725f 6c69 6d69 747d 2720 6d75  upper_limit}' mu
-00015810: 7374 2062 6520 6c65 7373 2074 6861 6e20  st be less than 
-00015820: 7468 6520 7570 7065 7220 6c69 6e65 6172  the upper linear
-00015830: 206c 696d 6974 2076 616c 7565 2027 7b75   limit value '{u
-00015840: 7070 6572 5f6c 696e 6561 725f 6c69 6d69  pper_linear_limi
-00015850: 747d 272e 2229 0a0a 2020 2020 2020 2020  t}'.")..        
-00015860: 6966 206e 6f74 2076 616c 6964 5261 6e67  if not validRang
-00015870: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-00015880: 6574 7572 6e20 4e6f 6e65 0a0a 2020 2020  eturn None..    
-00015890: 2020 2020 6966 2074 6172 6765 745f 7661      if target_va
-000158a0: 6c75 6520 6973 206e 6f74 204e 6f6e 653a  lue is not None:
-000158b0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000158c0: 414e 474c 455f 5241 4e47 455f 4d49 4e20  ANGLE_RANGE_MIN 
-000158d0: 3c3d 2074 6172 6765 745f 7661 6c75 6520  <= target_value 
-000158e0: 3c3d 2041 4e47 4c45 5f52 414e 4745 5f4d  <= ANGLE_RANGE_M
-000158f0: 4158 3a0a 2020 2020 2020 2020 2020 2020  AX:.            
-00015900: 2020 2020 7061 7373 0a20 2020 2020 2020      pass.       
-00015910: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00015920: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00015930: 5f5f 662e 6170 7065 6e64 2866 225b 5261  __f.append(f"[Ra
-00015940: 6e67 6520 7661 6c75 6520 7761 726e 696e  nge value warnin
-00015950: 675d 207b 7365 6c66 2e5f 5f67 6574 4375  g] {self.__getCu
-00015960: 7272 656e 7452 6573 7472 6169 6e74 2829  rrentRestraint()
-00015970: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
-00015980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015990: 2020 2066 227b 7372 6346 756e 637d 2c20     f"{srcFunc}, 
-000159a0: 7468 6520 7461 7267 6574 2076 616c 7565  the target value
-000159b0: 3d27 7b74 6172 6765 745f 7661 6c75 657d  ='{target_value}
-000159c0: 2720 7368 6f75 6c64 2062 6520 7769 7468  ' should be with
-000159d0: 696e 2072 616e 6765 207b 414e 474c 455f  in range {ANGLE_
-000159e0: 5245 5354 5241 494e 545f 5241 4e47 457d  RESTRAINT_RANGE}
-000159f0: 2e22 290a 0a20 2020 2020 2020 2069 6620  .")..        if 
-00015a00: 6c6f 7765 725f 6c69 6d69 7420 6973 206e  lower_limit is n
-00015a10: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-00015a20: 2020 2020 2069 6620 414e 474c 455f 5241       if ANGLE_RA
-00015a30: 4e47 455f 4d49 4e20 3c3d 206c 6f77 6572  NGE_MIN <= lower
-00015a40: 5f6c 696d 6974 203c 3d20 414e 474c 455f  _limit <= ANGLE_
-00015a50: 5241 4e47 455f 4d41 583a 0a20 2020 2020  RANGE_MAX:.     
-00015a60: 2020 2020 2020 2020 2020 2070 6173 730a             pass.
-00015a70: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00015a80: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00015a90: 2020 7365 6c66 2e5f 5f66 2e61 7070 656e    self.__f.appen
-00015aa0: 6428 6622 5b52 616e 6765 2076 616c 7565  d(f"[Range value
-00015ab0: 2077 6172 6e69 6e67 5d20 7b73 656c 662e   warning] {self.
-00015ac0: 5f5f 6765 7443 7572 7265 6e74 5265 7374  __getCurrentRest
-00015ad0: 7261 696e 7428 297d 220a 2020 2020 2020  raint()}".      
-00015ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015af0: 2020 2020 2020 2020 2020 6622 7b73 7263            f"{src
-00015b00: 4675 6e63 7d2c 2074 6865 206c 6f77 6572  Func}, the lower
-00015b10: 206c 696d 6974 2076 616c 7565 3d27 7b6c   limit value='{l
-00015b20: 6f77 6572 5f6c 696d 6974 7d27 2073 686f  ower_limit}' sho
-00015b30: 756c 6420 6265 2077 6974 6869 6e20 7261  uld be within ra
-00015b40: 6e67 6520 7b41 4e47 4c45 5f52 4553 5452  nge {ANGLE_RESTR
-00015b50: 4149 4e54 5f52 414e 4745 7d2e 2229 0a0a  AINT_RANGE}.")..
-00015b60: 2020 2020 2020 2020 6966 2075 7070 6572          if upper
-00015b70: 5f6c 696d 6974 2069 7320 6e6f 7420 4e6f  _limit is not No
-00015b80: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00015b90: 6966 2041 4e47 4c45 5f52 414e 4745 5f4d  if ANGLE_RANGE_M
-00015ba0: 494e 203c 3d20 7570 7065 725f 6c69 6d69  IN <= upper_limi
-00015bb0: 7420 3c3d 2041 4e47 4c45 5f52 414e 4745  t <= ANGLE_RANGE
-00015bc0: 5f4d 4158 3a0a 2020 2020 2020 2020 2020  _MAX:.          
-00015bd0: 2020 2020 2020 7061 7373 0a20 2020 2020        pass.     
-00015be0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00015bf0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00015c00: 662e 5f5f 662e 6170 7065 6e64 2866 225b  f.__f.append(f"[
-00015c10: 5261 6e67 6520 7661 6c75 6520 7761 726e  Range value warn
-00015c20: 696e 675d 207b 7365 6c66 2e5f 5f67 6574  ing] {self.__get
-00015c30: 4375 7272 656e 7452 6573 7472 6169 6e74  CurrentRestraint
-00015c40: 2829 7d22 0a20 2020 2020 2020 2020 2020  ()}".           
-00015c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015c60: 2020 2020 2066 227b 7372 6346 756e 637d       f"{srcFunc}
-00015c70: 2c20 7468 6520 7570 7065 7220 6c69 6d69  , the upper limi
-00015c80: 7420 7661 6c75 653d 277b 7570 7065 725f  t value='{upper_
-00015c90: 6c69 6d69 747d 2720 7368 6f75 6c64 2062  limit}' should b
-00015ca0: 6520 7769 7468 696e 2072 616e 6765 207b  e within range {
-00015cb0: 414e 474c 455f 5245 5354 5241 494e 545f  ANGLE_RESTRAINT_
-00015cc0: 5241 4e47 457d 2e22 290a 0a20 2020 2020  RANGE}.")..     
-00015cd0: 2020 2069 6620 6c6f 7765 725f 6c69 6e65     if lower_line
-00015ce0: 6172 5f6c 696d 6974 2069 7320 6e6f 7420  ar_limit is not 
-00015cf0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00015d00: 2020 6966 2041 4e47 4c45 5f52 414e 4745    if ANGLE_RANGE
-00015d10: 5f4d 494e 203c 3d20 6c6f 7765 725f 6c69  _MIN <= lower_li
-00015d20: 6e65 6172 5f6c 696d 6974 203c 3d20 414e  near_limit <= AN
-00015d30: 474c 455f 5241 4e47 455f 4d41 583a 0a20  GLE_RANGE_MAX:. 
-00015d40: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00015d50: 6173 730a 2020 2020 2020 2020 2020 2020  ass.            
-00015d60: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00015d70: 2020 2020 2020 7365 6c66 2e5f 5f66 2e61        self.__f.a
-00015d80: 7070 656e 6428 6622 5b52 616e 6765 2076  ppend(f"[Range v
-00015d90: 616c 7565 2077 6172 6e69 6e67 5d20 7b73  alue warning] {s
-00015da0: 656c 662e 5f5f 6765 7443 7572 7265 6e74  elf.__getCurrent
-00015db0: 5265 7374 7261 696e 7428 297d 220a 2020  Restraint()}".  
-00015dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015dd0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-00015de0: 7b73 7263 4675 6e63 7d2c 2074 6865 206c  {srcFunc}, the l
-00015df0: 6f77 6572 206c 696e 6561 7220 6c69 6d69  ower linear limi
-00015e00: 7420 7661 6c75 653d 277b 6c6f 7765 725f  t value='{lower_
-00015e10: 6c69 6e65 6172 5f6c 696d 6974 7d27 2073  linear_limit}' s
-00015e20: 686f 756c 6420 6265 2077 6974 6869 6e20  hould be within 
-00015e30: 7261 6e67 6520 7b41 4e47 4c45 5f52 4553  range {ANGLE_RES
-00015e40: 5452 4149 4e54 5f52 414e 4745 7d2e 2229  TRAINT_RANGE}.")
-00015e50: 0a0a 2020 2020 2020 2020 6966 2075 7070  ..        if upp
-00015e60: 6572 5f6c 696e 6561 725f 6c69 6d69 7420  er_linear_limit 
-00015e70: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-00015e80: 2020 2020 2020 2020 2069 6620 414e 474c           if ANGL
-00015e90: 455f 5241 4e47 455f 4d49 4e20 3c3d 2075  E_RANGE_MIN <= u
-00015ea0: 7070 6572 5f6c 696e 6561 725f 6c69 6d69  pper_linear_limi
-00015eb0: 7420 3c3d 2041 4e47 4c45 5f52 414e 4745  t <= ANGLE_RANGE
-00015ec0: 5f4d 4158 3a0a 2020 2020 2020 2020 2020  _MAX:.          
-00015ed0: 2020 2020 2020 7061 7373 0a20 2020 2020        pass.     
-00015ee0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00015ef0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00015f00: 662e 5f5f 662e 6170 7065 6e64 2866 225b  f.__f.append(f"[
-00015f10: 5261 6e67 6520 7661 6c75 6520 7761 726e  Range value warn
-00015f20: 696e 675d 207b 7365 6c66 2e5f 5f67 6574  ing] {self.__get
-00015f30: 4375 7272 656e 7452 6573 7472 6169 6e74  CurrentRestraint
-00015f40: 2829 7d22 0a20 2020 2020 2020 2020 2020  ()}".           
-00015f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015f60: 2020 2020 2066 227b 7372 6346 756e 637d       f"{srcFunc}
-00015f70: 2c20 7468 6520 7570 7065 7220 6c69 6e65  , the upper line
-00015f80: 6172 206c 696d 6974 2076 616c 7565 3d27  ar limit value='
-00015f90: 7b75 7070 6572 5f6c 696e 6561 725f 6c69  {upper_linear_li
-00015fa0: 6d69 747d 2720 7368 6f75 6c64 2062 6520  mit}' should be 
-00015fb0: 7769 7468 696e 2072 616e 6765 207b 414e  within range {AN
-00015fc0: 474c 455f 5245 5354 5241 494e 545f 5241  GLE_RESTRAINT_RA
-00015fd0: 4e47 457d 2e22 290a 0a20 2020 2020 2020  NGE}.")..       
-00015fe0: 2072 6574 7572 6e20 6473 7446 756e 630a   return dstFunc.
-00015ff0: 0a20 2020 2023 2045 6e74 6572 2061 2070  .    # Enter a p
-00016000: 6172 7365 2074 7265 6520 7072 6f64 7563  arse tree produc
-00016010: 6564 2062 7920 526f 7365 7474 614d 5250  ed by RosettaMRP
-00016020: 6172 7365 7223 6469 6865 6472 616c 5f72  arser#dihedral_r
-00016030: 6573 7472 6169 6e74 732e 0a20 2020 2064  estraints..    d
-00016040: 6566 2065 6e74 6572 4469 6865 6472 616c  ef enterDihedral
-00016050: 5f72 6573 7472 6169 6e74 7328 7365 6c66  _restraints(self
-00016060: 2c20 6374 783a 2052 6f73 6574 7461 4d52  , ctx: RosettaMR
-00016070: 5061 7273 6572 2e44 6968 6564 7261 6c5f  Parser.Dihedral_
-00016080: 7265 7374 7261 696e 7473 436f 6e74 6578  restraintsContex
-00016090: 7429 3a20 2023 2070 796c 696e 743a 2064  t):  # pylint: d
-000160a0: 6973 6162 6c65 3d75 6e75 7365 642d 6172  isable=unused-ar
-000160b0: 6775 6d65 6e74 0a20 2020 2020 2020 2073  gument.        s
-000160c0: 656c 662e 5f5f 6375 725f 7375 6274 7970  elf.__cur_subtyp
-000160d0: 6520 3d20 2764 6968 6564 270a 0a20 2020  e = 'dihed'..   
-000160e0: 2023 2045 7869 7420 6120 7061 7273 6520   # Exit a parse 
-000160f0: 7472 6565 2070 726f 6475 6365 6420 6279  tree produced by
-00016100: 2052 6f73 6574 7461 4d52 5061 7273 6572   RosettaMRParser
-00016110: 2364 6968 6564 7261 6c5f 7265 7374 7261  #dihedral_restra
-00016120: 696e 7473 2e0a 2020 2020 6465 6620 6578  ints..    def ex
-00016130: 6974 4469 6865 6472 616c 5f72 6573 7472  itDihedral_restr
-00016140: 6169 6e74 7328 7365 6c66 2c20 6374 783a  aints(self, ctx:
-00016150: 2052 6f73 6574 7461 4d52 5061 7273 6572   RosettaMRParser
-00016160: 2e44 6968 6564 7261 6c5f 7265 7374 7261  .Dihedral_restra
-00016170: 696e 7473 436f 6e74 6578 7429 3a20 2023  intsContext):  #
-00016180: 2070 796c 696e 743a 2064 6973 6162 6c65   pylint: disable
-00016190: 3d75 6e75 7365 642d 6172 6775 6d65 6e74  =unused-argument
-000161a0: 0a20 2020 2020 2020 2070 6173 730a 0a20  .        pass.. 
-000161b0: 2020 2023 2045 6e74 6572 2061 2070 6172     # Enter a par
-000161c0: 7365 2074 7265 6520 7072 6f64 7563 6564  se tree produced
-000161d0: 2062 7920 526f 7365 7474 614d 5250 6172   by RosettaMRPar
-000161e0: 7365 7223 6469 6865 6472 616c 5f72 6573  ser#dihedral_res
-000161f0: 7472 6169 6e74 2e0a 2020 2020 6465 6620  traint..    def 
-00016200: 656e 7465 7244 6968 6564 7261 6c5f 7265  enterDihedral_re
-00016210: 7374 7261 696e 7428 7365 6c66 2c20 6374  straint(self, ct
-00016220: 783a 2052 6f73 6574 7461 4d52 5061 7273  x: RosettaMRPars
-00016230: 6572 2e44 6968 6564 7261 6c5f 7265 7374  er.Dihedral_rest
-00016240: 7261 696e 7443 6f6e 7465 7874 293a 2020  raintContext):  
-00016250: 2320 7079 6c69 6e74 3a20 6469 7361 626c  # pylint: disabl
-00016260: 653d 756e 7573 6564 2d61 7267 756d 656e  e=unused-argumen
-00016270: 740a 2020 2020 2020 2020 7365 6c66 2e64  t.        self.d
-00016280: 6968 6564 5265 7374 7261 696e 7473 202b  ihedRestraints +
-00016290: 3d20 310a 0a20 2020 2020 2020 2073 656c  = 1..        sel
-000162a0: 662e 7374 6163 6b46 756e 6373 2e63 6c65  f.stackFuncs.cle
-000162b0: 6172 2829 0a20 2020 2020 2020 2073 656c  ar().        sel
-000162c0: 662e 6174 6f6d 5365 6c65 6374 696f 6e53  f.atomSelectionS
-000162d0: 6574 2e63 6c65 6172 2829 0a0a 2020 2020  et.clear()..    
-000162e0: 2320 4578 6974 2061 2070 6172 7365 2074  # Exit a parse t
-000162f0: 7265 6520 7072 6f64 7563 6564 2062 7920  ree produced by 
-00016300: 526f 7365 7474 614d 5250 6172 7365 7223  RosettaMRParser#
-00016310: 6469 6865 6472 616c 5f72 6573 7472 6169  dihedral_restrai
-00016320: 6e74 2e0a 2020 2020 6465 6620 6578 6974  nt..    def exit
-00016330: 4469 6865 6472 616c 5f72 6573 7472 6169  Dihedral_restrai
-00016340: 6e74 2873 656c 662c 2063 7478 3a20 526f  nt(self, ctx: Ro
-00016350: 7365 7474 614d 5250 6172 7365 722e 4469  settaMRParser.Di
-00016360: 6865 6472 616c 5f72 6573 7472 6169 6e74  hedral_restraint
-00016370: 436f 6e74 6578 7429 3a0a 2020 2020 2020  Context):.      
-00016380: 2020 7365 7149 6431 203d 2069 6e74 2873    seqId1 = int(s
-00016390: 7472 2863 7478 2e49 6e74 6567 6572 2830  tr(ctx.Integer(0
-000163a0: 2929 290a 2020 2020 2020 2020 6174 6f6d  ))).        atom
-000163b0: 4964 3120 3d20 7374 7228 6374 782e 5369  Id1 = str(ctx.Si
-000163c0: 6d70 6c65 5f6e 616d 6528 3029 292e 7570  mple_name(0)).up
-000163d0: 7065 7228 290a 2020 2020 2020 2020 7365  per().        se
-000163e0: 7149 6432 203d 2069 6e74 2873 7472 2863  qId2 = int(str(c
-000163f0: 7478 2e49 6e74 6567 6572 2831 2929 290a  tx.Integer(1))).
-00016400: 2020 2020 2020 2020 6174 6f6d 4964 3220          atomId2 
-00016410: 3d20 7374 7228 6374 782e 5369 6d70 6c65  = str(ctx.Simple
-00016420: 5f6e 616d 6528 3129 292e 7570 7065 7228  _name(1)).upper(
-00016430: 290a 2020 2020 2020 2020 7365 7149 6433  ).        seqId3
-00016440: 203d 2069 6e74 2873 7472 2863 7478 2e49   = int(str(ctx.I
-00016450: 6e74 6567 6572 2832 2929 290a 2020 2020  nteger(2))).    
-00016460: 2020 2020 6174 6f6d 4964 3320 3d20 7374      atomId3 = st
-00016470: 7228 6374 782e 5369 6d70 6c65 5f6e 616d  r(ctx.Simple_nam
-00016480: 6528 3229 292e 7570 7065 7228 290a 2020  e(2)).upper().  
-00016490: 2020 2020 2020 7365 7149 6434 203d 2069        seqId4 = i
-000164a0: 6e74 2873 7472 2863 7478 2e49 6e74 6567  nt(str(ctx.Integ
-000164b0: 6572 2833 2929 290a 2020 2020 2020 2020  er(3))).        
-000164c0: 6174 6f6d 4964 3420 3d20 7374 7228 6374  atomId4 = str(ct
-000164d0: 782e 5369 6d70 6c65 5f6e 616d 6528 3329  x.Simple_name(3)
-000164e0: 292e 7570 7065 7228 290a 0a20 2020 2020  ).upper()..     
-000164f0: 2020 2064 7374 4675 6e63 203d 2073 656c     dstFunc = sel
-00016500: 662e 7661 6c69 6461 7465 416e 676c 6552  f.validateAngleR
-00016510: 616e 6765 2831 2e30 290a 0a20 2020 2020  ange(1.0)..     
-00016520: 2020 2069 6620 6473 7446 756e 6320 6973     if dstFunc is
-00016530: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00016540: 2020 2072 6574 7572 6e0a 0a20 2020 2020     return..     
-00016550: 2020 2069 6620 6e6f 7420 7365 6c66 2e5f     if not self._
-00016560: 5f68 6173 506f 6c79 5365 713a 0a20 2020  _hasPolySeq:.   
-00016570: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
-00016580: 0a20 2020 2020 2020 2073 656c 662e 5f5f  .        self.__
-00016590: 7265 7472 6965 7665 4c6f 6361 6c53 6571  retrieveLocalSeq
-000165a0: 5363 6865 6d65 2829 0a0a 2020 2020 2020  Scheme()..      
-000165b0: 2020 6368 6169 6e41 7373 6967 6e31 203d    chainAssign1 =
-000165c0: 2073 656c 662e 6173 7369 676e 436f 6f72   self.assignCoor
-000165d0: 6450 6f6c 796d 6572 5365 7175 656e 6365  dPolymerSequence
-000165e0: 2873 6571 4964 312c 2061 746f 6d49 6431  (seqId1, atomId1
-000165f0: 290a 2020 2020 2020 2020 6368 6169 6e41  ).        chainA
-00016600: 7373 6967 6e32 203d 2073 656c 662e 6173  ssign2 = self.as
-00016610: 7369 676e 436f 6f72 6450 6f6c 796d 6572  signCoordPolymer
-00016620: 5365 7175 656e 6365 2873 6571 4964 322c  Sequence(seqId2,
-00016630: 2061 746f 6d49 6432 290a 2020 2020 2020   atomId2).      
-00016640: 2020 6368 6169 6e41 7373 6967 6e33 203d    chainAssign3 =
-00016650: 2073 656c 662e 6173 7369 676e 436f 6f72   self.assignCoor
-00016660: 6450 6f6c 796d 6572 5365 7175 656e 6365  dPolymerSequence
-00016670: 2873 6571 4964 332c 2061 746f 6d49 6433  (seqId3, atomId3
-00016680: 290a 2020 2020 2020 2020 6368 6169 6e41  ).        chainA
-00016690: 7373 6967 6e34 203d 2073 656c 662e 6173  ssign4 = self.as
-000166a0: 7369 676e 436f 6f72 6450 6f6c 796d 6572  signCoordPolymer
-000166b0: 5365 7175 656e 6365 2873 6571 4964 342c  Sequence(seqId4,
-000166c0: 2061 746f 6d49 6434 290a 0a20 2020 2020   atomId4)..     
-000166d0: 2020 2069 6620 6c65 6e28 6368 6169 6e41     if len(chainA
-000166e0: 7373 6967 6e31 2920 3d3d 2030 206f 7220  ssign1) == 0 or 
-000166f0: 6c65 6e28 6368 6169 6e41 7373 6967 6e32  len(chainAssign2
-00016700: 2920 3d3d 2030 5c0a 2020 2020 2020 2020  ) == 0\.        
-00016710: 2020 206f 7220 6c65 6e28 6368 6169 6e41     or len(chainA
-00016720: 7373 6967 6e33 2920 3d3d 2030 206f 7220  ssign3) == 0 or 
-00016730: 6c65 6e28 6368 6169 6e41 7373 6967 6e34  len(chainAssign4
-00016740: 2920 3d3d 2030 3a0a 2020 2020 2020 2020  ) == 0:.        
-00016750: 2020 2020 7265 7475 726e 0a0a 2020 2020      return..    
-00016760: 2020 2020 7365 6c66 2e73 656c 6563 7443      self.selectC
-00016770: 6f6f 7264 4174 6f6d 7328 6368 6169 6e41  oordAtoms(chainA
-00016780: 7373 6967 6e31 2c20 7365 7149 6431 2c20  ssign1, seqId1, 
-00016790: 6174 6f6d 4964 312c 2046 616c 7365 2c20  atomId1, False, 
-000167a0: 2761 2064 6968 6564 7261 6c20 616e 676c  'a dihedral angl
-000167b0: 6527 290a 2020 2020 2020 2020 7365 6c66  e').        self
-000167c0: 2e73 656c 6563 7443 6f6f 7264 4174 6f6d  .selectCoordAtom
-000167d0: 7328 6368 6169 6e41 7373 6967 6e32 2c20  s(chainAssign2, 
-000167e0: 7365 7149 6432 2c20 6174 6f6d 4964 322c  seqId2, atomId2,
-000167f0: 2046 616c 7365 2c20 2761 2064 6968 6564   False, 'a dihed
-00016800: 7261 6c20 616e 676c 6527 290a 2020 2020  ral angle').    
-00016810: 2020 2020 7365 6c66 2e73 656c 6563 7443      self.selectC
-00016820: 6f6f 7264 4174 6f6d 7328 6368 6169 6e41  oordAtoms(chainA
-00016830: 7373 6967 6e33 2c20 7365 7149 6433 2c20  ssign3, seqId3, 
-00016840: 6174 6f6d 4964 332c 2046 616c 7365 2c20  atomId3, False, 
-00016850: 2761 2064 6968 6564 7261 6c20 616e 676c  'a dihedral angl
-00016860: 6527 290a 2020 2020 2020 2020 7365 6c66  e').        self
-00016870: 2e73 656c 6563 7443 6f6f 7264 4174 6f6d  .selectCoordAtom
-00016880: 7328 6368 6169 6e41 7373 6967 6e34 2c20  s(chainAssign4, 
-00016890: 7365 7149 6434 2c20 6174 6f6d 4964 342c  seqId4, atomId4,
-000168a0: 2046 616c 7365 2c20 2761 2064 6968 6564   False, 'a dihed
-000168b0: 7261 6c20 616e 676c 6527 290a 0a20 2020  ral angle')..   
-000168c0: 2020 2020 2069 6620 6c65 6e28 7365 6c66       if len(self
-000168d0: 2e61 746f 6d53 656c 6563 7469 6f6e 5365  .atomSelectionSe
-000168e0: 7429 203c 2034 3a0a 2020 2020 2020 2020  t) < 4:.        
-000168f0: 2020 2020 7265 7475 726e 0a0a 2020 2020      return..    
-00016900: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
-00016910: 6172 6555 6e69 7175 6543 6f6f 7264 4174  areUniqueCoordAt
-00016920: 6f6d 7328 2761 2044 6968 6564 7261 6c20  oms('a Dihedral 
-00016930: 616e 676c 6527 293a 0a20 2020 2020 2020  angle'):.       
-00016940: 2020 2020 2072 6574 7572 6e0a 0a20 2020       return..   
-00016950: 2020 2020 2069 6620 7365 6c66 2e5f 5f63       if self.__c
-00016960: 7265 6174 6553 6644 6963 743a 0a20 2020  reateSfDict:.   
-00016970: 2020 2020 2020 2020 2073 6620 3d20 7365           sf = se
-00016980: 6c66 2e5f 5f67 6574 5366 2870 6f74 656e  lf.__getSf(poten
-00016990: 7469 616c 5479 7065 3d67 6574 506f 7465  tialType=getPote
-000169a0: 6e74 6961 6c54 7970 6528 7365 6c66 2e5f  ntialType(self._
-000169b0: 5f66 696c 655f 7479 7065 2c20 7365 6c66  _file_type, self
-000169c0: 2e5f 5f63 7572 5f73 7562 7479 7065 2c20  .__cur_subtype, 
-000169d0: 6473 7446 756e 6329 290a 0a20 2020 2020  dstFunc))..     
-000169e0: 2020 2063 6f6d 7049 6420 3d20 7365 6c66     compId = self
-000169f0: 2e61 746f 6d53 656c 6563 7469 6f6e 5365  .atomSelectionSe
-00016a00: 745b 305d 5b30 5d5b 2763 6f6d 705f 6964  t[0][0]['comp_id
-00016a10: 275d 0a20 2020 2020 2020 2070 6570 7469  '].        pepti
-00016a20: 6465 2c20 6e75 636c 656f 7469 6465 2c20  de, nucleotide, 
-00016a30: 6361 7262 6f68 7964 7261 7465 203d 2073  carbohydrate = s
-00016a40: 656c 662e 5f5f 6373 5374 6174 2e67 6574  elf.__csStat.get
-00016a50: 5479 7065 4f66 436f 6d70 4964 2863 6f6d  TypeOfCompId(com
-00016a60: 7049 6429 0a0a 2020 2020 2020 2020 6966  pId)..        if
-00016a70: 2073 656c 662e 5f5f 6375 725f 6e65 7374   self.__cur_nest
-00016a80: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-00016a90: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00016aa0: 662e 5f5f 6465 6275 673a 0a20 2020 2020  f.__debug:.     
-00016ab0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00016ac0: 2866 224e 4553 5445 443a 207b 7365 6c66  (f"NESTED: {self
-00016ad0: 2e5f 5f63 7572 5f6e 6573 747d 2229 0a0a  .__cur_nest}")..
-00016ae0: 2020 2020 2020 2020 6669 7273 745f 6974          first_it
-00016af0: 656d 203d 2054 7275 650a 0a20 2020 2020  em = True..     
-00016b00: 2020 2066 6f72 2061 746f 6d31 2c20 6174     for atom1, at
-00016b10: 6f6d 322c 2061 746f 6d33 2c20 6174 6f6d  om2, atom3, atom
-00016b20: 3420 696e 2069 7465 7274 6f6f 6c73 2e70  4 in itertools.p
-00016b30: 726f 6475 6374 2873 656c 662e 6174 6f6d  roduct(self.atom
-00016b40: 5365 6c65 6374 696f 6e53 6574 5b30 5d2c  SelectionSet[0],
-00016b50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014010: 2766 756e 635f 7479 7065 7327 2069 6e20  'func_types' in 
+00014020: 6669 7273 7446 756e 633a 0a20 2020 2020  firstFunc:.     
+00014030: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00014040: 6972 7374 4675 6e63 5b27 6675 6e63 5f74  irstFunc['func_t
+00014050: 7970 6573 275d 2e61 7070 656e 6428 6675  ypes'].append(fu
+00014060: 6e63 5b27 6e61 6d65 275d 290a 2020 2020  nc['name']).    
+00014070: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00014080: 7263 4675 6e63 2069 7320 4e6f 6e65 3a0a  rcFunc is None:.
+00014090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000140a0: 2020 2020 7372 6346 756e 6320 3d20 636f      srcFunc = co
+000140b0: 7079 2e63 6f70 7928 6675 6e63 290a 2020  py.copy(func).  
+000140c0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000140d0: 2027 7461 7267 6574 5f76 616c 7565 2720   'target_value' 
+000140e0: 696e 2066 756e 633a 0a20 2020 2020 2020  in func:.       
+000140f0: 2020 2020 2020 2020 2020 2020 2074 6172               tar
+00014100: 6765 745f 7661 6c75 6520 3d20 6675 6e63  get_value = func
+00014110: 5b27 7461 7267 6574 5f76 616c 7565 275d  ['target_value']
+00014120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014130: 2020 2020 2064 656c 2073 7263 4675 6e63       del srcFunc
+00014140: 5b27 7461 7267 6574 5f76 616c 7565 275d  ['target_value']
+00014150: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014160: 2069 6620 276c 6f77 6572 5f6c 696d 6974   if 'lower_limit
+00014170: 2720 696e 2066 756e 633a 0a20 2020 2020  ' in func:.     
+00014180: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00014190: 6f77 6572 5f6c 696d 6974 203d 2066 756e  ower_limit = fun
+000141a0: 635b 276c 6f77 6572 5f6c 696d 6974 275d  c['lower_limit']
+000141b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000141c0: 2020 2020 2064 656c 2073 7263 4675 6e63       del srcFunc
+000141d0: 5b27 6c6f 7765 725f 6c69 6d69 7427 5d0a  ['lower_limit'].
+000141e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000141f0: 6966 2027 7570 7065 725f 6c69 6d69 7427  if 'upper_limit'
+00014200: 2069 6e20 6675 6e63 3a0a 2020 2020 2020   in func:.      
+00014210: 2020 2020 2020 2020 2020 2020 2020 7570                up
+00014220: 7065 725f 6c69 6d69 7420 3d20 6675 6e63  per_limit = func
+00014230: 5b27 7570 7065 725f 6c69 6d69 7427 5d0a  ['upper_limit'].
+00014240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014250: 2020 2020 6465 6c20 7372 6346 756e 635b      del srcFunc[
+00014260: 2775 7070 6572 5f6c 696d 6974 275d 0a20  'upper_limit']. 
+00014270: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00014280: 6620 276c 6f77 6572 5f6c 696e 6561 725f  f 'lower_linear_
+00014290: 6c69 6d69 7427 2069 6e20 6675 6e63 3a0a  limit' in func:.
+000142a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000142b0: 2020 2020 6c6f 7765 725f 6c69 6e65 6172      lower_linear
+000142c0: 5f6c 696d 6974 203d 2066 756e 635b 276c  _limit = func['l
+000142d0: 6f77 6572 5f6c 696e 6561 725f 6c69 6d69  ower_linear_limi
+000142e0: 7427 5d0a 2020 2020 2020 2020 2020 2020  t'].            
+000142f0: 2020 2020 2020 2020 6465 6c20 7372 6346          del srcF
+00014300: 756e 635b 276c 6f77 6572 5f6c 696e 6561  unc['lower_linea
+00014310: 725f 6c69 6d69 7427 5d0a 2020 2020 2020  r_limit'].      
+00014320: 2020 2020 2020 2020 2020 6966 2027 7570            if 'up
+00014330: 7065 725f 6c69 6e65 6172 5f6c 696d 6974  per_linear_limit
+00014340: 2720 696e 2066 756e 633a 0a20 2020 2020  ' in func:.     
+00014350: 2020 2020 2020 2020 2020 2020 2020 2075                 u
+00014360: 7070 6572 5f6c 696e 6561 725f 6c69 6d69  pper_linear_limi
+00014370: 7420 3d20 6675 6e63 5b27 7570 7065 725f  t = func['upper_
+00014380: 6c69 6e65 6172 5f6c 696d 6974 275d 0a20  linear_limit']. 
+00014390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000143a0: 2020 2064 656c 2073 7263 4675 6e63 5b27     del srcFunc['
+000143b0: 7570 7065 725f 6c69 6e65 6172 5f6c 696d  upper_linear_lim
+000143c0: 6974 275d 0a20 2020 2020 2020 2020 2020  it'].           
+000143d0: 2020 2020 206c 6576 656c 202b 3d20 310a       level += 1.
+000143e0: 0a20 2020 2020 2020 2069 6620 7372 6346  .        if srcF
+000143f0: 756e 6320 6973 204e 6f6e 653a 2020 2320  unc is None:  # 
+00014400: 6572 726f 7273 2061 7265 2061 6c72 6561  errors are alrea
+00014410: 6479 2063 6175 6768 740a 2020 2020 2020  dy caught.      
+00014420: 2020 2020 2020 7265 7475 726e 204e 6f6e        return Non
+00014430: 650a 0a20 2020 2020 2020 2069 6620 6c65  e..        if le
+00014440: 7665 6c20 3e20 313a 0a20 2020 2020 2020  vel > 1:.       
+00014450: 2020 2020 2073 656c 662e 5f5f 662e 6170       self.__f.ap
+00014460: 7065 6e64 2866 225b 556e 7375 7070 6f72  pend(f"[Unsuppor
+00014470: 7465 6420 6461 7461 5d20 7b73 656c 662e  ted data] {self.
+00014480: 5f5f 6765 7443 7572 7265 6e74 5265 7374  __getCurrentRest
+00014490: 7261 696e 7428 297d 220a 2020 2020 2020  raint()}".      
+000144a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000144b0: 2020 2020 2020 6622 546f 6f20 636f 6d70        f"Too comp
+000144c0: 6c65 7820 636f 6e73 7472 6169 6e74 2066  lex constraint f
+000144d0: 756e 6374 696f 6e20 7b66 6972 7374 4675  unction {firstFu
+000144e0: 6e63 7d20 6361 6e20 6e6f 7420 6265 2063  nc} can not be c
+000144f0: 6f6e 7665 7274 6564 2074 6f20 4e45 462f  onverted to NEF/
+00014500: 4e4d 522d 5354 4152 2064 6174 612e 2229  NMR-STAR data.")
+00014510: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00014520: 7572 6e20 4e6f 6e65 0a0a 2020 2020 2020  urn None..      
+00014530: 2020 6966 2074 6172 6765 745f 7661 6c75    if target_valu
+00014540: 6520 6973 204e 6f6e 6520 616e 6420 6c6f  e is None and lo
+00014550: 7765 725f 6c69 6d69 7420 6973 204e 6f6e  wer_limit is Non
+00014560: 6520 616e 6420 7570 7065 725f 6c69 6d69  e and upper_limi
+00014570: 7420 6973 204e 6f6e 655c 0a20 2020 2020  t is None\.     
+00014580: 2020 2020 2020 616e 6420 6c6f 7765 725f        and lower_
+00014590: 6c69 6e65 6172 5f6c 696d 6974 2069 7320  linear_limit is 
+000145a0: 4e6f 6e65 2061 6e64 2075 7070 6572 5f6c  None and upper_l
+000145b0: 696e 6561 725f 6c69 6d69 7420 6973 204e  inear_limit is N
+000145c0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+000145d0: 2073 656c 662e 5f5f 662e 6170 7065 6e64   self.__f.append
+000145e0: 2866 225b 556e 7375 7070 6f72 7465 6420  (f"[Unsupported 
+000145f0: 6461 7461 5d20 7b73 656c 662e 5f5f 6765  data] {self.__ge
+00014600: 7443 7572 7265 6e74 5265 7374 7261 696e  tCurrentRestrain
+00014610: 7428 297d 220a 2020 2020 2020 2020 2020  t()}".          
+00014620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014630: 2020 6622 5468 6520 636f 6e73 7472 6169    f"The constrai
+00014640: 6e74 2066 756e 6374 696f 6e20 7b73 7263  nt function {src
+00014650: 4675 6e63 7d20 6361 6e20 6e6f 7420 6265  Func} can not be
+00014660: 2063 6f6e 7665 7274 6564 2074 6f20 4e45   converted to NE
+00014670: 462f 4e4d 522d 5354 4152 2064 6174 612e  F/NMR-STAR data.
+00014680: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
+00014690: 6574 7572 6e20 4e6f 6e65 0a0a 2020 2020  eturn None..    
+000146a0: 2020 2020 7661 6c69 6452 616e 6765 203d      validRange =
+000146b0: 2054 7275 650a 2020 2020 2020 2020 6473   True.        ds
+000146c0: 7446 756e 6320 3d20 7b27 7765 6967 6874  tFunc = {'weight
+000146d0: 273a 2077 6569 6768 747d 0a0a 2020 2020  ': weight}..    
+000146e0: 2020 2020 6966 2073 656c 662e 5f5f 636f      if self.__co
+000146f0: 7272 6563 7443 6972 6375 6c61 7253 6869  rrectCircularShi
+00014700: 6674 3a0a 2020 2020 2020 2020 2020 2020  ft:.            
+00014710: 5f61 7272 6179 203d 206e 756d 7079 2e61  _array = numpy.a
+00014720: 7272 6179 285b 7461 7267 6574 5f76 616c  rray([target_val
+00014730: 7565 2c20 6c6f 7765 725f 6c69 6d69 742c  ue, lower_limit,
+00014740: 2075 7070 6572 5f6c 696d 6974 2c20 6c6f   upper_limit, lo
+00014750: 7765 725f 6c69 6e65 6172 5f6c 696d 6974  wer_linear_limit
+00014760: 2c20 7570 7065 725f 6c69 6e65 6172 5f6c  , upper_linear_l
+00014770: 696d 6974 5d2c 0a20 2020 2020 2020 2020  imit],.         
+00014780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014790: 2020 2020 2020 2020 6474 7970 653d 666c          dtype=fl
+000147a0: 6f61 7429 0a0a 2020 2020 2020 2020 2020  oat)..          
+000147b0: 2020 7368 6966 7420 3d20 4e6f 6e65 0a20    shift = None. 
+000147c0: 2020 2020 2020 2020 2020 2069 6620 6e75             if nu
+000147d0: 6d70 792e 6e61 6e6d 696e 285f 6172 7261  mpy.nanmin(_arra
+000147e0: 7929 203e 3d20 5448 5245 5348 484f 4c44  y) >= THRESHHOLD
+000147f0: 5f46 4f52 5f43 4952 4355 4c41 525f 5348  _FOR_CIRCULAR_SH
+00014800: 4946 543a 0a20 2020 2020 2020 2020 2020  IFT:.           
+00014810: 2020 2020 2073 6869 6674 203d 202d 286e       shift = -(n
+00014820: 756d 7079 2e6e 616e 6d61 7828 5f61 7272  umpy.nanmax(_arr
+00014830: 6179 2920 2f2f 2033 3630 2920 2a20 3336  ay) // 360) * 36
+00014840: 300a 2020 2020 2020 2020 2020 2020 656c  0.            el
+00014850: 6966 206e 756d 7079 2e6e 616e 6d61 7828  if numpy.nanmax(
+00014860: 5f61 7272 6179 2920 3c3d 202d 5448 5245  _array) <= -THRE
+00014870: 5348 484f 4c44 5f46 4f52 5f43 4952 4355  SHHOLD_FOR_CIRCU
+00014880: 4c41 525f 5348 4946 543a 0a20 2020 2020  LAR_SHIFT:.     
+00014890: 2020 2020 2020 2020 2020 2073 6869 6674             shift
+000148a0: 203d 202d 286e 756d 7079 2e6e 616e 6d69   = -(numpy.nanmi
+000148b0: 6e28 5f61 7272 6179 2920 2f2f 2033 3630  n(_array) // 360
+000148c0: 2920 2a20 3336 300a 2020 2020 2020 2020  ) * 360.        
+000148d0: 2020 2020 6966 2073 6869 6674 2069 7320      if shift is 
+000148e0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+000148f0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00014900: 5f66 2e61 7070 656e 6428 6622 5b52 616e  _f.append(f"[Ran
+00014910: 6765 2076 616c 7565 2077 6172 6e69 6e67  ge value warning
+00014920: 5d20 7b73 656c 662e 5f5f 6765 7443 7572  ] {self.__getCur
+00014930: 7265 6e74 5265 7374 7261 696e 7428 297d  rentRestraint()}
+00014940: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00014950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014960: 2020 2254 6865 2074 6172 6765 742f 6c69    "The target/li
+00014970: 6d69 7420 7661 6c75 6573 2066 6f72 2061  mit values for a
+00014980: 6e20 616e 676c 6520 7265 7374 7261 696e  n angle restrain
+00014990: 7420 6861 7665 2062 6565 6e20 6369 7263  t have been circ
+000149a0: 756c 6172 6c79 2073 6869 6674 6564 2022  ularly shifted "
+000149b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000149c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000149d0: 2066 2274 6f20 6669 7420 7769 7468 696e   f"to fit within
+000149e0: 2072 616e 6765 207b 414e 474c 455f 5245   range {ANGLE_RE
+000149f0: 5354 5241 494e 545f 4552 524f 527d 2e22  STRAINT_ERROR}."
+00014a00: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00014a10: 2020 6966 2074 6172 6765 745f 7661 6c75    if target_valu
+00014a20: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
+00014a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014a40: 2020 2074 6172 6765 745f 7661 6c75 6520     target_value 
+00014a50: 2b3d 2073 6869 6674 0a20 2020 2020 2020  += shift.       
+00014a60: 2020 2020 2020 2020 2069 6620 6c6f 7765           if lowe
+00014a70: 725f 6c69 6d69 7420 6973 206e 6f74 204e  r_limit is not N
+00014a80: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00014a90: 2020 2020 2020 2020 206c 6f77 6572 5f6c           lower_l
+00014aa0: 696d 6974 202b 3d20 7368 6966 740a 2020  imit += shift.  
+00014ab0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00014ac0: 2075 7070 6572 5f6c 696d 6974 2069 7320   upper_limit is 
+00014ad0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00014ae0: 2020 2020 2020 2020 2020 2020 2020 7570                up
+00014af0: 7065 725f 6c69 6d69 7420 2b3d 2073 6869  per_limit += shi
+00014b00: 6674 0a20 2020 2020 2020 2020 2020 2020  ft.             
+00014b10: 2020 2069 6620 6c6f 7765 725f 6c69 6e65     if lower_line
+00014b20: 6172 5f6c 696d 6974 2069 7320 6e6f 7420  ar_limit is not 
+00014b30: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00014b40: 2020 2020 2020 2020 2020 7570 7065 725f            upper_
+00014b50: 6c69 6e65 6172 5f6c 696d 6974 202b 3d20  linear_limit += 
+00014b60: 7368 6966 740a 2020 2020 2020 2020 2020  shift.          
+00014b70: 2020 2020 2020 6966 2075 7070 6572 5f6c        if upper_l
+00014b80: 696e 6561 725f 6c69 6d69 7420 6973 206e  inear_limit is n
+00014b90: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+00014ba0: 2020 2020 2020 2020 2020 2020 2075 7070               upp
+00014bb0: 6572 5f6c 696e 6561 725f 6c69 6d69 7420  er_linear_limit 
+00014bc0: 2b3d 2073 6869 6674 0a0a 2020 2020 2020  += shift..      
+00014bd0: 2020 6966 2074 6172 6765 745f 7661 6c75    if target_valu
+00014be0: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
+00014bf0: 2020 2020 2020 2020 2020 2069 6620 414e             if AN
+00014c00: 474c 455f 4552 524f 525f 4d49 4e20 3c20  GLE_ERROR_MIN < 
+00014c10: 7461 7267 6574 5f76 616c 7565 203c 2041  target_value < A
+00014c20: 4e47 4c45 5f45 5252 4f52 5f4d 4158 3a0a  NGLE_ERROR_MAX:.
+00014c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014c40: 6473 7446 756e 635b 2774 6172 6765 745f  dstFunc['target_
+00014c50: 7661 6c75 6527 5d20 3d20 6622 7b74 6172  value'] = f"{tar
+00014c60: 6765 745f 7661 6c75 657d 220a 2020 2020  get_value}".    
+00014c70: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00014c80: 2020 2020 2020 2020 2020 2020 2020 7661                va
+00014c90: 6c69 6452 616e 6765 203d 2046 616c 7365  lidRange = False
+00014ca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014cb0: 2073 656c 662e 5f5f 662e 6170 7065 6e64   self.__f.append
+00014cc0: 2866 225b 5261 6e67 6520 7661 6c75 6520  (f"[Range value 
+00014cd0: 6572 726f 725d 207b 7365 6c66 2e5f 5f67  error] {self.__g
+00014ce0: 6574 4375 7272 656e 7452 6573 7472 6169  etCurrentRestrai
+00014cf0: 6e74 2829 7d22 0a20 2020 2020 2020 2020  nt()}".         
+00014d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014d10: 2020 2020 2020 2066 227b 7372 6346 756e         f"{srcFun
+00014d20: 637d 2c20 7468 6520 7461 7267 6574 2076  c}, the target v
+00014d30: 616c 7565 3d27 7b74 6172 6765 745f 7661  alue='{target_va
+00014d40: 6c75 657d 2720 6d75 7374 2062 6520 7769  lue}' must be wi
+00014d50: 7468 696e 2072 616e 6765 207b 414e 474c  thin range {ANGL
+00014d60: 455f 5245 5354 5241 494e 545f 4552 524f  E_RESTRAINT_ERRO
+00014d70: 527d 2e22 290a 0a20 2020 2020 2020 2069  R}.")..        i
+00014d80: 6620 6c6f 7765 725f 6c69 6d69 7420 6973  f lower_limit is
+00014d90: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+00014da0: 2020 2020 2020 2069 6620 414e 474c 455f         if ANGLE_
+00014db0: 4552 524f 525f 4d49 4e20 3c3d 206c 6f77  ERROR_MIN <= low
+00014dc0: 6572 5f6c 696d 6974 203c 2041 4e47 4c45  er_limit < ANGLE
+00014dd0: 5f45 5252 4f52 5f4d 4158 3a0a 2020 2020  _ERROR_MAX:.    
+00014de0: 2020 2020 2020 2020 2020 2020 6473 7446              dstF
+00014df0: 756e 635b 276c 6f77 6572 5f6c 696d 6974  unc['lower_limit
+00014e00: 275d 203d 2066 227b 6c6f 7765 725f 6c69  '] = f"{lower_li
+00014e10: 6d69 747d 220a 2020 2020 2020 2020 2020  mit}".          
+00014e20: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00014e30: 2020 2020 2020 2020 7661 6c69 6452 616e          validRan
+00014e40: 6765 203d 2046 616c 7365 0a20 2020 2020  ge = False.     
+00014e50: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00014e60: 5f5f 662e 6170 7065 6e64 2866 225b 5261  __f.append(f"[Ra
+00014e70: 6e67 6520 7661 6c75 6520 6572 726f 725d  nge value error]
+00014e80: 207b 7365 6c66 2e5f 5f67 6574 4375 7272   {self.__getCurr
+00014e90: 656e 7452 6573 7472 6169 6e74 2829 7d22  entRestraint()}"
+00014ea0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014ec0: 2066 227b 7372 6346 756e 637d 2c20 7468   f"{srcFunc}, th
+00014ed0: 6520 6c6f 7765 7220 6c69 6d69 7420 7661  e lower limit va
+00014ee0: 6c75 653d 277b 6c6f 7765 725f 6c69 6d69  lue='{lower_limi
+00014ef0: 747d 2720 6d75 7374 2062 6520 7769 7468  t}' must be with
+00014f00: 696e 2072 616e 6765 207b 414e 474c 455f  in range {ANGLE_
+00014f10: 5245 5354 5241 494e 545f 4552 524f 527d  RESTRAINT_ERROR}
+00014f20: 2e22 290a 0a20 2020 2020 2020 2069 6620  .")..        if 
+00014f30: 7570 7065 725f 6c69 6d69 7420 6973 206e  upper_limit is n
+00014f40: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+00014f50: 2020 2020 2069 6620 414e 474c 455f 4552       if ANGLE_ER
+00014f60: 524f 525f 4d49 4e20 3c20 7570 7065 725f  ROR_MIN < upper_
+00014f70: 6c69 6d69 7420 3c3d 2041 4e47 4c45 5f45  limit <= ANGLE_E
+00014f80: 5252 4f52 5f4d 4158 3a0a 2020 2020 2020  RROR_MAX:.      
+00014f90: 2020 2020 2020 2020 2020 6473 7446 756e            dstFun
+00014fa0: 635b 2775 7070 6572 5f6c 696d 6974 275d  c['upper_limit']
+00014fb0: 203d 2066 227b 7570 7065 725f 6c69 6d69   = f"{upper_limi
+00014fc0: 747d 220a 2020 2020 2020 2020 2020 2020  t}".            
+00014fd0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00014fe0: 2020 2020 2020 7661 6c69 6452 616e 6765        validRange
+00014ff0: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
+00015000: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
+00015010: 662e 6170 7065 6e64 2866 225b 5261 6e67  f.append(f"[Rang
+00015020: 6520 7661 6c75 6520 6572 726f 725d 207b  e value error] {
+00015030: 7365 6c66 2e5f 5f67 6574 4375 7272 656e  self.__getCurren
+00015040: 7452 6573 7472 6169 6e74 2829 7d22 0a20  tRestraint()}". 
+00015050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015060: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00015070: 227b 7372 6346 756e 637d 2c20 7468 6520  "{srcFunc}, the 
+00015080: 7570 7065 7220 6c69 6d69 7420 7661 6c75  upper limit valu
+00015090: 653d 277b 7570 7065 725f 6c69 6d69 747d  e='{upper_limit}
+000150a0: 2720 6d75 7374 2062 6520 7769 7468 696e  ' must be within
+000150b0: 2072 616e 6765 207b 414e 474c 455f 5245   range {ANGLE_RE
+000150c0: 5354 5241 494e 545f 4552 524f 527d 2e22  STRAINT_ERROR}."
+000150d0: 290a 0a20 2020 2020 2020 2069 6620 6c6f  )..        if lo
+000150e0: 7765 725f 6c69 6e65 6172 5f6c 696d 6974  wer_linear_limit
+000150f0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+00015100: 2020 2020 2020 2020 2020 6966 2041 4e47            if ANG
+00015110: 4c45 5f45 5252 4f52 5f4d 494e 203c 3d20  LE_ERROR_MIN <= 
+00015120: 6c6f 7765 725f 6c69 6e65 6172 5f6c 696d  lower_linear_lim
+00015130: 6974 203c 2041 4e47 4c45 5f45 5252 4f52  it < ANGLE_ERROR
+00015140: 5f4d 4158 3a0a 2020 2020 2020 2020 2020  _MAX:.          
+00015150: 2020 2020 2020 6473 7446 756e 635b 276c        dstFunc['l
+00015160: 6f77 6572 5f6c 696e 6561 725f 6c69 6d69  ower_linear_limi
+00015170: 7427 5d20 3d20 6622 7b6c 6f77 6572 5f6c  t'] = f"{lower_l
+00015180: 696e 6561 725f 6c69 6d69 747d 220a 2020  inear_limit}".  
+00015190: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+000151a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000151b0: 7661 6c69 6452 616e 6765 203d 2046 616c  validRange = Fal
+000151c0: 7365 0a20 2020 2020 2020 2020 2020 2020  se.             
+000151d0: 2020 2073 656c 662e 5f5f 662e 6170 7065     self.__f.appe
+000151e0: 6e64 2866 225b 5261 6e67 6520 7661 6c75  nd(f"[Range valu
+000151f0: 6520 6572 726f 725d 207b 7365 6c66 2e5f  e error] {self._
+00015200: 5f67 6574 4375 7272 656e 7452 6573 7472  _getCurrentRestr
+00015210: 6169 6e74 2829 7d22 0a20 2020 2020 2020  aint()}".       
+00015220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015230: 2020 2020 2020 2020 2066 227b 7372 6346           f"{srcF
+00015240: 756e 637d 2c20 7468 6520 6c6f 7765 7220  unc}, the lower 
+00015250: 6c69 6e65 6172 206c 696d 6974 2076 616c  linear limit val
+00015260: 7565 3d27 7b6c 6f77 6572 5f6c 696e 6561  ue='{lower_linea
+00015270: 725f 6c69 6d69 747d 2720 6d75 7374 2062  r_limit}' must b
+00015280: 6520 7769 7468 696e 2072 616e 6765 207b  e within range {
+00015290: 414e 474c 455f 5245 5354 5241 494e 545f  ANGLE_RESTRAINT_
+000152a0: 4552 524f 527d 2e22 290a 0a20 2020 2020  ERROR}.")..     
+000152b0: 2020 2069 6620 7570 7065 725f 6c69 6e65     if upper_line
+000152c0: 6172 5f6c 696d 6974 2069 7320 6e6f 7420  ar_limit is not 
+000152d0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+000152e0: 2020 6966 2041 4e47 4c45 5f45 5252 4f52    if ANGLE_ERROR
+000152f0: 5f4d 494e 203c 2075 7070 6572 5f6c 696e  _MIN < upper_lin
+00015300: 6561 725f 6c69 6d69 7420 3c3d 2041 4e47  ear_limit <= ANG
+00015310: 4c45 5f45 5252 4f52 5f4d 4158 3a0a 2020  LE_ERROR_MAX:.  
+00015320: 2020 2020 2020 2020 2020 2020 2020 6473                ds
+00015330: 7446 756e 635b 2775 7070 6572 5f6c 696e  tFunc['upper_lin
+00015340: 6561 725f 6c69 6d69 7427 5d20 3d20 6622  ear_limit'] = f"
+00015350: 7b75 7070 6572 5f6c 696e 6561 725f 6c69  {upper_linear_li
+00015360: 6d69 747d 220a 2020 2020 2020 2020 2020  mit}".          
+00015370: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00015380: 2020 2020 2020 2020 7661 6c69 6452 616e          validRan
+00015390: 6765 203d 2046 616c 7365 0a20 2020 2020  ge = False.     
+000153a0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000153b0: 5f5f 662e 6170 7065 6e64 2866 225b 5261  __f.append(f"[Ra
+000153c0: 6e67 6520 7661 6c75 6520 6572 726f 725d  nge value error]
+000153d0: 207b 7365 6c66 2e5f 5f67 6574 4375 7272   {self.__getCurr
+000153e0: 656e 7452 6573 7472 6169 6e74 2829 7d22  entRestraint()}"
+000153f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015410: 2066 227b 7372 6346 756e 637d 2c20 7468   f"{srcFunc}, th
+00015420: 6520 7570 7065 7220 6c69 6e65 6172 206c  e upper linear l
+00015430: 696d 6974 2076 616c 7565 3d27 7b75 7070  imit value='{upp
+00015440: 6572 5f6c 696e 6561 725f 6c69 6d69 747d  er_linear_limit}
+00015450: 2720 6d75 7374 2062 6520 7769 7468 696e  ' must be within
+00015460: 2072 616e 6765 207b 414e 474c 455f 5245   range {ANGLE_RE
+00015470: 5354 5241 494e 545f 4552 524f 527d 2e22  STRAINT_ERROR}."
+00015480: 290a 0a20 2020 2020 2020 2069 6620 6c6f  )..        if lo
+00015490: 7765 725f 6c69 6d69 7420 6973 206e 6f74  wer_limit is not
+000154a0: 204e 6f6e 6520 616e 6420 6c6f 7765 725f   None and lower_
+000154b0: 6c69 6e65 6172 5f6c 696d 6974 2069 7320  linear_limit is 
+000154c0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+000154d0: 2020 2020 2020 6966 206c 6f77 6572 5f6c        if lower_l
+000154e0: 696e 6561 725f 6c69 6d69 7420 3e20 6c6f  inear_limit > lo
+000154f0: 7765 725f 6c69 6d69 743a 0a20 2020 2020  wer_limit:.     
+00015500: 2020 2020 2020 2020 2020 2076 616c 6964             valid
+00015510: 5261 6e67 6520 3d20 4661 6c73 650a 2020  Range = False.  
+00015520: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00015530: 6c66 2e5f 5f66 2e61 7070 656e 6428 6622  lf.__f.append(f"
+00015540: 5b52 616e 6765 2076 616c 7565 2065 7272  [Range value err
+00015550: 6f72 5d20 7b73 656c 662e 5f5f 6765 7443  or] {self.__getC
+00015560: 7572 7265 6e74 5265 7374 7261 696e 7428  urrentRestraint(
+00015570: 297d 220a 2020 2020 2020 2020 2020 2020  )}".            
+00015580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015590: 2020 2020 6622 7b73 7263 4675 6e63 7d2c      f"{srcFunc},
+000155a0: 2074 6865 206c 6f77 6572 206c 696e 6561   the lower linea
+000155b0: 7220 6c69 6d69 7420 7661 6c75 653d 277b  r limit value='{
+000155c0: 6c6f 7765 725f 6c69 6e65 6172 5f6c 696d  lower_linear_lim
+000155d0: 6974 7d27 206d 7573 7420 6265 206c 6573  it}' must be les
+000155e0: 7320 7468 616e 2074 6865 206c 6f77 6572  s than the lower
+000155f0: 206c 696d 6974 2076 616c 7565 2027 7b6c   limit value '{l
+00015600: 6f77 6572 5f6c 696d 6974 7d27 2e22 290a  ower_limit}'.").
+00015610: 0a20 2020 2020 2020 2069 6620 7570 7065  .        if uppe
+00015620: 725f 6c69 6d69 7420 6973 206e 6f74 204e  r_limit is not N
+00015630: 6f6e 6520 616e 6420 7570 7065 725f 6c69  one and upper_li
+00015640: 6e65 6172 5f6c 696d 6974 2069 7320 6e6f  near_limit is no
+00015650: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+00015660: 2020 2020 6966 2075 7070 6572 5f6c 696d      if upper_lim
+00015670: 6974 203e 2075 7070 6572 5f6c 696e 6561  it > upper_linea
+00015680: 725f 6c69 6d69 743a 0a20 2020 2020 2020  r_limit:.       
+00015690: 2020 2020 2020 2020 2076 616c 6964 5261           validRa
+000156a0: 6e67 6520 3d20 4661 6c73 650a 2020 2020  nge = False.    
+000156b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000156c0: 2e5f 5f66 2e61 7070 656e 6428 6622 5b52  .__f.append(f"[R
+000156d0: 616e 6765 2076 616c 7565 2065 7272 6f72  ange value error
+000156e0: 5d20 7b73 656c 662e 5f5f 6765 7443 7572  ] {self.__getCur
+000156f0: 7265 6e74 5265 7374 7261 696e 7428 297d  rentRestraint()}
+00015700: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00015710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015720: 2020 6622 7b73 7263 4675 6e63 7d2c 2074    f"{srcFunc}, t
+00015730: 6865 2075 7070 6572 206c 696d 6974 2076  he upper limit v
+00015740: 616c 7565 3d27 7b75 7070 6572 5f6c 696d  alue='{upper_lim
+00015750: 6974 7d27 206d 7573 7420 6265 206c 6573  it}' must be les
+00015760: 7320 7468 616e 2074 6865 2075 7070 6572  s than the upper
+00015770: 206c 696e 6561 7220 6c69 6d69 7420 7661   linear limit va
+00015780: 6c75 6520 277b 7570 7065 725f 6c69 6e65  lue '{upper_line
+00015790: 6172 5f6c 696d 6974 7d27 2e22 290a 0a20  ar_limit}'.").. 
+000157a0: 2020 2020 2020 2069 6620 6e6f 7420 7661         if not va
+000157b0: 6c69 6452 616e 6765 3a0a 2020 2020 2020  lidRange:.      
+000157c0: 2020 2020 2020 7265 7475 726e 204e 6f6e        return Non
+000157d0: 650a 0a20 2020 2020 2020 2069 6620 7461  e..        if ta
+000157e0: 7267 6574 5f76 616c 7565 2069 7320 6e6f  rget_value is no
+000157f0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+00015800: 2020 2020 6966 2041 4e47 4c45 5f52 414e      if ANGLE_RAN
+00015810: 4745 5f4d 494e 203c 3d20 7461 7267 6574  GE_MIN <= target
+00015820: 5f76 616c 7565 203c 3d20 414e 474c 455f  _value <= ANGLE_
+00015830: 5241 4e47 455f 4d41 583a 0a20 2020 2020  RANGE_MAX:.     
+00015840: 2020 2020 2020 2020 2020 2070 6173 730a             pass.
+00015850: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00015860: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00015870: 2020 7365 6c66 2e5f 5f66 2e61 7070 656e    self.__f.appen
+00015880: 6428 6622 5b52 616e 6765 2076 616c 7565  d(f"[Range value
+00015890: 2077 6172 6e69 6e67 5d20 7b73 656c 662e   warning] {self.
+000158a0: 5f5f 6765 7443 7572 7265 6e74 5265 7374  __getCurrentRest
+000158b0: 7261 696e 7428 297d 220a 2020 2020 2020  raint()}".      
+000158c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000158d0: 2020 2020 2020 2020 2020 6622 7b73 7263            f"{src
+000158e0: 4675 6e63 7d2c 2074 6865 2074 6172 6765  Func}, the targe
+000158f0: 7420 7661 6c75 653d 277b 7461 7267 6574  t value='{target
+00015900: 5f76 616c 7565 7d27 2073 686f 756c 6420  _value}' should 
+00015910: 6265 2077 6974 6869 6e20 7261 6e67 6520  be within range 
+00015920: 7b41 4e47 4c45 5f52 4553 5452 4149 4e54  {ANGLE_RESTRAINT
+00015930: 5f52 414e 4745 7d2e 2229 0a0a 2020 2020  _RANGE}.")..    
+00015940: 2020 2020 6966 206c 6f77 6572 5f6c 696d      if lower_lim
+00015950: 6974 2069 7320 6e6f 7420 4e6f 6e65 3a0a  it is not None:.
+00015960: 2020 2020 2020 2020 2020 2020 6966 2041              if A
+00015970: 4e47 4c45 5f52 414e 4745 5f4d 494e 203c  NGLE_RANGE_MIN <
+00015980: 3d20 6c6f 7765 725f 6c69 6d69 7420 3c3d  = lower_limit <=
+00015990: 2041 4e47 4c45 5f52 414e 4745 5f4d 4158   ANGLE_RANGE_MAX
+000159a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000159b0: 2020 7061 7373 0a20 2020 2020 2020 2020    pass.         
+000159c0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+000159d0: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
+000159e0: 662e 6170 7065 6e64 2866 225b 5261 6e67  f.append(f"[Rang
+000159f0: 6520 7661 6c75 6520 7761 726e 696e 675d  e value warning]
+00015a00: 207b 7365 6c66 2e5f 5f67 6574 4375 7272   {self.__getCurr
+00015a10: 656e 7452 6573 7472 6169 6e74 2829 7d22  entRestraint()}"
+00015a20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015a40: 2066 227b 7372 6346 756e 637d 2c20 7468   f"{srcFunc}, th
+00015a50: 6520 6c6f 7765 7220 6c69 6d69 7420 7661  e lower limit va
+00015a60: 6c75 653d 277b 6c6f 7765 725f 6c69 6d69  lue='{lower_limi
+00015a70: 747d 2720 7368 6f75 6c64 2062 6520 7769  t}' should be wi
+00015a80: 7468 696e 2072 616e 6765 207b 414e 474c  thin range {ANGL
+00015a90: 455f 5245 5354 5241 494e 545f 5241 4e47  E_RESTRAINT_RANG
+00015aa0: 457d 2e22 290a 0a20 2020 2020 2020 2069  E}.")..        i
+00015ab0: 6620 7570 7065 725f 6c69 6d69 7420 6973  f upper_limit is
+00015ac0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+00015ad0: 2020 2020 2020 2069 6620 414e 474c 455f         if ANGLE_
+00015ae0: 5241 4e47 455f 4d49 4e20 3c3d 2075 7070  RANGE_MIN <= upp
+00015af0: 6572 5f6c 696d 6974 203c 3d20 414e 474c  er_limit <= ANGL
+00015b00: 455f 5241 4e47 455f 4d41 583a 0a20 2020  E_RANGE_MAX:.   
+00015b10: 2020 2020 2020 2020 2020 2020 2070 6173               pas
+00015b20: 730a 2020 2020 2020 2020 2020 2020 656c  s.            el
+00015b30: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00015b40: 2020 2020 7365 6c66 2e5f 5f66 2e61 7070      self.__f.app
+00015b50: 656e 6428 6622 5b52 616e 6765 2076 616c  end(f"[Range val
+00015b60: 7565 2077 6172 6e69 6e67 5d20 7b73 656c  ue warning] {sel
+00015b70: 662e 5f5f 6765 7443 7572 7265 6e74 5265  f.__getCurrentRe
+00015b80: 7374 7261 696e 7428 297d 220a 2020 2020  straint()}".    
+00015b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015ba0: 2020 2020 2020 2020 2020 2020 6622 7b73              f"{s
+00015bb0: 7263 4675 6e63 7d2c 2074 6865 2075 7070  rcFunc}, the upp
+00015bc0: 6572 206c 696d 6974 2076 616c 7565 3d27  er limit value='
+00015bd0: 7b75 7070 6572 5f6c 696d 6974 7d27 2073  {upper_limit}' s
+00015be0: 686f 756c 6420 6265 2077 6974 6869 6e20  hould be within 
+00015bf0: 7261 6e67 6520 7b41 4e47 4c45 5f52 4553  range {ANGLE_RES
+00015c00: 5452 4149 4e54 5f52 414e 4745 7d2e 2229  TRAINT_RANGE}.")
+00015c10: 0a0a 2020 2020 2020 2020 6966 206c 6f77  ..        if low
+00015c20: 6572 5f6c 696e 6561 725f 6c69 6d69 7420  er_linear_limit 
+00015c30: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+00015c40: 2020 2020 2020 2020 2069 6620 414e 474c           if ANGL
+00015c50: 455f 5241 4e47 455f 4d49 4e20 3c3d 206c  E_RANGE_MIN <= l
+00015c60: 6f77 6572 5f6c 696e 6561 725f 6c69 6d69  ower_linear_limi
+00015c70: 7420 3c3d 2041 4e47 4c45 5f52 414e 4745  t <= ANGLE_RANGE
+00015c80: 5f4d 4158 3a0a 2020 2020 2020 2020 2020  _MAX:.          
+00015c90: 2020 2020 2020 7061 7373 0a20 2020 2020        pass.     
+00015ca0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00015cb0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00015cc0: 662e 5f5f 662e 6170 7065 6e64 2866 225b  f.__f.append(f"[
+00015cd0: 5261 6e67 6520 7661 6c75 6520 7761 726e  Range value warn
+00015ce0: 696e 675d 207b 7365 6c66 2e5f 5f67 6574  ing] {self.__get
+00015cf0: 4375 7272 656e 7452 6573 7472 6169 6e74  CurrentRestraint
+00015d00: 2829 7d22 0a20 2020 2020 2020 2020 2020  ()}".           
+00015d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015d20: 2020 2020 2066 227b 7372 6346 756e 637d       f"{srcFunc}
+00015d30: 2c20 7468 6520 6c6f 7765 7220 6c69 6e65  , the lower line
+00015d40: 6172 206c 696d 6974 2076 616c 7565 3d27  ar limit value='
+00015d50: 7b6c 6f77 6572 5f6c 696e 6561 725f 6c69  {lower_linear_li
+00015d60: 6d69 747d 2720 7368 6f75 6c64 2062 6520  mit}' should be 
+00015d70: 7769 7468 696e 2072 616e 6765 207b 414e  within range {AN
+00015d80: 474c 455f 5245 5354 5241 494e 545f 5241  GLE_RESTRAINT_RA
+00015d90: 4e47 457d 2e22 290a 0a20 2020 2020 2020  NGE}.")..       
+00015da0: 2069 6620 7570 7065 725f 6c69 6e65 6172   if upper_linear
+00015db0: 5f6c 696d 6974 2069 7320 6e6f 7420 4e6f  _limit is not No
+00015dc0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00015dd0: 6966 2041 4e47 4c45 5f52 414e 4745 5f4d  if ANGLE_RANGE_M
+00015de0: 494e 203c 3d20 7570 7065 725f 6c69 6e65  IN <= upper_line
+00015df0: 6172 5f6c 696d 6974 203c 3d20 414e 474c  ar_limit <= ANGL
+00015e00: 455f 5241 4e47 455f 4d41 583a 0a20 2020  E_RANGE_MAX:.   
+00015e10: 2020 2020 2020 2020 2020 2020 2070 6173               pas
+00015e20: 730a 2020 2020 2020 2020 2020 2020 656c  s.            el
+00015e30: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00015e40: 2020 2020 7365 6c66 2e5f 5f66 2e61 7070      self.__f.app
+00015e50: 656e 6428 6622 5b52 616e 6765 2076 616c  end(f"[Range val
+00015e60: 7565 2077 6172 6e69 6e67 5d20 7b73 656c  ue warning] {sel
+00015e70: 662e 5f5f 6765 7443 7572 7265 6e74 5265  f.__getCurrentRe
+00015e80: 7374 7261 696e 7428 297d 220a 2020 2020  straint()}".    
+00015e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015ea0: 2020 2020 2020 2020 2020 2020 6622 7b73              f"{s
+00015eb0: 7263 4675 6e63 7d2c 2074 6865 2075 7070  rcFunc}, the upp
+00015ec0: 6572 206c 696e 6561 7220 6c69 6d69 7420  er linear limit 
+00015ed0: 7661 6c75 653d 277b 7570 7065 725f 6c69  value='{upper_li
+00015ee0: 6e65 6172 5f6c 696d 6974 7d27 2073 686f  near_limit}' sho
+00015ef0: 756c 6420 6265 2077 6974 6869 6e20 7261  uld be within ra
+00015f00: 6e67 6520 7b41 4e47 4c45 5f52 4553 5452  nge {ANGLE_RESTR
+00015f10: 4149 4e54 5f52 414e 4745 7d2e 2229 0a0a  AINT_RANGE}.")..
+00015f20: 2020 2020 2020 2020 7265 7475 726e 2064          return d
+00015f30: 7374 4675 6e63 0a0a 2020 2020 2320 456e  stFunc..    # En
+00015f40: 7465 7220 6120 7061 7273 6520 7472 6565  ter a parse tree
+00015f50: 2070 726f 6475 6365 6420 6279 2052 6f73   produced by Ros
+00015f60: 6574 7461 4d52 5061 7273 6572 2364 6968  ettaMRParser#dih
+00015f70: 6564 7261 6c5f 7265 7374 7261 696e 7473  edral_restraints
+00015f80: 2e0a 2020 2020 6465 6620 656e 7465 7244  ..    def enterD
+00015f90: 6968 6564 7261 6c5f 7265 7374 7261 696e  ihedral_restrain
+00015fa0: 7473 2873 656c 662c 2063 7478 3a20 526f  ts(self, ctx: Ro
+00015fb0: 7365 7474 614d 5250 6172 7365 722e 4469  settaMRParser.Di
+00015fc0: 6865 6472 616c 5f72 6573 7472 6169 6e74  hedral_restraint
+00015fd0: 7343 6f6e 7465 7874 293a 2020 2320 7079  sContext):  # py
+00015fe0: 6c69 6e74 3a20 6469 7361 626c 653d 756e  lint: disable=un
+00015ff0: 7573 6564 2d61 7267 756d 656e 740a 2020  used-argument.  
+00016000: 2020 2020 2020 7365 6c66 2e5f 5f63 7572        self.__cur
+00016010: 5f73 7562 7479 7065 203d 2027 6469 6865  _subtype = 'dihe
+00016020: 6427 0a0a 2020 2020 2320 4578 6974 2061  d'..    # Exit a
+00016030: 2070 6172 7365 2074 7265 6520 7072 6f64   parse tree prod
+00016040: 7563 6564 2062 7920 526f 7365 7474 614d  uced by RosettaM
+00016050: 5250 6172 7365 7223 6469 6865 6472 616c  RParser#dihedral
+00016060: 5f72 6573 7472 6169 6e74 732e 0a20 2020  _restraints..   
+00016070: 2064 6566 2065 7869 7444 6968 6564 7261   def exitDihedra
+00016080: 6c5f 7265 7374 7261 696e 7473 2873 656c  l_restraints(sel
+00016090: 662c 2063 7478 3a20 526f 7365 7474 614d  f, ctx: RosettaM
+000160a0: 5250 6172 7365 722e 4469 6865 6472 616c  RParser.Dihedral
+000160b0: 5f72 6573 7472 6169 6e74 7343 6f6e 7465  _restraintsConte
+000160c0: 7874 293a 2020 2320 7079 6c69 6e74 3a20  xt):  # pylint: 
+000160d0: 6469 7361 626c 653d 756e 7573 6564 2d61  disable=unused-a
+000160e0: 7267 756d 656e 740a 2020 2020 2020 2020  rgument.        
+000160f0: 7061 7373 0a0a 2020 2020 2320 456e 7465  pass..    # Ente
+00016100: 7220 6120 7061 7273 6520 7472 6565 2070  r a parse tree p
+00016110: 726f 6475 6365 6420 6279 2052 6f73 6574  roduced by Roset
+00016120: 7461 4d52 5061 7273 6572 2364 6968 6564  taMRParser#dihed
+00016130: 7261 6c5f 7265 7374 7261 696e 742e 0a20  ral_restraint.. 
+00016140: 2020 2064 6566 2065 6e74 6572 4469 6865     def enterDihe
+00016150: 6472 616c 5f72 6573 7472 6169 6e74 2873  dral_restraint(s
+00016160: 656c 662c 2063 7478 3a20 526f 7365 7474  elf, ctx: Rosett
+00016170: 614d 5250 6172 7365 722e 4469 6865 6472  aMRParser.Dihedr
+00016180: 616c 5f72 6573 7472 6169 6e74 436f 6e74  al_restraintCont
+00016190: 6578 7429 3a20 2023 2070 796c 696e 743a  ext):  # pylint:
+000161a0: 2064 6973 6162 6c65 3d75 6e75 7365 642d   disable=unused-
+000161b0: 6172 6775 6d65 6e74 0a20 2020 2020 2020  argument.       
+000161c0: 2073 656c 662e 6469 6865 6452 6573 7472   self.dihedRestr
+000161d0: 6169 6e74 7320 2b3d 2031 0a0a 2020 2020  aints += 1..    
+000161e0: 2020 2020 7365 6c66 2e73 7461 636b 4675      self.stackFu
+000161f0: 6e63 732e 636c 6561 7228 290a 2020 2020  ncs.clear().    
+00016200: 2020 2020 7365 6c66 2e61 746f 6d53 656c      self.atomSel
+00016210: 6563 7469 6f6e 5365 742e 636c 6561 7228  ectionSet.clear(
+00016220: 290a 0a20 2020 2023 2045 7869 7420 6120  )..    # Exit a 
+00016230: 7061 7273 6520 7472 6565 2070 726f 6475  parse tree produ
+00016240: 6365 6420 6279 2052 6f73 6574 7461 4d52  ced by RosettaMR
+00016250: 5061 7273 6572 2364 6968 6564 7261 6c5f  Parser#dihedral_
+00016260: 7265 7374 7261 696e 742e 0a20 2020 2064  restraint..    d
+00016270: 6566 2065 7869 7444 6968 6564 7261 6c5f  ef exitDihedral_
+00016280: 7265 7374 7261 696e 7428 7365 6c66 2c20  restraint(self, 
+00016290: 6374 783a 2052 6f73 6574 7461 4d52 5061  ctx: RosettaMRPa
+000162a0: 7273 6572 2e44 6968 6564 7261 6c5f 7265  rser.Dihedral_re
+000162b0: 7374 7261 696e 7443 6f6e 7465 7874 293a  straintContext):
+000162c0: 0a20 2020 2020 2020 2073 6571 4964 3120  .        seqId1 
+000162d0: 3d20 696e 7428 7374 7228 6374 782e 496e  = int(str(ctx.In
+000162e0: 7465 6765 7228 3029 2929 0a20 2020 2020  teger(0))).     
+000162f0: 2020 2061 746f 6d49 6431 203d 2073 7472     atomId1 = str
+00016300: 2863 7478 2e53 696d 706c 655f 6e61 6d65  (ctx.Simple_name
+00016310: 2830 2929 2e75 7070 6572 2829 0a20 2020  (0)).upper().   
+00016320: 2020 2020 2073 6571 4964 3220 3d20 696e       seqId2 = in
+00016330: 7428 7374 7228 6374 782e 496e 7465 6765  t(str(ctx.Intege
+00016340: 7228 3129 2929 0a20 2020 2020 2020 2061  r(1))).        a
+00016350: 746f 6d49 6432 203d 2073 7472 2863 7478  tomId2 = str(ctx
+00016360: 2e53 696d 706c 655f 6e61 6d65 2831 2929  .Simple_name(1))
+00016370: 2e75 7070 6572 2829 0a20 2020 2020 2020  .upper().       
+00016380: 2073 6571 4964 3320 3d20 696e 7428 7374   seqId3 = int(st
+00016390: 7228 6374 782e 496e 7465 6765 7228 3229  r(ctx.Integer(2)
+000163a0: 2929 0a20 2020 2020 2020 2061 746f 6d49  )).        atomI
+000163b0: 6433 203d 2073 7472 2863 7478 2e53 696d  d3 = str(ctx.Sim
+000163c0: 706c 655f 6e61 6d65 2832 2929 2e75 7070  ple_name(2)).upp
+000163d0: 6572 2829 0a20 2020 2020 2020 2073 6571  er().        seq
+000163e0: 4964 3420 3d20 696e 7428 7374 7228 6374  Id4 = int(str(ct
+000163f0: 782e 496e 7465 6765 7228 3329 2929 0a20  x.Integer(3))). 
+00016400: 2020 2020 2020 2061 746f 6d49 6434 203d         atomId4 =
+00016410: 2073 7472 2863 7478 2e53 696d 706c 655f   str(ctx.Simple_
+00016420: 6e61 6d65 2833 2929 2e75 7070 6572 2829  name(3)).upper()
+00016430: 0a0a 2020 2020 2020 2020 6473 7446 756e  ..        dstFun
+00016440: 6320 3d20 7365 6c66 2e76 616c 6964 6174  c = self.validat
+00016450: 6541 6e67 6c65 5261 6e67 6528 312e 3029  eAngleRange(1.0)
+00016460: 0a0a 2020 2020 2020 2020 6966 2064 7374  ..        if dst
+00016470: 4675 6e63 2069 7320 4e6f 6e65 3a0a 2020  Func is None:.  
+00016480: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00016490: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+000164a0: 2073 656c 662e 5f5f 6861 7350 6f6c 7953   self.__hasPolyS
+000164b0: 6571 3a0a 2020 2020 2020 2020 2020 2020  eq:.            
+000164c0: 7265 7475 726e 0a0a 2020 2020 2020 2020  return..        
+000164d0: 7365 6c66 2e5f 5f72 6574 7269 6576 654c  self.__retrieveL
+000164e0: 6f63 616c 5365 7153 6368 656d 6528 290a  ocalSeqScheme().
+000164f0: 0a20 2020 2020 2020 2063 6861 696e 4173  .        chainAs
+00016500: 7369 676e 3120 3d20 7365 6c66 2e61 7373  sign1 = self.ass
+00016510: 6967 6e43 6f6f 7264 506f 6c79 6d65 7253  ignCoordPolymerS
+00016520: 6571 7565 6e63 6528 7365 7149 6431 2c20  equence(seqId1, 
+00016530: 6174 6f6d 4964 3129 0a20 2020 2020 2020  atomId1).       
+00016540: 2063 6861 696e 4173 7369 676e 3220 3d20   chainAssign2 = 
+00016550: 7365 6c66 2e61 7373 6967 6e43 6f6f 7264  self.assignCoord
+00016560: 506f 6c79 6d65 7253 6571 7565 6e63 6528  PolymerSequence(
+00016570: 7365 7149 6432 2c20 6174 6f6d 4964 3229  seqId2, atomId2)
+00016580: 0a20 2020 2020 2020 2063 6861 696e 4173  .        chainAs
+00016590: 7369 676e 3320 3d20 7365 6c66 2e61 7373  sign3 = self.ass
+000165a0: 6967 6e43 6f6f 7264 506f 6c79 6d65 7253  ignCoordPolymerS
+000165b0: 6571 7565 6e63 6528 7365 7149 6433 2c20  equence(seqId3, 
+000165c0: 6174 6f6d 4964 3329 0a20 2020 2020 2020  atomId3).       
+000165d0: 2063 6861 696e 4173 7369 676e 3420 3d20   chainAssign4 = 
+000165e0: 7365 6c66 2e61 7373 6967 6e43 6f6f 7264  self.assignCoord
+000165f0: 506f 6c79 6d65 7253 6571 7565 6e63 6528  PolymerSequence(
+00016600: 7365 7149 6434 2c20 6174 6f6d 4964 3429  seqId4, atomId4)
+00016610: 0a0a 2020 2020 2020 2020 6966 206c 656e  ..        if len
+00016620: 2863 6861 696e 4173 7369 676e 3129 203d  (chainAssign1) =
+00016630: 3d20 3020 6f72 206c 656e 2863 6861 696e  = 0 or len(chain
+00016640: 4173 7369 676e 3229 203d 3d20 305c 0a20  Assign2) == 0\. 
+00016650: 2020 2020 2020 2020 2020 6f72 206c 656e            or len
+00016660: 2863 6861 696e 4173 7369 676e 3329 203d  (chainAssign3) =
+00016670: 3d20 3020 6f72 206c 656e 2863 6861 696e  = 0 or len(chain
+00016680: 4173 7369 676e 3429 203d 3d20 303a 0a20  Assign4) == 0:. 
+00016690: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+000166a0: 6e0a 0a20 2020 2020 2020 2073 656c 662e  n..        self.
+000166b0: 7365 6c65 6374 436f 6f72 6441 746f 6d73  selectCoordAtoms
+000166c0: 2863 6861 696e 4173 7369 676e 312c 2073  (chainAssign1, s
+000166d0: 6571 4964 312c 2061 746f 6d49 6431 2c20  eqId1, atomId1, 
+000166e0: 4661 6c73 652c 2027 6120 6469 6865 6472  False, 'a dihedr
+000166f0: 616c 2061 6e67 6c65 2729 0a20 2020 2020  al angle').     
+00016700: 2020 2073 656c 662e 7365 6c65 6374 436f     self.selectCo
+00016710: 6f72 6441 746f 6d73 2863 6861 696e 4173  ordAtoms(chainAs
+00016720: 7369 676e 322c 2073 6571 4964 322c 2061  sign2, seqId2, a
+00016730: 746f 6d49 6432 2c20 4661 6c73 652c 2027  tomId2, False, '
+00016740: 6120 6469 6865 6472 616c 2061 6e67 6c65  a dihedral angle
+00016750: 2729 0a20 2020 2020 2020 2073 656c 662e  ').        self.
+00016760: 7365 6c65 6374 436f 6f72 6441 746f 6d73  selectCoordAtoms
+00016770: 2863 6861 696e 4173 7369 676e 332c 2073  (chainAssign3, s
+00016780: 6571 4964 332c 2061 746f 6d49 6433 2c20  eqId3, atomId3, 
+00016790: 4661 6c73 652c 2027 6120 6469 6865 6472  False, 'a dihedr
+000167a0: 616c 2061 6e67 6c65 2729 0a20 2020 2020  al angle').     
+000167b0: 2020 2073 656c 662e 7365 6c65 6374 436f     self.selectCo
+000167c0: 6f72 6441 746f 6d73 2863 6861 696e 4173  ordAtoms(chainAs
+000167d0: 7369 676e 342c 2073 6571 4964 342c 2061  sign4, seqId4, a
+000167e0: 746f 6d49 6434 2c20 4661 6c73 652c 2027  tomId4, False, '
+000167f0: 6120 6469 6865 6472 616c 2061 6e67 6c65  a dihedral angle
+00016800: 2729 0a0a 2020 2020 2020 2020 6966 206c  ')..        if l
+00016810: 656e 2873 656c 662e 6174 6f6d 5365 6c65  en(self.atomSele
+00016820: 6374 696f 6e53 6574 2920 3c20 343a 0a20  ctionSet) < 4:. 
+00016830: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00016840: 6e0a 0a20 2020 2020 2020 2069 6620 6e6f  n..        if no
+00016850: 7420 7365 6c66 2e61 7265 556e 6971 7565  t self.areUnique
+00016860: 436f 6f72 6441 746f 6d73 2827 6120 4469  CoordAtoms('a Di
+00016870: 6865 6472 616c 2061 6e67 6c65 2729 3a0a  hedral angle'):.
+00016880: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00016890: 726e 0a0a 2020 2020 2020 2020 6966 2073  rn..        if s
+000168a0: 656c 662e 5f5f 6372 6561 7465 5366 4469  elf.__createSfDi
+000168b0: 6374 3a0a 2020 2020 2020 2020 2020 2020  ct:.            
+000168c0: 7366 203d 2073 656c 662e 5f5f 6765 7453  sf = self.__getS
+000168d0: 6628 706f 7465 6e74 6961 6c54 7970 653d  f(potentialType=
+000168e0: 6765 7450 6f74 656e 7469 616c 5479 7065  getPotentialType
+000168f0: 2873 656c 662e 5f5f 6669 6c65 5f74 7970  (self.__file_typ
+00016900: 652c 2073 656c 662e 5f5f 6375 725f 7375  e, self.__cur_su
+00016910: 6274 7970 652c 2064 7374 4675 6e63 2929  btype, dstFunc))
+00016920: 0a0a 2020 2020 2020 2020 636f 6d70 4964  ..        compId
+00016930: 203d 2073 656c 662e 6174 6f6d 5365 6c65   = self.atomSele
+00016940: 6374 696f 6e53 6574 5b30 5d5b 305d 5b27  ctionSet[0][0]['
+00016950: 636f 6d70 5f69 6427 5d0a 2020 2020 2020  comp_id'].      
+00016960: 2020 7065 7074 6964 652c 206e 7563 6c65    peptide, nucle
+00016970: 6f74 6964 652c 2063 6172 626f 6879 6472  otide, carbohydr
+00016980: 6174 6520 3d20 7365 6c66 2e5f 5f63 7353  ate = self.__csS
+00016990: 7461 742e 6765 7454 7970 654f 6643 6f6d  tat.getTypeOfCom
+000169a0: 7049 6428 636f 6d70 4964 290a 0a20 2020  pId(compId)..   
+000169b0: 2020 2020 2069 6620 7365 6c66 2e5f 5f63       if self.__c
+000169c0: 7572 5f6e 6573 7420 6973 206e 6f74 204e  ur_nest is not N
+000169d0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+000169e0: 2069 6620 7365 6c66 2e5f 5f64 6562 7567   if self.__debug
+000169f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00016a00: 2020 7072 696e 7428 6622 4e45 5354 4544    print(f"NESTED
+00016a10: 3a20 7b73 656c 662e 5f5f 6375 725f 6e65  : {self.__cur_ne
+00016a20: 7374 7d22 290a 0a20 2020 2020 2020 2066  st}")..        f
+00016a30: 6972 7374 5f69 7465 6d20 3d20 5472 7565  irst_item = True
+00016a40: 0a0a 2020 2020 2020 2020 666f 7220 6174  ..        for at
+00016a50: 6f6d 312c 2061 746f 6d32 2c20 6174 6f6d  om1, atom2, atom
+00016a60: 332c 2061 746f 6d34 2069 6e20 6974 6572  3, atom4 in iter
+00016a70: 746f 6f6c 732e 7072 6f64 7563 7428 7365  tools.product(se
+00016a80: 6c66 2e61 746f 6d53 656c 6563 7469 6f6e  lf.atomSelection
+00016a90: 5365 745b 305d 2c0a 2020 2020 2020 2020  Set[0],.        
+00016aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016ad0: 2020 2020 7365 6c66 2e61 746f 6d53 656c      self.atomSel
+00016ae0: 6563 7469 6f6e 5365 745b 315d 2c0a 2020  ectionSet[1],.  
+00016af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016b20: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00016b30: 746f 6d53 656c 6563 7469 6f6e 5365 745b  tomSelectionSet[
+00016b40: 325d 2c0a 2020 2020 2020 2020 2020 2020  2],.            
+00016b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00016b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00016b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016b80: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00016b90: 662e 6174 6f6d 5365 6c65 6374 696f 6e53  f.atomSelectionS
-00016ba0: 6574 5b31 5d2c 0a20 2020 2020 2020 2020  et[1],.         
-00016bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016be0: 2020 2073 656c 662e 6174 6f6d 5365 6c65     self.atomSele
-00016bf0: 6374 696f 6e53 6574 5b32 5d2c 0a20 2020  ctionSet[2],.   
+00016b80: 7365 6c66 2e61 746f 6d53 656c 6563 7469  self.atomSelecti
+00016b90: 6f6e 5365 745b 335d 293a 0a20 2020 2020  onSet[3]):.     
+00016ba0: 2020 2020 2020 2061 6e67 6c65 4e61 6d65         angleName
+00016bb0: 203d 2067 6574 5479 7065 4f66 4469 6865   = getTypeOfDihe
+00016bc0: 6472 616c 5265 7374 7261 696e 7428 7065  dralRestraint(pe
+00016bd0: 7074 6964 652c 206e 7563 6c65 6f74 6964  ptide, nucleotid
+00016be0: 652c 2063 6172 626f 6879 6472 6174 652c  e, carbohydrate,
+00016bf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00016c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00016c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016c30: 2020 2020 2020 2020 2073 656c 662e 6174           self.at
-00016c40: 6f6d 5365 6c65 6374 696f 6e53 6574 5b33  omSelectionSet[3
-00016c50: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
-00016c60: 616e 676c 654e 616d 6520 3d20 6765 7454  angleName = getT
-00016c70: 7970 654f 6644 6968 6564 7261 6c52 6573  ypeOfDihedralRes
-00016c80: 7472 6169 6e74 2870 6570 7469 6465 2c20  traint(peptide, 
-00016c90: 6e75 636c 656f 7469 6465 2c20 6361 7262  nucleotide, carb
-00016ca0: 6f68 7964 7261 7465 2c0a 2020 2020 2020  ohydrate,.      
-00016cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016cd0: 2020 2020 2020 2020 2020 2020 205b 6174               [at
-00016ce0: 6f6d 312c 2061 746f 6d32 2c20 6174 6f6d  om1, atom2, atom
-00016cf0: 332c 2061 746f 6d34 5d29 0a20 2020 2020  3, atom4]).     
-00016d00: 2020 2020 2020 2069 6620 616e 676c 654e         if angleN
-00016d10: 616d 6520 6973 204e 6f6e 653a 0a20 2020  ame is None:.   
-00016d20: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
-00016d30: 7469 6e75 650a 2020 2020 2020 2020 2020  tinue.          
-00016d40: 2020 6966 2073 656c 662e 5f5f 6465 6275    if self.__debu
-00016d50: 673a 0a20 2020 2020 2020 2020 2020 2020  g:.             
-00016d60: 2020 2070 7269 6e74 2866 2273 7562 7479     print(f"subty
-00016d70: 7065 3d7b 7365 6c66 2e5f 5f63 7572 5f73  pe={self.__cur_s
-00016d80: 7562 7479 7065 7d20 6964 3d7b 7365 6c66  ubtype} id={self
-00016d90: 2e64 6968 6564 5265 7374 7261 696e 7473  .dihedRestraints
-00016da0: 7d20 616e 676c 654e 616d 653d 7b61 6e67  } angleName={ang
-00016db0: 6c65 4e61 6d65 7d20 220a 2020 2020 2020  leName} ".      
-00016dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016dd0: 6622 6174 6f6d 313d 7b61 746f 6d31 7d20  f"atom1={atom1} 
-00016de0: 6174 6f6d 323d 7b61 746f 6d32 7d20 6174  atom2={atom2} at
-00016df0: 6f6d 333d 7b61 746f 6d33 7d20 6174 6f6d  om3={atom3} atom
-00016e00: 343d 7b61 746f 6d34 7d20 7b64 7374 4675  4={atom4} {dstFu
-00016e10: 6e63 7d22 290a 2020 2020 2020 2020 2020  nc}").          
-00016e20: 2020 6966 2073 656c 662e 5f5f 6372 6561    if self.__crea
-00016e30: 7465 5366 4469 6374 2061 6e64 2073 6620  teSfDict and sf 
-00016e40: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-00016e50: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00016e60: 6669 7273 745f 6974 656d 3a0a 2020 2020  first_item:.    
+00016c20: 2020 2020 5b61 746f 6d31 2c20 6174 6f6d      [atom1, atom
+00016c30: 322c 2061 746f 6d33 2c20 6174 6f6d 345d  2, atom3, atom4]
+00016c40: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+00016c50: 2061 6e67 6c65 4e61 6d65 2069 7320 4e6f   angleName is No
+00016c60: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00016c70: 2020 2020 636f 6e74 696e 7565 0a20 2020      continue.   
+00016c80: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00016c90: 2e5f 5f64 6562 7567 3a0a 2020 2020 2020  .__debug:.      
+00016ca0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00016cb0: 6622 7375 6274 7970 653d 7b73 656c 662e  f"subtype={self.
+00016cc0: 5f5f 6375 725f 7375 6274 7970 657d 2069  __cur_subtype} i
+00016cd0: 643d 7b73 656c 662e 6469 6865 6452 6573  d={self.dihedRes
+00016ce0: 7472 6169 6e74 737d 2061 6e67 6c65 4e61  traints} angleNa
+00016cf0: 6d65 3d7b 616e 676c 654e 616d 657d 2022  me={angleName} "
+00016d00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016d10: 2020 2020 2020 2066 2261 746f 6d31 3d7b         f"atom1={
+00016d20: 6174 6f6d 317d 2061 746f 6d32 3d7b 6174  atom1} atom2={at
+00016d30: 6f6d 327d 2061 746f 6d33 3d7b 6174 6f6d  om2} atom3={atom
+00016d40: 337d 2061 746f 6d34 3d7b 6174 6f6d 347d  3} atom4={atom4}
+00016d50: 207b 6473 7446 756e 637d 2229 0a20 2020   {dstFunc}").   
+00016d60: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00016d70: 2e5f 5f63 7265 6174 6553 6644 6963 7420  .__createSfDict 
+00016d80: 616e 6420 7366 2069 7320 6e6f 7420 4e6f  and sf is not No
+00016d90: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00016da0: 2020 2020 6966 2066 6972 7374 5f69 7465      if first_ite
+00016db0: 6d3a 0a20 2020 2020 2020 2020 2020 2020  m:.             
+00016dc0: 2020 2020 2020 2073 665b 2769 6427 5d20         sf['id'] 
+00016dd0: 2b3d 2031 0a20 2020 2020 2020 2020 2020  += 1.           
+00016de0: 2020 2020 2020 2020 2066 6972 7374 5f69           first_i
+00016df0: 7465 6d20 3d20 4661 6c73 650a 2020 2020  tem = False.    
+00016e00: 2020 2020 2020 2020 2020 2020 7366 5b27              sf['
+00016e10: 696e 6465 785f 6964 275d 202b 3d20 310a  index_id'] += 1.
+00016e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016e30: 726f 7720 3d20 6765 7452 6f77 2873 656c  row = getRow(sel
+00016e40: 662e 5f5f 6375 725f 7375 6274 7970 652c  f.__cur_subtype,
+00016e50: 2073 665b 2769 6427 5d2c 2073 665b 2769   sf['id'], sf['i
+00016e60: 6e64 6578 5f69 6427 5d2c 0a20 2020 2020  ndex_id'],.     
 00016e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016e80: 7366 5b27 6964 275d 202b 3d20 310a 2020  sf['id'] += 1.  
-00016e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016ea0: 2020 6669 7273 745f 6974 656d 203d 2046    first_item = F
-00016eb0: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-00016ec0: 2020 2020 2073 665b 2769 6e64 6578 5f69       sf['index_i
-00016ed0: 6427 5d20 2b3d 2031 0a20 2020 2020 2020  d'] += 1.       
-00016ee0: 2020 2020 2020 2020 2072 6f77 203d 2067           row = g
-00016ef0: 6574 526f 7728 7365 6c66 2e5f 5f63 7572  etRow(self.__cur
-00016f00: 5f73 7562 7479 7065 2c20 7366 5b27 6964  _subtype, sf['id
-00016f10: 275d 2c20 7366 5b27 696e 6465 785f 6964  '], sf['index_id
-00016f20: 275d 2c0a 2020 2020 2020 2020 2020 2020  '],.            
-00016f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016f40: 2027 2e27 2c20 4e6f 6e65 2c20 616e 676c   '.', None, angl
-00016f50: 654e 616d 652c 0a20 2020 2020 2020 2020  eName,.         
-00016f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016f70: 2020 2020 7366 5b27 6c69 7374 5f69 6427      sf['list_id'
-00016f80: 5d2c 2073 656c 662e 5f5f 656e 7472 7949  ], self.__entryI
-00016f90: 642c 2064 7374 4675 6e63 2c0a 2020 2020  d, dstFunc,.    
-00016fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016fb0: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
-00016fc0: 6175 7468 546f 5374 6172 5365 712c 2073  authToStarSeq, s
-00016fd0: 656c 662e 5f5f 6175 7468 546f 496e 7343  elf.__authToInsC
-00016fe0: 6f64 652c 2073 656c 662e 5f5f 6f66 6673  ode, self.__offs
-00016ff0: 6574 486f 6c64 6572 2c0a 2020 2020 2020  etHolder,.      
-00017000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017010: 2020 2020 2020 2061 746f 6d31 2c20 6174         atom1, at
-00017020: 6f6d 322c 2061 746f 6d33 2c20 6174 6f6d  om2, atom3, atom
-00017030: 3429 0a20 2020 2020 2020 2020 2020 2020  4).             
-00017040: 2020 2073 665b 276c 6f6f 7027 5d2e 6164     sf['loop'].ad
-00017050: 645f 6461 7461 2872 6f77 290a 0a20 2020  d_data(row)..   
-00017060: 2023 2045 6e74 6572 2061 2070 6172 7365   # Enter a parse
-00017070: 2074 7265 6520 7072 6f64 7563 6564 2062   tree produced b
-00017080: 7920 526f 7365 7474 614d 5250 6172 7365  y RosettaMRParse
-00017090: 7223 6469 6865 6472 616c 5f70 6169 725f  r#dihedral_pair_
-000170a0: 7265 7374 7261 696e 7473 2e0a 2020 2020  restraints..    
-000170b0: 6465 6620 656e 7465 7244 6968 6564 7261  def enterDihedra
-000170c0: 6c5f 7061 6972 5f72 6573 7472 6169 6e74  l_pair_restraint
-000170d0: 7328 7365 6c66 2c20 6374 783a 2052 6f73  s(self, ctx: Ros
-000170e0: 6574 7461 4d52 5061 7273 6572 2e44 6968  ettaMRParser.Dih
-000170f0: 6564 7261 6c5f 7061 6972 5f72 6573 7472  edral_pair_restr
-00017100: 6169 6e74 7343 6f6e 7465 7874 293a 2020  aintsContext):  
-00017110: 2320 7079 6c69 6e74 3a20 6469 7361 626c  # pylint: disabl
-00017120: 653d 756e 7573 6564 2d61 7267 756d 656e  e=unused-argumen
-00017130: 740a 2020 2020 2020 2020 7365 6c66 2e5f  t.        self._
-00017140: 5f63 7572 5f73 7562 7479 7065 203d 2027  _cur_subtype = '
-00017150: 6469 6865 6427 0a0a 2020 2020 2320 4578  dihed'..    # Ex
-00017160: 6974 2061 2070 6172 7365 2074 7265 6520  it a parse tree 
-00017170: 7072 6f64 7563 6564 2062 7920 526f 7365  produced by Rose
-00017180: 7474 614d 5250 6172 7365 7223 6469 6865  ttaMRParser#dihe
-00017190: 6472 616c 5f70 6169 725f 7265 7374 7261  dral_pair_restra
-000171a0: 696e 7473 2e0a 2020 2020 6465 6620 6578  ints..    def ex
-000171b0: 6974 4469 6865 6472 616c 5f70 6169 725f  itDihedral_pair_
-000171c0: 7265 7374 7261 696e 7473 2873 656c 662c  restraints(self,
-000171d0: 2063 7478 3a20 526f 7365 7474 614d 5250   ctx: RosettaMRP
-000171e0: 6172 7365 722e 4469 6865 6472 616c 5f70  arser.Dihedral_p
-000171f0: 6169 725f 7265 7374 7261 696e 7473 436f  air_restraintsCo
-00017200: 6e74 6578 7429 3a20 2023 2070 796c 696e  ntext):  # pylin
-00017210: 743a 2064 6973 6162 6c65 3d75 6e75 7365  t: disable=unuse
-00017220: 642d 6172 6775 6d65 6e74 0a20 2020 2020  d-argument.     
-00017230: 2020 2070 6173 730a 0a20 2020 2023 2045     pass..    # E
-00017240: 6e74 6572 2061 2070 6172 7365 2074 7265  nter a parse tre
-00017250: 6520 7072 6f64 7563 6564 2062 7920 526f  e produced by Ro
-00017260: 7365 7474 614d 5250 6172 7365 7223 6469  settaMRParser#di
-00017270: 6865 6472 616c 5f70 6169 725f 7265 7374  hedral_pair_rest
-00017280: 7261 696e 742e 0a20 2020 2064 6566 2065  raint..    def e
-00017290: 6e74 6572 4469 6865 6472 616c 5f70 6169  nterDihedral_pai
-000172a0: 725f 7265 7374 7261 696e 7428 7365 6c66  r_restraint(self
-000172b0: 2c20 6374 783a 2052 6f73 6574 7461 4d52  , ctx: RosettaMR
-000172c0: 5061 7273 6572 2e44 6968 6564 7261 6c5f  Parser.Dihedral_
-000172d0: 7061 6972 5f72 6573 7472 6169 6e74 436f  pair_restraintCo
-000172e0: 6e74 6578 7429 3a20 2023 2070 796c 696e  ntext):  # pylin
-000172f0: 743a 2064 6973 6162 6c65 3d75 6e75 7365  t: disable=unuse
-00017300: 642d 6172 6775 6d65 6e74 0a20 2020 2020  d-argument.     
-00017310: 2020 2073 656c 662e 6469 6865 6452 6573     self.dihedRes
-00017320: 7472 6169 6e74 7320 2b3d 2031 0a0a 2020  traints += 1..  
-00017330: 2020 2020 2020 7365 6c66 2e73 7461 636b        self.stack
-00017340: 4675 6e63 732e 636c 6561 7228 290a 2020  Funcs.clear().  
-00017350: 2020 2020 2020 7365 6c66 2e61 746f 6d53        self.atomS
-00017360: 656c 6563 7469 6f6e 5365 742e 636c 6561  electionSet.clea
-00017370: 7228 290a 0a20 2020 2023 2045 7869 7420  r()..    # Exit 
-00017380: 6120 7061 7273 6520 7472 6565 2070 726f  a parse tree pro
-00017390: 6475 6365 6420 6279 2052 6f73 6574 7461  duced by Rosetta
-000173a0: 4d52 5061 7273 6572 2364 6968 6564 7261  MRParser#dihedra
-000173b0: 6c5f 7061 6972 5f72 6573 7472 6169 6e74  l_pair_restraint
-000173c0: 2e0a 2020 2020 6465 6620 6578 6974 4469  ..    def exitDi
-000173d0: 6865 6472 616c 5f70 6169 725f 7265 7374  hedral_pair_rest
-000173e0: 7261 696e 7428 7365 6c66 2c20 6374 783a  raint(self, ctx:
-000173f0: 2052 6f73 6574 7461 4d52 5061 7273 6572   RosettaMRParser
-00017400: 2e44 6968 6564 7261 6c5f 7061 6972 5f72  .Dihedral_pair_r
-00017410: 6573 7472 6169 6e74 436f 6e74 6578 7429  estraintContext)
-00017420: 3a0a 2020 2020 2020 2020 7365 7149 6431  :.        seqId1
-00017430: 203d 2069 6e74 2873 7472 2863 7478 2e49   = int(str(ctx.I
-00017440: 6e74 6567 6572 2830 2929 290a 2020 2020  nteger(0))).    
-00017450: 2020 2020 6174 6f6d 4964 3120 3d20 7374      atomId1 = st
-00017460: 7228 6374 782e 5369 6d70 6c65 5f6e 616d  r(ctx.Simple_nam
-00017470: 6528 3029 292e 7570 7065 7228 290a 2020  e(0)).upper().  
-00017480: 2020 2020 2020 7365 7149 6432 203d 2069        seqId2 = i
-00017490: 6e74 2873 7472 2863 7478 2e49 6e74 6567  nt(str(ctx.Integ
-000174a0: 6572 2831 2929 290a 2020 2020 2020 2020  er(1))).        
-000174b0: 6174 6f6d 4964 3220 3d20 7374 7228 6374  atomId2 = str(ct
-000174c0: 782e 5369 6d70 6c65 5f6e 616d 6528 3129  x.Simple_name(1)
-000174d0: 292e 7570 7065 7228 290a 2020 2020 2020  ).upper().      
-000174e0: 2020 7365 7149 6433 203d 2069 6e74 2873    seqId3 = int(s
-000174f0: 7472 2863 7478 2e49 6e74 6567 6572 2832  tr(ctx.Integer(2
+00016e80: 2020 2020 2020 2020 272e 272c 204e 6f6e          '.', Non
+00016e90: 652c 2061 6e67 6c65 4e61 6d65 2c0a 2020  e, angleName,.  
+00016ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016eb0: 2020 2020 2020 2020 2020 2073 665b 276c             sf['l
+00016ec0: 6973 745f 6964 275d 2c20 7365 6c66 2e5f  ist_id'], self._
+00016ed0: 5f65 6e74 7279 4964 2c20 6473 7446 756e  _entryId, dstFun
+00016ee0: 632c 0a20 2020 2020 2020 2020 2020 2020  c,.             
+00016ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016f00: 7365 6c66 2e5f 5f61 7574 6854 6f53 7461  self.__authToSta
+00016f10: 7253 6571 2c20 7365 6c66 2e5f 5f61 7574  rSeq, self.__aut
+00016f20: 6854 6f49 6e73 436f 6465 2c20 7365 6c66  hToInsCode, self
+00016f30: 2e5f 5f6f 6666 7365 7448 6f6c 6465 722c  .__offsetHolder,
+00016f40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016f50: 2020 2020 2020 2020 2020 2020 2020 6174                at
+00016f60: 6f6d 312c 2061 746f 6d32 2c20 6174 6f6d  om1, atom2, atom
+00016f70: 332c 2061 746f 6d34 290a 2020 2020 2020  3, atom4).      
+00016f80: 2020 2020 2020 2020 2020 7366 5b27 6c6f            sf['lo
+00016f90: 6f70 275d 2e61 6464 5f64 6174 6128 726f  op'].add_data(ro
+00016fa0: 7729 0a0a 2020 2020 2320 456e 7465 7220  w)..    # Enter 
+00016fb0: 6120 7061 7273 6520 7472 6565 2070 726f  a parse tree pro
+00016fc0: 6475 6365 6420 6279 2052 6f73 6574 7461  duced by Rosetta
+00016fd0: 4d52 5061 7273 6572 2364 6968 6564 7261  MRParser#dihedra
+00016fe0: 6c5f 7061 6972 5f72 6573 7472 6169 6e74  l_pair_restraint
+00016ff0: 732e 0a20 2020 2064 6566 2065 6e74 6572  s..    def enter
+00017000: 4469 6865 6472 616c 5f70 6169 725f 7265  Dihedral_pair_re
+00017010: 7374 7261 696e 7473 2873 656c 662c 2063  straints(self, c
+00017020: 7478 3a20 526f 7365 7474 614d 5250 6172  tx: RosettaMRPar
+00017030: 7365 722e 4469 6865 6472 616c 5f70 6169  ser.Dihedral_pai
+00017040: 725f 7265 7374 7261 696e 7473 436f 6e74  r_restraintsCont
+00017050: 6578 7429 3a20 2023 2070 796c 696e 743a  ext):  # pylint:
+00017060: 2064 6973 6162 6c65 3d75 6e75 7365 642d   disable=unused-
+00017070: 6172 6775 6d65 6e74 0a20 2020 2020 2020  argument.       
+00017080: 2073 656c 662e 5f5f 6375 725f 7375 6274   self.__cur_subt
+00017090: 7970 6520 3d20 2764 6968 6564 270a 0a20  ype = 'dihed'.. 
+000170a0: 2020 2023 2045 7869 7420 6120 7061 7273     # Exit a pars
+000170b0: 6520 7472 6565 2070 726f 6475 6365 6420  e tree produced 
+000170c0: 6279 2052 6f73 6574 7461 4d52 5061 7273  by RosettaMRPars
+000170d0: 6572 2364 6968 6564 7261 6c5f 7061 6972  er#dihedral_pair
+000170e0: 5f72 6573 7472 6169 6e74 732e 0a20 2020  _restraints..   
+000170f0: 2064 6566 2065 7869 7444 6968 6564 7261   def exitDihedra
+00017100: 6c5f 7061 6972 5f72 6573 7472 6169 6e74  l_pair_restraint
+00017110: 7328 7365 6c66 2c20 6374 783a 2052 6f73  s(self, ctx: Ros
+00017120: 6574 7461 4d52 5061 7273 6572 2e44 6968  ettaMRParser.Dih
+00017130: 6564 7261 6c5f 7061 6972 5f72 6573 7472  edral_pair_restr
+00017140: 6169 6e74 7343 6f6e 7465 7874 293a 2020  aintsContext):  
+00017150: 2320 7079 6c69 6e74 3a20 6469 7361 626c  # pylint: disabl
+00017160: 653d 756e 7573 6564 2d61 7267 756d 656e  e=unused-argumen
+00017170: 740a 2020 2020 2020 2020 7061 7373 0a0a  t.        pass..
+00017180: 2020 2020 2320 456e 7465 7220 6120 7061      # Enter a pa
+00017190: 7273 6520 7472 6565 2070 726f 6475 6365  rse tree produce
+000171a0: 6420 6279 2052 6f73 6574 7461 4d52 5061  d by RosettaMRPa
+000171b0: 7273 6572 2364 6968 6564 7261 6c5f 7061  rser#dihedral_pa
+000171c0: 6972 5f72 6573 7472 6169 6e74 2e0a 2020  ir_restraint..  
+000171d0: 2020 6465 6620 656e 7465 7244 6968 6564    def enterDihed
+000171e0: 7261 6c5f 7061 6972 5f72 6573 7472 6169  ral_pair_restrai
+000171f0: 6e74 2873 656c 662c 2063 7478 3a20 526f  nt(self, ctx: Ro
+00017200: 7365 7474 614d 5250 6172 7365 722e 4469  settaMRParser.Di
+00017210: 6865 6472 616c 5f70 6169 725f 7265 7374  hedral_pair_rest
+00017220: 7261 696e 7443 6f6e 7465 7874 293a 2020  raintContext):  
+00017230: 2320 7079 6c69 6e74 3a20 6469 7361 626c  # pylint: disabl
+00017240: 653d 756e 7573 6564 2d61 7267 756d 656e  e=unused-argumen
+00017250: 740a 2020 2020 2020 2020 7365 6c66 2e64  t.        self.d
+00017260: 6968 6564 5265 7374 7261 696e 7473 202b  ihedRestraints +
+00017270: 3d20 310a 0a20 2020 2020 2020 2073 656c  = 1..        sel
+00017280: 662e 7374 6163 6b46 756e 6373 2e63 6c65  f.stackFuncs.cle
+00017290: 6172 2829 0a20 2020 2020 2020 2073 656c  ar().        sel
+000172a0: 662e 6174 6f6d 5365 6c65 6374 696f 6e53  f.atomSelectionS
+000172b0: 6574 2e63 6c65 6172 2829 0a0a 2020 2020  et.clear()..    
+000172c0: 2320 4578 6974 2061 2070 6172 7365 2074  # Exit a parse t
+000172d0: 7265 6520 7072 6f64 7563 6564 2062 7920  ree produced by 
+000172e0: 526f 7365 7474 614d 5250 6172 7365 7223  RosettaMRParser#
+000172f0: 6469 6865 6472 616c 5f70 6169 725f 7265  dihedral_pair_re
+00017300: 7374 7261 696e 742e 0a20 2020 2064 6566  straint..    def
+00017310: 2065 7869 7444 6968 6564 7261 6c5f 7061   exitDihedral_pa
+00017320: 6972 5f72 6573 7472 6169 6e74 2873 656c  ir_restraint(sel
+00017330: 662c 2063 7478 3a20 526f 7365 7474 614d  f, ctx: RosettaM
+00017340: 5250 6172 7365 722e 4469 6865 6472 616c  RParser.Dihedral
+00017350: 5f70 6169 725f 7265 7374 7261 696e 7443  _pair_restraintC
+00017360: 6f6e 7465 7874 293a 0a20 2020 2020 2020  ontext):.       
+00017370: 2073 6571 4964 3120 3d20 696e 7428 7374   seqId1 = int(st
+00017380: 7228 6374 782e 496e 7465 6765 7228 3029  r(ctx.Integer(0)
+00017390: 2929 0a20 2020 2020 2020 2061 746f 6d49  )).        atomI
+000173a0: 6431 203d 2073 7472 2863 7478 2e53 696d  d1 = str(ctx.Sim
+000173b0: 706c 655f 6e61 6d65 2830 2929 2e75 7070  ple_name(0)).upp
+000173c0: 6572 2829 0a20 2020 2020 2020 2073 6571  er().        seq
+000173d0: 4964 3220 3d20 696e 7428 7374 7228 6374  Id2 = int(str(ct
+000173e0: 782e 496e 7465 6765 7228 3129 2929 0a20  x.Integer(1))). 
+000173f0: 2020 2020 2020 2061 746f 6d49 6432 203d         atomId2 =
+00017400: 2073 7472 2863 7478 2e53 696d 706c 655f   str(ctx.Simple_
+00017410: 6e61 6d65 2831 2929 2e75 7070 6572 2829  name(1)).upper()
+00017420: 0a20 2020 2020 2020 2073 6571 4964 3320  .        seqId3 
+00017430: 3d20 696e 7428 7374 7228 6374 782e 496e  = int(str(ctx.In
+00017440: 7465 6765 7228 3229 2929 0a20 2020 2020  teger(2))).     
+00017450: 2020 2061 746f 6d49 6433 203d 2073 7472     atomId3 = str
+00017460: 2863 7478 2e53 696d 706c 655f 6e61 6d65  (ctx.Simple_name
+00017470: 2832 2929 2e75 7070 6572 2829 0a20 2020  (2)).upper().   
+00017480: 2020 2020 2073 6571 4964 3420 3d20 696e       seqId4 = in
+00017490: 7428 7374 7228 6374 782e 496e 7465 6765  t(str(ctx.Intege
+000174a0: 7228 3329 2929 0a20 2020 2020 2020 2061  r(3))).        a
+000174b0: 746f 6d49 6434 203d 2073 7472 2863 7478  tomId4 = str(ctx
+000174c0: 2e53 696d 706c 655f 6e61 6d65 2833 2929  .Simple_name(3))
+000174d0: 2e75 7070 6572 2829 0a0a 2020 2020 2020  .upper()..      
+000174e0: 2020 7365 7149 6435 203d 2069 6e74 2873    seqId5 = int(s
+000174f0: 7472 2863 7478 2e49 6e74 6567 6572 2834  tr(ctx.Integer(4
 00017500: 2929 290a 2020 2020 2020 2020 6174 6f6d  ))).        atom
-00017510: 4964 3320 3d20 7374 7228 6374 782e 5369  Id3 = str(ctx.Si
-00017520: 6d70 6c65 5f6e 616d 6528 3229 292e 7570  mple_name(2)).up
+00017510: 4964 3520 3d20 7374 7228 6374 782e 5369  Id5 = str(ctx.Si
+00017520: 6d70 6c65 5f6e 616d 6528 3429 292e 7570  mple_name(4)).up
 00017530: 7065 7228 290a 2020 2020 2020 2020 7365  per().        se
-00017540: 7149 6434 203d 2069 6e74 2873 7472 2863  qId4 = int(str(c
-00017550: 7478 2e49 6e74 6567 6572 2833 2929 290a  tx.Integer(3))).
-00017560: 2020 2020 2020 2020 6174 6f6d 4964 3420          atomId4 
+00017540: 7149 6436 203d 2069 6e74 2873 7472 2863  qId6 = int(str(c
+00017550: 7478 2e49 6e74 6567 6572 2835 2929 290a  tx.Integer(5))).
+00017560: 2020 2020 2020 2020 6174 6f6d 4964 3620          atomId6 
 00017570: 3d20 7374 7228 6374 782e 5369 6d70 6c65  = str(ctx.Simple
-00017580: 5f6e 616d 6528 3329 292e 7570 7065 7228  _name(3)).upper(
-00017590: 290a 0a20 2020 2020 2020 2073 6571 4964  )..        seqId
-000175a0: 3520 3d20 696e 7428 7374 7228 6374 782e  5 = int(str(ctx.
-000175b0: 496e 7465 6765 7228 3429 2929 0a20 2020  Integer(4))).   
-000175c0: 2020 2020 2061 746f 6d49 6435 203d 2073       atomId5 = s
-000175d0: 7472 2863 7478 2e53 696d 706c 655f 6e61  tr(ctx.Simple_na
-000175e0: 6d65 2834 2929 2e75 7070 6572 2829 0a20  me(4)).upper(). 
-000175f0: 2020 2020 2020 2073 6571 4964 3620 3d20         seqId6 = 
-00017600: 696e 7428 7374 7228 6374 782e 496e 7465  int(str(ctx.Inte
-00017610: 6765 7228 3529 2929 0a20 2020 2020 2020  ger(5))).       
-00017620: 2061 746f 6d49 6436 203d 2073 7472 2863   atomId6 = str(c
-00017630: 7478 2e53 696d 706c 655f 6e61 6d65 2835  tx.Simple_name(5
-00017640: 2929 2e75 7070 6572 2829 0a20 2020 2020  )).upper().     
-00017650: 2020 2073 6571 4964 3720 3d20 696e 7428     seqId7 = int(
-00017660: 7374 7228 6374 782e 496e 7465 6765 7228  str(ctx.Integer(
-00017670: 3629 2929 0a20 2020 2020 2020 2061 746f  6))).        ato
-00017680: 6d49 6437 203d 2073 7472 2863 7478 2e53  mId7 = str(ctx.S
-00017690: 696d 706c 655f 6e61 6d65 2836 2929 2e75  imple_name(6)).u
-000176a0: 7070 6572 2829 0a20 2020 2020 2020 2073  pper().        s
-000176b0: 6571 4964 3820 3d20 696e 7428 7374 7228  eqId8 = int(str(
-000176c0: 6374 782e 496e 7465 6765 7228 3729 2929  ctx.Integer(7)))
-000176d0: 0a20 2020 2020 2020 2061 746f 6d49 6438  .        atomId8
-000176e0: 203d 2073 7472 2863 7478 2e53 696d 706c   = str(ctx.Simpl
-000176f0: 655f 6e61 6d65 2837 2929 2e75 7070 6572  e_name(7)).upper
-00017700: 2829 0a0a 2020 2020 2020 2020 6473 7446  ()..        dstF
-00017710: 756e 6320 3d20 7365 6c66 2e76 616c 6964  unc = self.valid
-00017720: 6174 6541 6e67 6c65 5261 6e67 6528 312e  ateAngleRange(1.
-00017730: 3029 0a0a 2020 2020 2020 2020 6966 2064  0)..        if d
-00017740: 7374 4675 6e63 2069 7320 4e6f 6e65 3a0a  stFunc is None:.
-00017750: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00017760: 726e 0a0a 2020 2020 2020 2020 6966 206e  rn..        if n
-00017770: 6f74 2073 656c 662e 5f5f 6861 7350 6f6c  ot self.__hasPol
-00017780: 7953 6571 3a0a 2020 2020 2020 2020 2020  ySeq:.          
-00017790: 2020 7265 7475 726e 0a0a 2020 2020 2020    return..      
-000177a0: 2020 7365 6c66 2e5f 5f72 6574 7269 6576    self.__retriev
-000177b0: 654c 6f63 616c 5365 7153 6368 656d 6528  eLocalSeqScheme(
-000177c0: 290a 0a20 2020 2020 2020 2063 6861 696e  )..        chain
-000177d0: 4173 7369 676e 3120 3d20 7365 6c66 2e61  Assign1 = self.a
-000177e0: 7373 6967 6e43 6f6f 7264 506f 6c79 6d65  ssignCoordPolyme
-000177f0: 7253 6571 7565 6e63 6528 7365 7149 6431  rSequence(seqId1
-00017800: 2c20 6174 6f6d 4964 3129 0a20 2020 2020  , atomId1).     
-00017810: 2020 2063 6861 696e 4173 7369 676e 3220     chainAssign2 
-00017820: 3d20 7365 6c66 2e61 7373 6967 6e43 6f6f  = self.assignCoo
-00017830: 7264 506f 6c79 6d65 7253 6571 7565 6e63  rdPolymerSequenc
-00017840: 6528 7365 7149 6432 2c20 6174 6f6d 4964  e(seqId2, atomId
-00017850: 3229 0a20 2020 2020 2020 2063 6861 696e  2).        chain
-00017860: 4173 7369 676e 3320 3d20 7365 6c66 2e61  Assign3 = self.a
-00017870: 7373 6967 6e43 6f6f 7264 506f 6c79 6d65  ssignCoordPolyme
-00017880: 7253 6571 7565 6e63 6528 7365 7149 6433  rSequence(seqId3
-00017890: 2c20 6174 6f6d 4964 3329 0a20 2020 2020  , atomId3).     
-000178a0: 2020 2063 6861 696e 4173 7369 676e 3420     chainAssign4 
-000178b0: 3d20 7365 6c66 2e61 7373 6967 6e43 6f6f  = self.assignCoo
-000178c0: 7264 506f 6c79 6d65 7253 6571 7565 6e63  rdPolymerSequenc
-000178d0: 6528 7365 7149 6434 2c20 6174 6f6d 4964  e(seqId4, atomId
-000178e0: 3429 0a20 2020 2020 2020 2063 6861 696e  4).        chain
-000178f0: 4173 7369 676e 3520 3d20 7365 6c66 2e61  Assign5 = self.a
-00017900: 7373 6967 6e43 6f6f 7264 506f 6c79 6d65  ssignCoordPolyme
-00017910: 7253 6571 7565 6e63 6528 7365 7149 6435  rSequence(seqId5
-00017920: 2c20 6174 6f6d 4964 3529 0a20 2020 2020  , atomId5).     
-00017930: 2020 2063 6861 696e 4173 7369 676e 3620     chainAssign6 
-00017940: 3d20 7365 6c66 2e61 7373 6967 6e43 6f6f  = self.assignCoo
-00017950: 7264 506f 6c79 6d65 7253 6571 7565 6e63  rdPolymerSequenc
-00017960: 6528 7365 7149 6436 2c20 6174 6f6d 4964  e(seqId6, atomId
-00017970: 3629 0a20 2020 2020 2020 2063 6861 696e  6).        chain
-00017980: 4173 7369 676e 3720 3d20 7365 6c66 2e61  Assign7 = self.a
-00017990: 7373 6967 6e43 6f6f 7264 506f 6c79 6d65  ssignCoordPolyme
-000179a0: 7253 6571 7565 6e63 6528 7365 7149 6437  rSequence(seqId7
-000179b0: 2c20 6174 6f6d 4964 3729 0a20 2020 2020  , atomId7).     
-000179c0: 2020 2063 6861 696e 4173 7369 676e 3820     chainAssign8 
-000179d0: 3d20 7365 6c66 2e61 7373 6967 6e43 6f6f  = self.assignCoo
-000179e0: 7264 506f 6c79 6d65 7253 6571 7565 6e63  rdPolymerSequenc
-000179f0: 6528 7365 7149 6438 2c20 6174 6f6d 4964  e(seqId8, atomId
-00017a00: 3829 0a0a 2020 2020 2020 2020 6966 206c  8)..        if l
-00017a10: 656e 2863 6861 696e 4173 7369 676e 3129  en(chainAssign1)
-00017a20: 203d 3d20 3020 6f72 206c 656e 2863 6861   == 0 or len(cha
-00017a30: 696e 4173 7369 676e 3229 203d 3d20 305c  inAssign2) == 0\
-00017a40: 0a20 2020 2020 2020 2020 2020 6f72 206c  .           or l
-00017a50: 656e 2863 6861 696e 4173 7369 676e 3329  en(chainAssign3)
-00017a60: 203d 3d20 3020 6f72 206c 656e 2863 6861   == 0 or len(cha
-00017a70: 696e 4173 7369 676e 3429 203d 3d20 305c  inAssign4) == 0\
-00017a80: 0a20 2020 2020 2020 2020 2020 6f72 206c  .           or l
-00017a90: 656e 2863 6861 696e 4173 7369 676e 3529  en(chainAssign5)
-00017aa0: 203d 3d20 3020 6f72 206c 656e 2863 6861   == 0 or len(cha
-00017ab0: 696e 4173 7369 676e 3629 203d 3d20 305c  inAssign6) == 0\
-00017ac0: 0a20 2020 2020 2020 2020 2020 6f72 206c  .           or l
-00017ad0: 656e 2863 6861 696e 4173 7369 676e 3729  en(chainAssign7)
-00017ae0: 203d 3d20 3020 6f72 206c 656e 2863 6861   == 0 or len(cha
-00017af0: 696e 4173 7369 676e 3829 203d 3d20 303a  inAssign8) == 0:
-00017b00: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00017b10: 7572 6e0a 0a20 2020 2020 2020 2073 656c  urn..        sel
-00017b20: 662e 7365 6c65 6374 436f 6f72 6441 746f  f.selectCoordAto
-00017b30: 6d73 2863 6861 696e 4173 7369 676e 312c  ms(chainAssign1,
-00017b40: 2073 6571 4964 312c 2061 746f 6d49 6431   seqId1, atomId1
-00017b50: 2c20 4661 6c73 652c 2027 6120 6469 6865  , False, 'a dihe
-00017b60: 6472 616c 2061 6e67 6c65 2070 6169 7227  dral angle pair'
-00017b70: 290a 2020 2020 2020 2020 7365 6c66 2e73  ).        self.s
-00017b80: 656c 6563 7443 6f6f 7264 4174 6f6d 7328  electCoordAtoms(
-00017b90: 6368 6169 6e41 7373 6967 6e32 2c20 7365  chainAssign2, se
-00017ba0: 7149 6432 2c20 6174 6f6d 4964 322c 2046  qId2, atomId2, F
-00017bb0: 616c 7365 2c20 2761 2064 6968 6564 7261  alse, 'a dihedra
-00017bc0: 6c20 616e 676c 6520 7061 6972 2729 0a20  l angle pair'). 
-00017bd0: 2020 2020 2020 2073 656c 662e 7365 6c65         self.sele
-00017be0: 6374 436f 6f72 6441 746f 6d73 2863 6861  ctCoordAtoms(cha
-00017bf0: 696e 4173 7369 676e 332c 2073 6571 4964  inAssign3, seqId
-00017c00: 332c 2061 746f 6d49 6433 2c20 4661 6c73  3, atomId3, Fals
-00017c10: 652c 2027 6120 6469 6865 6472 616c 2061  e, 'a dihedral a
-00017c20: 6e67 6c65 2070 6169 7227 290a 2020 2020  ngle pair').    
-00017c30: 2020 2020 7365 6c66 2e73 656c 6563 7443      self.selectC
-00017c40: 6f6f 7264 4174 6f6d 7328 6368 6169 6e41  oordAtoms(chainA
-00017c50: 7373 6967 6e34 2c20 7365 7149 6434 2c20  ssign4, seqId4, 
-00017c60: 6174 6f6d 4964 342c 2046 616c 7365 2c20  atomId4, False, 
-00017c70: 2761 2064 6968 6564 7261 6c20 616e 676c  'a dihedral angl
-00017c80: 6520 7061 6972 2729 0a20 2020 2020 2020  e pair').       
-00017c90: 2073 656c 662e 7365 6c65 6374 436f 6f72   self.selectCoor
-00017ca0: 6441 746f 6d73 2863 6861 696e 4173 7369  dAtoms(chainAssi
-00017cb0: 676e 352c 2073 6571 4964 352c 2061 746f  gn5, seqId5, ato
-00017cc0: 6d49 6435 2c20 4661 6c73 652c 2027 6120  mId5, False, 'a 
-00017cd0: 6469 6865 6472 616c 2061 6e67 6c65 2070  dihedral angle p
-00017ce0: 6169 7227 290a 2020 2020 2020 2020 7365  air').        se
-00017cf0: 6c66 2e73 656c 6563 7443 6f6f 7264 4174  lf.selectCoordAt
-00017d00: 6f6d 7328 6368 6169 6e41 7373 6967 6e36  oms(chainAssign6
-00017d10: 2c20 7365 7149 6436 2c20 6174 6f6d 4964  , seqId6, atomId
-00017d20: 362c 2046 616c 7365 2c20 2761 2064 6968  6, False, 'a dih
-00017d30: 6564 7261 6c20 616e 676c 6520 7061 6972  edral angle pair
-00017d40: 2729 0a20 2020 2020 2020 2073 656c 662e  ').        self.
-00017d50: 7365 6c65 6374 436f 6f72 6441 746f 6d73  selectCoordAtoms
-00017d60: 2863 6861 696e 4173 7369 676e 372c 2073  (chainAssign7, s
-00017d70: 6571 4964 372c 2061 746f 6d49 6437 2c20  eqId7, atomId7, 
-00017d80: 4661 6c73 652c 2027 6120 6469 6865 6472  False, 'a dihedr
-00017d90: 616c 2061 6e67 6c65 2070 6169 7227 290a  al angle pair').
-00017da0: 2020 2020 2020 2020 7365 6c66 2e73 656c          self.sel
-00017db0: 6563 7443 6f6f 7264 4174 6f6d 7328 6368  ectCoordAtoms(ch
-00017dc0: 6169 6e41 7373 6967 6e38 2c20 7365 7149  ainAssign8, seqI
-00017dd0: 6438 2c20 6174 6f6d 4964 382c 2046 616c  d8, atomId8, Fal
-00017de0: 7365 2c20 2761 2064 6968 6564 7261 6c20  se, 'a dihedral 
-00017df0: 616e 676c 6520 7061 6972 2729 0a0a 2020  angle pair')..  
-00017e00: 2020 2020 2020 6966 206c 656e 2873 656c        if len(sel
-00017e10: 662e 6174 6f6d 5365 6c65 6374 696f 6e53  f.atomSelectionS
-00017e20: 6574 2920 3c20 383a 0a20 2020 2020 2020  et) < 8:.       
-00017e30: 2020 2020 2072 6574 7572 6e0a 0a20 2020       return..   
-00017e40: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
-00017e50: 2e61 7265 556e 6971 7565 436f 6f72 6441  .areUniqueCoordA
-00017e60: 746f 6d73 2827 6120 4469 6865 6472 616c  toms('a Dihedral
-00017e70: 2061 6e67 6c65 2070 6169 7227 293a 0a20   angle pair'):. 
-00017e80: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00017e90: 6e0a 0a20 2020 2020 2020 2069 6620 7365  n..        if se
-00017ea0: 6c66 2e5f 5f63 7265 6174 6553 6644 6963  lf.__createSfDic
-00017eb0: 743a 0a20 2020 2020 2020 2020 2020 2073  t:.            s
-00017ec0: 6620 3d20 7365 6c66 2e5f 5f67 6574 5366  f = self.__getSf
-00017ed0: 2870 6f74 656e 7469 616c 5479 7065 3d67  (potentialType=g
-00017ee0: 6574 506f 7465 6e74 6961 6c54 7970 6528  etPotentialType(
-00017ef0: 7365 6c66 2e5f 5f66 696c 655f 7479 7065  self.__file_type
-00017f00: 2c20 7365 6c66 2e5f 5f63 7572 5f73 7562  , self.__cur_sub
-00017f10: 7479 7065 2c20 6473 7446 756e 6329 290a  type, dstFunc)).
-00017f20: 0a20 2020 2020 2020 2063 6f6d 7049 6420  .        compId 
-00017f30: 3d20 7365 6c66 2e61 746f 6d53 656c 6563  = self.atomSelec
-00017f40: 7469 6f6e 5365 745b 305d 5b30 5d5b 2763  tionSet[0][0]['c
-00017f50: 6f6d 705f 6964 275d 0a20 2020 2020 2020  omp_id'].       
-00017f60: 2070 6570 7469 6465 2c20 6e75 636c 656f   peptide, nucleo
-00017f70: 7469 6465 2c20 6361 7262 6f68 7964 7261  tide, carbohydra
-00017f80: 7465 203d 2073 656c 662e 5f5f 6373 5374  te = self.__csSt
-00017f90: 6174 2e67 6574 5479 7065 4f66 436f 6d70  at.getTypeOfComp
-00017fa0: 4964 2863 6f6d 7049 6429 0a0a 2020 2020  Id(compId)..    
-00017fb0: 2020 2020 6966 2073 656c 662e 5f5f 6375      if self.__cu
-00017fc0: 725f 6e65 7374 2069 7320 6e6f 7420 4e6f  r_nest is not No
-00017fd0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00017fe0: 6966 2073 656c 662e 5f5f 6465 6275 673a  if self.__debug:
-00017ff0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018000: 2070 7269 6e74 2866 224e 4553 5445 443a   print(f"NESTED:
-00018010: 207b 7365 6c66 2e5f 5f63 7572 5f6e 6573   {self.__cur_nes
-00018020: 747d 2229 0a0a 2020 2020 2020 2020 6669  t}")..        fi
-00018030: 7273 745f 6974 656d 203d 2054 7275 650a  rst_item = True.
-00018040: 0a20 2020 2020 2020 2066 6f72 2061 746f  .        for ato
-00018050: 6d31 2c20 6174 6f6d 322c 2061 746f 6d33  m1, atom2, atom3
-00018060: 2c20 6174 6f6d 3420 696e 2069 7465 7274  , atom4 in itert
-00018070: 6f6f 6c73 2e70 726f 6475 6374 2873 656c  ools.product(sel
-00018080: 662e 6174 6f6d 5365 6c65 6374 696f 6e53  f.atomSelectionS
-00018090: 6574 5b30 5d2c 0a20 2020 2020 2020 2020  et[0],.         
+00017580: 5f6e 616d 6528 3529 292e 7570 7065 7228  _name(5)).upper(
+00017590: 290a 2020 2020 2020 2020 7365 7149 6437  ).        seqId7
+000175a0: 203d 2069 6e74 2873 7472 2863 7478 2e49   = int(str(ctx.I
+000175b0: 6e74 6567 6572 2836 2929 290a 2020 2020  nteger(6))).    
+000175c0: 2020 2020 6174 6f6d 4964 3720 3d20 7374      atomId7 = st
+000175d0: 7228 6374 782e 5369 6d70 6c65 5f6e 616d  r(ctx.Simple_nam
+000175e0: 6528 3629 292e 7570 7065 7228 290a 2020  e(6)).upper().  
+000175f0: 2020 2020 2020 7365 7149 6438 203d 2069        seqId8 = i
+00017600: 6e74 2873 7472 2863 7478 2e49 6e74 6567  nt(str(ctx.Integ
+00017610: 6572 2837 2929 290a 2020 2020 2020 2020  er(7))).        
+00017620: 6174 6f6d 4964 3820 3d20 7374 7228 6374  atomId8 = str(ct
+00017630: 782e 5369 6d70 6c65 5f6e 616d 6528 3729  x.Simple_name(7)
+00017640: 292e 7570 7065 7228 290a 0a20 2020 2020  ).upper()..     
+00017650: 2020 2064 7374 4675 6e63 203d 2073 656c     dstFunc = sel
+00017660: 662e 7661 6c69 6461 7465 416e 676c 6552  f.validateAngleR
+00017670: 616e 6765 2831 2e30 290a 0a20 2020 2020  ange(1.0)..     
+00017680: 2020 2069 6620 6473 7446 756e 6320 6973     if dstFunc is
+00017690: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+000176a0: 2020 2072 6574 7572 6e0a 0a20 2020 2020     return..     
+000176b0: 2020 2069 6620 6e6f 7420 7365 6c66 2e5f     if not self._
+000176c0: 5f68 6173 506f 6c79 5365 713a 0a20 2020  _hasPolySeq:.   
+000176d0: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
+000176e0: 0a20 2020 2020 2020 2073 656c 662e 5f5f  .        self.__
+000176f0: 7265 7472 6965 7665 4c6f 6361 6c53 6571  retrieveLocalSeq
+00017700: 5363 6865 6d65 2829 0a0a 2020 2020 2020  Scheme()..      
+00017710: 2020 6368 6169 6e41 7373 6967 6e31 203d    chainAssign1 =
+00017720: 2073 656c 662e 6173 7369 676e 436f 6f72   self.assignCoor
+00017730: 6450 6f6c 796d 6572 5365 7175 656e 6365  dPolymerSequence
+00017740: 2873 6571 4964 312c 2061 746f 6d49 6431  (seqId1, atomId1
+00017750: 290a 2020 2020 2020 2020 6368 6169 6e41  ).        chainA
+00017760: 7373 6967 6e32 203d 2073 656c 662e 6173  ssign2 = self.as
+00017770: 7369 676e 436f 6f72 6450 6f6c 796d 6572  signCoordPolymer
+00017780: 5365 7175 656e 6365 2873 6571 4964 322c  Sequence(seqId2,
+00017790: 2061 746f 6d49 6432 290a 2020 2020 2020   atomId2).      
+000177a0: 2020 6368 6169 6e41 7373 6967 6e33 203d    chainAssign3 =
+000177b0: 2073 656c 662e 6173 7369 676e 436f 6f72   self.assignCoor
+000177c0: 6450 6f6c 796d 6572 5365 7175 656e 6365  dPolymerSequence
+000177d0: 2873 6571 4964 332c 2061 746f 6d49 6433  (seqId3, atomId3
+000177e0: 290a 2020 2020 2020 2020 6368 6169 6e41  ).        chainA
+000177f0: 7373 6967 6e34 203d 2073 656c 662e 6173  ssign4 = self.as
+00017800: 7369 676e 436f 6f72 6450 6f6c 796d 6572  signCoordPolymer
+00017810: 5365 7175 656e 6365 2873 6571 4964 342c  Sequence(seqId4,
+00017820: 2061 746f 6d49 6434 290a 2020 2020 2020   atomId4).      
+00017830: 2020 6368 6169 6e41 7373 6967 6e35 203d    chainAssign5 =
+00017840: 2073 656c 662e 6173 7369 676e 436f 6f72   self.assignCoor
+00017850: 6450 6f6c 796d 6572 5365 7175 656e 6365  dPolymerSequence
+00017860: 2873 6571 4964 352c 2061 746f 6d49 6435  (seqId5, atomId5
+00017870: 290a 2020 2020 2020 2020 6368 6169 6e41  ).        chainA
+00017880: 7373 6967 6e36 203d 2073 656c 662e 6173  ssign6 = self.as
+00017890: 7369 676e 436f 6f72 6450 6f6c 796d 6572  signCoordPolymer
+000178a0: 5365 7175 656e 6365 2873 6571 4964 362c  Sequence(seqId6,
+000178b0: 2061 746f 6d49 6436 290a 2020 2020 2020   atomId6).      
+000178c0: 2020 6368 6169 6e41 7373 6967 6e37 203d    chainAssign7 =
+000178d0: 2073 656c 662e 6173 7369 676e 436f 6f72   self.assignCoor
+000178e0: 6450 6f6c 796d 6572 5365 7175 656e 6365  dPolymerSequence
+000178f0: 2873 6571 4964 372c 2061 746f 6d49 6437  (seqId7, atomId7
+00017900: 290a 2020 2020 2020 2020 6368 6169 6e41  ).        chainA
+00017910: 7373 6967 6e38 203d 2073 656c 662e 6173  ssign8 = self.as
+00017920: 7369 676e 436f 6f72 6450 6f6c 796d 6572  signCoordPolymer
+00017930: 5365 7175 656e 6365 2873 6571 4964 382c  Sequence(seqId8,
+00017940: 2061 746f 6d49 6438 290a 0a20 2020 2020   atomId8)..     
+00017950: 2020 2069 6620 6c65 6e28 6368 6169 6e41     if len(chainA
+00017960: 7373 6967 6e31 2920 3d3d 2030 206f 7220  ssign1) == 0 or 
+00017970: 6c65 6e28 6368 6169 6e41 7373 6967 6e32  len(chainAssign2
+00017980: 2920 3d3d 2030 5c0a 2020 2020 2020 2020  ) == 0\.        
+00017990: 2020 206f 7220 6c65 6e28 6368 6169 6e41     or len(chainA
+000179a0: 7373 6967 6e33 2920 3d3d 2030 206f 7220  ssign3) == 0 or 
+000179b0: 6c65 6e28 6368 6169 6e41 7373 6967 6e34  len(chainAssign4
+000179c0: 2920 3d3d 2030 5c0a 2020 2020 2020 2020  ) == 0\.        
+000179d0: 2020 206f 7220 6c65 6e28 6368 6169 6e41     or len(chainA
+000179e0: 7373 6967 6e35 2920 3d3d 2030 206f 7220  ssign5) == 0 or 
+000179f0: 6c65 6e28 6368 6169 6e41 7373 6967 6e36  len(chainAssign6
+00017a00: 2920 3d3d 2030 5c0a 2020 2020 2020 2020  ) == 0\.        
+00017a10: 2020 206f 7220 6c65 6e28 6368 6169 6e41     or len(chainA
+00017a20: 7373 6967 6e37 2920 3d3d 2030 206f 7220  ssign7) == 0 or 
+00017a30: 6c65 6e28 6368 6169 6e41 7373 6967 6e38  len(chainAssign8
+00017a40: 2920 3d3d 2030 3a0a 2020 2020 2020 2020  ) == 0:.        
+00017a50: 2020 2020 7265 7475 726e 0a0a 2020 2020      return..    
+00017a60: 2020 2020 7365 6c66 2e73 656c 6563 7443      self.selectC
+00017a70: 6f6f 7264 4174 6f6d 7328 6368 6169 6e41  oordAtoms(chainA
+00017a80: 7373 6967 6e31 2c20 7365 7149 6431 2c20  ssign1, seqId1, 
+00017a90: 6174 6f6d 4964 312c 2046 616c 7365 2c20  atomId1, False, 
+00017aa0: 2761 2064 6968 6564 7261 6c20 616e 676c  'a dihedral angl
+00017ab0: 6520 7061 6972 2729 0a20 2020 2020 2020  e pair').       
+00017ac0: 2073 656c 662e 7365 6c65 6374 436f 6f72   self.selectCoor
+00017ad0: 6441 746f 6d73 2863 6861 696e 4173 7369  dAtoms(chainAssi
+00017ae0: 676e 322c 2073 6571 4964 322c 2061 746f  gn2, seqId2, ato
+00017af0: 6d49 6432 2c20 4661 6c73 652c 2027 6120  mId2, False, 'a 
+00017b00: 6469 6865 6472 616c 2061 6e67 6c65 2070  dihedral angle p
+00017b10: 6169 7227 290a 2020 2020 2020 2020 7365  air').        se
+00017b20: 6c66 2e73 656c 6563 7443 6f6f 7264 4174  lf.selectCoordAt
+00017b30: 6f6d 7328 6368 6169 6e41 7373 6967 6e33  oms(chainAssign3
+00017b40: 2c20 7365 7149 6433 2c20 6174 6f6d 4964  , seqId3, atomId
+00017b50: 332c 2046 616c 7365 2c20 2761 2064 6968  3, False, 'a dih
+00017b60: 6564 7261 6c20 616e 676c 6520 7061 6972  edral angle pair
+00017b70: 2729 0a20 2020 2020 2020 2073 656c 662e  ').        self.
+00017b80: 7365 6c65 6374 436f 6f72 6441 746f 6d73  selectCoordAtoms
+00017b90: 2863 6861 696e 4173 7369 676e 342c 2073  (chainAssign4, s
+00017ba0: 6571 4964 342c 2061 746f 6d49 6434 2c20  eqId4, atomId4, 
+00017bb0: 4661 6c73 652c 2027 6120 6469 6865 6472  False, 'a dihedr
+00017bc0: 616c 2061 6e67 6c65 2070 6169 7227 290a  al angle pair').
+00017bd0: 2020 2020 2020 2020 7365 6c66 2e73 656c          self.sel
+00017be0: 6563 7443 6f6f 7264 4174 6f6d 7328 6368  ectCoordAtoms(ch
+00017bf0: 6169 6e41 7373 6967 6e35 2c20 7365 7149  ainAssign5, seqI
+00017c00: 6435 2c20 6174 6f6d 4964 352c 2046 616c  d5, atomId5, Fal
+00017c10: 7365 2c20 2761 2064 6968 6564 7261 6c20  se, 'a dihedral 
+00017c20: 616e 676c 6520 7061 6972 2729 0a20 2020  angle pair').   
+00017c30: 2020 2020 2073 656c 662e 7365 6c65 6374       self.select
+00017c40: 436f 6f72 6441 746f 6d73 2863 6861 696e  CoordAtoms(chain
+00017c50: 4173 7369 676e 362c 2073 6571 4964 362c  Assign6, seqId6,
+00017c60: 2061 746f 6d49 6436 2c20 4661 6c73 652c   atomId6, False,
+00017c70: 2027 6120 6469 6865 6472 616c 2061 6e67   'a dihedral ang
+00017c80: 6c65 2070 6169 7227 290a 2020 2020 2020  le pair').      
+00017c90: 2020 7365 6c66 2e73 656c 6563 7443 6f6f    self.selectCoo
+00017ca0: 7264 4174 6f6d 7328 6368 6169 6e41 7373  rdAtoms(chainAss
+00017cb0: 6967 6e37 2c20 7365 7149 6437 2c20 6174  ign7, seqId7, at
+00017cc0: 6f6d 4964 372c 2046 616c 7365 2c20 2761  omId7, False, 'a
+00017cd0: 2064 6968 6564 7261 6c20 616e 676c 6520   dihedral angle 
+00017ce0: 7061 6972 2729 0a20 2020 2020 2020 2073  pair').        s
+00017cf0: 656c 662e 7365 6c65 6374 436f 6f72 6441  elf.selectCoordA
+00017d00: 746f 6d73 2863 6861 696e 4173 7369 676e  toms(chainAssign
+00017d10: 382c 2073 6571 4964 382c 2061 746f 6d49  8, seqId8, atomI
+00017d20: 6438 2c20 4661 6c73 652c 2027 6120 6469  d8, False, 'a di
+00017d30: 6865 6472 616c 2061 6e67 6c65 2070 6169  hedral angle pai
+00017d40: 7227 290a 0a20 2020 2020 2020 2069 6620  r')..        if 
+00017d50: 6c65 6e28 7365 6c66 2e61 746f 6d53 656c  len(self.atomSel
+00017d60: 6563 7469 6f6e 5365 7429 203c 2038 3a0a  ectionSet) < 8:.
+00017d70: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00017d80: 726e 0a0a 2020 2020 2020 2020 6966 206e  rn..        if n
+00017d90: 6f74 2073 656c 662e 6172 6555 6e69 7175  ot self.areUniqu
+00017da0: 6543 6f6f 7264 4174 6f6d 7328 2761 2044  eCoordAtoms('a D
+00017db0: 6968 6564 7261 6c20 616e 676c 6520 7061  ihedral angle pa
+00017dc0: 6972 2729 3a0a 2020 2020 2020 2020 2020  ir'):.          
+00017dd0: 2020 7265 7475 726e 0a0a 2020 2020 2020    return..      
+00017de0: 2020 6966 2073 656c 662e 5f5f 6372 6561    if self.__crea
+00017df0: 7465 5366 4469 6374 3a0a 2020 2020 2020  teSfDict:.      
+00017e00: 2020 2020 2020 7366 203d 2073 656c 662e        sf = self.
+00017e10: 5f5f 6765 7453 6628 706f 7465 6e74 6961  __getSf(potentia
+00017e20: 6c54 7970 653d 6765 7450 6f74 656e 7469  lType=getPotenti
+00017e30: 616c 5479 7065 2873 656c 662e 5f5f 6669  alType(self.__fi
+00017e40: 6c65 5f74 7970 652c 2073 656c 662e 5f5f  le_type, self.__
+00017e50: 6375 725f 7375 6274 7970 652c 2064 7374  cur_subtype, dst
+00017e60: 4675 6e63 2929 0a0a 2020 2020 2020 2020  Func))..        
+00017e70: 636f 6d70 4964 203d 2073 656c 662e 6174  compId = self.at
+00017e80: 6f6d 5365 6c65 6374 696f 6e53 6574 5b30  omSelectionSet[0
+00017e90: 5d5b 305d 5b27 636f 6d70 5f69 6427 5d0a  ][0]['comp_id'].
+00017ea0: 2020 2020 2020 2020 7065 7074 6964 652c          peptide,
+00017eb0: 206e 7563 6c65 6f74 6964 652c 2063 6172   nucleotide, car
+00017ec0: 626f 6879 6472 6174 6520 3d20 7365 6c66  bohydrate = self
+00017ed0: 2e5f 5f63 7353 7461 742e 6765 7454 7970  .__csStat.getTyp
+00017ee0: 654f 6643 6f6d 7049 6428 636f 6d70 4964  eOfCompId(compId
+00017ef0: 290a 0a20 2020 2020 2020 2069 6620 7365  )..        if se
+00017f00: 6c66 2e5f 5f63 7572 5f6e 6573 7420 6973  lf.__cur_nest is
+00017f10: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+00017f20: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
+00017f30: 5f64 6562 7567 3a0a 2020 2020 2020 2020  _debug:.        
+00017f40: 2020 2020 2020 2020 7072 696e 7428 6622          print(f"
+00017f50: 4e45 5354 4544 3a20 7b73 656c 662e 5f5f  NESTED: {self.__
+00017f60: 6375 725f 6e65 7374 7d22 290a 0a20 2020  cur_nest}")..   
+00017f70: 2020 2020 2066 6972 7374 5f69 7465 6d20       first_item 
+00017f80: 3d20 5472 7565 0a0a 2020 2020 2020 2020  = True..        
+00017f90: 666f 7220 6174 6f6d 312c 2061 746f 6d32  for atom1, atom2
+00017fa0: 2c20 6174 6f6d 332c 2061 746f 6d34 2069  , atom3, atom4 i
+00017fb0: 6e20 6974 6572 746f 6f6c 732e 7072 6f64  n itertools.prod
+00017fc0: 7563 7428 7365 6c66 2e61 746f 6d53 656c  uct(self.atomSel
+00017fd0: 6563 7469 6f6e 5365 745b 305d 2c0a 2020  ectionSet[0],.  
+00017fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018010: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00018020: 746f 6d53 656c 6563 7469 6f6e 5365 745b  tomSelectionSet[
+00018030: 315d 2c0a 2020 2020 2020 2020 2020 2020  1],.            
+00018040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018070: 7365 6c66 2e61 746f 6d53 656c 6563 7469  self.atomSelecti
+00018080: 6f6e 5365 745b 325d 2c0a 2020 2020 2020  onSet[2],.      
+00018090: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000180a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000180b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000180c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000180d0: 2020 2073 656c 662e 6174 6f6d 5365 6c65     self.atomSele
-000180e0: 6374 696f 6e53 6574 5b31 5d2c 0a20 2020  ctionSet[1],.   
-000180f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018120: 2020 2020 2020 2020 2073 656c 662e 6174           self.at
-00018130: 6f6d 5365 6c65 6374 696f 6e53 6574 5b32  omSelectionSet[2
-00018140: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+000180c0: 2020 2020 2020 7365 6c66 2e61 746f 6d53        self.atomS
+000180d0: 656c 6563 7469 6f6e 5365 745b 335d 293a  electionSet[3]):
+000180e0: 0a20 2020 2020 2020 2020 2020 2061 6e67  .            ang
+000180f0: 6c65 4e61 6d65 203d 2067 6574 5479 7065  leName = getType
+00018100: 4f66 4469 6865 6472 616c 5265 7374 7261  OfDihedralRestra
+00018110: 696e 7428 7065 7074 6964 652c 206e 7563  int(peptide, nuc
+00018120: 6c65 6f74 6964 652c 2063 6172 626f 6879  leotide, carbohy
+00018130: 6472 6174 652c 0a20 2020 2020 2020 2020  drate,.         
+00018140: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00018150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018170: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00018180: 656c 662e 6174 6f6d 5365 6c65 6374 696f  elf.atomSelectio
-00018190: 6e53 6574 5b33 5d29 3a0a 2020 2020 2020  nSet[3]):.      
-000181a0: 2020 2020 2020 616e 676c 654e 616d 6520        angleName 
-000181b0: 3d20 6765 7454 7970 654f 6644 6968 6564  = getTypeOfDihed
-000181c0: 7261 6c52 6573 7472 6169 6e74 2870 6570  ralRestraint(pep
-000181d0: 7469 6465 2c20 6e75 636c 656f 7469 6465  tide, nucleotide
-000181e0: 2c20 6361 7262 6f68 7964 7261 7465 2c0a  , carbohydrate,.
-000181f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018220: 2020 205b 6174 6f6d 312c 2061 746f 6d32     [atom1, atom2
-00018230: 2c20 6174 6f6d 332c 2061 746f 6d34 5d29  , atom3, atom4])
-00018240: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00018250: 616e 676c 654e 616d 6520 6973 204e 6f6e  angleName is Non
-00018260: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00018270: 2020 2063 6f6e 7469 6e75 650a 2020 2020     continue.    
-00018280: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00018290: 5f5f 6465 6275 673a 0a20 2020 2020 2020  __debug:.       
-000182a0: 2020 2020 2020 2020 2070 7269 6e74 2866           print(f
-000182b0: 2273 7562 7479 7065 3d7b 7365 6c66 2e5f  "subtype={self._
-000182c0: 5f63 7572 5f73 7562 7479 7065 7d20 6964  _cur_subtype} id
-000182d0: 3d7b 7365 6c66 2e64 6968 6564 5265 7374  ={self.dihedRest
-000182e0: 7261 696e 7473 7d20 616e 676c 654e 616d  raints} angleNam
-000182f0: 653d 7b61 6e67 6c65 4e61 6d65 7d20 220a  e={angleName} ".
-00018300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018310: 2020 2020 2020 6622 6174 6f6d 313d 7b61        f"atom1={a
-00018320: 746f 6d31 7d20 6174 6f6d 323d 7b61 746f  tom1} atom2={ato
-00018330: 6d32 7d20 6174 6f6d 333d 7b61 746f 6d33  m2} atom3={atom3
-00018340: 7d20 6174 6f6d 343d 7b61 746f 6d34 7d22  } atom4={atom4}"
-00018350: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-00018360: 2073 656c 662e 5f5f 6372 6561 7465 5366   self.__createSf
-00018370: 4469 6374 2061 6e64 2073 6620 6973 206e  Dict and sf is n
-00018380: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-00018390: 2020 2020 2020 2020 2069 6620 6669 7273           if firs
-000183a0: 745f 6974 656d 3a0a 2020 2020 2020 2020  t_item:.        
-000183b0: 2020 2020 2020 2020 2020 2020 7366 5b27              sf['
-000183c0: 6964 275d 202b 3d20 310a 2020 2020 2020  id'] += 1.      
-000183d0: 2020 2020 2020 2020 2020 2020 2020 6669                fi
-000183e0: 7273 745f 6974 656d 203d 2046 616c 7365  rst_item = False
-000183f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018400: 2073 665b 2769 6e64 6578 5f69 6427 5d20   sf['index_id'] 
-00018410: 2b3d 2031 0a20 2020 2020 2020 2020 2020  += 1.           
-00018420: 2020 2020 2072 6f77 203d 2067 6574 526f       row = getRo
-00018430: 7728 7365 6c66 2e5f 5f63 7572 5f73 7562  w(self.__cur_sub
-00018440: 7479 7065 2c20 7366 5b27 6964 275d 2c20  type, sf['id'], 
-00018450: 7366 5b27 696e 6465 785f 6964 275d 2c0a  sf['index_id'],.
-00018460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018470: 2020 2020 2020 2020 2020 2020 2031 2c20               1, 
-00018480: 4e6f 6e65 2c20 616e 676c 654e 616d 652c  None, angleName,
-00018490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000184a0: 2020 2020 2020 2020 2020 2020 2020 7366                sf
-000184b0: 5b27 6c69 7374 5f69 6427 5d2c 2073 656c  ['list_id'], sel
-000184c0: 662e 5f5f 656e 7472 7949 642c 2064 7374  f.__entryId, dst
-000184d0: 4675 6e63 2c0a 2020 2020 2020 2020 2020  Func,.          
-000184e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000184f0: 2020 2073 656c 662e 5f5f 6175 7468 546f     self.__authTo
-00018500: 5374 6172 5365 712c 2073 656c 662e 5f5f  StarSeq, self.__
-00018510: 6175 7468 546f 496e 7343 6f64 652c 2073  authToInsCode, s
-00018520: 656c 662e 5f5f 6f66 6673 6574 486f 6c64  elf.__offsetHold
-00018530: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
-00018540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018550: 2061 746f 6d31 2c20 6174 6f6d 322c 2061   atom1, atom2, a
-00018560: 746f 6d33 2c20 6174 6f6d 3429 0a20 2020  tom3, atom4).   
-00018570: 2020 2020 2020 2020 2020 2020 2073 665b               sf[
-00018580: 276c 6f6f 7027 5d2e 6164 645f 6461 7461  'loop'].add_data
-00018590: 2872 6f77 290a 0a20 2020 2020 2020 2063  (row)..        c
-000185a0: 6f6d 7049 6420 3d20 7365 6c66 2e61 746f  ompId = self.ato
-000185b0: 6d53 656c 6563 7469 6f6e 5365 745b 345d  mSelectionSet[4]
-000185c0: 5b30 5d5b 2763 6f6d 705f 6964 275d 0a20  [0]['comp_id']. 
-000185d0: 2020 2020 2020 2070 6570 7469 6465 2c20         peptide, 
-000185e0: 6e75 636c 656f 7469 6465 2c20 6361 7262  nucleotide, carb
-000185f0: 6f68 7964 7261 7465 203d 2073 656c 662e  ohydrate = self.
-00018600: 5f5f 6373 5374 6174 2e67 6574 5479 7065  __csStat.getType
-00018610: 4f66 436f 6d70 4964 2863 6f6d 7049 6429  OfCompId(compId)
-00018620: 0a0a 2020 2020 2020 2020 666f 7220 6174  ..        for at
-00018630: 6f6d 312c 2061 746f 6d32 2c20 6174 6f6d  om1, atom2, atom
-00018640: 332c 2061 746f 6d34 2069 6e20 6974 6572  3, atom4 in iter
-00018650: 746f 6f6c 732e 7072 6f64 7563 7428 7365  tools.product(se
-00018660: 6c66 2e61 746f 6d53 656c 6563 7469 6f6e  lf.atomSelection
-00018670: 5365 745b 345d 2c0a 2020 2020 2020 2020  Set[4],.        
+00018160: 2020 2020 2020 2020 2020 5b61 746f 6d31            [atom1
+00018170: 2c20 6174 6f6d 322c 2061 746f 6d33 2c20  , atom2, atom3, 
+00018180: 6174 6f6d 345d 290a 2020 2020 2020 2020  atom4]).        
+00018190: 2020 2020 6966 2061 6e67 6c65 4e61 6d65      if angleName
+000181a0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+000181b0: 2020 2020 2020 2020 2020 636f 6e74 696e            contin
+000181c0: 7565 0a20 2020 2020 2020 2020 2020 2069  ue.            i
+000181d0: 6620 7365 6c66 2e5f 5f64 6562 7567 3a0a  f self.__debug:.
+000181e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000181f0: 7072 696e 7428 6622 7375 6274 7970 653d  print(f"subtype=
+00018200: 7b73 656c 662e 5f5f 6375 725f 7375 6274  {self.__cur_subt
+00018210: 7970 657d 2069 643d 7b73 656c 662e 6469  ype} id={self.di
+00018220: 6865 6452 6573 7472 6169 6e74 737d 2061  hedRestraints} a
+00018230: 6e67 6c65 4e61 6d65 3d7b 616e 676c 654e  ngleName={angleN
+00018240: 616d 657d 2022 0a20 2020 2020 2020 2020  ame} ".         
+00018250: 2020 2020 2020 2020 2020 2020 2066 2261               f"a
+00018260: 746f 6d31 3d7b 6174 6f6d 317d 2061 746f  tom1={atom1} ato
+00018270: 6d32 3d7b 6174 6f6d 327d 2061 746f 6d33  m2={atom2} atom3
+00018280: 3d7b 6174 6f6d 337d 2061 746f 6d34 3d7b  ={atom3} atom4={
+00018290: 6174 6f6d 347d 2229 0a20 2020 2020 2020  atom4}").       
+000182a0: 2020 2020 2069 6620 7365 6c66 2e5f 5f63       if self.__c
+000182b0: 7265 6174 6553 6644 6963 7420 616e 6420  reateSfDict and 
+000182c0: 7366 2069 7320 6e6f 7420 4e6f 6e65 3a0a  sf is not None:.
+000182d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000182e0: 6966 2066 6972 7374 5f69 7465 6d3a 0a20  if first_item:. 
+000182f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018300: 2020 2073 665b 2769 6427 5d20 2b3d 2031     sf['id'] += 1
+00018310: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018320: 2020 2020 2066 6972 7374 5f69 7465 6d20       first_item 
+00018330: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
+00018340: 2020 2020 2020 2020 7366 5b27 696e 6465          sf['inde
+00018350: 785f 6964 275d 202b 3d20 310a 2020 2020  x_id'] += 1.    
+00018360: 2020 2020 2020 2020 2020 2020 726f 7720              row 
+00018370: 3d20 6765 7452 6f77 2873 656c 662e 5f5f  = getRow(self.__
+00018380: 6375 725f 7375 6274 7970 652c 2073 665b  cur_subtype, sf[
+00018390: 2769 6427 5d2c 2073 665b 2769 6e64 6578  'id'], sf['index
+000183a0: 5f69 6427 5d2c 0a20 2020 2020 2020 2020  _id'],.         
+000183b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000183c0: 2020 2020 312c 204e 6f6e 652c 2061 6e67      1, None, ang
+000183d0: 6c65 4e61 6d65 2c0a 2020 2020 2020 2020  leName,.        
+000183e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000183f0: 2020 2020 2073 665b 276c 6973 745f 6964       sf['list_id
+00018400: 275d 2c20 7365 6c66 2e5f 5f65 6e74 7279  '], self.__entry
+00018410: 4964 2c20 6473 7446 756e 632c 0a20 2020  Id, dstFunc,.   
+00018420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018430: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00018440: 5f61 7574 6854 6f53 7461 7253 6571 2c20  _authToStarSeq, 
+00018450: 7365 6c66 2e5f 5f61 7574 6854 6f49 6e73  self.__authToIns
+00018460: 436f 6465 2c20 7365 6c66 2e5f 5f6f 6666  Code, self.__off
+00018470: 7365 7448 6f6c 6465 722c 0a20 2020 2020  setHolder,.     
+00018480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018490: 2020 2020 2020 2020 6174 6f6d 312c 2061          atom1, a
+000184a0: 746f 6d32 2c20 6174 6f6d 332c 2061 746f  tom2, atom3, ato
+000184b0: 6d34 290a 2020 2020 2020 2020 2020 2020  m4).            
+000184c0: 2020 2020 7366 5b27 6c6f 6f70 275d 2e61      sf['loop'].a
+000184d0: 6464 5f64 6174 6128 726f 7729 0a0a 2020  dd_data(row)..  
+000184e0: 2020 2020 2020 636f 6d70 4964 203d 2073        compId = s
+000184f0: 656c 662e 6174 6f6d 5365 6c65 6374 696f  elf.atomSelectio
+00018500: 6e53 6574 5b34 5d5b 305d 5b27 636f 6d70  nSet[4][0]['comp
+00018510: 5f69 6427 5d0a 2020 2020 2020 2020 7065  _id'].        pe
+00018520: 7074 6964 652c 206e 7563 6c65 6f74 6964  ptide, nucleotid
+00018530: 652c 2063 6172 626f 6879 6472 6174 6520  e, carbohydrate 
+00018540: 3d20 7365 6c66 2e5f 5f63 7353 7461 742e  = self.__csStat.
+00018550: 6765 7454 7970 654f 6643 6f6d 7049 6428  getTypeOfCompId(
+00018560: 636f 6d70 4964 290a 0a20 2020 2020 2020  compId)..       
+00018570: 2066 6f72 2061 746f 6d31 2c20 6174 6f6d   for atom1, atom
+00018580: 322c 2061 746f 6d33 2c20 6174 6f6d 3420  2, atom3, atom4 
+00018590: 696e 2069 7465 7274 6f6f 6c73 2e70 726f  in itertools.pro
+000185a0: 6475 6374 2873 656c 662e 6174 6f6d 5365  duct(self.atomSe
+000185b0: 6c65 6374 696f 6e53 6574 5b34 5d2c 0a20  lectionSet[4],. 
+000185c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000185d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000185e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000185f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00018600: 6174 6f6d 5365 6c65 6374 696f 6e53 6574  atomSelectionSet
+00018610: 5b35 5d2c 0a20 2020 2020 2020 2020 2020  [5],.           
+00018620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018650: 2073 656c 662e 6174 6f6d 5365 6c65 6374   self.atomSelect
+00018660: 696f 6e53 6574 5b36 5d2c 0a20 2020 2020  ionSet[6],.     
+00018670: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00018680: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00018690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000186a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000186b0: 2020 2020 7365 6c66 2e61 746f 6d53 656c      self.atomSel
-000186c0: 6563 7469 6f6e 5365 745b 355d 2c0a 2020  ectionSet[5],.  
-000186d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000186e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000186f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018700: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00018710: 746f 6d53 656c 6563 7469 6f6e 5365 745b  tomSelectionSet[
-00018720: 365d 2c0a 2020 2020 2020 2020 2020 2020  6],.            
+000186a0: 2020 2020 2020 2073 656c 662e 6174 6f6d         self.atom
+000186b0: 5365 6c65 6374 696f 6e53 6574 5b37 5d29  SelectionSet[7])
+000186c0: 3a0a 2020 2020 2020 2020 2020 2020 616e  :.            an
+000186d0: 676c 654e 616d 6520 3d20 6765 7454 7970  gleName = getTyp
+000186e0: 654f 6644 6968 6564 7261 6c52 6573 7472  eOfDihedralRestr
+000186f0: 6169 6e74 2870 6570 7469 6465 2c20 6e75  aint(peptide, nu
+00018700: 636c 656f 7469 6465 2c20 6361 7262 6f68  cleotide, carboh
+00018710: 7964 7261 7465 2c0a 2020 2020 2020 2020  ydrate,.        
+00018720: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00018730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018760: 7365 6c66 2e61 746f 6d53 656c 6563 7469  self.atomSelecti
-00018770: 6f6e 5365 745b 375d 293a 0a20 2020 2020  onSet[7]):.     
-00018780: 2020 2020 2020 2061 6e67 6c65 4e61 6d65         angleName
-00018790: 203d 2067 6574 5479 7065 4f66 4469 6865   = getTypeOfDihe
-000187a0: 6472 616c 5265 7374 7261 696e 7428 7065  dralRestraint(pe
-000187b0: 7074 6964 652c 206e 7563 6c65 6f74 6964  ptide, nucleotid
-000187c0: 652c 2063 6172 626f 6879 6472 6174 652c  e, carbohydrate,
-000187d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000187e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000187f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018800: 2020 2020 5b61 746f 6d31 2c20 6174 6f6d      [atom1, atom
-00018810: 322c 2061 746f 6d33 2c20 6174 6f6d 345d  2, atom3, atom4]
-00018820: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-00018830: 2061 6e67 6c65 4e61 6d65 2069 7320 4e6f   angleName is No
-00018840: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00018850: 2020 2020 636f 6e74 696e 7565 0a20 2020      continue.   
-00018860: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00018870: 2e5f 5f64 6562 7567 3a0a 2020 2020 2020  .__debug:.      
-00018880: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00018890: 6622 7375 6274 7970 653d 7b73 656c 662e  f"subtype={self.
-000188a0: 5f5f 6375 725f 7375 6274 7970 657d 2069  __cur_subtype} i
-000188b0: 643d 7b73 656c 662e 6469 6865 6452 6573  d={self.dihedRes
-000188c0: 7472 6169 6e74 737d 2061 6e67 6c65 4e61  traints} angleNa
-000188d0: 6d65 3d7b 616e 676c 654e 616d 657d 2022  me={angleName} "
-000188e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000188f0: 2020 2020 2020 2066 2261 746f 6d35 3d7b         f"atom5={
-00018900: 6174 6f6d 317d 2061 746f 6d36 3d7b 6174  atom1} atom6={at
-00018910: 6f6d 327d 2061 746f 6d37 3d7b 6174 6f6d  om2} atom7={atom
-00018920: 337d 2061 746f 6d38 3d7b 6174 6f6d 347d  3} atom8={atom4}
-00018930: 207b 6473 7446 756e 637d 2229 0a20 2020   {dstFunc}").   
-00018940: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00018950: 2e5f 5f63 7265 6174 6553 6644 6963 7420  .__createSfDict 
-00018960: 616e 6420 7366 2069 7320 6e6f 7420 4e6f  and sf is not No
-00018970: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00018980: 2020 2020 6966 2066 6972 7374 5f69 7465      if first_ite
-00018990: 6d3a 0a20 2020 2020 2020 2020 2020 2020  m:.             
-000189a0: 2020 2020 2020 2073 665b 2769 6427 5d20         sf['id'] 
-000189b0: 2b3d 2031 0a20 2020 2020 2020 2020 2020  += 1.           
-000189c0: 2020 2020 2020 2020 2066 6972 7374 5f69           first_i
-000189d0: 7465 6d20 3d20 4661 6c73 650a 2020 2020  tem = False.    
-000189e0: 2020 2020 2020 2020 2020 2020 7366 5b27              sf['
-000189f0: 696e 6465 785f 6964 275d 202b 3d20 310a  index_id'] += 1.
-00018a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018a10: 726f 7720 3d20 6765 7452 6f77 2873 656c  row = getRow(sel
-00018a20: 662e 5f5f 6375 725f 7375 6274 7970 652c  f.__cur_subtype,
-00018a30: 2073 665b 2769 6427 5d2c 2073 665b 2769   sf['id'], sf['i
-00018a40: 6e64 6578 5f69 6427 5d2c 0a20 2020 2020  ndex_id'],.     
-00018a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018a60: 2020 2020 2020 2020 322c 204e 6f6e 652c          2, None,
-00018a70: 2061 6e67 6c65 4e61 6d65 2c0a 2020 2020   angleName,.    
-00018a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018a90: 2020 2020 2020 2020 2073 665b 276c 6973           sf['lis
-00018aa0: 745f 6964 275d 2c20 7365 6c66 2e5f 5f65  t_id'], self.__e
-00018ab0: 6e74 7279 4964 2c20 6473 7446 756e 632c  ntryId, dstFunc,
-00018ac0: 2073 656c 662e 5f5f 6175 7468 546f 5374   self.__authToSt
-00018ad0: 6172 5365 712c 2061 746f 6d31 2c20 6174  arSeq, atom1, at
-00018ae0: 6f6d 322c 2061 746f 6d33 2c20 6174 6f6d  om2, atom3, atom
-00018af0: 3429 0a20 2020 2020 2020 2020 2020 2020  4).             
-00018b00: 2020 2073 665b 276c 6f6f 7027 5d2e 6164     sf['loop'].ad
-00018b10: 645f 6461 7461 2872 6f77 290a 0a20 2020  d_data(row)..   
-00018b20: 2023 2045 6e74 6572 2061 2070 6172 7365   # Enter a parse
-00018b30: 2074 7265 6520 7072 6f64 7563 6564 2062   tree produced b
-00018b40: 7920 526f 7365 7474 614d 5250 6172 7365  y RosettaMRParse
-00018b50: 7223 636f 6f72 6469 6e61 7465 5f72 6573  r#coordinate_res
-00018b60: 7472 6169 6e74 732e 0a20 2020 2064 6566  traints..    def
-00018b70: 2065 6e74 6572 436f 6f72 6469 6e61 7465   enterCoordinate
-00018b80: 5f72 6573 7472 6169 6e74 7328 7365 6c66  _restraints(self
-00018b90: 2c20 6374 783a 2052 6f73 6574 7461 4d52  , ctx: RosettaMR
-00018ba0: 5061 7273 6572 2e43 6f6f 7264 696e 6174  Parser.Coordinat
-00018bb0: 655f 7265 7374 7261 696e 7473 436f 6e74  e_restraintsCont
-00018bc0: 6578 7429 3a20 2023 2070 796c 696e 743a  ext):  # pylint:
-00018bd0: 2064 6973 6162 6c65 3d75 6e75 7365 642d   disable=unused-
-00018be0: 6172 6775 6d65 6e74 0a20 2020 2020 2020  argument.       
-00018bf0: 2073 656c 662e 5f5f 6375 725f 7375 6274   self.__cur_subt
-00018c00: 7970 6520 3d20 2767 656f 270a 0a20 2020  ype = 'geo'..   
-00018c10: 2023 2045 7869 7420 6120 7061 7273 6520   # Exit a parse 
-00018c20: 7472 6565 2070 726f 6475 6365 6420 6279  tree produced by
-00018c30: 2052 6f73 6574 7461 4d52 5061 7273 6572   RosettaMRParser
-00018c40: 2363 6f6f 7264 696e 6174 655f 7265 7374  #coordinate_rest
-00018c50: 7261 696e 7473 2e0a 2020 2020 6465 6620  raints..    def 
-00018c60: 6578 6974 436f 6f72 6469 6e61 7465 5f72  exitCoordinate_r
-00018c70: 6573 7472 6169 6e74 7328 7365 6c66 2c20  estraints(self, 
-00018c80: 6374 783a 2052 6f73 6574 7461 4d52 5061  ctx: RosettaMRPa
-00018c90: 7273 6572 2e43 6f6f 7264 696e 6174 655f  rser.Coordinate_
-00018ca0: 7265 7374 7261 696e 7473 436f 6e74 6578  restraintsContex
-00018cb0: 7429 3a20 2023 2070 796c 696e 743a 2064  t):  # pylint: d
-00018cc0: 6973 6162 6c65 3d75 6e75 7365 642d 6172  isable=unused-ar
-00018cd0: 6775 6d65 6e74 0a20 2020 2020 2020 2070  gument.        p
-00018ce0: 6173 730a 0a20 2020 2023 2045 6e74 6572  ass..    # Enter
-00018cf0: 2061 2070 6172 7365 2074 7265 6520 7072   a parse tree pr
-00018d00: 6f64 7563 6564 2062 7920 526f 7365 7474  oduced by Rosett
-00018d10: 614d 5250 6172 7365 7223 636f 6f72 6469  aMRParser#coordi
-00018d20: 6e61 7465 5f72 6573 7472 6169 6e74 2e0a  nate_restraint..
-00018d30: 2020 2020 6465 6620 656e 7465 7243 6f6f      def enterCoo
-00018d40: 7264 696e 6174 655f 7265 7374 7261 696e  rdinate_restrain
-00018d50: 7428 7365 6c66 2c20 6374 783a 2052 6f73  t(self, ctx: Ros
-00018d60: 6574 7461 4d52 5061 7273 6572 2e43 6f6f  ettaMRParser.Coo
-00018d70: 7264 696e 6174 655f 7265 7374 7261 696e  rdinate_restrain
-00018d80: 7443 6f6e 7465 7874 293a 2020 2320 7079  tContext):  # py
-00018d90: 6c69 6e74 3a20 6469 7361 626c 653d 756e  lint: disable=un
-00018da0: 7573 6564 2d61 7267 756d 656e 740a 2020  used-argument.  
-00018db0: 2020 2020 2020 7365 6c66 2e67 656f 5265        self.geoRe
-00018dc0: 7374 7261 696e 7473 202b 3d20 310a 0a20  straints += 1.. 
-00018dd0: 2020 2020 2020 2073 656c 662e 7374 6163         self.stac
-00018de0: 6b46 756e 6373 2e63 6c65 6172 2829 0a20  kFuncs.clear(). 
-00018df0: 2020 2020 2020 2073 656c 662e 6174 6f6d         self.atom
-00018e00: 5365 6c65 6374 696f 6e53 6574 2e63 6c65  SelectionSet.cle
-00018e10: 6172 2829 0a0a 2020 2020 2320 4578 6974  ar()..    # Exit
-00018e20: 2061 2070 6172 7365 2074 7265 6520 7072   a parse tree pr
-00018e30: 6f64 7563 6564 2062 7920 526f 7365 7474  oduced by Rosett
-00018e40: 614d 5250 6172 7365 7223 636f 6f72 6469  aMRParser#coordi
-00018e50: 6e61 7465 5f72 6573 7472 6169 6e74 2e0a  nate_restraint..
-00018e60: 2020 2020 6465 6620 6578 6974 436f 6f72      def exitCoor
-00018e70: 6469 6e61 7465 5f72 6573 7472 6169 6e74  dinate_restraint
-00018e80: 2873 656c 662c 2063 7478 3a20 526f 7365  (self, ctx: Rose
-00018e90: 7474 614d 5250 6172 7365 722e 436f 6f72  ttaMRParser.Coor
-00018ea0: 6469 6e61 7465 5f72 6573 7472 6169 6e74  dinate_restraint
-00018eb0: 436f 6e74 6578 7429 3a0a 0a20 2020 2020  Context):..     
-00018ec0: 2020 2074 7279 3a0a 0a20 2020 2020 2020     try:..       
-00018ed0: 2020 2020 2061 746f 6d49 6431 203d 2073       atomId1 = s
-00018ee0: 7472 2863 7478 2e53 696d 706c 655f 6e61  tr(ctx.Simple_na
-00018ef0: 6d65 2830 2929 2e75 7070 6572 2829 0a20  me(0)).upper(). 
-00018f00: 2020 2020 2020 2020 2020 205f 7365 7149             _seqI
-00018f10: 6431 203d 2073 7472 2863 7478 2e53 696d  d1 = str(ctx.Sim
-00018f20: 706c 655f 6e61 6d65 2831 2929 2e75 7070  ple_name(1)).upp
-00018f30: 6572 2829 0a20 2020 2020 2020 2020 2020  er().           
-00018f40: 2061 746f 6d49 6432 203d 2073 7472 2863   atomId2 = str(c
-00018f50: 7478 2e53 696d 706c 655f 6e61 6d65 2832  tx.Simple_name(2
-00018f60: 2929 2e75 7070 6572 2829 0a20 2020 2020  )).upper().     
-00018f70: 2020 2020 2020 205f 7365 7149 6432 203d         _seqId2 =
-00018f80: 2073 7472 2863 7478 2e53 696d 706c 655f   str(ctx.Simple_
-00018f90: 6e61 6d65 2833 2929 2e75 7070 6572 2829  name(3)).upper()
-00018fa0: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00018fb0: 206c 656e 2873 656c 662e 6e75 6d62 6572   len(self.number
-00018fc0: 5365 6c65 6374 696f 6e29 203d 3d20 3020  Selection) == 0 
-00018fd0: 6f72 204e 6f6e 6520 696e 2073 656c 662e  or None in self.
-00018fe0: 6e75 6d62 6572 5365 6c65 6374 696f 6e3a  numberSelection:
-00018ff0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019000: 2072 6574 7572 6e0a 0a20 2020 2020 2020   return..       
-00019010: 2020 2020 2063 6172 7458 203d 2073 656c       cartX = sel
-00019020: 662e 6e75 6d62 6572 5365 6c65 6374 696f  f.numberSelectio
-00019030: 6e5b 305d 0a20 2020 2020 2020 2020 2020  n[0].           
-00019040: 2063 6172 7459 203d 2073 656c 662e 6e75   cartY = self.nu
-00019050: 6d62 6572 5365 6c65 6374 696f 6e5b 315d  mberSelection[1]
-00019060: 0a20 2020 2020 2020 2020 2020 2063 6172  .            car
-00019070: 745a 203d 2073 656c 662e 6e75 6d62 6572  tZ = self.number
-00019080: 5365 6c65 6374 696f 6e5b 325d 0a0a 2020  Selection[2]..  
-00019090: 2020 2020 2020 2020 2020 6966 205f 7365            if _se
-000190a0: 7149 6431 2e69 7364 6563 696d 616c 2829  qId1.isdecimal()
-000190b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000190c0: 2020 7365 7149 6431 203d 2069 6e74 285f    seqId1 = int(_
-000190d0: 7365 7149 6431 290a 2020 2020 2020 2020  seqId1).        
-000190e0: 2020 2020 2020 2020 6669 7865 6443 6861          fixedCha
-000190f0: 696e 4964 3120 3d20 4e6f 6e65 0a20 2020  inId1 = None.   
-00019100: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00019110: 2020 2020 2020 2020 2020 2020 2020 2067                 g
-00019120: 203d 2073 656c 662e 636f 6e63 6174 5f72   = self.concat_r
-00019130: 6573 6e75 6d5f 6368 6169 6e5f 7061 742e  esnum_chain_pat.
-00019140: 7365 6172 6368 285f 7365 7149 6431 292e  search(_seqId1).
-00019150: 6772 6f75 7073 2829 0a20 2020 2020 2020  groups().       
-00019160: 2020 2020 2020 2020 2073 6571 4964 3120           seqId1 
-00019170: 3d20 696e 7428 675b 305d 290a 2020 2020  = int(g[0]).    
-00019180: 2020 2020 2020 2020 2020 2020 6669 7865              fixe
-00019190: 6443 6861 696e 4964 3120 3d20 675b 315d  dChainId1 = g[1]
-000191a0: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-000191b0: 205f 7365 7149 6432 2e69 7364 6563 696d   _seqId2.isdecim
-000191c0: 616c 2829 3a0a 2020 2020 2020 2020 2020  al():.          
-000191d0: 2020 2020 2020 7365 7149 6432 203d 2069        seqId2 = i
-000191e0: 6e74 285f 7365 7149 6432 290a 2020 2020  nt(_seqId2).    
-000191f0: 2020 2020 2020 2020 2020 2020 6669 7865              fixe
-00019200: 6443 6861 696e 4964 3220 3d20 4e6f 6e65  dChainId2 = None
-00019210: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00019220: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00019230: 2020 2067 203d 2073 656c 662e 636f 6e63     g = self.conc
-00019240: 6174 5f72 6573 6e75 6d5f 6368 6169 6e5f  at_resnum_chain_
-00019250: 7061 742e 7365 6172 6368 285f 7365 7149  pat.search(_seqI
-00019260: 6432 292e 6772 6f75 7073 2829 0a20 2020  d2).groups().   
-00019270: 2020 2020 2020 2020 2020 2020 2073 6571               seq
-00019280: 4964 3220 3d20 696e 7428 675b 305d 290a  Id2 = int(g[0]).
-00019290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000192a0: 6669 7865 6443 6861 696e 4964 3220 3d20  fixedChainId2 = 
-000192b0: 675b 315d 0a0a 2020 2020 2020 2020 2020  g[1]..          
-000192c0: 2020 6966 206e 6f74 2073 656c 662e 5f5f    if not self.__
-000192d0: 6861 7350 6f6c 7953 6571 3a0a 2020 2020  hasPolySeq:.    
-000192e0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000192f0: 726e 0a0a 2020 2020 2020 2020 2020 2020  rn..            
-00019300: 7365 6c66 2e5f 5f72 6574 7269 6576 654c  self.__retrieveL
-00019310: 6f63 616c 5365 7153 6368 656d 6528 290a  ocalSeqScheme().
-00019320: 0a20 2020 2020 2020 2020 2020 2063 6861  .            cha
-00019330: 696e 4173 7369 676e 3120 3d20 7365 6c66  inAssign1 = self
-00019340: 2e61 7373 6967 6e43 6f6f 7264 506f 6c79  .assignCoordPoly
-00019350: 6d65 7253 6571 7565 6e63 6528 7365 7149  merSequence(seqI
-00019360: 6431 2c20 6174 6f6d 4964 312c 2066 6978  d1, atomId1, fix
-00019370: 6564 4368 6169 6e49 6431 290a 2020 2020  edChainId1).    
-00019380: 2020 2020 2020 2020 6368 6169 6e41 7373          chainAss
-00019390: 6967 6e32 203d 2073 656c 662e 6173 7369  ign2 = self.assi
-000193a0: 676e 436f 6f72 6450 6f6c 796d 6572 5365  gnCoordPolymerSe
-000193b0: 7175 656e 6365 2873 6571 4964 322c 2061  quence(seqId2, a
-000193c0: 746f 6d49 6432 2c20 6669 7865 6443 6861  tomId2, fixedCha
-000193d0: 696e 4964 3229 0a0a 2020 2020 2020 2020  inId2)..        
-000193e0: 2020 2020 6966 206c 656e 2863 6861 696e      if len(chain
-000193f0: 4173 7369 676e 3129 203d 3d20 3020 6f72  Assign1) == 0 or
-00019400: 206c 656e 2863 6861 696e 4173 7369 676e   len(chainAssign
-00019410: 3229 203d 3d20 303a 0a20 2020 2020 2020  2) == 0:.       
-00019420: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
-00019430: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00019440: 662e 7365 6c65 6374 436f 6f72 6441 746f  f.selectCoordAto
-00019450: 6d73 2863 6861 696e 4173 7369 676e 312c  ms(chainAssign1,
-00019460: 2073 6571 4964 312c 2061 746f 6d49 6431   seqId1, atomId1
-00019470: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-00019480: 6c66 2e73 656c 6563 7443 6f6f 7264 4174  lf.selectCoordAt
-00019490: 6f6d 7328 6368 6169 6e41 7373 6967 6e32  oms(chainAssign2
-000194a0: 2c20 7365 7149 6432 2c20 6174 6f6d 4964  , seqId2, atomId
-000194b0: 322c 2046 616c 7365 2c20 2761 2063 6f6f  2, False, 'a coo
-000194c0: 7264 696e 6174 6527 2920 2023 2072 6566  rdinate')  # ref
-000194d0: 4174 6f6d 0a0a 2020 2020 2020 2020 2020  Atom..          
-000194e0: 2020 6966 206c 656e 2873 656c 662e 6174    if len(self.at
-000194f0: 6f6d 5365 6c65 6374 696f 6e53 6574 2920  omSelectionSet) 
-00019500: 3c20 323a 0a20 2020 2020 2020 2020 2020  < 2:.           
-00019510: 2020 2020 2072 6574 7572 6e0a 0a20 2020       return..   
-00019520: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
-00019530: 616c 6c6f 775a 6572 6f55 7070 6572 4c69  allowZeroUpperLi
-00019540: 6d69 7420 3d20 4661 6c73 650a 2020 2020  mit = False.    
-00019550: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00019560: 5f5f 7265 6173 6f6e 7320 6973 206e 6f74  __reasons is not
-00019570: 204e 6f6e 6520 616e 6420 276d 6f64 656c   None and 'model
-00019580: 5f63 6861 696e 5f69 645f 6578 7427 2069  _chain_id_ext' i
-00019590: 6e20 7365 6c66 2e5f 5f72 6561 736f 6e73  n self.__reasons
-000195a0: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
-000195b0: 2061 6e64 206c 656e 2873 656c 662e 6174   and len(self.at
-000195c0: 6f6d 5365 6c65 6374 696f 6e53 6574 5b30  omSelectionSet[0
-000195d0: 5d29 203e 2030 5c0a 2020 2020 2020 2020  ]) > 0\.        
-000195e0: 2020 2020 2020 2061 6e64 206c 656e 2873         and len(s
-000195f0: 656c 662e 6174 6f6d 5365 6c65 6374 696f  elf.atomSelectio
-00019600: 6e53 6574 5b30 5d29 203d 3d20 6c65 6e28  nSet[0]) == len(
-00019610: 7365 6c66 2e61 746f 6d53 656c 6563 7469  self.atomSelecti
-00019620: 6f6e 5365 745b 315d 293a 0a20 2020 2020  onSet[1]):.     
-00019630: 2020 2020 2020 2020 2020 2063 6861 696e             chain
-00019640: 5f69 645f 3120 3d20 7365 6c66 2e61 746f  _id_1 = self.ato
-00019650: 6d53 656c 6563 7469 6f6e 5365 745b 305d  mSelectionSet[0]
-00019660: 5b30 5d5b 2763 6861 696e 5f69 6427 5d0a  [0]['chain_id'].
-00019670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019680: 7365 715f 6964 5f31 203d 2073 656c 662e  seq_id_1 = self.
-00019690: 6174 6f6d 5365 6c65 6374 696f 6e53 6574  atomSelectionSet
-000196a0: 5b30 5d5b 305d 5b27 7365 715f 6964 275d  [0][0]['seq_id']
-000196b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000196c0: 2061 746f 6d5f 6964 5f31 203d 2073 656c   atom_id_1 = sel
-000196d0: 662e 6174 6f6d 5365 6c65 6374 696f 6e53  f.atomSelectionS
-000196e0: 6574 5b30 5d5b 305d 5b27 6174 6f6d 5f69  et[0][0]['atom_i
-000196f0: 6427 5d0a 0a20 2020 2020 2020 2020 2020  d']..           
-00019700: 2020 2020 2063 6861 696e 5f69 645f 3220       chain_id_2 
-00019710: 3d20 7365 6c66 2e61 746f 6d53 656c 6563  = self.atomSelec
-00019720: 7469 6f6e 5365 745b 315d 5b30 5d5b 2763  tionSet[1][0]['c
-00019730: 6861 696e 5f69 6427 5d0a 2020 2020 2020  hain_id'].      
-00019740: 2020 2020 2020 2020 2020 7365 715f 6964            seq_id
-00019750: 5f32 203d 2073 656c 662e 6174 6f6d 5365  _2 = self.atomSe
-00019760: 6c65 6374 696f 6e53 6574 5b31 5d5b 305d  lectionSet[1][0]
-00019770: 5b27 7365 715f 6964 275d 0a20 2020 2020  ['seq_id'].     
-00019780: 2020 2020 2020 2020 2020 2061 746f 6d5f             atom_
-00019790: 6964 5f32 203d 2073 656c 662e 6174 6f6d  id_2 = self.atom
-000197a0: 5365 6c65 6374 696f 6e53 6574 5b31 5d5b  SelectionSet[1][
-000197b0: 305d 5b27 6174 6f6d 5f69 6427 5d0a 0a20  0]['atom_id'].. 
-000197c0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000197d0: 6620 6368 6169 6e5f 6964 5f31 2021 3d20  f chain_id_1 != 
-000197e0: 6368 6169 6e5f 6964 5f32 2061 6e64 2073  chain_id_2 and s
-000197f0: 6571 5f69 645f 3120 3d3d 2073 6571 5f69  eq_id_1 == seq_i
-00019800: 645f 3220 616e 6420 6174 6f6d 5f69 645f  d_2 and atom_id_
-00019810: 3120 3d3d 2061 746f 6d5f 6964 5f32 5c0a  1 == atom_id_2\.
-00019820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019830: 2020 2061 6e64 2028 2863 6861 696e 5f69     and ((chain_i
-00019840: 645f 3120 696e 2073 656c 662e 5f5f 7265  d_1 in self.__re
-00019850: 6173 6f6e 735b 276d 6f64 656c 5f63 6861  asons['model_cha
-00019860: 696e 5f69 645f 6578 7427 5d20 616e 6420  in_id_ext'] and 
-00019870: 6368 6169 6e5f 6964 5f32 2069 6e20 7365  chain_id_2 in se
-00019880: 6c66 2e5f 5f72 6561 736f 6e73 5b27 6d6f  lf.__reasons['mo
-00019890: 6465 6c5f 6368 6169 6e5f 6964 5f65 7874  del_chain_id_ext
-000198a0: 275d 5b63 6861 696e 5f69 645f 315d 290a  '][chain_id_1]).
-000198b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000198c0: 2020 2020 2020 2020 6f72 2028 6368 6169          or (chai
-000198d0: 6e5f 6964 5f32 2069 6e20 7365 6c66 2e5f  n_id_2 in self._
-000198e0: 5f72 6561 736f 6e73 5b27 6d6f 6465 6c5f  _reasons['model_
-000198f0: 6368 6169 6e5f 6964 5f65 7874 275d 2061  chain_id_ext'] a
-00019900: 6e64 2063 6861 696e 5f69 645f 3120 696e  nd chain_id_1 in
-00019910: 2073 656c 662e 5f5f 7265 6173 6f6e 735b   self.__reasons[
-00019920: 276d 6f64 656c 5f63 6861 696e 5f69 645f  'model_chain_id_
-00019930: 6578 7427 5d5b 6368 6169 6e5f 6964 5f32  ext'][chain_id_2
-00019940: 5d29 293a 0a20 2020 2020 2020 2020 2020  ])):.           
-00019950: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
-00019960: 616c 6c6f 775a 6572 6f55 7070 6572 4c69  allowZeroUpperLi
-00019970: 6d69 7420 3d20 5472 7565 0a20 2020 2020  mit = True.     
-00019980: 2020 2020 2020 2073 656c 662e 5f5f 616c         self.__al
-00019990: 6c6f 775a 6572 6f55 7070 6572 4c69 6d69  lowZeroUpperLimi
-000199a0: 7420 7c3d 2068 6173 496e 7465 7243 6861  t |= hasInterCha
-000199b0: 696e 5265 7374 7261 696e 7428 7365 6c66  inRestraint(self
-000199c0: 2e61 746f 6d53 656c 6563 7469 6f6e 5365  .atomSelectionSe
-000199d0: 7429 0a0a 2020 2020 2020 2020 2020 2020  t)..            
-000199e0: 6473 7446 756e 6320 3d20 7365 6c66 2e76  dstFunc = self.v
-000199f0: 616c 6964 6174 6544 6973 7461 6e63 6552  alidateDistanceR
-00019a00: 616e 6765 2831 2e30 290a 0a20 2020 2020  ange(1.0)..     
-00019a10: 2020 2020 2020 2069 6620 6473 7446 756e         if dstFun
-00019a20: 6320 6973 204e 6f6e 653a 0a20 2020 2020  c is None:.     
-00019a30: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00019a40: 6e0a 0a20 2020 2020 2020 2020 2020 2069  n..            i
-00019a50: 6620 7365 6c66 2e5f 5f63 7265 6174 6553  f self.__createS
-00019a60: 6644 6963 743a 0a20 2020 2020 2020 2020  fDict:.         
-00019a70: 2020 2020 2020 2073 6620 3d20 7365 6c66         sf = self
-00019a80: 2e5f 5f67 6574 5366 2827 6861 726d 6f6e  .__getSf('harmon
-00019a90: 6963 2063 6f6f 7264 696e 6174 6520 7265  ic coordinate re
-00019aa0: 7374 7261 696e 742c 2052 4f53 4554 5441  straint, ROSETTA
-00019ab0: 2043 6f6f 7264 696e 6174 6543 6f6e 7374   CoordinateConst
-00019ac0: 7261 696e 7427 290a 2020 2020 2020 2020  raint').        
-00019ad0: 2020 2020 2020 2020 7366 5b27 6964 275d          sf['id']
-00019ae0: 202b 3d20 310a 2020 2020 2020 2020 2020   += 1.          
-00019af0: 2020 2020 2020 6966 206c 656e 2873 665b        if len(sf[
-00019b00: 276c 6f6f 7027 5d5b 2774 6167 7327 5d29  'loop']['tags'])
-00019b10: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
-00019b20: 2020 2020 2020 2020 2020 2073 665b 276c             sf['l
-00019b30: 6f6f 7027 5d5b 2774 6167 7327 5d20 3d20  oop']['tags'] = 
-00019b40: 5b27 696e 6465 785f 6964 272c 2027 6964  ['index_id', 'id
-00019b50: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-00019b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019b70: 2020 2020 2020 2020 2020 2020 2027 6175               'au
-00019b80: 7468 5f61 7379 6d5f 6964 272c 2027 6175  th_asym_id', 'au
-00019b90: 7468 5f73 6571 5f69 6427 2c20 2761 7574  th_seq_id', 'aut
-00019ba0: 685f 636f 6d70 5f69 6427 2c20 2761 7574  h_comp_id', 'aut
-00019bb0: 685f 6174 6f6d 5f69 6427 2c0a 2020 2020  h_atom_id',.    
-00019bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018740: 2020 2020 2020 2020 2020 205b 6174 6f6d             [atom
+00018750: 312c 2061 746f 6d32 2c20 6174 6f6d 332c  1, atom2, atom3,
+00018760: 2061 746f 6d34 5d29 0a20 2020 2020 2020   atom4]).       
+00018770: 2020 2020 2069 6620 616e 676c 654e 616d       if angleNam
+00018780: 6520 6973 204e 6f6e 653a 0a20 2020 2020  e is None:.     
+00018790: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
+000187a0: 6e75 650a 2020 2020 2020 2020 2020 2020  nue.            
+000187b0: 6966 2073 656c 662e 5f5f 6465 6275 673a  if self.__debug:
+000187c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000187d0: 2070 7269 6e74 2866 2273 7562 7479 7065   print(f"subtype
+000187e0: 3d7b 7365 6c66 2e5f 5f63 7572 5f73 7562  ={self.__cur_sub
+000187f0: 7479 7065 7d20 6964 3d7b 7365 6c66 2e64  type} id={self.d
+00018800: 6968 6564 5265 7374 7261 696e 7473 7d20  ihedRestraints} 
+00018810: 616e 676c 654e 616d 653d 7b61 6e67 6c65  angleName={angle
+00018820: 4e61 6d65 7d20 220a 2020 2020 2020 2020  Name} ".        
+00018830: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+00018840: 6174 6f6d 353d 7b61 746f 6d31 7d20 6174  atom5={atom1} at
+00018850: 6f6d 363d 7b61 746f 6d32 7d20 6174 6f6d  om6={atom2} atom
+00018860: 373d 7b61 746f 6d33 7d20 6174 6f6d 383d  7={atom3} atom8=
+00018870: 7b61 746f 6d34 7d20 7b64 7374 4675 6e63  {atom4} {dstFunc
+00018880: 7d22 290a 2020 2020 2020 2020 2020 2020  }").            
+00018890: 6966 2073 656c 662e 5f5f 6372 6561 7465  if self.__create
+000188a0: 5366 4469 6374 2061 6e64 2073 6620 6973  SfDict and sf is
+000188b0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+000188c0: 2020 2020 2020 2020 2020 2069 6620 6669             if fi
+000188d0: 7273 745f 6974 656d 3a0a 2020 2020 2020  rst_item:.      
+000188e0: 2020 2020 2020 2020 2020 2020 2020 7366                sf
+000188f0: 5b27 6964 275d 202b 3d20 310a 2020 2020  ['id'] += 1.    
+00018900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018910: 6669 7273 745f 6974 656d 203d 2046 616c  first_item = Fal
+00018920: 7365 0a20 2020 2020 2020 2020 2020 2020  se.             
+00018930: 2020 2073 665b 2769 6e64 6578 5f69 6427     sf['index_id'
+00018940: 5d20 2b3d 2031 0a20 2020 2020 2020 2020  ] += 1.         
+00018950: 2020 2020 2020 2072 6f77 203d 2067 6574         row = get
+00018960: 526f 7728 7365 6c66 2e5f 5f63 7572 5f73  Row(self.__cur_s
+00018970: 7562 7479 7065 2c20 7366 5b27 6964 275d  ubtype, sf['id']
+00018980: 2c20 7366 5b27 696e 6465 785f 6964 275d  , sf['index_id']
+00018990: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000189a0: 2020 2020 2020 2020 2020 2020 2020 2032                 2
+000189b0: 2c20 4e6f 6e65 2c20 616e 676c 654e 616d  , None, angleNam
+000189c0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+000189d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000189e0: 7366 5b27 6c69 7374 5f69 6427 5d2c 2073  sf['list_id'], s
+000189f0: 656c 662e 5f5f 656e 7472 7949 642c 2064  elf.__entryId, d
+00018a00: 7374 4675 6e63 2c20 7365 6c66 2e5f 5f61  stFunc, self.__a
+00018a10: 7574 6854 6f53 7461 7253 6571 2c20 6174  uthToStarSeq, at
+00018a20: 6f6d 312c 2061 746f 6d32 2c20 6174 6f6d  om1, atom2, atom
+00018a30: 332c 2061 746f 6d34 290a 2020 2020 2020  3, atom4).      
+00018a40: 2020 2020 2020 2020 2020 7366 5b27 6c6f            sf['lo
+00018a50: 6f70 275d 2e61 6464 5f64 6174 6128 726f  op'].add_data(ro
+00018a60: 7729 0a0a 2020 2020 2320 456e 7465 7220  w)..    # Enter 
+00018a70: 6120 7061 7273 6520 7472 6565 2070 726f  a parse tree pro
+00018a80: 6475 6365 6420 6279 2052 6f73 6574 7461  duced by Rosetta
+00018a90: 4d52 5061 7273 6572 2363 6f6f 7264 696e  MRParser#coordin
+00018aa0: 6174 655f 7265 7374 7261 696e 7473 2e0a  ate_restraints..
+00018ab0: 2020 2020 6465 6620 656e 7465 7243 6f6f      def enterCoo
+00018ac0: 7264 696e 6174 655f 7265 7374 7261 696e  rdinate_restrain
+00018ad0: 7473 2873 656c 662c 2063 7478 3a20 526f  ts(self, ctx: Ro
+00018ae0: 7365 7474 614d 5250 6172 7365 722e 436f  settaMRParser.Co
+00018af0: 6f72 6469 6e61 7465 5f72 6573 7472 6169  ordinate_restrai
+00018b00: 6e74 7343 6f6e 7465 7874 293a 2020 2320  ntsContext):  # 
+00018b10: 7079 6c69 6e74 3a20 6469 7361 626c 653d  pylint: disable=
+00018b20: 756e 7573 6564 2d61 7267 756d 656e 740a  unused-argument.
+00018b30: 2020 2020 2020 2020 7365 6c66 2e5f 5f63          self.__c
+00018b40: 7572 5f73 7562 7479 7065 203d 2027 6765  ur_subtype = 'ge
+00018b50: 6f27 0a0a 2020 2020 2320 4578 6974 2061  o'..    # Exit a
+00018b60: 2070 6172 7365 2074 7265 6520 7072 6f64   parse tree prod
+00018b70: 7563 6564 2062 7920 526f 7365 7474 614d  uced by RosettaM
+00018b80: 5250 6172 7365 7223 636f 6f72 6469 6e61  RParser#coordina
+00018b90: 7465 5f72 6573 7472 6169 6e74 732e 0a20  te_restraints.. 
+00018ba0: 2020 2064 6566 2065 7869 7443 6f6f 7264     def exitCoord
+00018bb0: 696e 6174 655f 7265 7374 7261 696e 7473  inate_restraints
+00018bc0: 2873 656c 662c 2063 7478 3a20 526f 7365  (self, ctx: Rose
+00018bd0: 7474 614d 5250 6172 7365 722e 436f 6f72  ttaMRParser.Coor
+00018be0: 6469 6e61 7465 5f72 6573 7472 6169 6e74  dinate_restraint
+00018bf0: 7343 6f6e 7465 7874 293a 2020 2320 7079  sContext):  # py
+00018c00: 6c69 6e74 3a20 6469 7361 626c 653d 756e  lint: disable=un
+00018c10: 7573 6564 2d61 7267 756d 656e 740a 2020  used-argument.  
+00018c20: 2020 2020 2020 7061 7373 0a0a 2020 2020        pass..    
+00018c30: 2320 456e 7465 7220 6120 7061 7273 6520  # Enter a parse 
+00018c40: 7472 6565 2070 726f 6475 6365 6420 6279  tree produced by
+00018c50: 2052 6f73 6574 7461 4d52 5061 7273 6572   RosettaMRParser
+00018c60: 2363 6f6f 7264 696e 6174 655f 7265 7374  #coordinate_rest
+00018c70: 7261 696e 742e 0a20 2020 2064 6566 2065  raint..    def e
+00018c80: 6e74 6572 436f 6f72 6469 6e61 7465 5f72  nterCoordinate_r
+00018c90: 6573 7472 6169 6e74 2873 656c 662c 2063  estraint(self, c
+00018ca0: 7478 3a20 526f 7365 7474 614d 5250 6172  tx: RosettaMRPar
+00018cb0: 7365 722e 436f 6f72 6469 6e61 7465 5f72  ser.Coordinate_r
+00018cc0: 6573 7472 6169 6e74 436f 6e74 6578 7429  estraintContext)
+00018cd0: 3a20 2023 2070 796c 696e 743a 2064 6973  :  # pylint: dis
+00018ce0: 6162 6c65 3d75 6e75 7365 642d 6172 6775  able=unused-argu
+00018cf0: 6d65 6e74 0a20 2020 2020 2020 2073 656c  ment.        sel
+00018d00: 662e 6765 6f52 6573 7472 6169 6e74 7320  f.geoRestraints 
+00018d10: 2b3d 2031 0a0a 2020 2020 2020 2020 7365  += 1..        se
+00018d20: 6c66 2e73 7461 636b 4675 6e63 732e 636c  lf.stackFuncs.cl
+00018d30: 6561 7228 290a 2020 2020 2020 2020 7365  ear().        se
+00018d40: 6c66 2e61 746f 6d53 656c 6563 7469 6f6e  lf.atomSelection
+00018d50: 5365 742e 636c 6561 7228 290a 0a20 2020  Set.clear()..   
+00018d60: 2023 2045 7869 7420 6120 7061 7273 6520   # Exit a parse 
+00018d70: 7472 6565 2070 726f 6475 6365 6420 6279  tree produced by
+00018d80: 2052 6f73 6574 7461 4d52 5061 7273 6572   RosettaMRParser
+00018d90: 2363 6f6f 7264 696e 6174 655f 7265 7374  #coordinate_rest
+00018da0: 7261 696e 742e 0a20 2020 2064 6566 2065  raint..    def e
+00018db0: 7869 7443 6f6f 7264 696e 6174 655f 7265  xitCoordinate_re
+00018dc0: 7374 7261 696e 7428 7365 6c66 2c20 6374  straint(self, ct
+00018dd0: 783a 2052 6f73 6574 7461 4d52 5061 7273  x: RosettaMRPars
+00018de0: 6572 2e43 6f6f 7264 696e 6174 655f 7265  er.Coordinate_re
+00018df0: 7374 7261 696e 7443 6f6e 7465 7874 293a  straintContext):
+00018e00: 0a0a 2020 2020 2020 2020 7472 793a 0a0a  ..        try:..
+00018e10: 2020 2020 2020 2020 2020 2020 6174 6f6d              atom
+00018e20: 4964 3120 3d20 7374 7228 6374 782e 5369  Id1 = str(ctx.Si
+00018e30: 6d70 6c65 5f6e 616d 6528 3029 292e 7570  mple_name(0)).up
+00018e40: 7065 7228 290a 2020 2020 2020 2020 2020  per().          
+00018e50: 2020 5f73 6571 4964 3120 3d20 7374 7228    _seqId1 = str(
+00018e60: 6374 782e 5369 6d70 6c65 5f6e 616d 6528  ctx.Simple_name(
+00018e70: 3129 292e 7570 7065 7228 290a 2020 2020  1)).upper().    
+00018e80: 2020 2020 2020 2020 6174 6f6d 4964 3220          atomId2 
+00018e90: 3d20 7374 7228 6374 782e 5369 6d70 6c65  = str(ctx.Simple
+00018ea0: 5f6e 616d 6528 3229 292e 7570 7065 7228  _name(2)).upper(
+00018eb0: 290a 2020 2020 2020 2020 2020 2020 5f73  ).            _s
+00018ec0: 6571 4964 3220 3d20 7374 7228 6374 782e  eqId2 = str(ctx.
+00018ed0: 5369 6d70 6c65 5f6e 616d 6528 3329 292e  Simple_name(3)).
+00018ee0: 7570 7065 7228 290a 0a20 2020 2020 2020  upper()..       
+00018ef0: 2020 2020 2069 6620 6c65 6e28 7365 6c66       if len(self
+00018f00: 2e6e 756d 6265 7253 656c 6563 7469 6f6e  .numberSelection
+00018f10: 2920 3d3d 2030 206f 7220 4e6f 6e65 2069  ) == 0 or None i
+00018f20: 6e20 7365 6c66 2e6e 756d 6265 7253 656c  n self.numberSel
+00018f30: 6563 7469 6f6e 3a0a 2020 2020 2020 2020  ection:.        
+00018f40: 2020 2020 2020 2020 7265 7475 726e 0a0a          return..
+00018f50: 2020 2020 2020 2020 2020 2020 6361 7274              cart
+00018f60: 5820 3d20 7365 6c66 2e6e 756d 6265 7253  X = self.numberS
+00018f70: 656c 6563 7469 6f6e 5b30 5d0a 2020 2020  election[0].    
+00018f80: 2020 2020 2020 2020 6361 7274 5920 3d20          cartY = 
+00018f90: 7365 6c66 2e6e 756d 6265 7253 656c 6563  self.numberSelec
+00018fa0: 7469 6f6e 5b31 5d0a 2020 2020 2020 2020  tion[1].        
+00018fb0: 2020 2020 6361 7274 5a20 3d20 7365 6c66      cartZ = self
+00018fc0: 2e6e 756d 6265 7253 656c 6563 7469 6f6e  .numberSelection
+00018fd0: 5b32 5d0a 0a20 2020 2020 2020 2020 2020  [2]..           
+00018fe0: 2069 6620 5f73 6571 4964 312e 6973 6465   if _seqId1.isde
+00018ff0: 6369 6d61 6c28 293a 0a20 2020 2020 2020  cimal():.       
+00019000: 2020 2020 2020 2020 2073 6571 4964 3120           seqId1 
+00019010: 3d20 696e 7428 5f73 6571 4964 3129 0a20  = int(_seqId1). 
+00019020: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00019030: 6978 6564 4368 6169 6e49 6431 203d 204e  ixedChainId1 = N
+00019040: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
+00019050: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00019060: 2020 2020 2020 6720 3d20 7365 6c66 2e63        g = self.c
+00019070: 6f6e 6361 745f 7265 736e 756d 5f63 6861  oncat_resnum_cha
+00019080: 696e 5f70 6174 2e73 6561 7263 6828 5f73  in_pat.search(_s
+00019090: 6571 4964 3129 2e67 726f 7570 7328 290a  eqId1).groups().
+000190a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000190b0: 7365 7149 6431 203d 2069 6e74 2867 5b30  seqId1 = int(g[0
+000190c0: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
+000190d0: 2020 2066 6978 6564 4368 6169 6e49 6431     fixedChainId1
+000190e0: 203d 2067 5b31 5d0a 0a20 2020 2020 2020   = g[1]..       
+000190f0: 2020 2020 2069 6620 5f73 6571 4964 322e       if _seqId2.
+00019100: 6973 6465 6369 6d61 6c28 293a 0a20 2020  isdecimal():.   
+00019110: 2020 2020 2020 2020 2020 2020 2073 6571               seq
+00019120: 4964 3220 3d20 696e 7428 5f73 6571 4964  Id2 = int(_seqId
+00019130: 3229 0a20 2020 2020 2020 2020 2020 2020  2).             
+00019140: 2020 2066 6978 6564 4368 6169 6e49 6432     fixedChainId2
+00019150: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
+00019160: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00019170: 2020 2020 2020 2020 2020 6720 3d20 7365            g = se
+00019180: 6c66 2e63 6f6e 6361 745f 7265 736e 756d  lf.concat_resnum
+00019190: 5f63 6861 696e 5f70 6174 2e73 6561 7263  _chain_pat.searc
+000191a0: 6828 5f73 6571 4964 3229 2e67 726f 7570  h(_seqId2).group
+000191b0: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
+000191c0: 2020 2020 7365 7149 6432 203d 2069 6e74      seqId2 = int
+000191d0: 2867 5b30 5d29 0a20 2020 2020 2020 2020  (g[0]).         
+000191e0: 2020 2020 2020 2066 6978 6564 4368 6169         fixedChai
+000191f0: 6e49 6432 203d 2067 5b31 5d0a 0a20 2020  nId2 = g[1]..   
+00019200: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+00019210: 7365 6c66 2e5f 5f68 6173 506f 6c79 5365  self.__hasPolySe
+00019220: 713a 0a20 2020 2020 2020 2020 2020 2020  q:.             
+00019230: 2020 2072 6574 7572 6e0a 0a20 2020 2020     return..     
+00019240: 2020 2020 2020 2073 656c 662e 5f5f 7265         self.__re
+00019250: 7472 6965 7665 4c6f 6361 6c53 6571 5363  trieveLocalSeqSc
+00019260: 6865 6d65 2829 0a0a 2020 2020 2020 2020  heme()..        
+00019270: 2020 2020 6368 6169 6e41 7373 6967 6e31      chainAssign1
+00019280: 203d 2073 656c 662e 6173 7369 676e 436f   = self.assignCo
+00019290: 6f72 6450 6f6c 796d 6572 5365 7175 656e  ordPolymerSequen
+000192a0: 6365 2873 6571 4964 312c 2061 746f 6d49  ce(seqId1, atomI
+000192b0: 6431 2c20 6669 7865 6443 6861 696e 4964  d1, fixedChainId
+000192c0: 3129 0a20 2020 2020 2020 2020 2020 2063  1).            c
+000192d0: 6861 696e 4173 7369 676e 3220 3d20 7365  hainAssign2 = se
+000192e0: 6c66 2e61 7373 6967 6e43 6f6f 7264 506f  lf.assignCoordPo
+000192f0: 6c79 6d65 7253 6571 7565 6e63 6528 7365  lymerSequence(se
+00019300: 7149 6432 2c20 6174 6f6d 4964 322c 2066  qId2, atomId2, f
+00019310: 6978 6564 4368 6169 6e49 6432 290a 0a20  ixedChainId2).. 
+00019320: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+00019330: 6e28 6368 6169 6e41 7373 6967 6e31 2920  n(chainAssign1) 
+00019340: 3d3d 2030 206f 7220 6c65 6e28 6368 6169  == 0 or len(chai
+00019350: 6e41 7373 6967 6e32 2920 3d3d 2030 3a0a  nAssign2) == 0:.
+00019360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019370: 7265 7475 726e 0a0a 2020 2020 2020 2020  return..        
+00019380: 2020 2020 7365 6c66 2e73 656c 6563 7443      self.selectC
+00019390: 6f6f 7264 4174 6f6d 7328 6368 6169 6e41  oordAtoms(chainA
+000193a0: 7373 6967 6e31 2c20 7365 7149 6431 2c20  ssign1, seqId1, 
+000193b0: 6174 6f6d 4964 3129 0a20 2020 2020 2020  atomId1).       
+000193c0: 2020 2020 2073 656c 662e 7365 6c65 6374       self.select
+000193d0: 436f 6f72 6441 746f 6d73 2863 6861 696e  CoordAtoms(chain
+000193e0: 4173 7369 676e 322c 2073 6571 4964 322c  Assign2, seqId2,
+000193f0: 2061 746f 6d49 6432 2c20 4661 6c73 652c   atomId2, False,
+00019400: 2027 6120 636f 6f72 6469 6e61 7465 2729   'a coordinate')
+00019410: 2020 2320 7265 6641 746f 6d0a 0a20 2020    # refAtom..   
+00019420: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
+00019430: 7365 6c66 2e61 746f 6d53 656c 6563 7469  self.atomSelecti
+00019440: 6f6e 5365 7429 203c 2032 3a0a 2020 2020  onSet) < 2:.    
+00019450: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00019460: 726e 0a0a 2020 2020 2020 2020 2020 2020  rn..            
+00019470: 7365 6c66 2e5f 5f61 6c6c 6f77 5a65 726f  self.__allowZero
+00019480: 5570 7065 724c 696d 6974 203d 2046 616c  UpperLimit = Fal
+00019490: 7365 0a20 2020 2020 2020 2020 2020 2069  se.            i
+000194a0: 6620 7365 6c66 2e5f 5f72 6561 736f 6e73  f self.__reasons
+000194b0: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
+000194c0: 2027 6d6f 6465 6c5f 6368 6169 6e5f 6964   'model_chain_id
+000194d0: 5f65 7874 2720 696e 2073 656c 662e 5f5f  _ext' in self.__
+000194e0: 7265 6173 6f6e 735c 0a20 2020 2020 2020  reasons\.       
+000194f0: 2020 2020 2020 2020 616e 6420 6c65 6e28          and len(
+00019500: 7365 6c66 2e61 746f 6d53 656c 6563 7469  self.atomSelecti
+00019510: 6f6e 5365 745b 305d 2920 3e20 305c 0a20  onSet[0]) > 0\. 
+00019520: 2020 2020 2020 2020 2020 2020 2020 616e                an
+00019530: 6420 6c65 6e28 7365 6c66 2e61 746f 6d53  d len(self.atomS
+00019540: 656c 6563 7469 6f6e 5365 745b 305d 2920  electionSet[0]) 
+00019550: 3d3d 206c 656e 2873 656c 662e 6174 6f6d  == len(self.atom
+00019560: 5365 6c65 6374 696f 6e53 6574 5b31 5d29  SelectionSet[1])
+00019570: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00019580: 2020 6368 6169 6e5f 6964 5f31 203d 2073    chain_id_1 = s
+00019590: 656c 662e 6174 6f6d 5365 6c65 6374 696f  elf.atomSelectio
+000195a0: 6e53 6574 5b30 5d5b 305d 5b27 6368 6169  nSet[0][0]['chai
+000195b0: 6e5f 6964 275d 0a20 2020 2020 2020 2020  n_id'].         
+000195c0: 2020 2020 2020 2073 6571 5f69 645f 3120         seq_id_1 
+000195d0: 3d20 7365 6c66 2e61 746f 6d53 656c 6563  = self.atomSelec
+000195e0: 7469 6f6e 5365 745b 305d 5b30 5d5b 2773  tionSet[0][0]['s
+000195f0: 6571 5f69 6427 5d0a 2020 2020 2020 2020  eq_id'].        
+00019600: 2020 2020 2020 2020 6174 6f6d 5f69 645f          atom_id_
+00019610: 3120 3d20 7365 6c66 2e61 746f 6d53 656c  1 = self.atomSel
+00019620: 6563 7469 6f6e 5365 745b 305d 5b30 5d5b  ectionSet[0][0][
+00019630: 2761 746f 6d5f 6964 275d 0a0a 2020 2020  'atom_id']..    
+00019640: 2020 2020 2020 2020 2020 2020 6368 6169              chai
+00019650: 6e5f 6964 5f32 203d 2073 656c 662e 6174  n_id_2 = self.at
+00019660: 6f6d 5365 6c65 6374 696f 6e53 6574 5b31  omSelectionSet[1
+00019670: 5d5b 305d 5b27 6368 6169 6e5f 6964 275d  ][0]['chain_id']
+00019680: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019690: 2073 6571 5f69 645f 3220 3d20 7365 6c66   seq_id_2 = self
+000196a0: 2e61 746f 6d53 656c 6563 7469 6f6e 5365  .atomSelectionSe
+000196b0: 745b 315d 5b30 5d5b 2773 6571 5f69 6427  t[1][0]['seq_id'
+000196c0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+000196d0: 2020 6174 6f6d 5f69 645f 3220 3d20 7365    atom_id_2 = se
+000196e0: 6c66 2e61 746f 6d53 656c 6563 7469 6f6e  lf.atomSelection
+000196f0: 5365 745b 315d 5b30 5d5b 2761 746f 6d5f  Set[1][0]['atom_
+00019700: 6964 275d 0a0a 2020 2020 2020 2020 2020  id']..          
+00019710: 2020 2020 2020 6966 2063 6861 696e 5f69        if chain_i
+00019720: 645f 3120 213d 2063 6861 696e 5f69 645f  d_1 != chain_id_
+00019730: 3220 616e 6420 7365 715f 6964 5f31 203d  2 and seq_id_1 =
+00019740: 3d20 7365 715f 6964 5f32 2061 6e64 2061  = seq_id_2 and a
+00019750: 746f 6d5f 6964 5f31 203d 3d20 6174 6f6d  tom_id_1 == atom
+00019760: 5f69 645f 325c 0a20 2020 2020 2020 2020  _id_2\.         
+00019770: 2020 2020 2020 2020 2020 616e 6420 2828            and ((
+00019780: 6368 6169 6e5f 6964 5f31 2069 6e20 7365  chain_id_1 in se
+00019790: 6c66 2e5f 5f72 6561 736f 6e73 5b27 6d6f  lf.__reasons['mo
+000197a0: 6465 6c5f 6368 6169 6e5f 6964 5f65 7874  del_chain_id_ext
+000197b0: 275d 2061 6e64 2063 6861 696e 5f69 645f  '] and chain_id_
+000197c0: 3220 696e 2073 656c 662e 5f5f 7265 6173  2 in self.__reas
+000197d0: 6f6e 735b 276d 6f64 656c 5f63 6861 696e  ons['model_chain
+000197e0: 5f69 645f 6578 7427 5d5b 6368 6169 6e5f  _id_ext'][chain_
+000197f0: 6964 5f31 5d29 0a20 2020 2020 2020 2020  id_1]).         
+00019800: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+00019810: 7220 2863 6861 696e 5f69 645f 3220 696e  r (chain_id_2 in
+00019820: 2073 656c 662e 5f5f 7265 6173 6f6e 735b   self.__reasons[
+00019830: 276d 6f64 656c 5f63 6861 696e 5f69 645f  'model_chain_id_
+00019840: 6578 7427 5d20 616e 6420 6368 6169 6e5f  ext'] and chain_
+00019850: 6964 5f31 2069 6e20 7365 6c66 2e5f 5f72  id_1 in self.__r
+00019860: 6561 736f 6e73 5b27 6d6f 6465 6c5f 6368  easons['model_ch
+00019870: 6169 6e5f 6964 5f65 7874 275d 5b63 6861  ain_id_ext'][cha
+00019880: 696e 5f69 645f 325d 2929 3a0a 2020 2020  in_id_2])):.    
+00019890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000198a0: 7365 6c66 2e5f 5f61 6c6c 6f77 5a65 726f  self.__allowZero
+000198b0: 5570 7065 724c 696d 6974 203d 2054 7275  UpperLimit = Tru
+000198c0: 650a 2020 2020 2020 2020 2020 2020 7365  e.            se
+000198d0: 6c66 2e5f 5f61 6c6c 6f77 5a65 726f 5570  lf.__allowZeroUp
+000198e0: 7065 724c 696d 6974 207c 3d20 6861 7349  perLimit |= hasI
+000198f0: 6e74 6572 4368 6169 6e52 6573 7472 6169  nterChainRestrai
+00019900: 6e74 2873 656c 662e 6174 6f6d 5365 6c65  nt(self.atomSele
+00019910: 6374 696f 6e53 6574 290a 0a20 2020 2020  ctionSet)..     
+00019920: 2020 2020 2020 2064 7374 4675 6e63 203d         dstFunc =
+00019930: 2073 656c 662e 7661 6c69 6461 7465 4469   self.validateDi
+00019940: 7374 616e 6365 5261 6e67 6528 312e 3029  stanceRange(1.0)
+00019950: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00019960: 2064 7374 4675 6e63 2069 7320 4e6f 6e65   dstFunc is None
+00019970: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00019980: 2020 7265 7475 726e 0a0a 2020 2020 2020    return..      
+00019990: 2020 2020 2020 6966 2073 656c 662e 5f5f        if self.__
+000199a0: 6372 6561 7465 5366 4469 6374 3a0a 2020  createSfDict:.  
+000199b0: 2020 2020 2020 2020 2020 2020 2020 7366                sf
+000199c0: 203d 2073 656c 662e 5f5f 6765 7453 6628   = self.__getSf(
+000199d0: 2768 6172 6d6f 6e69 6320 636f 6f72 6469  'harmonic coordi
+000199e0: 6e61 7465 2072 6573 7472 6169 6e74 2c20  nate restraint, 
+000199f0: 524f 5345 5454 4120 436f 6f72 6469 6e61  ROSETTA Coordina
+00019a00: 7465 436f 6e73 7472 6169 6e74 2729 0a20  teConstraint'). 
+00019a10: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00019a20: 665b 2769 6427 5d20 2b3d 2031 0a20 2020  f['id'] += 1.   
+00019a30: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00019a40: 6c65 6e28 7366 5b27 6c6f 6f70 275d 5b27  len(sf['loop']['
+00019a50: 7461 6773 275d 2920 3d3d 2030 3a0a 2020  tags']) == 0:.  
+00019a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019a70: 2020 7366 5b27 6c6f 6f70 275d 5b27 7461    sf['loop']['ta
+00019a80: 6773 275d 203d 205b 2769 6e64 6578 5f69  gs'] = ['index_i
+00019a90: 6427 2c20 2769 6427 2c0a 2020 2020 2020  d', 'id',.      
+00019aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019ac0: 2020 2020 2761 7574 685f 6173 796d 5f69      'auth_asym_i
+00019ad0: 6427 2c20 2761 7574 685f 7365 715f 6964  d', 'auth_seq_id
+00019ae0: 272c 2027 6175 7468 5f63 6f6d 705f 6964  ', 'auth_comp_id
+00019af0: 272c 2027 6175 7468 5f61 746f 6d5f 6964  ', 'auth_atom_id
+00019b00: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+00019b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019b20: 2020 2020 2020 2020 2020 2020 2027 7265               're
+00019b30: 665f 6175 7468 5f61 7379 6d5f 6964 272c  f_auth_asym_id',
+00019b40: 2027 7265 665f 6175 7468 5f73 6571 5f69   'ref_auth_seq_i
+00019b50: 6427 2c20 2772 6566 5f61 7574 685f 636f  d', 'ref_auth_co
+00019b60: 6d70 5f69 6427 2c20 2772 6566 5f61 7574  mp_id', 'ref_aut
+00019b70: 685f 6174 6f6d 5f69 6427 2c0a 2020 2020  h_atom_id',.    
+00019b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019ba0: 2020 2020 2020 2763 6172 745f 7827 2c20        'cart_x', 
+00019bb0: 2763 6172 745f 7927 2c20 2763 6172 745f  'cart_y', 'cart_
+00019bc0: 7a27 2c0a 2020 2020 2020 2020 2020 2020  z',.            
 00019bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019be0: 2020 2020 2020 2772 6566 5f61 7574 685f        'ref_auth_
-00019bf0: 6173 796d 5f69 6427 2c20 2772 6566 5f61  asym_id', 'ref_a
-00019c00: 7574 685f 7365 715f 6964 272c 2027 7265  uth_seq_id', 're
-00019c10: 665f 6175 7468 5f63 6f6d 705f 6964 272c  f_auth_comp_id',
-00019c20: 2027 7265 665f 6175 7468 5f61 746f 6d5f   'ref_auth_atom_
-00019c30: 6964 272c 0a20 2020 2020 2020 2020 2020  id',.           
-00019c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019c50: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00019c60: 6361 7274 5f78 272c 2027 6361 7274 5f79  cart_x', 'cart_y
-00019c70: 272c 2027 6361 7274 5f7a 272c 0a20 2020  ', 'cart_z',.   
-00019c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019ca0: 2020 2020 2020 2027 6c69 7374 5f69 6427         'list_id'
-00019cb0: 2c20 2765 6e74 7279 5f69 6427 5d0a 0a20  , 'entry_id'].. 
-00019cc0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00019cd0: 6c66 2e5f 5f63 7572 5f6e 6573 7420 6973  lf.__cur_nest is
-00019ce0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-00019cf0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00019d00: 6c66 2e5f 5f64 6562 7567 3a0a 2020 2020  lf.__debug:.    
-00019d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019d20: 7072 696e 7428 6622 4e45 5354 4544 3a20  print(f"NESTED: 
-00019d30: 7b73 656c 662e 5f5f 6375 725f 6e65 7374  {self.__cur_nest
-00019d40: 7d22 290a 0a20 2020 2020 2020 2020 2020  }")..           
-00019d50: 2068 6173 5f69 6e74 7261 5f63 6861 696e   has_intra_chain
-00019d60: 2c20 7265 705f 6368 6169 6e5f 6964 5f73  , rep_chain_id_s
-00019d70: 6574 203d 2068 6173 496e 7472 6143 6861  et = hasIntraCha
-00019d80: 696e 5265 7374 7261 696e 7428 7365 6c66  inRestraint(self
-00019d90: 2e61 746f 6d53 656c 6563 7469 6f6e 5365  .atomSelectionSe
-00019da0: 7429 0a0a 2020 2020 2020 2020 2020 2020  t)..            
-00019db0: 666f 7220 6174 6f6d 312c 2061 746f 6d32  for atom1, atom2
-00019dc0: 2069 6e20 6974 6572 746f 6f6c 732e 7072   in itertools.pr
-00019dd0: 6f64 7563 7428 7365 6c66 2e61 746f 6d53  oduct(self.atomS
-00019de0: 656c 6563 7469 6f6e 5365 745b 305d 2c0a  electionSet[0],.
-00019df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019e20: 2020 7365 6c66 2e61 746f 6d53 656c 6563    self.atomSelec
-00019e30: 7469 6f6e 5365 745b 315d 293a 0a20 2020  tionSet[1]):.   
-00019e40: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00019e50: 6973 4964 656e 7469 6361 6c52 6573 7472  isIdenticalRestr
-00019e60: 6169 6e74 285b 6174 6f6d 312c 2061 746f  aint([atom1, ato
-00019e70: 6d32 5d29 3a0a 2020 2020 2020 2020 2020  m2]):.          
-00019e80: 2020 2020 2020 2020 2020 636f 6e74 696e            contin
-00019e90: 7565 0a20 2020 2020 2020 2020 2020 2020  ue.             
-00019ea0: 2020 2069 6620 6861 735f 696e 7472 615f     if has_intra_
-00019eb0: 6368 6169 6e20 616e 6420 2861 746f 6d31  chain and (atom1
-00019ec0: 5b27 6368 6169 6e5f 6964 275d 2021 3d20  ['chain_id'] != 
-00019ed0: 6174 6f6d 325b 2763 6861 696e 5f69 6427  atom2['chain_id'
-00019ee0: 5d20 6f72 2061 746f 6d31 5b27 6368 6169  ] or atom1['chai
-00019ef0: 6e5f 6964 275d 206e 6f74 2069 6e20 7265  n_id'] not in re
-00019f00: 705f 6368 6169 6e5f 6964 5f73 6574 293a  p_chain_id_set):
-00019f10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019f20: 2020 2020 2063 6f6e 7469 6e75 650a 2020       continue.  
-00019f30: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00019f40: 2073 656c 662e 5f5f 6465 6275 673a 0a20   self.__debug:. 
-00019f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019f60: 2020 2070 7269 6e74 2866 2273 7562 7479     print(f"subty
-00019f70: 7065 3d7b 7365 6c66 2e5f 5f63 7572 5f73  pe={self.__cur_s
-00019f80: 7562 7479 7065 7d20 2843 6f6f 7264 696e  ubtype} (Coordin
-00019f90: 6174 6529 2069 643d 7b73 656c 662e 6765  ate) id={self.ge
-00019fa0: 6f52 6573 7472 6169 6e74 737d 2022 0a20  oRestraints} ". 
-00019fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019fc0: 2020 2020 2020 2020 2066 2261 746f 6d3d           f"atom=
-00019fd0: 7b61 746f 6d31 7d20 7265 6641 746f 6d3d  {atom1} refAtom=
-00019fe0: 7b61 746f 6d32 7d20 636f 6f72 643d 287b  {atom2} coord=({
-00019ff0: 6361 7274 587d 2c20 7b63 6172 7459 7d2c  cartX}, {cartY},
-0001a000: 207b 6361 7274 5a7d 2920 7b64 7374 4675   {cartZ}) {dstFu
-0001a010: 6e63 7d22 290a 2020 2020 2020 2020 2020  nc}").          
-0001a020: 2020 2020 2020 6966 2073 656c 662e 5f5f        if self.__
-0001a030: 6372 6561 7465 5366 4469 6374 2061 6e64  createSfDict and
-0001a040: 2073 6620 6973 206e 6f74 204e 6f6e 653a   sf is not None:
-0001a050: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a060: 2020 2020 2073 665b 2769 6e64 6578 5f69       sf['index_i
-0001a070: 6427 5d20 2b3d 2031 0a20 2020 2020 2020  d'] += 1.       
-0001a080: 2020 2020 2020 2020 2020 2020 2073 665b               sf[
-0001a090: 276c 6f6f 7027 5d5b 2764 6174 6127 5d2e  'loop']['data'].
-0001a0a0: 6170 7065 6e64 285b 7366 5b27 696e 6465  append([sf['inde
-0001a0b0: 785f 6964 275d 2c20 7366 5b27 6964 275d  x_id'], sf['id']
-0001a0c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001a0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a0f0: 2061 746f 6d31 5b27 6368 6169 6e5f 6964   atom1['chain_id
-0001a100: 275d 2c20 6174 6f6d 315b 2773 6571 5f69  '], atom1['seq_i
-0001a110: 6427 5d2c 2061 746f 6d31 5b27 636f 6d70  d'], atom1['comp
-0001a120: 5f69 6427 5d2c 2061 746f 6d31 5b27 6174  _id'], atom1['at
-0001a130: 6f6d 5f69 6427 5d2c 0a20 2020 2020 2020  om_id'],.       
+00019be0: 2020 2020 2020 2020 2020 2020 2020 276c                'l
+00019bf0: 6973 745f 6964 272c 2027 656e 7472 795f  ist_id', 'entry_
+00019c00: 6964 275d 0a0a 2020 2020 2020 2020 2020  id']..          
+00019c10: 2020 6966 2073 656c 662e 5f5f 6375 725f    if self.__cur_
+00019c20: 6e65 7374 2069 7320 6e6f 7420 4e6f 6e65  nest is not None
+00019c30: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00019c40: 2020 6966 2073 656c 662e 5f5f 6465 6275    if self.__debu
+00019c50: 673a 0a20 2020 2020 2020 2020 2020 2020  g:.             
+00019c60: 2020 2020 2020 2070 7269 6e74 2866 224e         print(f"N
+00019c70: 4553 5445 443a 207b 7365 6c66 2e5f 5f63  ESTED: {self.__c
+00019c80: 7572 5f6e 6573 747d 2229 0a0a 2020 2020  ur_nest}")..    
+00019c90: 2020 2020 2020 2020 6861 735f 696e 7472          has_intr
+00019ca0: 615f 6368 6169 6e2c 2072 6570 5f63 6861  a_chain, rep_cha
+00019cb0: 696e 5f69 645f 7365 7420 3d20 6861 7349  in_id_set = hasI
+00019cc0: 6e74 7261 4368 6169 6e52 6573 7472 6169  ntraChainRestrai
+00019cd0: 6e74 2873 656c 662e 6174 6f6d 5365 6c65  nt(self.atomSele
+00019ce0: 6374 696f 6e53 6574 290a 0a20 2020 2020  ctionSet)..     
+00019cf0: 2020 2020 2020 2066 6f72 2061 746f 6d31         for atom1
+00019d00: 2c20 6174 6f6d 3220 696e 2069 7465 7274  , atom2 in itert
+00019d10: 6f6f 6c73 2e70 726f 6475 6374 2873 656c  ools.product(sel
+00019d20: 662e 6174 6f6d 5365 6c65 6374 696f 6e53  f.atomSelectionS
+00019d30: 6574 5b30 5d2c 0a20 2020 2020 2020 2020  et[0],.         
+00019d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019d60: 2020 2020 2020 2020 2073 656c 662e 6174           self.at
+00019d70: 6f6d 5365 6c65 6374 696f 6e53 6574 5b31  omSelectionSet[1
+00019d80: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
+00019d90: 2020 2020 6966 2069 7349 6465 6e74 6963      if isIdentic
+00019da0: 616c 5265 7374 7261 696e 7428 5b61 746f  alRestraint([ato
+00019db0: 6d31 2c20 6174 6f6d 325d 293a 0a20 2020  m1, atom2]):.   
+00019dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019dd0: 2063 6f6e 7469 6e75 650a 2020 2020 2020   continue.      
+00019de0: 2020 2020 2020 2020 2020 6966 2068 6173            if has
+00019df0: 5f69 6e74 7261 5f63 6861 696e 2061 6e64  _intra_chain and
+00019e00: 2028 6174 6f6d 315b 2763 6861 696e 5f69   (atom1['chain_i
+00019e10: 6427 5d20 213d 2061 746f 6d32 5b27 6368  d'] != atom2['ch
+00019e20: 6169 6e5f 6964 275d 206f 7220 6174 6f6d  ain_id'] or atom
+00019e30: 315b 2763 6861 696e 5f69 6427 5d20 6e6f  1['chain_id'] no
+00019e40: 7420 696e 2072 6570 5f63 6861 696e 5f69  t in rep_chain_i
+00019e50: 645f 7365 7429 3a0a 2020 2020 2020 2020  d_set):.        
+00019e60: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
+00019e70: 696e 7565 0a20 2020 2020 2020 2020 2020  inue.           
+00019e80: 2020 2020 2069 6620 7365 6c66 2e5f 5f64       if self.__d
+00019e90: 6562 7567 3a0a 2020 2020 2020 2020 2020  ebug:.          
+00019ea0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00019eb0: 6622 7375 6274 7970 653d 7b73 656c 662e  f"subtype={self.
+00019ec0: 5f5f 6375 725f 7375 6274 7970 657d 2028  __cur_subtype} (
+00019ed0: 436f 6f72 6469 6e61 7465 2920 6964 3d7b  Coordinate) id={
+00019ee0: 7365 6c66 2e67 656f 5265 7374 7261 696e  self.geoRestrain
+00019ef0: 7473 7d20 220a 2020 2020 2020 2020 2020  ts} ".          
+00019f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019f10: 6622 6174 6f6d 3d7b 6174 6f6d 317d 2072  f"atom={atom1} r
+00019f20: 6566 4174 6f6d 3d7b 6174 6f6d 327d 2063  efAtom={atom2} c
+00019f30: 6f6f 7264 3d28 7b63 6172 7458 7d2c 207b  oord=({cartX}, {
+00019f40: 6361 7274 597d 2c20 7b63 6172 745a 7d29  cartY}, {cartZ})
+00019f50: 207b 6473 7446 756e 637d 2229 0a20 2020   {dstFunc}").   
+00019f60: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00019f70: 7365 6c66 2e5f 5f63 7265 6174 6553 6644  self.__createSfD
+00019f80: 6963 7420 616e 6420 7366 2069 7320 6e6f  ict and sf is no
+00019f90: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+00019fa0: 2020 2020 2020 2020 2020 2020 7366 5b27              sf['
+00019fb0: 696e 6465 785f 6964 275d 202b 3d20 310a  index_id'] += 1.
+00019fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019fd0: 2020 2020 7366 5b27 6c6f 6f70 275d 5b27      sf['loop']['
+00019fe0: 6461 7461 275d 2e61 7070 656e 6428 5b73  data'].append([s
+00019ff0: 665b 2769 6e64 6578 5f69 6427 5d2c 2073  f['index_id'], s
+0001a000: 665b 2769 6427 5d2c 0a20 2020 2020 2020  f['id'],.       
+0001a010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a030: 2020 2020 2020 2020 6174 6f6d 315b 2763          atom1['c
+0001a040: 6861 696e 5f69 6427 5d2c 2061 746f 6d31  hain_id'], atom1
+0001a050: 5b27 7365 715f 6964 275d 2c20 6174 6f6d  ['seq_id'], atom
+0001a060: 315b 2763 6f6d 705f 6964 275d 2c20 6174  1['comp_id'], at
+0001a070: 6f6d 315b 2761 746f 6d5f 6964 275d 2c0a  om1['atom_id'],.
+0001a080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a0a0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0001a0b0: 746f 6d32 5b27 6368 6169 6e5f 6964 275d  tom2['chain_id']
+0001a0c0: 2c20 6174 6f6d 325b 2773 6571 5f69 6427  , atom2['seq_id'
+0001a0d0: 5d2c 2061 746f 6d32 5b27 636f 6d70 5f69  ], atom2['comp_i
+0001a0e0: 6427 5d2c 2061 746f 6d32 5b27 6174 6f6d  d'], atom2['atom
+0001a0f0: 5f69 6427 5d2c 0a20 2020 2020 2020 2020  _id'],.         
+0001a100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a120: 2020 2020 2020 6361 7274 582c 2063 6172        cartX, car
+0001a130: 7459 2c20 6361 7274 5a2c 0a20 2020 2020  tY, cartZ,.     
 0001a140: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001a150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a160: 2020 2020 2020 2020 6174 6f6d 325b 2763          atom2['c
-0001a170: 6861 696e 5f69 6427 5d2c 2061 746f 6d32  hain_id'], atom2
-0001a180: 5b27 7365 715f 6964 275d 2c20 6174 6f6d  ['seq_id'], atom
-0001a190: 325b 2763 6f6d 705f 6964 275d 2c20 6174  2['comp_id'], at
-0001a1a0: 6f6d 325b 2761 746f 6d5f 6964 275d 2c0a  om2['atom_id'],.
-0001a1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a1d0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0001a1e0: 6172 7458 2c20 6361 7274 592c 2063 6172  artX, cartY, car
-0001a1f0: 745a 2c0a 2020 2020 2020 2020 2020 2020  tZ,.            
-0001a200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a220: 2020 2073 665b 276c 6973 745f 6964 275d     sf['list_id']
-0001a230: 2c20 7365 6c66 2e5f 5f65 6e74 7279 4964  , self.__entryId
-0001a240: 5d29 0a0a 2020 2020 2020 2020 6578 6365  ])..        exce
-0001a250: 7074 2056 616c 7565 4572 726f 723a 0a20  pt ValueError:. 
-0001a260: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001a270: 6765 6f52 6573 7472 6169 6e74 7320 2d3d  geoRestraints -=
-0001a280: 2031 0a20 2020 2020 2020 2066 696e 616c   1.        final
-0001a290: 6c79 3a0a 2020 2020 2020 2020 2020 2020  ly:.            
-0001a2a0: 7365 6c66 2e6e 756d 6265 7253 656c 6563  self.numberSelec
-0001a2b0: 7469 6f6e 2e63 6c65 6172 2829 0a0a 2020  tion.clear()..  
-0001a2c0: 2020 2320 456e 7465 7220 6120 7061 7273    # Enter a pars
-0001a2d0: 6520 7472 6565 2070 726f 6475 6365 6420  e tree produced 
-0001a2e0: 6279 2052 6f73 6574 7461 4d52 5061 7273  by RosettaMRPars
-0001a2f0: 6572 236c 6f63 616c 5f63 6f6f 7264 696e  er#local_coordin
-0001a300: 6174 655f 7265 7374 7261 696e 7473 2e0a  ate_restraints..
-0001a310: 2020 2020 6465 6620 656e 7465 724c 6f63      def enterLoc
-0001a320: 616c 5f63 6f6f 7264 696e 6174 655f 7265  al_coordinate_re
-0001a330: 7374 7261 696e 7473 2873 656c 662c 2063  straints(self, c
-0001a340: 7478 3a20 526f 7365 7474 614d 5250 6172  tx: RosettaMRPar
-0001a350: 7365 722e 4c6f 6361 6c5f 636f 6f72 6469  ser.Local_coordi
-0001a360: 6e61 7465 5f72 6573 7472 6169 6e74 7343  nate_restraintsC
-0001a370: 6f6e 7465 7874 293a 2020 2320 7079 6c69  ontext):  # pyli
-0001a380: 6e74 3a20 6469 7361 626c 653d 756e 7573  nt: disable=unus
-0001a390: 6564 2d61 7267 756d 656e 740a 2020 2020  ed-argument.    
-0001a3a0: 2020 2020 7365 6c66 2e5f 5f63 7572 5f73      self.__cur_s
-0001a3b0: 7562 7479 7065 203d 2027 6765 6f27 0a0a  ubtype = 'geo'..
-0001a3c0: 2020 2020 2320 4578 6974 2061 2070 6172      # Exit a par
-0001a3d0: 7365 2074 7265 6520 7072 6f64 7563 6564  se tree produced
-0001a3e0: 2062 7920 526f 7365 7474 614d 5250 6172   by RosettaMRPar
-0001a3f0: 7365 7223 6c6f 6361 6c5f 636f 6f72 6469  ser#local_coordi
-0001a400: 6e61 7465 5f72 6573 7472 6169 6e74 732e  nate_restraints.
-0001a410: 0a20 2020 2064 6566 2065 7869 744c 6f63  .    def exitLoc
-0001a420: 616c 5f63 6f6f 7264 696e 6174 655f 7265  al_coordinate_re
-0001a430: 7374 7261 696e 7473 2873 656c 662c 2063  straints(self, c
-0001a440: 7478 3a20 526f 7365 7474 614d 5250 6172  tx: RosettaMRPar
-0001a450: 7365 722e 4c6f 6361 6c5f 636f 6f72 6469  ser.Local_coordi
-0001a460: 6e61 7465 5f72 6573 7472 6169 6e74 7343  nate_restraintsC
-0001a470: 6f6e 7465 7874 293a 2020 2320 7079 6c69  ontext):  # pyli
-0001a480: 6e74 3a20 6469 7361 626c 653d 756e 7573  nt: disable=unus
-0001a490: 6564 2d61 7267 756d 656e 740a 2020 2020  ed-argument.    
-0001a4a0: 2020 2020 7061 7373 0a0a 2020 2020 2320      pass..    # 
-0001a4b0: 456e 7465 7220 6120 7061 7273 6520 7472  Enter a parse tr
-0001a4c0: 6565 2070 726f 6475 6365 6420 6279 2052  ee produced by R
-0001a4d0: 6f73 6574 7461 4d52 5061 7273 6572 236c  osettaMRParser#l
-0001a4e0: 6f63 616c 5f63 6f6f 7264 696e 6174 655f  ocal_coordinate_
-0001a4f0: 7265 7374 7261 696e 742e 0a20 2020 2064  restraint..    d
-0001a500: 6566 2065 6e74 6572 4c6f 6361 6c5f 636f  ef enterLocal_co
-0001a510: 6f72 6469 6e61 7465 5f72 6573 7472 6169  ordinate_restrai
-0001a520: 6e74 2873 656c 662c 2063 7478 3a20 526f  nt(self, ctx: Ro
-0001a530: 7365 7474 614d 5250 6172 7365 722e 4c6f  settaMRParser.Lo
-0001a540: 6361 6c5f 636f 6f72 6469 6e61 7465 5f72  cal_coordinate_r
-0001a550: 6573 7472 6169 6e74 436f 6e74 6578 7429  estraintContext)
-0001a560: 3a20 2023 2070 796c 696e 743a 2064 6973  :  # pylint: dis
-0001a570: 6162 6c65 3d75 6e75 7365 642d 6172 6775  able=unused-argu
-0001a580: 6d65 6e74 0a20 2020 2020 2020 2073 656c  ment.        sel
-0001a590: 662e 6765 6f52 6573 7472 6169 6e74 7320  f.geoRestraints 
-0001a5a0: 2b3d 2031 0a0a 2020 2020 2020 2020 7365  += 1..        se
-0001a5b0: 6c66 2e73 7461 636b 4675 6e63 732e 636c  lf.stackFuncs.cl
-0001a5c0: 6561 7228 290a 2020 2020 2020 2020 7365  ear().        se
-0001a5d0: 6c66 2e61 746f 6d53 656c 6563 7469 6f6e  lf.atomSelection
-0001a5e0: 5365 742e 636c 6561 7228 290a 0a20 2020  Set.clear()..   
-0001a5f0: 2023 2045 7869 7420 6120 7061 7273 6520   # Exit a parse 
-0001a600: 7472 6565 2070 726f 6475 6365 6420 6279  tree produced by
-0001a610: 2052 6f73 6574 7461 4d52 5061 7273 6572   RosettaMRParser
-0001a620: 236c 6f63 616c 5f63 6f6f 7264 696e 6174  #local_coordinat
-0001a630: 655f 7265 7374 7261 696e 742e 0a20 2020  e_restraint..   
-0001a640: 2064 6566 2065 7869 744c 6f63 616c 5f63   def exitLocal_c
-0001a650: 6f6f 7264 696e 6174 655f 7265 7374 7261  oordinate_restra
-0001a660: 696e 7428 7365 6c66 2c20 6374 783a 2052  int(self, ctx: R
-0001a670: 6f73 6574 7461 4d52 5061 7273 6572 2e4c  osettaMRParser.L
-0001a680: 6f63 616c 5f63 6f6f 7264 696e 6174 655f  ocal_coordinate_
-0001a690: 7265 7374 7261 696e 7443 6f6e 7465 7874  restraintContext
-0001a6a0: 293a 0a0a 2020 2020 2020 2020 7472 793a  ):..        try:
-0001a6b0: 0a0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-0001a6c0: 7149 6431 203d 2069 6e74 2873 7472 2863  qId1 = int(str(c
-0001a6d0: 7478 2e49 6e74 6567 6572 2830 2929 290a  tx.Integer(0))).
-0001a6e0: 2020 2020 2020 2020 2020 2020 6174 6f6d              atom
-0001a6f0: 4964 3120 3d20 7374 7228 6374 782e 5369  Id1 = str(ctx.Si
-0001a700: 6d70 6c65 5f6e 616d 6528 3029 292e 7570  mple_name(0)).up
-0001a710: 7065 7228 290a 2020 2020 2020 2020 2020  per().          
-0001a720: 2020 7365 7149 6432 3334 203d 2069 6e74    seqId234 = int
-0001a730: 2873 7472 2863 7478 2e49 6e74 6567 6572  (str(ctx.Integer
-0001a740: 2831 2929 290a 2020 2020 2020 2020 2020  (1))).          
-0001a750: 2020 6174 6f6d 4964 3220 3d20 7374 7228    atomId2 = str(
-0001a760: 6374 782e 5369 6d70 6c65 5f6e 616d 6528  ctx.Simple_name(
-0001a770: 3129 292e 7570 7065 7228 290a 2020 2020  1)).upper().    
-0001a780: 2020 2020 2020 2020 6174 6f6d 4964 3320          atomId3 
-0001a790: 3d20 7374 7228 6374 782e 5369 6d70 6c65  = str(ctx.Simple
-0001a7a0: 5f6e 616d 6528 3229 292e 7570 7065 7228  _name(2)).upper(
-0001a7b0: 290a 2020 2020 2020 2020 2020 2020 6174  ).            at
-0001a7c0: 6f6d 4964 3420 3d20 7374 7228 6374 782e  omId4 = str(ctx.
-0001a7d0: 5369 6d70 6c65 5f6e 616d 6528 3329 292e  Simple_name(3)).
-0001a7e0: 7570 7065 7228 290a 0a20 2020 2020 2020  upper()..       
-0001a7f0: 2020 2020 2069 6620 6c65 6e28 7365 6c66       if len(self
-0001a800: 2e6e 756d 6265 7253 656c 6563 7469 6f6e  .numberSelection
-0001a810: 2920 3d3d 2030 206f 7220 4e6f 6e65 2069  ) == 0 or None i
-0001a820: 6e20 7365 6c66 2e6e 756d 6265 7253 656c  n self.numberSel
-0001a830: 6563 7469 6f6e 3a0a 2020 2020 2020 2020  ection:.        
-0001a840: 2020 2020 2020 2020 7265 7475 726e 0a0a          return..
-0001a850: 2020 2020 2020 2020 2020 2020 6361 7274              cart
-0001a860: 5820 3d20 7365 6c66 2e6e 756d 6265 7253  X = self.numberS
-0001a870: 656c 6563 7469 6f6e 5b30 5d0a 2020 2020  election[0].    
-0001a880: 2020 2020 2020 2020 6361 7274 5920 3d20          cartY = 
-0001a890: 7365 6c66 2e6e 756d 6265 7253 656c 6563  self.numberSelec
-0001a8a0: 7469 6f6e 5b31 5d0a 2020 2020 2020 2020  tion[1].        
-0001a8b0: 2020 2020 6361 7274 5a20 3d20 7365 6c66      cartZ = self
-0001a8c0: 2e6e 756d 6265 7253 656c 6563 7469 6f6e  .numberSelection
-0001a8d0: 5b32 5d0a 0a20 2020 2020 2020 2020 2020  [2]..           
-0001a8e0: 2064 7374 4675 6e63 203d 2073 656c 662e   dstFunc = self.
-0001a8f0: 7661 6c69 6461 7465 4469 7374 616e 6365  validateDistance
-0001a900: 5261 6e67 6528 312e 3029 0a0a 2020 2020  Range(1.0)..    
-0001a910: 2020 2020 2020 2020 6966 2064 7374 4675          if dstFu
-0001a920: 6e63 2069 7320 4e6f 6e65 3a0a 2020 2020  nc is None:.    
-0001a930: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001a940: 726e 0a0a 2020 2020 2020 2020 2020 2020  rn..            
-0001a950: 6966 206e 6f74 2073 656c 662e 5f5f 6861  if not self.__ha
-0001a960: 7350 6f6c 7953 6571 3a0a 2020 2020 2020  sPolySeq:.      
-0001a970: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001a980: 0a0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-0001a990: 6c66 2e5f 5f72 6574 7269 6576 654c 6f63  lf.__retrieveLoc
-0001a9a0: 616c 5365 7153 6368 656d 6528 290a 0a20  alSeqScheme().. 
-0001a9b0: 2020 2020 2020 2020 2020 2063 6861 696e             chain
-0001a9c0: 4173 7369 676e 3120 3d20 7365 6c66 2e61  Assign1 = self.a
-0001a9d0: 7373 6967 6e43 6f6f 7264 506f 6c79 6d65  ssignCoordPolyme
-0001a9e0: 7253 6571 7565 6e63 6528 7365 7149 6431  rSequence(seqId1
-0001a9f0: 2c20 6174 6f6d 4964 3129 0a20 2020 2020  , atomId1).     
-0001aa00: 2020 2020 2020 2063 6861 696e 4173 7369         chainAssi
-0001aa10: 676e 3220 3d20 7365 6c66 2e61 7373 6967  gn2 = self.assig
-0001aa20: 6e43 6f6f 7264 506f 6c79 6d65 7253 6571  nCoordPolymerSeq
-0001aa30: 7565 6e63 6528 7365 7149 6432 3334 2c20  uence(seqId234, 
-0001aa40: 6174 6f6d 4964 3229 0a20 2020 2020 2020  atomId2).       
-0001aa50: 2020 2020 2063 6861 696e 4173 7369 676e       chainAssign
-0001aa60: 3320 3d20 7365 6c66 2e61 7373 6967 6e43  3 = self.assignC
-0001aa70: 6f6f 7264 506f 6c79 6d65 7253 6571 7565  oordPolymerSeque
-0001aa80: 6e63 6528 7365 7149 6432 3334 2c20 6174  nce(seqId234, at
-0001aa90: 6f6d 4964 3329 0a20 2020 2020 2020 2020  omId3).         
-0001aaa0: 2020 2063 6861 696e 4173 7369 676e 3420     chainAssign4 
-0001aab0: 3d20 7365 6c66 2e61 7373 6967 6e43 6f6f  = self.assignCoo
-0001aac0: 7264 506f 6c79 6d65 7253 6571 7565 6e63  rdPolymerSequenc
-0001aad0: 6528 7365 7149 6432 3334 2c20 6174 6f6d  e(seqId234, atom
-0001aae0: 4964 3429 0a0a 2020 2020 2020 2020 2020  Id4)..          
-0001aaf0: 2020 6966 206c 656e 2863 6861 696e 4173    if len(chainAs
-0001ab00: 7369 676e 3129 203d 3d20 3020 6f72 206c  sign1) == 0 or l
-0001ab10: 656e 2863 6861 696e 4173 7369 676e 3229  en(chainAssign2)
-0001ab20: 203d 3d20 305c 0a20 2020 2020 2020 2020   == 0\.         
-0001ab30: 2020 2020 2020 6f72 206c 656e 2863 6861        or len(cha
-0001ab40: 696e 4173 7369 676e 3329 203d 3d20 3020  inAssign3) == 0 
-0001ab50: 6f72 206c 656e 2863 6861 696e 4173 7369  or len(chainAssi
-0001ab60: 676e 3429 203d 3d20 303a 0a20 2020 2020  gn4) == 0:.     
-0001ab70: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0001ab80: 6e0a 0a20 2020 2020 2020 2020 2020 2073  n..            s
-0001ab90: 656c 662e 7365 6c65 6374 436f 6f72 6441  elf.selectCoordA
-0001aba0: 746f 6d73 2863 6861 696e 4173 7369 676e  toms(chainAssign
-0001abb0: 312c 2073 6571 4964 312c 2061 746f 6d49  1, seqId1, atomI
-0001abc0: 6431 290a 2020 2020 2020 2020 2020 2020  d1).            
-0001abd0: 7365 6c66 2e73 656c 6563 7443 6f6f 7264  self.selectCoord
-0001abe0: 4174 6f6d 7328 6368 6169 6e41 7373 6967  Atoms(chainAssig
-0001abf0: 6e32 2c20 7365 7149 6432 3334 2c20 6174  n2, seqId234, at
-0001ac00: 6f6d 4964 322c 2046 616c 7365 2c20 2761  omId2, False, 'a
-0001ac10: 206c 6f63 616c 2063 6f6f 7264 696e 6174   local coordinat
-0001ac20: 6527 2920 2023 206f 7269 6769 6e41 746f  e')  # originAto
-0001ac30: 6d31 0a20 2020 2020 2020 2020 2020 2073  m1.            s
-0001ac40: 656c 662e 7365 6c65 6374 436f 6f72 6441  elf.selectCoordA
-0001ac50: 746f 6d73 2863 6861 696e 4173 7369 676e  toms(chainAssign
-0001ac60: 332c 2073 6571 4964 3233 342c 2061 746f  3, seqId234, ato
-0001ac70: 6d49 6433 2c20 4661 6c73 652c 2027 6120  mId3, False, 'a 
-0001ac80: 6c6f 6361 6c20 636f 6f72 6469 6e61 7465  local coordinate
-0001ac90: 2729 2020 2320 6f72 6967 696e 4174 6f6d  ')  # originAtom
-0001aca0: 320a 2020 2020 2020 2020 2020 2020 7365  2.            se
-0001acb0: 6c66 2e73 656c 6563 7443 6f6f 7264 4174  lf.selectCoordAt
-0001acc0: 6f6d 7328 6368 6169 6e41 7373 6967 6e34  oms(chainAssign4
-0001acd0: 2c20 7365 7149 6432 3334 2c20 6174 6f6d  , seqId234, atom
-0001ace0: 4964 342c 2046 616c 7365 2c20 2761 206c  Id4, False, 'a l
-0001acf0: 6f63 616c 2063 6f6f 7264 6961 6e74 6527  ocal coordiante'
-0001ad00: 2920 2023 206f 7269 6769 6e41 746f 6d33  )  # originAtom3
-0001ad10: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0001ad20: 206c 656e 2873 656c 662e 6174 6f6d 5365   len(self.atomSe
-0001ad30: 6c65 6374 696f 6e53 6574 2920 3c20 343a  lectionSet) < 4:
-0001ad40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ad50: 2072 6574 7572 6e0a 0a20 2020 2020 2020   return..       
-0001ad60: 2020 2020 2069 6620 7365 6c66 2e5f 5f63       if self.__c
-0001ad70: 7265 6174 6553 6644 6963 743a 0a20 2020  reateSfDict:.   
-0001ad80: 2020 2020 2020 2020 2020 2020 2073 6620               sf 
-0001ad90: 3d20 7365 6c66 2e5f 5f67 6574 5366 2827  = self.__getSf('
-0001ada0: 6c6f 6361 6c20 6861 726d 6f6e 6963 2063  local harmonic c
-0001adb0: 6f6f 7264 696e 6174 6520 7265 7374 7261  oordinate restra
-0001adc0: 696e 742c 2052 4f53 4554 5441 204c 6f63  int, ROSETTA Loc
-0001add0: 616c 436f 6f72 6469 6e61 7465 436f 6e73  alCoordinateCons
-0001ade0: 7472 6169 6e74 2729 0a20 2020 2020 2020  traint').       
-0001adf0: 2020 2020 2020 2020 2073 665b 2769 6427           sf['id'
-0001ae00: 5d20 2b3d 2031 0a20 2020 2020 2020 2020  ] += 1.         
-0001ae10: 2020 2020 2020 2069 6620 6c65 6e28 7366         if len(sf
-0001ae20: 5b27 6c6f 6f70 275d 5b27 7461 6773 275d  ['loop']['tags']
-0001ae30: 2920 3d3d 2030 3a0a 2020 2020 2020 2020  ) == 0:.        
-0001ae40: 2020 2020 2020 2020 2020 2020 7366 5b27              sf['
-0001ae50: 6c6f 6f70 275d 5b27 7461 6773 275d 203d  loop']['tags'] =
-0001ae60: 205b 2769 6e64 6578 5f69 6427 2c20 2769   ['index_id', 'i
-0001ae70: 6427 2c0a 2020 2020 2020 2020 2020 2020  d',.            
-0001ae80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ae90: 2020 2020 2020 2020 2020 2020 2020 2761                'a
-0001aea0: 7574 685f 6173 796d 5f69 6427 2c20 2761  uth_asym_id', 'a
-0001aeb0: 7574 685f 7365 715f 6964 272c 2027 6175  uth_seq_id', 'au
-0001aec0: 7468 5f63 6f6d 705f 6964 272c 2027 6175  th_comp_id', 'au
-0001aed0: 7468 5f61 746f 6d5f 6964 272c 0a20 2020  th_atom_id',.   
-0001aee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001aef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001af00: 2020 2020 2020 2027 6f72 6967 696e 5f61         'origin_a
-0001af10: 7574 685f 6173 796d 5f69 645f 3127 2c20  uth_asym_id_1', 
-0001af20: 276f 7269 6769 6e5f 6175 7468 5f73 6571  'origin_auth_seq
-0001af30: 5f69 645f 3127 2c20 276f 7269 6769 6e5f  _id_1', 'origin_
-0001af40: 6175 7468 5f63 6f6d 705f 6964 5f31 272c  auth_comp_id_1',
-0001af50: 2027 6f72 6967 696e 5f61 7574 685f 6174   'origin_auth_at
-0001af60: 6f6d 5f69 645f 3127 2c0a 2020 2020 2020  om_id_1',.      
-0001af70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001af80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001af90: 2020 2020 276f 7269 6769 6e5f 6175 7468      'origin_auth
-0001afa0: 5f61 7379 6d5f 6964 5f32 272c 2027 6f72  _asym_id_2', 'or
-0001afb0: 6967 696e 5f61 7574 685f 7365 715f 6964  igin_auth_seq_id
-0001afc0: 5f32 272c 2027 6f72 6967 696e 5f61 7574  _2', 'origin_aut
-0001afd0: 685f 636f 6d70 5f69 645f 3227 2c20 276f  h_comp_id_2', 'o
-0001afe0: 7269 6769 6e5f 6175 7468 5f61 746f 6d5f  rigin_auth_atom_
-0001aff0: 6964 5f32 272c 0a20 2020 2020 2020 2020  id_2',.         
-0001b000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b020: 2027 6f72 6967 696e 5f61 7574 685f 6173   'origin_auth_as
-0001b030: 796d 5f69 645f 3327 2c20 276f 7269 6769  ym_id_3', 'origi
-0001b040: 6e5f 6175 7468 5f73 6571 5f69 645f 3327  n_auth_seq_id_3'
-0001b050: 2c20 276f 7269 6769 6e5f 6175 7468 5f63  , 'origin_auth_c
-0001b060: 6f6d 705f 6964 5f33 272c 2027 6f72 6967  omp_id_3', 'orig
-0001b070: 696e 5f61 7574 685f 6174 6f6d 5f69 645f  in_auth_atom_id_
-0001b080: 3327 2c0a 2020 2020 2020 2020 2020 2020  3',.            
-0001b090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b0a0: 2020 2020 2020 2020 2020 2020 2020 276c                'l
-0001b0b0: 6f63 616c 5f63 6172 745f 7827 2c20 276c  ocal_cart_x', 'l
-0001b0c0: 6f63 616c 5f63 6172 745f 7927 2c20 276c  ocal_cart_y', 'l
-0001b0d0: 6f63 616c 5f63 6172 745f 7a27 2c0a 2020  ocal_cart_z',.  
-0001b0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b100: 2020 2020 2020 2020 276c 6973 745f 6964          'list_id
-0001b110: 272c 2027 656e 7472 795f 6964 275d 0a0a  ', 'entry_id']..
-0001b120: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0001b130: 656c 662e 5f5f 6375 725f 6e65 7374 2069  elf.__cur_nest i
-0001b140: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-0001b150: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0001b160: 656c 662e 5f5f 6465 6275 673a 0a20 2020  elf.__debug:.   
+0001a160: 2020 2020 2020 2020 2020 7366 5b27 6c69            sf['li
+0001a170: 7374 5f69 6427 5d2c 2073 656c 662e 5f5f  st_id'], self.__
+0001a180: 656e 7472 7949 645d 290a 0a20 2020 2020  entryId])..     
+0001a190: 2020 2065 7863 6570 7420 5661 6c75 6545     except ValueE
+0001a1a0: 7272 6f72 3a0a 2020 2020 2020 2020 2020  rror:.          
+0001a1b0: 2020 7365 6c66 2e67 656f 5265 7374 7261    self.geoRestra
+0001a1c0: 696e 7473 202d 3d20 310a 2020 2020 2020  ints -= 1.      
+0001a1d0: 2020 6669 6e61 6c6c 793a 0a20 2020 2020    finally:.     
+0001a1e0: 2020 2020 2020 2073 656c 662e 6e75 6d62         self.numb
+0001a1f0: 6572 5365 6c65 6374 696f 6e2e 636c 6561  erSelection.clea
+0001a200: 7228 290a 0a20 2020 2023 2045 6e74 6572  r()..    # Enter
+0001a210: 2061 2070 6172 7365 2074 7265 6520 7072   a parse tree pr
+0001a220: 6f64 7563 6564 2062 7920 526f 7365 7474  oduced by Rosett
+0001a230: 614d 5250 6172 7365 7223 6c6f 6361 6c5f  aMRParser#local_
+0001a240: 636f 6f72 6469 6e61 7465 5f72 6573 7472  coordinate_restr
+0001a250: 6169 6e74 732e 0a20 2020 2064 6566 2065  aints..    def e
+0001a260: 6e74 6572 4c6f 6361 6c5f 636f 6f72 6469  nterLocal_coordi
+0001a270: 6e61 7465 5f72 6573 7472 6169 6e74 7328  nate_restraints(
+0001a280: 7365 6c66 2c20 6374 783a 2052 6f73 6574  self, ctx: Roset
+0001a290: 7461 4d52 5061 7273 6572 2e4c 6f63 616c  taMRParser.Local
+0001a2a0: 5f63 6f6f 7264 696e 6174 655f 7265 7374  _coordinate_rest
+0001a2b0: 7261 696e 7473 436f 6e74 6578 7429 3a20  raintsContext): 
+0001a2c0: 2023 2070 796c 696e 743a 2064 6973 6162   # pylint: disab
+0001a2d0: 6c65 3d75 6e75 7365 642d 6172 6775 6d65  le=unused-argume
+0001a2e0: 6e74 0a20 2020 2020 2020 2073 656c 662e  nt.        self.
+0001a2f0: 5f5f 6375 725f 7375 6274 7970 6520 3d20  __cur_subtype = 
+0001a300: 2767 656f 270a 0a20 2020 2023 2045 7869  'geo'..    # Exi
+0001a310: 7420 6120 7061 7273 6520 7472 6565 2070  t a parse tree p
+0001a320: 726f 6475 6365 6420 6279 2052 6f73 6574  roduced by Roset
+0001a330: 7461 4d52 5061 7273 6572 236c 6f63 616c  taMRParser#local
+0001a340: 5f63 6f6f 7264 696e 6174 655f 7265 7374  _coordinate_rest
+0001a350: 7261 696e 7473 2e0a 2020 2020 6465 6620  raints..    def 
+0001a360: 6578 6974 4c6f 6361 6c5f 636f 6f72 6469  exitLocal_coordi
+0001a370: 6e61 7465 5f72 6573 7472 6169 6e74 7328  nate_restraints(
+0001a380: 7365 6c66 2c20 6374 783a 2052 6f73 6574  self, ctx: Roset
+0001a390: 7461 4d52 5061 7273 6572 2e4c 6f63 616c  taMRParser.Local
+0001a3a0: 5f63 6f6f 7264 696e 6174 655f 7265 7374  _coordinate_rest
+0001a3b0: 7261 696e 7473 436f 6e74 6578 7429 3a20  raintsContext): 
+0001a3c0: 2023 2070 796c 696e 743a 2064 6973 6162   # pylint: disab
+0001a3d0: 6c65 3d75 6e75 7365 642d 6172 6775 6d65  le=unused-argume
+0001a3e0: 6e74 0a20 2020 2020 2020 2070 6173 730a  nt.        pass.
+0001a3f0: 0a20 2020 2023 2045 6e74 6572 2061 2070  .    # Enter a p
+0001a400: 6172 7365 2074 7265 6520 7072 6f64 7563  arse tree produc
+0001a410: 6564 2062 7920 526f 7365 7474 614d 5250  ed by RosettaMRP
+0001a420: 6172 7365 7223 6c6f 6361 6c5f 636f 6f72  arser#local_coor
+0001a430: 6469 6e61 7465 5f72 6573 7472 6169 6e74  dinate_restraint
+0001a440: 2e0a 2020 2020 6465 6620 656e 7465 724c  ..    def enterL
+0001a450: 6f63 616c 5f63 6f6f 7264 696e 6174 655f  ocal_coordinate_
+0001a460: 7265 7374 7261 696e 7428 7365 6c66 2c20  restraint(self, 
+0001a470: 6374 783a 2052 6f73 6574 7461 4d52 5061  ctx: RosettaMRPa
+0001a480: 7273 6572 2e4c 6f63 616c 5f63 6f6f 7264  rser.Local_coord
+0001a490: 696e 6174 655f 7265 7374 7261 696e 7443  inate_restraintC
+0001a4a0: 6f6e 7465 7874 293a 2020 2320 7079 6c69  ontext):  # pyli
+0001a4b0: 6e74 3a20 6469 7361 626c 653d 756e 7573  nt: disable=unus
+0001a4c0: 6564 2d61 7267 756d 656e 740a 2020 2020  ed-argument.    
+0001a4d0: 2020 2020 7365 6c66 2e67 656f 5265 7374      self.geoRest
+0001a4e0: 7261 696e 7473 202b 3d20 310a 0a20 2020  raints += 1..   
+0001a4f0: 2020 2020 2073 656c 662e 7374 6163 6b46       self.stackF
+0001a500: 756e 6373 2e63 6c65 6172 2829 0a20 2020  uncs.clear().   
+0001a510: 2020 2020 2073 656c 662e 6174 6f6d 5365       self.atomSe
+0001a520: 6c65 6374 696f 6e53 6574 2e63 6c65 6172  lectionSet.clear
+0001a530: 2829 0a0a 2020 2020 2320 4578 6974 2061  ()..    # Exit a
+0001a540: 2070 6172 7365 2074 7265 6520 7072 6f64   parse tree prod
+0001a550: 7563 6564 2062 7920 526f 7365 7474 614d  uced by RosettaM
+0001a560: 5250 6172 7365 7223 6c6f 6361 6c5f 636f  RParser#local_co
+0001a570: 6f72 6469 6e61 7465 5f72 6573 7472 6169  ordinate_restrai
+0001a580: 6e74 2e0a 2020 2020 6465 6620 6578 6974  nt..    def exit
+0001a590: 4c6f 6361 6c5f 636f 6f72 6469 6e61 7465  Local_coordinate
+0001a5a0: 5f72 6573 7472 6169 6e74 2873 656c 662c  _restraint(self,
+0001a5b0: 2063 7478 3a20 526f 7365 7474 614d 5250   ctx: RosettaMRP
+0001a5c0: 6172 7365 722e 4c6f 6361 6c5f 636f 6f72  arser.Local_coor
+0001a5d0: 6469 6e61 7465 5f72 6573 7472 6169 6e74  dinate_restraint
+0001a5e0: 436f 6e74 6578 7429 3a0a 0a20 2020 2020  Context):..     
+0001a5f0: 2020 2074 7279 3a0a 0a20 2020 2020 2020     try:..       
+0001a600: 2020 2020 2073 6571 4964 3120 3d20 696e       seqId1 = in
+0001a610: 7428 7374 7228 6374 782e 496e 7465 6765  t(str(ctx.Intege
+0001a620: 7228 3029 2929 0a20 2020 2020 2020 2020  r(0))).         
+0001a630: 2020 2061 746f 6d49 6431 203d 2073 7472     atomId1 = str
+0001a640: 2863 7478 2e53 696d 706c 655f 6e61 6d65  (ctx.Simple_name
+0001a650: 2830 2929 2e75 7070 6572 2829 0a20 2020  (0)).upper().   
+0001a660: 2020 2020 2020 2020 2073 6571 4964 3233           seqId23
+0001a670: 3420 3d20 696e 7428 7374 7228 6374 782e  4 = int(str(ctx.
+0001a680: 496e 7465 6765 7228 3129 2929 0a20 2020  Integer(1))).   
+0001a690: 2020 2020 2020 2020 2061 746f 6d49 6432           atomId2
+0001a6a0: 203d 2073 7472 2863 7478 2e53 696d 706c   = str(ctx.Simpl
+0001a6b0: 655f 6e61 6d65 2831 2929 2e75 7070 6572  e_name(1)).upper
+0001a6c0: 2829 0a20 2020 2020 2020 2020 2020 2061  ().            a
+0001a6d0: 746f 6d49 6433 203d 2073 7472 2863 7478  tomId3 = str(ctx
+0001a6e0: 2e53 696d 706c 655f 6e61 6d65 2832 2929  .Simple_name(2))
+0001a6f0: 2e75 7070 6572 2829 0a20 2020 2020 2020  .upper().       
+0001a700: 2020 2020 2061 746f 6d49 6434 203d 2073       atomId4 = s
+0001a710: 7472 2863 7478 2e53 696d 706c 655f 6e61  tr(ctx.Simple_na
+0001a720: 6d65 2833 2929 2e75 7070 6572 2829 0a0a  me(3)).upper()..
+0001a730: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+0001a740: 656e 2873 656c 662e 6e75 6d62 6572 5365  en(self.numberSe
+0001a750: 6c65 6374 696f 6e29 203d 3d20 3020 6f72  lection) == 0 or
+0001a760: 204e 6f6e 6520 696e 2073 656c 662e 6e75   None in self.nu
+0001a770: 6d62 6572 5365 6c65 6374 696f 6e3a 0a20  mberSelection:. 
+0001a780: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0001a790: 6574 7572 6e0a 0a20 2020 2020 2020 2020  eturn..         
+0001a7a0: 2020 2063 6172 7458 203d 2073 656c 662e     cartX = self.
+0001a7b0: 6e75 6d62 6572 5365 6c65 6374 696f 6e5b  numberSelection[
+0001a7c0: 305d 0a20 2020 2020 2020 2020 2020 2063  0].            c
+0001a7d0: 6172 7459 203d 2073 656c 662e 6e75 6d62  artY = self.numb
+0001a7e0: 6572 5365 6c65 6374 696f 6e5b 315d 0a20  erSelection[1]. 
+0001a7f0: 2020 2020 2020 2020 2020 2063 6172 745a             cartZ
+0001a800: 203d 2073 656c 662e 6e75 6d62 6572 5365   = self.numberSe
+0001a810: 6c65 6374 696f 6e5b 325d 0a0a 2020 2020  lection[2]..    
+0001a820: 2020 2020 2020 2020 6473 7446 756e 6320          dstFunc 
+0001a830: 3d20 7365 6c66 2e76 616c 6964 6174 6544  = self.validateD
+0001a840: 6973 7461 6e63 6552 616e 6765 2831 2e30  istanceRange(1.0
+0001a850: 290a 0a20 2020 2020 2020 2020 2020 2069  )..            i
+0001a860: 6620 6473 7446 756e 6320 6973 204e 6f6e  f dstFunc is Non
+0001a870: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0001a880: 2020 2072 6574 7572 6e0a 0a20 2020 2020     return..     
+0001a890: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
+0001a8a0: 6c66 2e5f 5f68 6173 506f 6c79 5365 713a  lf.__hasPolySeq:
+0001a8b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a8c0: 2072 6574 7572 6e0a 0a20 2020 2020 2020   return..       
+0001a8d0: 2020 2020 2073 656c 662e 5f5f 7265 7472       self.__retr
+0001a8e0: 6965 7665 4c6f 6361 6c53 6571 5363 6865  ieveLocalSeqSche
+0001a8f0: 6d65 2829 0a0a 2020 2020 2020 2020 2020  me()..          
+0001a900: 2020 6368 6169 6e41 7373 6967 6e31 203d    chainAssign1 =
+0001a910: 2073 656c 662e 6173 7369 676e 436f 6f72   self.assignCoor
+0001a920: 6450 6f6c 796d 6572 5365 7175 656e 6365  dPolymerSequence
+0001a930: 2873 6571 4964 312c 2061 746f 6d49 6431  (seqId1, atomId1
+0001a940: 290a 2020 2020 2020 2020 2020 2020 6368  ).            ch
+0001a950: 6169 6e41 7373 6967 6e32 203d 2073 656c  ainAssign2 = sel
+0001a960: 662e 6173 7369 676e 436f 6f72 6450 6f6c  f.assignCoordPol
+0001a970: 796d 6572 5365 7175 656e 6365 2873 6571  ymerSequence(seq
+0001a980: 4964 3233 342c 2061 746f 6d49 6432 290a  Id234, atomId2).
+0001a990: 2020 2020 2020 2020 2020 2020 6368 6169              chai
+0001a9a0: 6e41 7373 6967 6e33 203d 2073 656c 662e  nAssign3 = self.
+0001a9b0: 6173 7369 676e 436f 6f72 6450 6f6c 796d  assignCoordPolym
+0001a9c0: 6572 5365 7175 656e 6365 2873 6571 4964  erSequence(seqId
+0001a9d0: 3233 342c 2061 746f 6d49 6433 290a 2020  234, atomId3).  
+0001a9e0: 2020 2020 2020 2020 2020 6368 6169 6e41            chainA
+0001a9f0: 7373 6967 6e34 203d 2073 656c 662e 6173  ssign4 = self.as
+0001aa00: 7369 676e 436f 6f72 6450 6f6c 796d 6572  signCoordPolymer
+0001aa10: 5365 7175 656e 6365 2873 6571 4964 3233  Sequence(seqId23
+0001aa20: 342c 2061 746f 6d49 6434 290a 0a20 2020  4, atomId4)..   
+0001aa30: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
+0001aa40: 6368 6169 6e41 7373 6967 6e31 2920 3d3d  chainAssign1) ==
+0001aa50: 2030 206f 7220 6c65 6e28 6368 6169 6e41   0 or len(chainA
+0001aa60: 7373 6967 6e32 2920 3d3d 2030 5c0a 2020  ssign2) == 0\.  
+0001aa70: 2020 2020 2020 2020 2020 2020 206f 7220               or 
+0001aa80: 6c65 6e28 6368 6169 6e41 7373 6967 6e33  len(chainAssign3
+0001aa90: 2920 3d3d 2030 206f 7220 6c65 6e28 6368  ) == 0 or len(ch
+0001aaa0: 6169 6e41 7373 6967 6e34 2920 3d3d 2030  ainAssign4) == 0
+0001aab0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001aac0: 2020 7265 7475 726e 0a0a 2020 2020 2020    return..      
+0001aad0: 2020 2020 2020 7365 6c66 2e73 656c 6563        self.selec
+0001aae0: 7443 6f6f 7264 4174 6f6d 7328 6368 6169  tCoordAtoms(chai
+0001aaf0: 6e41 7373 6967 6e31 2c20 7365 7149 6431  nAssign1, seqId1
+0001ab00: 2c20 6174 6f6d 4964 3129 0a20 2020 2020  , atomId1).     
+0001ab10: 2020 2020 2020 2073 656c 662e 7365 6c65         self.sele
+0001ab20: 6374 436f 6f72 6441 746f 6d73 2863 6861  ctCoordAtoms(cha
+0001ab30: 696e 4173 7369 676e 322c 2073 6571 4964  inAssign2, seqId
+0001ab40: 3233 342c 2061 746f 6d49 6432 2c20 4661  234, atomId2, Fa
+0001ab50: 6c73 652c 2027 6120 6c6f 6361 6c20 636f  lse, 'a local co
+0001ab60: 6f72 6469 6e61 7465 2729 2020 2320 6f72  ordinate')  # or
+0001ab70: 6967 696e 4174 6f6d 310a 2020 2020 2020  iginAtom1.      
+0001ab80: 2020 2020 2020 7365 6c66 2e73 656c 6563        self.selec
+0001ab90: 7443 6f6f 7264 4174 6f6d 7328 6368 6169  tCoordAtoms(chai
+0001aba0: 6e41 7373 6967 6e33 2c20 7365 7149 6432  nAssign3, seqId2
+0001abb0: 3334 2c20 6174 6f6d 4964 332c 2046 616c  34, atomId3, Fal
+0001abc0: 7365 2c20 2761 206c 6f63 616c 2063 6f6f  se, 'a local coo
+0001abd0: 7264 696e 6174 6527 2920 2023 206f 7269  rdinate')  # ori
+0001abe0: 6769 6e41 746f 6d32 0a20 2020 2020 2020  ginAtom2.       
+0001abf0: 2020 2020 2073 656c 662e 7365 6c65 6374       self.select
+0001ac00: 436f 6f72 6441 746f 6d73 2863 6861 696e  CoordAtoms(chain
+0001ac10: 4173 7369 676e 342c 2073 6571 4964 3233  Assign4, seqId23
+0001ac20: 342c 2061 746f 6d49 6434 2c20 4661 6c73  4, atomId4, Fals
+0001ac30: 652c 2027 6120 6c6f 6361 6c20 636f 6f72  e, 'a local coor
+0001ac40: 6469 616e 7465 2729 2020 2320 6f72 6967  diante')  # orig
+0001ac50: 696e 4174 6f6d 330a 0a20 2020 2020 2020  inAtom3..       
+0001ac60: 2020 2020 2069 6620 6c65 6e28 7365 6c66       if len(self
+0001ac70: 2e61 746f 6d53 656c 6563 7469 6f6e 5365  .atomSelectionSe
+0001ac80: 7429 203c 2034 3a0a 2020 2020 2020 2020  t) < 4:.        
+0001ac90: 2020 2020 2020 2020 7265 7475 726e 0a0a          return..
+0001aca0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0001acb0: 656c 662e 5f5f 6372 6561 7465 5366 4469  elf.__createSfDi
+0001acc0: 6374 3a0a 2020 2020 2020 2020 2020 2020  ct:.            
+0001acd0: 2020 2020 7366 203d 2073 656c 662e 5f5f      sf = self.__
+0001ace0: 6765 7453 6628 276c 6f63 616c 2068 6172  getSf('local har
+0001acf0: 6d6f 6e69 6320 636f 6f72 6469 6e61 7465  monic coordinate
+0001ad00: 2072 6573 7472 6169 6e74 2c20 524f 5345   restraint, ROSE
+0001ad10: 5454 4120 4c6f 6361 6c43 6f6f 7264 696e  TTA LocalCoordin
+0001ad20: 6174 6543 6f6e 7374 7261 696e 7427 290a  ateConstraint').
+0001ad30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ad40: 7366 5b27 6964 275d 202b 3d20 310a 2020  sf['id'] += 1.  
+0001ad50: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0001ad60: 206c 656e 2873 665b 276c 6f6f 7027 5d5b   len(sf['loop'][
+0001ad70: 2774 6167 7327 5d29 203d 3d20 303a 0a20  'tags']) == 0:. 
+0001ad80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ad90: 2020 2073 665b 276c 6f6f 7027 5d5b 2774     sf['loop']['t
+0001ada0: 6167 7327 5d20 3d20 5b27 696e 6465 785f  ags'] = ['index_
+0001adb0: 6964 272c 2027 6964 272c 0a20 2020 2020  id', 'id',.     
+0001adc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001add0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ade0: 2020 2020 2027 6175 7468 5f61 7379 6d5f       'auth_asym_
+0001adf0: 6964 272c 2027 6175 7468 5f73 6571 5f69  id', 'auth_seq_i
+0001ae00: 6427 2c20 2761 7574 685f 636f 6d70 5f69  d', 'auth_comp_i
+0001ae10: 6427 2c20 2761 7574 685f 6174 6f6d 5f69  d', 'auth_atom_i
+0001ae20: 6427 2c0a 2020 2020 2020 2020 2020 2020  d',.            
+0001ae30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ae40: 2020 2020 2020 2020 2020 2020 2020 276f                'o
+0001ae50: 7269 6769 6e5f 6175 7468 5f61 7379 6d5f  rigin_auth_asym_
+0001ae60: 6964 5f31 272c 2027 6f72 6967 696e 5f61  id_1', 'origin_a
+0001ae70: 7574 685f 7365 715f 6964 5f31 272c 2027  uth_seq_id_1', '
+0001ae80: 6f72 6967 696e 5f61 7574 685f 636f 6d70  origin_auth_comp
+0001ae90: 5f69 645f 3127 2c20 276f 7269 6769 6e5f  _id_1', 'origin_
+0001aea0: 6175 7468 5f61 746f 6d5f 6964 5f31 272c  auth_atom_id_1',
+0001aeb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001aec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001aed0: 2020 2020 2020 2020 2020 2027 6f72 6967             'orig
+0001aee0: 696e 5f61 7574 685f 6173 796d 5f69 645f  in_auth_asym_id_
+0001aef0: 3227 2c20 276f 7269 6769 6e5f 6175 7468  2', 'origin_auth
+0001af00: 5f73 6571 5f69 645f 3227 2c20 276f 7269  _seq_id_2', 'ori
+0001af10: 6769 6e5f 6175 7468 5f63 6f6d 705f 6964  gin_auth_comp_id
+0001af20: 5f32 272c 2027 6f72 6967 696e 5f61 7574  _2', 'origin_aut
+0001af30: 685f 6174 6f6d 5f69 645f 3227 2c0a 2020  h_atom_id_2',.  
+0001af40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001af50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001af60: 2020 2020 2020 2020 276f 7269 6769 6e5f          'origin_
+0001af70: 6175 7468 5f61 7379 6d5f 6964 5f33 272c  auth_asym_id_3',
+0001af80: 2027 6f72 6967 696e 5f61 7574 685f 7365   'origin_auth_se
+0001af90: 715f 6964 5f33 272c 2027 6f72 6967 696e  q_id_3', 'origin
+0001afa0: 5f61 7574 685f 636f 6d70 5f69 645f 3327  _auth_comp_id_3'
+0001afb0: 2c20 276f 7269 6769 6e5f 6175 7468 5f61  , 'origin_auth_a
+0001afc0: 746f 6d5f 6964 5f33 272c 0a20 2020 2020  tom_id_3',.     
+0001afd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001afe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001aff0: 2020 2020 2027 6c6f 6361 6c5f 6361 7274       'local_cart
+0001b000: 5f78 272c 2027 6c6f 6361 6c5f 6361 7274  _x', 'local_cart
+0001b010: 5f79 272c 2027 6c6f 6361 6c5f 6361 7274  _y', 'local_cart
+0001b020: 5f7a 272c 0a20 2020 2020 2020 2020 2020  _z',.           
+0001b030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b040: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0001b050: 6c69 7374 5f69 6427 2c20 2765 6e74 7279  list_id', 'entry
+0001b060: 5f69 6427 5d0a 0a20 2020 2020 2020 2020  _id']..         
+0001b070: 2020 2069 6620 7365 6c66 2e5f 5f63 7572     if self.__cur
+0001b080: 5f6e 6573 7420 6973 206e 6f74 204e 6f6e  _nest is not Non
+0001b090: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0001b0a0: 2020 2069 6620 7365 6c66 2e5f 5f64 6562     if self.__deb
+0001b0b0: 7567 3a0a 2020 2020 2020 2020 2020 2020  ug:.            
+0001b0c0: 2020 2020 2020 2020 7072 696e 7428 6622          print(f"
+0001b0d0: 4e45 5354 4544 3a20 7b73 656c 662e 5f5f  NESTED: {self.__
+0001b0e0: 6375 725f 6e65 7374 7d22 290a 0a20 2020  cur_nest}")..   
+0001b0f0: 2020 2020 2020 2020 2066 6f72 2061 746f           for ato
+0001b100: 6d31 2c20 6174 6f6d 322c 2061 746f 6d33  m1, atom2, atom3
+0001b110: 2c20 6174 6f6d 3420 696e 2069 7465 7274  , atom4 in itert
+0001b120: 6f6f 6c73 2e70 726f 6475 6374 2873 656c  ools.product(sel
+0001b130: 662e 6174 6f6d 5365 6c65 6374 696f 6e53  f.atomSelectionS
+0001b140: 6574 5b30 5d2c 0a20 2020 2020 2020 2020  et[0],.         
+0001b150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b160: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001b170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b180: 2070 7269 6e74 2866 224e 4553 5445 443a   print(f"NESTED:
-0001b190: 207b 7365 6c66 2e5f 5f63 7572 5f6e 6573   {self.__cur_nes
-0001b1a0: 747d 2229 0a0a 2020 2020 2020 2020 2020  t}")..          
-0001b1b0: 2020 666f 7220 6174 6f6d 312c 2061 746f    for atom1, ato
-0001b1c0: 6d32 2c20 6174 6f6d 332c 2061 746f 6d34  m2, atom3, atom4
-0001b1d0: 2069 6e20 6974 6572 746f 6f6c 732e 7072   in itertools.pr
-0001b1e0: 6f64 7563 7428 7365 6c66 2e61 746f 6d53  oduct(self.atomS
-0001b1f0: 656c 6563 7469 6f6e 5365 745b 305d 2c0a  electionSet[0],.
+0001b180: 2020 2020 2020 2073 656c 662e 6174 6f6d         self.atom
+0001b190: 5365 6c65 6374 696f 6e53 6574 5b31 5d2c  SelectionSet[1],
+0001b1a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b1e0: 2073 656c 662e 6174 6f6d 5365 6c65 6374   self.atomSelect
+0001b1f0: 696f 6e53 6574 5b32 5d2c 0a20 2020 2020  ionSet[2],.     
 0001b200: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001b210: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001b220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b240: 7365 6c66 2e61 746f 6d53 656c 6563 7469  self.atomSelecti
-0001b250: 6f6e 5365 745b 315d 2c0a 2020 2020 2020  onSet[1],.      
-0001b260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b290: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-0001b2a0: 746f 6d53 656c 6563 7469 6f6e 5365 745b  tomSelectionSet[
-0001b2b0: 325d 2c0a 2020 2020 2020 2020 2020 2020  2],.            
-0001b2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b230: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001b240: 6174 6f6d 5365 6c65 6374 696f 6e53 6574  atomSelectionSet
+0001b250: 5b33 5d29 3a0a 2020 2020 2020 2020 2020  [3]):.          
+0001b260: 2020 2020 2020 6966 2073 656c 662e 5f5f        if self.__
+0001b270: 6465 6275 673a 0a20 2020 2020 2020 2020  debug:.         
+0001b280: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0001b290: 2866 2273 7562 7479 7065 3d7b 7365 6c66  (f"subtype={self
+0001b2a0: 2e5f 5f63 7572 5f73 7562 7479 7065 7d20  .__cur_subtype} 
+0001b2b0: 284c 6f63 616c 436f 6f72 6469 6e61 7465  (LocalCoordinate
+0001b2c0: 2920 6964 3d7b 7365 6c66 2e67 656f 5265  ) id={self.geoRe
+0001b2d0: 7374 7261 696e 7473 7d20 220a 2020 2020  straints} ".    
 0001b2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b2f0: 2020 2020 7365 6c66 2e61 746f 6d53 656c      self.atomSel
-0001b300: 6563 7469 6f6e 5365 745b 335d 293a 0a20  ectionSet[3]):. 
-0001b310: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0001b320: 6620 7365 6c66 2e5f 5f64 6562 7567 3a0a  f self.__debug:.
-0001b330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b340: 2020 2020 7072 696e 7428 6622 7375 6274      print(f"subt
-0001b350: 7970 653d 7b73 656c 662e 5f5f 6375 725f  ype={self.__cur_
-0001b360: 7375 6274 7970 657d 2028 4c6f 6361 6c43  subtype} (LocalC
-0001b370: 6f6f 7264 696e 6174 6529 2069 643d 7b73  oordinate) id={s
-0001b380: 656c 662e 6765 6f52 6573 7472 6169 6e74  elf.geoRestraint
-0001b390: 737d 2022 0a20 2020 2020 2020 2020 2020  s} ".           
-0001b3a0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0001b3b0: 2261 746f 6d3d 7b61 746f 6d31 7d20 6f72  "atom={atom1} or
-0001b3c0: 6967 696e 4174 6f6d 313d 7b61 746f 6d32  iginAtom1={atom2
-0001b3d0: 7d20 6f72 6967 696e 4174 6f6d 323d 7b61  } originAtom2={a
-0001b3e0: 746f 6d33 7d20 6f72 6967 696e 4174 6f6d  tom3} originAtom
-0001b3f0: 333d 7b61 746f 6d34 7d20 220a 2020 2020  3={atom4} ".    
-0001b400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b410: 2020 2020 2020 6622 6c6f 6361 6c43 6f6f        f"localCoo
-0001b420: 7264 3d28 7b63 6172 7458 7d2c 207b 6361  rd=({cartX}, {ca
-0001b430: 7274 597d 2c20 7b63 6172 745a 7d29 207b  rtY}, {cartZ}) {
-0001b440: 6473 7446 756e 637d 2229 0a20 2020 2020  dstFunc}").     
-0001b450: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-0001b460: 6c66 2e5f 5f63 7265 6174 6553 6644 6963  lf.__createSfDic
-0001b470: 7420 616e 6420 7366 2069 7320 6e6f 7420  t and sf is not 
-0001b480: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0001b490: 2020 2020 2020 2020 2020 7366 5b27 696e            sf['in
-0001b4a0: 6465 785f 6964 275d 202b 3d20 310a 2020  dex_id'] += 1.  
-0001b4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b4c0: 2020 7366 5b27 6c6f 6f70 275d 5b27 6461    sf['loop']['da
-0001b4d0: 7461 275d 2e61 7070 656e 6428 5b73 665b  ta'].append([sf[
-0001b4e0: 2769 6e64 6578 5f69 6427 5d2c 2073 665b  'index_id'], sf[
-0001b4f0: 2769 6427 5d2c 0a20 2020 2020 2020 2020  'id'],.         
-0001b500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b520: 2020 2020 2020 6174 6f6d 315b 2763 6861        atom1['cha
-0001b530: 696e 5f69 6427 5d2c 2061 746f 6d31 5b27  in_id'], atom1['
-0001b540: 7365 715f 6964 275d 2c20 6174 6f6d 315b  seq_id'], atom1[
-0001b550: 2763 6f6d 705f 6964 275d 2c20 6174 6f6d  'comp_id'], atom
-0001b560: 315b 2761 746f 6d5f 6964 275d 2c0a 2020  1['atom_id'],.  
-0001b570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b590: 2020 2020 2020 2020 2020 2020 2061 746f               ato
-0001b5a0: 6d32 5b27 6368 6169 6e5f 6964 275d 2c20  m2['chain_id'], 
-0001b5b0: 6174 6f6d 325b 2773 6571 5f69 6427 5d2c  atom2['seq_id'],
-0001b5c0: 2061 746f 6d32 5b27 636f 6d70 5f69 6427   atom2['comp_id'
-0001b5d0: 5d2c 2061 746f 6d32 5b27 6174 6f6d 5f69  ], atom2['atom_i
-0001b5e0: 6427 5d2c 0a20 2020 2020 2020 2020 2020  d'],.           
-0001b5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b610: 2020 2020 6174 6f6d 335b 2763 6861 696e      atom3['chain
-0001b620: 5f69 6427 5d2c 2061 746f 6d33 5b27 7365  _id'], atom3['se
-0001b630: 715f 6964 275d 2c20 6174 6f6d 335b 2763  q_id'], atom3['c
-0001b640: 6f6d 705f 6964 275d 2c20 6174 6f6d 335b  omp_id'], atom3[
-0001b650: 2761 746f 6d5f 6964 275d 2c0a 2020 2020  'atom_id'],.    
+0001b2f0: 2020 2020 2020 6622 6174 6f6d 3d7b 6174        f"atom={at
+0001b300: 6f6d 317d 206f 7269 6769 6e41 746f 6d31  om1} originAtom1
+0001b310: 3d7b 6174 6f6d 327d 206f 7269 6769 6e41  ={atom2} originA
+0001b320: 746f 6d32 3d7b 6174 6f6d 337d 206f 7269  tom2={atom3} ori
+0001b330: 6769 6e41 746f 6d33 3d7b 6174 6f6d 347d  ginAtom3={atom4}
+0001b340: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+0001b350: 2020 2020 2020 2020 2020 2020 2066 226c               f"l
+0001b360: 6f63 616c 436f 6f72 643d 287b 6361 7274  ocalCoord=({cart
+0001b370: 587d 2c20 7b63 6172 7459 7d2c 207b 6361  X}, {cartY}, {ca
+0001b380: 7274 5a7d 2920 7b64 7374 4675 6e63 7d22  rtZ}) {dstFunc}"
+0001b390: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0001b3a0: 2020 6966 2073 656c 662e 5f5f 6372 6561    if self.__crea
+0001b3b0: 7465 5366 4469 6374 2061 6e64 2073 6620  teSfDict and sf 
+0001b3c0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0001b3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b3e0: 2073 665b 2769 6e64 6578 5f69 6427 5d20   sf['index_id'] 
+0001b3f0: 2b3d 2031 0a20 2020 2020 2020 2020 2020  += 1.           
+0001b400: 2020 2020 2020 2020 2073 665b 276c 6f6f           sf['loo
+0001b410: 7027 5d5b 2764 6174 6127 5d2e 6170 7065  p']['data'].appe
+0001b420: 6e64 285b 7366 5b27 696e 6465 785f 6964  nd([sf['index_id
+0001b430: 275d 2c20 7366 5b27 6964 275d 2c0a 2020  '], sf['id'],.  
+0001b440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b460: 2020 2020 2020 2020 2020 2020 2061 746f               ato
+0001b470: 6d31 5b27 6368 6169 6e5f 6964 275d 2c20  m1['chain_id'], 
+0001b480: 6174 6f6d 315b 2773 6571 5f69 6427 5d2c  atom1['seq_id'],
+0001b490: 2061 746f 6d31 5b27 636f 6d70 5f69 6427   atom1['comp_id'
+0001b4a0: 5d2c 2061 746f 6d31 5b27 6174 6f6d 5f69  ], atom1['atom_i
+0001b4b0: 6427 5d2c 0a20 2020 2020 2020 2020 2020  d'],.           
+0001b4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b4e0: 2020 2020 6174 6f6d 325b 2763 6861 696e      atom2['chain
+0001b4f0: 5f69 6427 5d2c 2061 746f 6d32 5b27 7365  _id'], atom2['se
+0001b500: 715f 6964 275d 2c20 6174 6f6d 325b 2763  q_id'], atom2['c
+0001b510: 6f6d 705f 6964 275d 2c20 6174 6f6d 325b  omp_id'], atom2[
+0001b520: 2761 746f 6d5f 6964 275d 2c0a 2020 2020  'atom_id'],.    
+0001b530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b550: 2020 2020 2020 2020 2020 2061 746f 6d33             atom3
+0001b560: 5b27 6368 6169 6e5f 6964 275d 2c20 6174  ['chain_id'], at
+0001b570: 6f6d 335b 2773 6571 5f69 6427 5d2c 2061  om3['seq_id'], a
+0001b580: 746f 6d33 5b27 636f 6d70 5f69 6427 5d2c  tom3['comp_id'],
+0001b590: 2061 746f 6d33 5b27 6174 6f6d 5f69 6427   atom3['atom_id'
+0001b5a0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0001b5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b5d0: 2020 6174 6f6d 345b 2763 6861 696e 5f69    atom4['chain_i
+0001b5e0: 6427 5d2c 2061 746f 6d34 5b27 7365 715f  d'], atom4['seq_
+0001b5f0: 6964 275d 2c20 6174 6f6d 345b 2763 6f6d  id'], atom4['com
+0001b600: 705f 6964 275d 2c20 6174 6f6d 345b 2761  p_id'], atom4['a
+0001b610: 746f 6d5f 6964 275d 2c0a 2020 2020 2020  tom_id'],.      
+0001b620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b640: 2020 2020 2020 2020 2063 6172 7458 2c20           cartX, 
+0001b650: 6361 7274 592c 2063 6172 745a 2c0a 2020  cartY, cartZ,.  
 0001b660: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001b670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b680: 2020 2020 2020 2020 2020 2061 746f 6d34             atom4
-0001b690: 5b27 6368 6169 6e5f 6964 275d 2c20 6174  ['chain_id'], at
-0001b6a0: 6f6d 345b 2773 6571 5f69 6427 5d2c 2061  om4['seq_id'], a
-0001b6b0: 746f 6d34 5b27 636f 6d70 5f69 6427 5d2c  tom4['comp_id'],
-0001b6c0: 2061 746f 6d34 5b27 6174 6f6d 5f69 6427   atom4['atom_id'
-0001b6d0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-0001b6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b700: 2020 6361 7274 582c 2063 6172 7459 2c20    cartX, cartY, 
-0001b710: 6361 7274 5a2c 0a20 2020 2020 2020 2020  cartZ,.         
-0001b720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b740: 2020 2020 2020 7366 5b27 6c69 7374 5f69        sf['list_i
-0001b750: 6427 5d2c 2073 656c 662e 5f5f 656e 7472  d'], self.__entr
-0001b760: 7949 645d 290a 0a20 2020 2020 2020 2065  yId])..        e
-0001b770: 7863 6570 7420 5661 6c75 6545 7272 6f72  xcept ValueError
-0001b780: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-0001b790: 6c66 2e67 656f 5265 7374 7261 696e 7473  lf.geoRestraints
-0001b7a0: 202d 3d20 310a 2020 2020 2020 2020 6669   -= 1.        fi
-0001b7b0: 6e61 6c6c 793a 0a20 2020 2020 2020 2020  nally:.         
-0001b7c0: 2020 2073 656c 662e 6e75 6d62 6572 5365     self.numberSe
-0001b7d0: 6c65 6374 696f 6e2e 636c 6561 7228 290a  lection.clear().
-0001b7e0: 0a20 2020 2023 2045 6e74 6572 2061 2070  .    # Enter a p
-0001b7f0: 6172 7365 2074 7265 6520 7072 6f64 7563  arse tree produc
-0001b800: 6564 2062 7920 526f 7365 7474 614d 5250  ed by RosettaMRP
-0001b810: 6172 7365 7223 7369 7465 5f72 6573 7472  arser#site_restr
-0001b820: 6169 6e74 732e 0a20 2020 2064 6566 2065  aints..    def e
-0001b830: 6e74 6572 5369 7465 5f72 6573 7472 6169  nterSite_restrai
-0001b840: 6e74 7328 7365 6c66 2c20 6374 783a 2052  nts(self, ctx: R
-0001b850: 6f73 6574 7461 4d52 5061 7273 6572 2e53  osettaMRParser.S
-0001b860: 6974 655f 7265 7374 7261 696e 7473 436f  ite_restraintsCo
-0001b870: 6e74 6578 7429 3a20 2023 2070 796c 696e  ntext):  # pylin
-0001b880: 743a 2064 6973 6162 6c65 3d75 6e75 7365  t: disable=unuse
-0001b890: 642d 6172 6775 6d65 6e74 0a20 2020 2020  d-argument.     
-0001b8a0: 2020 2073 656c 662e 5f5f 6375 725f 7375     self.__cur_su
-0001b8b0: 6274 7970 6520 3d20 2767 656f 270a 0a20  btype = 'geo'.. 
-0001b8c0: 2020 2023 2045 7869 7420 6120 7061 7273     # Exit a pars
-0001b8d0: 6520 7472 6565 2070 726f 6475 6365 6420  e tree produced 
-0001b8e0: 6279 2052 6f73 6574 7461 4d52 5061 7273  by RosettaMRPars
-0001b8f0: 6572 2373 6974 655f 7265 7374 7261 696e  er#site_restrain
-0001b900: 7473 2e0a 2020 2020 6465 6620 6578 6974  ts..    def exit
-0001b910: 5369 7465 5f72 6573 7472 6169 6e74 7328  Site_restraints(
-0001b920: 7365 6c66 2c20 6374 783a 2052 6f73 6574  self, ctx: Roset
-0001b930: 7461 4d52 5061 7273 6572 2e53 6974 655f  taMRParser.Site_
-0001b940: 7265 7374 7261 696e 7473 436f 6e74 6578  restraintsContex
-0001b950: 7429 3a20 2023 2070 796c 696e 743a 2064  t):  # pylint: d
-0001b960: 6973 6162 6c65 3d75 6e75 7365 642d 6172  isable=unused-ar
-0001b970: 6775 6d65 6e74 0a20 2020 2020 2020 2070  gument.        p
-0001b980: 6173 730a 0a20 2020 2023 2045 6e74 6572  ass..    # Enter
-0001b990: 2061 2070 6172 7365 2074 7265 6520 7072   a parse tree pr
-0001b9a0: 6f64 7563 6564 2062 7920 526f 7365 7474  oduced by Rosett
-0001b9b0: 614d 5250 6172 7365 7223 7369 7465 5f72  aMRParser#site_r
-0001b9c0: 6573 7472 6169 6e74 2e0a 2020 2020 6465  estraint..    de
-0001b9d0: 6620 656e 7465 7253 6974 655f 7265 7374  f enterSite_rest
-0001b9e0: 7261 696e 7428 7365 6c66 2c20 6374 783a  raint(self, ctx:
-0001b9f0: 2052 6f73 6574 7461 4d52 5061 7273 6572   RosettaMRParser
-0001ba00: 2e53 6974 655f 7265 7374 7261 696e 7443  .Site_restraintC
-0001ba10: 6f6e 7465 7874 293a 2020 2320 7079 6c69  ontext):  # pyli
-0001ba20: 6e74 3a20 6469 7361 626c 653d 756e 7573  nt: disable=unus
-0001ba30: 6564 2d61 7267 756d 656e 740a 2020 2020  ed-argument.    
-0001ba40: 2020 2020 7365 6c66 2e67 656f 5265 7374      self.geoRest
-0001ba50: 7261 696e 7473 202b 3d20 310a 0a20 2020  raints += 1..   
-0001ba60: 2020 2020 2073 656c 662e 7374 6163 6b46       self.stackF
-0001ba70: 756e 6373 2e63 6c65 6172 2829 0a20 2020  uncs.clear().   
-0001ba80: 2020 2020 2073 656c 662e 6174 6f6d 5365       self.atomSe
-0001ba90: 6c65 6374 696f 6e53 6574 2e63 6c65 6172  lectionSet.clear
-0001baa0: 2829 0a0a 2020 2020 2320 4578 6974 2061  ()..    # Exit a
-0001bab0: 2070 6172 7365 2074 7265 6520 7072 6f64   parse tree prod
-0001bac0: 7563 6564 2062 7920 526f 7365 7474 614d  uced by RosettaM
-0001bad0: 5250 6172 7365 7223 7369 7465 5f72 6573  RParser#site_res
-0001bae0: 7472 6169 6e74 2e0a 2020 2020 6465 6620  traint..    def 
-0001baf0: 6578 6974 5369 7465 5f72 6573 7472 6169  exitSite_restrai
-0001bb00: 6e74 2873 656c 662c 2063 7478 3a20 526f  nt(self, ctx: Ro
-0001bb10: 7365 7474 614d 5250 6172 7365 722e 5369  settaMRParser.Si
-0001bb20: 7465 5f72 6573 7472 6169 6e74 436f 6e74  te_restraintCont
-0001bb30: 6578 7429 3a0a 2020 2020 2020 2020 7365  ext):.        se
-0001bb40: 7149 6431 203d 2069 6e74 2873 7472 2863  qId1 = int(str(c
-0001bb50: 7478 2e49 6e74 6567 6572 2829 2929 0a20  tx.Integer())). 
-0001bb60: 2020 2020 2020 2061 746f 6d49 6431 203d         atomId1 =
-0001bb70: 2073 7472 2863 7478 2e53 696d 706c 655f   str(ctx.Simple_
-0001bb80: 6e61 6d65 2830 2929 2e75 7070 6572 2829  name(0)).upper()
-0001bb90: 0a20 2020 2020 2020 206f 7070 6f73 696e  .        opposin
-0001bba0: 6743 6861 696e 4964 203d 2073 7472 2863  gChainId = str(c
-0001bbb0: 7478 2e53 696d 706c 655f 6e61 6d65 2831  tx.Simple_name(1
-0001bbc0: 2929 2e75 7070 6572 2829 0a0a 2020 2020  )).upper()..    
-0001bbd0: 2020 2020 6473 7446 756e 6320 3d20 7365      dstFunc = se
-0001bbe0: 6c66 2e76 616c 6964 6174 6544 6973 7461  lf.validateDista
-0001bbf0: 6e63 6552 616e 6765 2831 2e30 290a 0a20  nceRange(1.0).. 
-0001bc00: 2020 2020 2020 2069 6620 6473 7446 756e         if dstFun
-0001bc10: 6320 6973 204e 6f6e 653a 0a20 2020 2020  c is None:.     
-0001bc20: 2020 2020 2020 2072 6574 7572 6e0a 0a20         return.. 
-0001bc30: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
-0001bc40: 6c66 2e5f 5f68 6173 506f 6c79 5365 713a  lf.__hasPolySeq:
-0001bc50: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0001bc60: 7572 6e0a 0a20 2020 2020 2020 2073 656c  urn..        sel
-0001bc70: 662e 5f5f 7265 7472 6965 7665 4c6f 6361  f.__retrieveLoca
-0001bc80: 6c53 6571 5363 6865 6d65 2829 0a0a 2020  lSeqScheme()..  
-0001bc90: 2020 2020 2020 6368 6169 6e41 7373 6967        chainAssig
-0001bca0: 6e31 203d 2073 656c 662e 6173 7369 676e  n1 = self.assign
-0001bcb0: 436f 6f72 6450 6f6c 796d 6572 5365 7175  CoordPolymerSequ
-0001bcc0: 656e 6365 2873 6571 4964 312c 2061 746f  ence(seqId1, ato
-0001bcd0: 6d49 6431 290a 0a20 2020 2020 2020 2069  mId1)..        i
-0001bce0: 6620 6c65 6e28 6368 6169 6e41 7373 6967  f len(chainAssig
-0001bcf0: 6e31 2920 3d3d 2030 3a0a 2020 2020 2020  n1) == 0:.      
-0001bd00: 2020 2020 2020 7265 7475 726e 0a0a 2020        return..  
-0001bd10: 2020 2020 2020 7365 6c66 2e73 656c 6563        self.selec
-0001bd20: 7443 6f6f 7264 4174 6f6d 7328 6368 6169  tCoordAtoms(chai
-0001bd30: 6e41 7373 6967 6e31 2c20 7365 7149 6431  nAssign1, seqId1
-0001bd40: 2c20 6174 6f6d 4964 3129 0a0a 2020 2020  , atomId1)..    
-0001bd50: 2020 2020 6966 206c 656e 2873 656c 662e      if len(self.
-0001bd60: 6174 6f6d 5365 6c65 6374 696f 6e53 6574  atomSelectionSet
-0001bd70: 2920 3c20 313a 0a20 2020 2020 2020 2020  ) < 1:.         
-0001bd80: 2020 2072 6574 7572 6e0a 0a20 2020 2020     return..     
-0001bd90: 2020 2069 6620 6e6f 7420 7365 6c66 2e5f     if not self._
-0001bda0: 5f70 7265 6665 7241 7574 6853 6571 3a0a  _preferAuthSeq:.
-0001bdb0: 2020 2020 2020 2020 2020 2020 7073 203d              ps =
-0001bdc0: 206e 6578 7428 2870 7320 666f 7220 7073   next((ps for ps
-0001bdd0: 2069 6e20 7365 6c66 2e5f 5f70 6f6c 7953   in self.__polyS
-0001bde0: 6571 2069 6620 7073 5b27 6368 6169 6e5f  eq if ps['chain_
-0001bdf0: 6964 275d 203d 3d20 6f70 706f 7369 6e67  id'] == opposing
-0001be00: 4368 6169 6e49 6429 2c20 4e6f 6e65 290a  ChainId), None).
-0001be10: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0001be20: 2020 2020 2020 2020 2020 7073 203d 206e            ps = n
-0001be30: 6578 7428 2870 7320 666f 7220 7073 2069  ext((ps for ps i
-0001be40: 6e20 7365 6c66 2e5f 5f70 6f6c 7953 6571  n self.__polySeq
-0001be50: 2069 6620 7073 5b27 6175 7468 5f63 6861   if ps['auth_cha
-0001be60: 696e 5f69 6427 5d20 3d3d 206f 7070 6f73  in_id'] == oppos
-0001be70: 696e 6743 6861 696e 4964 292c 204e 6f6e  ingChainId), Non
-0001be80: 6529 0a0a 2020 2020 2020 2020 6966 2070  e)..        if p
-0001be90: 7320 6973 204e 6f6e 653a 0a20 2020 2020  s is None:.     
-0001bea0: 2020 2020 2020 2073 656c 662e 5f5f 662e         self.__f.
-0001beb0: 6170 7065 6e64 2866 225b 496e 7661 6c69  append(f"[Invali
-0001bec0: 6420 6461 7461 5d20 7b73 656c 662e 5f5f  d data] {self.__
-0001bed0: 6765 7443 7572 7265 6e74 5265 7374 7261  getCurrentRestra
-0001bee0: 696e 7428 297d 220a 2020 2020 2020 2020  int()}".        
-0001bef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bf00: 2020 2020 6622 5468 6520 6f70 706f 7369      f"The opposi
-0001bf10: 6e67 2063 6861 696e 207b 6f70 706f 7369  ng chain {opposi
-0001bf20: 6e67 4368 6169 6e49 6421 727d 2069 7320  ngChainId!r} is 
-0001bf30: 6e6f 7420 666f 756e 6420 696e 2074 6865  not found in the
-0001bf40: 2063 6f6f 7264 696e 6174 6573 2e22 290a   coordinates.").
-0001bf50: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001bf60: 726e 0a0a 2020 2020 2020 2020 666f 7220  rn..        for 
-0001bf70: 6174 6f6d 3120 696e 2073 656c 662e 6174  atom1 in self.at
-0001bf80: 6f6d 5365 6c65 6374 696f 6e53 6574 5b30  omSelectionSet[0
-0001bf90: 5d3a 0a20 2020 2020 2020 2020 2020 2063  ]:.            c
-0001bfa0: 6861 696e 4964 203d 2061 746f 6d31 5b27  hainId = atom1['
-0001bfb0: 6368 6169 6e5f 6964 275d 0a20 2020 2020  chain_id'].     
-0001bfc0: 2020 2020 2020 2069 6620 6368 6169 6e49         if chainI
-0001bfd0: 6420 3d3d 206f 7070 6f73 696e 6743 6861  d == opposingCha
-0001bfe0: 696e 4964 3a0a 2020 2020 2020 2020 2020  inId:.          
-0001bff0: 2020 2020 2020 7365 6c66 2e5f 5f66 2e61        self.__f.a
-0001c000: 7070 656e 6428 6622 5b49 6e76 616c 6964  ppend(f"[Invalid
-0001c010: 2064 6174 615d 207b 7365 6c66 2e5f 5f67   data] {self.__g
-0001c020: 6574 4375 7272 656e 7452 6573 7472 6169  etCurrentRestrai
-0001c030: 6e74 2829 7d22 0a20 2020 2020 2020 2020  nt()}".         
-0001c040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c050: 2020 2020 2020 2066 2254 6865 2073 656c         f"The sel
-0001c060: 6563 7465 6420 6174 6f6d 207b 6368 6169  ected atom {chai
-0001c070: 6e49 647d 3a7b 6174 6f6d 315b 2773 6571  nId}:{atom1['seq
-0001c080: 5f69 6427 5d7d 3a7b 6174 6f6d 315b 2763  _id']}:{atom1['c
-0001c090: 6f6d 705f 6964 275d 7d3a 7b61 746f 6d31  omp_id']}:{atom1
-0001c0a0: 5b27 6174 6f6d 5f69 6427 5d7d 2022 0a20  ['atom_id']} ". 
-0001c0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c0c0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0001c0d0: 226d 7573 7420 6e6f 7420 696e 2074 6865  "must not in the
-0001c0e0: 206f 7070 6f73 696e 6720 6368 6169 6e20   opposing chain 
-0001c0f0: 7b6f 7070 6f73 696e 6743 6861 696e 4964  {opposingChainId
-0001c100: 2172 7d2e 2229 0a20 2020 2020 2020 2020  !r}.").         
-0001c110: 2020 2020 2020 2072 6574 7572 6e0a 0a20         return.. 
-0001c120: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
-0001c130: 5f63 7265 6174 6553 6644 6963 743a 0a20  _createSfDict:. 
-0001c140: 2020 2020 2020 2020 2020 2073 6620 3d20             sf = 
-0001c150: 7365 6c66 2e5f 5f67 6574 5366 2827 616d  self.__getSf('am
-0001c160: 6269 6775 6f75 7320 7369 7465 2072 6573  biguous site res
-0001c170: 7472 6169 6e74 2028 6174 6f6d 2074 6f20  traint (atom to 
-0001c180: 6f74 6865 7220 6368 6169 6e29 2c20 524f  other chain), RO
-0001c190: 5345 5454 4120 5369 7465 436f 6e73 7472  SETTA SiteConstr
-0001c1a0: 6169 6e74 2729 0a20 2020 2020 2020 2020  aint').         
-0001c1b0: 2020 2073 665b 2769 6427 5d20 2b3d 2031     sf['id'] += 1
-0001c1c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001c1d0: 6c65 6e28 7366 5b27 6c6f 6f70 275d 5b27  len(sf['loop']['
-0001c1e0: 7461 6773 275d 2920 3d3d 2030 3a0a 2020  tags']) == 0:.  
-0001c1f0: 2020 2020 2020 2020 2020 2020 2020 7366                sf
-0001c200: 5b27 6c6f 6f70 275d 5b27 7461 6773 275d  ['loop']['tags']
-0001c210: 203d 205b 2769 6e64 6578 5f69 6427 2c20   = ['index_id', 
-0001c220: 2769 6427 2c0a 2020 2020 2020 2020 2020  'id',.          
-0001c230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c240: 2020 2020 2020 2020 2020 2020 2761 7574              'aut
-0001c250: 685f 6173 796d 5f69 6427 2c20 2761 7574  h_asym_id', 'aut
-0001c260: 685f 7365 715f 6964 272c 2027 6175 7468  h_seq_id', 'auth
-0001c270: 5f63 6f6d 705f 6964 272c 2027 6175 7468  _comp_id', 'auth
-0001c280: 5f61 746f 6d5f 6964 272c 0a20 2020 2020  _atom_id',.     
-0001c290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c2b0: 2027 6f70 706f 7369 6e67 5f61 7574 685f   'opposing_auth_
-0001c2c0: 6173 796d 5f69 6427 2c0a 2020 2020 2020  asym_id',.      
-0001c2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b680: 2020 2020 2020 2020 2020 2020 2073 665b               sf[
+0001b690: 276c 6973 745f 6964 275d 2c20 7365 6c66  'list_id'], self
+0001b6a0: 2e5f 5f65 6e74 7279 4964 5d29 0a0a 2020  .__entryId])..  
+0001b6b0: 2020 2020 2020 6578 6365 7074 2056 616c        except Val
+0001b6c0: 7565 4572 726f 723a 0a20 2020 2020 2020  ueError:.       
+0001b6d0: 2020 2020 2073 656c 662e 6765 6f52 6573       self.geoRes
+0001b6e0: 7472 6169 6e74 7320 2d3d 2031 0a20 2020  traints -= 1.   
+0001b6f0: 2020 2020 2066 696e 616c 6c79 3a0a 2020       finally:.  
+0001b700: 2020 2020 2020 2020 2020 7365 6c66 2e6e            self.n
+0001b710: 756d 6265 7253 656c 6563 7469 6f6e 2e63  umberSelection.c
+0001b720: 6c65 6172 2829 0a0a 2020 2020 2320 456e  lear()..    # En
+0001b730: 7465 7220 6120 7061 7273 6520 7472 6565  ter a parse tree
+0001b740: 2070 726f 6475 6365 6420 6279 2052 6f73   produced by Ros
+0001b750: 6574 7461 4d52 5061 7273 6572 2373 6974  ettaMRParser#sit
+0001b760: 655f 7265 7374 7261 696e 7473 2e0a 2020  e_restraints..  
+0001b770: 2020 6465 6620 656e 7465 7253 6974 655f    def enterSite_
+0001b780: 7265 7374 7261 696e 7473 2873 656c 662c  restraints(self,
+0001b790: 2063 7478 3a20 526f 7365 7474 614d 5250   ctx: RosettaMRP
+0001b7a0: 6172 7365 722e 5369 7465 5f72 6573 7472  arser.Site_restr
+0001b7b0: 6169 6e74 7343 6f6e 7465 7874 293a 2020  aintsContext):  
+0001b7c0: 2320 7079 6c69 6e74 3a20 6469 7361 626c  # pylint: disabl
+0001b7d0: 653d 756e 7573 6564 2d61 7267 756d 656e  e=unused-argumen
+0001b7e0: 740a 2020 2020 2020 2020 7365 6c66 2e5f  t.        self._
+0001b7f0: 5f63 7572 5f73 7562 7479 7065 203d 2027  _cur_subtype = '
+0001b800: 6765 6f27 0a0a 2020 2020 2320 4578 6974  geo'..    # Exit
+0001b810: 2061 2070 6172 7365 2074 7265 6520 7072   a parse tree pr
+0001b820: 6f64 7563 6564 2062 7920 526f 7365 7474  oduced by Rosett
+0001b830: 614d 5250 6172 7365 7223 7369 7465 5f72  aMRParser#site_r
+0001b840: 6573 7472 6169 6e74 732e 0a20 2020 2064  estraints..    d
+0001b850: 6566 2065 7869 7453 6974 655f 7265 7374  ef exitSite_rest
+0001b860: 7261 696e 7473 2873 656c 662c 2063 7478  raints(self, ctx
+0001b870: 3a20 526f 7365 7474 614d 5250 6172 7365  : RosettaMRParse
+0001b880: 722e 5369 7465 5f72 6573 7472 6169 6e74  r.Site_restraint
+0001b890: 7343 6f6e 7465 7874 293a 2020 2320 7079  sContext):  # py
+0001b8a0: 6c69 6e74 3a20 6469 7361 626c 653d 756e  lint: disable=un
+0001b8b0: 7573 6564 2d61 7267 756d 656e 740a 2020  used-argument.  
+0001b8c0: 2020 2020 2020 7061 7373 0a0a 2020 2020        pass..    
+0001b8d0: 2320 456e 7465 7220 6120 7061 7273 6520  # Enter a parse 
+0001b8e0: 7472 6565 2070 726f 6475 6365 6420 6279  tree produced by
+0001b8f0: 2052 6f73 6574 7461 4d52 5061 7273 6572   RosettaMRParser
+0001b900: 2373 6974 655f 7265 7374 7261 696e 742e  #site_restraint.
+0001b910: 0a20 2020 2064 6566 2065 6e74 6572 5369  .    def enterSi
+0001b920: 7465 5f72 6573 7472 6169 6e74 2873 656c  te_restraint(sel
+0001b930: 662c 2063 7478 3a20 526f 7365 7474 614d  f, ctx: RosettaM
+0001b940: 5250 6172 7365 722e 5369 7465 5f72 6573  RParser.Site_res
+0001b950: 7472 6169 6e74 436f 6e74 6578 7429 3a20  traintContext): 
+0001b960: 2023 2070 796c 696e 743a 2064 6973 6162   # pylint: disab
+0001b970: 6c65 3d75 6e75 7365 642d 6172 6775 6d65  le=unused-argume
+0001b980: 6e74 0a20 2020 2020 2020 2073 656c 662e  nt.        self.
+0001b990: 6765 6f52 6573 7472 6169 6e74 7320 2b3d  geoRestraints +=
+0001b9a0: 2031 0a0a 2020 2020 2020 2020 7365 6c66   1..        self
+0001b9b0: 2e73 7461 636b 4675 6e63 732e 636c 6561  .stackFuncs.clea
+0001b9c0: 7228 290a 2020 2020 2020 2020 7365 6c66  r().        self
+0001b9d0: 2e61 746f 6d53 656c 6563 7469 6f6e 5365  .atomSelectionSe
+0001b9e0: 742e 636c 6561 7228 290a 0a20 2020 2023  t.clear()..    #
+0001b9f0: 2045 7869 7420 6120 7061 7273 6520 7472   Exit a parse tr
+0001ba00: 6565 2070 726f 6475 6365 6420 6279 2052  ee produced by R
+0001ba10: 6f73 6574 7461 4d52 5061 7273 6572 2373  osettaMRParser#s
+0001ba20: 6974 655f 7265 7374 7261 696e 742e 0a20  ite_restraint.. 
+0001ba30: 2020 2064 6566 2065 7869 7453 6974 655f     def exitSite_
+0001ba40: 7265 7374 7261 696e 7428 7365 6c66 2c20  restraint(self, 
+0001ba50: 6374 783a 2052 6f73 6574 7461 4d52 5061  ctx: RosettaMRPa
+0001ba60: 7273 6572 2e53 6974 655f 7265 7374 7261  rser.Site_restra
+0001ba70: 696e 7443 6f6e 7465 7874 293a 0a20 2020  intContext):.   
+0001ba80: 2020 2020 2073 6571 4964 3120 3d20 696e       seqId1 = in
+0001ba90: 7428 7374 7228 6374 782e 496e 7465 6765  t(str(ctx.Intege
+0001baa0: 7228 2929 290a 2020 2020 2020 2020 6174  r())).        at
+0001bab0: 6f6d 4964 3120 3d20 7374 7228 6374 782e  omId1 = str(ctx.
+0001bac0: 5369 6d70 6c65 5f6e 616d 6528 3029 292e  Simple_name(0)).
+0001bad0: 7570 7065 7228 290a 2020 2020 2020 2020  upper().        
+0001bae0: 6f70 706f 7369 6e67 4368 6169 6e49 6420  opposingChainId 
+0001baf0: 3d20 7374 7228 6374 782e 5369 6d70 6c65  = str(ctx.Simple
+0001bb00: 5f6e 616d 6528 3129 292e 7570 7065 7228  _name(1)).upper(
+0001bb10: 290a 0a20 2020 2020 2020 2064 7374 4675  )..        dstFu
+0001bb20: 6e63 203d 2073 656c 662e 7661 6c69 6461  nc = self.valida
+0001bb30: 7465 4469 7374 616e 6365 5261 6e67 6528  teDistanceRange(
+0001bb40: 312e 3029 0a0a 2020 2020 2020 2020 6966  1.0)..        if
+0001bb50: 2064 7374 4675 6e63 2069 7320 4e6f 6e65   dstFunc is None
+0001bb60: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0001bb70: 7475 726e 0a0a 2020 2020 2020 2020 6966  turn..        if
+0001bb80: 206e 6f74 2073 656c 662e 5f5f 6861 7350   not self.__hasP
+0001bb90: 6f6c 7953 6571 3a0a 2020 2020 2020 2020  olySeq:.        
+0001bba0: 2020 2020 7265 7475 726e 0a0a 2020 2020      return..    
+0001bbb0: 2020 2020 7365 6c66 2e5f 5f72 6574 7269      self.__retri
+0001bbc0: 6576 654c 6f63 616c 5365 7153 6368 656d  eveLocalSeqSchem
+0001bbd0: 6528 290a 0a20 2020 2020 2020 2063 6861  e()..        cha
+0001bbe0: 696e 4173 7369 676e 3120 3d20 7365 6c66  inAssign1 = self
+0001bbf0: 2e61 7373 6967 6e43 6f6f 7264 506f 6c79  .assignCoordPoly
+0001bc00: 6d65 7253 6571 7565 6e63 6528 7365 7149  merSequence(seqI
+0001bc10: 6431 2c20 6174 6f6d 4964 3129 0a0a 2020  d1, atomId1)..  
+0001bc20: 2020 2020 2020 6966 206c 656e 2863 6861        if len(cha
+0001bc30: 696e 4173 7369 676e 3129 203d 3d20 303a  inAssign1) == 0:
+0001bc40: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0001bc50: 7572 6e0a 0a20 2020 2020 2020 2073 656c  urn..        sel
+0001bc60: 662e 7365 6c65 6374 436f 6f72 6441 746f  f.selectCoordAto
+0001bc70: 6d73 2863 6861 696e 4173 7369 676e 312c  ms(chainAssign1,
+0001bc80: 2073 6571 4964 312c 2061 746f 6d49 6431   seqId1, atomId1
+0001bc90: 290a 0a20 2020 2020 2020 2069 6620 6c65  )..        if le
+0001bca0: 6e28 7365 6c66 2e61 746f 6d53 656c 6563  n(self.atomSelec
+0001bcb0: 7469 6f6e 5365 7429 203c 2031 3a0a 2020  tionSet) < 1:.  
+0001bcc0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001bcd0: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+0001bce0: 2073 656c 662e 5f5f 7072 6566 6572 4175   self.__preferAu
+0001bcf0: 7468 5365 713a 0a20 2020 2020 2020 2020  thSeq:.         
+0001bd00: 2020 2070 7320 3d20 6e65 7874 2828 7073     ps = next((ps
+0001bd10: 2066 6f72 2070 7320 696e 2073 656c 662e   for ps in self.
+0001bd20: 5f5f 706f 6c79 5365 7120 6966 2070 735b  __polySeq if ps[
+0001bd30: 2763 6861 696e 5f69 6427 5d20 3d3d 206f  'chain_id'] == o
+0001bd40: 7070 6f73 696e 6743 6861 696e 4964 292c  pposingChainId),
+0001bd50: 204e 6f6e 6529 0a20 2020 2020 2020 2065   None).        e
+0001bd60: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0001bd70: 2070 7320 3d20 6e65 7874 2828 7073 2066   ps = next((ps f
+0001bd80: 6f72 2070 7320 696e 2073 656c 662e 5f5f  or ps in self.__
+0001bd90: 706f 6c79 5365 7120 6966 2070 735b 2761  polySeq if ps['a
+0001bda0: 7574 685f 6368 6169 6e5f 6964 275d 203d  uth_chain_id'] =
+0001bdb0: 3d20 6f70 706f 7369 6e67 4368 6169 6e49  = opposingChainI
+0001bdc0: 6429 2c20 4e6f 6e65 290a 0a20 2020 2020  d), None)..     
+0001bdd0: 2020 2069 6620 7073 2069 7320 4e6f 6e65     if ps is None
+0001bde0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+0001bdf0: 6c66 2e5f 5f66 2e61 7070 656e 6428 6622  lf.__f.append(f"
+0001be00: 5b49 6e76 616c 6964 2064 6174 615d 207b  [Invalid data] {
+0001be10: 7365 6c66 2e5f 5f67 6574 4375 7272 656e  self.__getCurren
+0001be20: 7452 6573 7472 6169 6e74 2829 7d22 0a20  tRestraint()}". 
+0001be30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001be40: 2020 2020 2020 2020 2020 2066 2254 6865             f"The
+0001be50: 206f 7070 6f73 696e 6720 6368 6169 6e20   opposing chain 
+0001be60: 7b6f 7070 6f73 696e 6743 6861 696e 4964  {opposingChainId
+0001be70: 2172 7d20 6973 206e 6f74 2066 6f75 6e64  !r} is not found
+0001be80: 2069 6e20 7468 6520 636f 6f72 6469 6e61   in the coordina
+0001be90: 7465 732e 2229 0a20 2020 2020 2020 2020  tes.").         
+0001bea0: 2020 2072 6574 7572 6e0a 0a20 2020 2020     return..     
+0001beb0: 2020 2066 6f72 2061 746f 6d31 2069 6e20     for atom1 in 
+0001bec0: 7365 6c66 2e61 746f 6d53 656c 6563 7469  self.atomSelecti
+0001bed0: 6f6e 5365 745b 305d 3a0a 2020 2020 2020  onSet[0]:.      
+0001bee0: 2020 2020 2020 6368 6169 6e49 6420 3d20        chainId = 
+0001bef0: 6174 6f6d 315b 2763 6861 696e 5f69 6427  atom1['chain_id'
+0001bf00: 5d0a 2020 2020 2020 2020 2020 2020 6966  ].            if
+0001bf10: 2063 6861 696e 4964 203d 3d20 6f70 706f   chainId == oppo
+0001bf20: 7369 6e67 4368 6169 6e49 643a 0a20 2020  singChainId:.   
+0001bf30: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0001bf40: 662e 5f5f 662e 6170 7065 6e64 2866 225b  f.__f.append(f"[
+0001bf50: 496e 7661 6c69 6420 6461 7461 5d20 7b73  Invalid data] {s
+0001bf60: 656c 662e 5f5f 6765 7443 7572 7265 6e74  elf.__getCurrent
+0001bf70: 5265 7374 7261 696e 7428 297d 220a 2020  Restraint()}".  
+0001bf80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bf90: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+0001bfa0: 5468 6520 7365 6c65 6374 6564 2061 746f  The selected ato
+0001bfb0: 6d20 7b63 6861 696e 4964 7d3a 7b61 746f  m {chainId}:{ato
+0001bfc0: 6d31 5b27 7365 715f 6964 275d 7d3a 7b61  m1['seq_id']}:{a
+0001bfd0: 746f 6d31 5b27 636f 6d70 5f69 6427 5d7d  tom1['comp_id']}
+0001bfe0: 3a7b 6174 6f6d 315b 2761 746f 6d5f 6964  :{atom1['atom_id
+0001bff0: 275d 7d20 220a 2020 2020 2020 2020 2020  ']} ".          
+0001c000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c010: 2020 2020 2020 6622 6d75 7374 206e 6f74        f"must not
+0001c020: 2069 6e20 7468 6520 6f70 706f 7369 6e67   in the opposing
+0001c030: 2063 6861 696e 207b 6f70 706f 7369 6e67   chain {opposing
+0001c040: 4368 6169 6e49 6421 727d 2e22 290a 2020  ChainId!r}.").  
+0001c050: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0001c060: 7475 726e 0a0a 2020 2020 2020 2020 6966  turn..        if
+0001c070: 2073 656c 662e 5f5f 6372 6561 7465 5366   self.__createSf
+0001c080: 4469 6374 3a0a 2020 2020 2020 2020 2020  Dict:.          
+0001c090: 2020 7366 203d 2073 656c 662e 5f5f 6765    sf = self.__ge
+0001c0a0: 7453 6628 2761 6d62 6967 756f 7573 2073  tSf('ambiguous s
+0001c0b0: 6974 6520 7265 7374 7261 696e 7420 2861  ite restraint (a
+0001c0c0: 746f 6d20 746f 206f 7468 6572 2063 6861  tom to other cha
+0001c0d0: 696e 292c 2052 4f53 4554 5441 2053 6974  in), ROSETTA Sit
+0001c0e0: 6543 6f6e 7374 7261 696e 7427 290a 2020  eConstraint').  
+0001c0f0: 2020 2020 2020 2020 2020 7366 5b27 6964            sf['id
+0001c100: 275d 202b 3d20 310a 2020 2020 2020 2020  '] += 1.        
+0001c110: 2020 2020 6966 206c 656e 2873 665b 276c      if len(sf['l
+0001c120: 6f6f 7027 5d5b 2774 6167 7327 5d29 203d  oop']['tags']) =
+0001c130: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
+0001c140: 2020 2020 2073 665b 276c 6f6f 7027 5d5b       sf['loop'][
+0001c150: 2774 6167 7327 5d20 3d20 5b27 696e 6465  'tags'] = ['inde
+0001c160: 785f 6964 272c 2027 6964 272c 0a20 2020  x_id', 'id',.   
+0001c170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c190: 2020 2027 6175 7468 5f61 7379 6d5f 6964     'auth_asym_id
+0001c1a0: 272c 2027 6175 7468 5f73 6571 5f69 6427  ', 'auth_seq_id'
+0001c1b0: 2c20 2761 7574 685f 636f 6d70 5f69 6427  , 'auth_comp_id'
+0001c1c0: 2c20 2761 7574 685f 6174 6f6d 5f69 6427  , 'auth_atom_id'
+0001c1d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001c1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c1f0: 2020 2020 2020 2020 276f 7070 6f73 696e          'opposin
+0001c200: 675f 6175 7468 5f61 7379 6d5f 6964 272c  g_auth_asym_id',
+0001c210: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001c220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c230: 2020 2020 2020 2027 7461 7267 6574 5f76         'target_v
+0001c240: 616c 7565 272c 2027 7461 7267 6574 5f76  alue', 'target_v
+0001c250: 616c 7565 5f75 6e63 6572 7461 696e 7479  alue_uncertainty
+0001c260: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+0001c270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c280: 2020 2020 2020 2020 2027 6c6f 7765 725f           'lower_
+0001c290: 6c69 6e65 6172 5f6c 696d 6974 272c 2027  linear_limit', '
+0001c2a0: 6c6f 7765 725f 6c69 6d69 7427 2c20 2775  lower_limit', 'u
+0001c2b0: 7070 6572 5f6c 696d 6974 272c 2027 7570  pper_limit', 'up
+0001c2c0: 7065 725f 6c69 6e65 6172 5f6c 696d 6974  per_linear_limit
+0001c2d0: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
 0001c2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c2f0: 2774 6172 6765 745f 7661 6c75 6527 2c20  'target_value', 
-0001c300: 2774 6172 6765 745f 7661 6c75 655f 756e  'target_value_un
-0001c310: 6365 7274 6169 6e74 7927 2c0a 2020 2020  certainty',.    
-0001c320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c340: 2020 276c 6f77 6572 5f6c 696e 6561 725f    'lower_linear_
-0001c350: 6c69 6d69 7427 2c20 276c 6f77 6572 5f6c  limit', 'lower_l
-0001c360: 696d 6974 272c 2027 7570 7065 725f 6c69  imit', 'upper_li
-0001c370: 6d69 7427 2c20 2775 7070 6572 5f6c 696e  mit', 'upper_lin
-0001c380: 6561 725f 6c69 6d69 7427 2c0a 2020 2020  ear_limit',.    
-0001c390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c3b0: 2020 276c 6973 745f 6964 272c 2027 656e    'list_id', 'en
-0001c3c0: 7472 795f 6964 275d 0a0a 2020 2020 2020  try_id']..      
-0001c3d0: 2020 6966 2073 656c 662e 5f5f 6375 725f    if self.__cur_
-0001c3e0: 6e65 7374 2069 7320 6e6f 7420 4e6f 6e65  nest is not None
-0001c3f0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-0001c400: 2073 656c 662e 5f5f 6465 6275 673a 0a20   self.__debug:. 
-0001c410: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0001c420: 7269 6e74 2866 224e 4553 5445 443a 207b  rint(f"NESTED: {
-0001c430: 7365 6c66 2e5f 5f63 7572 5f6e 6573 747d  self.__cur_nest}
-0001c440: 2229 0a0a 2020 2020 2020 2020 666f 7220  ")..        for 
-0001c450: 6174 6f6d 3120 696e 2073 656c 662e 6174  atom1 in self.at
-0001c460: 6f6d 5365 6c65 6374 696f 6e53 6574 5b30  omSelectionSet[0
-0001c470: 5d3a 0a20 2020 2020 2020 2020 2020 2069  ]:.            i
-0001c480: 6620 7365 6c66 2e5f 5f64 6562 7567 3a0a  f self.__debug:.
-0001c490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c4a0: 7072 696e 7428 6622 7375 6274 7970 653d  print(f"subtype=
-0001c4b0: 7b73 656c 662e 5f5f 6375 725f 7375 6274  {self.__cur_subt
-0001c4c0: 7970 657d 2028 5369 7465 2920 6964 3d7b  ype} (Site) id={
-0001c4d0: 7365 6c66 2e67 656f 5265 7374 7261 696e  self.geoRestrain
-0001c4e0: 7473 7d20 220a 2020 2020 2020 2020 2020  ts} ".          
-0001c4f0: 2020 2020 2020 2020 2020 2020 6622 6174              f"at
-0001c500: 6f6d 3d7b 6174 6f6d 317d 206f 7070 6f73  om={atom1} oppos
-0001c510: 696e 6743 6861 696e 4964 3d7b 6f70 706f  ingChainId={oppo
-0001c520: 7369 6e67 4368 6169 6e49 647d 207b 6473  singChainId} {ds
-0001c530: 7446 756e 637d 2229 0a20 2020 2020 2020  tFunc}").       
-0001c540: 2020 2020 2069 6620 7365 6c66 2e5f 5f63       if self.__c
-0001c550: 7265 6174 6553 6644 6963 7420 616e 6420  reateSfDict and 
-0001c560: 7366 2069 7320 6e6f 7420 4e6f 6e65 3a0a  sf is not None:.
-0001c570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c580: 7366 5b27 696e 6465 785f 6964 275d 202b  sf['index_id'] +
-0001c590: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
-0001c5a0: 2020 2020 7366 5b27 6c6f 6f70 275d 5b27      sf['loop']['
-0001c5b0: 6461 7461 275d 2e61 7070 656e 6428 5b73  data'].append([s
-0001c5c0: 665b 2769 6e64 6578 5f69 6427 5d2c 2073  f['index_id'], s
-0001c5d0: 665b 2769 6427 5d2c 0a20 2020 2020 2020  f['id'],.       
+0001c2f0: 2020 2020 2020 2020 2027 6c69 7374 5f69           'list_i
+0001c300: 6427 2c20 2765 6e74 7279 5f69 6427 5d0a  d', 'entry_id'].
+0001c310: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+0001c320: 2e5f 5f63 7572 5f6e 6573 7420 6973 206e  .__cur_nest is n
+0001c330: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+0001c340: 2020 2020 2069 6620 7365 6c66 2e5f 5f64       if self.__d
+0001c350: 6562 7567 3a0a 2020 2020 2020 2020 2020  ebug:.          
+0001c360: 2020 2020 2020 7072 696e 7428 6622 4e45        print(f"NE
+0001c370: 5354 4544 3a20 7b73 656c 662e 5f5f 6375  STED: {self.__cu
+0001c380: 725f 6e65 7374 7d22 290a 0a20 2020 2020  r_nest}")..     
+0001c390: 2020 2066 6f72 2061 746f 6d31 2069 6e20     for atom1 in 
+0001c3a0: 7365 6c66 2e61 746f 6d53 656c 6563 7469  self.atomSelecti
+0001c3b0: 6f6e 5365 745b 305d 3a0a 2020 2020 2020  onSet[0]:.      
+0001c3c0: 2020 2020 2020 6966 2073 656c 662e 5f5f        if self.__
+0001c3d0: 6465 6275 673a 0a20 2020 2020 2020 2020  debug:.         
+0001c3e0: 2020 2020 2020 2070 7269 6e74 2866 2273         print(f"s
+0001c3f0: 7562 7479 7065 3d7b 7365 6c66 2e5f 5f63  ubtype={self.__c
+0001c400: 7572 5f73 7562 7479 7065 7d20 2853 6974  ur_subtype} (Sit
+0001c410: 6529 2069 643d 7b73 656c 662e 6765 6f52  e) id={self.geoR
+0001c420: 6573 7472 6169 6e74 737d 2022 0a20 2020  estraints} ".   
+0001c430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c440: 2020 2066 2261 746f 6d3d 7b61 746f 6d31     f"atom={atom1
+0001c450: 7d20 6f70 706f 7369 6e67 4368 6169 6e49  } opposingChainI
+0001c460: 643d 7b6f 7070 6f73 696e 6743 6861 696e  d={opposingChain
+0001c470: 4964 7d20 7b64 7374 4675 6e63 7d22 290a  Id} {dstFunc}").
+0001c480: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0001c490: 656c 662e 5f5f 6372 6561 7465 5366 4469  elf.__createSfDi
+0001c4a0: 6374 2061 6e64 2073 6620 6973 206e 6f74  ct and sf is not
+0001c4b0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0001c4c0: 2020 2020 2020 2073 665b 2769 6e64 6578         sf['index
+0001c4d0: 5f69 6427 5d20 2b3d 2031 0a20 2020 2020  _id'] += 1.     
+0001c4e0: 2020 2020 2020 2020 2020 2073 665b 276c             sf['l
+0001c4f0: 6f6f 7027 5d5b 2764 6174 6127 5d2e 6170  oop']['data'].ap
+0001c500: 7065 6e64 285b 7366 5b27 696e 6465 785f  pend([sf['index_
+0001c510: 6964 275d 2c20 7366 5b27 6964 275d 2c0a  id'], sf['id'],.
+0001c520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c540: 2020 2020 2020 2020 2020 2061 746f 6d31             atom1
+0001c550: 5b27 6368 6169 6e5f 6964 275d 2c20 6174  ['chain_id'], at
+0001c560: 6f6d 315b 2773 6571 5f69 6427 5d2c 2061  om1['seq_id'], a
+0001c570: 746f 6d31 5b27 636f 6d70 5f69 6427 5d2c  tom1['comp_id'],
+0001c580: 2061 746f 6d31 5b27 6174 6f6d 5f69 6427   atom1['atom_id'
+0001c590: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0001c5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c5b0: 2020 2020 2020 2020 2020 2020 2020 6f70                op
+0001c5c0: 706f 7369 6e67 4368 6169 6e49 642c 0a20  posingChainId,. 
+0001c5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001c5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c600: 2020 2020 6174 6f6d 315b 2763 6861 696e      atom1['chain
-0001c610: 5f69 6427 5d2c 2061 746f 6d31 5b27 7365  _id'], atom1['se
-0001c620: 715f 6964 275d 2c20 6174 6f6d 315b 2763  q_id'], atom1['c
-0001c630: 6f6d 705f 6964 275d 2c20 6174 6f6d 315b  omp_id'], atom1[
-0001c640: 2761 746f 6d5f 6964 275d 2c0a 2020 2020  'atom_id'],.    
-0001c650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c670: 2020 2020 2020 206f 7070 6f73 696e 6743         opposingC
-0001c680: 6861 696e 4964 2c0a 2020 2020 2020 2020  hainId,.        
-0001c690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c6b0: 2020 2064 7374 4675 6e63 5b27 7461 7267     dstFunc['targ
-0001c6c0: 6574 5f76 616c 7565 275d 2069 6620 2774  et_value'] if 't
-0001c6d0: 6172 6765 745f 7661 6c75 6527 2069 6e20  arget_value' in 
-0001c6e0: 6473 7446 756e 6320 656c 7365 204e 6f6e  dstFunc else Non
-0001c6f0: 652c 204e 6f6e 652c 0a20 2020 2020 2020  e, None,.       
+0001c5f0: 2020 2020 2020 2020 2020 6473 7446 756e            dstFun
+0001c600: 632e 6765 7428 2774 6172 6765 745f 7661  c.get('target_va
+0001c610: 6c75 6527 292c 204e 6f6e 652c 0a20 2020  lue'), None,.   
+0001c620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c640: 2020 2020 2020 2020 6473 7446 756e 632e          dstFunc.
+0001c650: 6765 7428 276c 6f77 6572 5f6c 696e 6561  get('lower_linea
+0001c660: 725f 6c69 6d69 7427 292c 0a20 2020 2020  r_limit'),.     
+0001c670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c690: 2020 2020 2020 6473 7446 756e 632e 6765        dstFunc.ge
+0001c6a0: 7428 276c 6f77 6572 5f6c 696d 6974 2729  t('lower_limit')
+0001c6b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001c6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c6d0: 2020 2020 2020 2020 2020 2020 2064 7374               dst
+0001c6e0: 4675 6e63 2e67 6574 2827 7570 7065 725f  Func.get('upper_
+0001c6f0: 6c69 6d69 7427 292c 0a20 2020 2020 2020  limit'),.       
 0001c700: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001c710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c720: 2020 2020 6473 7446 756e 635b 276c 6f77      dstFunc['low
-0001c730: 6572 5f6c 696e 6561 725f 6c69 6d69 7427  er_linear_limit'
-0001c740: 5d20 6966 2027 6c6f 7765 725f 6c69 6e65  ] if 'lower_line
-0001c750: 6172 5f6c 696d 6974 2720 696e 2064 7374  ar_limit' in dst
-0001c760: 4675 6e63 2065 6c73 6520 4e6f 6e65 2c0a  Func else None,.
-0001c770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c790: 2020 2020 2020 2020 2020 2064 7374 4675             dstFu
-0001c7a0: 6e63 5b27 6c6f 7765 725f 6c69 6d69 7427  nc['lower_limit'
-0001c7b0: 5d20 6966 2027 6c6f 7765 725f 6c69 6d69  ] if 'lower_limi
-0001c7c0: 7427 2069 6e20 6473 7446 756e 6320 656c  t' in dstFunc el
-0001c7d0: 7365 204e 6f6e 652c 0a20 2020 2020 2020  se None,.       
-0001c7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c800: 2020 2020 6473 7446 756e 635b 2775 7070      dstFunc['upp
-0001c810: 6572 5f6c 696d 6974 275d 2069 6620 2775  er_limit'] if 'u
-0001c820: 7070 6572 5f6c 696d 6974 2720 696e 2064  pper_limit' in d
-0001c830: 7374 4675 6e63 2065 6c73 6520 4e6f 6e65  stFunc else None
-0001c840: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001c850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c860: 2020 2020 2020 2020 2020 2020 2064 7374               dst
-0001c870: 4675 6e63 5b27 7570 7065 725f 6c69 6e65  Func['upper_line
-0001c880: 6172 5f6c 696d 6974 275d 2069 6620 2775  ar_limit'] if 'u
-0001c890: 7070 6572 5f6c 696e 6561 725f 6c69 6d69  pper_linear_limi
-0001c8a0: 7427 2069 6e20 6473 7446 756e 6320 656c  t' in dstFunc el
-0001c8b0: 7365 204e 6f6e 652c 0a20 2020 2020 2020  se None,.       
-0001c8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c8e0: 2020 2020 7366 5b27 6c69 7374 5f69 6427      sf['list_id'
-0001c8f0: 5d2c 2073 656c 662e 5f5f 656e 7472 7949  ], self.__entryI
-0001c900: 645d 290a 0a20 2020 2023 2045 6e74 6572  d])..    # Enter
-0001c910: 2061 2070 6172 7365 2074 7265 6520 7072   a parse tree pr
-0001c920: 6f64 7563 6564 2062 7920 526f 7365 7474  oduced by Rosett
-0001c930: 614d 5250 6172 7365 7223 7369 7465 5f72  aMRParser#site_r
-0001c940: 6573 6964 7565 735f 7265 7374 7261 696e  esidues_restrain
-0001c950: 7473 2e0a 2020 2020 6465 6620 656e 7465  ts..    def ente
-0001c960: 7253 6974 655f 7265 7369 6475 6573 5f72  rSite_residues_r
-0001c970: 6573 7472 6169 6e74 7328 7365 6c66 2c20  estraints(self, 
-0001c980: 6374 783a 2052 6f73 6574 7461 4d52 5061  ctx: RosettaMRPa
-0001c990: 7273 6572 2e53 6974 655f 7265 7369 6475  rser.Site_residu
-0001c9a0: 6573 5f72 6573 7472 6169 6e74 7343 6f6e  es_restraintsCon
-0001c9b0: 7465 7874 293a 2020 2320 7079 6c69 6e74  text):  # pylint
-0001c9c0: 3a20 6469 7361 626c 653d 756e 7573 6564  : disable=unused
-0001c9d0: 2d61 7267 756d 656e 740a 2020 2020 2020  -argument.      
-0001c9e0: 2020 7365 6c66 2e5f 5f63 7572 5f73 7562    self.__cur_sub
-0001c9f0: 7479 7065 203d 2027 6765 6f27 0a0a 2020  type = 'geo'..  
-0001ca00: 2020 2320 4578 6974 2061 2070 6172 7365    # Exit a parse
-0001ca10: 2074 7265 6520 7072 6f64 7563 6564 2062   tree produced b
-0001ca20: 7920 526f 7365 7474 614d 5250 6172 7365  y RosettaMRParse
-0001ca30: 7223 7369 7465 5f72 6573 6964 7565 735f  r#site_residues_
-0001ca40: 7265 7374 7261 696e 7473 2e0a 2020 2020  restraints..    
-0001ca50: 6465 6620 6578 6974 5369 7465 5f72 6573  def exitSite_res
-0001ca60: 6964 7565 735f 7265 7374 7261 696e 7473  idues_restraints
-0001ca70: 2873 656c 662c 2063 7478 3a20 526f 7365  (self, ctx: Rose
-0001ca80: 7474 614d 5250 6172 7365 722e 5369 7465  ttaMRParser.Site
-0001ca90: 5f72 6573 6964 7565 735f 7265 7374 7261  _residues_restra
-0001caa0: 696e 7473 436f 6e74 6578 7429 3a20 2023  intsContext):  #
-0001cab0: 2070 796c 696e 743a 2064 6973 6162 6c65   pylint: disable
-0001cac0: 3d75 6e75 7365 642d 6172 6775 6d65 6e74  =unused-argument
-0001cad0: 0a20 2020 2020 2020 2070 6173 730a 0a20  .        pass.. 
-0001cae0: 2020 2023 2045 6e74 6572 2061 2070 6172     # Enter a par
-0001caf0: 7365 2074 7265 6520 7072 6f64 7563 6564  se tree produced
-0001cb00: 2062 7920 526f 7365 7474 614d 5250 6172   by RosettaMRPar
-0001cb10: 7365 7223 7369 7465 5f72 6573 6964 7565  ser#site_residue
-0001cb20: 735f 7265 7374 7261 696e 742e 0a20 2020  s_restraint..   
-0001cb30: 2064 6566 2065 6e74 6572 5369 7465 5f72   def enterSite_r
-0001cb40: 6573 6964 7565 735f 7265 7374 7261 696e  esidues_restrain
-0001cb50: 7428 7365 6c66 2c20 6374 783a 2052 6f73  t(self, ctx: Ros
-0001cb60: 6574 7461 4d52 5061 7273 6572 2e53 6974  ettaMRParser.Sit
-0001cb70: 655f 7265 7369 6475 6573 5f72 6573 7472  e_residues_restr
-0001cb80: 6169 6e74 436f 6e74 6578 7429 3a20 2023  aintContext):  #
-0001cb90: 2070 796c 696e 743a 2064 6973 6162 6c65   pylint: disable
-0001cba0: 3d75 6e75 7365 642d 6172 6775 6d65 6e74  =unused-argument
-0001cbb0: 0a20 2020 2020 2020 2073 656c 662e 6765  .        self.ge
-0001cbc0: 6f52 6573 7472 6169 6e74 7320 2b3d 2031  oRestraints += 1
-0001cbd0: 0a0a 2020 2020 2020 2020 7365 6c66 2e73  ..        self.s
-0001cbe0: 7461 636b 4675 6e63 732e 636c 6561 7228  tackFuncs.clear(
-0001cbf0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-0001cc00: 746f 6d53 656c 6563 7469 6f6e 5365 742e  tomSelectionSet.
-0001cc10: 636c 6561 7228 290a 0a20 2020 2023 2045  clear()..    # E
-0001cc20: 7869 7420 6120 7061 7273 6520 7472 6565  xit a parse tree
-0001cc30: 2070 726f 6475 6365 6420 6279 2052 6f73   produced by Ros
-0001cc40: 6574 7461 4d52 5061 7273 6572 2373 6974  ettaMRParser#sit
-0001cc50: 655f 7265 7369 6475 6573 5f72 6573 7472  e_residues_restr
-0001cc60: 6169 6e74 2e0a 2020 2020 6465 6620 6578  aint..    def ex
-0001cc70: 6974 5369 7465 5f72 6573 6964 7565 735f  itSite_residues_
-0001cc80: 7265 7374 7261 696e 7428 7365 6c66 2c20  restraint(self, 
-0001cc90: 6374 783a 2052 6f73 6574 7461 4d52 5061  ctx: RosettaMRPa
-0001cca0: 7273 6572 2e53 6974 655f 7265 7369 6475  rser.Site_residu
-0001ccb0: 6573 5f72 6573 7472 6169 6e74 436f 6e74  es_restraintCont
-0001ccc0: 6578 7429 3a0a 2020 2020 2020 2020 7365  ext):.        se
-0001ccd0: 7149 6431 203d 2069 6e74 2873 7472 2863  qId1 = int(str(c
-0001cce0: 7478 2e49 6e74 6567 6572 2830 2929 290a  tx.Integer(0))).
-0001ccf0: 2020 2020 2020 2020 6174 6f6d 4964 3120          atomId1 
-0001cd00: 3d20 7374 7228 6374 782e 5369 6d70 6c65  = str(ctx.Simple
-0001cd10: 5f6e 616d 6528 2929 2e75 7070 6572 2829  _name()).upper()
-0001cd20: 0a20 2020 2020 2020 2073 6571 4964 3220  .        seqId2 
-0001cd30: 3d20 696e 7428 7374 7228 6374 782e 496e  = int(str(ctx.In
-0001cd40: 7465 6765 7228 3129 2929 0a20 2020 2020  teger(1))).     
-0001cd50: 2020 2073 6571 4964 3320 3d20 696e 7428     seqId3 = int(
-0001cd60: 7374 7228 6374 782e 496e 7465 6765 7228  str(ctx.Integer(
-0001cd70: 3229 2929 0a0a 2020 2020 2020 2020 6473  2)))..        ds
-0001cd80: 7446 756e 6320 3d20 7365 6c66 2e76 616c  tFunc = self.val
-0001cd90: 6964 6174 6544 6973 7461 6e63 6552 616e  idateDistanceRan
-0001cda0: 6765 2831 2e30 290a 0a20 2020 2020 2020  ge(1.0)..       
-0001cdb0: 2069 6620 6473 7446 756e 6320 6973 204e   if dstFunc is N
-0001cdc0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0001cdd0: 2072 6574 7572 6e0a 0a20 2020 2020 2020   return..       
-0001cde0: 2069 6620 6e6f 7420 7365 6c66 2e5f 5f68   if not self.__h
-0001cdf0: 6173 506f 6c79 5365 713a 0a20 2020 2020  asPolySeq:.     
-0001ce00: 2020 2020 2020 2072 6574 7572 6e0a 0a20         return.. 
-0001ce10: 2020 2020 2020 2073 656c 662e 5f5f 7265         self.__re
-0001ce20: 7472 6965 7665 4c6f 6361 6c53 6571 5363  trieveLocalSeqSc
-0001ce30: 6865 6d65 2829 0a0a 2020 2020 2020 2020  heme()..        
-0001ce40: 6368 6169 6e41 7373 6967 6e31 203d 2073  chainAssign1 = s
-0001ce50: 656c 662e 6173 7369 676e 436f 6f72 6450  elf.assignCoordP
-0001ce60: 6f6c 796d 6572 5365 7175 656e 6365 2873  olymerSequence(s
-0001ce70: 6571 4964 312c 2061 746f 6d49 6431 290a  eqId1, atomId1).
-0001ce80: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
-0001ce90: 6368 6169 6e41 7373 6967 6e31 2920 3d3d  chainAssign1) ==
-0001cea0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-0001ceb0: 7265 7475 726e 0a0a 2020 2020 2020 2020  return..        
-0001cec0: 7365 6c66 2e73 656c 6563 7443 6f6f 7264  self.selectCoord
-0001ced0: 4174 6f6d 7328 6368 6169 6e41 7373 6967  Atoms(chainAssig
-0001cee0: 6e31 2c20 7365 7149 6431 2c20 6174 6f6d  n1, seqId1, atom
-0001cef0: 4964 3129 0a0a 2020 2020 2020 2020 6966  Id1)..        if
-0001cf00: 206c 656e 2873 656c 662e 6174 6f6d 5365   len(self.atomSe
-0001cf10: 6c65 6374 696f 6e53 6574 2920 3c20 313a  lectionSet) < 1:
-0001cf20: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0001cf30: 7572 6e0a 0a20 2020 2020 2020 2063 6861  urn..        cha
-0001cf40: 696e 4173 7369 676e 3220 3d20 7365 6c66  inAssign2 = self
-0001cf50: 2e61 7373 6967 6e43 6f6f 7264 506f 6c79  .assignCoordPoly
-0001cf60: 6d65 7253 6571 7565 6e63 6528 7365 7149  merSequence(seqI
-0001cf70: 6432 290a 2020 2020 2020 2020 6368 6169  d2).        chai
-0001cf80: 6e41 7373 6967 6e33 203d 2073 656c 662e  nAssign3 = self.
-0001cf90: 6173 7369 676e 436f 6f72 6450 6f6c 796d  assignCoordPolym
-0001cfa0: 6572 5365 7175 656e 6365 2873 6571 4964  erSequence(seqId
-0001cfb0: 3329 0a0a 2020 2020 2020 2020 6966 206c  3)..        if l
-0001cfc0: 656e 2863 6861 696e 4173 7369 676e 3229  en(chainAssign2)
-0001cfd0: 203d 3d20 3020 6f72 206c 656e 2863 6861   == 0 or len(cha
-0001cfe0: 696e 4173 7369 676e 3329 203d 3d20 303a  inAssign3) == 0:
-0001cff0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0001d000: 7572 6e0a 0a20 2020 2020 2020 2073 656c  urn..        sel
-0001d010: 662e 7365 6c65 6374 436f 6f72 6452 6573  f.selectCoordRes
-0001d020: 6964 7565 7328 6368 6169 6e41 7373 6967  idues(chainAssig
-0001d030: 6e32 2c20 7365 7149 6432 290a 2020 2020  n2, seqId2).    
-0001d040: 2020 2020 7365 6c66 2e73 656c 6563 7443      self.selectC
-0001d050: 6f6f 7264 5265 7369 6475 6573 2863 6861  oordResidues(cha
-0001d060: 696e 4173 7369 676e 332c 2073 6571 4964  inAssign3, seqId
-0001d070: 3329 0a0a 2020 2020 2020 2020 6966 206c  3)..        if l
-0001d080: 656e 2873 656c 662e 6174 6f6d 5365 6c65  en(self.atomSele
-0001d090: 6374 696f 6e53 6574 2920 3c20 333a 0a20  ctionSet) < 3:. 
-0001d0a0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0001d0b0: 6e0a 0a20 2020 2020 2020 2069 6620 7365  n..        if se
-0001d0c0: 6c66 2e5f 5f63 7265 6174 6553 6644 6963  lf.__createSfDic
-0001d0d0: 743a 0a20 2020 2020 2020 2020 2020 2073  t:.            s
-0001d0e0: 6620 3d20 7365 6c66 2e5f 5f67 6574 5366  f = self.__getSf
-0001d0f0: 2827 616d 6269 6775 6f75 7320 7369 7465  ('ambiguous site
-0001d100: 2072 6573 7472 6169 6e74 2028 6174 6f6d   restraint (atom
-0001d110: 2074 6f20 6f74 6865 7220 7265 7369 6475   to other residu
-0001d120: 6529 2c20 524f 5345 5454 4120 5369 7465  e), ROSETTA Site
-0001d130: 436f 6e73 7472 6169 6e74 5265 7369 6475  ConstraintResidu
-0001d140: 6573 2729 0a20 2020 2020 2020 2020 2020  es').           
-0001d150: 2073 665b 2769 6427 5d20 2b3d 2031 0a20   sf['id'] += 1. 
-0001d160: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-0001d170: 6e28 7366 5b27 6c6f 6f70 275d 5b27 7461  n(sf['loop']['ta
-0001d180: 6773 275d 2920 3d3d 2030 3a0a 2020 2020  gs']) == 0:.    
-0001d190: 2020 2020 2020 2020 2020 2020 7366 5b27              sf['
-0001d1a0: 6c6f 6f70 275d 5b27 7461 6773 275d 203d  loop']['tags'] =
-0001d1b0: 205b 2769 6e64 6578 5f69 6427 2c20 2769   ['index_id', 'i
-0001d1c0: 6427 2c0a 2020 2020 2020 2020 2020 2020  d',.            
-0001d1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d1e0: 2020 2020 2020 2020 2020 2761 7574 685f            'auth_
-0001d1f0: 6173 796d 5f69 6427 2c20 2761 7574 685f  asym_id', 'auth_
-0001d200: 7365 715f 6964 272c 2027 6175 7468 5f63  seq_id', 'auth_c
-0001d210: 6f6d 705f 6964 272c 2027 6175 7468 5f61  omp_id', 'auth_a
-0001d220: 746f 6d5f 6964 272c 0a20 2020 2020 2020  tom_id',.       
-0001d230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d240: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0001d250: 696e 7465 7261 6374 696e 675f 6175 7468  interacting_auth
-0001d260: 5f61 7379 6d5f 6964 5f31 272c 2027 696e  _asym_id_1', 'in
-0001d270: 7465 7261 6374 696e 675f 6175 7468 5f73  teracting_auth_s
-0001d280: 6571 5f69 645f 3127 2c20 2769 6e74 6572  eq_id_1', 'inter
-0001d290: 6163 7469 6e67 5f61 7574 685f 636f 6d70  acting_auth_comp
-0001d2a0: 5f69 645f 3127 2c0a 2020 2020 2020 2020  _id_1',.        
-0001d2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d2c0: 2020 2020 2020 2020 2020 2020 2020 2769                'i
-0001d2d0: 6e74 6572 6163 7469 6e67 5f61 7574 685f  nteracting_auth_
-0001d2e0: 6173 796d 5f69 645f 3227 2c20 2769 6e74  asym_id_2', 'int
-0001d2f0: 6572 6163 7469 6e67 5f61 7574 685f 7365  eracting_auth_se
-0001d300: 715f 6964 5f32 272c 2027 696e 7465 7261  q_id_2', 'intera
-0001d310: 6374 696e 675f 6175 7468 5f63 6f6d 705f  cting_auth_comp_
-0001d320: 6964 5f32 272c 0a20 2020 2020 2020 2020  id_2',.         
-0001d330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d340: 2020 2020 2020 2020 2020 2020 2027 7461               'ta
-0001d350: 7267 6574 5f76 616c 7565 272c 2027 7461  rget_value', 'ta
-0001d360: 7267 6574 5f76 616c 7565 5f75 6e63 6572  rget_value_uncer
-0001d370: 7461 696e 7479 272c 0a20 2020 2020 2020  tainty',.       
+0001c720: 2020 2020 6473 7446 756e 632e 6765 7428      dstFunc.get(
+0001c730: 2775 7070 6572 5f6c 696e 6561 725f 6c69  'upper_linear_li
+0001c740: 6d69 7427 292c 0a20 2020 2020 2020 2020  mit'),.         
+0001c750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c770: 2020 7366 5b27 6c69 7374 5f69 6427 5d2c    sf['list_id'],
+0001c780: 2073 656c 662e 5f5f 656e 7472 7949 645d   self.__entryId]
+0001c790: 290a 0a20 2020 2023 2045 6e74 6572 2061  )..    # Enter a
+0001c7a0: 2070 6172 7365 2074 7265 6520 7072 6f64   parse tree prod
+0001c7b0: 7563 6564 2062 7920 526f 7365 7474 614d  uced by RosettaM
+0001c7c0: 5250 6172 7365 7223 7369 7465 5f72 6573  RParser#site_res
+0001c7d0: 6964 7565 735f 7265 7374 7261 696e 7473  idues_restraints
+0001c7e0: 2e0a 2020 2020 6465 6620 656e 7465 7253  ..    def enterS
+0001c7f0: 6974 655f 7265 7369 6475 6573 5f72 6573  ite_residues_res
+0001c800: 7472 6169 6e74 7328 7365 6c66 2c20 6374  traints(self, ct
+0001c810: 783a 2052 6f73 6574 7461 4d52 5061 7273  x: RosettaMRPars
+0001c820: 6572 2e53 6974 655f 7265 7369 6475 6573  er.Site_residues
+0001c830: 5f72 6573 7472 6169 6e74 7343 6f6e 7465  _restraintsConte
+0001c840: 7874 293a 2020 2320 7079 6c69 6e74 3a20  xt):  # pylint: 
+0001c850: 6469 7361 626c 653d 756e 7573 6564 2d61  disable=unused-a
+0001c860: 7267 756d 656e 740a 2020 2020 2020 2020  rgument.        
+0001c870: 7365 6c66 2e5f 5f63 7572 5f73 7562 7479  self.__cur_subty
+0001c880: 7065 203d 2027 6765 6f27 0a0a 2020 2020  pe = 'geo'..    
+0001c890: 2320 4578 6974 2061 2070 6172 7365 2074  # Exit a parse t
+0001c8a0: 7265 6520 7072 6f64 7563 6564 2062 7920  ree produced by 
+0001c8b0: 526f 7365 7474 614d 5250 6172 7365 7223  RosettaMRParser#
+0001c8c0: 7369 7465 5f72 6573 6964 7565 735f 7265  site_residues_re
+0001c8d0: 7374 7261 696e 7473 2e0a 2020 2020 6465  straints..    de
+0001c8e0: 6620 6578 6974 5369 7465 5f72 6573 6964  f exitSite_resid
+0001c8f0: 7565 735f 7265 7374 7261 696e 7473 2873  ues_restraints(s
+0001c900: 656c 662c 2063 7478 3a20 526f 7365 7474  elf, ctx: Rosett
+0001c910: 614d 5250 6172 7365 722e 5369 7465 5f72  aMRParser.Site_r
+0001c920: 6573 6964 7565 735f 7265 7374 7261 696e  esidues_restrain
+0001c930: 7473 436f 6e74 6578 7429 3a20 2023 2070  tsContext):  # p
+0001c940: 796c 696e 743a 2064 6973 6162 6c65 3d75  ylint: disable=u
+0001c950: 6e75 7365 642d 6172 6775 6d65 6e74 0a20  nused-argument. 
+0001c960: 2020 2020 2020 2070 6173 730a 0a20 2020         pass..   
+0001c970: 2023 2045 6e74 6572 2061 2070 6172 7365   # Enter a parse
+0001c980: 2074 7265 6520 7072 6f64 7563 6564 2062   tree produced b
+0001c990: 7920 526f 7365 7474 614d 5250 6172 7365  y RosettaMRParse
+0001c9a0: 7223 7369 7465 5f72 6573 6964 7565 735f  r#site_residues_
+0001c9b0: 7265 7374 7261 696e 742e 0a20 2020 2064  restraint..    d
+0001c9c0: 6566 2065 6e74 6572 5369 7465 5f72 6573  ef enterSite_res
+0001c9d0: 6964 7565 735f 7265 7374 7261 696e 7428  idues_restraint(
+0001c9e0: 7365 6c66 2c20 6374 783a 2052 6f73 6574  self, ctx: Roset
+0001c9f0: 7461 4d52 5061 7273 6572 2e53 6974 655f  taMRParser.Site_
+0001ca00: 7265 7369 6475 6573 5f72 6573 7472 6169  residues_restrai
+0001ca10: 6e74 436f 6e74 6578 7429 3a20 2023 2070  ntContext):  # p
+0001ca20: 796c 696e 743a 2064 6973 6162 6c65 3d75  ylint: disable=u
+0001ca30: 6e75 7365 642d 6172 6775 6d65 6e74 0a20  nused-argument. 
+0001ca40: 2020 2020 2020 2073 656c 662e 6765 6f52         self.geoR
+0001ca50: 6573 7472 6169 6e74 7320 2b3d 2031 0a0a  estraints += 1..
+0001ca60: 2020 2020 2020 2020 7365 6c66 2e73 7461          self.sta
+0001ca70: 636b 4675 6e63 732e 636c 6561 7228 290a  ckFuncs.clear().
+0001ca80: 2020 2020 2020 2020 7365 6c66 2e61 746f          self.ato
+0001ca90: 6d53 656c 6563 7469 6f6e 5365 742e 636c  mSelectionSet.cl
+0001caa0: 6561 7228 290a 0a20 2020 2023 2045 7869  ear()..    # Exi
+0001cab0: 7420 6120 7061 7273 6520 7472 6565 2070  t a parse tree p
+0001cac0: 726f 6475 6365 6420 6279 2052 6f73 6574  roduced by Roset
+0001cad0: 7461 4d52 5061 7273 6572 2373 6974 655f  taMRParser#site_
+0001cae0: 7265 7369 6475 6573 5f72 6573 7472 6169  residues_restrai
+0001caf0: 6e74 2e0a 2020 2020 6465 6620 6578 6974  nt..    def exit
+0001cb00: 5369 7465 5f72 6573 6964 7565 735f 7265  Site_residues_re
+0001cb10: 7374 7261 696e 7428 7365 6c66 2c20 6374  straint(self, ct
+0001cb20: 783a 2052 6f73 6574 7461 4d52 5061 7273  x: RosettaMRPars
+0001cb30: 6572 2e53 6974 655f 7265 7369 6475 6573  er.Site_residues
+0001cb40: 5f72 6573 7472 6169 6e74 436f 6e74 6578  _restraintContex
+0001cb50: 7429 3a0a 2020 2020 2020 2020 7365 7149  t):.        seqI
+0001cb60: 6431 203d 2069 6e74 2873 7472 2863 7478  d1 = int(str(ctx
+0001cb70: 2e49 6e74 6567 6572 2830 2929 290a 2020  .Integer(0))).  
+0001cb80: 2020 2020 2020 6174 6f6d 4964 3120 3d20        atomId1 = 
+0001cb90: 7374 7228 6374 782e 5369 6d70 6c65 5f6e  str(ctx.Simple_n
+0001cba0: 616d 6528 2929 2e75 7070 6572 2829 0a20  ame()).upper(). 
+0001cbb0: 2020 2020 2020 2073 6571 4964 3220 3d20         seqId2 = 
+0001cbc0: 696e 7428 7374 7228 6374 782e 496e 7465  int(str(ctx.Inte
+0001cbd0: 6765 7228 3129 2929 0a20 2020 2020 2020  ger(1))).       
+0001cbe0: 2073 6571 4964 3320 3d20 696e 7428 7374   seqId3 = int(st
+0001cbf0: 7228 6374 782e 496e 7465 6765 7228 3229  r(ctx.Integer(2)
+0001cc00: 2929 0a0a 2020 2020 2020 2020 6473 7446  ))..        dstF
+0001cc10: 756e 6320 3d20 7365 6c66 2e76 616c 6964  unc = self.valid
+0001cc20: 6174 6544 6973 7461 6e63 6552 616e 6765  ateDistanceRange
+0001cc30: 2831 2e30 290a 0a20 2020 2020 2020 2069  (1.0)..        i
+0001cc40: 6620 6473 7446 756e 6320 6973 204e 6f6e  f dstFunc is Non
+0001cc50: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+0001cc60: 6574 7572 6e0a 0a20 2020 2020 2020 2069  eturn..        i
+0001cc70: 6620 6e6f 7420 7365 6c66 2e5f 5f68 6173  f not self.__has
+0001cc80: 506f 6c79 5365 713a 0a20 2020 2020 2020  PolySeq:.       
+0001cc90: 2020 2020 2072 6574 7572 6e0a 0a20 2020       return..   
+0001cca0: 2020 2020 2073 656c 662e 5f5f 7265 7472       self.__retr
+0001ccb0: 6965 7665 4c6f 6361 6c53 6571 5363 6865  ieveLocalSeqSche
+0001ccc0: 6d65 2829 0a0a 2020 2020 2020 2020 6368  me()..        ch
+0001ccd0: 6169 6e41 7373 6967 6e31 203d 2073 656c  ainAssign1 = sel
+0001cce0: 662e 6173 7369 676e 436f 6f72 6450 6f6c  f.assignCoordPol
+0001ccf0: 796d 6572 5365 7175 656e 6365 2873 6571  ymerSequence(seq
+0001cd00: 4964 312c 2061 746f 6d49 6431 290a 0a20  Id1, atomId1).. 
+0001cd10: 2020 2020 2020 2069 6620 6c65 6e28 6368         if len(ch
+0001cd20: 6169 6e41 7373 6967 6e31 2920 3d3d 2030  ainAssign1) == 0
+0001cd30: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0001cd40: 7475 726e 0a0a 2020 2020 2020 2020 7365  turn..        se
+0001cd50: 6c66 2e73 656c 6563 7443 6f6f 7264 4174  lf.selectCoordAt
+0001cd60: 6f6d 7328 6368 6169 6e41 7373 6967 6e31  oms(chainAssign1
+0001cd70: 2c20 7365 7149 6431 2c20 6174 6f6d 4964  , seqId1, atomId
+0001cd80: 3129 0a0a 2020 2020 2020 2020 6966 206c  1)..        if l
+0001cd90: 656e 2873 656c 662e 6174 6f6d 5365 6c65  en(self.atomSele
+0001cda0: 6374 696f 6e53 6574 2920 3c20 313a 0a20  ctionSet) < 1:. 
+0001cdb0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0001cdc0: 6e0a 0a20 2020 2020 2020 2063 6861 696e  n..        chain
+0001cdd0: 4173 7369 676e 3220 3d20 7365 6c66 2e61  Assign2 = self.a
+0001cde0: 7373 6967 6e43 6f6f 7264 506f 6c79 6d65  ssignCoordPolyme
+0001cdf0: 7253 6571 7565 6e63 6528 7365 7149 6432  rSequence(seqId2
+0001ce00: 290a 2020 2020 2020 2020 6368 6169 6e41  ).        chainA
+0001ce10: 7373 6967 6e33 203d 2073 656c 662e 6173  ssign3 = self.as
+0001ce20: 7369 676e 436f 6f72 6450 6f6c 796d 6572  signCoordPolymer
+0001ce30: 5365 7175 656e 6365 2873 6571 4964 3329  Sequence(seqId3)
+0001ce40: 0a0a 2020 2020 2020 2020 6966 206c 656e  ..        if len
+0001ce50: 2863 6861 696e 4173 7369 676e 3229 203d  (chainAssign2) =
+0001ce60: 3d20 3020 6f72 206c 656e 2863 6861 696e  = 0 or len(chain
+0001ce70: 4173 7369 676e 3329 203d 3d20 303a 0a20  Assign3) == 0:. 
+0001ce80: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0001ce90: 6e0a 0a20 2020 2020 2020 2073 656c 662e  n..        self.
+0001cea0: 7365 6c65 6374 436f 6f72 6452 6573 6964  selectCoordResid
+0001ceb0: 7565 7328 6368 6169 6e41 7373 6967 6e32  ues(chainAssign2
+0001cec0: 2c20 7365 7149 6432 290a 2020 2020 2020  , seqId2).      
+0001ced0: 2020 7365 6c66 2e73 656c 6563 7443 6f6f    self.selectCoo
+0001cee0: 7264 5265 7369 6475 6573 2863 6861 696e  rdResidues(chain
+0001cef0: 4173 7369 676e 332c 2073 6571 4964 3329  Assign3, seqId3)
+0001cf00: 0a0a 2020 2020 2020 2020 6966 206c 656e  ..        if len
+0001cf10: 2873 656c 662e 6174 6f6d 5365 6c65 6374  (self.atomSelect
+0001cf20: 696f 6e53 6574 2920 3c20 333a 0a20 2020  ionSet) < 3:.   
+0001cf30: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
+0001cf40: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+0001cf50: 2e5f 5f63 7265 6174 6553 6644 6963 743a  .__createSfDict:
+0001cf60: 0a20 2020 2020 2020 2020 2020 2073 6620  .            sf 
+0001cf70: 3d20 7365 6c66 2e5f 5f67 6574 5366 2827  = self.__getSf('
+0001cf80: 616d 6269 6775 6f75 7320 7369 7465 2072  ambiguous site r
+0001cf90: 6573 7472 6169 6e74 2028 6174 6f6d 2074  estraint (atom t
+0001cfa0: 6f20 6f74 6865 7220 7265 7369 6475 6529  o other residue)
+0001cfb0: 2c20 524f 5345 5454 4120 5369 7465 436f  , ROSETTA SiteCo
+0001cfc0: 6e73 7472 6169 6e74 5265 7369 6475 6573  nstraintResidues
+0001cfd0: 2729 0a20 2020 2020 2020 2020 2020 2073  ').            s
+0001cfe0: 665b 2769 6427 5d20 2b3d 2031 0a20 2020  f['id'] += 1.   
+0001cff0: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
+0001d000: 7366 5b27 6c6f 6f70 275d 5b27 7461 6773  sf['loop']['tags
+0001d010: 275d 2920 3d3d 2030 3a0a 2020 2020 2020  ']) == 0:.      
+0001d020: 2020 2020 2020 2020 2020 7366 5b27 6c6f            sf['lo
+0001d030: 6f70 275d 5b27 7461 6773 275d 203d 205b  op']['tags'] = [
+0001d040: 2769 6e64 6578 5f69 6427 2c20 2769 6427  'index_id', 'id'
+0001d050: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001d060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d070: 2020 2020 2020 2020 2761 7574 685f 6173          'auth_as
+0001d080: 796d 5f69 6427 2c20 2761 7574 685f 7365  ym_id', 'auth_se
+0001d090: 715f 6964 272c 2027 6175 7468 5f63 6f6d  q_id', 'auth_com
+0001d0a0: 705f 6964 272c 2027 6175 7468 5f61 746f  p_id', 'auth_ato
+0001d0b0: 6d5f 6964 272c 0a20 2020 2020 2020 2020  m_id',.         
+0001d0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d0d0: 2020 2020 2020 2020 2020 2020 2027 696e               'in
+0001d0e0: 7465 7261 6374 696e 675f 6175 7468 5f61  teracting_auth_a
+0001d0f0: 7379 6d5f 6964 5f31 272c 2027 696e 7465  sym_id_1', 'inte
+0001d100: 7261 6374 696e 675f 6175 7468 5f73 6571  racting_auth_seq
+0001d110: 5f69 645f 3127 2c20 2769 6e74 6572 6163  _id_1', 'interac
+0001d120: 7469 6e67 5f61 7574 685f 636f 6d70 5f69  ting_auth_comp_i
+0001d130: 645f 3127 2c0a 2020 2020 2020 2020 2020  d_1',.          
+0001d140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d150: 2020 2020 2020 2020 2020 2020 2769 6e74              'int
+0001d160: 6572 6163 7469 6e67 5f61 7574 685f 6173  eracting_auth_as
+0001d170: 796d 5f69 645f 3227 2c20 2769 6e74 6572  ym_id_2', 'inter
+0001d180: 6163 7469 6e67 5f61 7574 685f 7365 715f  acting_auth_seq_
+0001d190: 6964 5f32 272c 2027 696e 7465 7261 6374  id_2', 'interact
+0001d1a0: 696e 675f 6175 7468 5f63 6f6d 705f 6964  ing_auth_comp_id
+0001d1b0: 5f32 272c 0a20 2020 2020 2020 2020 2020  _2',.           
+0001d1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d1d0: 2020 2020 2020 2020 2020 2027 7461 7267             'targ
+0001d1e0: 6574 5f76 616c 7565 272c 2027 7461 7267  et_value', 'targ
+0001d1f0: 6574 5f76 616c 7565 5f75 6e63 6572 7461  et_value_uncerta
+0001d200: 696e 7479 272c 0a20 2020 2020 2020 2020  inty',.         
+0001d210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d220: 2020 2020 2020 2020 2020 2020 2027 6c6f               'lo
+0001d230: 7765 725f 6c69 6e65 6172 5f6c 696d 6974  wer_linear_limit
+0001d240: 272c 2027 6c6f 7765 725f 6c69 6d69 7427  ', 'lower_limit'
+0001d250: 2c20 2775 7070 6572 5f6c 696d 6974 272c  , 'upper_limit',
+0001d260: 2027 7570 7065 725f 6c69 6e65 6172 5f6c   'upper_linear_l
+0001d270: 696d 6974 272c 0a20 2020 2020 2020 2020  imit',.         
+0001d280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d290: 2020 2020 2020 2020 2020 2020 2027 6c69               'li
+0001d2a0: 7374 5f69 6427 2c20 2765 6e74 7279 5f69  st_id', 'entry_i
+0001d2b0: 6427 5d0a 0a20 2020 2020 2020 2069 6620  d']..        if 
+0001d2c0: 7365 6c66 2e5f 5f63 7572 5f6e 6573 7420  self.__cur_nest 
+0001d2d0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0001d2e0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+0001d2f0: 2e5f 5f64 6562 7567 3a0a 2020 2020 2020  .__debug:.      
+0001d300: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+0001d310: 6622 4e45 5354 4544 3a20 7b73 656c 662e  f"NESTED: {self.
+0001d320: 5f5f 6375 725f 6e65 7374 7d22 290a 0a20  __cur_nest}").. 
+0001d330: 2020 2020 2020 2066 6f72 2061 746f 6d31         for atom1
+0001d340: 2c20 7265 7332 2c20 7265 7333 2069 6e20  , res2, res3 in 
+0001d350: 6974 6572 746f 6f6c 732e 7072 6f64 7563  itertools.produc
+0001d360: 7428 7365 6c66 2e61 746f 6d53 656c 6563  t(self.atomSelec
+0001d370: 7469 6f6e 5365 745b 305d 2c0a 2020 2020  tionSet[0],.    
 0001d380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d390: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0001d3a0: 6c6f 7765 725f 6c69 6e65 6172 5f6c 696d  lower_linear_lim
-0001d3b0: 6974 272c 2027 6c6f 7765 725f 6c69 6d69  it', 'lower_limi
-0001d3c0: 7427 2c20 2775 7070 6572 5f6c 696d 6974  t', 'upper_limit
-0001d3d0: 272c 2027 7570 7065 725f 6c69 6e65 6172  ', 'upper_linear
-0001d3e0: 5f6c 696d 6974 272c 0a20 2020 2020 2020  _limit',.       
-0001d3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d400: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0001d410: 6c69 7374 5f69 6427 2c20 2765 6e74 7279  list_id', 'entry
-0001d420: 5f69 6427 5d0a 0a20 2020 2020 2020 2069  _id']..        i
-0001d430: 6620 7365 6c66 2e5f 5f63 7572 5f6e 6573  f self.__cur_nes
-0001d440: 7420 6973 206e 6f74 204e 6f6e 653a 0a20  t is not None:. 
-0001d450: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-0001d460: 6c66 2e5f 5f64 6562 7567 3a0a 2020 2020  lf.__debug:.    
-0001d470: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-0001d480: 7428 6622 4e45 5354 4544 3a20 7b73 656c  t(f"NESTED: {sel
-0001d490: 662e 5f5f 6375 725f 6e65 7374 7d22 290a  f.__cur_nest}").
-0001d4a0: 0a20 2020 2020 2020 2066 6f72 2061 746f  .        for ato
-0001d4b0: 6d31 2c20 7265 7332 2c20 7265 7333 2069  m1, res2, res3 i
-0001d4c0: 6e20 6974 6572 746f 6f6c 732e 7072 6f64  n itertools.prod
-0001d4d0: 7563 7428 7365 6c66 2e61 746f 6d53 656c  uct(self.atomSel
-0001d4e0: 6563 7469 6f6e 5365 745b 305d 2c0a 2020  ectionSet[0],.  
-0001d4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d520: 2073 656c 662e 6174 6f6d 5365 6c65 6374   self.atomSelect
-0001d530: 696f 6e53 6574 5b31 5d2c 0a20 2020 2020  ionSet[1],.     
-0001d540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d560: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001d570: 6c66 2e61 746f 6d53 656c 6563 7469 6f6e  lf.atomSelection
-0001d580: 5365 745b 325d 293a 0a20 2020 2020 2020  Set[2]):.       
-0001d590: 2020 2020 2069 6620 7365 6c66 2e5f 5f64       if self.__d
-0001d5a0: 6562 7567 3a0a 2020 2020 2020 2020 2020  ebug:.          
-0001d5b0: 2020 2020 2020 7072 696e 7428 6622 7375        print(f"su
-0001d5c0: 6274 7970 653d 7b73 656c 662e 5f5f 6375  btype={self.__cu
-0001d5d0: 725f 7375 6274 7970 657d 2028 5369 7465  r_subtype} (Site
-0001d5e0: 2d52 6573 6964 7565 2920 6964 3d7b 7365  -Residue) id={se
-0001d5f0: 6c66 2e67 656f 5265 7374 7261 696e 7473  lf.geoRestraints
-0001d600: 7d20 220a 2020 2020 2020 2020 2020 2020  } ".            
-0001d610: 2020 2020 2020 2020 2020 6622 6174 6f6d            f"atom
-0001d620: 313d 7b61 746f 6d31 7d20 7265 7369 6475  1={atom1} residu
-0001d630: 6532 3d7b 7265 7332 7d20 7265 7369 6475  e2={res2} residu
-0001d640: 6533 3d7b 7265 7333 7d20 7b64 7374 4675  e3={res3} {dstFu
-0001d650: 6e63 7d22 290a 2020 2020 2020 2020 2020  nc}").          
-0001d660: 2020 6966 2073 656c 662e 5f5f 6372 6561    if self.__crea
-0001d670: 7465 5366 4469 6374 2061 6e64 2073 6620  teSfDict and sf 
-0001d680: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-0001d690: 2020 2020 2020 2020 2020 2020 2073 665b               sf[
-0001d6a0: 2769 6e64 6578 5f69 6427 5d20 2b3d 2031  'index_id'] += 1
-0001d6b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d6c0: 2073 665b 276c 6f6f 7027 5d5b 2764 6174   sf['loop']['dat
-0001d6d0: 6127 5d2e 6170 7065 6e64 285b 7366 5b27  a'].append([sf['
-0001d6e0: 696e 6465 785f 6964 275d 2c20 7366 5b27  index_id'], sf['
-0001d6f0: 6964 275d 2c0a 2020 2020 2020 2020 2020  id'],.          
-0001d700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d3a0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001d3b0: 656c 662e 6174 6f6d 5365 6c65 6374 696f  elf.atomSelectio
+0001d3c0: 6e53 6574 5b31 5d2c 0a20 2020 2020 2020  nSet[1],.       
+0001d3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d3f0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001d400: 2e61 746f 6d53 656c 6563 7469 6f6e 5365  .atomSelectionSe
+0001d410: 745b 325d 293a 0a20 2020 2020 2020 2020  t[2]):.         
+0001d420: 2020 2069 6620 7365 6c66 2e5f 5f64 6562     if self.__deb
+0001d430: 7567 3a0a 2020 2020 2020 2020 2020 2020  ug:.            
+0001d440: 2020 2020 7072 696e 7428 6622 7375 6274      print(f"subt
+0001d450: 7970 653d 7b73 656c 662e 5f5f 6375 725f  ype={self.__cur_
+0001d460: 7375 6274 7970 657d 2028 5369 7465 2d52  subtype} (Site-R
+0001d470: 6573 6964 7565 2920 6964 3d7b 7365 6c66  esidue) id={self
+0001d480: 2e67 656f 5265 7374 7261 696e 7473 7d20  .geoRestraints} 
+0001d490: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0001d4a0: 2020 2020 2020 2020 6622 6174 6f6d 313d          f"atom1=
+0001d4b0: 7b61 746f 6d31 7d20 7265 7369 6475 6532  {atom1} residue2
+0001d4c0: 3d7b 7265 7332 7d20 7265 7369 6475 6533  ={res2} residue3
+0001d4d0: 3d7b 7265 7333 7d20 7b64 7374 4675 6e63  ={res3} {dstFunc
+0001d4e0: 7d22 290a 2020 2020 2020 2020 2020 2020  }").            
+0001d4f0: 6966 2073 656c 662e 5f5f 6372 6561 7465  if self.__create
+0001d500: 5366 4469 6374 2061 6e64 2073 6620 6973  SfDict and sf is
+0001d510: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+0001d520: 2020 2020 2020 2020 2020 2073 665b 2769             sf['i
+0001d530: 6e64 6578 5f69 6427 5d20 2b3d 2031 0a20  ndex_id'] += 1. 
+0001d540: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001d550: 665b 276c 6f6f 7027 5d5b 2764 6174 6127  f['loop']['data'
+0001d560: 5d2e 6170 7065 6e64 285b 7366 5b27 696e  ].append([sf['in
+0001d570: 6465 785f 6964 275d 2c20 7366 5b27 6964  dex_id'], sf['id
+0001d580: 275d 2c0a 2020 2020 2020 2020 2020 2020  '],.            
+0001d590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d5a0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0001d5b0: 746f 6d31 5b27 6368 6169 6e5f 6964 275d  tom1['chain_id']
+0001d5c0: 2c20 6174 6f6d 315b 2773 6571 5f69 6427  , atom1['seq_id'
+0001d5d0: 5d2c 2061 746f 6d31 5b27 636f 6d70 5f69  ], atom1['comp_i
+0001d5e0: 6427 5d2c 2061 746f 6d31 5b27 6174 6f6d  d'], atom1['atom
+0001d5f0: 5f69 6427 5d2c 0a20 2020 2020 2020 2020  _id'],.         
+0001d600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d620: 2020 7265 7332 5b27 6368 6169 6e5f 6964    res2['chain_id
+0001d630: 275d 2c20 7265 7332 5b27 7365 715f 6964  '], res2['seq_id
+0001d640: 275d 2c20 7265 7332 5b27 636f 6d70 5f69  '], res2['comp_i
+0001d650: 6427 5d2c 0a20 2020 2020 2020 2020 2020  d'],.           
+0001d660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d680: 7265 7333 5b27 6368 6169 6e5f 6964 275d  res3['chain_id']
+0001d690: 2c20 7265 7333 5b27 7365 715f 6964 275d  , res3['seq_id']
+0001d6a0: 2c20 7265 7333 5b27 636f 6d70 5f69 6427  , res3['comp_id'
+0001d6b0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0001d6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d6d0: 2020 2020 2020 2020 2020 2020 2020 6473                ds
+0001d6e0: 7446 756e 632e 6765 7428 2774 6172 6765  tFunc.get('targe
+0001d6f0: 745f 7661 6c75 6527 292c 204e 6f6e 652c  t_value'), None,
+0001d700: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 0001d710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d720: 2061 746f 6d31 5b27 6368 6169 6e5f 6964   atom1['chain_id
-0001d730: 275d 2c20 6174 6f6d 315b 2773 6571 5f69  '], atom1['seq_i
-0001d740: 6427 5d2c 2061 746f 6d31 5b27 636f 6d70  d'], atom1['comp
-0001d750: 5f69 6427 5d2c 2061 746f 6d31 5b27 6174  _id'], atom1['at
-0001d760: 6f6d 5f69 6427 5d2c 0a20 2020 2020 2020  om_id'],.       
-0001d770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d790: 2020 2020 7265 7332 5b27 6368 6169 6e5f      res2['chain_
-0001d7a0: 6964 275d 2c20 7265 7332 5b27 7365 715f  id'], res2['seq_
-0001d7b0: 6964 275d 2c20 7265 7332 5b27 636f 6d70  id'], res2['comp
-0001d7c0: 5f69 6427 5d2c 0a20 2020 2020 2020 2020  _id'],.         
-0001d7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d720: 2020 2020 2020 2020 2020 2020 6473 7446              dstF
+0001d730: 756e 632e 6765 7428 276c 6f77 6572 5f6c  unc.get('lower_l
+0001d740: 696e 6561 725f 6c69 6d69 7427 292c 0a20  inear_limit'),. 
+0001d750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d770: 2020 2020 2020 2020 2020 6473 7446 756e            dstFun
+0001d780: 632e 6765 7428 276c 6f77 6572 5f6c 696d  c.get('lower_lim
+0001d790: 6974 2729 2c0a 2020 2020 2020 2020 2020  it'),.          
+0001d7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d7c0: 2064 7374 4675 6e63 2e67 6574 2827 7570   dstFunc.get('up
+0001d7d0: 7065 725f 6c69 6d69 7427 292c 0a20 2020  per_limit'),.   
 0001d7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d7f0: 2020 7265 7333 5b27 6368 6169 6e5f 6964    res3['chain_id
-0001d800: 275d 2c20 7265 7333 5b27 7365 715f 6964  '], res3['seq_id
-0001d810: 275d 2c20 7265 7333 5b27 636f 6d70 5f69  '], res3['comp_i
-0001d820: 6427 5d2c 0a20 2020 2020 2020 2020 2020  d'],.           
+0001d7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d800: 2020 2020 2020 2020 6473 7446 756e 632e          dstFunc.
+0001d810: 6765 7428 2775 7070 6572 5f6c 696e 6561  get('upper_linea
+0001d820: 725f 6c69 6d69 7427 292c 0a20 2020 2020  r_limit'),.     
 0001d830: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001d840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d850: 6473 7446 756e 635b 2774 6172 6765 745f  dstFunc['target_
-0001d860: 7661 6c75 6527 5d20 6966 2027 7461 7267  value'] if 'targ
-0001d870: 6574 5f76 616c 7565 2720 696e 2064 7374  et_value' in dst
-0001d880: 4675 6e63 2065 6c73 6520 4e6f 6e65 2c20  Func else None, 
-0001d890: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-0001d8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d8c0: 2064 7374 4675 6e63 5b27 6c6f 7765 725f   dstFunc['lower_
-0001d8d0: 6c69 6e65 6172 5f6c 696d 6974 275d 2069  linear_limit'] i
-0001d8e0: 6620 276c 6f77 6572 5f6c 696e 6561 725f  f 'lower_linear_
-0001d8f0: 6c69 6d69 7427 2069 6e20 6473 7446 756e  limit' in dstFun
-0001d900: 6320 656c 7365 204e 6f6e 652c 0a20 2020  c else None,.   
-0001d910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d930: 2020 2020 2020 2020 6473 7446 756e 635b          dstFunc[
-0001d940: 276c 6f77 6572 5f6c 696d 6974 275d 2069  'lower_limit'] i
-0001d950: 6620 276c 6f77 6572 5f6c 696d 6974 2720  f 'lower_limit' 
-0001d960: 696e 2064 7374 4675 6e63 2065 6c73 6520  in dstFunc else 
-0001d970: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-0001d980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d9a0: 2064 7374 4675 6e63 5b27 7570 7065 725f   dstFunc['upper_
-0001d9b0: 6c69 6d69 7427 5d20 6966 2027 7570 7065  limit'] if 'uppe
-0001d9c0: 725f 6c69 6d69 7427 2069 6e20 6473 7446  r_limit' in dstF
-0001d9d0: 756e 6320 656c 7365 204e 6f6e 652c 0a20  unc else None,. 
-0001d9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001da00: 2020 2020 2020 2020 2020 6473 7446 756e            dstFun
-0001da10: 635b 2775 7070 6572 5f6c 696e 6561 725f  c['upper_linear_
-0001da20: 6c69 6d69 7427 5d20 6966 2027 7570 7065  limit'] if 'uppe
-0001da30: 725f 6c69 6e65 6172 5f6c 696d 6974 2720  r_linear_limit' 
-0001da40: 696e 2064 7374 4675 6e63 2065 6c73 6520  in dstFunc else 
-0001da50: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-0001da60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001da70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001da80: 2073 665b 276c 6973 745f 6964 275d 2c20   sf['list_id'], 
-0001da90: 7365 6c66 2e5f 5f65 6e74 7279 4964 5d29  self.__entryId])
-0001daa0: 0a0a 2020 2020 2320 456e 7465 7220 6120  ..    # Enter a 
-0001dab0: 7061 7273 6520 7472 6565 2070 726f 6475  parse tree produ
-0001dac0: 6365 6420 6279 2052 6f73 6574 7461 4d52  ced by RosettaMR
-0001dad0: 5061 7273 6572 236d 696e 5f72 6573 6964  Parser#min_resid
-0001dae0: 7565 5f61 746f 6d69 635f 6469 7374 616e  ue_atomic_distan
-0001daf0: 6365 5f72 6573 7472 6169 6e74 732e 0a20  ce_restraints.. 
-0001db00: 2020 2064 6566 2065 6e74 6572 4d69 6e5f     def enterMin_
-0001db10: 7265 7369 6475 655f 6174 6f6d 6963 5f64  residue_atomic_d
-0001db20: 6973 7461 6e63 655f 7265 7374 7261 696e  istance_restrain
-0001db30: 7473 2873 656c 662c 2063 7478 3a20 526f  ts(self, ctx: Ro
-0001db40: 7365 7474 614d 5250 6172 7365 722e 4d69  settaMRParser.Mi
-0001db50: 6e5f 7265 7369 6475 655f 6174 6f6d 6963  n_residue_atomic
-0001db60: 5f64 6973 7461 6e63 655f 7265 7374 7261  _distance_restra
-0001db70: 696e 7473 436f 6e74 6578 7429 3a20 2023  intsContext):  #
+0001d850: 2020 2020 2020 7366 5b27 6c69 7374 5f69        sf['list_i
+0001d860: 6427 5d2c 2073 656c 662e 5f5f 656e 7472  d'], self.__entr
+0001d870: 7949 645d 290a 0a20 2020 2023 2045 6e74  yId])..    # Ent
+0001d880: 6572 2061 2070 6172 7365 2074 7265 6520  er a parse tree 
+0001d890: 7072 6f64 7563 6564 2062 7920 526f 7365  produced by Rose
+0001d8a0: 7474 614d 5250 6172 7365 7223 6d69 6e5f  ttaMRParser#min_
+0001d8b0: 7265 7369 6475 655f 6174 6f6d 6963 5f64  residue_atomic_d
+0001d8c0: 6973 7461 6e63 655f 7265 7374 7261 696e  istance_restrain
+0001d8d0: 7473 2e0a 2020 2020 6465 6620 656e 7465  ts..    def ente
+0001d8e0: 724d 696e 5f72 6573 6964 7565 5f61 746f  rMin_residue_ato
+0001d8f0: 6d69 635f 6469 7374 616e 6365 5f72 6573  mic_distance_res
+0001d900: 7472 6169 6e74 7328 7365 6c66 2c20 6374  traints(self, ct
+0001d910: 783a 2052 6f73 6574 7461 4d52 5061 7273  x: RosettaMRPars
+0001d920: 6572 2e4d 696e 5f72 6573 6964 7565 5f61  er.Min_residue_a
+0001d930: 746f 6d69 635f 6469 7374 616e 6365 5f72  tomic_distance_r
+0001d940: 6573 7472 6169 6e74 7343 6f6e 7465 7874  estraintsContext
+0001d950: 293a 2020 2320 7079 6c69 6e74 3a20 6469  ):  # pylint: di
+0001d960: 7361 626c 653d 756e 7573 6564 2d61 7267  sable=unused-arg
+0001d970: 756d 656e 740a 2020 2020 2020 2020 7365  ument.        se
+0001d980: 6c66 2e5f 5f63 7572 5f73 7562 7479 7065  lf.__cur_subtype
+0001d990: 203d 2027 6765 6f27 0a0a 2020 2020 2320   = 'geo'..    # 
+0001d9a0: 4578 6974 2061 2070 6172 7365 2074 7265  Exit a parse tre
+0001d9b0: 6520 7072 6f64 7563 6564 2062 7920 526f  e produced by Ro
+0001d9c0: 7365 7474 614d 5250 6172 7365 7223 6d69  settaMRParser#mi
+0001d9d0: 6e5f 7265 7369 6475 655f 6174 6f6d 6963  n_residue_atomic
+0001d9e0: 5f64 6973 7461 6e63 655f 7265 7374 7261  _distance_restra
+0001d9f0: 696e 7473 2e0a 2020 2020 6465 6620 6578  ints..    def ex
+0001da00: 6974 4d69 6e5f 7265 7369 6475 655f 6174  itMin_residue_at
+0001da10: 6f6d 6963 5f64 6973 7461 6e63 655f 7265  omic_distance_re
+0001da20: 7374 7261 696e 7473 2873 656c 662c 2063  straints(self, c
+0001da30: 7478 3a20 526f 7365 7474 614d 5250 6172  tx: RosettaMRPar
+0001da40: 7365 722e 4d69 6e5f 7265 7369 6475 655f  ser.Min_residue_
+0001da50: 6174 6f6d 6963 5f64 6973 7461 6e63 655f  atomic_distance_
+0001da60: 7265 7374 7261 696e 7473 436f 6e74 6578  restraintsContex
+0001da70: 7429 3a20 2023 2070 796c 696e 743a 2064  t):  # pylint: d
+0001da80: 6973 6162 6c65 3d75 6e75 7365 642d 6172  isable=unused-ar
+0001da90: 6775 6d65 6e74 0a20 2020 2020 2020 2070  gument.        p
+0001daa0: 6173 730a 0a20 2020 2023 2045 6e74 6572  ass..    # Enter
+0001dab0: 2061 2070 6172 7365 2074 7265 6520 7072   a parse tree pr
+0001dac0: 6f64 7563 6564 2062 7920 526f 7365 7474  oduced by Rosett
+0001dad0: 614d 5250 6172 7365 7223 6d69 6e5f 7265  aMRParser#min_re
+0001dae0: 7369 6475 655f 6174 6f6d 6963 5f64 6973  sidue_atomic_dis
+0001daf0: 7461 6e63 655f 7265 7374 7261 696e 742e  tance_restraint.
+0001db00: 0a20 2020 2064 6566 2065 6e74 6572 4d69  .    def enterMi
+0001db10: 6e5f 7265 7369 6475 655f 6174 6f6d 6963  n_residue_atomic
+0001db20: 5f64 6973 7461 6e63 655f 7265 7374 7261  _distance_restra
+0001db30: 696e 7428 7365 6c66 2c20 6374 783a 2052  int(self, ctx: R
+0001db40: 6f73 6574 7461 4d52 5061 7273 6572 2e4d  osettaMRParser.M
+0001db50: 696e 5f72 6573 6964 7565 5f61 746f 6d69  in_residue_atomi
+0001db60: 635f 6469 7374 616e 6365 5f72 6573 7472  c_distance_restr
+0001db70: 6169 6e74 436f 6e74 6578 7429 3a20 2023  aintContext):  #
 0001db80: 2070 796c 696e 743a 2064 6973 6162 6c65   pylint: disable
 0001db90: 3d75 6e75 7365 642d 6172 6775 6d65 6e74  =unused-argument
-0001dba0: 0a20 2020 2020 2020 2073 656c 662e 5f5f  .        self.__
-0001dbb0: 6375 725f 7375 6274 7970 6520 3d20 2767  cur_subtype = 'g
-0001dbc0: 656f 270a 0a20 2020 2023 2045 7869 7420  eo'..    # Exit 
-0001dbd0: 6120 7061 7273 6520 7472 6565 2070 726f  a parse tree pro
-0001dbe0: 6475 6365 6420 6279 2052 6f73 6574 7461  duced by Rosetta
-0001dbf0: 4d52 5061 7273 6572 236d 696e 5f72 6573  MRParser#min_res
-0001dc00: 6964 7565 5f61 746f 6d69 635f 6469 7374  idue_atomic_dist
-0001dc10: 616e 6365 5f72 6573 7472 6169 6e74 732e  ance_restraints.
-0001dc20: 0a20 2020 2064 6566 2065 7869 744d 696e  .    def exitMin
-0001dc30: 5f72 6573 6964 7565 5f61 746f 6d69 635f  _residue_atomic_
-0001dc40: 6469 7374 616e 6365 5f72 6573 7472 6169  distance_restrai
-0001dc50: 6e74 7328 7365 6c66 2c20 6374 783a 2052  nts(self, ctx: R
-0001dc60: 6f73 6574 7461 4d52 5061 7273 6572 2e4d  osettaMRParser.M
-0001dc70: 696e 5f72 6573 6964 7565 5f61 746f 6d69  in_residue_atomi
-0001dc80: 635f 6469 7374 616e 6365 5f72 6573 7472  c_distance_restr
-0001dc90: 6169 6e74 7343 6f6e 7465 7874 293a 2020  aintsContext):  
-0001dca0: 2320 7079 6c69 6e74 3a20 6469 7361 626c  # pylint: disabl
-0001dcb0: 653d 756e 7573 6564 2d61 7267 756d 656e  e=unused-argumen
-0001dcc0: 740a 2020 2020 2020 2020 7061 7373 0a0a  t.        pass..
-0001dcd0: 2020 2020 2320 456e 7465 7220 6120 7061      # Enter a pa
-0001dce0: 7273 6520 7472 6565 2070 726f 6475 6365  rse tree produce
-0001dcf0: 6420 6279 2052 6f73 6574 7461 4d52 5061  d by RosettaMRPa
-0001dd00: 7273 6572 236d 696e 5f72 6573 6964 7565  rser#min_residue
-0001dd10: 5f61 746f 6d69 635f 6469 7374 616e 6365  _atomic_distance
-0001dd20: 5f72 6573 7472 6169 6e74 2e0a 2020 2020  _restraint..    
-0001dd30: 6465 6620 656e 7465 724d 696e 5f72 6573  def enterMin_res
-0001dd40: 6964 7565 5f61 746f 6d69 635f 6469 7374  idue_atomic_dist
-0001dd50: 616e 6365 5f72 6573 7472 6169 6e74 2873  ance_restraint(s
-0001dd60: 656c 662c 2063 7478 3a20 526f 7365 7474  elf, ctx: Rosett
-0001dd70: 614d 5250 6172 7365 722e 4d69 6e5f 7265  aMRParser.Min_re
-0001dd80: 7369 6475 655f 6174 6f6d 6963 5f64 6973  sidue_atomic_dis
-0001dd90: 7461 6e63 655f 7265 7374 7261 696e 7443  tance_restraintC
-0001dda0: 6f6e 7465 7874 293a 2020 2320 7079 6c69  ontext):  # pyli
-0001ddb0: 6e74 3a20 6469 7361 626c 653d 756e 7573  nt: disable=unus
-0001ddc0: 6564 2d61 7267 756d 656e 740a 2020 2020  ed-argument.    
-0001ddd0: 2020 2020 7365 6c66 2e67 656f 5265 7374      self.geoRest
-0001dde0: 7261 696e 7473 202b 3d20 310a 0a20 2020  raints += 1..   
-0001ddf0: 2020 2020 2073 656c 662e 7374 6163 6b46       self.stackF
-0001de00: 756e 6373 2e63 6c65 6172 2829 0a20 2020  uncs.clear().   
-0001de10: 2020 2020 2073 656c 662e 6174 6f6d 5365       self.atomSe
-0001de20: 6c65 6374 696f 6e53 6574 2e63 6c65 6172  lectionSet.clear
-0001de30: 2829 0a0a 2020 2020 2320 4578 6974 2061  ()..    # Exit a
-0001de40: 2070 6172 7365 2074 7265 6520 7072 6f64   parse tree prod
-0001de50: 7563 6564 2062 7920 526f 7365 7474 614d  uced by RosettaM
-0001de60: 5250 6172 7365 7223 6d69 6e5f 7265 7369  RParser#min_resi
-0001de70: 6475 655f 6174 6f6d 6963 5f64 6973 7461  due_atomic_dista
-0001de80: 6e63 655f 7265 7374 7261 696e 742e 0a20  nce_restraint.. 
-0001de90: 2020 2064 6566 2065 7869 744d 696e 5f72     def exitMin_r
-0001dea0: 6573 6964 7565 5f61 746f 6d69 635f 6469  esidue_atomic_di
-0001deb0: 7374 616e 6365 5f72 6573 7472 6169 6e74  stance_restraint
-0001dec0: 2873 656c 662c 2063 7478 3a20 526f 7365  (self, ctx: Rose
-0001ded0: 7474 614d 5250 6172 7365 722e 4d69 6e5f  ttaMRParser.Min_
-0001dee0: 7265 7369 6475 655f 6174 6f6d 6963 5f64  residue_atomic_d
-0001def0: 6973 7461 6e63 655f 7265 7374 7261 696e  istance_restrain
-0001df00: 7443 6f6e 7465 7874 293a 0a0a 2020 2020  tContext):..    
-0001df10: 2020 2020 7472 793a 0a0a 2020 2020 2020      try:..      
-0001df20: 2020 2020 2020 7365 7149 6431 203d 2069        seqId1 = i
-0001df30: 6e74 2873 7472 2863 7478 2e49 6e74 6567  nt(str(ctx.Integ
-0001df40: 6572 2830 2929 290a 2020 2020 2020 2020  er(0))).        
-0001df50: 2020 2020 7365 7149 6432 203d 2069 6e74      seqId2 = int
-0001df60: 2873 7472 2863 7478 2e49 6e74 6567 6572  (str(ctx.Integer
-0001df70: 2831 2929 290a 0a20 2020 2020 2020 2020  (1)))..         
-0001df80: 2020 2069 6620 6c65 6e28 7365 6c66 2e6e     if len(self.n
-0001df90: 756d 6265 7253 656c 6563 7469 6f6e 2920  umberSelection) 
-0001dfa0: 3d3d 2030 206f 7220 4e6f 6e65 2069 6e20  == 0 or None in 
-0001dfb0: 7365 6c66 2e6e 756d 6265 7253 656c 6563  self.numberSelec
-0001dfc0: 7469 6f6e 3a0a 2020 2020 2020 2020 2020  tion:.          
-0001dfd0: 2020 2020 2020 7265 7475 726e 0a0a 2020        return..  
-0001dfe0: 2020 2020 2020 2020 2020 7461 7267 6574            target
-0001dff0: 5f76 616c 7565 203d 2073 656c 662e 6e75  _value = self.nu
-0001e000: 6d62 6572 5365 6c65 6374 696f 6e5b 305d  mberSelection[0]
-0001e010: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0001e020: 206e 6f74 2073 656c 662e 5f5f 6861 7350   not self.__hasP
-0001e030: 6f6c 7953 6571 3a0a 2020 2020 2020 2020  olySeq:.        
-0001e040: 2020 2020 2020 2020 7265 7475 726e 0a0a          return..
-0001e050: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001e060: 2e5f 5f72 6574 7269 6576 654c 6f63 616c  .__retrieveLocal
-0001e070: 5365 7153 6368 656d 6528 290a 0a20 2020  SeqScheme()..   
-0001e080: 2020 2020 2020 2020 2063 6861 696e 4173           chainAs
-0001e090: 7369 676e 3120 3d20 7365 6c66 2e61 7373  sign1 = self.ass
-0001e0a0: 6967 6e43 6f6f 7264 506f 6c79 6d65 7253  ignCoordPolymerS
-0001e0b0: 6571 7565 6e63 6528 7365 7149 6431 290a  equence(seqId1).
-0001e0c0: 2020 2020 2020 2020 2020 2020 6368 6169              chai
-0001e0d0: 6e41 7373 6967 6e32 203d 2073 656c 662e  nAssign2 = self.
-0001e0e0: 6173 7369 676e 436f 6f72 6450 6f6c 796d  assignCoordPolym
-0001e0f0: 6572 5365 7175 656e 6365 2873 6571 4964  erSequence(seqId
-0001e100: 3229 0a0a 2020 2020 2020 2020 2020 2020  2)..            
-0001e110: 6966 206c 656e 2863 6861 696e 4173 7369  if len(chainAssi
-0001e120: 676e 3129 203d 3d20 3020 6f72 206c 656e  gn1) == 0 or len
-0001e130: 2863 6861 696e 4173 7369 676e 3229 203d  (chainAssign2) =
-0001e140: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
-0001e150: 2020 2020 2072 6574 7572 6e0a 0a20 2020       return..   
-0001e160: 2020 2020 2020 2020 2073 656c 662e 7365           self.se
-0001e170: 6c65 6374 436f 6f72 6452 6573 6964 7565  lectCoordResidue
-0001e180: 7328 6368 6169 6e41 7373 6967 6e31 2c20  s(chainAssign1, 
-0001e190: 7365 7149 6431 290a 2020 2020 2020 2020  seqId1).        
-0001e1a0: 2020 2020 7365 6c66 2e73 656c 6563 7443      self.selectC
-0001e1b0: 6f6f 7264 5265 7369 6475 6573 2863 6861  oordResidues(cha
-0001e1c0: 696e 4173 7369 676e 322c 2073 6571 4964  inAssign2, seqId
-0001e1d0: 3229 0a0a 2020 2020 2020 2020 2020 2020  2)..            
-0001e1e0: 6966 206c 656e 2873 656c 662e 6174 6f6d  if len(self.atom
-0001e1f0: 5365 6c65 6374 696f 6e53 6574 2920 3c20  SelectionSet) < 
-0001e200: 323a 0a20 2020 2020 2020 2020 2020 2020  2:.             
-0001e210: 2020 2072 6574 7572 6e0a 0a20 2020 2020     return..     
-0001e220: 2020 2020 2020 2064 7374 4675 6e63 203d         dstFunc =
-0001e230: 207b 7d0a 2020 2020 2020 2020 2020 2020   {}.            
-0001e240: 7661 6c69 6452 616e 6765 203d 2054 7275  validRange = Tru
-0001e250: 650a 0a20 2020 2020 2020 2020 2020 2069  e..            i
-0001e260: 6620 4449 5354 5f45 5252 4f52 5f4d 494e  f DIST_ERROR_MIN
-0001e270: 203c 2074 6172 6765 745f 7661 6c75 6520   < target_value 
-0001e280: 3c20 4449 5354 5f45 5252 4f52 5f4d 4158  < DIST_ERROR_MAX
-0001e290: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001e2a0: 2020 6473 7446 756e 635b 2774 6172 6765    dstFunc['targe
-0001e2b0: 745f 7661 6c75 6527 5d20 3d20 6622 7b74  t_value'] = f"{t
-0001e2c0: 6172 6765 745f 7661 6c75 657d 220a 2020  arget_value}".  
-0001e2d0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0001e2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e2f0: 7661 6c69 6452 616e 6765 203d 2046 616c  validRange = Fal
-0001e300: 7365 0a20 2020 2020 2020 2020 2020 2020  se.             
-0001e310: 2020 2073 656c 662e 5f5f 662e 6170 7065     self.__f.appe
-0001e320: 6e64 2866 225b 5261 6e67 6520 7661 6c75  nd(f"[Range valu
-0001e330: 6520 6572 726f 725d 207b 7365 6c66 2e5f  e error] {self._
-0001e340: 5f67 6574 4375 7272 656e 7452 6573 7472  _getCurrentRestr
-0001e350: 6169 6e74 2829 7d22 0a20 2020 2020 2020  aint()}".       
-0001e360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e370: 2020 2020 2020 2020 2066 2254 6865 2074           f"The t
-0001e380: 6172 6765 7420 7661 6c75 653d 277b 7461  arget value='{ta
-0001e390: 7267 6574 5f76 616c 7565 7d27 206d 7573  rget_value}' mus
-0001e3a0: 7420 6265 2077 6974 6869 6e20 7261 6e67  t be within rang
-0001e3b0: 6520 7b44 4953 545f 5245 5354 5241 494e  e {DIST_RESTRAIN
-0001e3c0: 545f 4552 524f 527d 2e22 290a 0a20 2020  T_ERROR}.")..   
-0001e3d0: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-0001e3e0: 7661 6c69 6452 616e 6765 3a0a 2020 2020  validRange:.    
-0001e3f0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001e400: 726e 0a0a 2020 2020 2020 2020 2020 2020  rn..            
-0001e410: 6966 2044 4953 545f 5241 4e47 455f 4d49  if DIST_RANGE_MI
-0001e420: 4e20 3c3d 2074 6172 6765 745f 7661 6c75  N <= target_valu
-0001e430: 6520 3c3d 2044 4953 545f 5241 4e47 455f  e <= DIST_RANGE_
-0001e440: 4d41 583a 0a20 2020 2020 2020 2020 2020  MAX:.           
-0001e450: 2020 2020 2070 6173 730a 2020 2020 2020       pass.      
-0001e460: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0001e470: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001e480: 2e5f 5f66 2e61 7070 656e 6428 6622 5b52  .__f.append(f"[R
-0001e490: 616e 6765 2076 616c 7565 2077 6172 6e69  ange value warni
-0001e4a0: 6e67 5d20 7b73 656c 662e 5f5f 6765 7443  ng] {self.__getC
-0001e4b0: 7572 7265 6e74 5265 7374 7261 696e 7428  urrentRestraint(
-0001e4c0: 297d 220a 2020 2020 2020 2020 2020 2020  )}".            
+0001dba0: 0a20 2020 2020 2020 2073 656c 662e 6765  .        self.ge
+0001dbb0: 6f52 6573 7472 6169 6e74 7320 2b3d 2031  oRestraints += 1
+0001dbc0: 0a0a 2020 2020 2020 2020 7365 6c66 2e73  ..        self.s
+0001dbd0: 7461 636b 4675 6e63 732e 636c 6561 7228  tackFuncs.clear(
+0001dbe0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+0001dbf0: 746f 6d53 656c 6563 7469 6f6e 5365 742e  tomSelectionSet.
+0001dc00: 636c 6561 7228 290a 0a20 2020 2023 2045  clear()..    # E
+0001dc10: 7869 7420 6120 7061 7273 6520 7472 6565  xit a parse tree
+0001dc20: 2070 726f 6475 6365 6420 6279 2052 6f73   produced by Ros
+0001dc30: 6574 7461 4d52 5061 7273 6572 236d 696e  ettaMRParser#min
+0001dc40: 5f72 6573 6964 7565 5f61 746f 6d69 635f  _residue_atomic_
+0001dc50: 6469 7374 616e 6365 5f72 6573 7472 6169  distance_restrai
+0001dc60: 6e74 2e0a 2020 2020 6465 6620 6578 6974  nt..    def exit
+0001dc70: 4d69 6e5f 7265 7369 6475 655f 6174 6f6d  Min_residue_atom
+0001dc80: 6963 5f64 6973 7461 6e63 655f 7265 7374  ic_distance_rest
+0001dc90: 7261 696e 7428 7365 6c66 2c20 6374 783a  raint(self, ctx:
+0001dca0: 2052 6f73 6574 7461 4d52 5061 7273 6572   RosettaMRParser
+0001dcb0: 2e4d 696e 5f72 6573 6964 7565 5f61 746f  .Min_residue_ato
+0001dcc0: 6d69 635f 6469 7374 616e 6365 5f72 6573  mic_distance_res
+0001dcd0: 7472 6169 6e74 436f 6e74 6578 7429 3a0a  traintContext):.
+0001dce0: 0a20 2020 2020 2020 2074 7279 3a0a 0a20  .        try:.. 
+0001dcf0: 2020 2020 2020 2020 2020 2073 6571 4964             seqId
+0001dd00: 3120 3d20 696e 7428 7374 7228 6374 782e  1 = int(str(ctx.
+0001dd10: 496e 7465 6765 7228 3029 2929 0a20 2020  Integer(0))).   
+0001dd20: 2020 2020 2020 2020 2073 6571 4964 3220           seqId2 
+0001dd30: 3d20 696e 7428 7374 7228 6374 782e 496e  = int(str(ctx.In
+0001dd40: 7465 6765 7228 3129 2929 0a0a 2020 2020  teger(1)))..    
+0001dd50: 2020 2020 2020 2020 6966 206c 656e 2873          if len(s
+0001dd60: 656c 662e 6e75 6d62 6572 5365 6c65 6374  elf.numberSelect
+0001dd70: 696f 6e29 203d 3d20 3020 6f72 204e 6f6e  ion) == 0 or Non
+0001dd80: 6520 696e 2073 656c 662e 6e75 6d62 6572  e in self.number
+0001dd90: 5365 6c65 6374 696f 6e3a 0a20 2020 2020  Selection:.     
+0001dda0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0001ddb0: 6e0a 0a20 2020 2020 2020 2020 2020 2074  n..            t
+0001ddc0: 6172 6765 745f 7661 6c75 6520 3d20 7365  arget_value = se
+0001ddd0: 6c66 2e6e 756d 6265 7253 656c 6563 7469  lf.numberSelecti
+0001dde0: 6f6e 5b30 5d0a 0a20 2020 2020 2020 2020  on[0]..         
+0001ddf0: 2020 2069 6620 6e6f 7420 7365 6c66 2e5f     if not self._
+0001de00: 5f68 6173 506f 6c79 5365 713a 0a20 2020  _hasPolySeq:.   
+0001de10: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+0001de20: 7572 6e0a 0a20 2020 2020 2020 2020 2020  urn..           
+0001de30: 2073 656c 662e 5f5f 7265 7472 6965 7665   self.__retrieve
+0001de40: 4c6f 6361 6c53 6571 5363 6865 6d65 2829  LocalSeqScheme()
+0001de50: 0a0a 2020 2020 2020 2020 2020 2020 6368  ..            ch
+0001de60: 6169 6e41 7373 6967 6e31 203d 2073 656c  ainAssign1 = sel
+0001de70: 662e 6173 7369 676e 436f 6f72 6450 6f6c  f.assignCoordPol
+0001de80: 796d 6572 5365 7175 656e 6365 2873 6571  ymerSequence(seq
+0001de90: 4964 3129 0a20 2020 2020 2020 2020 2020  Id1).           
+0001dea0: 2063 6861 696e 4173 7369 676e 3220 3d20   chainAssign2 = 
+0001deb0: 7365 6c66 2e61 7373 6967 6e43 6f6f 7264  self.assignCoord
+0001dec0: 506f 6c79 6d65 7253 6571 7565 6e63 6528  PolymerSequence(
+0001ded0: 7365 7149 6432 290a 0a20 2020 2020 2020  seqId2)..       
+0001dee0: 2020 2020 2069 6620 6c65 6e28 6368 6169       if len(chai
+0001def0: 6e41 7373 6967 6e31 2920 3d3d 2030 206f  nAssign1) == 0 o
+0001df00: 7220 6c65 6e28 6368 6169 6e41 7373 6967  r len(chainAssig
+0001df10: 6e32 2920 3d3d 2030 3a0a 2020 2020 2020  n2) == 0:.      
+0001df20: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001df30: 0a0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+0001df40: 6c66 2e73 656c 6563 7443 6f6f 7264 5265  lf.selectCoordRe
+0001df50: 7369 6475 6573 2863 6861 696e 4173 7369  sidues(chainAssi
+0001df60: 676e 312c 2073 6571 4964 3129 0a20 2020  gn1, seqId1).   
+0001df70: 2020 2020 2020 2020 2073 656c 662e 7365           self.se
+0001df80: 6c65 6374 436f 6f72 6452 6573 6964 7565  lectCoordResidue
+0001df90: 7328 6368 6169 6e41 7373 6967 6e32 2c20  s(chainAssign2, 
+0001dfa0: 7365 7149 6432 290a 0a20 2020 2020 2020  seqId2)..       
+0001dfb0: 2020 2020 2069 6620 6c65 6e28 7365 6c66       if len(self
+0001dfc0: 2e61 746f 6d53 656c 6563 7469 6f6e 5365  .atomSelectionSe
+0001dfd0: 7429 203c 2032 3a0a 2020 2020 2020 2020  t) < 2:.        
+0001dfe0: 2020 2020 2020 2020 7265 7475 726e 0a0a          return..
+0001dff0: 2020 2020 2020 2020 2020 2020 6473 7446              dstF
+0001e000: 756e 6320 3d20 7b7d 0a20 2020 2020 2020  unc = {}.       
+0001e010: 2020 2020 2076 616c 6964 5261 6e67 6520       validRange 
+0001e020: 3d20 5472 7565 0a0a 2020 2020 2020 2020  = True..        
+0001e030: 2020 2020 6966 2044 4953 545f 4552 524f      if DIST_ERRO
+0001e040: 525f 4d49 4e20 3c20 7461 7267 6574 5f76  R_MIN < target_v
+0001e050: 616c 7565 203c 2044 4953 545f 4552 524f  alue < DIST_ERRO
+0001e060: 525f 4d41 583a 0a20 2020 2020 2020 2020  R_MAX:.         
+0001e070: 2020 2020 2020 2064 7374 4675 6e63 5b27         dstFunc['
+0001e080: 7461 7267 6574 5f76 616c 7565 275d 203d  target_value'] =
+0001e090: 2066 227b 7461 7267 6574 5f76 616c 7565   f"{target_value
+0001e0a0: 7d22 0a20 2020 2020 2020 2020 2020 2065  }".            e
+0001e0b0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0001e0c0: 2020 2020 2076 616c 6964 5261 6e67 6520       validRange 
+0001e0d0: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
+0001e0e0: 2020 2020 2020 2020 7365 6c66 2e5f 5f66          self.__f
+0001e0f0: 2e61 7070 656e 6428 6622 5b52 616e 6765  .append(f"[Range
+0001e100: 2076 616c 7565 2065 7272 6f72 5d20 7b73   value error] {s
+0001e110: 656c 662e 5f5f 6765 7443 7572 7265 6e74  elf.__getCurrent
+0001e120: 5265 7374 7261 696e 7428 297d 220a 2020  Restraint()}".  
+0001e130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e140: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+0001e150: 5468 6520 7461 7267 6574 2076 616c 7565  The target value
+0001e160: 3d27 7b74 6172 6765 745f 7661 6c75 657d  ='{target_value}
+0001e170: 2720 6d75 7374 2062 6520 7769 7468 696e  ' must be within
+0001e180: 2072 616e 6765 207b 4449 5354 5f52 4553   range {DIST_RES
+0001e190: 5452 4149 4e54 5f45 5252 4f52 7d2e 2229  TRAINT_ERROR}.")
+0001e1a0: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+0001e1b0: 206e 6f74 2076 616c 6964 5261 6e67 653a   not validRange:
+0001e1c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001e1d0: 2072 6574 7572 6e0a 0a20 2020 2020 2020   return..       
+0001e1e0: 2020 2020 2069 6620 4449 5354 5f52 414e       if DIST_RAN
+0001e1f0: 4745 5f4d 494e 203c 3d20 7461 7267 6574  GE_MIN <= target
+0001e200: 5f76 616c 7565 203c 3d20 4449 5354 5f52  _value <= DIST_R
+0001e210: 414e 4745 5f4d 4158 3a0a 2020 2020 2020  ANGE_MAX:.      
+0001e220: 2020 2020 2020 2020 2020 7061 7373 0a20            pass. 
+0001e230: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0001e240: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001e250: 2073 656c 662e 5f5f 662e 6170 7065 6e64   self.__f.append
+0001e260: 2866 225b 5261 6e67 6520 7661 6c75 6520  (f"[Range value 
+0001e270: 7761 726e 696e 675d 207b 7365 6c66 2e5f  warning] {self._
+0001e280: 5f67 6574 4375 7272 656e 7452 6573 7472  _getCurrentRestr
+0001e290: 6169 6e74 2829 7d22 0a20 2020 2020 2020  aint()}".       
+0001e2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e2b0: 2020 2020 2020 2020 2066 2254 6865 2074           f"The t
+0001e2c0: 6172 6765 7420 7661 6c75 653d 277b 7461  arget value='{ta
+0001e2d0: 7267 6574 5f76 616c 7565 7d27 2073 686f  rget_value}' sho
+0001e2e0: 756c 6420 6265 2077 6974 6869 6e20 7261  uld be within ra
+0001e2f0: 6e67 6520 7b44 4953 545f 5245 5354 5241  nge {DIST_RESTRA
+0001e300: 494e 545f 5241 4e47 457d 2e22 290a 0a20  INT_RANGE}.").. 
+0001e310: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+0001e320: 6c66 2e5f 5f63 7265 6174 6553 6644 6963  lf.__createSfDic
+0001e330: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
+0001e340: 2020 2073 6620 3d20 7365 6c66 2e5f 5f67     sf = self.__g
+0001e350: 6574 5366 2827 616d 6269 6775 6f75 7320  etSf('ambiguous 
+0001e360: 7369 7465 2072 6573 7472 6169 6e74 2028  site restraint (
+0001e370: 7265 7369 6475 6520 746f 206f 7468 6572  residue to other
+0001e380: 2072 6573 6964 7565 292c 2052 4f53 4554   residue), ROSET
+0001e390: 5441 204d 696e 5265 7369 6475 6541 746f  TA MinResidueAto
+0001e3a0: 6d69 6344 6973 7461 6e63 6527 290a 2020  micDistance').  
+0001e3b0: 2020 2020 2020 2020 2020 2020 2020 7366                sf
+0001e3c0: 5b27 6964 275d 202b 3d20 310a 2020 2020  ['id'] += 1.    
+0001e3d0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+0001e3e0: 656e 2873 665b 276c 6f6f 7027 5d5b 2774  en(sf['loop']['t
+0001e3f0: 6167 7327 5d29 203d 3d20 303a 0a20 2020  ags']) == 0:.   
+0001e400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e410: 2073 665b 276c 6f6f 7027 5d5b 2774 6167   sf['loop']['tag
+0001e420: 7327 5d20 3d20 5b27 696e 6465 785f 6964  s'] = ['index_id
+0001e430: 272c 2027 6964 272c 0a20 2020 2020 2020  ', 'id',.       
+0001e440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e460: 2020 2027 696e 7465 7261 6374 696e 675f     'interacting_
+0001e470: 6175 7468 5f61 7379 6d5f 6964 5f31 272c  auth_asym_id_1',
+0001e480: 2027 696e 7465 7261 6374 696e 675f 6175   'interacting_au
+0001e490: 7468 5f73 6571 5f69 645f 3127 2c20 2769  th_seq_id_1', 'i
+0001e4a0: 6e74 6572 6163 7469 6e67 5f61 7574 685f  nteracting_auth_
+0001e4b0: 636f 6d70 5f69 645f 3127 2c0a 2020 2020  comp_id_1',.    
+0001e4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001e4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e4e0: 2020 2020 6622 5468 6520 7461 7267 6574      f"The target
-0001e4f0: 2076 616c 7565 3d27 7b74 6172 6765 745f   value='{target_
-0001e500: 7661 6c75 657d 2720 7368 6f75 6c64 2062  value}' should b
-0001e510: 6520 7769 7468 696e 2072 616e 6765 207b  e within range {
-0001e520: 4449 5354 5f52 4553 5452 4149 4e54 5f52  DIST_RESTRAINT_R
-0001e530: 414e 4745 7d2e 2229 0a0a 2020 2020 2020  ANGE}.")..      
-0001e540: 2020 2020 2020 6966 2073 656c 662e 5f5f        if self.__
-0001e550: 6372 6561 7465 5366 4469 6374 3a0a 2020  createSfDict:.  
-0001e560: 2020 2020 2020 2020 2020 2020 2020 7366                sf
-0001e570: 203d 2073 656c 662e 5f5f 6765 7453 6628   = self.__getSf(
-0001e580: 2761 6d62 6967 756f 7573 2073 6974 6520  'ambiguous site 
-0001e590: 7265 7374 7261 696e 7420 2872 6573 6964  restraint (resid
-0001e5a0: 7565 2074 6f20 6f74 6865 7220 7265 7369  ue to other resi
-0001e5b0: 6475 6529 2c20 524f 5345 5454 4120 4d69  due), ROSETTA Mi
-0001e5c0: 6e52 6573 6964 7565 4174 6f6d 6963 4469  nResidueAtomicDi
-0001e5d0: 7374 616e 6365 2729 0a20 2020 2020 2020  stance').       
-0001e5e0: 2020 2020 2020 2020 2073 665b 2769 6427           sf['id'
-0001e5f0: 5d20 2b3d 2031 0a20 2020 2020 2020 2020  ] += 1.         
-0001e600: 2020 2020 2020 2069 6620 6c65 6e28 7366         if len(sf
-0001e610: 5b27 6c6f 6f70 275d 5b27 7461 6773 275d  ['loop']['tags']
-0001e620: 2920 3d3d 2030 3a0a 2020 2020 2020 2020  ) == 0:.        
-0001e630: 2020 2020 2020 2020 2020 2020 7366 5b27              sf['
-0001e640: 6c6f 6f70 275d 5b27 7461 6773 275d 203d  loop']['tags'] =
-0001e650: 205b 2769 6e64 6578 5f69 6427 2c20 2769   ['index_id', 'i
-0001e660: 6427 2c0a 2020 2020 2020 2020 2020 2020  d',.            
-0001e670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e680: 2020 2020 2020 2020 2020 2020 2020 2769                'i
-0001e690: 6e74 6572 6163 7469 6e67 5f61 7574 685f  nteracting_auth_
-0001e6a0: 6173 796d 5f69 645f 3127 2c20 2769 6e74  asym_id_1', 'int
-0001e6b0: 6572 6163 7469 6e67 5f61 7574 685f 7365  eracting_auth_se
-0001e6c0: 715f 6964 5f31 272c 2027 696e 7465 7261  q_id_1', 'intera
-0001e6d0: 6374 696e 675f 6175 7468 5f63 6f6d 705f  cting_auth_comp_
-0001e6e0: 6964 5f31 272c 0a20 2020 2020 2020 2020  id_1',.         
-0001e6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e710: 2027 696e 7465 7261 6374 696e 675f 6175   'interacting_au
-0001e720: 7468 5f61 7379 6d5f 6964 5f32 272c 2027  th_asym_id_2', '
-0001e730: 696e 7465 7261 6374 696e 675f 6175 7468  interacting_auth
-0001e740: 5f73 6571 5f69 645f 3227 2c20 2769 6e74  _seq_id_2', 'int
-0001e750: 6572 6163 7469 6e67 5f61 7574 685f 636f  eracting_auth_co
-0001e760: 6d70 5f69 645f 3227 2c0a 2020 2020 2020  mp_id_2',.      
-0001e770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e790: 2020 2020 2774 6172 6765 745f 7661 6c75      'target_valu
-0001e7a0: 6527 2c20 2774 6172 6765 745f 7661 6c75  e', 'target_valu
-0001e7b0: 655f 756e 6365 7274 6169 6e74 7927 2c0a  e_uncertainty',.
-0001e7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e7e0: 2020 2020 2020 2020 2020 276c 6f77 6572            'lower
-0001e7f0: 5f6c 696e 6561 725f 6c69 6d69 7427 2c20  _linear_limit', 
-0001e800: 276c 6f77 6572 5f6c 696d 6974 272c 2027  'lower_limit', '
-0001e810: 7570 7065 725f 6c69 6d69 7427 2c20 2775  upper_limit', 'u
-0001e820: 7070 6572 5f6c 696e 6561 725f 6c69 6d69  pper_linear_limi
-0001e830: 7427 2c0a 2020 2020 2020 2020 2020 2020  t',.            
-0001e840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e850: 2020 2020 2020 2020 2020 2020 2020 276c                'l
-0001e860: 6973 745f 6964 272c 2027 656e 7472 795f  ist_id', 'entry_
-0001e870: 6964 275d 0a0a 2020 2020 2020 2020 2020  id']..          
-0001e880: 2020 6966 2073 656c 662e 5f5f 6375 725f    if self.__cur_
-0001e890: 6e65 7374 2069 7320 6e6f 7420 4e6f 6e65  nest is not None
-0001e8a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001e8b0: 2020 6966 2073 656c 662e 5f5f 6465 6275    if self.__debu
-0001e8c0: 673a 0a20 2020 2020 2020 2020 2020 2020  g:.             
-0001e8d0: 2020 2020 2020 2070 7269 6e74 2866 224e         print(f"N
-0001e8e0: 4553 5445 443a 207b 7365 6c66 2e5f 5f63  ESTED: {self.__c
-0001e8f0: 7572 5f6e 6573 747d 2229 0a0a 2020 2020  ur_nest}")..    
-0001e900: 2020 2020 2020 2020 666f 7220 7265 7331          for res1
-0001e910: 2c20 7265 7332 2069 6e20 6974 6572 746f  , res2 in iterto
-0001e920: 6f6c 732e 7072 6f64 7563 7428 7365 6c66  ols.product(self
-0001e930: 2e61 746f 6d53 656c 6563 7469 6f6e 5365  .atomSelectionSe
-0001e940: 745b 305d 2c0a 2020 2020 2020 2020 2020  t[0],.          
+0001e4e0: 2020 2020 2020 2769 6e74 6572 6163 7469        'interacti
+0001e4f0: 6e67 5f61 7574 685f 6173 796d 5f69 645f  ng_auth_asym_id_
+0001e500: 3227 2c20 2769 6e74 6572 6163 7469 6e67  2', 'interacting
+0001e510: 5f61 7574 685f 7365 715f 6964 5f32 272c  _auth_seq_id_2',
+0001e520: 2027 696e 7465 7261 6374 696e 675f 6175   'interacting_au
+0001e530: 7468 5f63 6f6d 705f 6964 5f32 272c 0a20  th_comp_id_2',. 
+0001e540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e560: 2020 2020 2020 2020 2027 7461 7267 6574           'target
+0001e570: 5f76 616c 7565 272c 2027 7461 7267 6574  _value', 'target
+0001e580: 5f76 616c 7565 5f75 6e63 6572 7461 696e  _value_uncertain
+0001e590: 7479 272c 0a20 2020 2020 2020 2020 2020  ty',.           
+0001e5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e5b0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0001e5c0: 6c6f 7765 725f 6c69 6e65 6172 5f6c 696d  lower_linear_lim
+0001e5d0: 6974 272c 2027 6c6f 7765 725f 6c69 6d69  it', 'lower_limi
+0001e5e0: 7427 2c20 2775 7070 6572 5f6c 696d 6974  t', 'upper_limit
+0001e5f0: 272c 2027 7570 7065 725f 6c69 6e65 6172  ', 'upper_linear
+0001e600: 5f6c 696d 6974 272c 0a20 2020 2020 2020  _limit',.       
+0001e610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e630: 2020 2027 6c69 7374 5f69 6427 2c20 2765     'list_id', 'e
+0001e640: 6e74 7279 5f69 6427 5d0a 0a20 2020 2020  ntry_id']..     
+0001e650: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
+0001e660: 5f63 7572 5f6e 6573 7420 6973 206e 6f74  _cur_nest is not
+0001e670: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0001e680: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
+0001e690: 5f64 6562 7567 3a0a 2020 2020 2020 2020  _debug:.        
+0001e6a0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+0001e6b0: 7428 6622 4e45 5354 4544 3a20 7b73 656c  t(f"NESTED: {sel
+0001e6c0: 662e 5f5f 6375 725f 6e65 7374 7d22 290a  f.__cur_nest}").
+0001e6d0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0001e6e0: 2072 6573 312c 2072 6573 3220 696e 2069   res1, res2 in i
+0001e6f0: 7465 7274 6f6f 6c73 2e70 726f 6475 6374  tertools.product
+0001e700: 2873 656c 662e 6174 6f6d 5365 6c65 6374  (self.atomSelect
+0001e710: 696f 6e53 6574 5b30 5d2c 0a20 2020 2020  ionSet[0],.     
+0001e720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e740: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001e750: 6174 6f6d 5365 6c65 6374 696f 6e53 6574  atomSelectionSet
+0001e760: 5b31 5d29 3a0a 2020 2020 2020 2020 2020  [1]):.          
+0001e770: 2020 2020 2020 6966 2073 656c 662e 5f5f        if self.__
+0001e780: 6465 6275 673a 0a20 2020 2020 2020 2020  debug:.         
+0001e790: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0001e7a0: 2866 2273 7562 7479 7065 3d7b 7365 6c66  (f"subtype={self
+0001e7b0: 2e5f 5f63 7572 5f73 7562 7479 7065 7d20  .__cur_subtype} 
+0001e7c0: 284d 696e 5265 7369 6475 6541 746f 6d69  (MinResidueAtomi
+0001e7d0: 6344 6973 7461 6e63 6529 2069 643d 7b73  cDistance) id={s
+0001e7e0: 656c 662e 6765 6f52 6573 7472 6169 6e74  elf.geoRestraint
+0001e7f0: 737d 2022 0a20 2020 2020 2020 2020 2020  s} ".           
+0001e800: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0001e810: 2272 6573 7564 7565 313d 7b72 6573 317d  "resudue1={res1}
+0001e820: 2072 6573 6964 7565 323d 7b72 6573 327d   residue2={res2}
+0001e830: 207b 6473 7446 756e 637d 2229 0a20 2020   {dstFunc}").   
+0001e840: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0001e850: 7365 6c66 2e5f 5f63 7265 6174 6553 6644  self.__createSfD
+0001e860: 6963 7420 616e 6420 7366 2069 7320 6e6f  ict and sf is no
+0001e870: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+0001e880: 2020 2020 2020 2020 2020 2020 7366 5b27              sf['
+0001e890: 696e 6465 785f 6964 275d 202b 3d20 310a  index_id'] += 1.
+0001e8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e8b0: 2020 2020 7366 5b27 6c6f 6f70 275d 5b27      sf['loop']['
+0001e8c0: 6461 7461 275d 2e61 7070 656e 6428 5b73  data'].append([s
+0001e8d0: 665b 2769 6e64 6578 5f69 6427 5d2c 2073  f['index_id'], s
+0001e8e0: 665b 2769 6427 5d2c 0a20 2020 2020 2020  f['id'],.       
+0001e8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e910: 2020 2020 2020 2020 7265 7331 5b27 6368          res1['ch
+0001e920: 6169 6e5f 6964 275d 2c20 7265 7331 5b27  ain_id'], res1['
+0001e930: 7365 715f 6964 275d 2c20 7265 7331 5b27  seq_id'], res1['
+0001e940: 636f 6d70 5f69 6427 5d2c 0a20 2020 2020  comp_id'],.     
 0001e950: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001e960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e970: 2020 2020 2020 7365 6c66 2e61 746f 6d53        self.atomS
-0001e980: 656c 6563 7469 6f6e 5365 745b 315d 293a  electionSet[1]):
-0001e990: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001e9a0: 2069 6620 7365 6c66 2e5f 5f64 6562 7567   if self.__debug
-0001e9b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001e9c0: 2020 2020 2020 7072 696e 7428 6622 7375        print(f"su
-0001e9d0: 6274 7970 653d 7b73 656c 662e 5f5f 6375  btype={self.__cu
-0001e9e0: 725f 7375 6274 7970 657d 2028 4d69 6e52  r_subtype} (MinR
-0001e9f0: 6573 6964 7565 4174 6f6d 6963 4469 7374  esidueAtomicDist
-0001ea00: 616e 6365 2920 6964 3d7b 7365 6c66 2e67  ance) id={self.g
-0001ea10: 656f 5265 7374 7261 696e 7473 7d20 220a  eoRestraints} ".
-0001ea20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ea30: 2020 2020 2020 2020 2020 6622 7265 7375            f"resu
-0001ea40: 6475 6531 3d7b 7265 7331 7d20 7265 7369  due1={res1} resi
-0001ea50: 6475 6532 3d7b 7265 7332 7d20 7b64 7374  due2={res2} {dst
-0001ea60: 4675 6e63 7d22 290a 2020 2020 2020 2020  Func}").        
-0001ea70: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0001ea80: 5f5f 6372 6561 7465 5366 4469 6374 2061  __createSfDict a
-0001ea90: 6e64 2073 6620 6973 206e 6f74 204e 6f6e  nd sf is not Non
-0001eaa0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0001eab0: 2020 2020 2020 2073 665b 2769 6e64 6578         sf['index
-0001eac0: 5f69 6427 5d20 2b3d 2031 0a20 2020 2020  _id'] += 1.     
-0001ead0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001eae0: 665b 276c 6f6f 7027 5d5b 2764 6174 6127  f['loop']['data'
-0001eaf0: 5d2e 6170 7065 6e64 285b 7366 5b27 696e  ].append([sf['in
-0001eb00: 6465 785f 6964 275d 2c20 7366 5b27 6964  dex_id'], sf['id
-0001eb10: 275d 2c0a 2020 2020 2020 2020 2020 2020  '],.            
-0001eb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001eb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001eb40: 2020 2072 6573 315b 2763 6861 696e 5f69     res1['chain_i
-0001eb50: 6427 5d2c 2072 6573 315b 2773 6571 5f69  d'], res1['seq_i
-0001eb60: 6427 5d2c 2072 6573 315b 2763 6f6d 705f  d'], res1['comp_
-0001eb70: 6964 275d 2c0a 2020 2020 2020 2020 2020  id'],.          
-0001eb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001eb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001eba0: 2020 2020 2072 6573 325b 2763 6861 696e       res2['chain
-0001ebb0: 5f69 6427 5d2c 2072 6573 325b 2773 6571  _id'], res2['seq
-0001ebc0: 5f69 6427 5d2c 2072 6573 325b 2763 6f6d  _id'], res2['com
-0001ebd0: 705f 6964 275d 2c0a 2020 2020 2020 2020  p_id'],.        
-0001ebe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ebf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ec00: 2020 2020 2020 2064 7374 4675 6e63 5b27         dstFunc['
-0001ec10: 7461 7267 6574 5f76 616c 7565 275d 2069  target_value'] i
-0001ec20: 6620 2774 6172 6765 745f 7661 6c75 6527  f 'target_value'
-0001ec30: 2069 6e20 6473 7446 756e 6320 656c 7365   in dstFunc else
-0001ec40: 204e 6f6e 652c 204e 6f6e 652c 0a20 2020   None, None,.   
-0001ec50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ec60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ec70: 2020 2020 2020 2020 2020 2020 6473 7446              dstF
-0001ec80: 756e 635b 276c 6f77 6572 5f6c 696e 6561  unc['lower_linea
-0001ec90: 725f 6c69 6d69 7427 5d20 6966 2027 6c6f  r_limit'] if 'lo
-0001eca0: 7765 725f 6c69 6e65 6172 5f6c 696d 6974  wer_linear_limit
-0001ecb0: 2720 696e 2064 7374 4675 6e63 2065 6c73  ' in dstFunc els
-0001ecc0: 6520 4e6f 6e65 2c0a 2020 2020 2020 2020  e None,.        
-0001ecd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ece0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ecf0: 2020 2020 2020 2064 7374 4675 6e63 5b27         dstFunc['
-0001ed00: 6c6f 7765 725f 6c69 6d69 7427 5d20 6966  lower_limit'] if
-0001ed10: 2027 6c6f 7765 725f 6c69 6d69 7427 2069   'lower_limit' i
-0001ed20: 6e20 6473 7446 756e 6320 656c 7365 204e  n dstFunc else N
-0001ed30: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
-0001ed40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ed50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ed60: 2020 2020 6473 7446 756e 635b 2775 7070      dstFunc['upp
-0001ed70: 6572 5f6c 696d 6974 275d 2069 6620 2775  er_limit'] if 'u
-0001ed80: 7070 6572 5f6c 696d 6974 2720 696e 2064  pper_limit' in d
-0001ed90: 7374 4675 6e63 2065 6c73 6520 4e6f 6e65  stFunc else None
-0001eda0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001edb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001edc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001edd0: 2064 7374 4675 6e63 5b27 7570 7065 725f   dstFunc['upper_
-0001ede0: 6c69 6e65 6172 5f6c 696d 6974 275d 2069  linear_limit'] i
-0001edf0: 6620 2775 7070 6572 5f6c 696e 6561 725f  f 'upper_linear_
-0001ee00: 6c69 6d69 7427 2069 6e20 6473 7446 756e  limit' in dstFun
-0001ee10: 6320 656c 7365 204e 6f6e 652c 0a20 2020  c else None,.   
-0001ee20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ee30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ee40: 2020 2020 2020 2020 2020 2020 7366 5b27              sf['
-0001ee50: 6c69 7374 5f69 6427 5d2c 2073 656c 662e  list_id'], self.
-0001ee60: 5f5f 656e 7472 7949 645d 290a 0a20 2020  __entryId])..   
-0001ee70: 2020 2020 2065 7863 6570 7420 5661 6c75       except Valu
-0001ee80: 6545 7272 6f72 3a0a 2020 2020 2020 2020  eError:.        
-0001ee90: 2020 2020 7365 6c66 2e67 656f 5265 7374      self.geoRest
-0001eea0: 7261 696e 7473 202d 3d20 310a 2020 2020  raints -= 1.    
-0001eeb0: 2020 2020 6669 6e61 6c6c 793a 0a20 2020      finally:.   
-0001eec0: 2020 2020 2020 2020 2073 656c 662e 6e75           self.nu
-0001eed0: 6d62 6572 5365 6c65 6374 696f 6e2e 636c  mberSelection.cl
-0001eee0: 6561 7228 290a 0a20 2020 2023 2045 6e74  ear()..    # Ent
-0001eef0: 6572 2061 2070 6172 7365 2074 7265 6520  er a parse tree 
-0001ef00: 7072 6f64 7563 6564 2062 7920 526f 7365  produced by Rose
-0001ef10: 7474 614d 5250 6172 7365 7223 6269 675f  ttaMRParser#big_
-0001ef20: 6269 6e5f 7265 7374 7261 696e 7473 2e0a  bin_restraints..
-0001ef30: 2020 2020 6465 6620 656e 7465 7242 6967      def enterBig
-0001ef40: 5f62 696e 5f72 6573 7472 6169 6e74 7328  _bin_restraints(
-0001ef50: 7365 6c66 2c20 6374 783a 2052 6f73 6574  self, ctx: Roset
-0001ef60: 7461 4d52 5061 7273 6572 2e42 6967 5f62  taMRParser.Big_b
-0001ef70: 696e 5f72 6573 7472 6169 6e74 7343 6f6e  in_restraintsCon
-0001ef80: 7465 7874 293a 2020 2320 7079 6c69 6e74  text):  # pylint
-0001ef90: 3a20 6469 7361 626c 653d 756e 7573 6564  : disable=unused
-0001efa0: 2d61 7267 756d 656e 740a 2020 2020 2020  -argument.      
-0001efb0: 2020 7365 6c66 2e5f 5f63 7572 5f73 7562    self.__cur_sub
-0001efc0: 7479 7065 203d 2027 6765 6f27 0a0a 2020  type = 'geo'..  
-0001efd0: 2020 2320 4578 6974 2061 2070 6172 7365    # Exit a parse
-0001efe0: 2074 7265 6520 7072 6f64 7563 6564 2062   tree produced b
-0001eff0: 7920 526f 7365 7474 614d 5250 6172 7365  y RosettaMRParse
-0001f000: 7223 6269 675f 6269 6e5f 7265 7374 7261  r#big_bin_restra
-0001f010: 696e 7473 2e0a 2020 2020 6465 6620 6578  ints..    def ex
-0001f020: 6974 4269 675f 6269 6e5f 7265 7374 7261  itBig_bin_restra
-0001f030: 696e 7473 2873 656c 662c 2063 7478 3a20  ints(self, ctx: 
-0001f040: 526f 7365 7474 614d 5250 6172 7365 722e  RosettaMRParser.
-0001f050: 4269 675f 6269 6e5f 7265 7374 7261 696e  Big_bin_restrain
-0001f060: 7473 436f 6e74 6578 7429 3a20 2023 2070  tsContext):  # p
-0001f070: 796c 696e 743a 2064 6973 6162 6c65 3d75  ylint: disable=u
-0001f080: 6e75 7365 642d 6172 6775 6d65 6e74 0a20  nused-argument. 
-0001f090: 2020 2020 2020 2070 6173 730a 0a20 2020         pass..   
-0001f0a0: 2023 2045 6e74 6572 2061 2070 6172 7365   # Enter a parse
-0001f0b0: 2074 7265 6520 7072 6f64 7563 6564 2062   tree produced b
-0001f0c0: 7920 526f 7365 7474 614d 5250 6172 7365  y RosettaMRParse
-0001f0d0: 7223 6269 675f 6269 6e5f 7265 7374 7261  r#big_bin_restra
-0001f0e0: 696e 742e 0a20 2020 2064 6566 2065 6e74  int..    def ent
-0001f0f0: 6572 4269 675f 6269 6e5f 7265 7374 7261  erBig_bin_restra
-0001f100: 696e 7428 7365 6c66 2c20 6374 783a 2052  int(self, ctx: R
-0001f110: 6f73 6574 7461 4d52 5061 7273 6572 2e42  osettaMRParser.B
-0001f120: 6967 5f62 696e 5f72 6573 7472 6169 6e74  ig_bin_restraint
-0001f130: 436f 6e74 6578 7429 3a20 2023 2070 796c  Context):  # pyl
-0001f140: 696e 743a 2064 6973 6162 6c65 3d75 6e75  int: disable=unu
-0001f150: 7365 642d 6172 6775 6d65 6e74 0a20 2020  sed-argument.   
-0001f160: 2020 2020 2073 656c 662e 6765 6f52 6573       self.geoRes
-0001f170: 7472 6169 6e74 7320 2b3d 2031 0a0a 2020  traints += 1..  
-0001f180: 2020 2020 2020 7365 6c66 2e73 7461 636b        self.stack
-0001f190: 4675 6e63 732e 636c 6561 7228 290a 2020  Funcs.clear().  
-0001f1a0: 2020 2020 2020 7365 6c66 2e61 746f 6d53        self.atomS
-0001f1b0: 656c 6563 7469 6f6e 5365 742e 636c 6561  electionSet.clea
-0001f1c0: 7228 290a 0a20 2020 2023 2045 7869 7420  r()..    # Exit 
-0001f1d0: 6120 7061 7273 6520 7472 6565 2070 726f  a parse tree pro
-0001f1e0: 6475 6365 6420 6279 2052 6f73 6574 7461  duced by Rosetta
-0001f1f0: 4d52 5061 7273 6572 2362 6967 5f62 696e  MRParser#big_bin
-0001f200: 5f72 6573 7472 6169 6e74 2e0a 2020 2020  _restraint..    
-0001f210: 6465 6620 6578 6974 4269 675f 6269 6e5f  def exitBig_bin_
-0001f220: 7265 7374 7261 696e 7428 7365 6c66 2c20  restraint(self, 
-0001f230: 6374 783a 2052 6f73 6574 7461 4d52 5061  ctx: RosettaMRPa
-0001f240: 7273 6572 2e42 6967 5f62 696e 5f72 6573  rser.Big_bin_res
-0001f250: 7472 6169 6e74 436f 6e74 6578 7429 3a0a  traintContext):.
-0001f260: 0a20 2020 2020 2020 2074 7279 3a0a 0a20  .        try:.. 
-0001f270: 2020 2020 2020 2020 2020 2073 6571 4964             seqId
-0001f280: 203d 2069 6e74 2873 7472 2863 7478 2e53   = int(str(ctx.S
-0001f290: 696d 706c 655f 6e61 6d65 2829 2929 0a20  imple_name())). 
-0001f2a0: 2020 2020 2020 2020 2020 2062 696e 4368             binCh
-0001f2b0: 6172 203d 2073 7472 2863 7478 2e53 696d  ar = str(ctx.Sim
-0001f2c0: 706c 655f 6e61 6d65 2829 290a 0a20 2020  ple_name())..   
-0001f2d0: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
-0001f2e0: 7365 6c66 2e6e 756d 6265 7253 656c 6563  self.numberSelec
-0001f2f0: 7469 6f6e 2920 3d3d 2030 206f 7220 4e6f  tion) == 0 or No
-0001f300: 6e65 2069 6e20 7365 6c66 2e6e 756d 6265  ne in self.numbe
-0001f310: 7253 656c 6563 7469 6f6e 3a0a 2020 2020  rSelection:.    
-0001f320: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001f330: 726e 0a0a 2020 2020 2020 2020 2020 2020  rn..            
-0001f340: 7344 6576 203d 2073 656c 662e 6e75 6d62  sDev = self.numb
-0001f350: 6572 5365 6c65 6374 696f 6e5b 305d 0a0a  erSelection[0]..
-0001f360: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-0001f370: 6f74 2073 656c 662e 5f5f 6861 7350 6f6c  ot self.__hasPol
-0001f380: 7953 6571 3a0a 2020 2020 2020 2020 2020  ySeq:.          
-0001f390: 2020 2020 2020 7265 7475 726e 0a0a 2020        return..  
-0001f3a0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-0001f3b0: 5f72 6574 7269 6576 654c 6f63 616c 5365  _retrieveLocalSe
-0001f3c0: 7153 6368 656d 6528 290a 0a20 2020 2020  qScheme()..     
-0001f3d0: 2020 2020 2020 2063 6861 696e 4173 7369         chainAssi
-0001f3e0: 676e 203d 2073 656c 662e 6173 7369 676e  gn = self.assign
-0001f3f0: 436f 6f72 6450 6f6c 796d 6572 5365 7175  CoordPolymerSequ
-0001f400: 656e 6365 2873 6571 4964 290a 0a20 2020  ence(seqId)..   
-0001f410: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
-0001f420: 6368 6169 6e41 7373 6967 6e29 203d 3d20  chainAssign) == 
-0001f430: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-0001f440: 2020 2072 6574 7572 6e0a 0a20 2020 2020     return..     
-0001f450: 2020 2020 2020 2073 656c 662e 7365 6c65         self.sele
-0001f460: 6374 436f 6f72 6452 6573 6964 7565 7328  ctCoordResidues(
-0001f470: 6368 6169 6e41 7373 6967 6e2c 2073 6571  chainAssign, seq
-0001f480: 4964 290a 0a20 2020 2020 2020 2020 2020  Id)..           
-0001f490: 2069 6620 6c65 6e28 7365 6c66 2e61 746f   if len(self.ato
-0001f4a0: 6d53 656c 6563 7469 6f6e 5365 7429 203c  mSelectionSet) <
-0001f4b0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+0001e970: 2020 2020 2020 2020 2020 7265 7332 5b27            res2['
+0001e980: 6368 6169 6e5f 6964 275d 2c20 7265 7332  chain_id'], res2
+0001e990: 5b27 7365 715f 6964 275d 2c20 7265 7332  ['seq_id'], res2
+0001e9a0: 5b27 636f 6d70 5f69 6427 5d2c 0a20 2020  ['comp_id'],.   
+0001e9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e9d0: 2020 2020 2020 2020 2020 2020 6473 7446              dstF
+0001e9e0: 756e 632e 6765 7428 2774 6172 6765 745f  unc.get('target_
+0001e9f0: 7661 6c75 6527 292c 204e 6f6e 652c 0a20  value'), None,. 
+0001ea00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ea10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ea20: 2020 2020 2020 2020 2020 2020 2020 6473                ds
+0001ea30: 7446 756e 632e 6765 7428 276c 6f77 6572  tFunc.get('lower
+0001ea40: 5f6c 696e 6561 725f 6c69 6d69 7427 292c  _linear_limit'),
+0001ea50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001ea60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ea70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ea80: 6473 7446 756e 632e 6765 7428 276c 6f77  dstFunc.get('low
+0001ea90: 6572 5f6c 696d 6974 2729 2c0a 2020 2020  er_limit'),.    
+0001eaa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eac0: 2020 2020 2020 2020 2020 2064 7374 4675             dstFu
+0001ead0: 6e63 2e67 6574 2827 7570 7065 725f 6c69  nc.get('upper_li
+0001eae0: 6d69 7427 292c 0a20 2020 2020 2020 2020  mit'),.         
+0001eaf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eb10: 2020 2020 2020 6473 7446 756e 632e 6765        dstFunc.ge
+0001eb20: 7428 2775 7070 6572 5f6c 696e 6561 725f  t('upper_linear_
+0001eb30: 6c69 6d69 7427 292c 0a20 2020 2020 2020  limit'),.       
+0001eb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eb60: 2020 2020 2020 2020 7366 5b27 6c69 7374          sf['list
+0001eb70: 5f69 6427 5d2c 2073 656c 662e 5f5f 656e  _id'], self.__en
+0001eb80: 7472 7949 645d 290a 0a20 2020 2020 2020  tryId])..       
+0001eb90: 2065 7863 6570 7420 5661 6c75 6545 7272   except ValueErr
+0001eba0: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
+0001ebb0: 7365 6c66 2e67 656f 5265 7374 7261 696e  self.geoRestrain
+0001ebc0: 7473 202d 3d20 310a 2020 2020 2020 2020  ts -= 1.        
+0001ebd0: 6669 6e61 6c6c 793a 0a20 2020 2020 2020  finally:.       
+0001ebe0: 2020 2020 2073 656c 662e 6e75 6d62 6572       self.number
+0001ebf0: 5365 6c65 6374 696f 6e2e 636c 6561 7228  Selection.clear(
+0001ec00: 290a 0a20 2020 2023 2045 6e74 6572 2061  )..    # Enter a
+0001ec10: 2070 6172 7365 2074 7265 6520 7072 6f64   parse tree prod
+0001ec20: 7563 6564 2062 7920 526f 7365 7474 614d  uced by RosettaM
+0001ec30: 5250 6172 7365 7223 6269 675f 6269 6e5f  RParser#big_bin_
+0001ec40: 7265 7374 7261 696e 7473 2e0a 2020 2020  restraints..    
+0001ec50: 6465 6620 656e 7465 7242 6967 5f62 696e  def enterBig_bin
+0001ec60: 5f72 6573 7472 6169 6e74 7328 7365 6c66  _restraints(self
+0001ec70: 2c20 6374 783a 2052 6f73 6574 7461 4d52  , ctx: RosettaMR
+0001ec80: 5061 7273 6572 2e42 6967 5f62 696e 5f72  Parser.Big_bin_r
+0001ec90: 6573 7472 6169 6e74 7343 6f6e 7465 7874  estraintsContext
+0001eca0: 293a 2020 2320 7079 6c69 6e74 3a20 6469  ):  # pylint: di
+0001ecb0: 7361 626c 653d 756e 7573 6564 2d61 7267  sable=unused-arg
+0001ecc0: 756d 656e 740a 2020 2020 2020 2020 7365  ument.        se
+0001ecd0: 6c66 2e5f 5f63 7572 5f73 7562 7479 7065  lf.__cur_subtype
+0001ece0: 203d 2027 6765 6f27 0a0a 2020 2020 2320   = 'geo'..    # 
+0001ecf0: 4578 6974 2061 2070 6172 7365 2074 7265  Exit a parse tre
+0001ed00: 6520 7072 6f64 7563 6564 2062 7920 526f  e produced by Ro
+0001ed10: 7365 7474 614d 5250 6172 7365 7223 6269  settaMRParser#bi
+0001ed20: 675f 6269 6e5f 7265 7374 7261 696e 7473  g_bin_restraints
+0001ed30: 2e0a 2020 2020 6465 6620 6578 6974 4269  ..    def exitBi
+0001ed40: 675f 6269 6e5f 7265 7374 7261 696e 7473  g_bin_restraints
+0001ed50: 2873 656c 662c 2063 7478 3a20 526f 7365  (self, ctx: Rose
+0001ed60: 7474 614d 5250 6172 7365 722e 4269 675f  ttaMRParser.Big_
+0001ed70: 6269 6e5f 7265 7374 7261 696e 7473 436f  bin_restraintsCo
+0001ed80: 6e74 6578 7429 3a20 2023 2070 796c 696e  ntext):  # pylin
+0001ed90: 743a 2064 6973 6162 6c65 3d75 6e75 7365  t: disable=unuse
+0001eda0: 642d 6172 6775 6d65 6e74 0a20 2020 2020  d-argument.     
+0001edb0: 2020 2070 6173 730a 0a20 2020 2023 2045     pass..    # E
+0001edc0: 6e74 6572 2061 2070 6172 7365 2074 7265  nter a parse tre
+0001edd0: 6520 7072 6f64 7563 6564 2062 7920 526f  e produced by Ro
+0001ede0: 7365 7474 614d 5250 6172 7365 7223 6269  settaMRParser#bi
+0001edf0: 675f 6269 6e5f 7265 7374 7261 696e 742e  g_bin_restraint.
+0001ee00: 0a20 2020 2064 6566 2065 6e74 6572 4269  .    def enterBi
+0001ee10: 675f 6269 6e5f 7265 7374 7261 696e 7428  g_bin_restraint(
+0001ee20: 7365 6c66 2c20 6374 783a 2052 6f73 6574  self, ctx: Roset
+0001ee30: 7461 4d52 5061 7273 6572 2e42 6967 5f62  taMRParser.Big_b
+0001ee40: 696e 5f72 6573 7472 6169 6e74 436f 6e74  in_restraintCont
+0001ee50: 6578 7429 3a20 2023 2070 796c 696e 743a  ext):  # pylint:
+0001ee60: 2064 6973 6162 6c65 3d75 6e75 7365 642d   disable=unused-
+0001ee70: 6172 6775 6d65 6e74 0a20 2020 2020 2020  argument.       
+0001ee80: 2073 656c 662e 6765 6f52 6573 7472 6169   self.geoRestrai
+0001ee90: 6e74 7320 2b3d 2031 0a0a 2020 2020 2020  nts += 1..      
+0001eea0: 2020 7365 6c66 2e73 7461 636b 4675 6e63    self.stackFunc
+0001eeb0: 732e 636c 6561 7228 290a 2020 2020 2020  s.clear().      
+0001eec0: 2020 7365 6c66 2e61 746f 6d53 656c 6563    self.atomSelec
+0001eed0: 7469 6f6e 5365 742e 636c 6561 7228 290a  tionSet.clear().
+0001eee0: 0a20 2020 2023 2045 7869 7420 6120 7061  .    # Exit a pa
+0001eef0: 7273 6520 7472 6565 2070 726f 6475 6365  rse tree produce
+0001ef00: 6420 6279 2052 6f73 6574 7461 4d52 5061  d by RosettaMRPa
+0001ef10: 7273 6572 2362 6967 5f62 696e 5f72 6573  rser#big_bin_res
+0001ef20: 7472 6169 6e74 2e0a 2020 2020 6465 6620  traint..    def 
+0001ef30: 6578 6974 4269 675f 6269 6e5f 7265 7374  exitBig_bin_rest
+0001ef40: 7261 696e 7428 7365 6c66 2c20 6374 783a  raint(self, ctx:
+0001ef50: 2052 6f73 6574 7461 4d52 5061 7273 6572   RosettaMRParser
+0001ef60: 2e42 6967 5f62 696e 5f72 6573 7472 6169  .Big_bin_restrai
+0001ef70: 6e74 436f 6e74 6578 7429 3a0a 0a20 2020  ntContext):..   
+0001ef80: 2020 2020 2074 7279 3a0a 0a20 2020 2020       try:..     
+0001ef90: 2020 2020 2020 2073 6571 4964 203d 2069         seqId = i
+0001efa0: 6e74 2873 7472 2863 7478 2e53 696d 706c  nt(str(ctx.Simpl
+0001efb0: 655f 6e61 6d65 2829 2929 0a20 2020 2020  e_name())).     
+0001efc0: 2020 2020 2020 2062 696e 4368 6172 203d         binChar =
+0001efd0: 2073 7472 2863 7478 2e53 696d 706c 655f   str(ctx.Simple_
+0001efe0: 6e61 6d65 2829 290a 0a20 2020 2020 2020  name())..       
+0001eff0: 2020 2020 2069 6620 6c65 6e28 7365 6c66       if len(self
+0001f000: 2e6e 756d 6265 7253 656c 6563 7469 6f6e  .numberSelection
+0001f010: 2920 3d3d 2030 206f 7220 4e6f 6e65 2069  ) == 0 or None i
+0001f020: 6e20 7365 6c66 2e6e 756d 6265 7253 656c  n self.numberSel
+0001f030: 6563 7469 6f6e 3a0a 2020 2020 2020 2020  ection:.        
+0001f040: 2020 2020 2020 2020 7265 7475 726e 0a0a          return..
+0001f050: 2020 2020 2020 2020 2020 2020 7344 6576              sDev
+0001f060: 203d 2073 656c 662e 6e75 6d62 6572 5365   = self.numberSe
+0001f070: 6c65 6374 696f 6e5b 305d 0a0a 2020 2020  lection[0]..    
+0001f080: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
+0001f090: 656c 662e 5f5f 6861 7350 6f6c 7953 6571  elf.__hasPolySeq
+0001f0a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001f0b0: 2020 7265 7475 726e 0a0a 2020 2020 2020    return..      
+0001f0c0: 2020 2020 2020 7365 6c66 2e5f 5f72 6574        self.__ret
+0001f0d0: 7269 6576 654c 6f63 616c 5365 7153 6368  rieveLocalSeqSch
+0001f0e0: 656d 6528 290a 0a20 2020 2020 2020 2020  eme()..         
+0001f0f0: 2020 2063 6861 696e 4173 7369 676e 203d     chainAssign =
+0001f100: 2073 656c 662e 6173 7369 676e 436f 6f72   self.assignCoor
+0001f110: 6450 6f6c 796d 6572 5365 7175 656e 6365  dPolymerSequence
+0001f120: 2873 6571 4964 290a 0a20 2020 2020 2020  (seqId)..       
+0001f130: 2020 2020 2069 6620 6c65 6e28 6368 6169       if len(chai
+0001f140: 6e41 7373 6967 6e29 203d 3d20 303a 0a20  nAssign) == 0:. 
+0001f150: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0001f160: 6574 7572 6e0a 0a20 2020 2020 2020 2020  eturn..         
+0001f170: 2020 2073 656c 662e 7365 6c65 6374 436f     self.selectCo
+0001f180: 6f72 6452 6573 6964 7565 7328 6368 6169  ordResidues(chai
+0001f190: 6e41 7373 6967 6e2c 2073 6571 4964 290a  nAssign, seqId).
+0001f1a0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0001f1b0: 6c65 6e28 7365 6c66 2e61 746f 6d53 656c  len(self.atomSel
+0001f1c0: 6563 7469 6f6e 5365 7429 203c 2031 3a0a  ectionSet) < 1:.
+0001f1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f1e0: 7265 7475 726e 0a0a 2020 2020 2020 2020  return..        
+0001f1f0: 2020 2020 6966 2062 696e 4368 6172 206e      if binChar n
+0001f200: 6f74 2069 6e20 2827 4f27 2c20 2747 272c  ot in ('O', 'G',
+0001f210: 2027 4527 2c20 2741 272c 2027 4227 293a   'E', 'A', 'B'):
+0001f220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f230: 2073 656c 662e 5f5f 662e 6170 7065 6e64   self.__f.append
+0001f240: 2866 225b 456e 756d 206d 6973 6d61 7463  (f"[Enum mismatc
+0001f250: 685d 207b 7365 6c66 2e5f 5f67 6574 4375  h] {self.__getCu
+0001f260: 7272 656e 7452 6573 7472 6169 6e74 2829  rrentRestraint()
+0001f270: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
+0001f280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f290: 2020 2066 2254 6865 2042 6967 4269 6e20     f"The BigBin 
+0001f2a0: 6964 656e 7469 6669 6572 2027 7b62 696e  identifier '{bin
+0001f2b0: 4368 6172 7d27 206d 7573 7420 6265 206f  Char}' must be o
+0001f2c0: 6e65 206f 6620 7b28 274f 272c 2027 4727  ne of {('O', 'G'
+0001f2d0: 2c20 2745 272c 2027 4127 2c20 2742 2729  , 'E', 'A', 'B')
+0001f2e0: 7d2e 2229 0a20 2020 2020 2020 2020 2020  }.").           
+0001f2f0: 2020 2020 2072 6574 7572 6e0a 0a20 2020       return..   
+0001f300: 2020 2020 2020 2020 2064 7374 4675 6e63           dstFunc
+0001f310: 203d 207b 7d0a 2020 2020 2020 2020 2020   = {}.          
+0001f320: 2020 7661 6c69 6452 616e 6765 203d 2054    validRange = T
+0001f330: 7275 650a 0a20 2020 2020 2020 2020 2020  rue..           
+0001f340: 2069 6620 4449 5354 5f45 5252 4f52 5f4d   if DIST_ERROR_M
+0001f350: 494e 203c 2073 4465 7620 3c20 4449 5354  IN < sDev < DIST
+0001f360: 5f45 5252 4f52 5f4d 4158 3a0a 2020 2020  _ERROR_MAX:.    
+0001f370: 2020 2020 2020 2020 2020 2020 6473 7446              dstF
+0001f380: 756e 635b 2773 7461 6e64 6172 645f 6465  unc['standard_de
+0001f390: 7669 6174 696f 6e27 5d20 3d20 6622 7b73  viation'] = f"{s
+0001f3a0: 4465 767d 220a 2020 2020 2020 2020 2020  Dev}".          
+0001f3b0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0001f3c0: 2020 2020 2020 2020 7661 6c69 6452 616e          validRan
+0001f3d0: 6765 203d 2046 616c 7365 0a20 2020 2020  ge = False.     
+0001f3e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001f3f0: 5f5f 662e 6170 7065 6e64 2866 225b 5261  __f.append(f"[Ra
+0001f400: 6e67 6520 7661 6c75 6520 6572 726f 725d  nge value error]
+0001f410: 207b 7365 6c66 2e5f 5f67 6574 4375 7272   {self.__getCurr
+0001f420: 656e 7452 6573 7472 6169 6e74 2829 7d22  entRestraint()}"
+0001f430: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f450: 2066 2254 6865 2027 7364 6576 3d7b 7344   f"The 'sdev={sD
+0001f460: 6576 7d27 206d 7573 7420 6265 2077 6974  ev}' must be wit
+0001f470: 6869 6e20 7261 6e67 6520 7b44 4953 545f  hin range {DIST_
+0001f480: 5245 5354 5241 494e 545f 4552 524f 527d  RESTRAINT_ERROR}
+0001f490: 2e22 290a 0a20 2020 2020 2020 2020 2020  .")..           
+0001f4a0: 2069 6620 6e6f 7420 7661 6c69 6452 616e   if not validRan
+0001f4b0: 6765 3a0a 2020 2020 2020 2020 2020 2020  ge:.            
 0001f4c0: 2020 2020 7265 7475 726e 0a0a 2020 2020      return..    
-0001f4d0: 2020 2020 2020 2020 6966 2062 696e 4368          if binCh
-0001f4e0: 6172 206e 6f74 2069 6e20 2827 4f27 2c20  ar not in ('O', 
-0001f4f0: 2747 272c 2027 4527 2c20 2741 272c 2027  'G', 'E', 'A', '
-0001f500: 4227 293a 0a20 2020 2020 2020 2020 2020  B'):.           
-0001f510: 2020 2020 2073 656c 662e 5f5f 662e 6170       self.__f.ap
-0001f520: 7065 6e64 2866 225b 456e 756d 206d 6973  pend(f"[Enum mis
-0001f530: 6d61 7463 685d 207b 7365 6c66 2e5f 5f67  match] {self.__g
-0001f540: 6574 4375 7272 656e 7452 6573 7472 6169  etCurrentRestrai
-0001f550: 6e74 2829 7d22 0a20 2020 2020 2020 2020  nt()}".         
-0001f560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f570: 2020 2020 2020 2066 2254 6865 2042 6967         f"The Big
-0001f580: 4269 6e20 6964 656e 7469 6669 6572 2027  Bin identifier '
-0001f590: 7b62 696e 4368 6172 7d27 206d 7573 7420  {binChar}' must 
-0001f5a0: 6265 206f 6e65 206f 6620 7b28 274f 272c  be one of {('O',
-0001f5b0: 2027 4727 2c20 2745 272c 2027 4127 2c20   'G', 'E', 'A', 
-0001f5c0: 2742 2729 7d2e 2229 0a20 2020 2020 2020  'B')}.").       
-0001f5d0: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
-0001f5e0: 0a20 2020 2020 2020 2020 2020 2064 7374  .            dst
-0001f5f0: 4675 6e63 203d 207b 7d0a 2020 2020 2020  Func = {}.      
-0001f600: 2020 2020 2020 7661 6c69 6452 616e 6765        validRange
-0001f610: 203d 2054 7275 650a 0a20 2020 2020 2020   = True..       
-0001f620: 2020 2020 2069 6620 4449 5354 5f45 5252       if DIST_ERR
-0001f630: 4f52 5f4d 494e 203c 2073 4465 7620 3c20  OR_MIN < sDev < 
-0001f640: 4449 5354 5f45 5252 4f52 5f4d 4158 3a0a  DIST_ERROR_MAX:.
-0001f650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f660: 6473 7446 756e 635b 2773 7461 6e64 6172  dstFunc['standar
-0001f670: 645f 6465 7669 6174 696f 6e27 5d20 3d20  d_deviation'] = 
-0001f680: 6622 7b73 4465 767d 220a 2020 2020 2020  f"{sDev}".      
-0001f690: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0001f6a0: 2020 2020 2020 2020 2020 2020 7661 6c69              vali
-0001f6b0: 6452 616e 6765 203d 2046 616c 7365 0a20  dRange = False. 
-0001f6c0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001f6d0: 656c 662e 5f5f 662e 6170 7065 6e64 2866  elf.__f.append(f
-0001f6e0: 225b 5261 6e67 6520 7661 6c75 6520 6572  "[Range value er
-0001f6f0: 726f 725d 207b 7365 6c66 2e5f 5f67 6574  ror] {self.__get
-0001f700: 4375 7272 656e 7452 6573 7472 6169 6e74  CurrentRestraint
-0001f710: 2829 7d22 0a20 2020 2020 2020 2020 2020  ()}".           
-0001f720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f730: 2020 2020 2066 2254 6865 2027 7364 6576       f"The 'sdev
-0001f740: 3d7b 7344 6576 7d27 206d 7573 7420 6265  ={sDev}' must be
-0001f750: 2077 6974 6869 6e20 7261 6e67 6520 7b44   within range {D
-0001f760: 4953 545f 5245 5354 5241 494e 545f 4552  IST_RESTRAINT_ER
-0001f770: 524f 527d 2e22 290a 0a20 2020 2020 2020  ROR}.")..       
-0001f780: 2020 2020 2069 6620 6e6f 7420 7661 6c69       if not vali
-0001f790: 6452 616e 6765 3a0a 2020 2020 2020 2020  dRange:.        
-0001f7a0: 2020 2020 2020 2020 7265 7475 726e 0a0a          return..
-0001f7b0: 2020 2020 2020 2020 2020 2020 6966 2044              if D
-0001f7c0: 4953 545f 5241 4e47 455f 4d49 4e20 3c3d  IST_RANGE_MIN <=
-0001f7d0: 2073 4465 7620 3c3d 2044 4953 545f 5241   sDev <= DIST_RA
-0001f7e0: 4e47 455f 4d41 583a 0a20 2020 2020 2020  NGE_MAX:.       
-0001f7f0: 2020 2020 2020 2020 2070 6173 730a 2020           pass.  
-0001f800: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0001f810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f820: 7365 6c66 2e5f 5f66 2e61 7070 656e 6428  self.__f.append(
-0001f830: 6622 5b52 616e 6765 2076 616c 7565 2077  f"[Range value w
-0001f840: 6172 6e69 6e67 5d20 7b73 656c 662e 5f5f  arning] {self.__
-0001f850: 6765 7443 7572 7265 6e74 5265 7374 7261  getCurrentRestra
-0001f860: 696e 7428 297d 220a 2020 2020 2020 2020  int()}".        
-0001f870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f880: 2020 2020 2020 2020 6622 5468 6520 2773          f"The 's
-0001f890: 6465 763d 7b73 4465 767d 2720 7368 6f75  dev={sDev}' shou
-0001f8a0: 6c64 2062 6520 7769 7468 696e 2072 616e  ld be within ran
-0001f8b0: 6765 207b 4449 5354 5f52 4553 5452 4149  ge {DIST_RESTRAI
-0001f8c0: 4e54 5f52 414e 4745 7d2e 2229 0a0a 2020  NT_RANGE}.")..  
-0001f8d0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-0001f8e0: 662e 5f5f 6372 6561 7465 5366 4469 6374  f.__createSfDict
-0001f8f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001f900: 2020 7366 203d 2073 656c 662e 5f5f 6765    sf = self.__ge
-0001f910: 7453 6628 2264 6968 6564 7261 6c20 616e  tSf("dihedral an
-0001f920: 676c 6520 7265 7374 7261 696e 742c 2052  gle restraint, R
-0001f930: 4f53 4554 5441 2042 6967 4269 6e20 220a  OSETTA BigBin ".
-0001f940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f960: 2020 2228 274f 2720 666f 7220 6369 732d    "('O' for cis-
-0001f970: 6c69 6b65 204f 4d45 4741 2c20 2747 2720  like OMEGA, 'G' 
-0001f980: 666f 7220 5048 492c 5053 4920 696e 2031  for PHI,PSI in 1
-0001f990: 3030 2c31 3030 2c20 2745 2720 666f 7220  00,100, 'E' for 
-0001f9a0: 3130 302c 2d39 302c 2027 4127 2066 6f72  100,-90, 'A' for
-0001f9b0: 202d 3530 2c33 302c 2027 4227 2066 6f72   -50,30, 'B' for
-0001f9c0: 2031 3030 2c31 3735 2922 290a 2020 2020   100,175)").    
-0001f9d0: 2020 2020 2020 2020 2020 2020 7366 5b27              sf['
-0001f9e0: 6964 275d 202b 3d20 310a 2020 2020 2020  id'] += 1.      
-0001f9f0: 2020 2020 2020 2020 2020 6966 206c 656e            if len
-0001fa00: 2873 665b 276c 6f6f 7027 5d5b 2774 6167  (sf['loop']['tag
-0001fa10: 7327 5d29 203d 3d20 303a 0a20 2020 2020  s']) == 0:.     
-0001fa20: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001fa30: 665b 276c 6f6f 7027 5d5b 2774 6167 7327  f['loop']['tags'
-0001fa40: 5d20 3d20 5b27 696e 6465 785f 6964 272c  ] = ['index_id',
-0001fa50: 2027 6964 272c 0a20 2020 2020 2020 2020   'id',.         
-0001fa60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fa70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fa80: 2027 6175 7468 5f61 7379 6d5f 6964 5f31   'auth_asym_id_1
-0001fa90: 272c 2027 6175 7468 5f73 6571 5f69 645f  ', 'auth_seq_id_
-0001faa0: 3127 2c20 2761 7574 685f 636f 6d70 5f69  1', 'auth_comp_i
-0001fab0: 645f 3127 2c0a 2020 2020 2020 2020 2020  d_1',.          
-0001fac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fae0: 2762 696e 5f63 6f64 6527 2c20 2773 7461  'bin_code', 'sta
-0001faf0: 6e64 6172 645f 6465 7669 6174 696f 6e27  ndard_deviation'
-0001fb00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001fb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fb20: 2020 2020 2020 2020 2020 2020 276c 6973              'lis
-0001fb30: 745f 6964 272c 2027 656e 7472 795f 6964  t_id', 'entry_id
-0001fb40: 275d 0a0a 2020 2020 2020 2020 2020 2020  ']..            
-0001fb50: 6966 2073 656c 662e 5f5f 6375 725f 6e65  if self.__cur_ne
-0001fb60: 7374 2069 7320 6e6f 7420 4e6f 6e65 3a0a  st is not None:.
-0001fb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fb80: 6966 2073 656c 662e 5f5f 6465 6275 673a  if self.__debug:
-0001fb90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001fba0: 2020 2020 2070 7269 6e74 2866 224e 4553       print(f"NES
-0001fbb0: 5445 443a 207b 7365 6c66 2e5f 5f63 7572  TED: {self.__cur
-0001fbc0: 5f6e 6573 747d 2229 0a0a 2020 2020 2020  _nest}")..      
-0001fbd0: 2020 2020 2020 666f 7220 7265 7320 696e        for res in
-0001fbe0: 2073 656c 662e 6174 6f6d 5365 6c65 6374   self.atomSelect
-0001fbf0: 696f 6e53 6574 5b30 5d3a 0a20 2020 2020  ionSet[0]:.     
-0001fc00: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-0001fc10: 6c66 2e5f 5f64 6562 7567 3a0a 2020 2020  lf.__debug:.    
-0001fc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fc30: 7072 696e 7428 6622 7375 6274 7970 653d  print(f"subtype=
-0001fc40: 7b73 656c 662e 5f5f 6375 725f 7375 6274  {self.__cur_subt
-0001fc50: 7970 657d 2028 4269 6742 696e 2920 6964  ype} (BigBin) id
-0001fc60: 3d7b 7365 6c66 2e67 656f 5265 7374 7261  ={self.geoRestra
-0001fc70: 696e 7473 7d20 220a 2020 2020 2020 2020  ints} ".        
-0001fc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fc90: 2020 6622 7265 7369 6475 653d 7b72 6573    f"residue={res
-0001fca0: 7d20 6269 6e43 6861 723d 7b62 696e 4368  } binChar={binCh
-0001fcb0: 6172 7d20 7b64 7374 4675 6e63 7d22 290a  ar} {dstFunc}").
-0001fcc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fcd0: 6966 2073 656c 662e 5f5f 6372 6561 7465  if self.__create
-0001fce0: 5366 4469 6374 2061 6e64 2073 6620 6973  SfDict and sf is
-0001fcf0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-0001fd00: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001fd10: 665b 2769 6e64 6578 5f69 6427 5d20 2b3d  f['index_id'] +=
-0001fd20: 2031 0a20 2020 2020 2020 2020 2020 2020   1.             
-0001fd30: 2020 2020 2020 2073 665b 276c 6f6f 7027         sf['loop'
-0001fd40: 5d5b 2764 6174 6127 5d2e 6170 7065 6e64  ]['data'].append
-0001fd50: 285b 7366 5b27 696e 6465 785f 6964 275d  ([sf['index_id']
-0001fd60: 2c20 7366 5b27 6964 275d 2c0a 2020 2020  , sf['id'],.    
-0001fd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fd90: 2020 2020 2020 2020 2020 2072 6573 5b27             res['
-0001fda0: 6368 6169 6e5f 6964 275d 2c20 7265 735b  chain_id'], res[
-0001fdb0: 2773 6571 5f69 6427 5d2c 2072 6573 5b27  'seq_id'], res['
-0001fdc0: 636f 6d70 5f69 6427 5d2c 0a20 2020 2020  comp_id'],.     
-0001fdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fdf0: 2020 2020 2020 2020 2020 6269 6e43 6861            binCha
-0001fe00: 722c 2073 4465 762c 0a20 2020 2020 2020  r, sDev,.       
-0001fe10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fe20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fe30: 2020 2020 2020 2020 7366 5b27 6c69 7374          sf['list
-0001fe40: 5f69 6427 5d2c 2073 656c 662e 5f5f 656e  _id'], self.__en
-0001fe50: 7472 7949 645d 290a 0a20 2020 2020 2020  tryId])..       
-0001fe60: 2065 7863 6570 7420 5661 6c75 6545 7272   except ValueErr
-0001fe70: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
-0001fe80: 7365 6c66 2e67 656f 5265 7374 7261 696e  self.geoRestrain
-0001fe90: 7473 202d 3d20 310a 2020 2020 2020 2020  ts -= 1.        
-0001fea0: 6669 6e61 6c6c 793a 0a20 2020 2020 2020  finally:.       
-0001feb0: 2020 2020 2073 656c 662e 6e75 6d62 6572       self.number
-0001fec0: 5365 6c65 6374 696f 6e2e 636c 6561 7228  Selection.clear(
-0001fed0: 290a 0a20 2020 2023 2045 6e74 6572 2061  )..    # Enter a
-0001fee0: 2070 6172 7365 2074 7265 6520 7072 6f64   parse tree prod
-0001fef0: 7563 6564 2062 7920 526f 7365 7474 614d  uced by RosettaM
-0001ff00: 5250 6172 7365 7223 6e65 7374 6564 5f72  RParser#nested_r
-0001ff10: 6573 7472 6169 6e74 732e 0a20 2020 2064  estraints..    d
-0001ff20: 6566 2065 6e74 6572 4e65 7374 6564 5f72  ef enterNested_r
-0001ff30: 6573 7472 6169 6e74 7328 7365 6c66 2c20  estraints(self, 
-0001ff40: 6374 783a 2052 6f73 6574 7461 4d52 5061  ctx: RosettaMRPa
-0001ff50: 7273 6572 2e4e 6573 7465 645f 7265 7374  rser.Nested_rest
-0001ff60: 7261 696e 7473 436f 6e74 6578 7429 3a20  raintsContext): 
-0001ff70: 2023 2070 796c 696e 743a 2064 6973 6162   # pylint: disab
-0001ff80: 6c65 3d75 6e75 7365 642d 6172 6775 6d65  le=unused-argume
-0001ff90: 6e74 0a20 2020 2020 2020 2070 6173 730a  nt.        pass.
-0001ffa0: 0a20 2020 2023 2045 7869 7420 6120 7061  .    # Exit a pa
-0001ffb0: 7273 6520 7472 6565 2070 726f 6475 6365  rse tree produce
-0001ffc0: 6420 6279 2052 6f73 6574 7461 4d52 5061  d by RosettaMRPa
-0001ffd0: 7273 6572 236e 6573 7465 645f 7265 7374  rser#nested_rest
-0001ffe0: 7261 696e 7473 2e0a 2020 2020 6465 6620  raints..    def 
-0001fff0: 6578 6974 4e65 7374 6564 5f72 6573 7472  exitNested_restr
-00020000: 6169 6e74 7328 7365 6c66 2c20 6374 783a  aints(self, ctx:
-00020010: 2052 6f73 6574 7461 4d52 5061 7273 6572   RosettaMRParser
-00020020: 2e4e 6573 7465 645f 7265 7374 7261 696e  .Nested_restrain
-00020030: 7473 436f 6e74 6578 7429 3a20 2023 2070  tsContext):  # p
-00020040: 796c 696e 743a 2064 6973 6162 6c65 3d75  ylint: disable=u
-00020050: 6e75 7365 642d 6172 6775 6d65 6e74 0a20  nused-argument. 
-00020060: 2020 2020 2020 2070 6173 730a 0a20 2020         pass..   
-00020070: 2023 2045 6e74 6572 2061 2070 6172 7365   # Enter a parse
-00020080: 2074 7265 6520 7072 6f64 7563 6564 2062   tree produced b
-00020090: 7920 526f 7365 7474 614d 5250 6172 7365  y RosettaMRParse
-000200a0: 7223 6e65 7374 6564 5f72 6573 7472 6169  r#nested_restrai
-000200b0: 6e74 2e0a 2020 2020 6465 6620 656e 7465  nt..    def ente
-000200c0: 724e 6573 7465 645f 7265 7374 7261 696e  rNested_restrain
-000200d0: 7428 7365 6c66 2c20 6374 783a 2052 6f73  t(self, ctx: Ros
-000200e0: 6574 7461 4d52 5061 7273 6572 2e4e 6573  ettaMRParser.Nes
-000200f0: 7465 645f 7265 7374 7261 696e 7443 6f6e  ted_restraintCon
-00020100: 7465 7874 293a 0a20 2020 2020 2020 206e  text):.        n
-00020110: 203d 2030 0a20 2020 2020 2020 2077 6869   = 0.        whi
-00020120: 6c65 2063 7478 2e61 6e79 5f72 6573 7472  le ctx.any_restr
-00020130: 6169 6e74 286e 293a 0a20 2020 2020 2020  aint(n):.       
-00020140: 2020 2020 206e 202b 3d20 310a 0a20 2020       n += 1..   
-00020150: 2020 2020 2073 656c 662e 5f5f 6375 725f       self.__cur_
-00020160: 6e65 7374 203d 207b 7d0a 0a20 2020 2020  nest = {}..     
-00020170: 2020 2069 6620 6374 782e 4d75 6c74 6943     if ctx.MultiC
-00020180: 6f6e 7374 7261 696e 7428 293a 0a20 2020  onstraint():.   
-00020190: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
-000201a0: 6375 725f 6e65 7374 5b27 7479 7065 275d  cur_nest['type']
-000201b0: 203d 2027 6d75 6c74 6927 0a20 2020 2020   = 'multi'.     
-000201c0: 2020 2065 6c69 6620 6374 782e 416d 6269     elif ctx.Ambi
-000201d0: 6775 6f75 7343 6f6e 7374 7261 696e 7428  guousConstraint(
-000201e0: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
-000201f0: 656c 662e 5f5f 6375 725f 6e65 7374 5b27  elf.__cur_nest['
-00020200: 7479 7065 275d 203d 2027 616d 6269 6727  type'] = 'ambig'
-00020210: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00020220: 2020 2020 2020 2020 2020 206b 203d 2069             k = i
-00020230: 6e74 2873 7472 2863 7478 2e49 6e74 6567  nt(str(ctx.Integ
-00020240: 6572 2829 2929 0a20 2020 2020 2020 2020  er())).         
-00020250: 2020 2073 656c 662e 5f5f 6375 725f 6e65     self.__cur_ne
-00020260: 7374 5b27 7479 7065 275d 203d 2066 227b  st['type'] = f"{
-00020270: 6b7d 6f66 7b6e 7d22 0a0a 2020 2020 2020  k}of{n}"..      
-00020280: 2020 7365 6c66 2e5f 5f63 7572 5f6e 6573    self.__cur_nes
-00020290: 745b 2769 6427 5d20 3d20 2d31 0a20 2020  t['id'] = -1.   
-000202a0: 2020 2020 2073 656c 662e 5f5f 6375 725f       self.__cur_
-000202b0: 6e65 7374 5b27 7369 7a65 275d 203d 206e  nest['size'] = n
-000202c0: 0a0a 2020 2020 2320 4578 6974 2061 2070  ..    # Exit a p
-000202d0: 6172 7365 2074 7265 6520 7072 6f64 7563  arse tree produc
-000202e0: 6564 2062 7920 526f 7365 7474 614d 5250  ed by RosettaMRP
-000202f0: 6172 7365 7223 6e65 7374 6564 5f72 6573  arser#nested_res
-00020300: 7472 6169 6e74 2e0a 2020 2020 6465 6620  traint..    def 
-00020310: 6578 6974 4e65 7374 6564 5f72 6573 7472  exitNested_restr
-00020320: 6169 6e74 2873 656c 662c 2063 7478 3a20  aint(self, ctx: 
-00020330: 526f 7365 7474 614d 5250 6172 7365 722e  RosettaMRParser.
-00020340: 4e65 7374 6564 5f72 6573 7472 6169 6e74  Nested_restraint
-00020350: 436f 6e74 6578 7429 3a20 2023 2070 796c  Context):  # pyl
-00020360: 696e 743a 2064 6973 6162 6c65 3d75 6e75  int: disable=unu
-00020370: 7365 642d 6172 6775 6d65 6e74 0a20 2020  sed-argument.   
-00020380: 2020 2020 2073 656c 662e 5f5f 6375 725f       self.__cur_
-00020390: 6e65 7374 203d 204e 6f6e 650a 0a20 2020  nest = None..   
-000203a0: 2023 2045 6e74 6572 2061 2070 6172 7365   # Enter a parse
-000203b0: 2074 7265 6520 7072 6f64 7563 6564 2062   tree produced b
-000203c0: 7920 526f 7365 7474 614d 5250 6172 7365  y RosettaMRParse
-000203d0: 7223 616e 795f 7265 7374 7261 696e 742e  r#any_restraint.
-000203e0: 0a20 2020 2064 6566 2065 6e74 6572 416e  .    def enterAn
-000203f0: 795f 7265 7374 7261 696e 7428 7365 6c66  y_restraint(self
-00020400: 2c20 6374 783a 2052 6f73 6574 7461 4d52  , ctx: RosettaMR
-00020410: 5061 7273 6572 2e41 6e79 5f72 6573 7472  Parser.Any_restr
-00020420: 6169 6e74 436f 6e74 6578 7429 3a20 2023  aintContext):  #
-00020430: 2070 796c 696e 743a 2064 6973 6162 6c65   pylint: disable
-00020440: 3d75 6e75 7365 642d 6172 6775 6d65 6e74  =unused-argument
-00020450: 0a20 2020 2020 2020 2073 656c 662e 5f5f  .        self.__
-00020460: 6375 725f 6e65 7374 5b27 6964 275d 203d  cur_nest['id'] =
-00020470: 2073 656c 662e 5f5f 6375 725f 6e65 7374   self.__cur_nest
-00020480: 5b27 6964 275d 202b 2031 0a0a 2020 2020  ['id'] + 1..    
-00020490: 2320 4578 6974 2061 2070 6172 7365 2074  # Exit a parse t
-000204a0: 7265 6520 7072 6f64 7563 6564 2062 7920  ree produced by 
-000204b0: 526f 7365 7474 614d 5250 6172 7365 7223  RosettaMRParser#
-000204c0: 616e 795f 7265 7374 7261 696e 742e 0a20  any_restraint.. 
-000204d0: 2020 2064 6566 2065 7869 7441 6e79 5f72     def exitAny_r
-000204e0: 6573 7472 6169 6e74 2873 656c 662c 2063  estraint(self, c
-000204f0: 7478 3a20 526f 7365 7474 614d 5250 6172  tx: RosettaMRPar
-00020500: 7365 722e 416e 795f 7265 7374 7261 696e  ser.Any_restrain
-00020510: 7443 6f6e 7465 7874 293a 2020 2320 7079  tContext):  # py
-00020520: 6c69 6e74 3a20 6469 7361 626c 653d 756e  lint: disable=un
-00020530: 7573 6564 2d61 7267 756d 656e 740a 2020  used-argument.  
-00020540: 2020 2020 2020 7061 7373 0a0a 2020 2020        pass..    
-00020550: 2320 456e 7465 7220 6120 7061 7273 6520  # Enter a parse 
-00020560: 7472 6565 2070 726f 6475 6365 6420 6279  tree produced by
-00020570: 2052 6f73 6574 7461 4d52 5061 7273 6572   RosettaMRParser
-00020580: 2366 756e 635f 7479 7065 5f64 6566 2e0a  #func_type_def..
-00020590: 2020 2020 6465 6620 656e 7465 7246 756e      def enterFun
-000205a0: 635f 7479 7065 5f64 6566 2873 656c 662c  c_type_def(self,
-000205b0: 2063 7478 3a20 526f 7365 7474 614d 5250   ctx: RosettaMRP
-000205c0: 6172 7365 722e 4675 6e63 5f74 7970 655f  arser.Func_type_
-000205d0: 6465 6643 6f6e 7465 7874 293a 2020 2320  defContext):  # 
-000205e0: 7079 6c69 6e74 3a20 6469 7361 626c 653d  pylint: disable=
-000205f0: 756e 7573 6564 2d61 7267 756d 656e 740a  unused-argument.
-00020600: 2020 2020 2020 2020 7061 7373 0a0a 2020          pass..  
-00020610: 2020 2320 4578 6974 2061 2070 6172 7365    # Exit a parse
-00020620: 2074 7265 6520 7072 6f64 7563 6564 2062   tree produced b
-00020630: 7920 526f 7365 7474 614d 5250 6172 7365  y RosettaMRParse
-00020640: 7223 6675 6e63 5f74 7970 655f 6465 662e  r#func_type_def.
-00020650: 0a20 2020 2064 6566 2065 7869 7446 756e  .    def exitFun
-00020660: 635f 7479 7065 5f64 6566 2873 656c 662c  c_type_def(self,
-00020670: 2063 7478 3a20 526f 7365 7474 614d 5250   ctx: RosettaMRP
-00020680: 6172 7365 722e 4675 6e63 5f74 7970 655f  arser.Func_type_
-00020690: 6465 6643 6f6e 7465 7874 293a 0a20 2020  defContext):.   
-000206a0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000206b0: 2028 4349 5243 554c 4152 4841 524d 4f4e   (CIRCULARHARMON
-000206c0: 4943 207c 2048 4152 4d4f 4e49 4320 7c20  IC | HARMONIC | 
-000206d0: 5349 474d 4f49 4420 7c20 5351 5541 5245  SIGMOID | SQUARE
-000206e0: 5f57 454c 4c29 2046 6c6f 6174 2046 6c6f  _WELL) Float Flo
-000206f0: 6174 207c 0a20 2020 2020 2020 2042 4f55  at |.        BOU
-00020700: 4e44 4544 2046 6c6f 6174 2046 6c6f 6174  NDED Float Float
-00020710: 2046 6c6f 6174 2046 6c6f 6174 3f20 5369   Float Float? Si
-00020720: 6d70 6c65 5f6e 616d 652a 207c 0a20 2020  mple_name* |.   
-00020730: 2020 2020 2050 4552 494f 4449 4342 4f55       PERIODICBOU
-00020740: 4e44 4544 2046 6c6f 6174 2046 6c6f 6174  NDED Float Float
-00020750: 2046 6c6f 6174 2046 6c6f 6174 2046 6c6f   Float Float Flo
-00020760: 6174 3f20 5369 6d70 6c65 5f6e 616d 652a  at? Simple_name*
-00020770: 207c 0a20 2020 2020 2020 204f 4646 5345   |.        OFFSE
-00020780: 5450 4552 494f 4449 4342 4f55 4e44 4544  TPERIODICBOUNDED
-00020790: 2046 6c6f 6174 2046 6c6f 6174 2046 6c6f   Float Float Flo
-000207a0: 6174 2046 6c6f 6174 2046 6c6f 6174 2046  at Float Float F
-000207b0: 6c6f 6174 3f20 5369 6d70 6c65 5f6e 616d  loat? Simple_nam
-000207c0: 652a 207c 0a20 2020 2020 2020 2028 414d  e* |.        (AM
-000207d0: 4245 5250 4552 494f 4449 4320 7c20 4348  BERPERIODIC | CH
-000207e0: 4152 4d4d 5045 5249 4f44 4943 207c 2046  ARMMPERIODIC | F
-000207f0: 4c41 545f 4841 524d 4f4e 4943 207c 2054  LAT_HARMONIC | T
-00020800: 4f50 4f55 5429 2046 6c6f 6174 2046 6c6f  OPOUT) Float Flo
-00020810: 6174 2046 6c6f 6174 207c 0a20 2020 2020  at Float |.     
-00020820: 2020 2028 4349 5243 554c 4152 5349 474d     (CIRCULARSIGM
-00020830: 4f49 4441 4c20 7c20 4c49 4e45 4152 5f50  OIDAL | LINEAR_P
-00020840: 454e 414c 5459 2920 466c 6f61 7420 466c  ENALTY) Float Fl
-00020850: 6f61 7420 466c 6f61 7420 466c 6f61 7420  oat Float Float 
-00020860: 7c0a 2020 2020 2020 2020 4349 5243 554c  |.        CIRCUL
-00020870: 4152 5350 4c49 4e45 2046 6c6f 6174 2b20  ARSPLINE Float+ 
-00020880: 7c0a 2020 2020 2020 2020 4741 5553 5349  |.        GAUSSI
-00020890: 414e 4655 4e43 2046 6c6f 6174 2046 6c6f  ANFUNC Float Flo
-000208a0: 6174 2053 696d 706c 655f 6e61 6d65 2028  at Simple_name (
-000208b0: 5745 4947 4854 2046 6c6f 6174 293f 207c  WEIGHT Float)? |
-000208c0: 0a20 2020 2020 2020 2053 4f47 4655 4e43  .        SOGFUNC
-000208d0: 2049 6e74 6567 6572 2028 466c 6f61 7420   Integer (Float 
-000208e0: 466c 6f61 7420 466c 6f61 7429 2b20 7c0a  Float Float)+ |.
-000208f0: 2020 2020 2020 2020 284d 4958 5455 5245          (MIXTURE
-00020900: 4655 4e43 207c 204b 4152 504c 5553 207c  FUNC | KARPLUS |
-00020910: 2053 4f45 4449 4e47 4655 4e43 2920 466c   SOEDINGFUNC) Fl
-00020920: 6f61 7420 466c 6f61 7420 466c 6f61 7420  oat Float Float 
-00020930: 466c 6f61 7420 466c 6f61 7420 466c 6f61  Float Float Floa
-00020940: 7420 7c0a 2020 2020 2020 2020 434f 4e53  t |.        CONS
-00020950: 5441 4e54 4655 4e43 2046 6c6f 6174 207c  TANTFUNC Float |
-00020960: 0a20 2020 2020 2020 2049 4445 4e54 4954  .        IDENTIT
-00020970: 5920 7c0a 2020 2020 2020 2020 5343 414c  Y |.        SCAL
-00020980: 4152 5745 4947 4854 4544 4655 4e43 2046  ARWEIGHTEDFUNC F
-00020990: 6c6f 6174 2066 756e 635f 7479 7065 5f64  loat func_type_d
-000209a0: 6566 207c 0a20 2020 2020 2020 2053 554d  ef |.        SUM
-000209b0: 4655 4e43 2049 6e74 6567 6572 2066 756e  FUNC Integer fun
-000209c0: 635f 7479 7065 5f64 6566 2b20 7c0a 2020  c_type_def+ |.  
-000209d0: 2020 2020 2020 5350 4c49 4e45 2053 696d        SPLINE Sim
-000209e0: 706c 655f 6e61 6d65 2028 466c 6f61 7420  ple_name (Float 
-000209f0: 466c 6f61 7420 466c 6f61 7420 7c20 4e4f  Float Float | NO
-00020a00: 4e45 2046 6c6f 6174 2046 6c6f 6174 2046  NE Float Float F
-00020a10: 6c6f 6174 2028 5369 6d70 6c65 5f6e 616d  loat (Simple_nam
-00020a20: 6520 466c 6f61 742a 292b 2920 2f2f 2068  e Float*)+) // h
-00020a30: 6973 746f 6772 616d 5f66 696c 655f 7061  istogram_file_pa
-00020a40: 7468 2063 616e 206e 6f74 2062 6520 6576  th can not be ev
-00020a50: 616c 7561 7465 640a 2020 2020 2020 2020  aluated.        
-00020a60: 4641 4445 2046 6c6f 6174 2046 6c6f 6174  FADE Float Float
-00020a70: 2046 6c6f 6174 2046 6c6f 6174 2046 6c6f   Float Float Flo
-00020a80: 6174 3f20 7c0a 2020 2020 2020 2020 5351  at? |.        SQ
-00020a90: 5541 5245 5f57 454c 4c32 2046 6c6f 6174  UARE_WELL2 Float
-00020aa0: 2046 6c6f 6174 2046 6c6f 6174 2044 4547   Float Float DEG
-00020ab0: 5245 4553 3f20 7c0a 2020 2020 2020 2020  REES? |.        
-00020ac0: 4554 4142 4c45 2046 6c6f 6174 2046 6c6f  ETABLE Float Flo
-00020ad0: 6174 2046 6c6f 6174 2a20 7c0a 2020 2020  at Float* |.    
-00020ae0: 2020 2020 5553 4f47 2049 6e74 6567 6572      USOG Integer
-00020af0: 2028 466c 6f61 7420 466c 6f61 7420 466c   (Float Float Fl
-00020b00: 6f61 7420 466c 6f61 7429 2b20 7c0a 2020  oat Float)+ |.  
-00020b10: 2020 2020 2020 534f 4720 496e 7465 6765        SOG Intege
-00020b20: 7220 2846 6c6f 6174 2046 6c6f 6174 2046  r (Float Float F
-00020b30: 6c6f 6174 2046 6c6f 6174 2046 6c6f 6174  loat Float Float
-00020b40: 2046 6c6f 6174 292b 3b0a 2020 2020 2020   Float)+;.      
-00020b50: 2020 2222 220a 0a20 2020 2020 2020 2074    """..        t
-00020b60: 7279 3a0a 0a20 2020 2020 2020 2020 2020  ry:..           
-00020b70: 2066 756e 6320 3d20 7b7d 0a20 2020 2020   func = {}.     
-00020b80: 2020 2020 2020 2076 616c 6964 203d 2054         valid = T
-00020b90: 7275 650a 0a20 2020 2020 2020 2020 2020  rue..           
-00020ba0: 2069 6620 6c65 6e28 7365 6c66 2e6e 756d   if len(self.num
-00020bb0: 6265 7246 5365 6c65 6374 696f 6e29 203d  berFSelection) =
-00020bc0: 3d20 3020 6f72 204e 6f6e 6520 696e 2073  = 0 or None in s
-00020bd0: 656c 662e 6e75 6d62 6572 4653 656c 6563  elf.numberFSelec
-00020be0: 7469 6f6e 3a0a 2020 2020 2020 2020 2020  tion:.          
-00020bf0: 2020 2020 2020 7265 7475 726e 0a0a 2020        return..  
-00020c00: 2020 2020 2020 2020 2020 6966 2063 7478            if ctx
-00020c10: 2e43 4952 4355 4c41 5248 4152 4d4f 4e49  .CIRCULARHARMONI
-00020c20: 4328 2920 6f72 2063 7478 2e48 4152 4d4f  C() or ctx.HARMO
-00020c30: 4e49 4328 2920 6f72 2063 7478 2e53 4947  NIC() or ctx.SIG
-00020c40: 4d4f 4944 2829 206f 7220 6374 782e 5351  MOID() or ctx.SQ
-00020c50: 5541 5245 5f57 454c 4c28 293a 0a20 2020  UARE_WELL():.   
-00020c60: 2020 2020 2020 2020 2020 2020 2078 3020               x0 
-00020c70: 3d20 7365 6c66 2e6e 756d 6265 7246 5365  = self.numberFSe
-00020c80: 6c65 6374 696f 6e5b 305d 0a0a 2020 2020  lection[0]..    
-00020c90: 2020 2020 2020 2020 2020 2020 6675 6e63              func
-00020ca0: 5b27 7830 275d 203d 2078 300a 0a20 2020  ['x0'] = x0..   
-00020cb0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00020cc0: 6374 782e 4349 5243 554c 4152 4841 524d  ctx.CIRCULARHARM
-00020cd0: 4f4e 4943 2829 3a20 2023 2078 3020 7364  ONIC():  # x0 sd
-00020ce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00020cf0: 2020 2020 2066 756e 6354 7970 6520 3d20       funcType = 
-00020d00: 2743 4952 4355 4c41 5248 4152 4d4f 4e49  'CIRCULARHARMONI
-00020d10: 4327 0a0a 2020 2020 2020 2020 2020 2020  C'..            
-00020d20: 2020 2020 2020 2020 7364 203d 2073 656c          sd = sel
-00020d30: 662e 6e75 6d62 6572 4653 656c 6563 7469  f.numberFSelecti
-00020d40: 6f6e 5b31 5d0a 0a20 2020 2020 2020 2020  on[1]..         
-00020d50: 2020 2020 2020 2020 2020 2066 756e 635b             func[
-00020d60: 2773 6427 5d20 3d20 7364 0a0a 2020 2020  'sd'] = sd..    
-00020d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020d80: 6966 2073 6420 3c3d 2030 2e30 3a0a 2020  if sd <= 0.0:.  
+0001f4d0: 2020 2020 2020 2020 6966 2044 4953 545f          if DIST_
+0001f4e0: 5241 4e47 455f 4d49 4e20 3c3d 2073 4465  RANGE_MIN <= sDe
+0001f4f0: 7620 3c3d 2044 4953 545f 5241 4e47 455f  v <= DIST_RANGE_
+0001f500: 4d41 583a 0a20 2020 2020 2020 2020 2020  MAX:.           
+0001f510: 2020 2020 2070 6173 730a 2020 2020 2020       pass.      
+0001f520: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0001f530: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001f540: 2e5f 5f66 2e61 7070 656e 6428 6622 5b52  .__f.append(f"[R
+0001f550: 616e 6765 2076 616c 7565 2077 6172 6e69  ange value warni
+0001f560: 6e67 5d20 7b73 656c 662e 5f5f 6765 7443  ng] {self.__getC
+0001f570: 7572 7265 6e74 5265 7374 7261 696e 7428  urrentRestraint(
+0001f580: 297d 220a 2020 2020 2020 2020 2020 2020  )}".            
+0001f590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f5a0: 2020 2020 6622 5468 6520 2773 6465 763d      f"The 'sdev=
+0001f5b0: 7b73 4465 767d 2720 7368 6f75 6c64 2062  {sDev}' should b
+0001f5c0: 6520 7769 7468 696e 2072 616e 6765 207b  e within range {
+0001f5d0: 4449 5354 5f52 4553 5452 4149 4e54 5f52  DIST_RESTRAINT_R
+0001f5e0: 414e 4745 7d2e 2229 0a0a 2020 2020 2020  ANGE}.")..      
+0001f5f0: 2020 2020 2020 6966 2073 656c 662e 5f5f        if self.__
+0001f600: 6372 6561 7465 5366 4469 6374 3a0a 2020  createSfDict:.  
+0001f610: 2020 2020 2020 2020 2020 2020 2020 7366                sf
+0001f620: 203d 2073 656c 662e 5f5f 6765 7453 6628   = self.__getSf(
+0001f630: 2264 6968 6564 7261 6c20 616e 676c 6520  "dihedral angle 
+0001f640: 7265 7374 7261 696e 742c 2052 4f53 4554  restraint, ROSET
+0001f650: 5441 2042 6967 4269 6e20 220a 2020 2020  TA BigBin ".    
+0001f660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f670: 2020 2020 2020 2020 2020 2020 2020 2228                "(
+0001f680: 274f 2720 666f 7220 6369 732d 6c69 6b65  'O' for cis-like
+0001f690: 204f 4d45 4741 2c20 2747 2720 666f 7220   OMEGA, 'G' for 
+0001f6a0: 5048 492c 5053 4920 696e 2031 3030 2c31  PHI,PSI in 100,1
+0001f6b0: 3030 2c20 2745 2720 666f 7220 3130 302c  00, 'E' for 100,
+0001f6c0: 2d39 302c 2027 4127 2066 6f72 202d 3530  -90, 'A' for -50
+0001f6d0: 2c33 302c 2027 4227 2066 6f72 2031 3030  ,30, 'B' for 100
+0001f6e0: 2c31 3735 2922 290a 2020 2020 2020 2020  ,175)").        
+0001f6f0: 2020 2020 2020 2020 7366 5b27 6964 275d          sf['id']
+0001f700: 202b 3d20 310a 2020 2020 2020 2020 2020   += 1.          
+0001f710: 2020 2020 2020 6966 206c 656e 2873 665b        if len(sf[
+0001f720: 276c 6f6f 7027 5d5b 2774 6167 7327 5d29  'loop']['tags'])
+0001f730: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
+0001f740: 2020 2020 2020 2020 2020 2073 665b 276c             sf['l
+0001f750: 6f6f 7027 5d5b 2774 6167 7327 5d20 3d20  oop']['tags'] = 
+0001f760: 5b27 696e 6465 785f 6964 272c 2027 6964  ['index_id', 'id
+0001f770: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+0001f780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f790: 2020 2020 2020 2020 2020 2020 2027 6175               'au
+0001f7a0: 7468 5f61 7379 6d5f 6964 5f31 272c 2027  th_asym_id_1', '
+0001f7b0: 6175 7468 5f73 6571 5f69 645f 3127 2c20  auth_seq_id_1', 
+0001f7c0: 2761 7574 685f 636f 6d70 5f69 645f 3127  'auth_comp_id_1'
+0001f7d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001f7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f7f0: 2020 2020 2020 2020 2020 2020 2762 696e              'bin
+0001f800: 5f63 6f64 6527 2c20 2773 7461 6e64 6172  _code', 'standar
+0001f810: 645f 6465 7669 6174 696f 6e27 2c0a 2020  d_deviation',.  
+0001f820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f840: 2020 2020 2020 2020 276c 6973 745f 6964          'list_id
+0001f850: 272c 2027 656e 7472 795f 6964 275d 0a0a  ', 'entry_id']..
+0001f860: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0001f870: 656c 662e 5f5f 6375 725f 6e65 7374 2069  elf.__cur_nest i
+0001f880: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+0001f890: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0001f8a0: 656c 662e 5f5f 6465 6275 673a 0a20 2020  elf.__debug:.   
+0001f8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f8c0: 2070 7269 6e74 2866 224e 4553 5445 443a   print(f"NESTED:
+0001f8d0: 207b 7365 6c66 2e5f 5f63 7572 5f6e 6573   {self.__cur_nes
+0001f8e0: 747d 2229 0a0a 2020 2020 2020 2020 2020  t}")..          
+0001f8f0: 2020 666f 7220 7265 7320 696e 2073 656c    for res in sel
+0001f900: 662e 6174 6f6d 5365 6c65 6374 696f 6e53  f.atomSelectionS
+0001f910: 6574 5b30 5d3a 0a20 2020 2020 2020 2020  et[0]:.         
+0001f920: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
+0001f930: 5f64 6562 7567 3a0a 2020 2020 2020 2020  _debug:.        
+0001f940: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+0001f950: 7428 6622 7375 6274 7970 653d 7b73 656c  t(f"subtype={sel
+0001f960: 662e 5f5f 6375 725f 7375 6274 7970 657d  f.__cur_subtype}
+0001f970: 2028 4269 6742 696e 2920 6964 3d7b 7365   (BigBin) id={se
+0001f980: 6c66 2e67 656f 5265 7374 7261 696e 7473  lf.geoRestraints
+0001f990: 7d20 220a 2020 2020 2020 2020 2020 2020  } ".            
+0001f9a0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+0001f9b0: 7265 7369 6475 653d 7b72 6573 7d20 6269  residue={res} bi
+0001f9c0: 6e43 6861 723d 7b62 696e 4368 6172 7d20  nChar={binChar} 
+0001f9d0: 7b64 7374 4675 6e63 7d22 290a 2020 2020  {dstFunc}").    
+0001f9e0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0001f9f0: 656c 662e 5f5f 6372 6561 7465 5366 4469  elf.__createSfDi
+0001fa00: 6374 2061 6e64 2073 6620 6973 206e 6f74  ct and sf is not
+0001fa10: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0001fa20: 2020 2020 2020 2020 2020 2073 665b 2769             sf['i
+0001fa30: 6e64 6578 5f69 6427 5d20 2b3d 2031 0a20  ndex_id'] += 1. 
+0001fa40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fa50: 2020 2073 665b 276c 6f6f 7027 5d5b 2764     sf['loop']['d
+0001fa60: 6174 6127 5d2e 6170 7065 6e64 285b 7366  ata'].append([sf
+0001fa70: 5b27 696e 6465 785f 6964 275d 2c20 7366  ['index_id'], sf
+0001fa80: 5b27 6964 275d 2c0a 2020 2020 2020 2020  ['id'],.        
+0001fa90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001faa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fab0: 2020 2020 2020 2072 6573 5b27 6368 6169         res['chai
+0001fac0: 6e5f 6964 275d 2c20 7265 735b 2773 6571  n_id'], res['seq
+0001fad0: 5f69 6427 5d2c 2072 6573 5b27 636f 6d70  _id'], res['comp
+0001fae0: 5f69 6427 5d2c 0a20 2020 2020 2020 2020  _id'],.         
+0001faf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fb10: 2020 2020 2020 6269 6e43 6861 722c 2073        binChar, s
+0001fb20: 4465 762c 0a20 2020 2020 2020 2020 2020  Dev,.           
+0001fb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fb50: 2020 2020 7366 5b27 6c69 7374 5f69 6427      sf['list_id'
+0001fb60: 5d2c 2073 656c 662e 5f5f 656e 7472 7949  ], self.__entryI
+0001fb70: 645d 290a 0a20 2020 2020 2020 2065 7863  d])..        exc
+0001fb80: 6570 7420 5661 6c75 6545 7272 6f72 3a0a  ept ValueError:.
+0001fb90: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001fba0: 2e67 656f 5265 7374 7261 696e 7473 202d  .geoRestraints -
+0001fbb0: 3d20 310a 2020 2020 2020 2020 6669 6e61  = 1.        fina
+0001fbc0: 6c6c 793a 0a20 2020 2020 2020 2020 2020  lly:.           
+0001fbd0: 2073 656c 662e 6e75 6d62 6572 5365 6c65   self.numberSele
+0001fbe0: 6374 696f 6e2e 636c 6561 7228 290a 0a20  ction.clear().. 
+0001fbf0: 2020 2023 2045 6e74 6572 2061 2070 6172     # Enter a par
+0001fc00: 7365 2074 7265 6520 7072 6f64 7563 6564  se tree produced
+0001fc10: 2062 7920 526f 7365 7474 614d 5250 6172   by RosettaMRPar
+0001fc20: 7365 7223 6e65 7374 6564 5f72 6573 7472  ser#nested_restr
+0001fc30: 6169 6e74 732e 0a20 2020 2064 6566 2065  aints..    def e
+0001fc40: 6e74 6572 4e65 7374 6564 5f72 6573 7472  nterNested_restr
+0001fc50: 6169 6e74 7328 7365 6c66 2c20 6374 783a  aints(self, ctx:
+0001fc60: 2052 6f73 6574 7461 4d52 5061 7273 6572   RosettaMRParser
+0001fc70: 2e4e 6573 7465 645f 7265 7374 7261 696e  .Nested_restrain
+0001fc80: 7473 436f 6e74 6578 7429 3a20 2023 2070  tsContext):  # p
+0001fc90: 796c 696e 743a 2064 6973 6162 6c65 3d75  ylint: disable=u
+0001fca0: 6e75 7365 642d 6172 6775 6d65 6e74 0a20  nused-argument. 
+0001fcb0: 2020 2020 2020 2070 6173 730a 0a20 2020         pass..   
+0001fcc0: 2023 2045 7869 7420 6120 7061 7273 6520   # Exit a parse 
+0001fcd0: 7472 6565 2070 726f 6475 6365 6420 6279  tree produced by
+0001fce0: 2052 6f73 6574 7461 4d52 5061 7273 6572   RosettaMRParser
+0001fcf0: 236e 6573 7465 645f 7265 7374 7261 696e  #nested_restrain
+0001fd00: 7473 2e0a 2020 2020 6465 6620 6578 6974  ts..    def exit
+0001fd10: 4e65 7374 6564 5f72 6573 7472 6169 6e74  Nested_restraint
+0001fd20: 7328 7365 6c66 2c20 6374 783a 2052 6f73  s(self, ctx: Ros
+0001fd30: 6574 7461 4d52 5061 7273 6572 2e4e 6573  ettaMRParser.Nes
+0001fd40: 7465 645f 7265 7374 7261 696e 7473 436f  ted_restraintsCo
+0001fd50: 6e74 6578 7429 3a20 2023 2070 796c 696e  ntext):  # pylin
+0001fd60: 743a 2064 6973 6162 6c65 3d75 6e75 7365  t: disable=unuse
+0001fd70: 642d 6172 6775 6d65 6e74 0a20 2020 2020  d-argument.     
+0001fd80: 2020 2070 6173 730a 0a20 2020 2023 2045     pass..    # E
+0001fd90: 6e74 6572 2061 2070 6172 7365 2074 7265  nter a parse tre
+0001fda0: 6520 7072 6f64 7563 6564 2062 7920 526f  e produced by Ro
+0001fdb0: 7365 7474 614d 5250 6172 7365 7223 6e65  settaMRParser#ne
+0001fdc0: 7374 6564 5f72 6573 7472 6169 6e74 2e0a  sted_restraint..
+0001fdd0: 2020 2020 6465 6620 656e 7465 724e 6573      def enterNes
+0001fde0: 7465 645f 7265 7374 7261 696e 7428 7365  ted_restraint(se
+0001fdf0: 6c66 2c20 6374 783a 2052 6f73 6574 7461  lf, ctx: Rosetta
+0001fe00: 4d52 5061 7273 6572 2e4e 6573 7465 645f  MRParser.Nested_
+0001fe10: 7265 7374 7261 696e 7443 6f6e 7465 7874  restraintContext
+0001fe20: 293a 0a20 2020 2020 2020 206e 203d 2030  ):.        n = 0
+0001fe30: 0a20 2020 2020 2020 2077 6869 6c65 2063  .        while c
+0001fe40: 7478 2e61 6e79 5f72 6573 7472 6169 6e74  tx.any_restraint
+0001fe50: 286e 293a 0a20 2020 2020 2020 2020 2020  (n):.           
+0001fe60: 206e 202b 3d20 310a 0a20 2020 2020 2020   n += 1..       
+0001fe70: 2073 656c 662e 5f5f 6375 725f 6e65 7374   self.__cur_nest
+0001fe80: 203d 207b 7d0a 0a20 2020 2020 2020 2069   = {}..        i
+0001fe90: 6620 6374 782e 4d75 6c74 6943 6f6e 7374  f ctx.MultiConst
+0001fea0: 7261 696e 7428 293a 0a20 2020 2020 2020  raint():.       
+0001feb0: 2020 2020 2073 656c 662e 5f5f 6375 725f       self.__cur_
+0001fec0: 6e65 7374 5b27 7479 7065 275d 203d 2027  nest['type'] = '
+0001fed0: 6d75 6c74 6927 0a20 2020 2020 2020 2065  multi'.        e
+0001fee0: 6c69 6620 6374 782e 416d 6269 6775 6f75  lif ctx.Ambiguou
+0001fef0: 7343 6f6e 7374 7261 696e 7428 293a 0a20  sConstraint():. 
+0001ff00: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001ff10: 5f5f 6375 725f 6e65 7374 5b27 7479 7065  __cur_nest['type
+0001ff20: 275d 203d 2027 616d 6269 6727 0a20 2020  '] = 'ambig'.   
+0001ff30: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0001ff40: 2020 2020 2020 206b 203d 2069 6e74 2873         k = int(s
+0001ff50: 7472 2863 7478 2e49 6e74 6567 6572 2829  tr(ctx.Integer()
+0001ff60: 2929 0a20 2020 2020 2020 2020 2020 2073  )).            s
+0001ff70: 656c 662e 5f5f 6375 725f 6e65 7374 5b27  elf.__cur_nest['
+0001ff80: 7479 7065 275d 203d 2066 227b 6b7d 6f66  type'] = f"{k}of
+0001ff90: 7b6e 7d22 0a0a 2020 2020 2020 2020 7365  {n}"..        se
+0001ffa0: 6c66 2e5f 5f63 7572 5f6e 6573 745b 2769  lf.__cur_nest['i
+0001ffb0: 6427 5d20 3d20 2d31 0a20 2020 2020 2020  d'] = -1.       
+0001ffc0: 2073 656c 662e 5f5f 6375 725f 6e65 7374   self.__cur_nest
+0001ffd0: 5b27 7369 7a65 275d 203d 206e 0a0a 2020  ['size'] = n..  
+0001ffe0: 2020 2320 4578 6974 2061 2070 6172 7365    # Exit a parse
+0001fff0: 2074 7265 6520 7072 6f64 7563 6564 2062   tree produced b
+00020000: 7920 526f 7365 7474 614d 5250 6172 7365  y RosettaMRParse
+00020010: 7223 6e65 7374 6564 5f72 6573 7472 6169  r#nested_restrai
+00020020: 6e74 2e0a 2020 2020 6465 6620 6578 6974  nt..    def exit
+00020030: 4e65 7374 6564 5f72 6573 7472 6169 6e74  Nested_restraint
+00020040: 2873 656c 662c 2063 7478 3a20 526f 7365  (self, ctx: Rose
+00020050: 7474 614d 5250 6172 7365 722e 4e65 7374  ttaMRParser.Nest
+00020060: 6564 5f72 6573 7472 6169 6e74 436f 6e74  ed_restraintCont
+00020070: 6578 7429 3a20 2023 2070 796c 696e 743a  ext):  # pylint:
+00020080: 2064 6973 6162 6c65 3d75 6e75 7365 642d   disable=unused-
+00020090: 6172 6775 6d65 6e74 0a20 2020 2020 2020  argument.       
+000200a0: 2073 656c 662e 5f5f 6375 725f 6e65 7374   self.__cur_nest
+000200b0: 203d 204e 6f6e 650a 0a20 2020 2023 2045   = None..    # E
+000200c0: 6e74 6572 2061 2070 6172 7365 2074 7265  nter a parse tre
+000200d0: 6520 7072 6f64 7563 6564 2062 7920 526f  e produced by Ro
+000200e0: 7365 7474 614d 5250 6172 7365 7223 616e  settaMRParser#an
+000200f0: 795f 7265 7374 7261 696e 742e 0a20 2020  y_restraint..   
+00020100: 2064 6566 2065 6e74 6572 416e 795f 7265   def enterAny_re
+00020110: 7374 7261 696e 7428 7365 6c66 2c20 6374  straint(self, ct
+00020120: 783a 2052 6f73 6574 7461 4d52 5061 7273  x: RosettaMRPars
+00020130: 6572 2e41 6e79 5f72 6573 7472 6169 6e74  er.Any_restraint
+00020140: 436f 6e74 6578 7429 3a20 2023 2070 796c  Context):  # pyl
+00020150: 696e 743a 2064 6973 6162 6c65 3d75 6e75  int: disable=unu
+00020160: 7365 642d 6172 6775 6d65 6e74 0a20 2020  sed-argument.   
+00020170: 2020 2020 2073 656c 662e 5f5f 6375 725f       self.__cur_
+00020180: 6e65 7374 5b27 6964 275d 203d 2073 656c  nest['id'] = sel
+00020190: 662e 5f5f 6375 725f 6e65 7374 5b27 6964  f.__cur_nest['id
+000201a0: 275d 202b 2031 0a0a 2020 2020 2320 4578  '] + 1..    # Ex
+000201b0: 6974 2061 2070 6172 7365 2074 7265 6520  it a parse tree 
+000201c0: 7072 6f64 7563 6564 2062 7920 526f 7365  produced by Rose
+000201d0: 7474 614d 5250 6172 7365 7223 616e 795f  ttaMRParser#any_
+000201e0: 7265 7374 7261 696e 742e 0a20 2020 2064  restraint..    d
+000201f0: 6566 2065 7869 7441 6e79 5f72 6573 7472  ef exitAny_restr
+00020200: 6169 6e74 2873 656c 662c 2063 7478 3a20  aint(self, ctx: 
+00020210: 526f 7365 7474 614d 5250 6172 7365 722e  RosettaMRParser.
+00020220: 416e 795f 7265 7374 7261 696e 7443 6f6e  Any_restraintCon
+00020230: 7465 7874 293a 2020 2320 7079 6c69 6e74  text):  # pylint
+00020240: 3a20 6469 7361 626c 653d 756e 7573 6564  : disable=unused
+00020250: 2d61 7267 756d 656e 740a 2020 2020 2020  -argument.      
+00020260: 2020 7061 7373 0a0a 2020 2020 2320 456e    pass..    # En
+00020270: 7465 7220 6120 7061 7273 6520 7472 6565  ter a parse tree
+00020280: 2070 726f 6475 6365 6420 6279 2052 6f73   produced by Ros
+00020290: 6574 7461 4d52 5061 7273 6572 2366 756e  ettaMRParser#fun
+000202a0: 635f 7479 7065 5f64 6566 2e0a 2020 2020  c_type_def..    
+000202b0: 6465 6620 656e 7465 7246 756e 635f 7479  def enterFunc_ty
+000202c0: 7065 5f64 6566 2873 656c 662c 2063 7478  pe_def(self, ctx
+000202d0: 3a20 526f 7365 7474 614d 5250 6172 7365  : RosettaMRParse
+000202e0: 722e 4675 6e63 5f74 7970 655f 6465 6643  r.Func_type_defC
+000202f0: 6f6e 7465 7874 293a 2020 2320 7079 6c69  ontext):  # pyli
+00020300: 6e74 3a20 6469 7361 626c 653d 756e 7573  nt: disable=unus
+00020310: 6564 2d61 7267 756d 656e 740a 2020 2020  ed-argument.    
+00020320: 2020 2020 7061 7373 0a0a 2020 2020 2320      pass..    # 
+00020330: 4578 6974 2061 2070 6172 7365 2074 7265  Exit a parse tre
+00020340: 6520 7072 6f64 7563 6564 2062 7920 526f  e produced by Ro
+00020350: 7365 7474 614d 5250 6172 7365 7223 6675  settaMRParser#fu
+00020360: 6e63 5f74 7970 655f 6465 662e 0a20 2020  nc_type_def..   
+00020370: 2064 6566 2065 7869 7446 756e 635f 7479   def exitFunc_ty
+00020380: 7065 5f64 6566 2873 656c 662c 2063 7478  pe_def(self, ctx
+00020390: 3a20 526f 7365 7474 614d 5250 6172 7365  : RosettaMRParse
+000203a0: 722e 4675 6e63 5f74 7970 655f 6465 6643  r.Func_type_defC
+000203b0: 6f6e 7465 7874 293a 0a20 2020 2020 2020  ontext):.       
+000203c0: 2022 2222 0a20 2020 2020 2020 2028 4349   """.        (CI
+000203d0: 5243 554c 4152 4841 524d 4f4e 4943 207c  RCULARHARMONIC |
+000203e0: 2048 4152 4d4f 4e49 4320 7c20 5349 474d   HARMONIC | SIGM
+000203f0: 4f49 4420 7c20 5351 5541 5245 5f57 454c  OID | SQUARE_WEL
+00020400: 4c29 2046 6c6f 6174 2046 6c6f 6174 207c  L) Float Float |
+00020410: 0a20 2020 2020 2020 2042 4f55 4e44 4544  .        BOUNDED
+00020420: 2046 6c6f 6174 2046 6c6f 6174 2046 6c6f   Float Float Flo
+00020430: 6174 2046 6c6f 6174 3f20 5369 6d70 6c65  at Float? Simple
+00020440: 5f6e 616d 652a 207c 0a20 2020 2020 2020  _name* |.       
+00020450: 2050 4552 494f 4449 4342 4f55 4e44 4544   PERIODICBOUNDED
+00020460: 2046 6c6f 6174 2046 6c6f 6174 2046 6c6f   Float Float Flo
+00020470: 6174 2046 6c6f 6174 2046 6c6f 6174 3f20  at Float Float? 
+00020480: 5369 6d70 6c65 5f6e 616d 652a 207c 0a20  Simple_name* |. 
+00020490: 2020 2020 2020 204f 4646 5345 5450 4552         OFFSETPER
+000204a0: 494f 4449 4342 4f55 4e44 4544 2046 6c6f  IODICBOUNDED Flo
+000204b0: 6174 2046 6c6f 6174 2046 6c6f 6174 2046  at Float Float F
+000204c0: 6c6f 6174 2046 6c6f 6174 2046 6c6f 6174  loat Float Float
+000204d0: 3f20 5369 6d70 6c65 5f6e 616d 652a 207c  ? Simple_name* |
+000204e0: 0a20 2020 2020 2020 2028 414d 4245 5250  .        (AMBERP
+000204f0: 4552 494f 4449 4320 7c20 4348 4152 4d4d  ERIODIC | CHARMM
+00020500: 5045 5249 4f44 4943 207c 2046 4c41 545f  PERIODIC | FLAT_
+00020510: 4841 524d 4f4e 4943 207c 2054 4f50 4f55  HARMONIC | TOPOU
+00020520: 5429 2046 6c6f 6174 2046 6c6f 6174 2046  T) Float Float F
+00020530: 6c6f 6174 207c 0a20 2020 2020 2020 2028  loat |.        (
+00020540: 4349 5243 554c 4152 5349 474d 4f49 4441  CIRCULARSIGMOIDA
+00020550: 4c20 7c20 4c49 4e45 4152 5f50 454e 414c  L | LINEAR_PENAL
+00020560: 5459 2920 466c 6f61 7420 466c 6f61 7420  TY) Float Float 
+00020570: 466c 6f61 7420 466c 6f61 7420 7c0a 2020  Float Float |.  
+00020580: 2020 2020 2020 4349 5243 554c 4152 5350        CIRCULARSP
+00020590: 4c49 4e45 2046 6c6f 6174 2b20 7c0a 2020  LINE Float+ |.  
+000205a0: 2020 2020 2020 4741 5553 5349 414e 4655        GAUSSIANFU
+000205b0: 4e43 2046 6c6f 6174 2046 6c6f 6174 2053  NC Float Float S
+000205c0: 696d 706c 655f 6e61 6d65 2028 5745 4947  imple_name (WEIG
+000205d0: 4854 2046 6c6f 6174 293f 207c 0a20 2020  HT Float)? |.   
+000205e0: 2020 2020 2053 4f47 4655 4e43 2049 6e74       SOGFUNC Int
+000205f0: 6567 6572 2028 466c 6f61 7420 466c 6f61  eger (Float Floa
+00020600: 7420 466c 6f61 7429 2b20 7c0a 2020 2020  t Float)+ |.    
+00020610: 2020 2020 284d 4958 5455 5245 4655 4e43      (MIXTUREFUNC
+00020620: 207c 204b 4152 504c 5553 207c 2053 4f45   | KARPLUS | SOE
+00020630: 4449 4e47 4655 4e43 2920 466c 6f61 7420  DINGFUNC) Float 
+00020640: 466c 6f61 7420 466c 6f61 7420 466c 6f61  Float Float Floa
+00020650: 7420 466c 6f61 7420 466c 6f61 7420 7c0a  t Float Float |.
+00020660: 2020 2020 2020 2020 434f 4e53 5441 4e54          CONSTANT
+00020670: 4655 4e43 2046 6c6f 6174 207c 0a20 2020  FUNC Float |.   
+00020680: 2020 2020 2049 4445 4e54 4954 5920 7c0a       IDENTITY |.
+00020690: 2020 2020 2020 2020 5343 414c 4152 5745          SCALARWE
+000206a0: 4947 4854 4544 4655 4e43 2046 6c6f 6174  IGHTEDFUNC Float
+000206b0: 2066 756e 635f 7479 7065 5f64 6566 207c   func_type_def |
+000206c0: 0a20 2020 2020 2020 2053 554d 4655 4e43  .        SUMFUNC
+000206d0: 2049 6e74 6567 6572 2066 756e 635f 7479   Integer func_ty
+000206e0: 7065 5f64 6566 2b20 7c0a 2020 2020 2020  pe_def+ |.      
+000206f0: 2020 5350 4c49 4e45 2053 696d 706c 655f    SPLINE Simple_
+00020700: 6e61 6d65 2028 466c 6f61 7420 466c 6f61  name (Float Floa
+00020710: 7420 466c 6f61 7420 7c20 4e4f 4e45 2046  t Float | NONE F
+00020720: 6c6f 6174 2046 6c6f 6174 2046 6c6f 6174  loat Float Float
+00020730: 2028 5369 6d70 6c65 5f6e 616d 6520 466c   (Simple_name Fl
+00020740: 6f61 742a 292b 2920 2f2f 2068 6973 746f  oat*)+) // histo
+00020750: 6772 616d 5f66 696c 655f 7061 7468 2063  gram_file_path c
+00020760: 616e 206e 6f74 2062 6520 6576 616c 7561  an not be evalua
+00020770: 7465 640a 2020 2020 2020 2020 4641 4445  ted.        FADE
+00020780: 2046 6c6f 6174 2046 6c6f 6174 2046 6c6f   Float Float Flo
+00020790: 6174 2046 6c6f 6174 2046 6c6f 6174 3f20  at Float Float? 
+000207a0: 7c0a 2020 2020 2020 2020 5351 5541 5245  |.        SQUARE
+000207b0: 5f57 454c 4c32 2046 6c6f 6174 2046 6c6f  _WELL2 Float Flo
+000207c0: 6174 2046 6c6f 6174 2044 4547 5245 4553  at Float DEGREES
+000207d0: 3f20 7c0a 2020 2020 2020 2020 4554 4142  ? |.        ETAB
+000207e0: 4c45 2046 6c6f 6174 2046 6c6f 6174 2046  LE Float Float F
+000207f0: 6c6f 6174 2a20 7c0a 2020 2020 2020 2020  loat* |.        
+00020800: 5553 4f47 2049 6e74 6567 6572 2028 466c  USOG Integer (Fl
+00020810: 6f61 7420 466c 6f61 7420 466c 6f61 7420  oat Float Float 
+00020820: 466c 6f61 7429 2b20 7c0a 2020 2020 2020  Float)+ |.      
+00020830: 2020 534f 4720 496e 7465 6765 7220 2846    SOG Integer (F
+00020840: 6c6f 6174 2046 6c6f 6174 2046 6c6f 6174  loat Float Float
+00020850: 2046 6c6f 6174 2046 6c6f 6174 2046 6c6f   Float Float Flo
+00020860: 6174 292b 3b0a 2020 2020 2020 2020 2222  at)+;.        ""
+00020870: 220a 0a20 2020 2020 2020 2074 7279 3a0a  "..        try:.
+00020880: 0a20 2020 2020 2020 2020 2020 2066 756e  .            fun
+00020890: 6320 3d20 7b7d 0a20 2020 2020 2020 2020  c = {}.         
+000208a0: 2020 2076 616c 6964 203d 2054 7275 650a     valid = True.
+000208b0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000208c0: 6c65 6e28 7365 6c66 2e6e 756d 6265 7246  len(self.numberF
+000208d0: 5365 6c65 6374 696f 6e29 203d 3d20 3020  Selection) == 0 
+000208e0: 6f72 204e 6f6e 6520 696e 2073 656c 662e  or None in self.
+000208f0: 6e75 6d62 6572 4653 656c 6563 7469 6f6e  numberFSelection
+00020900: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00020910: 2020 7265 7475 726e 0a0a 2020 2020 2020    return..      
+00020920: 2020 2020 2020 6966 2063 7478 2e43 4952        if ctx.CIR
+00020930: 4355 4c41 5248 4152 4d4f 4e49 4328 2920  CULARHARMONIC() 
+00020940: 6f72 2063 7478 2e48 4152 4d4f 4e49 4328  or ctx.HARMONIC(
+00020950: 2920 6f72 2063 7478 2e53 4947 4d4f 4944  ) or ctx.SIGMOID
+00020960: 2829 206f 7220 6374 782e 5351 5541 5245  () or ctx.SQUARE
+00020970: 5f57 454c 4c28 293a 0a20 2020 2020 2020  _WELL():.       
+00020980: 2020 2020 2020 2020 2078 3020 3d20 7365           x0 = se
+00020990: 6c66 2e6e 756d 6265 7246 5365 6c65 6374  lf.numberFSelect
+000209a0: 696f 6e5b 305d 0a0a 2020 2020 2020 2020  ion[0]..        
+000209b0: 2020 2020 2020 2020 6675 6e63 5b27 7830          func['x0
+000209c0: 275d 203d 2078 300a 0a20 2020 2020 2020  '] = x0..       
+000209d0: 2020 2020 2020 2020 2069 6620 6374 782e           if ctx.
+000209e0: 4349 5243 554c 4152 4841 524d 4f4e 4943  CIRCULARHARMONIC
+000209f0: 2829 3a20 2023 2078 3020 7364 0a20 2020  ():  # x0 sd.   
+00020a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020a10: 2066 756e 6354 7970 6520 3d20 2743 4952   funcType = 'CIR
+00020a20: 4355 4c41 5248 4152 4d4f 4e49 4327 0a0a  CULARHARMONIC'..
+00020a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020a40: 2020 2020 7364 203d 2073 656c 662e 6e75      sd = self.nu
+00020a50: 6d62 6572 4653 656c 6563 7469 6f6e 5b31  mberFSelection[1
+00020a60: 5d0a 0a20 2020 2020 2020 2020 2020 2020  ]..             
+00020a70: 2020 2020 2020 2066 756e 635b 2773 6427         func['sd'
+00020a80: 5d20 3d20 7364 0a0a 2020 2020 2020 2020  ] = sd..        
+00020a90: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00020aa0: 6420 3c3d 2030 2e30 3a0a 2020 2020 2020  d <= 0.0:.      
+00020ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020ac0: 2020 7661 6c69 6420 3d20 4661 6c73 650a    valid = False.
+00020ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020ae0: 2020 2020 2020 2020 7365 6c66 2e5f 5f66          self.__f
+00020af0: 2e61 7070 656e 6428 6622 5b49 6e76 616c  .append(f"[Inval
+00020b00: 6964 2064 6174 615d 207b 7365 6c66 2e5f  id data] {self._
+00020b10: 5f67 6574 4375 7272 656e 7452 6573 7472  _getCurrentRestr
+00020b20: 6169 6e74 2829 7d22 0a20 2020 2020 2020  aint()}".       
+00020b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020b50: 2066 227b 6675 6e63 5479 7065 7d20 7374   f"{funcType} st
+00020b60: 616e 6461 7264 2064 6576 6961 7469 6f6e  andard deviation
+00020b70: 2027 7364 3d7b 7364 7d27 206d 7573 7420   'sd={sd}' must 
+00020b80: 6265 2061 2070 6f73 6974 6976 6520 7661  be a positive va
+00020b90: 6c75 652e 2229 0a0a 2020 2020 2020 2020  lue.")..        
+00020ba0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
+00020bb0: 5b27 7461 7267 6574 5f76 616c 7565 275d  ['target_value']
+00020bc0: 203d 2078 300a 2020 2020 2020 2020 2020   = x0.          
+00020bd0: 2020 2020 2020 2020 2020 6675 6e63 5b27            func['
+00020be0: 6c6f 7765 725f 6c69 6d69 7427 5d20 3d20  lower_limit'] = 
+00020bf0: 7830 202d 2073 640a 2020 2020 2020 2020  x0 - sd.        
+00020c00: 2020 2020 2020 2020 2020 2020 6675 6e63              func
+00020c10: 5b27 7570 7065 725f 6c69 6d69 7427 5d20  ['upper_limit'] 
+00020c20: 3d20 7830 202b 2073 640a 0a20 2020 2020  = x0 + sd..     
+00020c30: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00020c40: 6374 782e 4841 524d 4f4e 4943 2829 3a20  ctx.HARMONIC(): 
+00020c50: 2023 2078 3020 7364 0a20 2020 2020 2020   # x0 sd.       
+00020c60: 2020 2020 2020 2020 2020 2020 2066 756e               fun
+00020c70: 6354 7970 6520 3d20 2748 4152 4d4f 4e49  cType = 'HARMONI
+00020c80: 4327 0a0a 2020 2020 2020 2020 2020 2020  C'..            
+00020c90: 2020 2020 2020 2020 7364 203d 2073 656c          sd = sel
+00020ca0: 662e 6e75 6d62 6572 4653 656c 6563 7469  f.numberFSelecti
+00020cb0: 6f6e 5b31 5d0a 0a20 2020 2020 2020 2020  on[1]..         
+00020cc0: 2020 2020 2020 2020 2020 2066 756e 635b             func[
+00020cd0: 2773 6427 5d20 3d20 7364 0a0a 2020 2020  'sd'] = sd..    
+00020ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020cf0: 6966 2073 6420 3c3d 2030 2e30 3a0a 2020  if sd <= 0.0:.  
+00020d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020d10: 2020 2020 2020 7661 6c69 6420 3d20 4661        valid = Fa
+00020d20: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
+00020d30: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00020d40: 2e5f 5f66 2e61 7070 656e 6428 6622 5b49  .__f.append(f"[I
+00020d50: 6e76 616c 6964 2064 6174 615d 207b 7365  nvalid data] {se
+00020d60: 6c66 2e5f 5f67 6574 4375 7272 656e 7452  lf.__getCurrentR
+00020d70: 6573 7472 6169 6e74 2829 7d22 0a20 2020  estraint()}".   
+00020d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00020d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020da0: 2020 2020 2020 7661 6c69 6420 3d20 4661        valid = Fa
-00020db0: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
-00020dc0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00020dd0: 2e5f 5f66 2e61 7070 656e 6428 6622 5b49  .__f.append(f"[I
-00020de0: 6e76 616c 6964 2064 6174 615d 207b 7365  nvalid data] {se
-00020df0: 6c66 2e5f 5f67 6574 4375 7272 656e 7452  lf.__getCurrentR
-00020e00: 6573 7472 6169 6e74 2829 7d22 0a20 2020  estraint()}".   
-00020e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020e30: 2020 2020 2066 227b 6675 6e63 5479 7065       f"{funcType
-00020e40: 7d20 7374 616e 6461 7264 2064 6576 6961  } standard devia
-00020e50: 7469 6f6e 2027 7364 3d7b 7364 7d27 206d  tion 'sd={sd}' m
-00020e60: 7573 7420 6265 2061 2070 6f73 6974 6976  ust be a positiv
-00020e70: 6520 7661 6c75 652e 2229 0a0a 2020 2020  e value.")..    
-00020e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020e90: 6675 6e63 5b27 7461 7267 6574 5f76 616c  func['target_val
-00020ea0: 7565 275d 203d 2078 300a 2020 2020 2020  ue'] = x0.      
-00020eb0: 2020 2020 2020 2020 2020 2020 2020 6675                fu
-00020ec0: 6e63 5b27 6c6f 7765 725f 6c69 6d69 7427  nc['lower_limit'
-00020ed0: 5d20 3d20 7830 202d 2073 640a 2020 2020  ] = x0 - sd.    
-00020ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020ef0: 6675 6e63 5b27 7570 7065 725f 6c69 6d69  func['upper_limi
-00020f00: 7427 5d20 3d20 7830 202b 2073 640a 0a20  t'] = x0 + sd.. 
-00020f10: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00020f20: 6c69 6620 6374 782e 4841 524d 4f4e 4943  lif ctx.HARMONIC
-00020f30: 2829 3a20 2023 2078 3020 7364 0a20 2020  ():  # x0 sd.   
-00020f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020f50: 2066 756e 6354 7970 6520 3d20 2748 4152   funcType = 'HAR
-00020f60: 4d4f 4e49 4327 0a0a 2020 2020 2020 2020  MONIC'..        
-00020f70: 2020 2020 2020 2020 2020 2020 7364 203d              sd =
-00020f80: 2073 656c 662e 6e75 6d62 6572 4653 656c   self.numberFSel
-00020f90: 6563 7469 6f6e 5b31 5d0a 0a20 2020 2020  ection[1]..     
-00020fa0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00020fb0: 756e 635b 2773 6427 5d20 3d20 7364 0a0a  unc['sd'] = sd..
-00020fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020fd0: 2020 2020 6966 2073 6420 3c3d 2030 2e30      if sd <= 0.0
-00020fe0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00020ff0: 2020 2020 2020 2020 2020 7661 6c69 6420            valid 
-00021000: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
-00021010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021020: 7365 6c66 2e5f 5f66 2e61 7070 656e 6428  self.__f.append(
-00021030: 6622 5b49 6e76 616c 6964 2064 6174 615d  f"[Invalid data]
-00021040: 207b 7365 6c66 2e5f 5f67 6574 4375 7272   {self.__getCurr
-00021050: 656e 7452 6573 7472 6169 6e74 2829 7d22  entRestraint()}"
-00021060: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021080: 2020 2020 2020 2020 2066 227b 6675 6e63           f"{func
-00021090: 5479 7065 7d20 7374 616e 6461 7264 2064  Type} standard d
-000210a0: 6576 6961 7469 6f6e 2027 7364 3d7b 7364  eviation 'sd={sd
-000210b0: 7d27 206d 7573 7420 6265 2061 2070 6f73  }' must be a pos
-000210c0: 6974 6976 6520 7661 6c75 652e 2229 0a0a  itive value.")..
-000210d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000210e0: 2020 2020 6675 6e63 5b27 7461 7267 6574      func['target
-000210f0: 5f76 616c 7565 275d 203d 2078 300a 2020  _value'] = x0.  
-00021100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021110: 2020 6675 6e63 5b27 6c6f 7765 725f 6c69    func['lower_li
-00021120: 6d69 7427 5d20 3d20 7830 202d 2073 640a  mit'] = x0 - sd.
-00021130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021140: 2020 2020 6675 6e63 5b27 7570 7065 725f      func['upper_
-00021150: 6c69 6d69 7427 5d20 3d20 7830 202b 2073  limit'] = x0 + s
-00021160: 640a 0a20 2020 2020 2020 2020 2020 2020  d..             
-00021170: 2020 2065 6c69 6620 6374 782e 5349 474d     elif ctx.SIGM
-00021180: 4f49 4428 293a 2020 2320 7830 206d 0a20  OID():  # x0 m. 
-00021190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000211a0: 2020 2066 756e 6354 7970 6520 3d20 2753     funcType = 'S
-000211b0: 4947 4d4f 4944 270a 0a20 2020 2020 2020  IGMOID'..       
-000211c0: 2020 2020 2020 2020 2020 2020 206d 203d               m =
-000211d0: 2073 656c 662e 6e75 6d62 6572 4653 656c   self.numberFSel
-000211e0: 6563 7469 6f6e 5b31 5d0a 0a20 2020 2020  ection[1]..     
-000211f0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00021200: 756e 635b 276d 275d 203d 206d 0a0a 2020  unc['m'] = m..  
-00021210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021220: 2020 6966 206d 203e 2030 2e30 3a0a 2020    if m > 0.0:.  
-00021230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021240: 2020 2020 2020 6675 6e63 5b27 7570 7065        func['uppe
-00021250: 725f 6c69 6e65 6172 5f6c 696d 6974 275d  r_linear_limit']
-00021260: 203d 2078 300a 2020 2020 2020 2020 2020   = x0.          
-00021270: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00021280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021290: 2020 2020 2020 2020 6675 6e63 5b27 6c6f          func['lo
-000212a0: 7765 725f 6c69 656e 6172 5f6c 696d 6974  wer_lienar_limit
-000212b0: 275d 203d 2078 300a 0a20 2020 2020 2020  '] = x0..       
-000212c0: 2020 2020 2020 2020 2065 6c73 653a 2020           else:  
-000212d0: 2320 7830 2064 6570 7468 0a20 2020 2020  # x0 depth.     
-000212e0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-000212f0: 756e 6354 7970 6520 3d20 2753 5155 4152  uncType = 'SQUAR
-00021300: 455f 5745 4c4c 270a 0a20 2020 2020 2020  E_WELL'..       
-00021310: 2020 2020 2020 2020 2020 2020 2064 6570               dep
-00021320: 7468 203d 2073 656c 662e 6e75 6d62 6572  th = self.number
-00021330: 4653 656c 6563 7469 6f6e 5b31 5d0a 0a20  FSelection[1].. 
+00020da0: 2020 2020 2066 227b 6675 6e63 5479 7065       f"{funcType
+00020db0: 7d20 7374 616e 6461 7264 2064 6576 6961  } standard devia
+00020dc0: 7469 6f6e 2027 7364 3d7b 7364 7d27 206d  tion 'sd={sd}' m
+00020dd0: 7573 7420 6265 2061 2070 6f73 6974 6976  ust be a positiv
+00020de0: 6520 7661 6c75 652e 2229 0a0a 2020 2020  e value.")..    
+00020df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020e00: 6675 6e63 5b27 7461 7267 6574 5f76 616c  func['target_val
+00020e10: 7565 275d 203d 2078 300a 2020 2020 2020  ue'] = x0.      
+00020e20: 2020 2020 2020 2020 2020 2020 2020 6675                fu
+00020e30: 6e63 5b27 6c6f 7765 725f 6c69 6d69 7427  nc['lower_limit'
+00020e40: 5d20 3d20 7830 202d 2073 640a 2020 2020  ] = x0 - sd.    
+00020e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020e60: 6675 6e63 5b27 7570 7065 725f 6c69 6d69  func['upper_limi
+00020e70: 7427 5d20 3d20 7830 202b 2073 640a 0a20  t'] = x0 + sd.. 
+00020e80: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00020e90: 6c69 6620 6374 782e 5349 474d 4f49 4428  lif ctx.SIGMOID(
+00020ea0: 293a 2020 2320 7830 206d 0a20 2020 2020  ):  # x0 m.     
+00020eb0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00020ec0: 756e 6354 7970 6520 3d20 2753 4947 4d4f  uncType = 'SIGMO
+00020ed0: 4944 270a 0a20 2020 2020 2020 2020 2020  ID'..           
+00020ee0: 2020 2020 2020 2020 206d 203d 2073 656c           m = sel
+00020ef0: 662e 6e75 6d62 6572 4653 656c 6563 7469  f.numberFSelecti
+00020f00: 6f6e 5b31 5d0a 0a20 2020 2020 2020 2020  on[1]..         
+00020f10: 2020 2020 2020 2020 2020 2066 756e 635b             func[
+00020f20: 276d 275d 203d 206d 0a0a 2020 2020 2020  'm'] = m..      
+00020f30: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00020f40: 206d 203e 2030 2e30 3a0a 2020 2020 2020   m > 0.0:.      
+00020f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020f60: 2020 6675 6e63 5b27 7570 7065 725f 6c69    func['upper_li
+00020f70: 6e65 6172 5f6c 696d 6974 275d 203d 2078  near_limit'] = x
+00020f80: 300a 2020 2020 2020 2020 2020 2020 2020  0.              
+00020f90: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00020fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020fb0: 2020 2020 6675 6e63 5b27 6c6f 7765 725f      func['lower_
+00020fc0: 6c69 656e 6172 5f6c 696d 6974 275d 203d  lienar_limit'] =
+00020fd0: 2078 300a 0a20 2020 2020 2020 2020 2020   x0..           
+00020fe0: 2020 2020 2065 6c73 653a 2020 2320 7830       else:  # x0
+00020ff0: 2064 6570 7468 0a20 2020 2020 2020 2020   depth.         
+00021000: 2020 2020 2020 2020 2020 2066 756e 6354             funcT
+00021010: 7970 6520 3d20 2753 5155 4152 455f 5745  ype = 'SQUARE_WE
+00021020: 4c4c 270a 0a20 2020 2020 2020 2020 2020  LL'..           
+00021030: 2020 2020 2020 2020 2064 6570 7468 203d           depth =
+00021040: 2073 656c 662e 6e75 6d62 6572 4653 656c   self.numberFSel
+00021050: 6563 7469 6f6e 5b31 5d0a 0a20 2020 2020  ection[1]..     
+00021060: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00021070: 756e 635b 2764 6570 7468 275d 203d 2064  unc['depth'] = d
+00021080: 6570 7468 0a0a 2020 2020 2020 2020 2020  epth..          
+00021090: 2020 2020 2020 2020 2020 6966 2064 6570            if dep
+000210a0: 7468 203e 2030 2e30 3a0a 2020 2020 2020  th > 0.0:.      
+000210b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000210c0: 2020 6675 6e63 5b27 6c6f 7765 725f 6c69    func['lower_li
+000210d0: 6e65 6172 5f6c 696d 6974 275d 203d 2078  near_limit'] = x
+000210e0: 300a 2020 2020 2020 2020 2020 2020 2020  0.              
+000210f0: 2020 2020 2020 656c 6966 2064 6570 7468        elif depth
+00021100: 203c 2030 2e30 3a0a 2020 2020 2020 2020   < 0.0:.        
+00021110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021120: 6675 6e63 5b27 7570 7065 725f 6c69 6e65  func['upper_line
+00021130: 6172 5f6c 696d 6974 275d 203d 2078 300a  ar_limit'] = x0.
+00021140: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00021150: 2066 756e 635b 276e 616d 6527 5d20 3d20   func['name'] = 
+00021160: 6675 6e63 5479 7065 0a0a 2020 2020 2020  funcType..      
+00021170: 2020 2020 2020 656c 6966 2063 7478 2e42        elif ctx.B
+00021180: 4f55 4e44 4544 2829 3a20 2023 206c 6220  OUNDED():  # lb 
+00021190: 7562 2073 6420 7273 7769 7463 6820 7461  ub sd rswitch ta
+000211a0: 670a 2020 2020 2020 2020 2020 2020 2020  g.              
+000211b0: 2020 6675 6e63 5479 7065 203d 2027 424f    funcType = 'BO
+000211c0: 554e 4445 4427 0a20 2020 2020 2020 2020  UNDED'.         
+000211d0: 2020 2020 2020 206c 6220 3d20 7365 6c66         lb = self
+000211e0: 2e6e 756d 6265 7246 5365 6c65 6374 696f  .numberFSelectio
+000211f0: 6e5b 305d 0a20 2020 2020 2020 2020 2020  n[0].           
+00021200: 2020 2020 2075 6220 3d20 7365 6c66 2e6e       ub = self.n
+00021210: 756d 6265 7246 5365 6c65 6374 696f 6e5b  umberFSelection[
+00021220: 315d 0a20 2020 2020 2020 2020 2020 2020  1].             
+00021230: 2020 2073 6420 3d20 7365 6c66 2e6e 756d     sd = self.num
+00021240: 6265 7246 5365 6c65 6374 696f 6e5b 325d  berFSelection[2]
+00021250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00021260: 2072 7377 6974 6368 203d 2030 2e35 0a0a   rswitch = 0.5..
+00021270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021280: 6675 6e63 5b27 6e61 6d65 275d 203d 2066  func['name'] = f
+00021290: 756e 6354 7970 650a 2020 2020 2020 2020  uncType.        
+000212a0: 2020 2020 2020 2020 6675 6e63 5b27 6c62          func['lb
+000212b0: 275d 203d 206c 620a 2020 2020 2020 2020  '] = lb.        
+000212c0: 2020 2020 2020 2020 6675 6e63 5b27 7562          func['ub
+000212d0: 275d 203d 2075 620a 2020 2020 2020 2020  '] = ub.        
+000212e0: 2020 2020 2020 2020 6675 6e63 5b27 7364          func['sd
+000212f0: 275d 203d 2073 640a 0a20 2020 2020 2020  '] = sd..       
+00021300: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00021310: 2e5f 5f72 656d 6564 6961 7465 2061 6e64  .__remediate and
+00021320: 2073 656c 662e 5f5f 7265 6173 6f6e 7320   self.__reasons 
+00021330: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
 00021340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021350: 2020 2066 756e 635b 2764 6570 7468 275d     func['depth']
-00021360: 203d 2064 6570 7468 0a0a 2020 2020 2020   = depth..      
-00021370: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00021380: 2064 6570 7468 203e 2030 2e30 3a0a 2020   depth > 0.0:.  
-00021390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000213a0: 2020 2020 2020 6675 6e63 5b27 6c6f 7765        func['lowe
-000213b0: 725f 6c69 6e65 6172 5f6c 696d 6974 275d  r_linear_limit']
-000213c0: 203d 2078 300a 2020 2020 2020 2020 2020   = x0.          
-000213d0: 2020 2020 2020 2020 2020 656c 6966 2064            elif d
-000213e0: 6570 7468 203c 2030 2e30 3a0a 2020 2020  epth < 0.0:.    
-000213f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021400: 2020 2020 6675 6e63 5b27 7570 7065 725f      func['upper_
-00021410: 6c69 6e65 6172 5f6c 696d 6974 275d 203d  linear_limit'] =
-00021420: 2078 300a 0a20 2020 2020 2020 2020 2020   x0..           
-00021430: 2020 2020 2066 756e 635b 276e 616d 6527       func['name'
-00021440: 5d20 3d20 6675 6e63 5479 7065 0a0a 2020  ] = funcType..  
-00021450: 2020 2020 2020 2020 2020 656c 6966 2063            elif c
-00021460: 7478 2e42 4f55 4e44 4544 2829 3a20 2023  tx.BOUNDED():  #
-00021470: 206c 6220 7562 2073 6420 7273 7769 7463   lb ub sd rswitc
-00021480: 6820 7461 670a 2020 2020 2020 2020 2020  h tag.          
-00021490: 2020 2020 2020 6675 6e63 5479 7065 203d        funcType =
-000214a0: 2027 424f 554e 4445 4427 0a20 2020 2020   'BOUNDED'.     
-000214b0: 2020 2020 2020 2020 2020 206c 6220 3d20             lb = 
-000214c0: 7365 6c66 2e6e 756d 6265 7246 5365 6c65  self.numberFSele
-000214d0: 6374 696f 6e5b 305d 0a20 2020 2020 2020  ction[0].       
-000214e0: 2020 2020 2020 2020 2075 6220 3d20 7365           ub = se
-000214f0: 6c66 2e6e 756d 6265 7246 5365 6c65 6374  lf.numberFSelect
-00021500: 696f 6e5b 315d 0a20 2020 2020 2020 2020  ion[1].         
-00021510: 2020 2020 2020 2073 6420 3d20 7365 6c66         sd = self
-00021520: 2e6e 756d 6265 7246 5365 6c65 6374 696f  .numberFSelectio
-00021530: 6e5b 325d 0a20 2020 2020 2020 2020 2020  n[2].           
-00021540: 2020 2020 2072 7377 6974 6368 203d 2030       rswitch = 0
-00021550: 2e35 0a0a 2020 2020 2020 2020 2020 2020  .5..            
-00021560: 2020 2020 6675 6e63 5b27 6e61 6d65 275d      func['name']
-00021570: 203d 2066 756e 6354 7970 650a 2020 2020   = funcType.    
-00021580: 2020 2020 2020 2020 2020 2020 6675 6e63              func
-00021590: 5b27 6c62 275d 203d 206c 620a 2020 2020  ['lb'] = lb.    
-000215a0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
-000215b0: 5b27 7562 275d 203d 2075 620a 2020 2020  ['ub'] = ub.    
-000215c0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
-000215d0: 5b27 7364 275d 203d 2073 640a 0a20 2020  ['sd'] = sd..   
-000215e0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000215f0: 7365 6c66 2e5f 5f72 656d 6564 6961 7465  self.__remediate
-00021600: 2061 6e64 2073 656c 662e 5f5f 7265 6173   and self.__reas
-00021610: 6f6e 7320 6973 206e 6f74 204e 6f6e 653a  ons is not None:
-00021620: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021630: 2020 2020 2069 6620 7365 6c66 2e5f 5f63       if self.__c
-00021640: 7572 5f73 7562 7479 7065 203d 3d20 2764  ur_subtype == 'd
-00021650: 6973 7427 2061 6e64 2027 6469 7374 5f75  ist' and 'dist_u
-00021660: 6e75 7375 616c 5f6f 7264 6572 2720 696e  nusual_order' in
-00021670: 2073 656c 662e 5f5f 7265 6173 6f6e 733a   self.__reasons:
-00021680: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021690: 2020 2020 2020 2020 2074 6172 6765 745f           target_
-000216a0: 7661 6c75 652c 2064 6d69 6e75 732c 2064  value, dminus, d
-000216b0: 706c 7573 203d 206c 622c 2075 622c 2073  plus = lb, ub, s
-000216c0: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
-000216d0: 2020 2020 2020 2020 2020 6675 6e63 5b27            func['
-000216e0: 6c62 275d 203d 2074 6172 6765 745f 7661  lb'] = target_va
-000216f0: 6c75 6520 2d20 646d 696e 7573 0a20 2020  lue - dminus.   
-00021700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021710: 2020 2020 2066 756e 635b 2775 6227 5d20       func['ub'] 
-00021720: 3d20 7461 7267 6574 5f76 616c 7565 202b  = target_value +
-00021730: 2064 706c 7573 0a20 2020 2020 2020 2020   dplus.         
-00021740: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00021750: 756e 635b 2773 6427 5d20 3d20 2864 6d69  unc['sd'] = (dmi
-00021760: 6e75 7320 2b20 6470 6c75 7329 202f 2032  nus + dplus) / 2
-00021770: 2e30 0a0a 2020 2020 2020 2020 2020 2020  .0..            
-00021780: 2020 2020 6966 206c 6220 3e20 7562 3a0a      if lb > ub:.
-00021790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000217a0: 2020 2020 7661 6c69 6420 3d20 4661 6c73      valid = Fals
-000217b0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-000217c0: 2020 2020 2020 7365 6c66 2e5f 5f66 2e61        self.__f.a
-000217d0: 7070 656e 6428 6622 5b49 6e76 616c 6964  ppend(f"[Invalid
-000217e0: 2064 6174 615d 207b 7365 6c66 2e5f 5f67   data] {self.__g
-000217f0: 6574 4375 7272 656e 7452 6573 7472 6169  etCurrentRestrai
-00021800: 6e74 2829 7d22 0a20 2020 2020 2020 2020  nt()}".         
-00021810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021820: 2020 2020 2020 2020 2020 2066 227b 6675             f"{fu
-00021830: 6e63 5479 7065 7d20 6c6f 7765 7220 626f  ncType} lower bo
-00021840: 756e 6461 7279 2027 6c62 3d7b 6c62 7d27  undary 'lb={lb}'
-00021850: 206d 7573 7420 6265 206c 6573 7320 7468   must be less th
-00021860: 616e 206f 7220 6571 7561 6c20 746f 2075  an or equal to u
-00021870: 7070 6572 2062 6f75 6e64 6172 7920 2775  pper boundary 'u
-00021880: 623d 7b75 627d 272e 2229 0a20 2020 2020  b={ub}'.").     
-00021890: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000218a0: 6620 7365 6c66 2e5f 5f72 656d 6564 6961  f self.__remedia
-000218b0: 7465 3a0a 2020 2020 2020 2020 2020 2020  te:.            
-000218c0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-000218d0: 656c 662e 5f5f 6375 725f 7375 6274 7970  elf.__cur_subtyp
-000218e0: 6520 3d3d 2027 6469 7374 2720 616e 6420  e == 'dist' and 
-000218f0: 6c62 203e 2073 643a 0a20 2020 2020 2020  lb > sd:.       
-00021900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021910: 2020 2020 2073 656c 662e 5f5f 6469 7374       self.__dist
-00021920: 5f6c 625f 6772 6561 7465 725f 7468 616e  _lb_greater_than
-00021930: 5f75 6220 3d20 5472 7565 0a20 2020 2020  _ub = True.     
-00021940: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00021950: 6c66 2e5f 5f72 656d 6564 6961 7465 3a0a  lf.__remediate:.
+00021350: 2069 6620 7365 6c66 2e5f 5f63 7572 5f73   if self.__cur_s
+00021360: 7562 7479 7065 203d 3d20 2764 6973 7427  ubtype == 'dist'
+00021370: 2061 6e64 2027 6469 7374 5f75 6e75 7375   and 'dist_unusu
+00021380: 616c 5f6f 7264 6572 2720 696e 2073 656c  al_order' in sel
+00021390: 662e 5f5f 7265 6173 6f6e 733a 0a20 2020  f.__reasons:.   
+000213a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000213b0: 2020 2020 2074 6172 6765 745f 7661 6c75       target_valu
+000213c0: 652c 2064 6d69 6e75 732c 2064 706c 7573  e, dminus, dplus
+000213d0: 203d 206c 622c 2075 622c 2073 640a 2020   = lb, ub, sd.  
+000213e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000213f0: 2020 2020 2020 6675 6e63 5b27 6c62 275d        func['lb']
+00021400: 203d 2074 6172 6765 745f 7661 6c75 6520   = target_value 
+00021410: 2d20 646d 696e 7573 0a20 2020 2020 2020  - dminus.       
+00021420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021430: 2066 756e 635b 2775 6227 5d20 3d20 7461   func['ub'] = ta
+00021440: 7267 6574 5f76 616c 7565 202b 2064 706c  rget_value + dpl
+00021450: 7573 0a20 2020 2020 2020 2020 2020 2020  us.             
+00021460: 2020 2020 2020 2020 2020 2066 756e 635b             func[
+00021470: 2773 6427 5d20 3d20 2864 6d69 6e75 7320  'sd'] = (dminus 
+00021480: 2b20 6470 6c75 7329 202f 2032 2e30 0a0a  + dplus) / 2.0..
+00021490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000214a0: 6966 206c 6220 3e20 7562 3a0a 2020 2020  if lb > ub:.    
+000214b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000214c0: 7661 6c69 6420 3d20 4661 6c73 650a 2020  valid = False.  
+000214d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000214e0: 2020 7365 6c66 2e5f 5f66 2e61 7070 656e    self.__f.appen
+000214f0: 6428 6622 5b49 6e76 616c 6964 2064 6174  d(f"[Invalid dat
+00021500: 615d 207b 7365 6c66 2e5f 5f67 6574 4375  a] {self.__getCu
+00021510: 7272 656e 7452 6573 7472 6169 6e74 2829  rrentRestraint()
+00021520: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
+00021530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021540: 2020 2020 2020 2066 227b 6675 6e63 5479         f"{funcTy
+00021550: 7065 7d20 6c6f 7765 7220 626f 756e 6461  pe} lower bounda
+00021560: 7279 2027 6c62 3d7b 6c62 7d27 206d 7573  ry 'lb={lb}' mus
+00021570: 7420 6265 206c 6573 7320 7468 616e 206f  t be less than o
+00021580: 7220 6571 7561 6c20 746f 2075 7070 6572  r equal to upper
+00021590: 2062 6f75 6e64 6172 7920 2775 623d 7b75   boundary 'ub={u
+000215a0: 627d 272e 2229 0a20 2020 2020 2020 2020  b}'.").         
+000215b0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+000215c0: 6c66 2e5f 5f72 656d 6564 6961 7465 3a0a  lf.__remediate:.
+000215d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000215e0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+000215f0: 5f5f 6375 725f 7375 6274 7970 6520 3d3d  __cur_subtype ==
+00021600: 2027 6469 7374 2720 616e 6420 6c62 203e   'dist' and lb >
+00021610: 2073 643a 0a20 2020 2020 2020 2020 2020   sd:.           
+00021620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021630: 2073 656c 662e 5f5f 6469 7374 5f6c 625f   self.__dist_lb_
+00021640: 6772 6561 7465 725f 7468 616e 5f75 6220  greater_than_ub 
+00021650: 3d20 5472 7565 0a20 2020 2020 2020 2020  = True.         
+00021660: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
+00021670: 5f72 656d 6564 6961 7465 3a0a 2020 2020  _remediate:.    
+00021680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021690: 6966 2073 656c 662e 5f5f 6375 725f 7375  if self.__cur_su
+000216a0: 6274 7970 6520 3d3d 2027 6469 7374 2720  btype == 'dist' 
+000216b0: 616e 6420 2875 6220 3e20 6c62 206f 7220  and (ub > lb or 
+000216c0: 7364 203e 206c 6229 3a0a 2020 2020 2020  sd > lb):.      
+000216d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000216e0: 2020 7365 6c66 2e5f 5f64 6973 745f 7562    self.__dist_ub
+000216f0: 5f61 6c77 6179 735f 706f 7369 7469 7665  _always_positive
+00021700: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
+00021710: 2020 2020 2020 2020 2069 6620 7364 203c           if sd <
+00021720: 3d20 302e 303a 0a20 2020 2020 2020 2020  = 0.0:.         
+00021730: 2020 2020 2020 2020 2020 2076 616c 6964             valid
+00021740: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
+00021750: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00021760: 662e 5f5f 662e 6170 7065 6e64 2866 225b  f.__f.append(f"[
+00021770: 496e 7661 6c69 6420 6461 7461 5d20 7b73  Invalid data] {s
+00021780: 656c 662e 5f5f 6765 7443 7572 7265 6e74  elf.__getCurrent
+00021790: 5265 7374 7261 696e 7428 297d 220a 2020  Restraint()}".  
+000217a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000217b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000217c0: 2020 6622 7b66 756e 6354 7970 657d 2073    f"{funcType} s
+000217d0: 7461 6e64 6172 6420 6465 7669 6174 696f  tandard deviatio
+000217e0: 6e20 2773 643d 7b73 647d 2720 6d75 7374  n 'sd={sd}' must
+000217f0: 2062 6520 6120 706f 7369 7469 7665 2076   be a positive v
+00021800: 616c 7565 2e22 290a 0a20 2020 2020 2020  alue.")..       
+00021810: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
+00021820: 7365 6c66 2e6e 756d 6265 7246 5365 6c65  self.numberFSele
+00021830: 6374 696f 6e29 203e 2033 3a0a 2020 2020  ction) > 3:.    
+00021840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021850: 7273 7769 7463 6820 3d20 7365 6c66 2e6e  rswitch = self.n
+00021860: 756d 6265 7246 5365 6c65 6374 696f 6e5b  umberFSelection[
+00021870: 335d 0a0a 2020 2020 2020 2020 2020 2020  3]..            
+00021880: 2020 2020 2020 2020 6675 6e63 5b27 7273          func['rs
+00021890: 7769 7463 6827 5d20 3d20 7273 7769 7463  witch'] = rswitc
+000218a0: 680a 0a20 2020 2020 2020 2020 2020 2020  h..             
+000218b0: 2020 2020 2020 2069 6620 7273 7769 7463         if rswitc
+000218c0: 6820 3c20 302e 303a 0a20 2020 2020 2020  h < 0.0:.       
+000218d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000218e0: 2076 616c 6964 203d 2046 616c 7365 0a20   valid = False. 
+000218f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021900: 2020 2020 2020 2073 656c 662e 5f5f 662e         self.__f.
+00021910: 6170 7065 6e64 2866 225b 496e 7661 6c69  append(f"[Invali
+00021920: 6420 6461 7461 5d20 7b73 656c 662e 5f5f  d data] {self.__
+00021930: 6765 7443 7572 7265 6e74 5265 7374 7261  getCurrentRestra
+00021940: 696e 7428 297d 220a 2020 2020 2020 2020  int()}".        
+00021950: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00021960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021970: 2020 2020 6966 2073 656c 662e 5f5f 6375      if self.__cu
-00021980: 725f 7375 6274 7970 6520 3d3d 2027 6469  r_subtype == 'di
-00021990: 7374 2720 616e 6420 2875 6220 3e20 6c62  st' and (ub > lb
-000219a0: 206f 7220 7364 203e 206c 6229 3a0a 2020   or sd > lb):.  
-000219b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000219c0: 2020 2020 2020 7365 6c66 2e5f 5f64 6973        self.__dis
-000219d0: 745f 7562 5f61 6c77 6179 735f 706f 7369  t_ub_always_posi
-000219e0: 7469 7665 203d 2046 616c 7365 0a20 2020  tive = False.   
-000219f0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00021a00: 7364 203c 3d20 302e 303a 0a20 2020 2020  sd <= 0.0:.     
-00021a10: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-00021a20: 616c 6964 203d 2046 616c 7365 0a20 2020  alid = False.   
-00021a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021a40: 2073 656c 662e 5f5f 662e 6170 7065 6e64   self.__f.append
-00021a50: 2866 225b 496e 7661 6c69 6420 6461 7461  (f"[Invalid data
-00021a60: 5d20 7b73 656c 662e 5f5f 6765 7443 7572  ] {self.__getCur
-00021a70: 7265 6e74 5265 7374 7261 696e 7428 297d  rentRestraint()}
-00021a80: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00021a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021aa0: 2020 2020 2020 6622 7b66 756e 6354 7970        f"{funcTyp
-00021ab0: 657d 2073 7461 6e64 6172 6420 6465 7669  e} standard devi
-00021ac0: 6174 696f 6e20 2773 643d 7b73 647d 2720  ation 'sd={sd}' 
-00021ad0: 6d75 7374 2062 6520 6120 706f 7369 7469  must be a positi
-00021ae0: 7665 2076 616c 7565 2e22 290a 0a20 2020  ve value.")..   
-00021af0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00021b00: 6c65 6e28 7365 6c66 2e6e 756d 6265 7246  len(self.numberF
-00021b10: 5365 6c65 6374 696f 6e29 203e 2033 3a0a  Selection) > 3:.
-00021b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021b30: 2020 2020 7273 7769 7463 6820 3d20 7365      rswitch = se
-00021b40: 6c66 2e6e 756d 6265 7246 5365 6c65 6374  lf.numberFSelect
-00021b50: 696f 6e5b 335d 0a0a 2020 2020 2020 2020  ion[3]..        
-00021b60: 2020 2020 2020 2020 2020 2020 6675 6e63              func
-00021b70: 5b27 7273 7769 7463 6827 5d20 3d20 7273  ['rswitch'] = rs
-00021b80: 7769 7463 680a 0a20 2020 2020 2020 2020  witch..         
-00021b90: 2020 2020 2020 2020 2020 2069 6620 7273             if rs
-00021ba0: 7769 7463 6820 3c20 302e 303a 0a20 2020  witch < 0.0:.   
-00021bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021bc0: 2020 2020 2076 616c 6964 203d 2046 616c       valid = Fal
-00021bd0: 7365 0a20 2020 2020 2020 2020 2020 2020  se.             
-00021be0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00021bf0: 5f5f 662e 6170 7065 6e64 2866 225b 496e  __f.append(f"[In
-00021c00: 7661 6c69 6420 6461 7461 5d20 7b73 656c  valid data] {sel
-00021c10: 662e 5f5f 6765 7443 7572 7265 6e74 5265  f.__getCurrentRe
-00021c20: 7374 7261 696e 7428 297d 220a 2020 2020  straint()}".    
-00021c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021c50: 2020 2020 6622 7b66 756e 6354 7970 657d      f"{funcType}
-00021c60: 2061 6464 6974 696f 6e61 6c20 7661 6c75   additional valu
-00021c70: 6520 666f 7220 7377 6974 6368 696e 6720  e for switching 
-00021c80: 6672 6f6d 2074 6865 2075 7070 6572 206c  from the upper l
-00021c90: 696d 6974 2074 6f20 7468 6520 7570 7065  imit to the uppe
-00021ca0: 7220 6c69 6e65 6172 206c 696d 6974 2022  r linear limit "
-00021cb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021cd0: 2020 2020 2020 2020 2066 2227 7273 7769           f"'rswi
-00021ce0: 7463 683d 7b72 7377 6974 6368 7d27 206d  tch={rswitch}' m
-00021cf0: 7573 7420 6e6f 7420 6265 2061 206e 6567  ust not be a neg
-00021d00: 6174 6976 6520 7661 6c75 652e 2229 0a0a  ative value.")..
-00021d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021d20: 6966 2063 7478 2e53 696d 706c 655f 6e61  if ctx.Simple_na
-00021d30: 6d65 2830 293a 0a20 2020 2020 2020 2020  me(0):.         
-00021d40: 2020 2020 2020 2020 2020 2066 756e 635b             func[
-00021d50: 2774 6167 275d 203d 2073 7472 2863 7478  'tag'] = str(ctx
-00021d60: 2e53 696d 706c 655f 6e61 6d65 2830 2929  .Simple_name(0))
-00021d70: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00021d80: 2020 6675 6e63 5b27 6c6f 7765 725f 6c69    func['lower_li
-00021d90: 6d69 7427 5d20 3d20 6c62 0a20 2020 2020  mit'] = lb.     
-00021da0: 2020 2020 2020 2020 2020 2066 756e 635b             func[
-00021db0: 2775 7070 6572 5f6c 696d 6974 275d 203d  'upper_limit'] =
-00021dc0: 2075 620a 2020 2020 2020 2020 2020 2020   ub.            
-00021dd0: 2020 2020 6966 2075 6220 2b20 7273 7769      if ub + rswi
-00021de0: 7463 6820 3c20 4449 5354 5f45 5252 4f52  tch < DIST_ERROR
-00021df0: 5f4d 4158 206f 7220 7365 6c66 2e5f 5f63  _MAX or self.__c
-00021e00: 7572 5f73 7562 7479 7065 2021 3d20 2764  ur_subtype != 'd
-00021e10: 6973 7427 3a0a 2020 2020 2020 2020 2020  ist':.          
-00021e20: 2020 2020 2020 2020 2020 6675 6e63 5b27            func['
-00021e30: 7570 7065 725f 6c69 6e65 6172 5f6c 696d  upper_linear_lim
-00021e40: 6974 275d 203d 2075 6220 2b20 7273 7769  it'] = ub + rswi
-00021e50: 7463 680a 2020 2020 2020 2020 2020 2020  tch.            
-00021e60: 2020 2020 6966 206c 6220 2d20 7273 7769      if lb - rswi
-00021e70: 7463 6820 3e3d 2044 4953 545f 4552 524f  tch >= DIST_ERRO
-00021e80: 525f 4d49 4e20 6f72 2073 656c 662e 5f5f  R_MIN or self.__
-00021e90: 6375 725f 7375 6274 7970 6520 213d 2027  cur_subtype != '
-00021ea0: 6469 7374 273a 0a20 2020 2020 2020 2020  dist':.         
-00021eb0: 2020 2020 2020 2020 2020 2066 756e 635b             func[
-00021ec0: 276c 6f77 6572 5f6c 696e 6561 725f 6c69  'lower_linear_li
-00021ed0: 6d69 7427 5d20 3d20 6c62 202d 2072 7377  mit'] = lb - rsw
-00021ee0: 6974 6368 0a0a 2020 2020 2020 2020 2020  itch..          
-00021ef0: 2020 656c 6966 2063 7478 2e50 4552 494f    elif ctx.PERIO
-00021f00: 4449 4342 4f55 4e44 4544 2829 3a20 2023  DICBOUNDED():  #
-00021f10: 2070 6572 696f 6420 6c62 2075 6220 7364   period lb ub sd
-00021f20: 2072 7377 6974 6368 2074 6167 0a20 2020   rswitch tag.   
-00021f30: 2020 2020 2020 2020 2020 2020 2066 756e               fun
-00021f40: 6354 7970 6520 3d20 2750 4552 494f 4449  cType = 'PERIODI
-00021f50: 4342 4f55 4e44 4544 270a 0a20 2020 2020  CBOUNDED'..     
-00021f60: 2020 2020 2020 2020 2020 2070 6572 696f             perio
-00021f70: 6420 3d20 7365 6c66 2e6e 756d 6265 7246  d = self.numberF
-00021f80: 5365 6c65 6374 696f 6e5b 305d 0a20 2020  Selection[0].   
-00021f90: 2020 2020 2020 2020 2020 2020 206c 6220               lb 
-00021fa0: 3d20 7365 6c66 2e6e 756d 6265 7246 5365  = self.numberFSe
-00021fb0: 6c65 6374 696f 6e5b 315d 0a20 2020 2020  lection[1].     
-00021fc0: 2020 2020 2020 2020 2020 2075 6220 3d20             ub = 
-00021fd0: 7365 6c66 2e6e 756d 6265 7246 5365 6c65  self.numberFSele
-00021fe0: 6374 696f 6e5b 325d 0a20 2020 2020 2020  ction[2].       
-00021ff0: 2020 2020 2020 2020 2073 6420 3d20 7365           sd = se
-00022000: 6c66 2e6e 756d 6265 7246 5365 6c65 6374  lf.numberFSelect
-00022010: 696f 6e5b 335d 0a20 2020 2020 2020 2020  ion[3].         
-00022020: 2020 2020 2020 2072 7377 6974 6368 203d         rswitch =
-00022030: 2030 2e35 0a0a 2020 2020 2020 2020 2020   0.5..          
-00022040: 2020 2020 2020 6675 6e63 5b27 6e61 6d65        func['name
-00022050: 275d 203d 2066 756e 6354 7970 650a 2020  '] = funcType.  
-00022060: 2020 2020 2020 2020 2020 2020 2020 6675                fu
-00022070: 6e63 5b27 7065 7269 6f64 275d 203d 2070  nc['period'] = p
-00022080: 6572 696f 640a 2020 2020 2020 2020 2020  eriod.          
-00022090: 2020 2020 2020 6675 6e63 5b27 6c62 275d        func['lb']
-000220a0: 203d 206c 620a 2020 2020 2020 2020 2020   = lb.          
-000220b0: 2020 2020 2020 6675 6e63 5b27 7562 275d        func['ub']
-000220c0: 203d 2075 620a 2020 2020 2020 2020 2020   = ub.          
-000220d0: 2020 2020 2020 6675 6e63 5b27 7364 275d        func['sd']
-000220e0: 203d 2073 640a 0a20 2020 2020 2020 2020   = sd..         
-000220f0: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
-00022100: 5f72 656d 6564 6961 7465 2061 6e64 2073  _remediate and s
-00022110: 656c 662e 5f5f 7265 6173 6f6e 7320 6973  elf.__reasons is
-00022120: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-00022130: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00022140: 6620 7365 6c66 2e5f 5f63 7572 5f73 7562  f self.__cur_sub
-00022150: 7479 7065 203d 3d20 2764 6973 7427 2061  type == 'dist' a
-00022160: 6e64 2027 6469 7374 5f75 6e75 7375 616c  nd 'dist_unusual
-00022170: 5f6f 7264 6572 2720 696e 2073 656c 662e  _order' in self.
-00022180: 5f5f 7265 6173 6f6e 733a 0a20 2020 2020  __reasons:.     
-00022190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000221a0: 2020 2074 6172 6765 745f 7661 6c75 652c     target_value,
-000221b0: 2064 6d69 6e75 732c 2064 706c 7573 203d   dminus, dplus =
-000221c0: 206c 622c 2075 622c 2073 640a 2020 2020   lb, ub, sd.    
-000221d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000221e0: 2020 2020 6675 6e63 5b27 6c62 275d 203d      func['lb'] =
-000221f0: 2074 6172 6765 745f 7661 6c75 6520 2d20   target_value - 
-00022200: 646d 696e 7573 0a20 2020 2020 2020 2020  dminus.         
-00022210: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00022220: 756e 635b 2775 6227 5d20 3d20 7461 7267  unc['ub'] = targ
-00022230: 6574 5f76 616c 7565 202b 2064 706c 7573  et_value + dplus
-00022240: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022250: 2020 2020 2020 2020 2066 756e 635b 2773           func['s
-00022260: 6427 5d20 3d20 2864 6d69 6e75 7320 2b20  d'] = (dminus + 
-00022270: 6470 6c75 7329 202f 2032 2e30 0a0a 2020  dplus) / 2.0..  
-00022280: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00022290: 2070 6572 696f 6420 3c20 302e 303a 0a20   period < 0.0:. 
-000222a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000222b0: 2020 2076 616c 6964 203d 2046 616c 7365     valid = False
-000222c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000222d0: 2020 2020 2073 656c 662e 5f5f 662e 6170       self.__f.ap
-000222e0: 7065 6e64 2866 225b 496e 7661 6c69 6420  pend(f"[Invalid 
-000222f0: 6461 7461 5d20 7b73 656c 662e 5f5f 6765  data] {self.__ge
-00022300: 7443 7572 7265 6e74 5265 7374 7261 696e  tCurrentRestrain
-00022310: 7428 297d 220a 2020 2020 2020 2020 2020  t()}".          
-00022320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022330: 2020 2020 2020 2020 2020 6622 7b66 756e            f"{fun
-00022340: 6354 7970 657d 2027 7065 7269 6f64 3d7b  cType} 'period={
-00022350: 7065 7269 6f64 7d27 206d 7573 7420 6e6f  period}' must no
-00022360: 7420 6265 2061 206e 6567 6174 6976 6520  t be a negative 
-00022370: 7661 6c75 652e 2229 0a20 2020 2020 2020  value.").       
-00022380: 2020 2020 2020 2020 2069 6620 6c62 203e           if lb >
-00022390: 2075 623a 0a20 2020 2020 2020 2020 2020   ub:.           
-000223a0: 2020 2020 2020 2020 2076 616c 6964 203d           valid =
-000223b0: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
-000223c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000223d0: 5f5f 662e 6170 7065 6e64 2866 225b 496e  __f.append(f"[In
-000223e0: 7661 6c69 6420 6461 7461 5d20 7b73 656c  valid data] {sel
-000223f0: 662e 5f5f 6765 7443 7572 7265 6e74 5265  f.__getCurrentRe
-00022400: 7374 7261 696e 7428 297d 220a 2020 2020  straint()}".    
-00022410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022430: 6622 7b66 756e 6354 7970 657d 206c 6f77  f"{funcType} low
-00022440: 6572 2062 6f75 6e64 6172 7920 276c 623d  er boundary 'lb=
-00022450: 7b6c 627d 2720 6d75 7374 2062 6520 6c65  {lb}' must be le
-00022460: 7373 2074 6861 6e20 6f72 2065 7175 616c  ss than or equal
-00022470: 2074 6f20 7570 7065 7220 626f 756e 6461   to upper bounda
-00022480: 7279 2027 7562 3d7b 7562 7d27 2e22 290a  ry 'ub={ub}'.").
-00022490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000224a0: 2020 2020 6966 2073 656c 662e 5f5f 7265      if self.__re
-000224b0: 6d65 6469 6174 653a 0a20 2020 2020 2020  mediate:.       
-000224c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000224d0: 2069 6620 7365 6c66 2e5f 5f63 7572 5f73   if self.__cur_s
-000224e0: 7562 7479 7065 203d 3d20 2764 6973 7427  ubtype == 'dist'
-000224f0: 2061 6e64 206c 6220 3e20 7364 3a0a 2020   and lb > sd:.  
-00022500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022510: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00022520: 5f64 6973 745f 6c62 5f67 7265 6174 6572  _dist_lb_greater
-00022530: 5f74 6861 6e5f 7562 203d 2054 7275 650a  _than_ub = True.
-00022540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022550: 6966 2073 656c 662e 5f5f 7265 6d65 6469  if self.__remedi
-00022560: 6174 653a 0a20 2020 2020 2020 2020 2020  ate:.           
-00022570: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00022580: 2e5f 5f63 7572 5f73 7562 7479 7065 203d  .__cur_subtype =
-00022590: 3d20 2764 6973 7427 2061 6e64 2028 7562  = 'dist' and (ub
-000225a0: 203e 206c 6220 6f72 2073 6420 3e20 6c62   > lb or sd > lb
-000225b0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-000225c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000225d0: 5f5f 6469 7374 5f75 625f 616c 7761 7973  __dist_ub_always
-000225e0: 5f70 6f73 6974 6976 6520 3d20 4661 6c73  _positive = Fals
-000225f0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00022600: 2020 6966 2073 6420 3c3d 2030 2e30 3a0a    if sd <= 0.0:.
-00022610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022620: 2020 2020 7661 6c69 6420 3d20 4661 6c73      valid = Fals
-00022630: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00022640: 2020 2020 2020 7365 6c66 2e5f 5f66 2e61        self.__f.a
-00022650: 7070 656e 6428 6622 5b49 6e76 616c 6964  ppend(f"[Invalid
-00022660: 2064 6174 615d 207b 7365 6c66 2e5f 5f67   data] {self.__g
-00022670: 6574 4375 7272 656e 7452 6573 7472 6169  etCurrentRestrai
-00022680: 6e74 2829 7d22 0a20 2020 2020 2020 2020  nt()}".         
-00022690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000226a0: 2020 2020 2020 2020 2020 2066 227b 6675             f"{fu
-000226b0: 6e63 5479 7065 7d20 7374 616e 6461 7264  ncType} standard
-000226c0: 2064 6576 6961 7469 6f6e 2027 7364 3d7b   deviation 'sd={
-000226d0: 7364 7d27 206d 7573 7420 6265 2061 2070  sd}' must be a p
-000226e0: 6f73 6974 6976 6520 7661 6c75 652e 2229  ositive value.")
-000226f0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00022700: 2020 6966 206c 656e 2873 656c 662e 6e75    if len(self.nu
-00022710: 6d62 6572 4653 656c 6563 7469 6f6e 2920  mberFSelection) 
-00022720: 3e20 343a 0a20 2020 2020 2020 2020 2020  > 4:.           
-00022730: 2020 2020 2020 2020 2072 7377 6974 6368           rswitch
-00022740: 203d 2073 656c 662e 6e75 6d62 6572 4653   = self.numberFS
-00022750: 656c 6563 7469 6f6e 5b34 5d0a 0a20 2020  election[4]..   
-00022760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022770: 2066 756e 635b 2772 7377 6974 6368 275d   func['rswitch']
-00022780: 203d 2072 7377 6974 6368 0a0a 2020 2020   = rswitch..    
-00022790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000227a0: 6966 2072 7377 6974 6368 203c 2030 2e30  if rswitch < 0.0
-000227b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000227c0: 2020 2020 2020 2020 2020 7661 6c69 6420            valid 
-000227d0: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
-000227e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000227f0: 7365 6c66 2e5f 5f66 2e61 7070 656e 6428  self.__f.append(
-00022800: 6622 5b49 6e76 616c 6964 2064 6174 615d  f"[Invalid data]
-00022810: 207b 7365 6c66 2e5f 5f67 6574 4375 7272   {self.__getCurr
-00022820: 656e 7452 6573 7472 6169 6e74 2829 7d22  entRestraint()}"
-00022830: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022850: 2020 2020 2020 2020 2066 227b 6675 6e63           f"{func
-00022860: 5479 7065 7d20 6164 6469 7469 6f6e 616c  Type} additional
-00022870: 2076 616c 7565 2066 6f72 2073 7769 7463   value for switc
-00022880: 6869 6e67 2066 726f 6d20 7468 6520 7570  hing from the up
-00022890: 7065 7220 6c69 6d69 7420 746f 2074 6865  per limit to the
-000228a0: 2075 7070 6572 206c 696e 6561 7220 6c69   upper linear li
-000228b0: 6d69 7420 220a 2020 2020 2020 2020 2020  mit ".          
-000228c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000228d0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-000228e0: 2772 7377 6974 6368 3d7b 7273 7769 7463  'rswitch={rswitc
-000228f0: 687d 2720 6d75 7374 206e 6f74 2062 6520  h}' must not be 
-00022900: 6120 6e65 6761 7469 7665 2076 616c 7565  a negative value
-00022910: 2e22 290a 0a20 2020 2020 2020 2020 2020  .")..           
-00022920: 2020 2020 2069 6620 6374 782e 5369 6d70       if ctx.Simp
-00022930: 6c65 5f6e 616d 6528 3029 3a0a 2020 2020  le_name(0):.    
-00022940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022950: 6675 6e63 5b27 7461 6727 5d20 3d20 7374  func['tag'] = st
-00022960: 7228 6374 782e 5369 6d70 6c65 5f6e 616d  r(ctx.Simple_nam
-00022970: 6528 3029 290a 0a20 2020 2020 2020 2020  e(0))..         
-00022980: 2020 2020 2020 2066 756e 635b 276c 6f77         func['low
-00022990: 6572 5f6c 696d 6974 275d 203d 206c 620a  er_limit'] = lb.
-000229a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000229b0: 6675 6e63 5b27 7570 7065 725f 6c69 6d69  func['upper_limi
-000229c0: 7427 5d20 3d20 7562 0a0a 2020 2020 2020  t'] = ub..      
-000229d0: 2020 2020 2020 2020 2020 6966 2075 6220            if ub 
-000229e0: 2b20 7273 7769 7463 6820 3c20 4449 5354  + rswitch < DIST
-000229f0: 5f45 5252 4f52 5f4d 4158 206f 7220 7365  _ERROR_MAX or se
-00022a00: 6c66 2e5f 5f63 7572 5f73 7562 7479 7065  lf.__cur_subtype
-00022a10: 2021 3d20 2764 6973 7427 3a0a 2020 2020   != 'dist':.    
-00022a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022a30: 6675 6e63 5b27 7570 7065 725f 6c69 6e65  func['upper_line
-00022a40: 6172 5f6c 696d 6974 275d 203d 2075 6220  ar_limit'] = ub 
-00022a50: 2b20 7273 7769 7463 680a 2020 2020 2020  + rswitch.      
-00022a60: 2020 2020 2020 2020 2020 6966 206c 6220            if lb 
-00022a70: 2d20 7273 7769 7463 6820 3e3d 2044 4953  - rswitch >= DIS
-00022a80: 545f 4552 524f 525f 4d49 4e20 6f72 2073  T_ERROR_MIN or s
-00022a90: 656c 662e 5f5f 6375 725f 7375 6274 7970  elf.__cur_subtyp
-00022aa0: 6520 213d 2027 6469 7374 273a 0a20 2020  e != 'dist':.   
-00022ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022ac0: 2066 756e 635b 276c 6f77 6572 5f6c 696e   func['lower_lin
-00022ad0: 6561 725f 6c69 6d69 7427 5d20 3d20 6c62  ear_limit'] = lb
-00022ae0: 202d 2072 7377 6974 6368 0a0a 2020 2020   - rswitch..    
-00022af0: 2020 2020 2020 2020 656c 6966 2063 7478          elif ctx
-00022b00: 2e4f 4646 5345 5450 4552 494f 4449 4342  .OFFSETPERIODICB
-00022b10: 4f55 4e44 4544 2829 3a20 2023 206f 6666  OUNDED():  # off
-00022b20: 7365 7420 7065 7269 6f64 206c 6220 7562  set period lb ub
-00022b30: 2073 6420 7273 7769 7463 6820 7461 670a   sd rswitch tag.
-00022b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022b50: 6675 6e63 5479 7065 203d 2027 4f46 4653  funcType = 'OFFS
-00022b60: 4554 5045 5249 4f44 4943 424f 554e 4445  ETPERIODICBOUNDE
-00022b70: 4427 0a0a 2020 2020 2020 2020 2020 2020  D'..            
-00022b80: 2020 2020 6f66 6673 6574 203d 2073 656c      offset = sel
-00022b90: 662e 6e75 6d62 6572 4653 656c 6563 7469  f.numberFSelecti
-00022ba0: 6f6e 5b30 5d0a 2020 2020 2020 2020 2020  on[0].          
-00022bb0: 2020 2020 2020 7065 7269 6f64 203d 2073        period = s
-00022bc0: 656c 662e 6e75 6d62 6572 4653 656c 6563  elf.numberFSelec
-00022bd0: 7469 6f6e 5b31 5d0a 2020 2020 2020 2020  tion[1].        
-00022be0: 2020 2020 2020 2020 6c62 203d 2073 656c          lb = sel
-00022bf0: 662e 6e75 6d62 6572 4653 656c 6563 7469  f.numberFSelecti
-00022c00: 6f6e 5b32 5d0a 2020 2020 2020 2020 2020  on[2].          
-00022c10: 2020 2020 2020 7562 203d 2073 656c 662e        ub = self.
-00022c20: 6e75 6d62 6572 4653 656c 6563 7469 6f6e  numberFSelection
-00022c30: 5b33 5d0a 2020 2020 2020 2020 2020 2020  [3].            
-00022c40: 2020 2020 7364 203d 2073 656c 662e 6e75      sd = self.nu
-00022c50: 6d62 6572 4653 656c 6563 7469 6f6e 5b34  mberFSelection[4
-00022c60: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00022c70: 2020 7273 7769 7463 6820 3d20 302e 350a    rswitch = 0.5.
-00022c80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022c90: 2066 756e 635b 276e 616d 6527 5d20 3d20   func['name'] = 
-00022ca0: 6675 6e63 5479 7065 0a20 2020 2020 2020  funcType.       
-00022cb0: 2020 2020 2020 2020 2066 756e 635b 276f           func['o
-00022cc0: 6666 7365 7427 5d20 3d20 6f66 6673 6574  ffset'] = offset
-00022cd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022ce0: 2066 756e 635b 2770 6572 696f 6427 5d20   func['period'] 
-00022cf0: 3d20 7065 7269 6f64 0a20 2020 2020 2020  = period.       
-00022d00: 2020 2020 2020 2020 2066 756e 635b 276c           func['l
-00022d10: 6227 5d20 3d20 6c62 0a20 2020 2020 2020  b'] = lb.       
-00022d20: 2020 2020 2020 2020 2066 756e 635b 2775           func['u
-00022d30: 6227 5d20 3d20 7562 0a20 2020 2020 2020  b'] = ub.       
-00022d40: 2020 2020 2020 2020 2066 756e 635b 2773           func['s
-00022d50: 6427 5d20 3d20 7364 0a0a 2020 2020 2020  d'] = sd..      
-00022d60: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00022d70: 662e 5f5f 7265 6d65 6469 6174 6520 616e  f.__remediate an
-00022d80: 6420 7365 6c66 2e5f 5f72 6561 736f 6e73  d self.__reasons
-00022d90: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+00021970: 6622 7b66 756e 6354 7970 657d 2061 6464  f"{funcType} add
+00021980: 6974 696f 6e61 6c20 7661 6c75 6520 666f  itional value fo
+00021990: 7220 7377 6974 6368 696e 6720 6672 6f6d  r switching from
+000219a0: 2074 6865 2075 7070 6572 206c 696d 6974   the upper limit
+000219b0: 2074 6f20 7468 6520 7570 7065 7220 6c69   to the upper li
+000219c0: 6e65 6172 206c 696d 6974 2022 0a20 2020  near limit ".   
+000219d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000219e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000219f0: 2020 2020 2066 2227 7273 7769 7463 683d       f"'rswitch=
+00021a00: 7b72 7377 6974 6368 7d27 206d 7573 7420  {rswitch}' must 
+00021a10: 6e6f 7420 6265 2061 206e 6567 6174 6976  not be a negativ
+00021a20: 6520 7661 6c75 652e 2229 0a0a 2020 2020  e value.")..    
+00021a30: 2020 2020 2020 2020 2020 2020 6966 2063              if c
+00021a40: 7478 2e53 696d 706c 655f 6e61 6d65 2830  tx.Simple_name(0
+00021a50: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00021a60: 2020 2020 2020 2066 756e 635b 2774 6167         func['tag
+00021a70: 275d 203d 2073 7472 2863 7478 2e53 696d  '] = str(ctx.Sim
+00021a80: 706c 655f 6e61 6d65 2830 2929 0a0a 2020  ple_name(0))..  
+00021a90: 2020 2020 2020 2020 2020 2020 2020 6675                fu
+00021aa0: 6e63 5b27 6c6f 7765 725f 6c69 6d69 7427  nc['lower_limit'
+00021ab0: 5d20 3d20 6c62 0a20 2020 2020 2020 2020  ] = lb.         
+00021ac0: 2020 2020 2020 2066 756e 635b 2775 7070         func['upp
+00021ad0: 6572 5f6c 696d 6974 275d 203d 2075 620a  er_limit'] = ub.
+00021ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021af0: 6966 2075 6220 2b20 7273 7769 7463 6820  if ub + rswitch 
+00021b00: 3c20 4449 5354 5f45 5252 4f52 5f4d 4158  < DIST_ERROR_MAX
+00021b10: 206f 7220 7365 6c66 2e5f 5f63 7572 5f73   or self.__cur_s
+00021b20: 7562 7479 7065 2021 3d20 2764 6973 7427  ubtype != 'dist'
+00021b30: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00021b40: 2020 2020 2020 6675 6e63 5b27 7570 7065        func['uppe
+00021b50: 725f 6c69 6e65 6172 5f6c 696d 6974 275d  r_linear_limit']
+00021b60: 203d 2075 6220 2b20 7273 7769 7463 680a   = ub + rswitch.
+00021b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021b80: 6966 206c 6220 2d20 7273 7769 7463 6820  if lb - rswitch 
+00021b90: 3e3d 2044 4953 545f 4552 524f 525f 4d49  >= DIST_ERROR_MI
+00021ba0: 4e20 6f72 2073 656c 662e 5f5f 6375 725f  N or self.__cur_
+00021bb0: 7375 6274 7970 6520 213d 2027 6469 7374  subtype != 'dist
+00021bc0: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
+00021bd0: 2020 2020 2020 2066 756e 635b 276c 6f77         func['low
+00021be0: 6572 5f6c 696e 6561 725f 6c69 6d69 7427  er_linear_limit'
+00021bf0: 5d20 3d20 6c62 202d 2072 7377 6974 6368  ] = lb - rswitch
+00021c00: 0a0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+00021c10: 6966 2063 7478 2e50 4552 494f 4449 4342  if ctx.PERIODICB
+00021c20: 4f55 4e44 4544 2829 3a20 2023 2070 6572  OUNDED():  # per
+00021c30: 696f 6420 6c62 2075 6220 7364 2072 7377  iod lb ub sd rsw
+00021c40: 6974 6368 2074 6167 0a20 2020 2020 2020  itch tag.       
+00021c50: 2020 2020 2020 2020 2066 756e 6354 7970           funcTyp
+00021c60: 6520 3d20 2750 4552 494f 4449 4342 4f55  e = 'PERIODICBOU
+00021c70: 4e44 4544 270a 0a20 2020 2020 2020 2020  NDED'..         
+00021c80: 2020 2020 2020 2070 6572 696f 6420 3d20         period = 
+00021c90: 7365 6c66 2e6e 756d 6265 7246 5365 6c65  self.numberFSele
+00021ca0: 6374 696f 6e5b 305d 0a20 2020 2020 2020  ction[0].       
+00021cb0: 2020 2020 2020 2020 206c 6220 3d20 7365           lb = se
+00021cc0: 6c66 2e6e 756d 6265 7246 5365 6c65 6374  lf.numberFSelect
+00021cd0: 696f 6e5b 315d 0a20 2020 2020 2020 2020  ion[1].         
+00021ce0: 2020 2020 2020 2075 6220 3d20 7365 6c66         ub = self
+00021cf0: 2e6e 756d 6265 7246 5365 6c65 6374 696f  .numberFSelectio
+00021d00: 6e5b 325d 0a20 2020 2020 2020 2020 2020  n[2].           
+00021d10: 2020 2020 2073 6420 3d20 7365 6c66 2e6e       sd = self.n
+00021d20: 756d 6265 7246 5365 6c65 6374 696f 6e5b  umberFSelection[
+00021d30: 335d 0a20 2020 2020 2020 2020 2020 2020  3].             
+00021d40: 2020 2072 7377 6974 6368 203d 2030 2e35     rswitch = 0.5
+00021d50: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00021d60: 2020 6675 6e63 5b27 6e61 6d65 275d 203d    func['name'] =
+00021d70: 2066 756e 6354 7970 650a 2020 2020 2020   funcType.      
+00021d80: 2020 2020 2020 2020 2020 6675 6e63 5b27            func['
+00021d90: 7065 7269 6f64 275d 203d 2070 6572 696f  period'] = perio
+00021da0: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+00021db0: 2020 6675 6e63 5b27 6c62 275d 203d 206c    func['lb'] = l
+00021dc0: 620a 2020 2020 2020 2020 2020 2020 2020  b.              
+00021dd0: 2020 6675 6e63 5b27 7562 275d 203d 2075    func['ub'] = u
+00021de0: 620a 2020 2020 2020 2020 2020 2020 2020  b.              
+00021df0: 2020 6675 6e63 5b27 7364 275d 203d 2073    func['sd'] = s
+00021e00: 640a 0a20 2020 2020 2020 2020 2020 2020  d..             
+00021e10: 2020 2069 6620 7365 6c66 2e5f 5f72 656d     if self.__rem
+00021e20: 6564 6961 7465 2061 6e64 2073 656c 662e  ediate and self.
+00021e30: 5f5f 7265 6173 6f6e 7320 6973 206e 6f74  __reasons is not
+00021e40: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00021e50: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00021e60: 6c66 2e5f 5f63 7572 5f73 7562 7479 7065  lf.__cur_subtype
+00021e70: 203d 3d20 2764 6973 7427 2061 6e64 2027   == 'dist' and '
+00021e80: 6469 7374 5f75 6e75 7375 616c 5f6f 7264  dist_unusual_ord
+00021e90: 6572 2720 696e 2073 656c 662e 5f5f 7265  er' in self.__re
+00021ea0: 6173 6f6e 733a 0a20 2020 2020 2020 2020  asons:.         
+00021eb0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00021ec0: 6172 6765 745f 7661 6c75 652c 2064 6d69  arget_value, dmi
+00021ed0: 6e75 732c 2064 706c 7573 203d 206c 622c  nus, dplus = lb,
+00021ee0: 2075 622c 2073 640a 2020 2020 2020 2020   ub, sd.        
+00021ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021f00: 6675 6e63 5b27 6c62 275d 203d 2074 6172  func['lb'] = tar
+00021f10: 6765 745f 7661 6c75 6520 2d20 646d 696e  get_value - dmin
+00021f20: 7573 0a20 2020 2020 2020 2020 2020 2020  us.             
+00021f30: 2020 2020 2020 2020 2020 2066 756e 635b             func[
+00021f40: 2775 6227 5d20 3d20 7461 7267 6574 5f76  'ub'] = target_v
+00021f50: 616c 7565 202b 2064 706c 7573 0a20 2020  alue + dplus.   
+00021f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021f70: 2020 2020 2066 756e 635b 2773 6427 5d20       func['sd'] 
+00021f80: 3d20 2864 6d69 6e75 7320 2b20 6470 6c75  = (dminus + dplu
+00021f90: 7329 202f 2032 2e30 0a0a 2020 2020 2020  s) / 2.0..      
+00021fa0: 2020 2020 2020 2020 2020 6966 2070 6572            if per
+00021fb0: 696f 6420 3c20 302e 303a 0a20 2020 2020  iod < 0.0:.     
+00021fc0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00021fd0: 616c 6964 203d 2046 616c 7365 0a20 2020  alid = False.   
+00021fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021ff0: 2073 656c 662e 5f5f 662e 6170 7065 6e64   self.__f.append
+00022000: 2866 225b 496e 7661 6c69 6420 6461 7461  (f"[Invalid data
+00022010: 5d20 7b73 656c 662e 5f5f 6765 7443 7572  ] {self.__getCur
+00022020: 7265 6e74 5265 7374 7261 696e 7428 297d  rentRestraint()}
+00022030: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00022040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022050: 2020 2020 2020 6622 7b66 756e 6354 7970        f"{funcTyp
+00022060: 657d 2027 7065 7269 6f64 3d7b 7065 7269  e} 'period={peri
+00022070: 6f64 7d27 206d 7573 7420 6e6f 7420 6265  od}' must not be
+00022080: 2061 206e 6567 6174 6976 6520 7661 6c75   a negative valu
+00022090: 652e 2229 0a20 2020 2020 2020 2020 2020  e.").           
+000220a0: 2020 2020 2069 6620 6c62 203e 2075 623a       if lb > ub:
+000220b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000220c0: 2020 2020 2076 616c 6964 203d 2046 616c       valid = Fal
+000220d0: 7365 0a20 2020 2020 2020 2020 2020 2020  se.             
+000220e0: 2020 2020 2020 2073 656c 662e 5f5f 662e         self.__f.
+000220f0: 6170 7065 6e64 2866 225b 496e 7661 6c69  append(f"[Invali
+00022100: 6420 6461 7461 5d20 7b73 656c 662e 5f5f  d data] {self.__
+00022110: 6765 7443 7572 7265 6e74 5265 7374 7261  getCurrentRestra
+00022120: 696e 7428 297d 220a 2020 2020 2020 2020  int()}".        
+00022130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022140: 2020 2020 2020 2020 2020 2020 6622 7b66              f"{f
+00022150: 756e 6354 7970 657d 206c 6f77 6572 2062  uncType} lower b
+00022160: 6f75 6e64 6172 7920 276c 623d 7b6c 627d  oundary 'lb={lb}
+00022170: 2720 6d75 7374 2062 6520 6c65 7373 2074  ' must be less t
+00022180: 6861 6e20 6f72 2065 7175 616c 2074 6f20  han or equal to 
+00022190: 7570 7065 7220 626f 756e 6461 7279 2027  upper boundary '
+000221a0: 7562 3d7b 7562 7d27 2e22 290a 2020 2020  ub={ub}'.").    
+000221b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000221c0: 6966 2073 656c 662e 5f5f 7265 6d65 6469  if self.__remedi
+000221d0: 6174 653a 0a20 2020 2020 2020 2020 2020  ate:.           
+000221e0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000221f0: 7365 6c66 2e5f 5f63 7572 5f73 7562 7479  self.__cur_subty
+00022200: 7065 203d 3d20 2764 6973 7427 2061 6e64  pe == 'dist' and
+00022210: 206c 6220 3e20 7364 3a0a 2020 2020 2020   lb > sd:.      
+00022220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022230: 2020 2020 2020 7365 6c66 2e5f 5f64 6973        self.__dis
+00022240: 745f 6c62 5f67 7265 6174 6572 5f74 6861  t_lb_greater_tha
+00022250: 6e5f 7562 203d 2054 7275 650a 2020 2020  n_ub = True.    
+00022260: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00022270: 656c 662e 5f5f 7265 6d65 6469 6174 653a  elf.__remediate:
+00022280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022290: 2020 2020 2069 6620 7365 6c66 2e5f 5f63       if self.__c
+000222a0: 7572 5f73 7562 7479 7065 203d 3d20 2764  ur_subtype == 'd
+000222b0: 6973 7427 2061 6e64 2028 7562 203e 206c  ist' and (ub > l
+000222c0: 6220 6f72 2073 6420 3e20 6c62 293a 0a20  b or sd > lb):. 
+000222d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000222e0: 2020 2020 2020 2073 656c 662e 5f5f 6469         self.__di
+000222f0: 7374 5f75 625f 616c 7761 7973 5f70 6f73  st_ub_always_pos
+00022300: 6974 6976 6520 3d20 4661 6c73 650a 2020  itive = False.  
+00022310: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00022320: 2073 6420 3c3d 2030 2e30 3a0a 2020 2020   sd <= 0.0:.    
+00022330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022340: 7661 6c69 6420 3d20 4661 6c73 650a 2020  valid = False.  
+00022350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022360: 2020 7365 6c66 2e5f 5f66 2e61 7070 656e    self.__f.appen
+00022370: 6428 6622 5b49 6e76 616c 6964 2064 6174  d(f"[Invalid dat
+00022380: 615d 207b 7365 6c66 2e5f 5f67 6574 4375  a] {self.__getCu
+00022390: 7272 656e 7452 6573 7472 6169 6e74 2829  rrentRestraint()
+000223a0: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
+000223b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000223c0: 2020 2020 2020 2066 227b 6675 6e63 5479         f"{funcTy
+000223d0: 7065 7d20 7374 616e 6461 7264 2064 6576  pe} standard dev
+000223e0: 6961 7469 6f6e 2027 7364 3d7b 7364 7d27  iation 'sd={sd}'
+000223f0: 206d 7573 7420 6265 2061 2070 6f73 6974   must be a posit
+00022400: 6976 6520 7661 6c75 652e 2229 0a0a 2020  ive value.")..  
+00022410: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00022420: 206c 656e 2873 656c 662e 6e75 6d62 6572   len(self.number
+00022430: 4653 656c 6563 7469 6f6e 2920 3e20 343a  FSelection) > 4:
+00022440: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022450: 2020 2020 2072 7377 6974 6368 203d 2073       rswitch = s
+00022460: 656c 662e 6e75 6d62 6572 4653 656c 6563  elf.numberFSelec
+00022470: 7469 6f6e 5b34 5d0a 0a20 2020 2020 2020  tion[4]..       
+00022480: 2020 2020 2020 2020 2020 2020 2066 756e               fun
+00022490: 635b 2772 7377 6974 6368 275d 203d 2072  c['rswitch'] = r
+000224a0: 7377 6974 6368 0a0a 2020 2020 2020 2020  switch..        
+000224b0: 2020 2020 2020 2020 2020 2020 6966 2072              if r
+000224c0: 7377 6974 6368 203c 2030 2e30 3a0a 2020  switch < 0.0:.  
+000224d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000224e0: 2020 2020 2020 7661 6c69 6420 3d20 4661        valid = Fa
+000224f0: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
+00022500: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00022510: 2e5f 5f66 2e61 7070 656e 6428 6622 5b49  .__f.append(f"[I
+00022520: 6e76 616c 6964 2064 6174 615d 207b 7365  nvalid data] {se
+00022530: 6c66 2e5f 5f67 6574 4375 7272 656e 7452  lf.__getCurrentR
+00022540: 6573 7472 6169 6e74 2829 7d22 0a20 2020  estraint()}".   
+00022550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022570: 2020 2020 2066 227b 6675 6e63 5479 7065       f"{funcType
+00022580: 7d20 6164 6469 7469 6f6e 616c 2076 616c  } additional val
+00022590: 7565 2066 6f72 2073 7769 7463 6869 6e67  ue for switching
+000225a0: 2066 726f 6d20 7468 6520 7570 7065 7220   from the upper 
+000225b0: 6c69 6d69 7420 746f 2074 6865 2075 7070  limit to the upp
+000225c0: 6572 206c 696e 6561 7220 6c69 6d69 7420  er linear limit 
+000225d0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+000225e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000225f0: 2020 2020 2020 2020 2020 6622 2772 7377            f"'rsw
+00022600: 6974 6368 3d7b 7273 7769 7463 687d 2720  itch={rswitch}' 
+00022610: 6d75 7374 206e 6f74 2062 6520 6120 6e65  must not be a ne
+00022620: 6761 7469 7665 2076 616c 7565 2e22 290a  gative value.").
+00022630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022640: 2069 6620 6374 782e 5369 6d70 6c65 5f6e   if ctx.Simple_n
+00022650: 616d 6528 3029 3a0a 2020 2020 2020 2020  ame(0):.        
+00022660: 2020 2020 2020 2020 2020 2020 6675 6e63              func
+00022670: 5b27 7461 6727 5d20 3d20 7374 7228 6374  ['tag'] = str(ct
+00022680: 782e 5369 6d70 6c65 5f6e 616d 6528 3029  x.Simple_name(0)
+00022690: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+000226a0: 2020 2066 756e 635b 276c 6f77 6572 5f6c     func['lower_l
+000226b0: 696d 6974 275d 203d 206c 620a 2020 2020  imit'] = lb.    
+000226c0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
+000226d0: 5b27 7570 7065 725f 6c69 6d69 7427 5d20  ['upper_limit'] 
+000226e0: 3d20 7562 0a0a 2020 2020 2020 2020 2020  = ub..          
+000226f0: 2020 2020 2020 6966 2075 6220 2b20 7273        if ub + rs
+00022700: 7769 7463 6820 3c20 4449 5354 5f45 5252  witch < DIST_ERR
+00022710: 4f52 5f4d 4158 206f 7220 7365 6c66 2e5f  OR_MAX or self._
+00022720: 5f63 7572 5f73 7562 7479 7065 2021 3d20  _cur_subtype != 
+00022730: 2764 6973 7427 3a0a 2020 2020 2020 2020  'dist':.        
+00022740: 2020 2020 2020 2020 2020 2020 6675 6e63              func
+00022750: 5b27 7570 7065 725f 6c69 6e65 6172 5f6c  ['upper_linear_l
+00022760: 696d 6974 275d 203d 2075 6220 2b20 7273  imit'] = ub + rs
+00022770: 7769 7463 680a 2020 2020 2020 2020 2020  witch.          
+00022780: 2020 2020 2020 6966 206c 6220 2d20 7273        if lb - rs
+00022790: 7769 7463 6820 3e3d 2044 4953 545f 4552  witch >= DIST_ER
+000227a0: 524f 525f 4d49 4e20 6f72 2073 656c 662e  ROR_MIN or self.
+000227b0: 5f5f 6375 725f 7375 6274 7970 6520 213d  __cur_subtype !=
+000227c0: 2027 6469 7374 273a 0a20 2020 2020 2020   'dist':.       
+000227d0: 2020 2020 2020 2020 2020 2020 2066 756e               fun
+000227e0: 635b 276c 6f77 6572 5f6c 696e 6561 725f  c['lower_linear_
+000227f0: 6c69 6d69 7427 5d20 3d20 6c62 202d 2072  limit'] = lb - r
+00022800: 7377 6974 6368 0a0a 2020 2020 2020 2020  switch..        
+00022810: 2020 2020 656c 6966 2063 7478 2e4f 4646      elif ctx.OFF
+00022820: 5345 5450 4552 494f 4449 4342 4f55 4e44  SETPERIODICBOUND
+00022830: 4544 2829 3a20 2023 206f 6666 7365 7420  ED():  # offset 
+00022840: 7065 7269 6f64 206c 6220 7562 2073 6420  period lb ub sd 
+00022850: 7273 7769 7463 6820 7461 670a 2020 2020  rswitch tag.    
+00022860: 2020 2020 2020 2020 2020 2020 6675 6e63              func
+00022870: 5479 7065 203d 2027 4f46 4653 4554 5045  Type = 'OFFSETPE
+00022880: 5249 4f44 4943 424f 554e 4445 4427 0a0a  RIODICBOUNDED'..
+00022890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000228a0: 6f66 6673 6574 203d 2073 656c 662e 6e75  offset = self.nu
+000228b0: 6d62 6572 4653 656c 6563 7469 6f6e 5b30  mberFSelection[0
+000228c0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+000228d0: 2020 7065 7269 6f64 203d 2073 656c 662e    period = self.
+000228e0: 6e75 6d62 6572 4653 656c 6563 7469 6f6e  numberFSelection
+000228f0: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
+00022900: 2020 2020 6c62 203d 2073 656c 662e 6e75      lb = self.nu
+00022910: 6d62 6572 4653 656c 6563 7469 6f6e 5b32  mberFSelection[2
+00022920: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00022930: 2020 7562 203d 2073 656c 662e 6e75 6d62    ub = self.numb
+00022940: 6572 4653 656c 6563 7469 6f6e 5b33 5d0a  erFSelection[3].
+00022950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022960: 7364 203d 2073 656c 662e 6e75 6d62 6572  sd = self.number
+00022970: 4653 656c 6563 7469 6f6e 5b34 5d0a 2020  FSelection[4].  
+00022980: 2020 2020 2020 2020 2020 2020 2020 7273                rs
+00022990: 7769 7463 6820 3d20 302e 350a 0a20 2020  witch = 0.5..   
+000229a0: 2020 2020 2020 2020 2020 2020 2066 756e               fun
+000229b0: 635b 276e 616d 6527 5d20 3d20 6675 6e63  c['name'] = func
+000229c0: 5479 7065 0a20 2020 2020 2020 2020 2020  Type.           
+000229d0: 2020 2020 2066 756e 635b 276f 6666 7365       func['offse
+000229e0: 7427 5d20 3d20 6f66 6673 6574 0a20 2020  t'] = offset.   
+000229f0: 2020 2020 2020 2020 2020 2020 2066 756e               fun
+00022a00: 635b 2770 6572 696f 6427 5d20 3d20 7065  c['period'] = pe
+00022a10: 7269 6f64 0a20 2020 2020 2020 2020 2020  riod.           
+00022a20: 2020 2020 2066 756e 635b 276c 6227 5d20       func['lb'] 
+00022a30: 3d20 6c62 0a20 2020 2020 2020 2020 2020  = lb.           
+00022a40: 2020 2020 2066 756e 635b 2775 6227 5d20       func['ub'] 
+00022a50: 3d20 7562 0a20 2020 2020 2020 2020 2020  = ub.           
+00022a60: 2020 2020 2066 756e 635b 2773 6427 5d20       func['sd'] 
+00022a70: 3d20 7364 0a0a 2020 2020 2020 2020 2020  = sd..          
+00022a80: 2020 2020 2020 6966 2073 656c 662e 5f5f        if self.__
+00022a90: 7265 6d65 6469 6174 6520 616e 6420 7365  remediate and se
+00022aa0: 6c66 2e5f 5f72 6561 736f 6e73 2069 7320  lf.__reasons is 
+00022ab0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00022ac0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00022ad0: 2073 656c 662e 5f5f 6375 725f 7375 6274   self.__cur_subt
+00022ae0: 7970 6520 3d3d 2027 6469 7374 2720 616e  ype == 'dist' an
+00022af0: 6420 2764 6973 745f 756e 7573 7561 6c5f  d 'dist_unusual_
+00022b00: 6f72 6465 7227 2069 6e20 7365 6c66 2e5f  order' in self._
+00022b10: 5f72 6561 736f 6e73 3a0a 2020 2020 2020  _reasons:.      
+00022b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022b30: 2020 7461 7267 6574 5f76 616c 7565 2c20    target_value, 
+00022b40: 646d 696e 7573 2c20 6470 6c75 7320 3d20  dminus, dplus = 
+00022b50: 6c62 2c20 7562 2c20 7364 0a20 2020 2020  lb, ub, sd.     
+00022b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022b70: 2020 2066 756e 635b 276c 6227 5d20 3d20     func['lb'] = 
+00022b80: 7461 7267 6574 5f76 616c 7565 202d 2064  target_value - d
+00022b90: 6d69 6e75 730a 2020 2020 2020 2020 2020  minus.          
+00022ba0: 2020 2020 2020 2020 2020 2020 2020 6675                fu
+00022bb0: 6e63 5b27 7562 275d 203d 2074 6172 6765  nc['ub'] = targe
+00022bc0: 745f 7661 6c75 6520 2b20 6470 6c75 730a  t_value + dplus.
+00022bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022be0: 2020 2020 2020 2020 6675 6e63 5b27 7364          func['sd
+00022bf0: 275d 203d 2028 646d 696e 7573 202b 2064  '] = (dminus + d
+00022c00: 706c 7573 2920 2f20 322e 300a 0a20 2020  plus) / 2.0..   
+00022c10: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00022c20: 7065 7269 6f64 203c 2030 2e30 3a0a 2020  period < 0.0:.  
+00022c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022c40: 2020 7661 6c69 6420 3d20 4661 6c73 650a    valid = False.
+00022c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022c60: 2020 2020 7365 6c66 2e5f 5f66 2e61 7070      self.__f.app
+00022c70: 656e 6428 6622 5b49 6e76 616c 6964 2064  end(f"[Invalid d
+00022c80: 6174 615d 207b 7365 6c66 2e5f 5f67 6574  ata] {self.__get
+00022c90: 4375 7272 656e 7452 6573 7472 6169 6e74  CurrentRestraint
+00022ca0: 2829 7d22 0a20 2020 2020 2020 2020 2020  ()}".           
+00022cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022cc0: 2020 2020 2020 2020 2066 227b 6675 6e63           f"{func
+00022cd0: 5479 7065 7d20 2770 6572 696f 643d 7b70  Type} 'period={p
+00022ce0: 6572 696f 647d 2720 6d75 7374 206e 6f74  eriod}' must not
+00022cf0: 2062 6520 6120 6e65 6761 7469 7665 2076   be a negative v
+00022d00: 616c 7565 2e22 290a 2020 2020 2020 2020  alue.").        
+00022d10: 2020 2020 2020 2020 6966 206c 6220 3e20          if lb > 
+00022d20: 7562 3a0a 2020 2020 2020 2020 2020 2020  ub:.            
+00022d30: 2020 2020 2020 2020 7661 6c69 6420 3d20          valid = 
+00022d40: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
+00022d50: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00022d60: 5f66 2e61 7070 656e 6428 6622 5b49 6e76  _f.append(f"[Inv
+00022d70: 616c 6964 2064 6174 615d 207b 7365 6c66  alid data] {self
+00022d80: 2e5f 5f67 6574 4375 7272 656e 7452 6573  .__getCurrentRes
+00022d90: 7472 6169 6e74 2829 7d22 0a20 2020 2020  traint()}".     
 00022da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022db0: 2020 6966 2073 656c 662e 5f5f 6375 725f    if self.__cur_
-00022dc0: 7375 6274 7970 6520 3d3d 2027 6469 7374  subtype == 'dist
-00022dd0: 2720 616e 6420 2764 6973 745f 756e 7573  ' and 'dist_unus
-00022de0: 7561 6c5f 6f72 6465 7227 2069 6e20 7365  ual_order' in se
-00022df0: 6c66 2e5f 5f72 6561 736f 6e73 3a0a 2020  lf.__reasons:.  
-00022e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022e10: 2020 2020 2020 7461 7267 6574 5f76 616c        target_val
-00022e20: 7565 2c20 646d 696e 7573 2c20 6470 6c75  ue, dminus, dplu
-00022e30: 7320 3d20 6c62 2c20 7562 2c20 7364 0a20  s = lb, ub, sd. 
-00022e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022e50: 2020 2020 2020 2066 756e 635b 276c 6227         func['lb'
-00022e60: 5d20 3d20 7461 7267 6574 5f76 616c 7565  ] = target_value
-00022e70: 202d 2064 6d69 6e75 730a 2020 2020 2020   - dminus.      
-00022e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022e90: 2020 6675 6e63 5b27 7562 275d 203d 2074    func['ub'] = t
-00022ea0: 6172 6765 745f 7661 6c75 6520 2b20 6470  arget_value + dp
-00022eb0: 6c75 730a 2020 2020 2020 2020 2020 2020  lus.            
-00022ec0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
-00022ed0: 5b27 7364 275d 203d 2028 646d 696e 7573  ['sd'] = (dminus
-00022ee0: 202b 2064 706c 7573 2920 2f20 322e 300a   + dplus) / 2.0.
-00022ef0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022f00: 2069 6620 7065 7269 6f64 203c 2030 2e30   if period < 0.0
-00022f10: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00022f20: 2020 2020 2020 7661 6c69 6420 3d20 4661        valid = Fa
-00022f30: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
-00022f40: 2020 2020 2020 2020 7365 6c66 2e5f 5f66          self.__f
-00022f50: 2e61 7070 656e 6428 6622 5b49 6e76 616c  .append(f"[Inval
-00022f60: 6964 2064 6174 615d 207b 7365 6c66 2e5f  id data] {self._
-00022f70: 5f67 6574 4375 7272 656e 7452 6573 7472  _getCurrentRestr
-00022f80: 6169 6e74 2829 7d22 0a20 2020 2020 2020  aint()}".       
-00022f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022fa0: 2020 2020 2020 2020 2020 2020 2066 227b               f"{
-00022fb0: 6675 6e63 5479 7065 7d20 2770 6572 696f  funcType} 'perio
-00022fc0: 643d 7b70 6572 696f 647d 2720 6d75 7374  d={period}' must
-00022fd0: 206e 6f74 2062 6520 6120 6e65 6761 7469   not be a negati
-00022fe0: 7665 2076 616c 7565 2e22 290a 2020 2020  ve value.").    
-00022ff0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-00023000: 6220 3e20 7562 3a0a 2020 2020 2020 2020  b > ub:.        
-00023010: 2020 2020 2020 2020 2020 2020 7661 6c69              vali
-00023020: 6420 3d20 4661 6c73 650a 2020 2020 2020  d = False.      
-00023030: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00023040: 6c66 2e5f 5f66 2e61 7070 656e 6428 6622  lf.__f.append(f"
-00023050: 5b49 6e76 616c 6964 2064 6174 615d 207b  [Invalid data] {
-00023060: 7365 6c66 2e5f 5f67 6574 4375 7272 656e  self.__getCurren
-00023070: 7452 6573 7472 6169 6e74 2829 7d22 0a20  tRestraint()}". 
-00023080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000230a0: 2020 2066 227b 6675 6e63 5479 7065 7d20     f"{funcType} 
-000230b0: 6c6f 7765 7220 626f 756e 6461 7279 2027  lower boundary '
-000230c0: 6c62 3d7b 6c62 7d27 206d 7573 7420 6265  lb={lb}' must be
-000230d0: 206c 6573 7320 7468 616e 206f 7220 6571   less than or eq
-000230e0: 7561 6c20 746f 2075 7070 6572 2062 6f75  ual to upper bou
-000230f0: 6e64 6172 7920 2775 623d 7b75 627d 272e  ndary 'ub={ub}'.
-00023100: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
-00023110: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
-00023120: 5f72 656d 6564 6961 7465 3a0a 2020 2020  _remediate:.    
-00023130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023140: 2020 2020 6966 2073 656c 662e 5f5f 6375      if self.__cu
-00023150: 725f 7375 6274 7970 6520 3d3d 2027 6469  r_subtype == 'di
-00023160: 7374 2720 616e 6420 6c62 203e 2073 643a  st' and lb > sd:
-00023170: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023180: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00023190: 662e 5f5f 6469 7374 5f6c 625f 6772 6561  f.__dist_lb_grea
-000231a0: 7465 725f 7468 616e 5f75 6220 3d20 5472  ter_than_ub = Tr
-000231b0: 7565 0a20 2020 2020 2020 2020 2020 2020  ue.             
-000231c0: 2020 2069 6620 7365 6c66 2e5f 5f72 656d     if self.__rem
-000231d0: 6564 6961 7465 3a0a 2020 2020 2020 2020  ediate:.        
-000231e0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-000231f0: 656c 662e 5f5f 6375 725f 7375 6274 7970  elf.__cur_subtyp
-00023200: 6520 3d3d 2027 6469 7374 2720 616e 6420  e == 'dist' and 
-00023210: 2875 6220 3e20 6c62 206f 7220 7364 203e  (ub > lb or sd >
-00023220: 206c 6229 3a0a 2020 2020 2020 2020 2020   lb):.          
-00023230: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00023240: 6c66 2e5f 5f64 6973 745f 7562 5f61 6c77  lf.__dist_ub_alw
-00023250: 6179 735f 706f 7369 7469 7665 203d 2046  ays_positive = F
-00023260: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-00023270: 2020 2020 2069 6620 7364 203c 3d20 302e       if sd <= 0.
-00023280: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-00023290: 2020 2020 2020 2076 616c 6964 203d 2046         valid = F
-000232a0: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-000232b0: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
-000232c0: 662e 6170 7065 6e64 2866 225b 496e 7661  f.append(f"[Inva
-000232d0: 6c69 6420 6461 7461 5d20 7b73 656c 662e  lid data] {self.
-000232e0: 5f5f 6765 7443 7572 7265 6e74 5265 7374  __getCurrentRest
-000232f0: 7261 696e 7428 297d 220a 2020 2020 2020  raint()}".      
-00023300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023310: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-00023320: 7b66 756e 6354 7970 657d 2073 7461 6e64  {funcType} stand
-00023330: 6172 6420 6465 7669 6174 696f 6e20 2773  ard deviation 's
-00023340: 643d 7b73 647d 2720 6d75 7374 2062 6520  d={sd}' must be 
-00023350: 6120 706f 7369 7469 7665 2076 616c 7565  a positive value
-00023360: 2e22 290a 0a20 2020 2020 2020 2020 2020  .")..           
-00023370: 2020 2020 2069 6620 6c65 6e28 7365 6c66       if len(self
-00023380: 2e6e 756d 6265 7246 5365 6c65 6374 696f  .numberFSelectio
-00023390: 6e29 203e 2035 3a0a 2020 2020 2020 2020  n) > 5:.        
-000233a0: 2020 2020 2020 2020 2020 2020 7273 7769              rswi
-000233b0: 7463 6820 3d20 7365 6c66 2e6e 756d 6265  tch = self.numbe
-000233c0: 7246 5365 6c65 6374 696f 6e5b 355d 0a0a  rFSelection[5]..
-000233d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000233e0: 2020 2020 6675 6e63 5b27 7273 7769 7463      func['rswitc
-000233f0: 6827 5d20 3d20 7273 7769 7463 680a 0a20  h'] = rswitch.. 
-00023400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023410: 2020 2069 6620 7273 7769 7463 6820 3c20     if rswitch < 
-00023420: 302e 303a 0a20 2020 2020 2020 2020 2020  0.0:.           
-00023430: 2020 2020 2020 2020 2020 2020 2076 616c               val
-00023440: 6964 203d 2046 616c 7365 0a20 2020 2020  id = False.     
+00022db0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00022dc0: 227b 6675 6e63 5479 7065 7d20 6c6f 7765  "{funcType} lowe
+00022dd0: 7220 626f 756e 6461 7279 2027 6c62 3d7b  r boundary 'lb={
+00022de0: 6c62 7d27 206d 7573 7420 6265 206c 6573  lb}' must be les
+00022df0: 7320 7468 616e 206f 7220 6571 7561 6c20  s than or equal 
+00022e00: 746f 2075 7070 6572 2062 6f75 6e64 6172  to upper boundar
+00022e10: 7920 2775 623d 7b75 627d 272e 2229 0a20  y 'ub={ub}'."). 
+00022e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022e30: 2020 2069 6620 7365 6c66 2e5f 5f72 656d     if self.__rem
+00022e40: 6564 6961 7465 3a0a 2020 2020 2020 2020  ediate:.        
+00022e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022e60: 6966 2073 656c 662e 5f5f 6375 725f 7375  if self.__cur_su
+00022e70: 6274 7970 6520 3d3d 2027 6469 7374 2720  btype == 'dist' 
+00022e80: 616e 6420 6c62 203e 2073 643a 0a20 2020  and lb > sd:.   
+00022e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022ea0: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
+00022eb0: 6469 7374 5f6c 625f 6772 6561 7465 725f  dist_lb_greater_
+00022ec0: 7468 616e 5f75 6220 3d20 5472 7565 0a20  than_ub = True. 
+00022ed0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00022ee0: 6620 7365 6c66 2e5f 5f72 656d 6564 6961  f self.__remedia
+00022ef0: 7465 3a0a 2020 2020 2020 2020 2020 2020  te:.            
+00022f00: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00022f10: 5f5f 6375 725f 7375 6274 7970 6520 3d3d  __cur_subtype ==
+00022f20: 2027 6469 7374 2720 616e 6420 2875 6220   'dist' and (ub 
+00022f30: 3e20 6c62 206f 7220 7364 203e 206c 6229  > lb or sd > lb)
+00022f40: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00022f50: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00022f60: 5f64 6973 745f 7562 5f61 6c77 6179 735f  _dist_ub_always_
+00022f70: 706f 7369 7469 7665 203d 2046 616c 7365  positive = False
+00022f80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022f90: 2069 6620 7364 203c 3d20 302e 303a 0a20   if sd <= 0.0:. 
+00022fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022fb0: 2020 2076 616c 6964 203d 2046 616c 7365     valid = False
+00022fc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022fd0: 2020 2020 2073 656c 662e 5f5f 662e 6170       self.__f.ap
+00022fe0: 7065 6e64 2866 225b 496e 7661 6c69 6420  pend(f"[Invalid 
+00022ff0: 6461 7461 5d20 7b73 656c 662e 5f5f 6765  data] {self.__ge
+00023000: 7443 7572 7265 6e74 5265 7374 7261 696e  tCurrentRestrain
+00023010: 7428 297d 220a 2020 2020 2020 2020 2020  t()}".          
+00023020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023030: 2020 2020 2020 2020 2020 6622 7b66 756e            f"{fun
+00023040: 6354 7970 657d 2073 7461 6e64 6172 6420  cType} standard 
+00023050: 6465 7669 6174 696f 6e20 2773 643d 7b73  deviation 'sd={s
+00023060: 647d 2720 6d75 7374 2062 6520 6120 706f  d}' must be a po
+00023070: 7369 7469 7665 2076 616c 7565 2e22 290a  sitive value.").
+00023080: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023090: 2069 6620 6c65 6e28 7365 6c66 2e6e 756d   if len(self.num
+000230a0: 6265 7246 5365 6c65 6374 696f 6e29 203e  berFSelection) >
+000230b0: 2035 3a0a 2020 2020 2020 2020 2020 2020   5:.            
+000230c0: 2020 2020 2020 2020 7273 7769 7463 6820          rswitch 
+000230d0: 3d20 7365 6c66 2e6e 756d 6265 7246 5365  = self.numberFSe
+000230e0: 6c65 6374 696f 6e5b 355d 0a0a 2020 2020  lection[5]..    
+000230f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023100: 6675 6e63 5b27 7273 7769 7463 6827 5d20  func['rswitch'] 
+00023110: 3d20 7273 7769 7463 680a 0a20 2020 2020  = rswitch..     
+00023120: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00023130: 6620 7273 7769 7463 6820 3c20 302e 303a  f rswitch < 0.0:
+00023140: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023150: 2020 2020 2020 2020 2076 616c 6964 203d           valid =
+00023160: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
+00023170: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00023180: 656c 662e 5f5f 662e 6170 7065 6e64 2866  elf.__f.append(f
+00023190: 225b 496e 7661 6c69 6420 6461 7461 5d20  "[Invalid data] 
+000231a0: 7b73 656c 662e 5f5f 6765 7443 7572 7265  {self.__getCurre
+000231b0: 6e74 5265 7374 7261 696e 7428 297d 220a  ntRestraint()}".
+000231c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000231d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000231e0: 2020 2020 2020 2020 6622 7b66 756e 6354          f"{funcT
+000231f0: 7970 657d 2061 6464 6974 696f 6e61 6c20  ype} additional 
+00023200: 7661 6c75 6520 666f 7220 7377 6974 6368  value for switch
+00023210: 696e 6720 6672 6f6d 2074 6865 2075 7070  ing from the upp
+00023220: 6572 206c 696d 6974 2074 6f20 7468 6520  er limit to the 
+00023230: 7570 7065 7220 6c69 6e65 6172 206c 696d  upper linear lim
+00023240: 6974 2022 0a20 2020 2020 2020 2020 2020  it ".           
+00023250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023260: 2020 2020 2020 2020 2020 2020 2066 2227               f"'
+00023270: 7273 7769 7463 683d 7b72 7377 6974 6368  rswitch={rswitch
+00023280: 7d27 206d 7573 7420 6e6f 7420 6265 2061  }' must not be a
+00023290: 206e 6567 6174 6976 6520 7661 6c75 652e   negative value.
+000232a0: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
+000232b0: 2020 2020 6966 2063 7478 2e53 696d 706c      if ctx.Simpl
+000232c0: 655f 6e61 6d65 2830 293a 0a20 2020 2020  e_name(0):.     
+000232d0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000232e0: 756e 635b 2774 6167 275d 203d 2073 7472  unc['tag'] = str
+000232f0: 2863 7478 2e53 696d 706c 655f 6e61 6d65  (ctx.Simple_name
+00023300: 2830 2929 0a0a 2020 2020 2020 2020 2020  (0))..          
+00023310: 2020 2020 2020 6675 6e63 5b27 6c6f 7765        func['lowe
+00023320: 725f 6c69 6d69 7427 5d20 3d20 6c62 202b  r_limit'] = lb +
+00023330: 206f 6666 7365 740a 2020 2020 2020 2020   offset.        
+00023340: 2020 2020 2020 2020 6675 6e63 5b27 7570          func['up
+00023350: 7065 725f 6c69 6d69 7427 5d20 3d20 7562  per_limit'] = ub
+00023360: 202b 206f 6666 7365 740a 0a20 2020 2020   + offset..     
+00023370: 2020 2020 2020 2020 2020 2069 6620 7562             if ub
+00023380: 202b 2072 7377 6974 6368 203c 2044 4953   + rswitch < DIS
+00023390: 545f 4552 524f 525f 4d41 5820 6f72 2073  T_ERROR_MAX or s
+000233a0: 656c 662e 5f5f 6375 725f 7375 6274 7970  elf.__cur_subtyp
+000233b0: 6520 213d 2027 6469 7374 273a 0a20 2020  e != 'dist':.   
+000233c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000233d0: 2066 756e 635b 2775 7070 6572 5f6c 696e   func['upper_lin
+000233e0: 6561 725f 6c69 6d69 7427 5d20 3d20 7562  ear_limit'] = ub
+000233f0: 202b 2072 7377 6974 6368 0a20 2020 2020   + rswitch.     
+00023400: 2020 2020 2020 2020 2020 2069 6620 6c62             if lb
+00023410: 202d 2072 7377 6974 6368 203e 3d20 4449   - rswitch >= DI
+00023420: 5354 5f45 5252 4f52 5f4d 494e 206f 7220  ST_ERROR_MIN or 
+00023430: 7365 6c66 2e5f 5f63 7572 5f73 7562 7479  self.__cur_subty
+00023440: 7065 2021 3d20 2764 6973 7427 3a0a 2020  pe != 'dist':.  
 00023450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023460: 2020 2073 656c 662e 5f5f 662e 6170 7065     self.__f.appe
-00023470: 6e64 2866 225b 496e 7661 6c69 6420 6461  nd(f"[Invalid da
-00023480: 7461 5d20 7b73 656c 662e 5f5f 6765 7443  ta] {self.__getC
-00023490: 7572 7265 6e74 5265 7374 7261 696e 7428  urrentRestraint(
-000234a0: 297d 220a 2020 2020 2020 2020 2020 2020  )}".            
-000234b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000234c0: 2020 2020 2020 2020 2020 2020 6622 7b66              f"{f
-000234d0: 756e 6354 7970 657d 2061 6464 6974 696f  uncType} additio
-000234e0: 6e61 6c20 7661 6c75 6520 666f 7220 7377  nal value for sw
-000234f0: 6974 6368 696e 6720 6672 6f6d 2074 6865  itching from the
-00023500: 2075 7070 6572 206c 696d 6974 2074 6f20   upper limit to 
-00023510: 7468 6520 7570 7065 7220 6c69 6e65 6172  the upper linear
-00023520: 206c 696d 6974 2022 0a20 2020 2020 2020   limit ".       
-00023530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023550: 2066 2227 7273 7769 7463 683d 7b72 7377   f"'rswitch={rsw
-00023560: 6974 6368 7d27 206d 7573 7420 6e6f 7420  itch}' must not 
-00023570: 6265 2061 206e 6567 6174 6976 6520 7661  be a negative va
-00023580: 6c75 652e 2229 0a0a 2020 2020 2020 2020  lue.")..        
-00023590: 2020 2020 2020 2020 6966 2063 7478 2e53          if ctx.S
-000235a0: 696d 706c 655f 6e61 6d65 2830 293a 0a20  imple_name(0):. 
-000235b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000235c0: 2020 2066 756e 635b 2774 6167 275d 203d     func['tag'] =
-000235d0: 2073 7472 2863 7478 2e53 696d 706c 655f   str(ctx.Simple_
-000235e0: 6e61 6d65 2830 2929 0a0a 2020 2020 2020  name(0))..      
-000235f0: 2020 2020 2020 2020 2020 6675 6e63 5b27            func['
-00023600: 6c6f 7765 725f 6c69 6d69 7427 5d20 3d20  lower_limit'] = 
-00023610: 6c62 202b 206f 6666 7365 740a 2020 2020  lb + offset.    
-00023620: 2020 2020 2020 2020 2020 2020 6675 6e63              func
-00023630: 5b27 7570 7065 725f 6c69 6d69 7427 5d20  ['upper_limit'] 
-00023640: 3d20 7562 202b 206f 6666 7365 740a 0a20  = ub + offset.. 
-00023650: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00023660: 6620 7562 202b 2072 7377 6974 6368 203c  f ub + rswitch <
-00023670: 2044 4953 545f 4552 524f 525f 4d41 5820   DIST_ERROR_MAX 
-00023680: 6f72 2073 656c 662e 5f5f 6375 725f 7375  or self.__cur_su
-00023690: 6274 7970 6520 213d 2027 6469 7374 273a  btype != 'dist':
-000236a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000236b0: 2020 2020 2066 756e 635b 2775 7070 6572       func['upper
-000236c0: 5f6c 696e 6561 725f 6c69 6d69 7427 5d20  _linear_limit'] 
-000236d0: 3d20 7562 202b 2072 7377 6974 6368 0a20  = ub + rswitch. 
-000236e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000236f0: 6620 6c62 202d 2072 7377 6974 6368 203e  f lb - rswitch >
-00023700: 3d20 4449 5354 5f45 5252 4f52 5f4d 494e  = DIST_ERROR_MIN
-00023710: 206f 7220 7365 6c66 2e5f 5f63 7572 5f73   or self.__cur_s
-00023720: 7562 7479 7065 2021 3d20 2764 6973 7427  ubtype != 'dist'
-00023730: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00023740: 2020 2020 2020 6675 6e63 5b27 6c6f 7765        func['lowe
-00023750: 725f 6c69 6e65 6172 5f6c 696d 6974 275d  r_linear_limit']
-00023760: 203d 206c 6220 2d20 7273 7769 7463 680a   = lb - rswitch.
-00023770: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-00023780: 6620 6374 782e 414d 4245 5250 4552 494f  f ctx.AMBERPERIO
-00023790: 4449 4328 2920 6f72 2063 7478 2e43 4841  DIC() or ctx.CHA
-000237a0: 524d 4d50 4552 494f 4449 4328 293a 2020  RMMPERIODIC():  
-000237b0: 2320 7830 206e 5f70 6572 696f 6420 6b0a  # x0 n_period k.
-000237c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000237d0: 6675 6e63 5479 7065 203d 2027 414d 4245  funcType = 'AMBE
-000237e0: 5250 4552 494f 4449 4327 2069 6620 6374  RPERIODIC' if ct
-000237f0: 782e 414d 4245 5250 4552 494f 4449 4328  x.AMBERPERIODIC(
-00023800: 2920 656c 7365 2027 4348 4152 4d4d 5045  ) else 'CHARMMPE
-00023810: 5249 4f44 4943 270a 2020 2020 2020 2020  RIODIC'.        
-00023820: 2020 2020 2020 2020 7830 203d 2073 656c          x0 = sel
-00023830: 662e 6e75 6d62 6572 4653 656c 6563 7469  f.numberFSelecti
-00023840: 6f6e 5b30 5d0a 2020 2020 2020 2020 2020  on[0].          
-00023850: 2020 2020 2020 6e5f 7065 7269 6f64 203d        n_period =
-00023860: 2073 656c 662e 6e75 6d62 6572 4653 656c   self.numberFSel
-00023870: 6563 7469 6f6e 5b31 5d0a 2020 2020 2020  ection[1].      
-00023880: 2020 2020 2020 2020 2020 6b20 3d20 7365            k = se
-00023890: 6c66 2e6e 756d 6265 7246 5365 6c65 6374  lf.numberFSelect
-000238a0: 696f 6e5b 325d 0a0a 2020 2020 2020 2020  ion[2]..        
-000238b0: 2020 2020 2020 2020 6675 6e63 5b27 6e61          func['na
-000238c0: 6d65 275d 203d 2066 756e 6354 7970 650a  me'] = funcType.
-000238d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000238e0: 6675 6e63 5b27 7830 275d 203d 2078 300a  func['x0'] = x0.
-000238f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023900: 6675 6e63 5b27 6e5f 7065 7269 6f64 275d  func['n_period']
-00023910: 203d 206e 5f70 6572 696f 640a 2020 2020   = n_period.    
-00023920: 2020 2020 2020 2020 2020 2020 6675 6e63              func
-00023930: 5b27 6b27 5d20 3d20 6b0a 0a20 2020 2020  ['k'] = k..     
-00023940: 2020 2020 2020 2020 2020 2069 6620 7065             if pe
-00023950: 7269 6f64 203c 2030 2e30 3a0a 2020 2020  riod < 0.0:.    
-00023960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023970: 7661 6c69 6420 3d20 4661 6c73 650a 2020  valid = False.  
-00023980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023990: 2020 7365 6c66 2e5f 5f66 2e61 7070 656e    self.__f.appen
-000239a0: 6428 6622 5b49 6e76 616c 6964 2064 6174  d(f"[Invalid dat
-000239b0: 615d 207b 7365 6c66 2e5f 5f67 6574 4375  a] {self.__getCu
-000239c0: 7272 656e 7452 6573 7472 6169 6e74 2829  rrentRestraint()
-000239d0: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
-000239e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000239f0: 2020 2020 2020 2066 227b 6675 6e63 5479         f"{funcTy
-00023a00: 7065 7d20 7065 7269 6f64 6963 6974 7920  pe} periodicity 
-00023a10: 276e 5f70 6572 696f 643d 7b6e 5f70 6572  'n_period={n_per
-00023a20: 696f 647d 2720 6d75 7374 206e 6f74 2062  iod}' must not b
-00023a30: 6520 6120 6e65 6761 7469 7665 2076 616c  e a negative val
-00023a40: 7565 2e22 290a 0a20 2020 2020 2020 2020  ue.")..         
-00023a50: 2020 2065 6c69 6620 6374 782e 464c 4154     elif ctx.FLAT
-00023a60: 5f48 4152 4d4f 4e49 4328 2920 6f72 2063  _HARMONIC() or c
-00023a70: 7478 2e54 4f50 4f55 5428 293a 0a20 2020  tx.TOPOUT():.   
-00023a80: 2020 2020 2020 2020 2020 2020 2066 756e               fun
-00023a90: 6354 7970 6520 3d20 2746 4c41 545f 4841  cType = 'FLAT_HA
-00023aa0: 524d 4f4e 4943 2720 6966 2063 7478 2e46  RMONIC' if ctx.F
-00023ab0: 4c41 545f 4841 524d 4f4e 4943 2829 2065  LAT_HARMONIC() e
-00023ac0: 6c73 6520 2754 4f50 4f55 5427 0a0a 2020  lse 'TOPOUT'..  
-00023ad0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00023ae0: 2063 7478 2e46 4c41 545f 4841 524d 4f4e   ctx.FLAT_HARMON
-00023af0: 4943 2829 3a20 2023 2078 3020 7364 2074  IC():  # x0 sd t
-00023b00: 6f6c 0a20 2020 2020 2020 2020 2020 2020  ol.             
-00023b10: 2020 2020 2020 2078 3020 3d20 7365 6c66         x0 = self
-00023b20: 2e6e 756d 6265 7246 5365 6c65 6374 696f  .numberFSelectio
-00023b30: 6e5b 305d 0a20 2020 2020 2020 2020 2020  n[0].           
-00023b40: 2020 2020 2020 2020 2073 6420 3d20 7365           sd = se
-00023b50: 6c66 2e6e 756d 6265 7246 5365 6c65 6374  lf.numberFSelect
-00023b60: 696f 6e5b 315d 0a20 2020 2020 2020 2020  ion[1].         
-00023b70: 2020 2020 2020 2020 2020 2074 6f6c 203d             tol =
-00023b80: 2073 656c 662e 6e75 6d62 6572 4653 656c   self.numberFSel
-00023b90: 6563 7469 6f6e 5b32 5d0a 0a20 2020 2020  ection[2]..     
-00023ba0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00023bb0: 756e 635b 2778 3027 5d20 3d20 7830 0a20  unc['x0'] = x0. 
-00023bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023bd0: 2020 2066 756e 635b 2773 6427 5d20 3d20     func['sd'] = 
-00023be0: 7364 0a20 2020 2020 2020 2020 2020 2020  sd.             
-00023bf0: 2020 2020 2020 2066 756e 635b 2774 6f6c         func['tol
-00023c00: 275d 203d 2074 6f6c 0a0a 2020 2020 2020  '] = tol..      
-00023c10: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00023c20: 2073 6420 3c3d 2030 2e30 3a0a 2020 2020   sd <= 0.0:.    
-00023c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023c40: 2020 2020 7661 6c69 6420 3d20 4661 6c73      valid = Fals
-00023c50: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00023c60: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00023c70: 5f66 2e61 7070 656e 6428 6622 5b49 6e76  _f.append(f"[Inv
-00023c80: 616c 6964 2064 6174 615d 207b 7365 6c66  alid data] {self
-00023c90: 2e5f 5f67 6574 4375 7272 656e 7452 6573  .__getCurrentRes
-00023ca0: 7472 6169 6e74 2829 7d22 0a20 2020 2020  traint()}".     
-00023cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023cd0: 2020 2066 227b 6675 6e63 5479 7065 7d20     f"{funcType} 
-00023ce0: 7374 616e 6461 7264 2064 6576 6961 7469  standard deviati
-00023cf0: 6f6e 2027 7364 3d7b 7364 7d27 206d 7573  on 'sd={sd}' mus
-00023d00: 7420 6265 2061 2070 6f73 6974 6976 6520  t be a positive 
-00023d10: 7661 6c75 652e 2229 0a20 2020 2020 2020  value.").       
-00023d20: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00023d30: 746f 6c20 3c20 302e 303a 0a20 2020 2020  tol < 0.0:.     
-00023d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023d50: 2020 2076 616c 6964 203d 2046 616c 7365     valid = False
-00023d60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023d70: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
-00023d80: 662e 6170 7065 6e64 2866 225b 496e 7661  f.append(f"[Inva
-00023d90: 6c69 6420 6461 7461 5d20 7b73 656c 662e  lid data] {self.
-00023da0: 5f5f 6765 7443 7572 7265 6e74 5265 7374  __getCurrentRest
-00023db0: 7261 696e 7428 297d 220a 2020 2020 2020  raint()}".      
-00023dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023460: 2020 6675 6e63 5b27 6c6f 7765 725f 6c69    func['lower_li
+00023470: 6e65 6172 5f6c 696d 6974 275d 203d 206c  near_limit'] = l
+00023480: 6220 2d20 7273 7769 7463 680a 0a20 2020  b - rswitch..   
+00023490: 2020 2020 2020 2020 2065 6c69 6620 6374           elif ct
+000234a0: 782e 414d 4245 5250 4552 494f 4449 4328  x.AMBERPERIODIC(
+000234b0: 2920 6f72 2063 7478 2e43 4841 524d 4d50  ) or ctx.CHARMMP
+000234c0: 4552 494f 4449 4328 293a 2020 2320 7830  ERIODIC():  # x0
+000234d0: 206e 5f70 6572 696f 6420 6b0a 2020 2020   n_period k.    
+000234e0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
+000234f0: 5479 7065 203d 2027 414d 4245 5250 4552  Type = 'AMBERPER
+00023500: 494f 4449 4327 2069 6620 6374 782e 414d  IODIC' if ctx.AM
+00023510: 4245 5250 4552 494f 4449 4328 2920 656c  BERPERIODIC() el
+00023520: 7365 2027 4348 4152 4d4d 5045 5249 4f44  se 'CHARMMPERIOD
+00023530: 4943 270a 2020 2020 2020 2020 2020 2020  IC'.            
+00023540: 2020 2020 7830 203d 2073 656c 662e 6e75      x0 = self.nu
+00023550: 6d62 6572 4653 656c 6563 7469 6f6e 5b30  mberFSelection[0
+00023560: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00023570: 2020 6e5f 7065 7269 6f64 203d 2073 656c    n_period = sel
+00023580: 662e 6e75 6d62 6572 4653 656c 6563 7469  f.numberFSelecti
+00023590: 6f6e 5b31 5d0a 2020 2020 2020 2020 2020  on[1].          
+000235a0: 2020 2020 2020 6b20 3d20 7365 6c66 2e6e        k = self.n
+000235b0: 756d 6265 7246 5365 6c65 6374 696f 6e5b  umberFSelection[
+000235c0: 325d 0a0a 2020 2020 2020 2020 2020 2020  2]..            
+000235d0: 2020 2020 6675 6e63 5b27 6e61 6d65 275d      func['name']
+000235e0: 203d 2066 756e 6354 7970 650a 2020 2020   = funcType.    
+000235f0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
+00023600: 5b27 7830 275d 203d 2078 300a 2020 2020  ['x0'] = x0.    
+00023610: 2020 2020 2020 2020 2020 2020 6675 6e63              func
+00023620: 5b27 6e5f 7065 7269 6f64 275d 203d 206e  ['n_period'] = n
+00023630: 5f70 6572 696f 640a 2020 2020 2020 2020  _period.        
+00023640: 2020 2020 2020 2020 6675 6e63 5b27 6b27          func['k'
+00023650: 5d20 3d20 6b0a 0a20 2020 2020 2020 2020  ] = k..         
+00023660: 2020 2020 2020 2069 6620 7065 7269 6f64         if period
+00023670: 203c 2030 2e30 3a0a 2020 2020 2020 2020   < 0.0:.        
+00023680: 2020 2020 2020 2020 2020 2020 7661 6c69              vali
+00023690: 6420 3d20 4661 6c73 650a 2020 2020 2020  d = False.      
+000236a0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000236b0: 6c66 2e5f 5f66 2e61 7070 656e 6428 6622  lf.__f.append(f"
+000236c0: 5b49 6e76 616c 6964 2064 6174 615d 207b  [Invalid data] {
+000236d0: 7365 6c66 2e5f 5f67 6574 4375 7272 656e  self.__getCurren
+000236e0: 7452 6573 7472 6169 6e74 2829 7d22 0a20  tRestraint()}". 
+000236f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023710: 2020 2066 227b 6675 6e63 5479 7065 7d20     f"{funcType} 
+00023720: 7065 7269 6f64 6963 6974 7920 276e 5f70  periodicity 'n_p
+00023730: 6572 696f 643d 7b6e 5f70 6572 696f 647d  eriod={n_period}
+00023740: 2720 6d75 7374 206e 6f74 2062 6520 6120  ' must not be a 
+00023750: 6e65 6761 7469 7665 2076 616c 7565 2e22  negative value."
+00023760: 290a 0a20 2020 2020 2020 2020 2020 2065  )..            e
+00023770: 6c69 6620 6374 782e 464c 4154 5f48 4152  lif ctx.FLAT_HAR
+00023780: 4d4f 4e49 4328 2920 6f72 2063 7478 2e54  MONIC() or ctx.T
+00023790: 4f50 4f55 5428 293a 0a20 2020 2020 2020  OPOUT():.       
+000237a0: 2020 2020 2020 2020 2066 756e 6354 7970           funcTyp
+000237b0: 6520 3d20 2746 4c41 545f 4841 524d 4f4e  e = 'FLAT_HARMON
+000237c0: 4943 2720 6966 2063 7478 2e46 4c41 545f  IC' if ctx.FLAT_
+000237d0: 4841 524d 4f4e 4943 2829 2065 6c73 6520  HARMONIC() else 
+000237e0: 2754 4f50 4f55 5427 0a0a 2020 2020 2020  'TOPOUT'..      
+000237f0: 2020 2020 2020 2020 2020 6966 2063 7478            if ctx
+00023800: 2e46 4c41 545f 4841 524d 4f4e 4943 2829  .FLAT_HARMONIC()
+00023810: 3a20 2023 2078 3020 7364 2074 6f6c 0a20  :  # x0 sd tol. 
+00023820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023830: 2020 2078 3020 3d20 7365 6c66 2e6e 756d     x0 = self.num
+00023840: 6265 7246 5365 6c65 6374 696f 6e5b 305d  berFSelection[0]
+00023850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023860: 2020 2020 2073 6420 3d20 7365 6c66 2e6e       sd = self.n
+00023870: 756d 6265 7246 5365 6c65 6374 696f 6e5b  umberFSelection[
+00023880: 315d 0a20 2020 2020 2020 2020 2020 2020  1].             
+00023890: 2020 2020 2020 2074 6f6c 203d 2073 656c         tol = sel
+000238a0: 662e 6e75 6d62 6572 4653 656c 6563 7469  f.numberFSelecti
+000238b0: 6f6e 5b32 5d0a 0a20 2020 2020 2020 2020  on[2]..         
+000238c0: 2020 2020 2020 2020 2020 2066 756e 635b             func[
+000238d0: 2778 3027 5d20 3d20 7830 0a20 2020 2020  'x0'] = x0.     
+000238e0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000238f0: 756e 635b 2773 6427 5d20 3d20 7364 0a20  unc['sd'] = sd. 
+00023900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023910: 2020 2066 756e 635b 2774 6f6c 275d 203d     func['tol'] =
+00023920: 2074 6f6c 0a0a 2020 2020 2020 2020 2020   tol..          
+00023930: 2020 2020 2020 2020 2020 6966 2073 6420            if sd 
+00023940: 3c3d 2030 2e30 3a0a 2020 2020 2020 2020  <= 0.0:.        
+00023950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023960: 7661 6c69 6420 3d20 4661 6c73 650a 2020  valid = False.  
+00023970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023980: 2020 2020 2020 7365 6c66 2e5f 5f66 2e61        self.__f.a
+00023990: 7070 656e 6428 6622 5b49 6e76 616c 6964  ppend(f"[Invalid
+000239a0: 2064 6174 615d 207b 7365 6c66 2e5f 5f67   data] {self.__g
+000239b0: 6574 4375 7272 656e 7452 6573 7472 6169  etCurrentRestrai
+000239c0: 6e74 2829 7d22 0a20 2020 2020 2020 2020  nt()}".         
+000239d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000239e0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000239f0: 227b 6675 6e63 5479 7065 7d20 7374 616e  "{funcType} stan
+00023a00: 6461 7264 2064 6576 6961 7469 6f6e 2027  dard deviation '
+00023a10: 7364 3d7b 7364 7d27 206d 7573 7420 6265  sd={sd}' must be
+00023a20: 2061 2070 6f73 6974 6976 6520 7661 6c75   a positive valu
+00023a30: 652e 2229 0a20 2020 2020 2020 2020 2020  e.").           
+00023a40: 2020 2020 2020 2020 2069 6620 746f 6c20           if tol 
+00023a50: 3c20 302e 303a 0a20 2020 2020 2020 2020  < 0.0:.         
+00023a60: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00023a70: 616c 6964 203d 2046 616c 7365 0a20 2020  alid = False.   
+00023a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023a90: 2020 2020 2073 656c 662e 5f5f 662e 6170       self.__f.ap
+00023aa0: 7065 6e64 2866 225b 496e 7661 6c69 6420  pend(f"[Invalid 
+00023ab0: 6461 7461 5d20 7b73 656c 662e 5f5f 6765  data] {self.__ge
+00023ac0: 7443 7572 7265 6e74 5265 7374 7261 696e  tCurrentRestrain
+00023ad0: 7428 297d 220a 2020 2020 2020 2020 2020  t()}".          
+00023ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023af0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+00023b00: 7b66 756e 6354 7970 657d 2074 6f6c 6572  {funcType} toler
+00023b10: 616e 6365 2027 746f 6c3d 7b74 6f6c 7d27  ance 'tol={tol}'
+00023b20: 206d 7573 7420 6e6f 7420 6265 2061 206e   must not be a n
+00023b30: 6567 6174 6976 6520 7661 6c75 652e 2229  egative value.")
+00023b40: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00023b50: 2020 2020 2020 6675 6e63 5b27 7461 7267        func['targ
+00023b60: 6574 5f76 616c 7565 275d 203d 2078 300a  et_value'] = x0.
+00023b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023b80: 2020 2020 6675 6e63 5b27 6c6f 7765 725f      func['lower_
+00023b90: 6c69 6d69 7427 5d20 3d20 7830 202d 2074  limit'] = x0 - t
+00023ba0: 6f6c 202d 2073 640a 2020 2020 2020 2020  ol - sd.        
+00023bb0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
+00023bc0: 5b27 7570 7065 725f 6c69 6d69 7427 5d20  ['upper_limit'] 
+00023bd0: 3d20 7830 202b 2074 6f6c 202b 2073 640a  = x0 + tol + sd.
+00023be0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023bf0: 2065 6c73 653a 2020 2320 7765 6967 6874   else:  # weight
+00023c00: 2078 3020 6c69 6d69 740a 2020 2020 2020   x0 limit.      
+00023c10: 2020 2020 2020 2020 2020 2020 2020 7765                we
+00023c20: 6967 6874 203d 2073 656c 662e 6e75 6d62  ight = self.numb
+00023c30: 6572 4653 656c 6563 7469 6f6e 5b30 5d0a  erFSelection[0].
+00023c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023c50: 2020 2020 7830 203d 2073 656c 662e 6e75      x0 = self.nu
+00023c60: 6d62 6572 4653 656c 6563 7469 6f6e 5b31  mberFSelection[1
+00023c70: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00023c80: 2020 2020 2020 6c69 6d69 7420 3d20 7365        limit = se
+00023c90: 6c66 2e6e 756d 6265 7246 5365 6c65 6374  lf.numberFSelect
+00023ca0: 696f 6e5b 325d 0a0a 2020 2020 2020 2020  ion[2]..        
+00023cb0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
+00023cc0: 5b27 7765 6967 6874 275d 203d 2077 6569  ['weight'] = wei
+00023cd0: 6768 740a 2020 2020 2020 2020 2020 2020  ght.            
+00023ce0: 2020 2020 2020 2020 6675 6e63 5b27 7830          func['x0
+00023cf0: 275d 203d 2078 300a 2020 2020 2020 2020  '] = x0.        
+00023d00: 2020 2020 2020 2020 2020 2020 6675 6e63              func
+00023d10: 5b27 6c69 6d69 7427 5d20 3d20 6c69 6d69  ['limit'] = limi
+00023d20: 740a 0a20 2020 2020 2020 2020 2020 2020  t..             
+00023d30: 2020 2020 2020 2069 6620 7765 6967 6874         if weight
+00023d40: 203c 2030 2e30 3a0a 2020 2020 2020 2020   < 0.0:.        
+00023d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023d60: 7661 6c69 6420 3d20 4661 6c73 650a 2020  valid = False.  
+00023d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023d80: 2020 2020 2020 7365 6c66 2e5f 5f66 2e61        self.__f.a
+00023d90: 7070 656e 6428 6622 5b49 6e76 616c 6964  ppend(f"[Invalid
+00023da0: 2064 6174 615d 207b 7365 6c66 2e5f 5f67   data] {self.__g
+00023db0: 6574 4375 7272 656e 7452 6573 7472 6169  etCurrentRestrai
+00023dc0: 6e74 2829 7d22 0a20 2020 2020 2020 2020  nt()}".         
 00023dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023de0: 2020 6622 7b66 756e 6354 7970 657d 2074    f"{funcType} t
-00023df0: 6f6c 6572 616e 6365 2027 746f 6c3d 7b74  olerance 'tol={t
-00023e00: 6f6c 7d27 206d 7573 7420 6e6f 7420 6265  ol}' must not be
-00023e10: 2061 206e 6567 6174 6976 6520 7661 6c75   a negative valu
-00023e20: 652e 2229 0a0a 2020 2020 2020 2020 2020  e.")..          
-00023e30: 2020 2020 2020 2020 2020 6675 6e63 5b27            func['
-00023e40: 7461 7267 6574 5f76 616c 7565 275d 203d  target_value'] =
-00023e50: 2078 300a 2020 2020 2020 2020 2020 2020   x0.            
-00023e60: 2020 2020 2020 2020 6675 6e63 5b27 6c6f          func['lo
-00023e70: 7765 725f 6c69 6d69 7427 5d20 3d20 7830  wer_limit'] = x0
-00023e80: 202d 2074 6f6c 202d 2073 640a 2020 2020   - tol - sd.    
-00023e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023ea0: 6675 6e63 5b27 7570 7065 725f 6c69 6d69  func['upper_limi
-00023eb0: 7427 5d20 3d20 7830 202b 2074 6f6c 202b  t'] = x0 + tol +
-00023ec0: 2073 640a 0a20 2020 2020 2020 2020 2020   sd..           
-00023ed0: 2020 2020 2065 6c73 653a 2020 2320 7765       else:  # we
-00023ee0: 6967 6874 2078 3020 6c69 6d69 740a 2020  ight x0 limit.  
-00023ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023f00: 2020 7765 6967 6874 203d 2073 656c 662e    weight = self.
-00023f10: 6e75 6d62 6572 4653 656c 6563 7469 6f6e  numberFSelection
-00023f20: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
-00023f30: 2020 2020 2020 2020 7830 203d 2073 656c          x0 = sel
-00023f40: 662e 6e75 6d62 6572 4653 656c 6563 7469  f.numberFSelecti
-00023f50: 6f6e 5b31 5d0a 2020 2020 2020 2020 2020  on[1].          
-00023f60: 2020 2020 2020 2020 2020 6c69 6d69 7420            limit 
-00023f70: 3d20 7365 6c66 2e6e 756d 6265 7246 5365  = self.numberFSe
-00023f80: 6c65 6374 696f 6e5b 325d 0a0a 2020 2020  lection[2]..    
-00023f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023fa0: 6675 6e63 5b27 7765 6967 6874 275d 203d  func['weight'] =
-00023fb0: 2077 6569 6768 740a 2020 2020 2020 2020   weight.        
-00023fc0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
-00023fd0: 5b27 7830 275d 203d 2078 300a 2020 2020  ['x0'] = x0.    
-00023fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023ff0: 6675 6e63 5b27 6c69 6d69 7427 5d20 3d20  func['limit'] = 
-00024000: 6c69 6d69 740a 0a20 2020 2020 2020 2020  limit..         
-00024010: 2020 2020 2020 2020 2020 2069 6620 7765             if we
-00024020: 6967 6874 203c 2030 2e30 3a0a 2020 2020  ight < 0.0:.    
-00024030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024040: 2020 2020 7661 6c69 6420 3d20 4661 6c73      valid = Fals
-00024050: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00024060: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00024070: 5f66 2e61 7070 656e 6428 6622 5b49 6e76  _f.append(f"[Inv
-00024080: 616c 6964 2064 6174 615d 207b 7365 6c66  alid data] {self
-00024090: 2e5f 5f67 6574 4375 7272 656e 7452 6573  .__getCurrentRes
-000240a0: 7472 6169 6e74 2829 7d22 0a20 2020 2020  traint()}".     
-000240b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000240c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000240d0: 2020 2066 227b 6675 6e63 5479 7065 7d20     f"{funcType} 
-000240e0: 2777 6569 6768 743d 7b77 6569 6768 747d  'weight={weight}
-000240f0: 2720 6d75 7374 206e 6f74 2062 6520 6120  ' must not be a 
-00024100: 6e65 6761 7469 7665 2076 616c 7565 2e22  negative value."
-00024110: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00024120: 2020 2020 2020 656c 6966 2077 6569 6768        elif weigh
-00024130: 7420 3d3d 2030 2e30 3a0a 2020 2020 2020  t == 0.0:.      
-00024140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024150: 2020 7365 6c66 2e5f 5f66 2e61 7070 656e    self.__f.appen
-00024160: 6428 6622 5b52 616e 6765 2076 616c 7565  d(f"[Range value
-00024170: 2077 6172 6e69 6e67 5d20 7b73 656c 662e   warning] {self.
-00024180: 5f5f 6765 7443 7572 7265 6e74 5265 7374  __getCurrentRest
-00024190: 7261 696e 7428 297d 220a 2020 2020 2020  raint()}".      
-000241a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000241b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000241c0: 2020 6622 7b66 756e 6354 7970 657d 2027    f"{funcType} '
-000241d0: 7765 6967 6874 3d7b 7765 6967 6874 7d27  weight={weight}'
-000241e0: 2073 686f 756c 6420 6265 2061 2070 6f73   should be a pos
-000241f0: 6974 6976 6520 7661 6c75 652e 2229 0a0a  itive value.")..
-00024200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024210: 2020 2020 6966 206c 696d 6974 203c 3d20      if limit <= 
-00024220: 302e 303a 0a20 2020 2020 2020 2020 2020  0.0:.           
-00024230: 2020 2020 2020 2020 2020 2020 2076 616c               val
-00024240: 6964 203d 2046 616c 7365 0a20 2020 2020  id = False.     
-00024250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024260: 2020 2073 656c 662e 5f5f 662e 6170 7065     self.__f.appe
-00024270: 6e64 2866 225b 496e 7661 6c69 6420 6461  nd(f"[Invalid da
-00024280: 7461 5d20 7b73 656c 662e 5f5f 6765 7443  ta] {self.__getC
-00024290: 7572 7265 6e74 5265 7374 7261 696e 7428  urrentRestraint(
-000242a0: 297d 220a 2020 2020 2020 2020 2020 2020  )}".            
+00023de0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00023df0: 227b 6675 6e63 5479 7065 7d20 2777 6569  "{funcType} 'wei
+00023e00: 6768 743d 7b77 6569 6768 747d 2720 6d75  ght={weight}' mu
+00023e10: 7374 206e 6f74 2062 6520 6120 6e65 6761  st not be a nega
+00023e20: 7469 7665 2076 616c 7565 2e22 290a 2020  tive value.").  
+00023e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023e40: 2020 656c 6966 2077 6569 6768 7420 3d3d    elif weight ==
+00023e50: 2030 2e30 3a0a 2020 2020 2020 2020 2020   0.0:.          
+00023e60: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00023e70: 6c66 2e5f 5f66 2e61 7070 656e 6428 6622  lf.__f.append(f"
+00023e80: 5b52 616e 6765 2076 616c 7565 2077 6172  [Range value war
+00023e90: 6e69 6e67 5d20 7b73 656c 662e 5f5f 6765  ning] {self.__ge
+00023ea0: 7443 7572 7265 6e74 5265 7374 7261 696e  tCurrentRestrain
+00023eb0: 7428 297d 220a 2020 2020 2020 2020 2020  t()}".          
+00023ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023ed0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+00023ee0: 7b66 756e 6354 7970 657d 2027 7765 6967  {funcType} 'weig
+00023ef0: 6874 3d7b 7765 6967 6874 7d27 2073 686f  ht={weight}' sho
+00023f00: 756c 6420 6265 2061 2070 6f73 6974 6976  uld be a positiv
+00023f10: 6520 7661 6c75 652e 2229 0a0a 2020 2020  e value.")..    
+00023f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023f30: 6966 206c 696d 6974 203c 3d20 302e 303a  if limit <= 0.0:
+00023f40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023f50: 2020 2020 2020 2020 2076 616c 6964 203d           valid =
+00023f60: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
+00023f70: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00023f80: 656c 662e 5f5f 662e 6170 7065 6e64 2866  elf.__f.append(f
+00023f90: 225b 496e 7661 6c69 6420 6461 7461 5d20  "[Invalid data] 
+00023fa0: 7b73 656c 662e 5f5f 6765 7443 7572 7265  {self.__getCurre
+00023fb0: 6e74 5265 7374 7261 696e 7428 297d 220a  ntRestraint()}".
+00023fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023fe0: 2020 2020 2020 2020 6622 7b66 756e 6354          f"{funcT
+00023ff0: 7970 657d 2027 6c69 6d69 743d 7b6c 696d  ype} 'limit={lim
+00024000: 6974 7d27 206d 7573 7420 6265 2061 2070  it}' must be a p
+00024010: 6f73 6974 6976 6520 7661 6c75 652e 2229  ositive value.")
+00024020: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00024030: 2020 2020 2020 6675 6e63 5b27 7461 7267        func['targ
+00024040: 6574 5f76 616c 7565 275d 203d 2078 300a  et_value'] = x0.
+00024050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024060: 2020 2020 6675 6e63 5b27 6c6f 7765 725f      func['lower_
+00024070: 6c69 6d69 7427 5d20 3d20 7830 202d 206c  limit'] = x0 - l
+00024080: 696d 6974 0a20 2020 2020 2020 2020 2020  imit.           
+00024090: 2020 2020 2020 2020 2066 756e 635b 2775           func['u
+000240a0: 7070 6572 5f6c 696d 6974 275d 203d 2078  pper_limit'] = x
+000240b0: 3020 2b20 6c69 6d69 740a 0a20 2020 2020  0 + limit..     
+000240c0: 2020 2020 2020 2020 2020 2066 756e 635b             func[
+000240d0: 276e 616d 6527 5d20 3d20 6675 6e63 5479  'name'] = funcTy
+000240e0: 7065 0a0a 2020 2020 2020 2020 2020 2020  pe..            
+000240f0: 656c 6966 2063 7478 2e43 4952 4355 4c41  elif ctx.CIRCULA
+00024100: 5253 4947 4d4f 4944 414c 2829 206f 7220  RSIGMOIDAL() or 
+00024110: 6374 782e 4c49 4e45 4152 5f50 454e 414c  ctx.LINEAR_PENAL
+00024120: 5459 2829 3a0a 2020 2020 2020 2020 2020  TY():.          
+00024130: 2020 2020 2020 6675 6e63 5479 7065 203d        funcType =
+00024140: 2027 4349 5243 554c 4152 5349 474d 4f49   'CIRCULARSIGMOI
+00024150: 4441 4c27 2069 6620 6374 782e 4349 5243  DAL' if ctx.CIRC
+00024160: 554c 4152 5349 474d 4f49 4441 4c28 2920  ULARSIGMOIDAL() 
+00024170: 656c 7365 2027 4c49 4e45 4152 5f50 454e  else 'LINEAR_PEN
+00024180: 414c 5459 270a 0a20 2020 2020 2020 2020  ALTY'..         
+00024190: 2020 2020 2020 2069 6620 6374 782e 4349         if ctx.CI
+000241a0: 5243 554c 4152 5349 474d 4f49 4441 4c28  RCULARSIGMOIDAL(
+000241b0: 293a 2020 2320 7843 206d 206f 3120 6f32  ):  # xC m o1 o2
+000241c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000241d0: 2020 2020 2078 4320 3d20 7365 6c66 2e6e       xC = self.n
+000241e0: 756d 6265 7246 5365 6c65 6374 696f 6e5b  umberFSelection[
+000241f0: 305d 0a20 2020 2020 2020 2020 2020 2020  0].             
+00024200: 2020 2020 2020 206d 203d 2073 656c 662e         m = self.
+00024210: 6e75 6d62 6572 4653 656c 6563 7469 6f6e  numberFSelection
+00024220: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
+00024230: 2020 2020 2020 2020 6f31 203d 2073 656c          o1 = sel
+00024240: 662e 6e75 6d62 6572 4653 656c 6563 7469  f.numberFSelecti
+00024250: 6f6e 5b32 5d0a 2020 2020 2020 2020 2020  on[2].          
+00024260: 2020 2020 2020 2020 2020 6f32 203d 2073            o2 = s
+00024270: 656c 662e 6e75 6d62 6572 4653 656c 6563  elf.numberFSelec
+00024280: 7469 6f6e 5b33 5d0a 0a20 2020 2020 2020  tion[3]..       
+00024290: 2020 2020 2020 2020 2020 2020 2066 756e               fun
+000242a0: 635b 2778 4327 5d20 3d20 7843 0a20 2020  c['xC'] = xC.   
 000242b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000242c0: 2020 2020 2020 2020 2020 2020 6622 7b66              f"{f
-000242d0: 756e 6354 7970 657d 2027 6c69 6d69 743d  uncType} 'limit=
-000242e0: 7b6c 696d 6974 7d27 206d 7573 7420 6265  {limit}' must be
-000242f0: 2061 2070 6f73 6974 6976 6520 7661 6c75   a positive valu
-00024300: 652e 2229 0a0a 2020 2020 2020 2020 2020  e.")..          
-00024310: 2020 2020 2020 2020 2020 6675 6e63 5b27            func['
-00024320: 7461 7267 6574 5f76 616c 7565 275d 203d  target_value'] =
-00024330: 2078 300a 2020 2020 2020 2020 2020 2020   x0.            
-00024340: 2020 2020 2020 2020 6675 6e63 5b27 6c6f          func['lo
-00024350: 7765 725f 6c69 6d69 7427 5d20 3d20 7830  wer_limit'] = x0
-00024360: 202d 206c 696d 6974 0a20 2020 2020 2020   - limit.       
-00024370: 2020 2020 2020 2020 2020 2020 2066 756e               fun
-00024380: 635b 2775 7070 6572 5f6c 696d 6974 275d  c['upper_limit']
-00024390: 203d 2078 3020 2b20 6c69 6d69 740a 0a20   = x0 + limit.. 
-000243a0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-000243b0: 756e 635b 276e 616d 6527 5d20 3d20 6675  unc['name'] = fu
-000243c0: 6e63 5479 7065 0a0a 2020 2020 2020 2020  ncType..        
-000243d0: 2020 2020 656c 6966 2063 7478 2e43 4952      elif ctx.CIR
-000243e0: 4355 4c41 5253 4947 4d4f 4944 414c 2829  CULARSIGMOIDAL()
-000243f0: 206f 7220 6374 782e 4c49 4e45 4152 5f50   or ctx.LINEAR_P
-00024400: 454e 414c 5459 2829 3a0a 2020 2020 2020  ENALTY():.      
-00024410: 2020 2020 2020 2020 2020 6675 6e63 5479            funcTy
-00024420: 7065 203d 2027 4349 5243 554c 4152 5349  pe = 'CIRCULARSI
-00024430: 474d 4f49 4441 4c27 2069 6620 6374 782e  GMOIDAL' if ctx.
-00024440: 4349 5243 554c 4152 5349 474d 4f49 4441  CIRCULARSIGMOIDA
-00024450: 4c28 2920 656c 7365 2027 4c49 4e45 4152  L() else 'LINEAR
-00024460: 5f50 454e 414c 5459 270a 0a20 2020 2020  _PENALTY'..     
-00024470: 2020 2020 2020 2020 2020 2069 6620 6374             if ct
-00024480: 782e 4349 5243 554c 4152 5349 474d 4f49  x.CIRCULARSIGMOI
-00024490: 4441 4c28 293a 2020 2320 7843 206d 206f  DAL():  # xC m o
-000244a0: 3120 6f32 0a20 2020 2020 2020 2020 2020  1 o2.           
-000244b0: 2020 2020 2020 2020 2078 4320 3d20 7365           xC = se
-000244c0: 6c66 2e6e 756d 6265 7246 5365 6c65 6374  lf.numberFSelect
-000244d0: 696f 6e5b 305d 0a20 2020 2020 2020 2020  ion[0].         
-000244e0: 2020 2020 2020 2020 2020 206d 203d 2073             m = s
-000244f0: 656c 662e 6e75 6d62 6572 4653 656c 6563  elf.numberFSelec
-00024500: 7469 6f6e 5b31 5d0a 2020 2020 2020 2020  tion[1].        
-00024510: 2020 2020 2020 2020 2020 2020 6f31 203d              o1 =
-00024520: 2073 656c 662e 6e75 6d62 6572 4653 656c   self.numberFSel
-00024530: 6563 7469 6f6e 5b32 5d0a 2020 2020 2020  ection[2].      
-00024540: 2020 2020 2020 2020 2020 2020 2020 6f32                o2
-00024550: 203d 2073 656c 662e 6e75 6d62 6572 4653   = self.numberFS
-00024560: 656c 6563 7469 6f6e 5b33 5d0a 0a20 2020  election[3]..   
+000242c0: 2066 756e 635b 276d 275d 203d 206d 0a20   func['m'] = m. 
+000242d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000242e0: 2020 2066 756e 635b 276f 3127 5d20 3d20     func['o1'] = 
+000242f0: 6f31 0a20 2020 2020 2020 2020 2020 2020  o1.             
+00024300: 2020 2020 2020 2066 756e 635b 276f 3227         func['o2'
+00024310: 5d20 3d20 6f32 0a0a 2020 2020 2020 2020  ] = o2..        
+00024320: 2020 2020 2020 2020 2020 2020 6966 206d              if m
+00024330: 203c 2030 2e30 3a0a 2020 2020 2020 2020   < 0.0:.        
+00024340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024350: 7661 6c69 6420 3d20 4661 6c73 650a 2020  valid = False.  
+00024360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024370: 2020 2020 2020 7365 6c66 2e5f 5f66 2e61        self.__f.a
+00024380: 7070 656e 6428 6622 5b49 6e76 616c 6964  ppend(f"[Invalid
+00024390: 2064 6174 615d 207b 7365 6c66 2e5f 5f67   data] {self.__g
+000243a0: 6574 4375 7272 656e 7452 6573 7472 6169  etCurrentRestrai
+000243b0: 6e74 2829 7d22 0a20 2020 2020 2020 2020  nt()}".         
+000243c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000243d0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000243e0: 227b 6675 6e63 5479 7065 7d20 7065 7269  "{funcType} peri
+000243f0: 6f64 6963 6974 7920 276d 3d7b 6d7d 2720  odicity 'm={m}' 
+00024400: 6d75 7374 206e 6f74 2062 6520 6120 6e65  must not be a ne
+00024410: 6761 7469 7665 2076 616c 7565 2e22 290a  gative value.").
+00024420: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024430: 2065 6c73 653a 2020 2320 7830 2064 6570   else:  # x0 dep
+00024440: 7468 2077 6964 7468 2073 6c6f 7065 0a20  th width slope. 
+00024450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024460: 2020 2078 3020 3d20 7365 6c66 2e6e 756d     x0 = self.num
+00024470: 6265 7246 5365 6c65 6374 696f 6e5b 305d  berFSelection[0]
+00024480: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024490: 2020 2020 2064 6570 7468 203d 2073 656c       depth = sel
+000244a0: 662e 6e75 6d62 6572 4653 656c 6563 7469  f.numberFSelecti
+000244b0: 6f6e 5b31 5d0a 2020 2020 2020 2020 2020  on[1].          
+000244c0: 2020 2020 2020 2020 2020 7769 6474 6820            width 
+000244d0: 3d20 7365 6c66 2e6e 756d 6265 7246 5365  = self.numberFSe
+000244e0: 6c65 6374 696f 6e5b 325d 0a20 2020 2020  lection[2].     
+000244f0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00024500: 6c6f 7065 203d 2073 656c 662e 6e75 6d62  lope = self.numb
+00024510: 6572 4653 656c 6563 7469 6f6e 5b33 5d0a  erFSelection[3].
+00024520: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024530: 2020 2020 2066 756e 635b 2778 3027 5d20       func['x0'] 
+00024540: 3d20 7830 0a20 2020 2020 2020 2020 2020  = x0.           
+00024550: 2020 2020 2020 2020 2066 756e 635b 2764           func['d
+00024560: 6570 7468 275d 203d 2064 6570 7468 0a20  epth'] = depth. 
 00024570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024580: 2066 756e 635b 2778 4327 5d20 3d20 7843   func['xC'] = xC
-00024590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000245a0: 2020 2020 2066 756e 635b 276d 275d 203d       func['m'] =
-000245b0: 206d 0a20 2020 2020 2020 2020 2020 2020   m.             
-000245c0: 2020 2020 2020 2066 756e 635b 276f 3127         func['o1'
-000245d0: 5d20 3d20 6f31 0a20 2020 2020 2020 2020  ] = o1.         
-000245e0: 2020 2020 2020 2020 2020 2066 756e 635b             func[
-000245f0: 276f 3227 5d20 3d20 6f32 0a0a 2020 2020  'o2'] = o2..    
-00024600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024610: 6966 206d 203c 2030 2e30 3a0a 2020 2020  if m < 0.0:.    
-00024620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024630: 2020 2020 7661 6c69 6420 3d20 4661 6c73      valid = Fals
-00024640: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00024650: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00024660: 5f66 2e61 7070 656e 6428 6622 5b49 6e76  _f.append(f"[Inv
-00024670: 616c 6964 2064 6174 615d 207b 7365 6c66  alid data] {self
-00024680: 2e5f 5f67 6574 4375 7272 656e 7452 6573  .__getCurrentRes
-00024690: 7472 6169 6e74 2829 7d22 0a20 2020 2020  traint()}".     
-000246a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000246b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000246c0: 2020 2066 227b 6675 6e63 5479 7065 7d20     f"{funcType} 
-000246d0: 7065 7269 6f64 6963 6974 7920 276d 3d7b  periodicity 'm={
-000246e0: 6d7d 2720 6d75 7374 206e 6f74 2062 6520  m}' must not be 
-000246f0: 6120 6e65 6761 7469 7665 2076 616c 7565  a negative value
-00024700: 2e22 290a 0a20 2020 2020 2020 2020 2020  .")..           
-00024710: 2020 2020 2065 6c73 653a 2020 2320 7830       else:  # x0
-00024720: 2064 6570 7468 2077 6964 7468 2073 6c6f   depth width slo
-00024730: 7065 0a20 2020 2020 2020 2020 2020 2020  pe.             
-00024740: 2020 2020 2020 2078 3020 3d20 7365 6c66         x0 = self
-00024750: 2e6e 756d 6265 7246 5365 6c65 6374 696f  .numberFSelectio
-00024760: 6e5b 305d 0a20 2020 2020 2020 2020 2020  n[0].           
-00024770: 2020 2020 2020 2020 2064 6570 7468 203d           depth =
-00024780: 2073 656c 662e 6e75 6d62 6572 4653 656c   self.numberFSel
-00024790: 6563 7469 6f6e 5b31 5d0a 2020 2020 2020  ection[1].      
-000247a0: 2020 2020 2020 2020 2020 2020 2020 7769                wi
-000247b0: 6474 6820 3d20 7365 6c66 2e6e 756d 6265  dth = self.numbe
-000247c0: 7246 5365 6c65 6374 696f 6e5b 325d 0a20  rFSelection[2]. 
-000247d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000247e0: 2020 2073 6c6f 7065 203d 2073 656c 662e     slope = self.
-000247f0: 6e75 6d62 6572 4653 656c 6563 7469 6f6e  numberFSelection
-00024800: 5b33 5d0a 0a20 2020 2020 2020 2020 2020  [3]..           
-00024810: 2020 2020 2020 2020 2066 756e 635b 2778           func['x
-00024820: 3027 5d20 3d20 7830 0a20 2020 2020 2020  0'] = x0.       
-00024830: 2020 2020 2020 2020 2020 2020 2066 756e               fun
-00024840: 635b 2764 6570 7468 275d 203d 2064 6570  c['depth'] = dep
-00024850: 7468 0a20 2020 2020 2020 2020 2020 2020  th.             
-00024860: 2020 2020 2020 2066 756e 635b 2777 6964         func['wid
-00024870: 7468 275d 203d 2077 6964 7468 0a20 2020  th'] = width.   
-00024880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024890: 2066 756e 635b 2773 6c6f 7065 275d 203d   func['slope'] =
-000248a0: 2073 6c6f 7065 0a0a 2020 2020 2020 2020   slope..        
-000248b0: 2020 2020 2020 2020 2020 2020 6966 2077              if w
-000248c0: 6964 7468 203c 2030 2e30 3a0a 2020 2020  idth < 0.0:.    
-000248d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000248e0: 2020 2020 7661 6c69 6420 3d20 4661 6c73      valid = Fals
-000248f0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00024900: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00024910: 5f66 2e61 7070 656e 6428 6622 5b49 6e76  _f.append(f"[Inv
-00024920: 616c 6964 2064 6174 615d 207b 7365 6c66  alid data] {self
-00024930: 2e5f 5f67 6574 4375 7272 656e 7452 6573  .__getCurrentRes
-00024940: 7472 6169 6e74 2829 7d22 0a20 2020 2020  traint()}".     
-00024950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024970: 2020 2066 227b 6675 6e63 5479 7065 7d20     f"{funcType} 
-00024980: 2777 6964 7468 3d7b 7769 6474 687d 2720  'width={width}' 
-00024990: 6d75 7374 206e 6f74 2062 6520 6120 6e65  must not be a ne
-000249a0: 6761 7469 7665 2076 616c 7565 2e22 290a  gative value.").
+00024580: 2020 2066 756e 635b 2777 6964 7468 275d     func['width']
+00024590: 203d 2077 6964 7468 0a20 2020 2020 2020   = width.       
+000245a0: 2020 2020 2020 2020 2020 2020 2066 756e               fun
+000245b0: 635b 2773 6c6f 7065 275d 203d 2073 6c6f  c['slope'] = slo
+000245c0: 7065 0a0a 2020 2020 2020 2020 2020 2020  pe..            
+000245d0: 2020 2020 2020 2020 6966 2077 6964 7468          if width
+000245e0: 203c 2030 2e30 3a0a 2020 2020 2020 2020   < 0.0:.        
+000245f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024600: 7661 6c69 6420 3d20 4661 6c73 650a 2020  valid = False.  
+00024610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024620: 2020 2020 2020 7365 6c66 2e5f 5f66 2e61        self.__f.a
+00024630: 7070 656e 6428 6622 5b49 6e76 616c 6964  ppend(f"[Invalid
+00024640: 2064 6174 615d 207b 7365 6c66 2e5f 5f67   data] {self.__g
+00024650: 6574 4375 7272 656e 7452 6573 7472 6169  etCurrentRestrai
+00024660: 6e74 2829 7d22 0a20 2020 2020 2020 2020  nt()}".         
+00024670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024680: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00024690: 227b 6675 6e63 5479 7065 7d20 2777 6964  "{funcType} 'wid
+000246a0: 7468 3d7b 7769 6474 687d 2720 6d75 7374  th={width}' must
+000246b0: 206e 6f74 2062 6520 6120 6e65 6761 7469   not be a negati
+000246c0: 7665 2076 616c 7565 2e22 290a 2020 2020  ve value.").    
+000246d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000246e0: 6966 2073 6c6f 7065 203c 2030 2e30 3a0a  if slope < 0.0:.
+000246f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024700: 2020 2020 2020 2020 7661 6c69 6420 3d20          valid = 
+00024710: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
+00024720: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00024730: 6c66 2e5f 5f66 2e61 7070 656e 6428 6622  lf.__f.append(f"
+00024740: 5b49 6e76 616c 6964 2064 6174 615d 207b  [Invalid data] {
+00024750: 7365 6c66 2e5f 5f67 6574 4375 7272 656e  self.__getCurren
+00024760: 7452 6573 7472 6169 6e74 2829 7d22 0a20  tRestraint()}". 
+00024770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024790: 2020 2020 2020 2066 227b 6675 6e63 5479         f"{funcTy
+000247a0: 7065 7d20 2773 6c6f 7065 3d7b 736c 6f70  pe} 'slope={slop
+000247b0: 657d 2720 6d75 7374 206e 6f74 2062 6520  e}' must not be 
+000247c0: 6120 6e65 6761 7469 7665 2076 616c 7565  a negative value
+000247d0: 2e22 290a 0a20 2020 2020 2020 2020 2020  .")..           
+000247e0: 2020 2020 2020 2020 2066 756e 635b 276c           func['l
+000247f0: 6f77 6572 5f6c 696e 6561 725f 6c69 6d69  ower_linear_limi
+00024800: 7427 5d20 3d20 7830 202d 2077 6964 7468  t'] = x0 - width
+00024810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024820: 2020 2020 2066 756e 635b 2775 7070 6572       func['upper
+00024830: 5f6c 696e 6561 725f 6c69 6d69 7427 5d20  _linear_limit'] 
+00024840: 3d20 7830 202b 2077 6964 7468 0a0a 2020  = x0 + width..  
+00024850: 2020 2020 2020 2020 2020 2020 2020 6675                fu
+00024860: 6e63 5b27 6e61 6d65 275d 203d 2066 756e  nc['name'] = fun
+00024870: 6354 7970 650a 0a20 2020 2020 2020 2020  cType..         
+00024880: 2020 2065 6c69 6620 6374 782e 4349 5243     elif ctx.CIRC
+00024890: 554c 4152 5350 4c49 4e45 2829 3a20 2023  ULARSPLINE():  #
+000248a0: 2077 6569 6768 7420 5b33 3620 656e 6572   weight [36 ener
+000248b0: 6779 2076 616c 7565 735d 0a20 2020 2020  gy values].     
+000248c0: 2020 2020 2020 2020 2020 2066 756e 6354             funcT
+000248d0: 7970 6520 3d20 2743 4952 4355 4c41 5253  ype = 'CIRCULARS
+000248e0: 504c 494e 4527 0a20 2020 2020 2020 2020  PLINE'.         
+000248f0: 2020 2020 2020 2077 6569 6768 7420 3d20         weight = 
+00024900: 7365 6c66 2e6e 756d 6265 7246 5365 6c65  self.numberFSele
+00024910: 6374 696f 6e5b 305d 0a0a 2020 2020 2020  ction[0]..      
+00024920: 2020 2020 2020 2020 2020 6675 6e63 5b27            func['
+00024930: 6e61 6d65 275d 203d 2066 756e 6354 7970  name'] = funcTyp
+00024940: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00024950: 2020 6675 6e63 5b27 7765 6967 6874 275d    func['weight']
+00024960: 203d 2077 6569 6768 740a 0a20 2020 2020   = weight..     
+00024970: 2020 2020 2020 2020 2020 2069 6620 7765             if we
+00024980: 6967 6874 203c 2030 2e30 3a0a 2020 2020  ight < 0.0:.    
+00024990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000249a0: 7661 6c69 6420 3d20 4661 6c73 650a 2020  valid = False.  
 000249b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000249c0: 2020 2020 6966 2073 6c6f 7065 203c 2030      if slope < 0
-000249d0: 2e30 3a0a 2020 2020 2020 2020 2020 2020  .0:.            
-000249e0: 2020 2020 2020 2020 2020 2020 7661 6c69              vali
-000249f0: 6420 3d20 4661 6c73 650a 2020 2020 2020  d = False.      
-00024a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024a10: 2020 7365 6c66 2e5f 5f66 2e61 7070 656e    self.__f.appen
-00024a20: 6428 6622 5b49 6e76 616c 6964 2064 6174  d(f"[Invalid dat
-00024a30: 615d 207b 7365 6c66 2e5f 5f67 6574 4375  a] {self.__getCu
-00024a40: 7272 656e 7452 6573 7472 6169 6e74 2829  rrentRestraint()
-00024a50: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
-00024a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024a70: 2020 2020 2020 2020 2020 2066 227b 6675             f"{fu
-00024a80: 6e63 5479 7065 7d20 2773 6c6f 7065 3d7b  ncType} 'slope={
-00024a90: 736c 6f70 657d 2720 6d75 7374 206e 6f74  slope}' must not
-00024aa0: 2062 6520 6120 6e65 6761 7469 7665 2076   be a negative v
-00024ab0: 616c 7565 2e22 290a 0a20 2020 2020 2020  alue.")..       
-00024ac0: 2020 2020 2020 2020 2020 2020 2066 756e               fun
-00024ad0: 635b 276c 6f77 6572 5f6c 696e 6561 725f  c['lower_linear_
-00024ae0: 6c69 6d69 7427 5d20 3d20 7830 202d 2077  limit'] = x0 - w
-00024af0: 6964 7468 0a20 2020 2020 2020 2020 2020  idth.           
-00024b00: 2020 2020 2020 2020 2066 756e 635b 2775           func['u
-00024b10: 7070 6572 5f6c 696e 6561 725f 6c69 6d69  pper_linear_limi
-00024b20: 7427 5d20 3d20 7830 202b 2077 6964 7468  t'] = x0 + width
-00024b30: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00024b40: 2020 6675 6e63 5b27 6e61 6d65 275d 203d    func['name'] =
-00024b50: 2066 756e 6354 7970 650a 0a20 2020 2020   funcType..     
-00024b60: 2020 2020 2020 2065 6c69 6620 6374 782e         elif ctx.
-00024b70: 4349 5243 554c 4152 5350 4c49 4e45 2829  CIRCULARSPLINE()
-00024b80: 3a20 2023 2077 6569 6768 7420 5b33 3620  :  # weight [36 
-00024b90: 656e 6572 6779 2076 616c 7565 735d 0a20  energy values]. 
-00024ba0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00024bb0: 756e 6354 7970 6520 3d20 2743 4952 4355  uncType = 'CIRCU
-00024bc0: 4c41 5253 504c 494e 4527 0a20 2020 2020  LARSPLINE'.     
-00024bd0: 2020 2020 2020 2020 2020 2077 6569 6768             weigh
-00024be0: 7420 3d20 7365 6c66 2e6e 756d 6265 7246  t = self.numberF
-00024bf0: 5365 6c65 6374 696f 6e5b 305d 0a0a 2020  Selection[0]..  
-00024c00: 2020 2020 2020 2020 2020 2020 2020 6675                fu
-00024c10: 6e63 5b27 6e61 6d65 275d 203d 2066 756e  nc['name'] = fun
-00024c20: 6354 7970 650a 2020 2020 2020 2020 2020  cType.          
-00024c30: 2020 2020 2020 6675 6e63 5b27 7765 6967        func['weig
-00024c40: 6874 275d 203d 2077 6569 6768 740a 0a20  ht'] = weight.. 
-00024c50: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00024c60: 6620 7765 6967 6874 203c 2030 2e30 3a0a  f weight < 0.0:.
-00024c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024c80: 2020 2020 7661 6c69 6420 3d20 4661 6c73      valid = Fals
-00024c90: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00024ca0: 2020 2020 2020 7365 6c66 2e5f 5f66 2e61        self.__f.a
-00024cb0: 7070 656e 6428 6622 5b49 6e76 616c 6964  ppend(f"[Invalid
-00024cc0: 2064 6174 615d 207b 7365 6c66 2e5f 5f67   data] {self.__g
-00024cd0: 6574 4375 7272 656e 7452 6573 7472 6169  etCurrentRestrai
-00024ce0: 6e74 2829 7d22 0a20 2020 2020 2020 2020  nt()}".         
-00024cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024d00: 2020 2020 2020 2020 2020 2066 227b 6675             f"{fu
-00024d10: 6e63 5479 7065 7d20 2777 6569 6768 743d  ncType} 'weight=
-00024d20: 7b77 6569 6768 747d 2720 6d75 7374 206e  {weight}' must n
-00024d30: 6f74 2062 6520 6120 6e65 6761 7469 7665  ot be a negative
-00024d40: 2076 616c 7565 2e22 290a 2020 2020 2020   value.").      
-00024d50: 2020 2020 2020 2020 2020 656c 6966 2077            elif w
-00024d60: 6569 6768 7420 3d3d 2030 2e30 3a0a 2020  eight == 0.0:.  
-00024d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024d80: 2020 7365 6c66 2e5f 5f66 2e61 7070 656e    self.__f.appen
-00024d90: 6428 6622 5b52 616e 6765 2076 616c 7565  d(f"[Range value
-00024da0: 2077 6172 6e69 6e67 5d20 7b73 656c 662e   warning] {self.
-00024db0: 5f5f 6765 7443 7572 7265 6e74 5265 7374  __getCurrentRest
-00024dc0: 7261 696e 7428 297d 220a 2020 2020 2020  raint()}".      
-00024dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024de0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-00024df0: 7b66 756e 6354 7970 657d 2027 7765 6967  {funcType} 'weig
-00024e00: 6874 3d7b 7765 6967 6874 7d27 2073 686f  ht={weight}' sho
-00024e10: 756c 6420 6265 2061 2070 6f73 6974 6976  uld be a positiv
-00024e20: 6520 7661 6c75 652e 2229 0a0a 2020 2020  e value.")..    
-00024e30: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-00024e40: 656e 2873 656c 662e 6e75 6d62 6572 4653  en(self.numberFS
-00024e50: 656c 6563 7469 6f6e 2920 3e20 3336 3a0a  election) > 36:.
-00024e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024e70: 2020 2020 6675 6e63 5b27 656e 6572 6779      func['energy
-00024e80: 275d 203d 205b 5d0a 2020 2020 2020 2020  '] = [].        
-00024e90: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00024ea0: 6920 696e 2072 616e 6765 2833 3629 3a0a  i in range(36):.
+000249c0: 2020 7365 6c66 2e5f 5f66 2e61 7070 656e    self.__f.appen
+000249d0: 6428 6622 5b49 6e76 616c 6964 2064 6174  d(f"[Invalid dat
+000249e0: 615d 207b 7365 6c66 2e5f 5f67 6574 4375  a] {self.__getCu
+000249f0: 7272 656e 7452 6573 7472 6169 6e74 2829  rrentRestraint()
+00024a00: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
+00024a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024a20: 2020 2020 2020 2066 227b 6675 6e63 5479         f"{funcTy
+00024a30: 7065 7d20 2777 6569 6768 743d 7b77 6569  pe} 'weight={wei
+00024a40: 6768 747d 2720 6d75 7374 206e 6f74 2062  ght}' must not b
+00024a50: 6520 6120 6e65 6761 7469 7665 2076 616c  e a negative val
+00024a60: 7565 2e22 290a 2020 2020 2020 2020 2020  ue.").          
+00024a70: 2020 2020 2020 656c 6966 2077 6569 6768        elif weigh
+00024a80: 7420 3d3d 2030 2e30 3a0a 2020 2020 2020  t == 0.0:.      
+00024a90: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00024aa0: 6c66 2e5f 5f66 2e61 7070 656e 6428 6622  lf.__f.append(f"
+00024ab0: 5b52 616e 6765 2076 616c 7565 2077 6172  [Range value war
+00024ac0: 6e69 6e67 5d20 7b73 656c 662e 5f5f 6765  ning] {self.__ge
+00024ad0: 7443 7572 7265 6e74 5265 7374 7261 696e  tCurrentRestrain
+00024ae0: 7428 297d 220a 2020 2020 2020 2020 2020  t()}".          
+00024af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024b00: 2020 2020 2020 2020 2020 6622 7b66 756e            f"{fun
+00024b10: 6354 7970 657d 2027 7765 6967 6874 3d7b  cType} 'weight={
+00024b20: 7765 6967 6874 7d27 2073 686f 756c 6420  weight}' should 
+00024b30: 6265 2061 2070 6f73 6974 6976 6520 7661  be a positive va
+00024b40: 6c75 652e 2229 0a0a 2020 2020 2020 2020  lue.")..        
+00024b50: 2020 2020 2020 2020 6966 206c 656e 2873          if len(s
+00024b60: 656c 662e 6e75 6d62 6572 4653 656c 6563  elf.numberFSelec
+00024b70: 7469 6f6e 2920 3e20 3336 3a0a 2020 2020  tion) > 36:.    
+00024b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024b90: 6675 6e63 5b27 656e 6572 6779 275d 203d  func['energy'] =
+00024ba0: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
+00024bb0: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+00024bc0: 2072 616e 6765 2833 3629 3a0a 2020 2020   range(36):.    
+00024bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024be0: 2020 2020 6675 6e63 5b27 656e 6572 6779      func['energy
+00024bf0: 275d 2e61 7070 656e 6428 7365 6c66 2e6e  '].append(self.n
+00024c00: 756d 6265 7246 5365 6c65 6374 696f 6e5b  umberFSelection[
+00024c10: 6920 2b20 315d 290a 2020 2020 2020 2020  i + 1]).        
+00024c20: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00024c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024c40: 2020 7661 6c69 6420 3d20 4661 6c73 650a    valid = False.
+00024c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024c60: 2020 2020 7365 6c66 2e5f 5f66 2e61 7070      self.__f.app
+00024c70: 656e 6428 6622 5b49 6e76 616c 6964 2064  end(f"[Invalid d
+00024c80: 6174 615d 207b 7365 6c66 2e5f 5f67 6574  ata] {self.__get
+00024c90: 4375 7272 656e 7452 6573 7472 6169 6e74  CurrentRestraint
+00024ca0: 2829 7d22 0a20 2020 2020 2020 2020 2020  ()}".           
+00024cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024cc0: 2020 2020 2020 2020 2066 227b 6675 6e63           f"{func
+00024cd0: 5479 7065 7d20 7265 7175 6972 6573 2063  Type} requires c
+00024ce0: 6f6e 7365 6375 7469 7665 2033 3620 656e  onsecutive 36 en
+00024cf0: 6572 6779 2076 616c 7565 732c 2066 6f6c  ergy values, fol
+00024d00: 6c6f 7769 6e67 2074 6865 2066 6972 7374  lowing the first
+00024d10: 2077 6569 6768 7420 7661 6c75 652e 2229   weight value.")
+00024d20: 0a0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+00024d30: 6966 2063 7478 2e47 4155 5353 4941 4e46  if ctx.GAUSSIANF
+00024d40: 554e 4328 293a 2020 2320 6d65 616e 2073  UNC():  # mean s
+00024d50: 6420 7461 6720 5745 4947 4854 2077 6569  d tag WEIGHT wei
+00024d60: 6768 740a 2020 2020 2020 2020 2020 2020  ght.            
+00024d70: 2020 2020 6675 6e63 5479 7065 203d 2027      funcType = '
+00024d80: 4741 5553 5349 414e 4655 4e43 270a 2020  GAUSSIANFUNC'.  
+00024d90: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+00024da0: 616e 203d 2073 656c 662e 6e75 6d62 6572  an = self.number
+00024db0: 4653 656c 6563 7469 6f6e 5b30 5d0a 2020  FSelection[0].  
+00024dc0: 2020 2020 2020 2020 2020 2020 2020 7364                sd
+00024dd0: 203d 2073 656c 662e 6e75 6d62 6572 4653   = self.numberFS
+00024de0: 656c 6563 7469 6f6e 5b31 5d0a 0a20 2020  election[1]..   
+00024df0: 2020 2020 2020 2020 2020 2020 2066 756e               fun
+00024e00: 635b 276e 616d 6527 5d20 3d20 6675 6e63  c['name'] = func
+00024e10: 5479 7065 0a20 2020 2020 2020 2020 2020  Type.           
+00024e20: 2020 2020 2066 756e 635b 276d 6561 6e27       func['mean'
+00024e30: 5d20 3d20 6d65 616e 0a20 2020 2020 2020  ] = mean.       
+00024e40: 2020 2020 2020 2020 2066 756e 635b 2773           func['s
+00024e50: 6427 5d20 3d20 7364 0a20 2020 2020 2020  d'] = sd.       
+00024e60: 2020 2020 2020 2020 2066 756e 635b 2774           func['t
+00024e70: 6167 275d 203d 2073 7472 2863 7478 2e53  ag'] = str(ctx.S
+00024e80: 696d 706c 655f 6e61 6d65 2830 2929 0a0a  imple_name(0))..
+00024e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024ea0: 6966 2073 6420 3c3d 2030 2e30 3a0a 2020  if sd <= 0.0:.  
 00024eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024ec0: 2020 2020 2020 2020 6675 6e63 5b27 656e          func['en
-00024ed0: 6572 6779 275d 2e61 7070 656e 6428 7365  ergy'].append(se
-00024ee0: 6c66 2e6e 756d 6265 7246 5365 6c65 6374  lf.numberFSelect
-00024ef0: 696f 6e5b 6920 2b20 315d 290a 2020 2020  ion[i + 1]).    
-00024f00: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00024f10: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00024f20: 2020 2020 2020 7661 6c69 6420 3d20 4661        valid = Fa
-00024f30: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
-00024f40: 2020 2020 2020 2020 7365 6c66 2e5f 5f66          self.__f
-00024f50: 2e61 7070 656e 6428 6622 5b49 6e76 616c  .append(f"[Inval
-00024f60: 6964 2064 6174 615d 207b 7365 6c66 2e5f  id data] {self._
-00024f70: 5f67 6574 4375 7272 656e 7452 6573 7472  _getCurrentRestr
-00024f80: 6169 6e74 2829 7d22 0a20 2020 2020 2020  aint()}".       
+00024ec0: 2020 7661 6c69 6420 3d20 4661 6c73 650a    valid = False.
+00024ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024ee0: 2020 2020 7365 6c66 2e5f 5f66 2e61 7070      self.__f.app
+00024ef0: 656e 6428 6622 5b49 6e76 616c 6964 2064  end(f"[Invalid d
+00024f00: 6174 615d 207b 7365 6c66 2e5f 5f67 6574  ata] {self.__get
+00024f10: 4375 7272 656e 7452 6573 7472 6169 6e74  CurrentRestraint
+00024f20: 2829 7d22 0a20 2020 2020 2020 2020 2020  ()}".           
+00024f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024f40: 2020 2020 2020 2020 2066 227b 6675 6e63           f"{func
+00024f50: 5479 7065 7d20 7374 616e 6461 7264 2064  Type} standard d
+00024f60: 6576 6961 7469 6f6e 2027 7364 3d7b 7364  eviation 'sd={sd
+00024f70: 7d27 206d 7573 7420 6265 2061 2070 6f73  }' must be a pos
+00024f80: 6974 6976 6520 7661 6c75 652e 2229 0a0a  itive value.")..
 00024f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024fa0: 2020 2020 2020 2020 2020 2020 2066 227b               f"{
-00024fb0: 6675 6e63 5479 7065 7d20 7265 7175 6972  funcType} requir
-00024fc0: 6573 2063 6f6e 7365 6375 7469 7665 2033  es consecutive 3
-00024fd0: 3620 656e 6572 6779 2076 616c 7565 732c  6 energy values,
-00024fe0: 2066 6f6c 6c6f 7769 6e67 2074 6865 2066   following the f
-00024ff0: 6972 7374 2077 6569 6768 7420 7661 6c75  irst weight valu
-00025000: 652e 2229 0a0a 2020 2020 2020 2020 2020  e.")..          
-00025010: 2020 656c 6966 2063 7478 2e47 4155 5353    elif ctx.GAUSS
-00025020: 4941 4e46 554e 4328 293a 2020 2320 6d65  IANFUNC():  # me
-00025030: 616e 2073 6420 7461 6720 5745 4947 4854  an sd tag WEIGHT
-00025040: 2077 6569 6768 740a 2020 2020 2020 2020   weight.        
-00025050: 2020 2020 2020 2020 6675 6e63 5479 7065          funcType
-00025060: 203d 2027 4741 5553 5349 414e 4655 4e43   = 'GAUSSIANFUNC
-00025070: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
-00025080: 2020 6d65 616e 203d 2073 656c 662e 6e75    mean = self.nu
-00025090: 6d62 6572 4653 656c 6563 7469 6f6e 5b30  mberFSelection[0
-000250a0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-000250b0: 2020 7364 203d 2073 656c 662e 6e75 6d62    sd = self.numb
-000250c0: 6572 4653 656c 6563 7469 6f6e 5b31 5d0a  erFSelection[1].
-000250d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000250e0: 2066 756e 635b 276e 616d 6527 5d20 3d20   func['name'] = 
-000250f0: 6675 6e63 5479 7065 0a20 2020 2020 2020  funcType.       
-00025100: 2020 2020 2020 2020 2066 756e 635b 276d           func['m
-00025110: 6561 6e27 5d20 3d20 6d65 616e 0a20 2020  ean'] = mean.   
-00025120: 2020 2020 2020 2020 2020 2020 2066 756e               fun
-00025130: 635b 2773 6427 5d20 3d20 7364 0a20 2020  c['sd'] = sd.   
-00025140: 2020 2020 2020 2020 2020 2020 2066 756e               fun
-00025150: 635b 2774 6167 275d 203d 2073 7472 2863  c['tag'] = str(c
-00025160: 7478 2e53 696d 706c 655f 6e61 6d65 2830  tx.Simple_name(0
-00025170: 2929 0a0a 2020 2020 2020 2020 2020 2020  ))..            
-00025180: 2020 2020 6966 2073 6420 3c3d 2030 2e30      if sd <= 0.0
-00025190: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000251a0: 2020 2020 2020 7661 6c69 6420 3d20 4661        valid = Fa
-000251b0: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
-000251c0: 2020 2020 2020 2020 7365 6c66 2e5f 5f66          self.__f
-000251d0: 2e61 7070 656e 6428 6622 5b49 6e76 616c  .append(f"[Inval
-000251e0: 6964 2064 6174 615d 207b 7365 6c66 2e5f  id data] {self._
-000251f0: 5f67 6574 4375 7272 656e 7452 6573 7472  _getCurrentRestr
-00025200: 6169 6e74 2829 7d22 0a20 2020 2020 2020  aint()}".       
-00025210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025220: 2020 2020 2020 2020 2020 2020 2066 227b               f"{
-00025230: 6675 6e63 5479 7065 7d20 7374 616e 6461  funcType} standa
-00025240: 7264 2064 6576 6961 7469 6f6e 2027 7364  rd deviation 'sd
-00025250: 3d7b 7364 7d27 206d 7573 7420 6265 2061  ={sd}' must be a
-00025260: 2070 6f73 6974 6976 6520 7661 6c75 652e   positive value.
-00025270: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
-00025280: 2020 2020 6966 2063 7478 2e57 4549 4748      if ctx.WEIGH
-00025290: 5428 293a 0a20 2020 2020 2020 2020 2020  T():.           
-000252a0: 2020 2020 2020 2020 2077 6569 6768 7420           weight 
-000252b0: 3d20 7365 6c66 2e6e 756d 6265 7246 5365  = self.numberFSe
-000252c0: 6c65 6374 696f 6e5b 325d 0a0a 2020 2020  lection[2]..    
-000252d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000252e0: 6675 6e63 5b27 7765 6967 6874 275d 203d  func['weight'] =
-000252f0: 2077 6569 6768 740a 0a20 2020 2020 2020   weight..       
-00025300: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00025310: 7765 6967 6874 203c 2030 2e30 3a0a 2020  weight < 0.0:.  
-00025320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025330: 2020 2020 2020 7661 6c69 6420 3d20 4661        valid = Fa
-00025340: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
-00025350: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00025360: 2e5f 5f66 2e61 7070 656e 6428 6622 5b49  .__f.append(f"[I
-00025370: 6e76 616c 6964 2064 6174 615d 207b 7365  nvalid data] {se
-00025380: 6c66 2e5f 5f67 6574 4375 7272 656e 7452  lf.__getCurrentR
-00025390: 6573 7472 6169 6e74 2829 7d22 0a20 2020  estraint()}".   
-000253a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000253b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000253c0: 2020 2020 2066 227b 6675 6e63 5479 7065       f"{funcType
-000253d0: 7d20 2777 6569 6768 743d 7b77 6569 6768  } 'weight={weigh
-000253e0: 747d 2720 6d75 7374 206e 6f74 2062 6520  t}' must not be 
-000253f0: 6120 6e65 6761 7469 7665 2076 616c 7565  a negative value
-00025400: 2e22 290a 2020 2020 2020 2020 2020 2020  .").            
-00025410: 2020 2020 2020 2020 656c 6966 2077 6569          elif wei
-00025420: 6768 7420 3d3d 2030 2e30 3a0a 2020 2020  ght == 0.0:.    
-00025430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025440: 2020 2020 7365 6c66 2e5f 5f66 2e61 7070      self.__f.app
-00025450: 656e 6428 6622 5b52 616e 6765 2076 616c  end(f"[Range val
-00025460: 7565 2077 6172 6e69 6e67 5d20 7b73 656c  ue warning] {sel
-00025470: 662e 5f5f 6765 7443 7572 7265 6e74 5265  f.__getCurrentRe
-00025480: 7374 7261 696e 7428 297d 220a 2020 2020  straint()}".    
-00025490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000254a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000254b0: 2020 2020 6622 7b66 756e 6354 7970 657d      f"{funcType}
-000254c0: 2027 7765 6967 6874 3d7b 7765 6967 6874   'weight={weight
-000254d0: 7d27 2073 686f 756c 6420 6265 2061 2070  }' should be a p
-000254e0: 6f73 6974 6976 6520 7661 6c75 652e 2229  ositive value.")
-000254f0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00025500: 2020 6675 6e63 5b27 7461 7267 6574 5f76    func['target_v
-00025510: 616c 7565 275d 203d 206d 6561 6e0a 2020  alue'] = mean.  
-00025520: 2020 2020 2020 2020 2020 2020 2020 6675                fu
-00025530: 6e63 5b27 6c6f 7765 725f 6c69 6d69 7427  nc['lower_limit'
-00025540: 5d20 3d20 6d65 616e 202d 2073 640a 2020  ] = mean - sd.  
-00025550: 2020 2020 2020 2020 2020 2020 2020 6675                fu
-00025560: 6e63 5b27 7570 7065 725f 6c69 6d69 7427  nc['upper_limit'
-00025570: 5d20 3d20 6d65 616e 202b 2073 640a 0a20  ] = mean + sd.. 
-00025580: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00025590: 6374 782e 534f 4746 554e 4328 293a 2020  ctx.SOGFUNC():  
-000255a0: 2320 6e5f 6675 6e63 7320 5b6d 6561 6e31  # n_funcs [mean1
-000255b0: 2073 6465 7631 2077 6569 6768 7431 205b   sdev1 weight1 [
-000255c0: 6d65 616e 3220 7364 6576 3220 7765 6967  mean2 sdev2 weig
-000255d0: 6874 3220 5b2e 2e2e 5d5d 5d0a 2020 2020  ht2 [...]]].    
-000255e0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
-000255f0: 5479 7065 203d 2027 534f 4746 554e 4327  Type = 'SOGFUNC'
-00025600: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00025610: 206e 5f66 756e 6373 203d 2069 6e74 2873   n_funcs = int(s
-00025620: 7472 2863 7478 2e49 6e74 6567 6572 2829  tr(ctx.Integer()
-00025630: 2929 0a0a 2020 2020 2020 2020 2020 2020  ))..            
-00025640: 2020 2020 6675 6e63 5b27 6e61 6d65 275d      func['name']
-00025650: 203d 2066 756e 6354 7970 650a 2020 2020   = funcType.    
-00025660: 2020 2020 2020 2020 2020 2020 6675 6e63              func
-00025670: 5b27 6e5f 6675 6e63 7327 5d20 3d20 6e5f  ['n_funcs'] = n_
-00025680: 6675 6e63 730a 0a20 2020 2020 2020 2020  funcs..         
-00025690: 2020 2020 2020 2069 6620 6e5f 6675 6e63         if n_func
-000256a0: 7320 3c3d 2030 3a0a 2020 2020 2020 2020  s <= 0:.        
-000256b0: 2020 2020 2020 2020 2020 2020 7661 6c69              vali
-000256c0: 6420 3d20 4661 6c73 650a 2020 2020 2020  d = False.      
-000256d0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000256e0: 6c66 2e5f 5f66 2e61 7070 656e 6428 6622  lf.__f.append(f"
-000256f0: 5b49 6e76 616c 6964 2064 6174 615d 207b  [Invalid data] {
-00025700: 7365 6c66 2e5f 5f67 6574 4375 7272 656e  self.__getCurren
-00025710: 7452 6573 7472 6169 6e74 2829 7d22 0a20  tRestraint()}". 
-00025720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025740: 2020 2066 227b 6675 6e63 5479 7065 7d20     f"{funcType} 
-00025750: 7468 6520 6e75 6d62 6572 206f 6620 4761  the number of Ga
-00025760: 7573 7369 616e 2066 756e 6374 696f 6e73  ussian functions
-00025770: 2027 6e5f 6675 6e63 733d 7b6e 5f66 756e   'n_funcs={n_fun
-00025780: 6373 7d27 206d 7573 7420 6265 2061 2070  cs}' must be a p
-00025790: 6f73 6974 6976 6520 7661 6c75 652e 2229  ositive value.")
-000257a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000257b0: 2065 6c69 6620 6c65 6e28 7365 6c66 2e6e   elif len(self.n
-000257c0: 756d 6265 7246 5365 6c65 6374 696f 6e29  umberFSelection)
-000257d0: 203e 206e 5f66 756e 6373 202a 2033 202d   > n_funcs * 3 -
-000257e0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-000257f0: 2020 2020 2020 2020 6675 6e63 5b27 6d65          func['me
-00025800: 616e 275d 203d 205b 5d0a 2020 2020 2020  an'] = [].      
-00025810: 2020 2020 2020 2020 2020 2020 2020 6675                fu
-00025820: 6e63 5b27 7364 6576 275d 203d 205b 5d0a  nc['sdev'] = [].
-00025830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025840: 2020 2020 6675 6e63 5b27 7765 6967 6874      func['weight
-00025850: 275d 203d 205b 5d0a 2020 2020 2020 2020  '] = [].        
-00025860: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00025870: 6e20 696e 2072 616e 6765 286e 5f66 756e  n in range(n_fun
-00025880: 6373 293a 0a20 2020 2020 2020 2020 2020  cs):.           
-00025890: 2020 2020 2020 2020 2020 2020 2070 203d               p =
-000258a0: 206e 202a 2033 0a20 2020 2020 2020 2020   n * 3.         
-000258b0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-000258c0: 6561 6e20 3d20 7365 6c66 2e6e 756d 6265  ean = self.numbe
-000258d0: 7246 5365 6c65 6374 696f 6e5b 705d 0a20  rFSelection[p]. 
-000258e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000258f0: 2020 2020 2020 2073 6465 7620 3d20 7365         sdev = se
-00025900: 6c66 2e6e 756d 6265 7246 5365 6c65 6374  lf.numberFSelect
-00025910: 696f 6e5b 7020 2b20 315d 0a20 2020 2020  ion[p + 1].     
-00025920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025930: 2020 2077 6569 6768 7420 3d20 7365 6c66     weight = self
-00025940: 2e6e 756d 6265 7246 5365 6c65 6374 696f  .numberFSelectio
-00025950: 6e5b 7020 2b20 325d 0a0a 2020 2020 2020  n[p + 2]..      
-00025960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025970: 2020 6675 6e63 5b27 6d65 616e 275d 2e61    func['mean'].a
-00025980: 7070 656e 6428 6d65 616e 290a 2020 2020  ppend(mean).    
-00025990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000259a0: 2020 2020 6675 6e63 5b27 7364 6576 275d      func['sdev']
-000259b0: 2e61 7070 656e 6428 7364 6576 290a 2020  .append(sdev).  
-000259c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000259d0: 2020 2020 2020 6675 6e63 5b27 7765 6967        func['weig
-000259e0: 6874 275d 2e61 7070 656e 6428 7765 6967  ht'].append(weig
-000259f0: 6874 290a 0a20 2020 2020 2020 2020 2020  ht)..           
-00025a00: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00025a10: 6e5f 6675 6e63 7320 3d3d 2031 3a0a 2020  n_funcs == 1:.  
-00025a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025a30: 2020 2020 2020 2020 2020 6675 6e63 5b27            func['
-00025a40: 7461 7267 6574 5f76 616c 7565 275d 203d  target_value'] =
-00025a50: 206d 6561 6e0a 2020 2020 2020 2020 2020   mean.          
-00025a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025a70: 2020 6675 6e63 5b27 6c6f 7765 725f 6c69    func['lower_li
-00025a80: 6d69 7427 5d20 3d20 6d65 616e 202d 2073  mit'] = mean - s
-00025a90: 6465 760a 2020 2020 2020 2020 2020 2020  dev.            
-00025aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025ab0: 6675 6e63 5b27 7570 7065 725f 6c69 6d69  func['upper_limi
-00025ac0: 7427 5d20 3d20 6d65 616e 202b 2073 6465  t'] = mean + sde
-00025ad0: 760a 0a20 2020 2020 2020 2020 2020 2020  v..             
-00025ae0: 2020 2020 2020 2020 2020 2069 6620 7364             if sd
-00025af0: 6576 203c 3d20 302e 303a 0a20 2020 2020  ev <= 0.0:.     
+00024fa0: 6966 2063 7478 2e57 4549 4748 5428 293a  if ctx.WEIGHT():
+00024fb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024fc0: 2020 2020 2077 6569 6768 7420 3d20 7365       weight = se
+00024fd0: 6c66 2e6e 756d 6265 7246 5365 6c65 6374  lf.numberFSelect
+00024fe0: 696f 6e5b 325d 0a0a 2020 2020 2020 2020  ion[2]..        
+00024ff0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
+00025000: 5b27 7765 6967 6874 275d 203d 2077 6569  ['weight'] = wei
+00025010: 6768 740a 0a20 2020 2020 2020 2020 2020  ght..           
+00025020: 2020 2020 2020 2020 2069 6620 7765 6967           if weig
+00025030: 6874 203c 2030 2e30 3a0a 2020 2020 2020  ht < 0.0:.      
+00025040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025050: 2020 7661 6c69 6420 3d20 4661 6c73 650a    valid = False.
+00025060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025070: 2020 2020 2020 2020 7365 6c66 2e5f 5f66          self.__f
+00025080: 2e61 7070 656e 6428 6622 5b49 6e76 616c  .append(f"[Inval
+00025090: 6964 2064 6174 615d 207b 7365 6c66 2e5f  id data] {self._
+000250a0: 5f67 6574 4375 7272 656e 7452 6573 7472  _getCurrentRestr
+000250b0: 6169 6e74 2829 7d22 0a20 2020 2020 2020  aint()}".       
+000250c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000250d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000250e0: 2066 227b 6675 6e63 5479 7065 7d20 2777   f"{funcType} 'w
+000250f0: 6569 6768 743d 7b77 6569 6768 747d 2720  eight={weight}' 
+00025100: 6d75 7374 206e 6f74 2062 6520 6120 6e65  must not be a ne
+00025110: 6761 7469 7665 2076 616c 7565 2e22 290a  gative value.").
+00025120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025130: 2020 2020 656c 6966 2077 6569 6768 7420      elif weight 
+00025140: 3d3d 2030 2e30 3a0a 2020 2020 2020 2020  == 0.0:.        
+00025150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025160: 7365 6c66 2e5f 5f66 2e61 7070 656e 6428  self.__f.append(
+00025170: 6622 5b52 616e 6765 2076 616c 7565 2077  f"[Range value w
+00025180: 6172 6e69 6e67 5d20 7b73 656c 662e 5f5f  arning] {self.__
+00025190: 6765 7443 7572 7265 6e74 5265 7374 7261  getCurrentRestra
+000251a0: 696e 7428 297d 220a 2020 2020 2020 2020  int()}".        
+000251b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000251c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000251d0: 6622 7b66 756e 6354 7970 657d 2027 7765  f"{funcType} 'we
+000251e0: 6967 6874 3d7b 7765 6967 6874 7d27 2073  ight={weight}' s
+000251f0: 686f 756c 6420 6265 2061 2070 6f73 6974  hould be a posit
+00025200: 6976 6520 7661 6c75 652e 2229 0a0a 2020  ive value.")..  
+00025210: 2020 2020 2020 2020 2020 2020 2020 6675                fu
+00025220: 6e63 5b27 7461 7267 6574 5f76 616c 7565  nc['target_value
+00025230: 275d 203d 206d 6561 6e0a 2020 2020 2020  '] = mean.      
+00025240: 2020 2020 2020 2020 2020 6675 6e63 5b27            func['
+00025250: 6c6f 7765 725f 6c69 6d69 7427 5d20 3d20  lower_limit'] = 
+00025260: 6d65 616e 202d 2073 640a 2020 2020 2020  mean - sd.      
+00025270: 2020 2020 2020 2020 2020 6675 6e63 5b27            func['
+00025280: 7570 7065 725f 6c69 6d69 7427 5d20 3d20  upper_limit'] = 
+00025290: 6d65 616e 202b 2073 640a 0a20 2020 2020  mean + sd..     
+000252a0: 2020 2020 2020 2065 6c69 6620 6374 782e         elif ctx.
+000252b0: 534f 4746 554e 4328 293a 2020 2320 6e5f  SOGFUNC():  # n_
+000252c0: 6675 6e63 7320 5b6d 6561 6e31 2073 6465  funcs [mean1 sde
+000252d0: 7631 2077 6569 6768 7431 205b 6d65 616e  v1 weight1 [mean
+000252e0: 3220 7364 6576 3220 7765 6967 6874 3220  2 sdev2 weight2 
+000252f0: 5b2e 2e2e 5d5d 5d0a 2020 2020 2020 2020  [...]]].        
+00025300: 2020 2020 2020 2020 6675 6e63 5479 7065          funcType
+00025310: 203d 2027 534f 4746 554e 4327 0a20 2020   = 'SOGFUNC'.   
+00025320: 2020 2020 2020 2020 2020 2020 206e 5f66               n_f
+00025330: 756e 6373 203d 2069 6e74 2873 7472 2863  uncs = int(str(c
+00025340: 7478 2e49 6e74 6567 6572 2829 2929 0a0a  tx.Integer()))..
+00025350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025360: 6675 6e63 5b27 6e61 6d65 275d 203d 2066  func['name'] = f
+00025370: 756e 6354 7970 650a 2020 2020 2020 2020  uncType.        
+00025380: 2020 2020 2020 2020 6675 6e63 5b27 6e5f          func['n_
+00025390: 6675 6e63 7327 5d20 3d20 6e5f 6675 6e63  funcs'] = n_func
+000253a0: 730a 0a20 2020 2020 2020 2020 2020 2020  s..             
+000253b0: 2020 2069 6620 6e5f 6675 6e63 7320 3c3d     if n_funcs <=
+000253c0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+000253d0: 2020 2020 2020 2020 7661 6c69 6420 3d20          valid = 
+000253e0: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
+000253f0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00025400: 5f66 2e61 7070 656e 6428 6622 5b49 6e76  _f.append(f"[Inv
+00025410: 616c 6964 2064 6174 615d 207b 7365 6c66  alid data] {self
+00025420: 2e5f 5f67 6574 4375 7272 656e 7452 6573  .__getCurrentRes
+00025430: 7472 6169 6e74 2829 7d22 0a20 2020 2020  traint()}".     
+00025440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025450: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00025460: 227b 6675 6e63 5479 7065 7d20 7468 6520  "{funcType} the 
+00025470: 6e75 6d62 6572 206f 6620 4761 7573 7369  number of Gaussi
+00025480: 616e 2066 756e 6374 696f 6e73 2027 6e5f  an functions 'n_
+00025490: 6675 6e63 733d 7b6e 5f66 756e 6373 7d27  funcs={n_funcs}'
+000254a0: 206d 7573 7420 6265 2061 2070 6f73 6974   must be a posit
+000254b0: 6976 6520 7661 6c75 652e 2229 0a20 2020  ive value.").   
+000254c0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+000254d0: 6620 6c65 6e28 7365 6c66 2e6e 756d 6265  f len(self.numbe
+000254e0: 7246 5365 6c65 6374 696f 6e29 203e 206e  rFSelection) > n
+000254f0: 5f66 756e 6373 202a 2033 202d 2031 3a0a  _funcs * 3 - 1:.
+00025500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025510: 2020 2020 6675 6e63 5b27 6d65 616e 275d      func['mean']
+00025520: 203d 205b 5d0a 2020 2020 2020 2020 2020   = [].          
+00025530: 2020 2020 2020 2020 2020 6675 6e63 5b27            func['
+00025540: 7364 6576 275d 203d 205b 5d0a 2020 2020  sdev'] = [].    
+00025550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025560: 6675 6e63 5b27 7765 6967 6874 275d 203d  func['weight'] =
+00025570: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
+00025580: 2020 2020 2020 2020 666f 7220 6e20 696e          for n in
+00025590: 2072 616e 6765 286e 5f66 756e 6373 293a   range(n_funcs):
+000255a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000255b0: 2020 2020 2020 2020 2070 203d 206e 202a           p = n *
+000255c0: 2033 0a20 2020 2020 2020 2020 2020 2020   3.             
+000255d0: 2020 2020 2020 2020 2020 206d 6561 6e20             mean 
+000255e0: 3d20 7365 6c66 2e6e 756d 6265 7246 5365  = self.numberFSe
+000255f0: 6c65 6374 696f 6e5b 705d 0a20 2020 2020  lection[p].     
+00025600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025610: 2020 2073 6465 7620 3d20 7365 6c66 2e6e     sdev = self.n
+00025620: 756d 6265 7246 5365 6c65 6374 696f 6e5b  umberFSelection[
+00025630: 7020 2b20 315d 0a20 2020 2020 2020 2020  p + 1].         
+00025640: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+00025650: 6569 6768 7420 3d20 7365 6c66 2e6e 756d  eight = self.num
+00025660: 6265 7246 5365 6c65 6374 696f 6e5b 7020  berFSelection[p 
+00025670: 2b20 325d 0a0a 2020 2020 2020 2020 2020  + 2]..          
+00025680: 2020 2020 2020 2020 2020 2020 2020 6675                fu
+00025690: 6e63 5b27 6d65 616e 275d 2e61 7070 656e  nc['mean'].appen
+000256a0: 6428 6d65 616e 290a 2020 2020 2020 2020  d(mean).        
+000256b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000256c0: 6675 6e63 5b27 7364 6576 275d 2e61 7070  func['sdev'].app
+000256d0: 656e 6428 7364 6576 290a 2020 2020 2020  end(sdev).      
+000256e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000256f0: 2020 6675 6e63 5b27 7765 6967 6874 275d    func['weight']
+00025700: 2e61 7070 656e 6428 7765 6967 6874 290a  .append(weight).
+00025710: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025720: 2020 2020 2020 2020 2069 6620 6e5f 6675           if n_fu
+00025730: 6e63 7320 3d3d 2031 3a0a 2020 2020 2020  ncs == 1:.      
+00025740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025750: 2020 2020 2020 6675 6e63 5b27 7461 7267        func['targ
+00025760: 6574 5f76 616c 7565 275d 203d 206d 6561  et_value'] = mea
+00025770: 6e0a 2020 2020 2020 2020 2020 2020 2020  n.              
+00025780: 2020 2020 2020 2020 2020 2020 2020 6675                fu
+00025790: 6e63 5b27 6c6f 7765 725f 6c69 6d69 7427  nc['lower_limit'
+000257a0: 5d20 3d20 6d65 616e 202d 2073 6465 760a  ] = mean - sdev.
+000257b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000257c0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
+000257d0: 5b27 7570 7065 725f 6c69 6d69 7427 5d20  ['upper_limit'] 
+000257e0: 3d20 6d65 616e 202b 2073 6465 760a 0a20  = mean + sdev.. 
+000257f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025800: 2020 2020 2020 2069 6620 7364 6576 203c         if sdev <
+00025810: 3d20 302e 303a 0a20 2020 2020 2020 2020  = 0.0:.         
+00025820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025830: 2020 2076 616c 6964 203d 2046 616c 7365     valid = False
+00025840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025850: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00025860: 662e 5f5f 662e 6170 7065 6e64 2866 225b  f.__f.append(f"[
+00025870: 496e 7661 6c69 6420 6461 7461 5d20 7b73  Invalid data] {s
+00025880: 656c 662e 5f5f 6765 7443 7572 7265 6e74  elf.__getCurrent
+00025890: 5265 7374 7261 696e 7428 297d 220a 2020  Restraint()}".  
+000258a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000258b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000258c0: 2020 2020 2020 2020 2020 6622 7b66 756e            f"{fun
+000258d0: 6354 7970 657d 2073 7461 6e64 6172 6420  cType} standard 
+000258e0: 6465 7669 6174 696f 6e20 2773 6465 763d  deviation 'sdev=
+000258f0: 7b73 6465 767d 2720 6f66 207b 6e2b 317d  {sdev}' of {n+1}
+00025900: 7468 2066 756e 6374 696f 6e20 6d75 7374  th function must
+00025910: 2062 6520 6120 706f 7369 7469 7665 2076   be a positive v
+00025920: 616c 7565 2e22 290a 2020 2020 2020 2020  alue.").        
+00025930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025940: 6966 2077 6569 6768 7420 3c20 302e 303a  if weight < 0.0:
+00025950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025960: 2020 2020 2020 2020 2020 2020 2076 616c               val
+00025970: 6964 203d 2046 616c 7365 0a20 2020 2020  id = False.     
+00025980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025990: 2020 2020 2020 2073 656c 662e 5f5f 662e         self.__f.
+000259a0: 6170 7065 6e64 2866 225b 496e 7661 6c69  append(f"[Invali
+000259b0: 6420 6461 7461 5d20 7b73 656c 662e 5f5f  d data] {self.__
+000259c0: 6765 7443 7572 7265 6e74 5265 7374 7261  getCurrentRestra
+000259d0: 696e 7428 297d 220a 2020 2020 2020 2020  int()}".        
+000259e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000259f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025a00: 2020 2020 6622 7b66 756e 6354 7970 657d      f"{funcType}
+00025a10: 2027 7765 6967 6874 3d7b 7765 6967 6874   'weight={weight
+00025a20: 7d27 206f 6620 7b6e 2b31 7d74 6820 6675  }' of {n+1}th fu
+00025a30: 6e63 7469 6f6e 206d 7573 7420 6e6f 7420  nction must not 
+00025a40: 6265 2061 206e 6567 6174 6976 6520 7661  be a negative va
+00025a50: 6c75 652e 2229 0a20 2020 2020 2020 2020  lue.").         
+00025a60: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00025a70: 6c69 6620 7765 6967 6874 203d 3d20 302e  lif weight == 0.
+00025a80: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
+00025a90: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00025aa0: 656c 662e 5f5f 662e 6170 7065 6e64 2866  elf.__f.append(f
+00025ab0: 225b 5261 6e67 6520 7661 6c75 6520 6572  "[Range value er
+00025ac0: 726f 725d 207b 7365 6c66 2e5f 5f67 6574  ror] {self.__get
+00025ad0: 4375 7272 656e 7452 6573 7472 6169 6e74  CurrentRestraint
+00025ae0: 2829 7d22 0a20 2020 2020 2020 2020 2020  ()}".           
+00025af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00025b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025b10: 2020 2020 2020 2076 616c 6964 203d 2046         valid = F
-00025b20: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-00025b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025b40: 2073 656c 662e 5f5f 662e 6170 7065 6e64   self.__f.append
-00025b50: 2866 225b 496e 7661 6c69 6420 6461 7461  (f"[Invalid data
-00025b60: 5d20 7b73 656c 662e 5f5f 6765 7443 7572  ] {self.__getCur
-00025b70: 7265 6e74 5265 7374 7261 696e 7428 297d  rentRestraint()}
-00025b80: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00025b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025ba0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-00025bb0: 7b66 756e 6354 7970 657d 2073 7461 6e64  {funcType} stand
-00025bc0: 6172 6420 6465 7669 6174 696f 6e20 2773  ard deviation 's
-00025bd0: 6465 763d 7b73 6465 767d 2720 6f66 207b  dev={sdev}' of {
-00025be0: 6e2b 317d 7468 2066 756e 6374 696f 6e20  n+1}th function 
-00025bf0: 6d75 7374 2062 6520 6120 706f 7369 7469  must be a positi
-00025c00: 7665 2076 616c 7565 2e22 290a 2020 2020  ve value.").    
-00025c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025c20: 2020 2020 6966 2077 6569 6768 7420 3c20      if weight < 
-00025c30: 302e 303a 0a20 2020 2020 2020 2020 2020  0.0:.           
-00025c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025c50: 2076 616c 6964 203d 2046 616c 7365 0a20   valid = False. 
-00025c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025c70: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00025c80: 5f5f 662e 6170 7065 6e64 2866 225b 496e  __f.append(f"[In
-00025c90: 7661 6c69 6420 6461 7461 5d20 7b73 656c  valid data] {sel
-00025ca0: 662e 5f5f 6765 7443 7572 7265 6e74 5265  f.__getCurrentRe
-00025cb0: 7374 7261 696e 7428 297d 220a 2020 2020  straint()}".    
-00025cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025ce0: 2020 2020 2020 2020 6622 7b66 756e 6354          f"{funcT
-00025cf0: 7970 657d 2027 7765 6967 6874 3d7b 7765  ype} 'weight={we
-00025d00: 6967 6874 7d27 206f 6620 7b6e 2b31 7d74  ight}' of {n+1}t
-00025d10: 6820 6675 6e63 7469 6f6e 206d 7573 7420  h function must 
-00025d20: 6e6f 7420 6265 2061 206e 6567 6174 6976  not be a negativ
-00025d30: 6520 7661 6c75 652e 2229 0a20 2020 2020  e value.").     
-00025d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025d50: 2020 2065 6c69 6620 7765 6967 6874 203d     elif weight =
-00025d60: 3d20 302e 303a 0a20 2020 2020 2020 2020  = 0.0:.         
-00025d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025d80: 2020 2073 656c 662e 5f5f 662e 6170 7065     self.__f.appe
-00025d90: 6e64 2866 225b 5261 6e67 6520 7661 6c75  nd(f"[Range valu
-00025da0: 6520 6572 726f 725d 207b 7365 6c66 2e5f  e error] {self._
-00025db0: 5f67 6574 4375 7272 656e 7452 6573 7472  _getCurrentRestr
-00025dc0: 6169 6e74 2829 7d22 0a20 2020 2020 2020  aint()}".       
-00025dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025df0: 2020 2020 2066 227b 6675 6e63 5479 7065       f"{funcType
-00025e00: 7d20 2777 6569 6768 743d 7b77 6569 6768  } 'weight={weigh
-00025e10: 747d 2720 6f66 207b 6e2b 317d 7468 2066  t}' of {n+1}th f
-00025e20: 756e 6374 696f 6e20 7368 6f75 6c64 2062  unction should b
-00025e30: 6520 6120 706f 7369 7469 7665 2076 616c  e a positive val
-00025e40: 7565 2e22 290a 0a20 2020 2020 2020 2020  ue.")..         
-00025e50: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00025b10: 2066 227b 6675 6e63 5479 7065 7d20 2777   f"{funcType} 'w
+00025b20: 6569 6768 743d 7b77 6569 6768 747d 2720  eight={weight}' 
+00025b30: 6f66 207b 6e2b 317d 7468 2066 756e 6374  of {n+1}th funct
+00025b40: 696f 6e20 7368 6f75 6c64 2062 6520 6120  ion should be a 
+00025b50: 706f 7369 7469 7665 2076 616c 7565 2e22  positive value."
+00025b60: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+00025b70: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00025b80: 2020 2020 2020 2020 2020 2020 2076 616c               val
+00025b90: 6964 203d 2046 616c 7365 0a20 2020 2020  id = False.     
+00025ba0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00025bb0: 656c 662e 5f5f 662e 6170 7065 6e64 2866  elf.__f.append(f
+00025bc0: 225b 496e 7661 6c69 6420 6461 7461 5d20  "[Invalid data] 
+00025bd0: 7b73 656c 662e 5f5f 6765 7443 7572 7265  {self.__getCurre
+00025be0: 6e74 5265 7374 7261 696e 7428 297d 220a  ntRestraint()}".
+00025bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025c10: 2020 2020 6622 7b66 756e 6354 7970 657d      f"{funcType}
+00025c20: 2072 6571 7569 7265 7320 636f 6e73 6563   requires consec
+00025c30: 7574 6976 6520 3320 7061 7261 6d65 7465  utive 3 paramete
+00025c40: 7273 2028 6d65 616e 2c20 7364 6576 2c20  rs (mean, sdev, 
+00025c50: 7765 6967 6874 2920 666f 7220 6561 6368  weight) for each
+00025c60: 2047 6175 7373 6961 6e20 6675 6e63 7469   Gaussian functi
+00025c70: 6f6e 2061 6674 6572 2074 6865 2066 6972  on after the fir
+00025c80: 7374 2027 6e5f 6675 6e63 7327 2076 616c  st 'n_funcs' val
+00025c90: 7565 2e22 290a 0a20 2020 2020 2020 2020  ue.")..         
+00025ca0: 2020 2065 6c69 6620 6374 782e 4d49 5854     elif ctx.MIXT
+00025cb0: 5552 4546 554e 4328 2920 6f72 2063 7478  UREFUNC() or ctx
+00025cc0: 2e4b 4152 504c 5553 2829 206f 7220 6374  .KARPLUS() or ct
+00025cd0: 782e 534f 4544 494e 4746 554e 4328 293a  x.SOEDINGFUNC():
+00025ce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025cf0: 2069 6620 6374 782e 4d49 5854 5552 4546   if ctx.MIXTUREF
+00025d00: 554e 4328 293a 2020 2320 616e 6368 6f72  UNC():  # anchor
+00025d10: 2067 6175 7373 6961 6e5f 7061 7261 6d20   gaussian_param 
+00025d20: 6578 705f 7061 7261 6d20 6d69 7874 7572  exp_param mixtur
+00025d30: 655f 7061 7261 6d20 6267 5f6d 6561 6e20  e_param bg_mean 
+00025d40: 6267 5f73 640a 2020 2020 2020 2020 2020  bg_sd.          
+00025d50: 2020 2020 2020 2020 2020 6675 6e63 5479            funcTy
+00025d60: 7065 203d 2027 4d49 5854 5552 4546 554e  pe = 'MIXTUREFUN
+00025d70: 4327 0a20 2020 2020 2020 2020 2020 2020  C'.             
+00025d80: 2020 2020 2020 2061 6e63 686f 7220 3d20         anchor = 
+00025d90: 7365 6c66 2e6e 756d 6265 7246 5365 6c65  self.numberFSele
+00025da0: 6374 696f 6e5b 305d 0a20 2020 2020 2020  ction[0].       
+00025db0: 2020 2020 2020 2020 2020 2020 2067 6175               gau
+00025dc0: 7373 6961 6e5f 7061 7261 6d20 3d20 7365  ssian_param = se
+00025dd0: 6c66 2e6e 756d 6265 7246 5365 6c65 6374  lf.numberFSelect
+00025de0: 696f 6e5b 315d 0a20 2020 2020 2020 2020  ion[1].         
+00025df0: 2020 2020 2020 2020 2020 2065 7870 5f70             exp_p
+00025e00: 6172 616d 203d 2073 656c 662e 6e75 6d62  aram = self.numb
+00025e10: 6572 4653 656c 6563 7469 6f6e 5b32 5d0a  erFSelection[2].
+00025e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025e30: 2020 2020 6d69 7874 7572 655f 7061 7261      mixture_para
+00025e40: 6d20 3d20 7365 6c66 2e6e 756d 6265 7246  m = self.numberF
+00025e50: 5365 6c65 6374 696f 6e5b 335d 0a20 2020  Selection[3].   
 00025e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025e70: 2076 616c 6964 203d 2046 616c 7365 0a20   valid = False. 
-00025e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025e90: 2020 2073 656c 662e 5f5f 662e 6170 7065     self.__f.appe
-00025ea0: 6e64 2866 225b 496e 7661 6c69 6420 6461  nd(f"[Invalid da
-00025eb0: 7461 5d20 7b73 656c 662e 5f5f 6765 7443  ta] {self.__getC
-00025ec0: 7572 7265 6e74 5265 7374 7261 696e 7428  urrentRestraint(
-00025ed0: 297d 220a 2020 2020 2020 2020 2020 2020  )}".            
-00025ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025ef0: 2020 2020 2020 2020 6622 7b66 756e 6354          f"{funcT
-00025f00: 7970 657d 2072 6571 7569 7265 7320 636f  ype} requires co
-00025f10: 6e73 6563 7574 6976 6520 3320 7061 7261  nsecutive 3 para
-00025f20: 6d65 7465 7273 2028 6d65 616e 2c20 7364  meters (mean, sd
-00025f30: 6576 2c20 7765 6967 6874 2920 666f 7220  ev, weight) for 
-00025f40: 6561 6368 2047 6175 7373 6961 6e20 6675  each Gaussian fu
-00025f50: 6e63 7469 6f6e 2061 6674 6572 2074 6865  nction after the
-00025f60: 2066 6972 7374 2027 6e5f 6675 6e63 7327   first 'n_funcs'
-00025f70: 2076 616c 7565 2e22 290a 0a20 2020 2020   value.")..     
-00025f80: 2020 2020 2020 2065 6c69 6620 6374 782e         elif ctx.
-00025f90: 4d49 5854 5552 4546 554e 4328 2920 6f72  MIXTUREFUNC() or
-00025fa0: 2063 7478 2e4b 4152 504c 5553 2829 206f   ctx.KARPLUS() o
-00025fb0: 7220 6374 782e 534f 4544 494e 4746 554e  r ctx.SOEDINGFUN
-00025fc0: 4328 293a 0a20 2020 2020 2020 2020 2020  C():.           
-00025fd0: 2020 2020 2069 6620 6374 782e 4d49 5854       if ctx.MIXT
-00025fe0: 5552 4546 554e 4328 293a 2020 2320 616e  UREFUNC():  # an
-00025ff0: 6368 6f72 2067 6175 7373 6961 6e5f 7061  chor gaussian_pa
-00026000: 7261 6d20 6578 705f 7061 7261 6d20 6d69  ram exp_param mi
-00026010: 7874 7572 655f 7061 7261 6d20 6267 5f6d  xture_param bg_m
-00026020: 6561 6e20 6267 5f73 640a 2020 2020 2020  ean bg_sd.      
-00026030: 2020 2020 2020 2020 2020 2020 2020 6675                fu
-00026040: 6e63 5479 7065 203d 2027 4d49 5854 5552  ncType = 'MIXTUR
-00026050: 4546 554e 4327 0a20 2020 2020 2020 2020  EFUNC'.         
-00026060: 2020 2020 2020 2020 2020 2061 6e63 686f             ancho
-00026070: 7220 3d20 7365 6c66 2e6e 756d 6265 7246  r = self.numberF
-00026080: 5365 6c65 6374 696f 6e5b 305d 0a20 2020  Selection[0].   
-00026090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000260a0: 2067 6175 7373 6961 6e5f 7061 7261 6d20   gaussian_param 
-000260b0: 3d20 7365 6c66 2e6e 756d 6265 7246 5365  = self.numberFSe
-000260c0: 6c65 6374 696f 6e5b 315d 0a20 2020 2020  lection[1].     
-000260d0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000260e0: 7870 5f70 6172 616d 203d 2073 656c 662e  xp_param = self.
-000260f0: 6e75 6d62 6572 4653 656c 6563 7469 6f6e  numberFSelection
-00026100: 5b32 5d0a 2020 2020 2020 2020 2020 2020  [2].            
-00026110: 2020 2020 2020 2020 6d69 7874 7572 655f          mixture_
-00026120: 7061 7261 6d20 3d20 7365 6c66 2e6e 756d  param = self.num
-00026130: 6265 7246 5365 6c65 6374 696f 6e5b 335d  berFSelection[3]
-00026140: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00026150: 2020 2020 2062 675f 6d65 616e 203d 2073       bg_mean = s
-00026160: 656c 662e 6e75 6d62 6572 4653 656c 6563  elf.numberFSelec
-00026170: 7469 6f6e 5b34 5d0a 2020 2020 2020 2020  tion[4].        
-00026180: 2020 2020 2020 2020 2020 2020 6267 5f73              bg_s
-00026190: 6420 3d20 7365 6c66 2e6e 756d 6265 7246  d = self.numberF
-000261a0: 5365 6c65 6374 696f 6e5b 355d 0a0a 2020  Selection[5]..  
-000261b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000261c0: 2020 6675 6e63 5b27 6e61 6d65 275d 203d    func['name'] =
-000261d0: 2066 756e 6354 7970 650a 2020 2020 2020   funcType.      
-000261e0: 2020 2020 2020 2020 2020 2020 2020 6675                fu
-000261f0: 6e63 5b27 616e 6368 6f72 275d 203d 2061  nc['anchor'] = a
-00026200: 6e63 686f 720a 2020 2020 2020 2020 2020  nchor.          
-00026210: 2020 2020 2020 2020 2020 6675 6e63 5b27            func['
-00026220: 6761 7573 7369 616e 5f70 6172 616d 275d  gaussian_param']
-00026230: 203d 2067 6175 7373 6961 6e5f 7061 7261   = gaussian_para
-00026240: 6d0a 2020 2020 2020 2020 2020 2020 2020  m.              
-00026250: 2020 2020 2020 6675 6e63 5b27 6578 705f        func['exp_
-00026260: 7061 7261 6d27 5d20 3d20 6578 705f 7061  param'] = exp_pa
-00026270: 7261 6d0a 2020 2020 2020 2020 2020 2020  ram.            
-00026280: 2020 2020 2020 2020 6675 6e63 5b27 6d69          func['mi
-00026290: 7874 7572 655f 7061 7261 6d27 5d20 3d20  xture_param'] = 
-000262a0: 6d69 7874 7572 655f 7061 7261 6d0a 2020  mixture_param.  
-000262b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000262c0: 2020 6675 6e63 5b27 6267 5f6d 6561 6e27    func['bg_mean'
-000262d0: 5d20 3d20 6267 5f6d 6561 6e0a 2020 2020  ] = bg_mean.    
-000262e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000262f0: 6675 6e63 5b27 6267 5f73 6427 5d20 3d20  func['bg_sd'] = 
-00026300: 6267 5f73 640a 0a20 2020 2020 2020 2020  bg_sd..         
-00026310: 2020 2020 2020 2020 2020 2069 6620 6761             if ga
-00026320: 7573 7369 616e 5f70 6172 616d 203c 3d20  ussian_param <= 
-00026330: 302e 303a 0a20 2020 2020 2020 2020 2020  0.0:.           
-00026340: 2020 2020 2020 2020 2020 2020 2076 616c               val
-00026350: 6964 203d 2046 616c 7365 0a20 2020 2020  id = False.     
-00026360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026370: 2020 2073 656c 662e 5f5f 662e 6170 7065     self.__f.appe
-00026380: 6e64 2866 225b 496e 7661 6c69 6420 6461  nd(f"[Invalid da
-00026390: 7461 5d20 7b73 656c 662e 5f5f 6765 7443  ta] {self.__getC
-000263a0: 7572 7265 6e74 5265 7374 7261 696e 7428  urrentRestraint(
-000263b0: 297d 220a 2020 2020 2020 2020 2020 2020  )}".            
+00025e70: 2062 675f 6d65 616e 203d 2073 656c 662e   bg_mean = self.
+00025e80: 6e75 6d62 6572 4653 656c 6563 7469 6f6e  numberFSelection
+00025e90: 5b34 5d0a 2020 2020 2020 2020 2020 2020  [4].            
+00025ea0: 2020 2020 2020 2020 6267 5f73 6420 3d20          bg_sd = 
+00025eb0: 7365 6c66 2e6e 756d 6265 7246 5365 6c65  self.numberFSele
+00025ec0: 6374 696f 6e5b 355d 0a0a 2020 2020 2020  ction[5]..      
+00025ed0: 2020 2020 2020 2020 2020 2020 2020 6675                fu
+00025ee0: 6e63 5b27 6e61 6d65 275d 203d 2066 756e  nc['name'] = fun
+00025ef0: 6354 7970 650a 2020 2020 2020 2020 2020  cType.          
+00025f00: 2020 2020 2020 2020 2020 6675 6e63 5b27            func['
+00025f10: 616e 6368 6f72 275d 203d 2061 6e63 686f  anchor'] = ancho
+00025f20: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+00025f30: 2020 2020 2020 6675 6e63 5b27 6761 7573        func['gaus
+00025f40: 7369 616e 5f70 6172 616d 275d 203d 2067  sian_param'] = g
+00025f50: 6175 7373 6961 6e5f 7061 7261 6d0a 2020  aussian_param.  
+00025f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025f70: 2020 6675 6e63 5b27 6578 705f 7061 7261    func['exp_para
+00025f80: 6d27 5d20 3d20 6578 705f 7061 7261 6d0a  m'] = exp_param.
+00025f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025fa0: 2020 2020 6675 6e63 5b27 6d69 7874 7572      func['mixtur
+00025fb0: 655f 7061 7261 6d27 5d20 3d20 6d69 7874  e_param'] = mixt
+00025fc0: 7572 655f 7061 7261 6d0a 2020 2020 2020  ure_param.      
+00025fd0: 2020 2020 2020 2020 2020 2020 2020 6675                fu
+00025fe0: 6e63 5b27 6267 5f6d 6561 6e27 5d20 3d20  nc['bg_mean'] = 
+00025ff0: 6267 5f6d 6561 6e0a 2020 2020 2020 2020  bg_mean.        
+00026000: 2020 2020 2020 2020 2020 2020 6675 6e63              func
+00026010: 5b27 6267 5f73 6427 5d20 3d20 6267 5f73  ['bg_sd'] = bg_s
+00026020: 640a 0a20 2020 2020 2020 2020 2020 2020  d..             
+00026030: 2020 2020 2020 2069 6620 6761 7573 7369         if gaussi
+00026040: 616e 5f70 6172 616d 203c 3d20 302e 303a  an_param <= 0.0:
+00026050: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00026060: 2020 2020 2020 2020 2076 616c 6964 203d           valid =
+00026070: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
+00026080: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00026090: 656c 662e 5f5f 662e 6170 7065 6e64 2866  elf.__f.append(f
+000260a0: 225b 496e 7661 6c69 6420 6461 7461 5d20  "[Invalid data] 
+000260b0: 7b73 656c 662e 5f5f 6765 7443 7572 7265  {self.__getCurre
+000260c0: 6e74 5265 7374 7261 696e 7428 297d 220a  ntRestraint()}".
+000260d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000260e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000260f0: 2020 2020 2020 2020 6622 7b66 756e 6354          f"{funcT
+00026100: 7970 657d 2073 7461 6e64 6172 6420 6465  ype} standard de
+00026110: 7669 6174 696f 6e20 6f66 2061 2047 6175  viation of a Gau
+00026120: 7373 6961 6e20 6469 7374 7269 6275 7469  ssian distributi
+00026130: 6f6e 2022 0a20 2020 2020 2020 2020 2020  on ".           
+00026140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026150: 2020 2020 2020 2020 2020 2020 2066 2227               f"'
+00026160: 6761 7573 7369 616e 5f70 6172 616d 3d7b  gaussian_param={
+00026170: 6761 7573 7369 616e 5f70 6172 616d 7d27  gaussian_param}'
+00026180: 206d 7573 7420 6265 2061 2070 6f73 6974   must be a posit
+00026190: 6976 6520 7661 6c75 652e 2229 0a20 2020  ive value.").   
+000261a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000261b0: 2069 6620 6578 705f 7061 7261 6d20 3c3d   if exp_param <=
+000261c0: 2030 2e30 3a0a 2020 2020 2020 2020 2020   0.0:.          
+000261d0: 2020 2020 2020 2020 2020 2020 2020 7661                va
+000261e0: 6c69 6420 3d20 4661 6c73 650a 2020 2020  lid = False.    
+000261f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026200: 2020 2020 7365 6c66 2e5f 5f66 2e61 7070      self.__f.app
+00026210: 656e 6428 6622 5b49 6e76 616c 6964 2064  end(f"[Invalid d
+00026220: 6174 615d 207b 7365 6c66 2e5f 5f67 6574  ata] {self.__get
+00026230: 4375 7272 656e 7452 6573 7472 6169 6e74  CurrentRestraint
+00026240: 2829 7d22 0a20 2020 2020 2020 2020 2020  ()}".           
+00026250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026260: 2020 2020 2020 2020 2020 2020 2066 227b               f"{
+00026270: 6675 6e63 5479 7065 7d20 7261 7465 2061  funcType} rate a
+00026280: 7420 7768 6963 6820 7468 6520 6578 706f  t which the expo
+00026290: 6e65 6e74 6961 6c20 6469 7374 7269 6275  nential distribu
+000262a0: 7469 6f6e 2064 726f 7073 206f 6666 2022  tion drops off "
+000262b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000262c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000262d0: 2020 2020 2020 2020 2066 2227 6578 705f           f"'exp_
+000262e0: 7061 7261 6d3d 7b65 7870 5f70 6172 616d  param={exp_param
+000262f0: 7d27 206d 7573 7420 6265 2061 2070 6f73  }' must be a pos
+00026300: 6974 6976 6520 7661 6c75 652e 2229 0a20  itive value."). 
+00026310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026320: 2020 2069 6620 6d69 7874 7572 655f 7061     if mixture_pa
+00026330: 7261 6d20 3c3d 2030 2e30 3a0a 2020 2020  ram <= 0.0:.    
+00026340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026350: 2020 2020 7661 6c69 6420 3d20 4661 6c73      valid = Fals
+00026360: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00026370: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00026380: 5f66 2e61 7070 656e 6428 6622 5b49 6e76  _f.append(f"[Inv
+00026390: 616c 6964 2064 6174 615d 207b 7365 6c66  alid data] {self
+000263a0: 2e5f 5f67 6574 4375 7272 656e 7452 6573  .__getCurrentRes
+000263b0: 7472 6169 6e74 2829 7d22 0a20 2020 2020  traint()}".     
 000263c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000263d0: 2020 2020 2020 2020 2020 2020 6622 7b66              f"{f
-000263e0: 756e 6354 7970 657d 2073 7461 6e64 6172  uncType} standar
-000263f0: 6420 6465 7669 6174 696f 6e20 6f66 2061  d deviation of a
-00026400: 2047 6175 7373 6961 6e20 6469 7374 7269   Gaussian distri
-00026410: 6275 7469 6f6e 2022 0a20 2020 2020 2020  bution ".       
-00026420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000263d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000263e0: 2020 2066 227b 6675 6e63 5479 7065 7d20     f"{funcType} 
+000263f0: 6d69 7874 7572 6520 6f66 2074 6865 2047  mixture of the G
+00026400: 6175 7373 6961 6e20 616e 6420 4578 706f  aussian and Expo
+00026410: 6e65 6e74 6961 6c20 6675 6e63 7469 6f6e  nential function
+00026420: 7320 220a 2020 2020 2020 2020 2020 2020  s ".            
 00026430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026440: 2066 2227 6761 7573 7369 616e 5f70 6172   f"'gaussian_par
-00026450: 616d 3d7b 6761 7573 7369 616e 5f70 6172  am={gaussian_par
-00026460: 616d 7d27 206d 7573 7420 6265 2061 2070  am}' must be a p
-00026470: 6f73 6974 6976 6520 7661 6c75 652e 2229  ositive value.")
-00026480: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00026490: 2020 2020 2069 6620 6578 705f 7061 7261       if exp_para
-000264a0: 6d20 3c3d 2030 2e30 3a0a 2020 2020 2020  m <= 0.0:.      
-000264b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000264c0: 2020 7661 6c69 6420 3d20 4661 6c73 650a    valid = False.
+00026440: 2020 2020 2020 2020 2020 2020 6622 276d              f"'m
+00026450: 6978 7475 7265 5f70 6172 616d 3d7b 6d69  ixture_param={mi
+00026460: 7874 7572 655f 7061 7261 6d7d 2720 7468  xture_param}' th
+00026470: 6174 206d 616b 6520 7570 2067 2872 2920  at make up g(r) 
+00026480: 6675 6e63 7469 6f6e 206d 7573 7420 6265  function must be
+00026490: 2061 2070 6f73 6974 6976 6520 7661 6c75   a positive valu
+000264a0: 652e 2229 0a20 2020 2020 2020 2020 2020  e.").           
+000264b0: 2020 2020 2020 2020 2069 6620 6267 5f73           if bg_s
+000264c0: 6420 3c3d 2030 2e30 3a0a 2020 2020 2020  d <= 0.0:.      
 000264d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000264e0: 2020 2020 2020 2020 7365 6c66 2e5f 5f66          self.__f
-000264f0: 2e61 7070 656e 6428 6622 5b49 6e76 616c  .append(f"[Inval
-00026500: 6964 2064 6174 615d 207b 7365 6c66 2e5f  id data] {self._
-00026510: 5f67 6574 4375 7272 656e 7452 6573 7472  _getCurrentRestr
-00026520: 6169 6e74 2829 7d22 0a20 2020 2020 2020  aint()}".       
-00026530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026550: 2066 227b 6675 6e63 5479 7065 7d20 7261   f"{funcType} ra
-00026560: 7465 2061 7420 7768 6963 6820 7468 6520  te at which the 
-00026570: 6578 706f 6e65 6e74 6961 6c20 6469 7374  exponential dist
-00026580: 7269 6275 7469 6f6e 2064 726f 7073 206f  ribution drops o
-00026590: 6666 2022 0a20 2020 2020 2020 2020 2020  ff ".           
-000265a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000265b0: 2020 2020 2020 2020 2020 2020 2066 2227               f"'
-000265c0: 6578 705f 7061 7261 6d3d 7b65 7870 5f70  exp_param={exp_p
-000265d0: 6172 616d 7d27 206d 7573 7420 6265 2061  aram}' must be a
-000265e0: 2070 6f73 6974 6976 6520 7661 6c75 652e   positive value.
-000265f0: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
-00026600: 2020 2020 2020 2069 6620 6d69 7874 7572         if mixtur
-00026610: 655f 7061 7261 6d20 3c3d 2030 2e30 3a0a  e_param <= 0.0:.
-00026620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026630: 2020 2020 2020 2020 7661 6c69 6420 3d20          valid = 
-00026640: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
-00026650: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00026660: 6c66 2e5f 5f66 2e61 7070 656e 6428 6622  lf.__f.append(f"
-00026670: 5b49 6e76 616c 6964 2064 6174 615d 207b  [Invalid data] {
-00026680: 7365 6c66 2e5f 5f67 6574 4375 7272 656e  self.__getCurren
-00026690: 7452 6573 7472 6169 6e74 2829 7d22 0a20  tRestraint()}". 
-000266a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000266b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000266c0: 2020 2020 2020 2066 227b 6675 6e63 5479         f"{funcTy
-000266d0: 7065 7d20 6d69 7874 7572 6520 6f66 2074  pe} mixture of t
-000266e0: 6865 2047 6175 7373 6961 6e20 616e 6420  he Gaussian and 
-000266f0: 4578 706f 6e65 6e74 6961 6c20 6675 6e63  Exponential func
-00026700: 7469 6f6e 7320 220a 2020 2020 2020 2020  tions ".        
-00026710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026730: 6622 276d 6978 7475 7265 5f70 6172 616d  f"'mixture_param
-00026740: 3d7b 6d69 7874 7572 655f 7061 7261 6d7d  ={mixture_param}
-00026750: 2720 7468 6174 206d 616b 6520 7570 2067  ' that make up g
-00026760: 2872 2920 6675 6e63 7469 6f6e 206d 7573  (r) function mus
-00026770: 7420 6265 2061 2070 6f73 6974 6976 6520  t be a positive 
-00026780: 7661 6c75 652e 2229 0a20 2020 2020 2020  value.").       
-00026790: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000267a0: 6267 5f73 6420 3c3d 2030 2e30 3a0a 2020  bg_sd <= 0.0:.  
-000267b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000267c0: 2020 2020 2020 7661 6c69 6420 3d20 4661        valid = Fa
-000267d0: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
-000267e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000267f0: 2e5f 5f66 2e61 7070 656e 6428 6622 5b49  .__f.append(f"[I
-00026800: 6e76 616c 6964 2064 6174 615d 207b 7365  nvalid data] {se
-00026810: 6c66 2e5f 5f67 6574 4375 7272 656e 7452  lf.__getCurrentR
-00026820: 6573 7472 6169 6e74 2829 7d22 0a20 2020  estraint()}".   
-00026830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026850: 2020 2020 2066 227b 6675 6e63 5479 7065       f"{funcType
-00026860: 7d20 7374 616e 6461 7264 2064 6576 6961  } standard devia
-00026870: 7469 6f6e 2027 6267 5f73 643d 7b62 675f  tion 'bg_sd={bg_
-00026880: 7364 7d27 206f 6620 6828 7229 2066 756e  sd}' of h(r) fun
-00026890: 6374 696f 6e20 6d75 7374 2062 6520 6120  ction must be a 
-000268a0: 706f 7369 7469 7665 2076 616c 7565 2e22  positive value."
-000268b0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-000268c0: 2020 2065 6c69 6620 6374 782e 4b41 5250     elif ctx.KARP
-000268d0: 4c55 5328 293a 2020 2320 4120 4220 4320  LUS():  # A B C 
-000268e0: 4420 7830 2073 640a 2020 2020 2020 2020  D x0 sd.        
-000268f0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
-00026900: 5479 7065 203d 2027 4b41 5250 4c55 5327  Type = 'KARPLUS'
-00026910: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00026920: 2020 2020 2041 203d 2073 656c 662e 6e75       A = self.nu
-00026930: 6d62 6572 4653 656c 6563 7469 6f6e 5b30  mberFSelection[0
-00026940: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00026950: 2020 2020 2020 4220 3d20 7365 6c66 2e6e        B = self.n
-00026960: 756d 6265 7246 5365 6c65 6374 696f 6e5b  umberFSelection[
-00026970: 315d 0a20 2020 2020 2020 2020 2020 2020  1].             
-00026980: 2020 2020 2020 2043 203d 2073 656c 662e         C = self.
-00026990: 6e75 6d62 6572 4653 656c 6563 7469 6f6e  numberFSelection
-000269a0: 5b32 5d0a 2020 2020 2020 2020 2020 2020  [2].            
-000269b0: 2020 2020 2020 2020 4420 3d20 7365 6c66          D = self
-000269c0: 2e6e 756d 6265 7246 5365 6c65 6374 696f  .numberFSelectio
-000269d0: 6e5b 335d 0a20 2020 2020 2020 2020 2020  n[3].           
-000269e0: 2020 2020 2020 2020 2078 3020 3d20 7365           x0 = se
-000269f0: 6c66 2e6e 756d 6265 7246 5365 6c65 6374  lf.numberFSelect
-00026a00: 696f 6e5b 345d 0a20 2020 2020 2020 2020  ion[4].         
-00026a10: 2020 2020 2020 2020 2020 2073 6420 3d20             sd = 
-00026a20: 7365 6c66 2e6e 756d 6265 7246 5365 6c65  self.numberFSele
-00026a30: 6374 696f 6e5b 355d 0a0a 2020 2020 2020  ction[5]..      
-00026a40: 2020 2020 2020 2020 2020 2020 2020 6675                fu
-00026a50: 6e63 5b27 4127 5d20 3d20 410a 2020 2020  nc['A'] = A.    
-00026a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026a70: 6675 6e63 5b27 4227 5d20 3d20 420a 2020  func['B'] = B.  
-00026a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026a90: 2020 6675 6e63 5b27 4327 5d20 3d20 430a    func['C'] = C.
-00026aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026ab0: 2020 2020 6675 6e63 5b27 4427 5d20 3d20      func['D'] = 
-00026ac0: 440a 2020 2020 2020 2020 2020 2020 2020  D.              
-00026ad0: 2020 2020 2020 6675 6e63 5b27 7830 275d        func['x0']
-00026ae0: 203d 2078 300a 2020 2020 2020 2020 2020   = x0.          
-00026af0: 2020 2020 2020 2020 2020 6675 6e63 5b27            func['
-00026b00: 7364 275d 203d 2073 640a 0a20 2020 2020  sd'] = sd..     
-00026b10: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00026b20: 6620 7364 203c 3d20 302e 303a 0a20 2020  f sd <= 0.0:.   
-00026b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026b40: 2020 2020 2076 616c 6964 203d 2046 616c       valid = Fal
-00026b50: 7365 0a20 2020 2020 2020 2020 2020 2020  se.             
-00026b60: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00026b70: 5f5f 662e 6170 7065 6e64 2866 225b 496e  __f.append(f"[In
-00026b80: 7661 6c69 6420 6461 7461 5d20 7b73 656c  valid data] {sel
-00026b90: 662e 5f5f 6765 7443 7572 7265 6e74 5265  f.__getCurrentRe
-00026ba0: 7374 7261 696e 7428 297d 220a 2020 2020  straint()}".    
-00026bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026bd0: 2020 2020 6622 7b66 756e 6354 7970 657d      f"{funcType}
-00026be0: 2073 7461 6e64 6172 6420 6465 7669 6174   standard deviat
-00026bf0: 696f 6e20 2773 643d 7b73 647d 2720 6d75  ion 'sd={sd}' mu
-00026c00: 7374 2062 6520 6120 706f 7369 7469 7665  st be a positive
-00026c10: 2076 616c 7565 2e22 290a 0a20 2020 2020   value.")..     
-00026c20: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00026c30: 2020 2320 7731 206d 6561 6e31 2073 6431    # w1 mean1 sd1
-00026c40: 2077 3220 6d65 616e 3220 7364 320a 2020   w2 mean2 sd2.  
-00026c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026c60: 2020 6675 6e63 5479 7065 203d 2027 534f    funcType = 'SO
-00026c70: 4544 494e 4746 554e 4327 0a20 2020 2020  EDINGFUNC'.     
-00026c80: 2020 2020 2020 2020 2020 2020 2020 2077                 w
-00026c90: 3120 3d20 7365 6c66 2e6e 756d 6265 7246  1 = self.numberF
-00026ca0: 5365 6c65 6374 696f 6e5b 305d 0a20 2020  Selection[0].   
-00026cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026cc0: 206d 6561 6e31 203d 2073 656c 662e 6e75   mean1 = self.nu
-00026cd0: 6d62 6572 4653 656c 6563 7469 6f6e 5b31  mberFSelection[1
-00026ce0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00026cf0: 2020 2020 2020 7364 3120 3d20 7365 6c66        sd1 = self
-00026d00: 2e6e 756d 6265 7246 5365 6c65 6374 696f  .numberFSelectio
-00026d10: 6e5b 325d 0a20 2020 2020 2020 2020 2020  n[2].           
-00026d20: 2020 2020 2020 2020 2077 3220 3d20 7365           w2 = se
-00026d30: 6c66 2e6e 756d 6265 7246 5365 6c65 6374  lf.numberFSelect
-00026d40: 696f 6e5b 335d 0a20 2020 2020 2020 2020  ion[3].         
-00026d50: 2020 2020 2020 2020 2020 206d 6561 6e32             mean2
-00026d60: 203d 2073 656c 662e 6e75 6d62 6572 4653   = self.numberFS
-00026d70: 656c 6563 7469 6f6e 5b34 5d0a 2020 2020  election[4].    
+000264e0: 2020 7661 6c69 6420 3d20 4661 6c73 650a    valid = False.
+000264f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026500: 2020 2020 2020 2020 7365 6c66 2e5f 5f66          self.__f
+00026510: 2e61 7070 656e 6428 6622 5b49 6e76 616c  .append(f"[Inval
+00026520: 6964 2064 6174 615d 207b 7365 6c66 2e5f  id data] {self._
+00026530: 5f67 6574 4375 7272 656e 7452 6573 7472  _getCurrentRestr
+00026540: 6169 6e74 2829 7d22 0a20 2020 2020 2020  aint()}".       
+00026550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026570: 2066 227b 6675 6e63 5479 7065 7d20 7374   f"{funcType} st
+00026580: 616e 6461 7264 2064 6576 6961 7469 6f6e  andard deviation
+00026590: 2027 6267 5f73 643d 7b62 675f 7364 7d27   'bg_sd={bg_sd}'
+000265a0: 206f 6620 6828 7229 2066 756e 6374 696f   of h(r) functio
+000265b0: 6e20 6d75 7374 2062 6520 6120 706f 7369  n must be a posi
+000265c0: 7469 7665 2076 616c 7565 2e22 290a 0a20  tive value.").. 
+000265d0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000265e0: 6c69 6620 6374 782e 4b41 5250 4c55 5328  lif ctx.KARPLUS(
+000265f0: 293a 2020 2320 4120 4220 4320 4420 7830  ):  # A B C D x0
+00026600: 2073 640a 2020 2020 2020 2020 2020 2020   sd.            
+00026610: 2020 2020 2020 2020 6675 6e63 5479 7065          funcType
+00026620: 203d 2027 4b41 5250 4c55 5327 0a20 2020   = 'KARPLUS'.   
+00026630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026640: 2041 203d 2073 656c 662e 6e75 6d62 6572   A = self.number
+00026650: 4653 656c 6563 7469 6f6e 5b30 5d0a 2020  FSelection[0].  
+00026660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026670: 2020 4220 3d20 7365 6c66 2e6e 756d 6265    B = self.numbe
+00026680: 7246 5365 6c65 6374 696f 6e5b 315d 0a20  rFSelection[1]. 
+00026690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000266a0: 2020 2043 203d 2073 656c 662e 6e75 6d62     C = self.numb
+000266b0: 6572 4653 656c 6563 7469 6f6e 5b32 5d0a  erFSelection[2].
+000266c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000266d0: 2020 2020 4420 3d20 7365 6c66 2e6e 756d      D = self.num
+000266e0: 6265 7246 5365 6c65 6374 696f 6e5b 335d  berFSelection[3]
+000266f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00026700: 2020 2020 2078 3020 3d20 7365 6c66 2e6e       x0 = self.n
+00026710: 756d 6265 7246 5365 6c65 6374 696f 6e5b  umberFSelection[
+00026720: 345d 0a20 2020 2020 2020 2020 2020 2020  4].             
+00026730: 2020 2020 2020 2073 6420 3d20 7365 6c66         sd = self
+00026740: 2e6e 756d 6265 7246 5365 6c65 6374 696f  .numberFSelectio
+00026750: 6e5b 355d 0a0a 2020 2020 2020 2020 2020  n[5]..          
+00026760: 2020 2020 2020 2020 2020 6675 6e63 5b27            func['
+00026770: 4127 5d20 3d20 410a 2020 2020 2020 2020  A'] = A.        
+00026780: 2020 2020 2020 2020 2020 2020 6675 6e63              func
+00026790: 5b27 4227 5d20 3d20 420a 2020 2020 2020  ['B'] = B.      
+000267a0: 2020 2020 2020 2020 2020 2020 2020 6675                fu
+000267b0: 6e63 5b27 4327 5d20 3d20 430a 2020 2020  nc['C'] = C.    
+000267c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000267d0: 6675 6e63 5b27 4427 5d20 3d20 440a 2020  func['D'] = D.  
+000267e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000267f0: 2020 6675 6e63 5b27 7830 275d 203d 2078    func['x0'] = x
+00026800: 300a 2020 2020 2020 2020 2020 2020 2020  0.              
+00026810: 2020 2020 2020 6675 6e63 5b27 7364 275d        func['sd']
+00026820: 203d 2073 640a 0a20 2020 2020 2020 2020   = sd..         
+00026830: 2020 2020 2020 2020 2020 2069 6620 7364             if sd
+00026840: 203c 3d20 302e 303a 0a20 2020 2020 2020   <= 0.0:.       
+00026850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026860: 2076 616c 6964 203d 2046 616c 7365 0a20   valid = False. 
+00026870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026880: 2020 2020 2020 2073 656c 662e 5f5f 662e         self.__f.
+00026890: 6170 7065 6e64 2866 225b 496e 7661 6c69  append(f"[Invali
+000268a0: 6420 6461 7461 5d20 7b73 656c 662e 5f5f  d data] {self.__
+000268b0: 6765 7443 7572 7265 6e74 5265 7374 7261  getCurrentRestra
+000268c0: 696e 7428 297d 220a 2020 2020 2020 2020  int()}".        
+000268d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000268e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000268f0: 6622 7b66 756e 6354 7970 657d 2073 7461  f"{funcType} sta
+00026900: 6e64 6172 6420 6465 7669 6174 696f 6e20  ndard deviation 
+00026910: 2773 643d 7b73 647d 2720 6d75 7374 2062  'sd={sd}' must b
+00026920: 6520 6120 706f 7369 7469 7665 2076 616c  e a positive val
+00026930: 7565 2e22 290a 0a20 2020 2020 2020 2020  ue.")..         
+00026940: 2020 2020 2020 2065 6c73 653a 2020 2320         else:  # 
+00026950: 7731 206d 6561 6e31 2073 6431 2077 3220  w1 mean1 sd1 w2 
+00026960: 6d65 616e 3220 7364 320a 2020 2020 2020  mean2 sd2.      
+00026970: 2020 2020 2020 2020 2020 2020 2020 6675                fu
+00026980: 6e63 5479 7065 203d 2027 534f 4544 494e  ncType = 'SOEDIN
+00026990: 4746 554e 4327 0a20 2020 2020 2020 2020  GFUNC'.         
+000269a0: 2020 2020 2020 2020 2020 2077 3120 3d20             w1 = 
+000269b0: 7365 6c66 2e6e 756d 6265 7246 5365 6c65  self.numberFSele
+000269c0: 6374 696f 6e5b 305d 0a20 2020 2020 2020  ction[0].       
+000269d0: 2020 2020 2020 2020 2020 2020 206d 6561               mea
+000269e0: 6e31 203d 2073 656c 662e 6e75 6d62 6572  n1 = self.number
+000269f0: 4653 656c 6563 7469 6f6e 5b31 5d0a 2020  FSelection[1].  
+00026a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026a10: 2020 7364 3120 3d20 7365 6c66 2e6e 756d    sd1 = self.num
+00026a20: 6265 7246 5365 6c65 6374 696f 6e5b 325d  berFSelection[2]
+00026a30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00026a40: 2020 2020 2077 3220 3d20 7365 6c66 2e6e       w2 = self.n
+00026a50: 756d 6265 7246 5365 6c65 6374 696f 6e5b  umberFSelection[
+00026a60: 335d 0a20 2020 2020 2020 2020 2020 2020  3].             
+00026a70: 2020 2020 2020 206d 6561 6e32 203d 2073         mean2 = s
+00026a80: 656c 662e 6e75 6d62 6572 4653 656c 6563  elf.numberFSelec
+00026a90: 7469 6f6e 5b34 5d0a 2020 2020 2020 2020  tion[4].        
+00026aa0: 2020 2020 2020 2020 2020 2020 7364 3220              sd2 
+00026ab0: 3d20 7365 6c66 2e6e 756d 6265 7246 5365  = self.numberFSe
+00026ac0: 6c65 6374 696f 6e5b 355d 0a0a 2020 2020  lection[5]..    
+00026ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026ae0: 6675 6e63 5b27 7731 275d 203d 2077 310a  func['w1'] = w1.
+00026af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026b00: 2020 2020 6675 6e63 5b27 6d65 616e 3127      func['mean1'
+00026b10: 5d20 3d20 6d65 616e 310a 2020 2020 2020  ] = mean1.      
+00026b20: 2020 2020 2020 2020 2020 2020 2020 6675                fu
+00026b30: 6e63 5b27 7364 3127 5d20 3d20 7364 310a  nc['sd1'] = sd1.
+00026b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026b50: 2020 2020 6675 6e63 5b27 7732 275d 203d      func['w2'] =
+00026b60: 2077 320a 2020 2020 2020 2020 2020 2020   w2.            
+00026b70: 2020 2020 2020 2020 6675 6e63 5b27 6d65          func['me
+00026b80: 616e 3227 5d20 3d20 6d65 616e 320a 2020  an2'] = mean2.  
+00026b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026ba0: 2020 6675 6e63 5b27 7364 3227 5d20 3d20    func['sd2'] = 
+00026bb0: 7364 320a 0a20 2020 2020 2020 2020 2020  sd2..           
+00026bc0: 2020 2020 2020 2020 2069 6620 7731 203c           if w1 <
+00026bd0: 2030 2e30 3a0a 2020 2020 2020 2020 2020   0.0:.          
+00026be0: 2020 2020 2020 2020 2020 2020 2020 7661                va
+00026bf0: 6c69 6420 3d20 4661 6c73 650a 2020 2020  lid = False.    
+00026c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026c10: 2020 2020 7365 6c66 2e5f 5f66 2e61 7070      self.__f.app
+00026c20: 656e 6428 6622 5b49 6e76 616c 6964 2064  end(f"[Invalid d
+00026c30: 6174 615d 207b 7365 6c66 2e5f 5f67 6574  ata] {self.__get
+00026c40: 4375 7272 656e 7452 6573 7472 6169 6e74  CurrentRestraint
+00026c50: 2829 7d22 0a20 2020 2020 2020 2020 2020  ()}".           
+00026c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026c70: 2020 2020 2020 2020 2020 2020 2066 227b               f"{
+00026c80: 6675 6e63 5479 7065 7d20 7765 6967 6874  funcType} weight
+00026c90: 206f 6620 7468 6520 3173 7420 4761 7573   of the 1st Gaus
+00026ca0: 7369 616e 2066 756e 6374 696f 6e20 2777  sian function 'w
+00026cb0: 313d 7b77 317d 2720 6d75 7374 206e 6f74  1={w1}' must not
+00026cc0: 2062 6520 6120 6e65 6761 7469 7665 2076   be a negative v
+00026cd0: 616c 7565 2e22 290a 2020 2020 2020 2020  alue.").        
+00026ce0: 2020 2020 2020 2020 2020 2020 6966 2077              if w
+00026cf0: 3220 3c20 302e 303a 0a20 2020 2020 2020  2 < 0.0:.       
+00026d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026d10: 2076 616c 6964 203d 2046 616c 7365 0a20   valid = False. 
+00026d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026d30: 2020 2020 2020 2073 656c 662e 5f5f 662e         self.__f.
+00026d40: 6170 7065 6e64 2866 225b 496e 7661 6c69  append(f"[Invali
+00026d50: 6420 6461 7461 5d20 7b73 656c 662e 5f5f  d data] {self.__
+00026d60: 6765 7443 7572 7265 6e74 5265 7374 7261  getCurrentRestra
+00026d70: 696e 7428 297d 220a 2020 2020 2020 2020  int()}".        
 00026d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026d90: 7364 3220 3d20 7365 6c66 2e6e 756d 6265  sd2 = self.numbe
-00026da0: 7246 5365 6c65 6374 696f 6e5b 355d 0a0a  rFSelection[5]..
-00026db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026dc0: 2020 2020 6675 6e63 5b27 7731 275d 203d      func['w1'] =
-00026dd0: 2077 310a 2020 2020 2020 2020 2020 2020   w1.            
-00026de0: 2020 2020 2020 2020 6675 6e63 5b27 6d65          func['me
-00026df0: 616e 3127 5d20 3d20 6d65 616e 310a 2020  an1'] = mean1.  
-00026e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026e10: 2020 6675 6e63 5b27 7364 3127 5d20 3d20    func['sd1'] = 
-00026e20: 7364 310a 2020 2020 2020 2020 2020 2020  sd1.            
-00026e30: 2020 2020 2020 2020 6675 6e63 5b27 7732          func['w2
-00026e40: 275d 203d 2077 320a 2020 2020 2020 2020  '] = w2.        
-00026e50: 2020 2020 2020 2020 2020 2020 6675 6e63              func
-00026e60: 5b27 6d65 616e 3227 5d20 3d20 6d65 616e  ['mean2'] = mean
-00026e70: 320a 2020 2020 2020 2020 2020 2020 2020  2.              
-00026e80: 2020 2020 2020 6675 6e63 5b27 7364 3227        func['sd2'
-00026e90: 5d20 3d20 7364 320a 0a20 2020 2020 2020  ] = sd2..       
-00026ea0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00026eb0: 7731 203c 2030 2e30 3a0a 2020 2020 2020  w1 < 0.0:.      
-00026ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026ed0: 2020 7661 6c69 6420 3d20 4661 6c73 650a    valid = False.
-00026ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026ef0: 2020 2020 2020 2020 7365 6c66 2e5f 5f66          self.__f
-00026f00: 2e61 7070 656e 6428 6622 5b49 6e76 616c  .append(f"[Inval
-00026f10: 6964 2064 6174 615d 207b 7365 6c66 2e5f  id data] {self._
-00026f20: 5f67 6574 4375 7272 656e 7452 6573 7472  _getCurrentRestr
-00026f30: 6169 6e74 2829 7d22 0a20 2020 2020 2020  aint()}".       
-00026f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026da0: 6622 7b66 756e 6354 7970 657d 2077 6569  f"{funcType} wei
+00026db0: 6768 7420 6f66 2074 6865 2032 6e64 2047  ght of the 2nd G
+00026dc0: 6175 7373 6961 6e20 6675 6e63 7469 6f6e  aussian function
+00026dd0: 2027 7732 3d7b 7732 7d27 206d 7573 7420   'w2={w2}' must 
+00026de0: 6e6f 7420 6265 2061 206e 6567 6174 6976  not be a negativ
+00026df0: 6520 7661 6c75 652e 2229 0a20 2020 2020  e value.").     
+00026e00: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00026e10: 6620 7364 3120 3c3d 2030 2e30 3a0a 2020  f sd1 <= 0.0:.  
+00026e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026e30: 2020 2020 2020 7661 6c69 6420 3d20 4661        valid = Fa
+00026e40: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
+00026e50: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00026e60: 2e5f 5f66 2e61 7070 656e 6428 6622 5b49  .__f.append(f"[I
+00026e70: 6e76 616c 6964 2064 6174 615d 207b 7365  nvalid data] {se
+00026e80: 6c66 2e5f 5f67 6574 4375 7272 656e 7452  lf.__getCurrentR
+00026e90: 6573 7472 6169 6e74 2829 7d22 0a20 2020  estraint()}".   
+00026ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026ec0: 2020 2020 2066 227b 6675 6e63 5479 7065       f"{funcType
+00026ed0: 7d20 7374 616e 6461 7264 2064 6576 6961  } standard devia
+00026ee0: 7469 6f6e 206f 6620 7468 6520 3173 7420  tion of the 1st 
+00026ef0: 4761 7573 7369 616e 2066 756e 6374 696f  Gaussian functio
+00026f00: 6e20 2773 6431 3d7b 7364 317d 2720 6d75  n 'sd1={sd1}' mu
+00026f10: 7374 2062 6520 6120 706f 7369 7469 7665  st be a positive
+00026f20: 2076 616c 7565 2e22 290a 2020 2020 2020   value.").      
+00026f30: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00026f40: 2073 6432 203c 3d20 302e 303a 0a20 2020   sd2 <= 0.0:.   
 00026f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026f60: 2066 227b 6675 6e63 5479 7065 7d20 7765   f"{funcType} we
-00026f70: 6967 6874 206f 6620 7468 6520 3173 7420  ight of the 1st 
-00026f80: 4761 7573 7369 616e 2066 756e 6374 696f  Gaussian functio
-00026f90: 6e20 2777 313d 7b77 317d 2720 6d75 7374  n 'w1={w1}' must
-00026fa0: 206e 6f74 2062 6520 6120 6e65 6761 7469   not be a negati
-00026fb0: 7665 2076 616c 7565 2e22 290a 2020 2020  ve value.").    
-00026fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026fd0: 6966 2077 3220 3c20 302e 303a 0a20 2020  if w2 < 0.0:.   
+00026f60: 2020 2020 2076 616c 6964 203d 2046 616c       valid = Fal
+00026f70: 7365 0a20 2020 2020 2020 2020 2020 2020  se.             
+00026f80: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00026f90: 5f5f 662e 6170 7065 6e64 2866 225b 496e  __f.append(f"[In
+00026fa0: 7661 6c69 6420 6461 7461 5d20 7b73 656c  valid data] {sel
+00026fb0: 662e 5f5f 6765 7443 7572 7265 6e74 5265  f.__getCurrentRe
+00026fc0: 7374 7261 696e 7428 297d 220a 2020 2020  straint()}".    
+00026fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00026fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026ff0: 2020 2020 2076 616c 6964 203d 2046 616c       valid = Fal
-00027000: 7365 0a20 2020 2020 2020 2020 2020 2020  se.             
-00027010: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00027020: 5f5f 662e 6170 7065 6e64 2866 225b 496e  __f.append(f"[In
-00027030: 7661 6c69 6420 6461 7461 5d20 7b73 656c  valid data] {sel
-00027040: 662e 5f5f 6765 7443 7572 7265 6e74 5265  f.__getCurrentRe
-00027050: 7374 7261 696e 7428 297d 220a 2020 2020  straint()}".    
-00027060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027080: 2020 2020 6622 7b66 756e 6354 7970 657d      f"{funcType}
-00027090: 2077 6569 6768 7420 6f66 2074 6865 2032   weight of the 2
-000270a0: 6e64 2047 6175 7373 6961 6e20 6675 6e63  nd Gaussian func
-000270b0: 7469 6f6e 2027 7732 3d7b 7732 7d27 206d  tion 'w2={w2}' m
-000270c0: 7573 7420 6e6f 7420 6265 2061 206e 6567  ust not be a neg
-000270d0: 6174 6976 6520 7661 6c75 652e 2229 0a20  ative value."). 
-000270e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000270f0: 2020 2069 6620 7364 3120 3c3d 2030 2e30     if sd1 <= 0.0
-00027100: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00027110: 2020 2020 2020 2020 2020 7661 6c69 6420            valid 
-00027120: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
-00027130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027140: 7365 6c66 2e5f 5f66 2e61 7070 656e 6428  self.__f.append(
-00027150: 6622 5b49 6e76 616c 6964 2064 6174 615d  f"[Invalid data]
-00027160: 207b 7365 6c66 2e5f 5f67 6574 4375 7272   {self.__getCurr
-00027170: 656e 7452 6573 7472 6169 6e74 2829 7d22  entRestraint()}"
-00027180: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000271a0: 2020 2020 2020 2020 2066 227b 6675 6e63           f"{func
-000271b0: 5479 7065 7d20 7374 616e 6461 7264 2064  Type} standard d
-000271c0: 6576 6961 7469 6f6e 206f 6620 7468 6520  eviation of the 
-000271d0: 3173 7420 4761 7573 7369 616e 2066 756e  1st Gaussian fun
-000271e0: 6374 696f 6e20 2773 6431 3d7b 7364 317d  ction 'sd1={sd1}
-000271f0: 2720 6d75 7374 2062 6520 6120 706f 7369  ' must be a posi
-00027200: 7469 7665 2076 616c 7565 2e22 290a 2020  tive value.").  
-00027210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027220: 2020 6966 2073 6432 203c 3d20 302e 303a    if sd2 <= 0.0:
-00027230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027240: 2020 2020 2020 2020 2076 616c 6964 203d           valid =
-00027250: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
-00027260: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00027270: 656c 662e 5f5f 662e 6170 7065 6e64 2866  elf.__f.append(f
-00027280: 225b 496e 7661 6c69 6420 6461 7461 5d20  "[Invalid data] 
-00027290: 7b73 656c 662e 5f5f 6765 7443 7572 7265  {self.__getCurre
-000272a0: 6e74 5265 7374 7261 696e 7428 297d 220a  ntRestraint()}".
-000272b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000272c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000272d0: 2020 2020 2020 2020 6622 7b66 756e 6354          f"{funcT
-000272e0: 7970 657d 2073 7461 6e64 6172 6420 6465  ype} standard de
-000272f0: 7669 6174 696f 6e20 6f66 2074 6865 2032  viation of the 2
-00027300: 6e64 2047 6175 7373 6961 6e20 6675 6e63  nd Gaussian func
-00027310: 7469 6f6e 2027 7364 323d 7b73 6432 7d27  tion 'sd2={sd2}'
-00027320: 206d 7573 7420 6265 2061 2070 6f73 6974   must be a posit
-00027330: 6976 6520 7661 6c75 652e 2229 0a0a 2020  ive value.")..  
-00027340: 2020 2020 2020 2020 2020 656c 6966 2063            elif c
-00027350: 7478 2e43 4f4e 5354 414e 5446 554e 4328  tx.CONSTANTFUNC(
-00027360: 293a 2020 2320 7265 7475 726e 5f76 616c  ):  # return_val
-00027370: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027380: 2066 756e 6354 7970 6520 3d20 2743 4f4e   funcType = 'CON
-00027390: 5354 414e 5446 554e 4327 0a20 2020 2020  STANTFUNC'.     
-000273a0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-000273b0: 6e5f 7661 6c20 3d20 7365 6c66 2e6e 756d  n_val = self.num
-000273c0: 6265 7246 5365 6c65 6374 696f 6e5b 305d  berFSelection[0]
-000273d0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000273e0: 2020 6675 6e63 5b27 6e61 6d65 275d 203d    func['name'] =
-000273f0: 2066 756e 6354 7970 650a 2020 2020 2020   funcType.      
-00027400: 2020 2020 2020 2020 2020 6675 6e63 5b27            func['
-00027410: 7265 7475 726e 5f76 616c 275d 203d 2072  return_val'] = r
-00027420: 6574 7572 6e5f 7661 6c0a 0a20 2020 2020  eturn_val..     
-00027430: 2020 2020 2020 2065 6c69 6620 6374 782e         elif ctx.
-00027440: 4944 454e 5449 5459 2829 3a0a 2020 2020  IDENTITY():.    
-00027450: 2020 2020 2020 2020 2020 2020 6675 6e63              func
-00027460: 5b27 6e61 6d65 275d 203d 2027 4944 454e  ['name'] = 'IDEN
-00027470: 5449 5459 270a 0a20 2020 2020 2020 2020  TITY'..         
-00027480: 2020 2065 6c69 6620 6374 782e 5343 414c     elif ctx.SCAL
-00027490: 4152 5745 4947 4854 4544 4655 4e43 2829  ARWEIGHTEDFUNC()
-000274a0: 3a20 2023 2077 6569 6768 7420 6675 6e63  :  # weight func
-000274b0: 5f74 7970 655f 6465 660a 2020 2020 2020  _type_def.      
-000274c0: 2020 2020 2020 2020 2020 6675 6e63 5479            funcTy
-000274d0: 7065 203d 2027 5343 414c 4152 5745 4947  pe = 'SCALARWEIG
-000274e0: 4854 4544 4655 4e43 270a 2020 2020 2020  HTEDFUNC'.      
-000274f0: 2020 2020 2020 2020 2020 7765 6967 6874            weight
-00027500: 203d 2073 656c 662e 6e75 6d62 6572 4653   = self.numberFS
-00027510: 656c 6563 7469 6f6e 5b30 5d0a 0a20 2020  election[0]..   
-00027520: 2020 2020 2020 2020 2020 2020 2066 756e               fun
-00027530: 635b 276e 616d 6527 5d20 3d20 6675 6e63  c['name'] = func
-00027540: 5479 7065 0a20 2020 2020 2020 2020 2020  Type.           
-00027550: 2020 2020 2066 756e 635b 2777 6569 6768       func['weigh
-00027560: 7427 5d20 3d20 7765 6967 6874 0a0a 2020  t'] = weight..  
-00027570: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00027580: 2077 6569 6768 7420 3c20 302e 303a 0a20   weight < 0.0:. 
-00027590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000275a0: 2020 2076 616c 6964 203d 2046 616c 7365     valid = False
-000275b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000275c0: 2020 2020 2073 656c 662e 5f5f 662e 6170       self.__f.ap
-000275d0: 7065 6e64 2866 225b 496e 7661 6c69 6420  pend(f"[Invalid 
-000275e0: 6461 7461 5d20 7b73 656c 662e 5f5f 6765  data] {self.__ge
-000275f0: 7443 7572 7265 6e74 5265 7374 7261 696e  tCurrentRestrain
-00027600: 7428 297d 220a 2020 2020 2020 2020 2020  t()}".          
-00027610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027620: 2020 2020 2020 2020 2020 6622 7b66 756e            f"{fun
-00027630: 6354 7970 657d 2027 7765 6967 6874 3d7b  cType} 'weight={
-00027640: 7765 6967 6874 7d27 206f 6620 7b6e 2b31  weight}' of {n+1
-00027650: 7d74 6820 6675 6e63 7469 6f6e 206d 7573  }th function mus
-00027660: 7420 6e6f 7420 6265 2061 206e 6567 6174  t not be a negat
-00027670: 6976 6520 7661 6c75 652e 2229 0a20 2020  ive value.").   
-00027680: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-00027690: 6620 7765 6967 6874 203d 3d20 302e 303a  f weight == 0.0:
-000276a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000276b0: 2020 2020 2073 656c 662e 5f5f 662e 6170       self.__f.ap
-000276c0: 7065 6e64 2866 225b 5261 6e67 6520 7661  pend(f"[Range va
-000276d0: 6c75 6520 7761 726e 696e 675d 207b 7365  lue warning] {se
-000276e0: 6c66 2e5f 5f67 6574 4375 7272 656e 7452  lf.__getCurrentR
-000276f0: 6573 7472 6169 6e74 2829 7d22 0a20 2020  estraint()}".   
-00027700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027720: 2066 227b 6675 6e63 5479 7065 7d20 2777   f"{funcType} 'w
-00027730: 6569 6768 743d 7b77 6569 6768 747d 2720  eight={weight}' 
-00027740: 6f66 207b 6e2b 317d 7468 2066 756e 6374  of {n+1}th funct
-00027750: 696f 6e20 7368 6f75 6c64 2062 6520 6120  ion should be a 
-00027760: 706f 7369 7469 7665 2076 616c 7565 2e22  positive value."
-00027770: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-00027780: 2020 2066 756e 635b 2766 756e 635f 7479     func['func_ty
-00027790: 7065 7327 5d20 3d20 5b5d 0a0a 2020 2020  pes'] = []..    
-000277a0: 2020 2020 2020 2020 656c 6966 2063 7478          elif ctx
-000277b0: 2e53 554d 4655 4e43 2829 3a20 2023 206e  .SUMFUNC():  # n
-000277c0: 5f66 756e 6373 2046 756e 635f 5479 7065  _funcs Func_Type
-000277d0: 3120 4675 6e63 5f44 6566 3120 5b46 756e  1 Func_Def1 [Fun
-000277e0: 635f 5479 7065 3220 4675 6e63 5f44 6566  c_Type2 Func_Def
-000277f0: 3220 5b2e 2e2e 5d5d 0a20 2020 2020 2020  2 [...]].       
-00027800: 2020 2020 2020 2020 2066 756e 6354 7970           funcTyp
-00027810: 6520 3d20 2753 554d 4655 4e43 270a 2020  e = 'SUMFUNC'.  
-00027820: 2020 2020 2020 2020 2020 2020 2020 6e5f                n_
-00027830: 6675 6e63 7320 3d20 696e 7428 7374 7228  funcs = int(str(
-00027840: 6374 782e 496e 7465 6765 7228 2929 290a  ctx.Integer())).
-00027850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027860: 2066 756e 635b 276e 616d 6527 5d20 3d20   func['name'] = 
-00027870: 6675 6e63 5479 7065 0a20 2020 2020 2020  funcType.       
-00027880: 2020 2020 2020 2020 2066 756e 635b 276e           func['n
-00027890: 5f66 756e 6373 275d 203d 206e 5f66 756e  _funcs'] = n_fun
-000278a0: 6373 0a0a 2020 2020 2020 2020 2020 2020  cs..            
-000278b0: 2020 2020 6966 206e 5f66 756e 6373 203c      if n_funcs <
-000278c0: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
-000278d0: 2020 2020 2020 2020 2076 616c 6964 203d           valid =
-000278e0: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
-000278f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00027900: 5f5f 662e 6170 7065 6e64 2866 225b 496e  __f.append(f"[In
-00027910: 7661 6c69 6420 6461 7461 5d20 7b73 656c  valid data] {sel
-00027920: 662e 5f5f 6765 7443 7572 7265 6e74 5265  f.__getCurrentRe
-00027930: 7374 7261 696e 7428 297d 220a 2020 2020  straint()}".    
-00027940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027960: 6622 7b66 756e 6354 7970 657d 2074 6865  f"{funcType} the
-00027970: 206e 756d 6265 7220 6f66 2066 756e 6374   number of funct
-00027980: 696f 6e73 2027 6e5f 6675 6e63 733d 7b6e  ions 'n_funcs={n
-00027990: 5f66 756e 6373 7d27 206d 7573 7420 6265  _funcs}' must be
-000279a0: 2061 2070 6f73 6974 6976 6520 7661 6c75   a positive valu
-000279b0: 652e 2229 0a20 2020 2020 2020 2020 2020  e.").           
-000279c0: 2020 2020 2065 6c69 6620 6374 782e 6675       elif ctx.fu
-000279d0: 6e63 5f74 7970 655f 6465 6628 6e5f 6675  nc_type_def(n_fu
-000279e0: 6e63 7320 2d20 3129 3a0a 2020 2020 2020  ncs - 1):.      
-000279f0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-00027a00: 7373 0a20 2020 2020 2020 2020 2020 2020  ss.             
-00027a10: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00027a20: 2020 2020 2020 2020 2020 2020 2076 616c               val
-00027a30: 6964 203d 2046 616c 7365 0a20 2020 2020  id = False.     
-00027a40: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00027a50: 656c 662e 5f5f 662e 6170 7065 6e64 2866  elf.__f.append(f
-00027a60: 225b 496e 7661 6c69 6420 6461 7461 5d20  "[Invalid data] 
-00027a70: 7b73 656c 662e 5f5f 6765 7443 7572 7265  {self.__getCurre
-00027a80: 6e74 5265 7374 7261 696e 7428 297d 220a  ntRestraint()}".
-00027a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027ab0: 2020 2020 6622 7b66 756e 6354 7970 657d      f"{funcType}
-00027ac0: 2072 6571 7569 7265 7320 7b6e 5f66 756e   requires {n_fun
-00027ad0: 6373 7d20 6675 6e63 7469 6f6e 2064 6566  cs} function def
-00027ae0: 696e 6974 696f 6e73 2061 6674 6572 2074  initions after t
-00027af0: 6865 2066 6972 7374 2027 6e5f 6675 6e63  he first 'n_func
-00027b00: 7327 2076 616c 7565 2e22 290a 0a20 2020  s' value.")..   
-00027b10: 2020 2020 2020 2020 2020 2020 2066 756e               fun
-00027b20: 635b 2766 756e 635f 7479 7065 7327 5d20  c['func_types'] 
-00027b30: 3d20 5b5d 0a0a 2020 2020 2020 2020 2020  = []..          
-00027b40: 2020 656c 6966 2063 7478 2e53 504c 494e    elif ctx.SPLIN
-00027b50: 4528 293a 2020 2320 6465 7363 7269 7074  E():  # descript
-00027b60: 696f 6e20 284e 4f4e 4529 2065 7870 6572  ion (NONE) exper
-00027b70: 696d 656e 7461 6c5f 7661 6c75 6520 7765  imental_value we
-00027b80: 6967 6874 2062 696e 5f73 697a 6520 2878  ight bin_size (x
-00027b90: 5f61 7869 7320 7661 6c2a 292b 0a20 2020  _axis val*)+.   
-00027ba0: 2020 2020 2020 2020 2020 2020 2066 756e               fun
-00027bb0: 6354 7970 6520 3d20 2753 504c 494e 4527  cType = 'SPLINE'
-00027bc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027bd0: 2064 6573 6372 6970 7469 6f6e 203d 2073   description = s
-00027be0: 7472 2863 7478 2e53 696d 706c 655f 6e61  tr(ctx.Simple_na
-00027bf0: 6d65 2830 2929 0a20 2020 2020 2020 2020  me(0)).         
-00027c00: 2020 2020 2020 2065 7870 6572 696d 656e         experimen
-00027c10: 7461 6c5f 7661 6c75 6520 3d20 7365 6c66  tal_value = self
-00027c20: 2e6e 756d 6265 7246 5365 6c65 6374 696f  .numberFSelectio
-00027c30: 6e5b 305d 0a20 2020 2020 2020 2020 2020  n[0].           
-00027c40: 2020 2020 2077 6569 6768 7420 3d20 7365       weight = se
-00027c50: 6c66 2e6e 756d 6265 7246 5365 6c65 6374  lf.numberFSelect
-00027c60: 696f 6e5b 315d 0a20 2020 2020 2020 2020  ion[1].         
-00027c70: 2020 2020 2020 2062 696e 5f73 697a 6520         bin_size 
-00027c80: 3d20 7365 6c66 2e6e 756d 6265 7246 5365  = self.numberFSe
-00027c90: 6c65 6374 696f 6e5b 325d 0a0a 2020 2020  lection[2]..    
-00027ca0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
-00027cb0: 5b27 6e61 6d65 275d 203d 2066 756e 6354  ['name'] = funcT
-00027cc0: 7970 650a 2020 2020 2020 2020 2020 2020  ype.            
-00027cd0: 2020 2020 6675 6e63 5b27 6465 7363 7269      func['descri
-00027ce0: 7074 696f 6e27 5d20 3d20 6465 7363 7269  ption'] = descri
-00027cf0: 7074 696f 6e0a 2020 2020 2020 2020 2020  ption.          
-00027d00: 2020 2020 2020 6675 6e63 5b27 6578 7065        func['expe
-00027d10: 7269 6d65 6e74 616c 5f76 616c 7565 275d  rimental_value']
-00027d20: 203d 2065 7870 6572 696d 656e 7461 6c5f   = experimental_
-00027d30: 7661 6c75 650a 2020 2020 2020 2020 2020  value.          
-00027d40: 2020 2020 2020 6675 6e63 5b27 7765 6967        func['weig
-00027d50: 6874 275d 203d 2077 6569 6768 740a 2020  ht'] = weight.  
-00027d60: 2020 2020 2020 2020 2020 2020 2020 6675                fu
-00027d70: 6e63 5b27 6269 6e5f 7369 7a65 275d 203d  nc['bin_size'] =
-00027d80: 2062 696e 5f73 697a 650a 0a20 2020 2020   bin_size..     
-00027d90: 2020 2020 2020 2020 2020 2069 6620 7765             if we
-00027da0: 6967 6874 203c 2030 2e30 3a0a 2020 2020  ight < 0.0:.    
-00027db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027dc0: 7661 6c69 6420 3d20 4661 6c73 650a 2020  valid = False.  
-00027dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027de0: 2020 7365 6c66 2e5f 5f66 2e61 7070 656e    self.__f.appen
-00027df0: 6428 6622 5b49 6e76 616c 6964 2064 6174  d(f"[Invalid dat
-00027e00: 615d 207b 7365 6c66 2e5f 5f67 6574 4375  a] {self.__getCu
-00027e10: 7272 656e 7452 6573 7472 6169 6e74 2829  rrentRestraint()
-00027e20: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
-00027e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027e40: 2020 2020 2020 2066 227b 6675 6e63 5479         f"{funcTy
-00027e50: 7065 7d20 2777 6569 6768 743d 7b77 6569  pe} 'weight={wei
-00027e60: 6768 747d 2720 6d75 7374 206e 6f74 2062  ght}' must not b
-00027e70: 6520 6120 6e65 6761 7469 7665 2076 616c  e a negative val
-00027e80: 7565 2e22 290a 2020 2020 2020 2020 2020  ue.").          
-00027e90: 2020 2020 2020 656c 6966 2077 6569 6768        elif weigh
-00027ea0: 7420 3d3d 2030 2e30 3a0a 2020 2020 2020  t == 0.0:.      
-00027eb0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00027ec0: 6c66 2e5f 5f66 2e61 7070 656e 6428 6622  lf.__f.append(f"
-00027ed0: 5b52 616e 6765 2076 616c 7565 2077 6172  [Range value war
-00027ee0: 6e69 6e67 5d20 7b73 656c 662e 5f5f 6765  ning] {self.__ge
-00027ef0: 7443 7572 7265 6e74 5265 7374 7261 696e  tCurrentRestrain
-00027f00: 7428 297d 220a 2020 2020 2020 2020 2020  t()}".          
+00026ff0: 2020 2020 6622 7b66 756e 6354 7970 657d      f"{funcType}
+00027000: 2073 7461 6e64 6172 6420 6465 7669 6174   standard deviat
+00027010: 696f 6e20 6f66 2074 6865 2032 6e64 2047  ion of the 2nd G
+00027020: 6175 7373 6961 6e20 6675 6e63 7469 6f6e  aussian function
+00027030: 2027 7364 323d 7b73 6432 7d27 206d 7573   'sd2={sd2}' mus
+00027040: 7420 6265 2061 2070 6f73 6974 6976 6520  t be a positive 
+00027050: 7661 6c75 652e 2229 0a0a 2020 2020 2020  value.")..      
+00027060: 2020 2020 2020 656c 6966 2063 7478 2e43        elif ctx.C
+00027070: 4f4e 5354 414e 5446 554e 4328 293a 2020  ONSTANTFUNC():  
+00027080: 2320 7265 7475 726e 5f76 616c 0a20 2020  # return_val.   
+00027090: 2020 2020 2020 2020 2020 2020 2066 756e               fun
+000270a0: 6354 7970 6520 3d20 2743 4f4e 5354 414e  cType = 'CONSTAN
+000270b0: 5446 554e 4327 0a20 2020 2020 2020 2020  TFUNC'.         
+000270c0: 2020 2020 2020 2072 6574 7572 6e5f 7661         return_va
+000270d0: 6c20 3d20 7365 6c66 2e6e 756d 6265 7246  l = self.numberF
+000270e0: 5365 6c65 6374 696f 6e5b 305d 0a0a 2020  Selection[0]..  
+000270f0: 2020 2020 2020 2020 2020 2020 2020 6675                fu
+00027100: 6e63 5b27 6e61 6d65 275d 203d 2066 756e  nc['name'] = fun
+00027110: 6354 7970 650a 2020 2020 2020 2020 2020  cType.          
+00027120: 2020 2020 2020 6675 6e63 5b27 7265 7475        func['retu
+00027130: 726e 5f76 616c 275d 203d 2072 6574 7572  rn_val'] = retur
+00027140: 6e5f 7661 6c0a 0a20 2020 2020 2020 2020  n_val..         
+00027150: 2020 2065 6c69 6620 6374 782e 4944 454e     elif ctx.IDEN
+00027160: 5449 5459 2829 3a0a 2020 2020 2020 2020  TITY():.        
+00027170: 2020 2020 2020 2020 6675 6e63 5b27 6e61          func['na
+00027180: 6d65 275d 203d 2027 4944 454e 5449 5459  me'] = 'IDENTITY
+00027190: 270a 0a20 2020 2020 2020 2020 2020 2065  '..            e
+000271a0: 6c69 6620 6374 782e 5343 414c 4152 5745  lif ctx.SCALARWE
+000271b0: 4947 4854 4544 4655 4e43 2829 3a20 2023  IGHTEDFUNC():  #
+000271c0: 2077 6569 6768 7420 6675 6e63 5f74 7970   weight func_typ
+000271d0: 655f 6465 660a 2020 2020 2020 2020 2020  e_def.          
+000271e0: 2020 2020 2020 6675 6e63 5479 7065 203d        funcType =
+000271f0: 2027 5343 414c 4152 5745 4947 4854 4544   'SCALARWEIGHTED
+00027200: 4655 4e43 270a 2020 2020 2020 2020 2020  FUNC'.          
+00027210: 2020 2020 2020 7765 6967 6874 203d 2073        weight = s
+00027220: 656c 662e 6e75 6d62 6572 4653 656c 6563  elf.numberFSelec
+00027230: 7469 6f6e 5b30 5d0a 0a20 2020 2020 2020  tion[0]..       
+00027240: 2020 2020 2020 2020 2066 756e 635b 276e           func['n
+00027250: 616d 6527 5d20 3d20 6675 6e63 5479 7065  ame'] = funcType
+00027260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027270: 2066 756e 635b 2777 6569 6768 7427 5d20   func['weight'] 
+00027280: 3d20 7765 6967 6874 0a0a 2020 2020 2020  = weight..      
+00027290: 2020 2020 2020 2020 2020 6966 2077 6569            if wei
+000272a0: 6768 7420 3c20 302e 303a 0a20 2020 2020  ght < 0.0:.     
+000272b0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+000272c0: 616c 6964 203d 2046 616c 7365 0a20 2020  alid = False.   
+000272d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000272e0: 2073 656c 662e 5f5f 662e 6170 7065 6e64   self.__f.append
+000272f0: 2866 225b 496e 7661 6c69 6420 6461 7461  (f"[Invalid data
+00027300: 5d20 7b73 656c 662e 5f5f 6765 7443 7572  ] {self.__getCur
+00027310: 7265 6e74 5265 7374 7261 696e 7428 297d  rentRestraint()}
+00027320: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00027330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027340: 2020 2020 2020 6622 7b66 756e 6354 7970        f"{funcTyp
+00027350: 657d 2027 7765 6967 6874 3d7b 7765 6967  e} 'weight={weig
+00027360: 6874 7d27 206f 6620 7b6e 2b31 7d74 6820  ht}' of {n+1}th 
+00027370: 6675 6e63 7469 6f6e 206d 7573 7420 6e6f  function must no
+00027380: 7420 6265 2061 206e 6567 6174 6976 6520  t be a negative 
+00027390: 7661 6c75 652e 2229 0a20 2020 2020 2020  value.").       
+000273a0: 2020 2020 2020 2020 2065 6c69 6620 7765           elif we
+000273b0: 6967 6874 203d 3d20 302e 303a 0a20 2020  ight == 0.0:.   
+000273c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000273d0: 2073 656c 662e 5f5f 662e 6170 7065 6e64   self.__f.append
+000273e0: 2866 225b 5261 6e67 6520 7661 6c75 6520  (f"[Range value 
+000273f0: 7761 726e 696e 675d 207b 7365 6c66 2e5f  warning] {self._
+00027400: 5f67 6574 4375 7272 656e 7452 6573 7472  _getCurrentRestr
+00027410: 6169 6e74 2829 7d22 0a20 2020 2020 2020  aint()}".       
+00027420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027430: 2020 2020 2020 2020 2020 2020 2066 227b               f"{
+00027440: 6675 6e63 5479 7065 7d20 2777 6569 6768  funcType} 'weigh
+00027450: 743d 7b77 6569 6768 747d 2720 6f66 207b  t={weight}' of {
+00027460: 6e2b 317d 7468 2066 756e 6374 696f 6e20  n+1}th function 
+00027470: 7368 6f75 6c64 2062 6520 6120 706f 7369  should be a posi
+00027480: 7469 7665 2076 616c 7565 2e22 290a 0a20  tive value.").. 
+00027490: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000274a0: 756e 635b 2766 756e 635f 7479 7065 7327  unc['func_types'
+000274b0: 5d20 3d20 5b5d 0a0a 2020 2020 2020 2020  ] = []..        
+000274c0: 2020 2020 656c 6966 2063 7478 2e53 554d      elif ctx.SUM
+000274d0: 4655 4e43 2829 3a20 2023 206e 5f66 756e  FUNC():  # n_fun
+000274e0: 6373 2046 756e 635f 5479 7065 3120 4675  cs Func_Type1 Fu
+000274f0: 6e63 5f44 6566 3120 5b46 756e 635f 5479  nc_Def1 [Func_Ty
+00027500: 7065 3220 4675 6e63 5f44 6566 3220 5b2e  pe2 Func_Def2 [.
+00027510: 2e2e 5d5d 0a20 2020 2020 2020 2020 2020  ..]].           
+00027520: 2020 2020 2066 756e 6354 7970 6520 3d20       funcType = 
+00027530: 2753 554d 4655 4e43 270a 2020 2020 2020  'SUMFUNC'.      
+00027540: 2020 2020 2020 2020 2020 6e5f 6675 6e63            n_func
+00027550: 7320 3d20 696e 7428 7374 7228 6374 782e  s = int(str(ctx.
+00027560: 496e 7465 6765 7228 2929 290a 0a20 2020  Integer()))..   
+00027570: 2020 2020 2020 2020 2020 2020 2066 756e               fun
+00027580: 635b 276e 616d 6527 5d20 3d20 6675 6e63  c['name'] = func
+00027590: 5479 7065 0a20 2020 2020 2020 2020 2020  Type.           
+000275a0: 2020 2020 2066 756e 635b 276e 5f66 756e       func['n_fun
+000275b0: 6373 275d 203d 206e 5f66 756e 6373 0a0a  cs'] = n_funcs..
+000275c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000275d0: 6966 206e 5f66 756e 6373 203c 3d20 303a  if n_funcs <= 0:
+000275e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000275f0: 2020 2020 2076 616c 6964 203d 2046 616c       valid = Fal
+00027600: 7365 0a20 2020 2020 2020 2020 2020 2020  se.             
+00027610: 2020 2020 2020 2073 656c 662e 5f5f 662e         self.__f.
+00027620: 6170 7065 6e64 2866 225b 496e 7661 6c69  append(f"[Invali
+00027630: 6420 6461 7461 5d20 7b73 656c 662e 5f5f  d data] {self.__
+00027640: 6765 7443 7572 7265 6e74 5265 7374 7261  getCurrentRestra
+00027650: 696e 7428 297d 220a 2020 2020 2020 2020  int()}".        
+00027660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027670: 2020 2020 2020 2020 2020 2020 6622 7b66              f"{f
+00027680: 756e 6354 7970 657d 2074 6865 206e 756d  uncType} the num
+00027690: 6265 7220 6f66 2066 756e 6374 696f 6e73  ber of functions
+000276a0: 2027 6e5f 6675 6e63 733d 7b6e 5f66 756e   'n_funcs={n_fun
+000276b0: 6373 7d27 206d 7573 7420 6265 2061 2070  cs}' must be a p
+000276c0: 6f73 6974 6976 6520 7661 6c75 652e 2229  ositive value.")
+000276d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000276e0: 2065 6c69 6620 6374 782e 6675 6e63 5f74   elif ctx.func_t
+000276f0: 7970 655f 6465 6628 6e5f 6675 6e63 7320  ype_def(n_funcs 
+00027700: 2d20 3129 3a0a 2020 2020 2020 2020 2020  - 1):.          
+00027710: 2020 2020 2020 2020 2020 7061 7373 0a20            pass. 
+00027720: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00027730: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00027740: 2020 2020 2020 2020 2076 616c 6964 203d           valid =
+00027750: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
+00027760: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00027770: 5f5f 662e 6170 7065 6e64 2866 225b 496e  __f.append(f"[In
+00027780: 7661 6c69 6420 6461 7461 5d20 7b73 656c  valid data] {sel
+00027790: 662e 5f5f 6765 7443 7572 7265 6e74 5265  f.__getCurrentRe
+000277a0: 7374 7261 696e 7428 297d 220a 2020 2020  straint()}".    
+000277b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000277c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000277d0: 6622 7b66 756e 6354 7970 657d 2072 6571  f"{funcType} req
+000277e0: 7569 7265 7320 7b6e 5f66 756e 6373 7d20  uires {n_funcs} 
+000277f0: 6675 6e63 7469 6f6e 2064 6566 696e 6974  function definit
+00027800: 696f 6e73 2061 6674 6572 2074 6865 2066  ions after the f
+00027810: 6972 7374 2027 6e5f 6675 6e63 7327 2076  irst 'n_funcs' v
+00027820: 616c 7565 2e22 290a 0a20 2020 2020 2020  alue.")..       
+00027830: 2020 2020 2020 2020 2066 756e 635b 2766           func['f
+00027840: 756e 635f 7479 7065 7327 5d20 3d20 5b5d  unc_types'] = []
+00027850: 0a0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+00027860: 6966 2063 7478 2e53 504c 494e 4528 293a  if ctx.SPLINE():
+00027870: 2020 2320 6465 7363 7269 7074 696f 6e20    # description 
+00027880: 284e 4f4e 4529 2065 7870 6572 696d 656e  (NONE) experimen
+00027890: 7461 6c5f 7661 6c75 6520 7765 6967 6874  tal_value weight
+000278a0: 2062 696e 5f73 697a 6520 2878 5f61 7869   bin_size (x_axi
+000278b0: 7320 7661 6c2a 292b 0a20 2020 2020 2020  s val*)+.       
+000278c0: 2020 2020 2020 2020 2066 756e 6354 7970           funcTyp
+000278d0: 6520 3d20 2753 504c 494e 4527 0a20 2020  e = 'SPLINE'.   
+000278e0: 2020 2020 2020 2020 2020 2020 2064 6573               des
+000278f0: 6372 6970 7469 6f6e 203d 2073 7472 2863  cription = str(c
+00027900: 7478 2e53 696d 706c 655f 6e61 6d65 2830  tx.Simple_name(0
+00027910: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+00027920: 2020 2065 7870 6572 696d 656e 7461 6c5f     experimental_
+00027930: 7661 6c75 6520 3d20 7365 6c66 2e6e 756d  value = self.num
+00027940: 6265 7246 5365 6c65 6374 696f 6e5b 305d  berFSelection[0]
+00027950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027960: 2077 6569 6768 7420 3d20 7365 6c66 2e6e   weight = self.n
+00027970: 756d 6265 7246 5365 6c65 6374 696f 6e5b  umberFSelection[
+00027980: 315d 0a20 2020 2020 2020 2020 2020 2020  1].             
+00027990: 2020 2062 696e 5f73 697a 6520 3d20 7365     bin_size = se
+000279a0: 6c66 2e6e 756d 6265 7246 5365 6c65 6374  lf.numberFSelect
+000279b0: 696f 6e5b 325d 0a0a 2020 2020 2020 2020  ion[2]..        
+000279c0: 2020 2020 2020 2020 6675 6e63 5b27 6e61          func['na
+000279d0: 6d65 275d 203d 2066 756e 6354 7970 650a  me'] = funcType.
+000279e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000279f0: 6675 6e63 5b27 6465 7363 7269 7074 696f  func['descriptio
+00027a00: 6e27 5d20 3d20 6465 7363 7269 7074 696f  n'] = descriptio
+00027a10: 6e0a 2020 2020 2020 2020 2020 2020 2020  n.              
+00027a20: 2020 6675 6e63 5b27 6578 7065 7269 6d65    func['experime
+00027a30: 6e74 616c 5f76 616c 7565 275d 203d 2065  ntal_value'] = e
+00027a40: 7870 6572 696d 656e 7461 6c5f 7661 6c75  xperimental_valu
+00027a50: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00027a60: 2020 6675 6e63 5b27 7765 6967 6874 275d    func['weight']
+00027a70: 203d 2077 6569 6768 740a 2020 2020 2020   = weight.      
+00027a80: 2020 2020 2020 2020 2020 6675 6e63 5b27            func['
+00027a90: 6269 6e5f 7369 7a65 275d 203d 2062 696e  bin_size'] = bin
+00027aa0: 5f73 697a 650a 0a20 2020 2020 2020 2020  _size..         
+00027ab0: 2020 2020 2020 2069 6620 7765 6967 6874         if weight
+00027ac0: 203c 2030 2e30 3a0a 2020 2020 2020 2020   < 0.0:.        
+00027ad0: 2020 2020 2020 2020 2020 2020 7661 6c69              vali
+00027ae0: 6420 3d20 4661 6c73 650a 2020 2020 2020  d = False.      
+00027af0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00027b00: 6c66 2e5f 5f66 2e61 7070 656e 6428 6622  lf.__f.append(f"
+00027b10: 5b49 6e76 616c 6964 2064 6174 615d 207b  [Invalid data] {
+00027b20: 7365 6c66 2e5f 5f67 6574 4375 7272 656e  self.__getCurren
+00027b30: 7452 6573 7472 6169 6e74 2829 7d22 0a20  tRestraint()}". 
+00027b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027b60: 2020 2066 227b 6675 6e63 5479 7065 7d20     f"{funcType} 
+00027b70: 2777 6569 6768 743d 7b77 6569 6768 747d  'weight={weight}
+00027b80: 2720 6d75 7374 206e 6f74 2062 6520 6120  ' must not be a 
+00027b90: 6e65 6761 7469 7665 2076 616c 7565 2e22  negative value."
+00027ba0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00027bb0: 2020 656c 6966 2077 6569 6768 7420 3d3d    elif weight ==
+00027bc0: 2030 2e30 3a0a 2020 2020 2020 2020 2020   0.0:.          
+00027bd0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00027be0: 5f66 2e61 7070 656e 6428 6622 5b52 616e  _f.append(f"[Ran
+00027bf0: 6765 2076 616c 7565 2077 6172 6e69 6e67  ge value warning
+00027c00: 5d20 7b73 656c 662e 5f5f 6765 7443 7572  ] {self.__getCur
+00027c10: 7265 6e74 5265 7374 7261 696e 7428 297d  rentRestraint()}
+00027c20: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00027c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027c40: 2020 2020 2020 6622 7b66 756e 6354 7970        f"{funcTyp
+00027c50: 657d 2027 7765 6967 6874 3d7b 7765 6967  e} 'weight={weig
+00027c60: 6874 7d27 2073 686f 756c 6420 6265 2061  ht}' should be a
+00027c70: 2070 6f73 6974 6976 6520 7661 6c75 652e   positive value.
+00027c80: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
+00027c90: 2020 2020 6966 2062 696e 5f73 697a 6520      if bin_size 
+00027ca0: 3c3d 2030 2e30 3a0a 2020 2020 2020 2020  <= 0.0:.        
+00027cb0: 2020 2020 2020 2020 2020 2020 7661 6c69              vali
+00027cc0: 6420 3d20 4661 6c73 650a 2020 2020 2020  d = False.      
+00027cd0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00027ce0: 6c66 2e5f 5f66 2e61 7070 656e 6428 6622  lf.__f.append(f"
+00027cf0: 5b49 6e76 616c 6964 2064 6174 615d 207b  [Invalid data] {
+00027d00: 7365 6c66 2e5f 5f67 6574 4375 7272 656e  self.__getCurren
+00027d10: 7452 6573 7472 6169 6e74 2829 7d22 0a20  tRestraint()}". 
+00027d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027d40: 2020 2066 227b 6675 6e63 5479 7065 7d20     f"{funcType} 
+00027d50: 2762 696e 5f73 697a 653d 7b62 696e 5f73  'bin_size={bin_s
+00027d60: 697a 657d 2720 6d75 7374 2062 6520 6120  ize}' must be a 
+00027d70: 706f 7369 7469 7665 2076 616c 7565 2e22  positive value."
+00027d80: 290a 0a20 2020 2020 2020 2020 2020 2065  )..            e
+00027d90: 6c69 6620 6374 782e 4641 4445 2829 3a20  lif ctx.FADE(): 
+00027da0: 2023 206c 6220 7562 2064 2077 6420 5b20   # lb ub d wd [ 
+00027db0: 776f 205d 0a20 2020 2020 2020 2020 2020  wo ].           
+00027dc0: 2020 2020 2066 756e 6354 7970 6520 3d20       funcType = 
+00027dd0: 2746 4144 4527 0a20 2020 2020 2020 2020  'FADE'.         
+00027de0: 2020 2020 2020 206c 6220 3d20 7365 6c66         lb = self
+00027df0: 2e6e 756d 6265 7246 5365 6c65 6374 696f  .numberFSelectio
+00027e00: 6e5b 305d 0a20 2020 2020 2020 2020 2020  n[0].           
+00027e10: 2020 2020 2075 6220 3d20 7365 6c66 2e6e       ub = self.n
+00027e20: 756d 6265 7246 5365 6c65 6374 696f 6e5b  umberFSelection[
+00027e30: 315d 0a20 2020 2020 2020 2020 2020 2020  1].             
+00027e40: 2020 2064 203d 2073 656c 662e 6e75 6d62     d = self.numb
+00027e50: 6572 4653 656c 6563 7469 6f6e 5b32 5d0a  erFSelection[2].
+00027e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027e70: 7764 203d 2073 656c 662e 6e75 6d62 6572  wd = self.number
+00027e80: 4653 656c 6563 7469 6f6e 5b33 5d0a 2020  FSelection[3].  
+00027e90: 2020 2020 2020 2020 2020 2020 2020 776f                wo
+00027ea0: 203d 2030 2e30 0a0a 2020 2020 2020 2020   = 0.0..        
+00027eb0: 2020 2020 2020 2020 6675 6e63 5b27 6e61          func['na
+00027ec0: 6d65 275d 203d 2066 756e 6354 7970 650a  me'] = funcType.
+00027ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027ee0: 6675 6e63 5b27 6c62 275d 203d 206c 620a  func['lb'] = lb.
+00027ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027f00: 6675 6e63 5b27 7562 275d 203d 2075 620a  func['ub'] = ub.
 00027f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027f20: 2020 2020 2020 2020 2020 6622 7b66 756e            f"{fun
-00027f30: 6354 7970 657d 2027 7765 6967 6874 3d7b  cType} 'weight={
-00027f40: 7765 6967 6874 7d27 2073 686f 756c 6420  weight}' should 
-00027f50: 6265 2061 2070 6f73 6974 6976 6520 7661  be a positive va
-00027f60: 6c75 652e 2229 0a0a 2020 2020 2020 2020  lue.")..        
-00027f70: 2020 2020 2020 2020 6966 2062 696e 5f73          if bin_s
-00027f80: 697a 6520 3c3d 2030 2e30 3a0a 2020 2020  ize <= 0.0:.    
-00027f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027fa0: 7661 6c69 6420 3d20 4661 6c73 650a 2020  valid = False.  
-00027fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027fc0: 2020 7365 6c66 2e5f 5f66 2e61 7070 656e    self.__f.appen
-00027fd0: 6428 6622 5b49 6e76 616c 6964 2064 6174  d(f"[Invalid dat
-00027fe0: 615d 207b 7365 6c66 2e5f 5f67 6574 4375  a] {self.__getCu
-00027ff0: 7272 656e 7452 6573 7472 6169 6e74 2829  rrentRestraint()
-00028000: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
+00027f20: 6675 6e63 5b27 6427 5d20 3d20 6420 2023  func['d'] = d  #
+00027f30: 2066 6164 6520 7a6f 6e65 0a20 2020 2020   fade zone.     
+00027f40: 2020 2020 2020 2020 2020 2066 756e 635b             func[
+00027f50: 2777 6427 5d20 3d20 7764 2020 2320 7765  'wd'] = wd  # we
+00027f60: 6c6c 2064 6570 7468 0a0a 2020 2020 2020  ll depth..      
+00027f70: 2020 2020 2020 2020 2020 6966 206c 6220            if lb 
+00027f80: 3e20 7562 3a0a 2020 2020 2020 2020 2020  > ub:.          
+00027f90: 2020 2020 2020 2020 2020 7661 6c69 6420            valid 
+00027fa0: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
+00027fb0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00027fc0: 2e5f 5f66 2e61 7070 656e 6428 6622 5b49  .__f.append(f"[I
+00027fd0: 6e76 616c 6964 2064 6174 615d 207b 7365  nvalid data] {se
+00027fe0: 6c66 2e5f 5f67 6574 4375 7272 656e 7452  lf.__getCurrentR
+00027ff0: 6573 7472 6169 6e74 2829 7d22 0a20 2020  estraint()}".   
+00028000: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00028010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028020: 2020 2020 2020 2066 227b 6675 6e63 5479         f"{funcTy
-00028030: 7065 7d20 2762 696e 5f73 697a 653d 7b62  pe} 'bin_size={b
-00028040: 696e 5f73 697a 657d 2720 6d75 7374 2062  in_size}' must b
-00028050: 6520 6120 706f 7369 7469 7665 2076 616c  e a positive val
-00028060: 7565 2e22 290a 0a20 2020 2020 2020 2020  ue.")..         
-00028070: 2020 2065 6c69 6620 6374 782e 4641 4445     elif ctx.FADE
-00028080: 2829 3a20 2023 206c 6220 7562 2064 2077  ():  # lb ub d w
-00028090: 6420 5b20 776f 205d 0a20 2020 2020 2020  d [ wo ].       
-000280a0: 2020 2020 2020 2020 2066 756e 6354 7970           funcTyp
-000280b0: 6520 3d20 2746 4144 4527 0a20 2020 2020  e = 'FADE'.     
-000280c0: 2020 2020 2020 2020 2020 206c 6220 3d20             lb = 
-000280d0: 7365 6c66 2e6e 756d 6265 7246 5365 6c65  self.numberFSele
-000280e0: 6374 696f 6e5b 305d 0a20 2020 2020 2020  ction[0].       
-000280f0: 2020 2020 2020 2020 2075 6220 3d20 7365           ub = se
-00028100: 6c66 2e6e 756d 6265 7246 5365 6c65 6374  lf.numberFSelect
-00028110: 696f 6e5b 315d 0a20 2020 2020 2020 2020  ion[1].         
-00028120: 2020 2020 2020 2064 203d 2073 656c 662e         d = self.
-00028130: 6e75 6d62 6572 4653 656c 6563 7469 6f6e  numberFSelection
-00028140: 5b32 5d0a 2020 2020 2020 2020 2020 2020  [2].            
-00028150: 2020 2020 7764 203d 2073 656c 662e 6e75      wd = self.nu
-00028160: 6d62 6572 4653 656c 6563 7469 6f6e 5b33  mberFSelection[3
-00028170: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00028180: 2020 776f 203d 2030 2e30 0a0a 2020 2020    wo = 0.0..    
-00028190: 2020 2020 2020 2020 2020 2020 6675 6e63              func
-000281a0: 5b27 6e61 6d65 275d 203d 2066 756e 6354  ['name'] = funcT
-000281b0: 7970 650a 2020 2020 2020 2020 2020 2020  ype.            
-000281c0: 2020 2020 6675 6e63 5b27 6c62 275d 203d      func['lb'] =
-000281d0: 206c 620a 2020 2020 2020 2020 2020 2020   lb.            
-000281e0: 2020 2020 6675 6e63 5b27 7562 275d 203d      func['ub'] =
-000281f0: 2075 620a 2020 2020 2020 2020 2020 2020   ub.            
-00028200: 2020 2020 6675 6e63 5b27 6427 5d20 3d20      func['d'] = 
-00028210: 6420 2023 2066 6164 6520 7a6f 6e65 0a20  d  # fade zone. 
-00028220: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00028230: 756e 635b 2777 6427 5d20 3d20 7764 2020  unc['wd'] = wd  
-00028240: 2320 7765 6c6c 2064 6570 7468 0a0a 2020  # well depth..  
-00028250: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00028260: 206c 6220 3e20 7562 3a0a 2020 2020 2020   lb > ub:.      
-00028270: 2020 2020 2020 2020 2020 2020 2020 7661                va
-00028280: 6c69 6420 3d20 4661 6c73 650a 2020 2020  lid = False.    
-00028290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000282a0: 7365 6c66 2e5f 5f66 2e61 7070 656e 6428  self.__f.append(
-000282b0: 6622 5b49 6e76 616c 6964 2064 6174 615d  f"[Invalid data]
-000282c0: 207b 7365 6c66 2e5f 5f67 6574 4375 7272   {self.__getCurr
-000282d0: 656e 7452 6573 7472 6169 6e74 2829 7d22  entRestraint()}"
-000282e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000282f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028300: 2020 2020 2066 227b 6675 6e63 5479 7065       f"{funcType
-00028310: 7d20 6c6f 7765 7220 626f 756e 6461 7279  } lower boundary
-00028320: 2027 6c62 3d7b 6c62 7d27 206d 7573 7420   'lb={lb}' must 
-00028330: 6265 206c 6573 7320 7468 616e 206f 7220  be less than or 
-00028340: 6571 7561 6c20 746f 2075 7070 6572 2062  equal to upper b
-00028350: 6f75 6e64 6172 7920 2775 623d 7b75 627d  oundary 'ub={ub}
-00028360: 272e 2229 0a0a 2020 2020 2020 2020 2020  '.")..          
-00028370: 2020 2020 2020 6966 2064 203c 2030 2e30        if d < 0.0
-00028380: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00028390: 2020 2020 2020 7661 6c69 6420 3d20 4661        valid = Fa
-000283a0: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
-000283b0: 2020 2020 2020 2020 7365 6c66 2e5f 5f66          self.__f
-000283c0: 2e61 7070 656e 6428 6622 5b49 6e76 616c  .append(f"[Inval
-000283d0: 6964 2064 6174 615d 207b 7365 6c66 2e5f  id data] {self._
-000283e0: 5f67 6574 4375 7272 656e 7452 6573 7472  _getCurrentRestr
-000283f0: 6169 6e74 2829 7d22 0a20 2020 2020 2020  aint()}".       
-00028400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028410: 2020 2020 2020 2020 2020 2020 2066 227b               f"{
-00028420: 6675 6e63 5479 7065 7d20 6661 6465 207a  funcType} fade z
-00028430: 6f6e 6520 2764 3d7b 647d 2720 6d75 7374  one 'd={d}' must
-00028440: 206e 6f74 2062 6520 6120 6e65 6761 7469   not be a negati
-00028450: 7665 2076 616c 7565 2e22 290a 0a20 2020  ve value.")..   
-00028460: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00028470: 6c65 6e28 7365 6c66 2e6e 756d 6265 7246  len(self.numberF
-00028480: 5365 6c65 6374 696f 6e29 203e 2034 3a0a  Selection) > 4:.
-00028490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000284a0: 2020 2020 776f 203d 2073 656c 662e 6e75      wo = self.nu
-000284b0: 6d62 6572 4653 656c 6563 7469 6f6e 5b34  mberFSelection[4
-000284c0: 5d0a 0a20 2020 2020 2020 2020 2020 2020  ]..             
-000284d0: 2020 2020 2020 2066 756e 635b 2777 6f27         func['wo'
-000284e0: 5d20 3d20 776f 2020 2320 7765 6c6c 206f  ] = wo  # well o
-000284f0: 6666 7365 740a 0a20 2020 2020 2020 2020  ffset..         
-00028500: 2020 2065 6c69 6620 6374 782e 5351 5541     elif ctx.SQUA
-00028510: 5245 5f57 454c 4c32 2829 3a20 2023 2078  RE_WELL2():  # x
-00028520: 3020 7769 6474 6820 6465 7074 6820 5b44  0 width depth [D
-00028530: 4547 5245 4553 5d0a 2020 2020 2020 2020  EGREES].        
-00028540: 2020 2020 2020 2020 6675 6e63 5479 7065          funcType
-00028550: 203d 2027 5351 5541 5245 5f57 454c 4c32   = 'SQUARE_WELL2
-00028560: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
-00028570: 2020 7830 203d 2073 656c 662e 6e75 6d62    x0 = self.numb
-00028580: 6572 4653 656c 6563 7469 6f6e 5b30 5d0a  erFSelection[0].
-00028590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000285a0: 7769 6474 6820 3d20 7365 6c66 2e6e 756d  width = self.num
-000285b0: 6265 7246 5365 6c65 6374 696f 6e5b 325d  berFSelection[2]
-000285c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000285d0: 2064 6570 7468 203d 2073 656c 662e 6e75   depth = self.nu
-000285e0: 6d62 6572 4653 656c 6563 7469 6f6e 5b31  mberFSelection[1
-000285f0: 5d0a 0a20 2020 2020 2020 2020 2020 2020  ]..             
-00028600: 2020 2066 756e 635b 276e 616d 6527 5d20     func['name'] 
-00028610: 3d20 6675 6e63 5479 7065 0a20 2020 2020  = funcType.     
-00028620: 2020 2020 2020 2020 2020 2066 756e 635b             func[
-00028630: 2778 3027 5d20 3d20 7830 0a20 2020 2020  'x0'] = x0.     
-00028640: 2020 2020 2020 2020 2020 2066 756e 635b             func[
-00028650: 2777 6964 7468 275d 203d 2077 6964 7468  'width'] = width
-00028660: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028670: 2066 756e 635b 2764 6570 7468 275d 203d   func['depth'] =
-00028680: 2064 6570 7468 0a0a 2020 2020 2020 2020   depth..        
-00028690: 2020 2020 2020 2020 6966 2077 6569 6768          if weigh
-000286a0: 7420 3c20 302e 303a 0a20 2020 2020 2020  t < 0.0:.       
-000286b0: 2020 2020 2020 2020 2020 2020 2076 616c               val
-000286c0: 6964 203d 2046 616c 7365 0a20 2020 2020  id = False.     
-000286d0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000286e0: 656c 662e 5f5f 662e 6170 7065 6e64 2866  elf.__f.append(f
-000286f0: 225b 496e 7661 6c69 6420 6461 7461 5d20  "[Invalid data] 
-00028700: 7b73 656c 662e 5f5f 6765 7443 7572 7265  {self.__getCurre
-00028710: 6e74 5265 7374 7261 696e 7428 297d 220a  ntRestraint()}".
-00028720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028740: 2020 2020 6622 7b66 756e 6354 7970 657d      f"{funcType}
-00028750: 2027 7765 6967 6874 3d7b 7765 6967 6874   'weight={weight
-00028760: 7d27 206d 7573 7420 6e6f 7420 6265 2061  }' must not be a
-00028770: 206e 6567 6174 6976 6520 7661 6c75 652e   negative value.
-00028780: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
-00028790: 2020 2065 6c69 6620 7765 6967 6874 203d     elif weight =
-000287a0: 3d20 302e 303a 0a20 2020 2020 2020 2020  = 0.0:.         
-000287b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000287c0: 5f5f 662e 6170 7065 6e64 2866 225b 5261  __f.append(f"[Ra
-000287d0: 6e67 6520 7661 6c75 6520 7761 726e 696e  nge value warnin
-000287e0: 675d 207b 7365 6c66 2e5f 5f67 6574 4375  g] {self.__getCu
-000287f0: 7272 656e 7452 6573 7472 6169 6e74 2829  rrentRestraint()
-00028800: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
-00028810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028820: 2020 2020 2020 2066 227b 6675 6e63 5479         f"{funcTy
-00028830: 7065 7d20 2777 6569 6768 743d 7b77 6569  pe} 'weight={wei
-00028840: 6768 747d 2720 7368 6f75 6c64 2062 6520  ght}' should be 
-00028850: 6120 706f 7369 7469 7665 2076 616c 7565  a positive value
-00028860: 2e22 290a 0a20 2020 2020 2020 2020 2020  .")..           
-00028870: 2020 2020 2069 6620 6374 782e 4445 4752       if ctx.DEGR
-00028880: 4545 5328 293a 0a20 2020 2020 2020 2020  EES():.         
-00028890: 2020 2020 2020 2020 2020 2066 756e 635b             func[
-000288a0: 2775 6e69 7427 5d20 3d20 2764 6567 7265  'unit'] = 'degre
-000288b0: 6573 270a 2020 2020 2020 2020 2020 2020  es'.            
-000288c0: 2020 2020 2020 2020 6675 6e63 5b27 6c6f          func['lo
-000288d0: 7765 725f 6c69 6e65 6172 5f6c 696d 6974  wer_linear_limit
-000288e0: 275d 203d 2078 3020 2d20 7769 6474 680a  '] = x0 - width.
+00028020: 2066 227b 6675 6e63 5479 7065 7d20 6c6f   f"{funcType} lo
+00028030: 7765 7220 626f 756e 6461 7279 2027 6c62  wer boundary 'lb
+00028040: 3d7b 6c62 7d27 206d 7573 7420 6265 206c  ={lb}' must be l
+00028050: 6573 7320 7468 616e 206f 7220 6571 7561  ess than or equa
+00028060: 6c20 746f 2075 7070 6572 2062 6f75 6e64  l to upper bound
+00028070: 6172 7920 2775 623d 7b75 627d 272e 2229  ary 'ub={ub}'.")
+00028080: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00028090: 2020 6966 2064 203c 2030 2e30 3a0a 2020    if d < 0.0:.  
+000280a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000280b0: 2020 7661 6c69 6420 3d20 4661 6c73 650a    valid = False.
+000280c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000280d0: 2020 2020 7365 6c66 2e5f 5f66 2e61 7070      self.__f.app
+000280e0: 656e 6428 6622 5b49 6e76 616c 6964 2064  end(f"[Invalid d
+000280f0: 6174 615d 207b 7365 6c66 2e5f 5f67 6574  ata] {self.__get
+00028100: 4375 7272 656e 7452 6573 7472 6169 6e74  CurrentRestraint
+00028110: 2829 7d22 0a20 2020 2020 2020 2020 2020  ()}".           
+00028120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028130: 2020 2020 2020 2020 2066 227b 6675 6e63           f"{func
+00028140: 5479 7065 7d20 6661 6465 207a 6f6e 6520  Type} fade zone 
+00028150: 2764 3d7b 647d 2720 6d75 7374 206e 6f74  'd={d}' must not
+00028160: 2062 6520 6120 6e65 6761 7469 7665 2076   be a negative v
+00028170: 616c 7565 2e22 290a 0a20 2020 2020 2020  alue.")..       
+00028180: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
+00028190: 7365 6c66 2e6e 756d 6265 7246 5365 6c65  self.numberFSele
+000281a0: 6374 696f 6e29 203e 2034 3a0a 2020 2020  ction) > 4:.    
+000281b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000281c0: 776f 203d 2073 656c 662e 6e75 6d62 6572  wo = self.number
+000281d0: 4653 656c 6563 7469 6f6e 5b34 5d0a 0a20  FSelection[4].. 
+000281e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000281f0: 2020 2066 756e 635b 2777 6f27 5d20 3d20     func['wo'] = 
+00028200: 776f 2020 2320 7765 6c6c 206f 6666 7365  wo  # well offse
+00028210: 740a 0a20 2020 2020 2020 2020 2020 2065  t..            e
+00028220: 6c69 6620 6374 782e 5351 5541 5245 5f57  lif ctx.SQUARE_W
+00028230: 454c 4c32 2829 3a20 2023 2078 3020 7769  ELL2():  # x0 wi
+00028240: 6474 6820 6465 7074 6820 5b44 4547 5245  dth depth [DEGRE
+00028250: 4553 5d0a 2020 2020 2020 2020 2020 2020  ES].            
+00028260: 2020 2020 6675 6e63 5479 7065 203d 2027      funcType = '
+00028270: 5351 5541 5245 5f57 454c 4c32 270a 2020  SQUARE_WELL2'.  
+00028280: 2020 2020 2020 2020 2020 2020 2020 7830                x0
+00028290: 203d 2073 656c 662e 6e75 6d62 6572 4653   = self.numberFS
+000282a0: 656c 6563 7469 6f6e 5b30 5d0a 2020 2020  election[0].    
+000282b0: 2020 2020 2020 2020 2020 2020 7769 6474              widt
+000282c0: 6820 3d20 7365 6c66 2e6e 756d 6265 7246  h = self.numberF
+000282d0: 5365 6c65 6374 696f 6e5b 325d 0a20 2020  Selection[2].   
+000282e0: 2020 2020 2020 2020 2020 2020 2064 6570               dep
+000282f0: 7468 203d 2073 656c 662e 6e75 6d62 6572  th = self.number
+00028300: 4653 656c 6563 7469 6f6e 5b31 5d0a 0a20  FSelection[1].. 
+00028310: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00028320: 756e 635b 276e 616d 6527 5d20 3d20 6675  unc['name'] = fu
+00028330: 6e63 5479 7065 0a20 2020 2020 2020 2020  ncType.         
+00028340: 2020 2020 2020 2066 756e 635b 2778 3027         func['x0'
+00028350: 5d20 3d20 7830 0a20 2020 2020 2020 2020  ] = x0.         
+00028360: 2020 2020 2020 2066 756e 635b 2777 6964         func['wid
+00028370: 7468 275d 203d 2077 6964 7468 0a20 2020  th'] = width.   
+00028380: 2020 2020 2020 2020 2020 2020 2066 756e               fun
+00028390: 635b 2764 6570 7468 275d 203d 2064 6570  c['depth'] = dep
+000283a0: 7468 0a0a 2020 2020 2020 2020 2020 2020  th..            
+000283b0: 2020 2020 6966 2077 6569 6768 7420 3c20      if weight < 
+000283c0: 302e 303a 0a20 2020 2020 2020 2020 2020  0.0:.           
+000283d0: 2020 2020 2020 2020 2076 616c 6964 203d           valid =
+000283e0: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
+000283f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00028400: 5f5f 662e 6170 7065 6e64 2866 225b 496e  __f.append(f"[In
+00028410: 7661 6c69 6420 6461 7461 5d20 7b73 656c  valid data] {sel
+00028420: 662e 5f5f 6765 7443 7572 7265 6e74 5265  f.__getCurrentRe
+00028430: 7374 7261 696e 7428 297d 220a 2020 2020  straint()}".    
+00028440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028460: 6622 7b66 756e 6354 7970 657d 2027 7765  f"{funcType} 'we
+00028470: 6967 6874 3d7b 7765 6967 6874 7d27 206d  ight={weight}' m
+00028480: 7573 7420 6e6f 7420 6265 2061 206e 6567  ust not be a neg
+00028490: 6174 6976 6520 7661 6c75 652e 2229 0a20  ative value."). 
+000284a0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000284b0: 6c69 6620 7765 6967 6874 203d 3d20 302e  lif weight == 0.
+000284c0: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
+000284d0: 2020 2020 2020 2073 656c 662e 5f5f 662e         self.__f.
+000284e0: 6170 7065 6e64 2866 225b 5261 6e67 6520  append(f"[Range 
+000284f0: 7661 6c75 6520 7761 726e 696e 675d 207b  value warning] {
+00028500: 7365 6c66 2e5f 5f67 6574 4375 7272 656e  self.__getCurren
+00028510: 7452 6573 7472 6169 6e74 2829 7d22 0a20  tRestraint()}". 
+00028520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028540: 2020 2066 227b 6675 6e63 5479 7065 7d20     f"{funcType} 
+00028550: 2777 6569 6768 743d 7b77 6569 6768 747d  'weight={weight}
+00028560: 2720 7368 6f75 6c64 2062 6520 6120 706f  ' should be a po
+00028570: 7369 7469 7665 2076 616c 7565 2e22 290a  sitive value.").
+00028580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028590: 2069 6620 6374 782e 4445 4752 4545 5328   if ctx.DEGREES(
+000285a0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+000285b0: 2020 2020 2020 2066 756e 635b 2775 6e69         func['uni
+000285c0: 7427 5d20 3d20 2764 6567 7265 6573 270a  t'] = 'degrees'.
+000285d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000285e0: 2020 2020 6675 6e63 5b27 6c6f 7765 725f      func['lower_
+000285f0: 6c69 6e65 6172 5f6c 696d 6974 275d 203d  linear_limit'] =
+00028600: 2078 3020 2d20 7769 6474 680a 2020 2020   x0 - width.    
+00028610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028620: 6675 6e63 5b27 7570 7065 725f 6c69 6e65  func['upper_line
+00028630: 6172 5f6c 696d 6974 275d 203d 2078 3020  ar_limit'] = x0 
+00028640: 2b20 7769 6474 680a 2020 2020 2020 2020  + width.        
+00028650: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00028660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028670: 2020 6675 6e63 5b27 756e 6974 275d 203d    func['unit'] =
+00028680: 2027 7261 6469 616e 7327 0a20 2020 2020   'radians'.     
+00028690: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000286a0: 756e 635b 276c 6f77 6572 5f6c 696e 6561  unc['lower_linea
+000286b0: 725f 6c69 6d69 7427 5d20 3d20 6e75 6d70  r_limit'] = nump
+000286c0: 792e 6465 6772 6565 7328 7830 202d 2077  y.degrees(x0 - w
+000286d0: 6964 7468 290a 2020 2020 2020 2020 2020  idth).          
+000286e0: 2020 2020 2020 2020 2020 6675 6e63 5b27            func['
+000286f0: 7570 7065 725f 6c69 6e65 6172 5f6c 696d  upper_linear_lim
+00028700: 6974 275d 203d 206e 756d 7079 2e64 6567  it'] = numpy.deg
+00028710: 7265 6573 2878 3020 2b20 7769 6474 6829  rees(x0 + width)
+00028720: 0a0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+00028730: 6966 2063 7478 2e45 5441 424c 4528 293a  if ctx.ETABLE():
+00028740: 2020 2320 6d69 6e20 6d61 7820 5b6d 616e    # min max [man
+00028750: 7920 6e75 6d62 6572 735d 0a20 2020 2020  y numbers].     
+00028760: 2020 2020 2020 2020 2020 2066 756e 6354             funcT
+00028770: 7970 6520 3d20 2745 5441 424c 4527 0a20  ype = 'ETABLE'. 
+00028780: 2020 2020 2020 2020 2020 2020 2020 205f                 _
+00028790: 6d69 6e20 3d20 7365 6c66 2e6e 756d 6265  min = self.numbe
+000287a0: 7246 5365 6c65 6374 696f 6e5b 305d 0a20  rFSelection[0]. 
+000287b0: 2020 2020 2020 2020 2020 2020 2020 205f                 _
+000287c0: 6d61 7820 3d20 7365 6c66 2e6e 756d 6265  max = self.numbe
+000287d0: 7246 5365 6c65 6374 696f 6e5b 315d 0a0a  rFSelection[1]..
+000287e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000287f0: 6675 6e63 5b27 6e61 6d65 275d 203d 2066  func['name'] = f
+00028800: 756e 6354 7970 650a 2020 2020 2020 2020  uncType.        
+00028810: 2020 2020 2020 2020 6675 6e63 5b27 6d69          func['mi
+00028820: 6e27 5d20 3d20 5f6d 696e 0a20 2020 2020  n'] = _min.     
+00028830: 2020 2020 2020 2020 2020 2066 756e 635b             func[
+00028840: 276d 6178 275d 203d 205f 6d61 780a 0a20  'max'] = _max.. 
+00028850: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00028860: 6620 5f6d 696e 203e 205f 6d61 783a 0a20  f _min > _max:. 
+00028870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028880: 2020 2076 616c 6964 203d 2046 616c 7365     valid = False
+00028890: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000288a0: 2020 2020 2073 656c 662e 5f5f 662e 6170       self.__f.ap
+000288b0: 7065 6e64 2866 225b 496e 7661 6c69 6420  pend(f"[Invalid 
+000288c0: 6461 7461 5d20 7b73 656c 662e 5f5f 6765  data] {self.__ge
+000288d0: 7443 7572 7265 6e74 5265 7374 7261 696e  tCurrentRestrain
+000288e0: 7428 297d 220a 2020 2020 2020 2020 2020  t()}".          
 000288f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028900: 2020 2020 6675 6e63 5b27 7570 7065 725f      func['upper_
-00028910: 6c69 6e65 6172 5f6c 696d 6974 275d 203d  linear_limit'] =
-00028920: 2078 3020 2b20 7769 6474 680a 2020 2020   x0 + width.    
-00028930: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00028940: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00028950: 2020 2020 2020 6675 6e63 5b27 756e 6974        func['unit
-00028960: 275d 203d 2027 7261 6469 616e 7327 0a20  '] = 'radians'. 
-00028970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028980: 2020 2066 756e 635b 276c 6f77 6572 5f6c     func['lower_l
-00028990: 696e 6561 725f 6c69 6d69 7427 5d20 3d20  inear_limit'] = 
-000289a0: 6e75 6d70 792e 6465 6772 6565 7328 7830  numpy.degrees(x0
-000289b0: 202d 2077 6964 7468 290a 2020 2020 2020   - width).      
-000289c0: 2020 2020 2020 2020 2020 2020 2020 6675                fu
-000289d0: 6e63 5b27 7570 7065 725f 6c69 6e65 6172  nc['upper_linear
-000289e0: 5f6c 696d 6974 275d 203d 206e 756d 7079  _limit'] = numpy
-000289f0: 2e64 6567 7265 6573 2878 3020 2b20 7769  .degrees(x0 + wi
-00028a00: 6474 6829 0a0a 2020 2020 2020 2020 2020  dth)..          
-00028a10: 2020 656c 6966 2063 7478 2e45 5441 424c    elif ctx.ETABL
-00028a20: 4528 293a 2020 2320 6d69 6e20 6d61 7820  E():  # min max 
-00028a30: 5b6d 616e 7920 6e75 6d62 6572 735d 0a20  [many numbers]. 
-00028a40: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00028a50: 756e 6354 7970 6520 3d20 2745 5441 424c  uncType = 'ETABL
-00028a60: 4527 0a20 2020 2020 2020 2020 2020 2020  E'.             
-00028a70: 2020 205f 6d69 6e20 3d20 7365 6c66 2e6e     _min = self.n
-00028a80: 756d 6265 7246 5365 6c65 6374 696f 6e5b  umberFSelection[
-00028a90: 305d 0a20 2020 2020 2020 2020 2020 2020  0].             
-00028aa0: 2020 205f 6d61 7820 3d20 7365 6c66 2e6e     _max = self.n
-00028ab0: 756d 6265 7246 5365 6c65 6374 696f 6e5b  umberFSelection[
-00028ac0: 315d 0a0a 2020 2020 2020 2020 2020 2020  1]..            
-00028ad0: 2020 2020 6675 6e63 5b27 6e61 6d65 275d      func['name']
-00028ae0: 203d 2066 756e 6354 7970 650a 2020 2020   = funcType.    
+00028900: 2020 2020 2020 2020 2020 6622 7b66 756e            f"{fun
+00028910: 6354 7970 657d 2027 6d69 6e3d 7b5f 6d69  cType} 'min={_mi
+00028920: 6e7d 2720 6d75 7374 2062 6520 6c65 7373  n}' must be less
+00028930: 2074 6861 6e20 6f72 2065 7175 616c 2074   than or equal t
+00028940: 6f20 276d 6178 3d7b 5f6d 6178 7d27 2e22  o 'max={_max}'."
+00028950: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+00028960: 2020 2069 6620 6c65 6e28 7365 6c66 2e6e     if len(self.n
+00028970: 756d 6265 7246 5365 6c65 6374 696f 6e29  umberFSelection)
+00028980: 203e 2032 3a0a 2020 2020 2020 2020 2020   > 2:.          
+00028990: 2020 2020 2020 2020 2020 7061 7373 0a20            pass. 
+000289a0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000289b0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+000289c0: 2020 2020 2020 2020 2076 616c 6964 203d           valid =
+000289d0: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
+000289e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000289f0: 5f5f 662e 6170 7065 6e64 2866 225b 496e  __f.append(f"[In
+00028a00: 7661 6c69 6420 6461 7461 5d20 7b73 656c  valid data] {sel
+00028a10: 662e 5f5f 6765 7443 7572 7265 6e74 5265  f.__getCurrentRe
+00028a20: 7374 7261 696e 7428 297d 220a 2020 2020  straint()}".    
+00028a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028a50: 6622 7b66 756e 6354 7970 657d 2072 6571  f"{funcType} req
+00028a60: 7569 7265 7320 7061 7261 6d65 7465 7273  uires parameters
+00028a70: 2061 6674 6572 2074 6865 2066 6972 7374   after the first
+00028a80: 2027 6d69 6e27 2061 6e64 2074 6865 2073   'min' and the s
+00028a90: 6563 6f6e 6420 276d 6178 2720 7661 6c75  econd 'max' valu
+00028aa0: 6573 2e22 290a 0a20 2020 2020 2020 2020  es.")..         
+00028ab0: 2020 2065 6c69 6620 6374 782e 5553 4f47     elif ctx.USOG
+00028ac0: 2829 3a20 2023 206e 756d 5f67 6175 7373  ():  # num_gauss
+00028ad0: 6961 6e73 206d 6561 6e31 2073 6431 206d  ians mean1 sd1 m
+00028ae0: 6561 6e32 2073 6432 2e2e 2e0a 2020 2020  ean2 sd2....    
 00028af0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
-00028b00: 5b27 6d69 6e27 5d20 3d20 5f6d 696e 0a20  ['min'] = _min. 
-00028b10: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00028b20: 756e 635b 276d 6178 275d 203d 205f 6d61  unc['max'] = _ma
-00028b30: 780a 0a20 2020 2020 2020 2020 2020 2020  x..             
-00028b40: 2020 2069 6620 5f6d 696e 203e 205f 6d61     if _min > _ma
-00028b50: 783a 0a20 2020 2020 2020 2020 2020 2020  x:.             
-00028b60: 2020 2020 2020 2076 616c 6964 203d 2046         valid = F
-00028b70: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-00028b80: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
-00028b90: 662e 6170 7065 6e64 2866 225b 496e 7661  f.append(f"[Inva
-00028ba0: 6c69 6420 6461 7461 5d20 7b73 656c 662e  lid data] {self.
-00028bb0: 5f5f 6765 7443 7572 7265 6e74 5265 7374  __getCurrentRest
-00028bc0: 7261 696e 7428 297d 220a 2020 2020 2020  raint()}".      
+00028b00: 5479 7065 203d 2027 5553 4f47 270a 2020  Type = 'USOG'.  
+00028b10: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
+00028b20: 6d5f 6761 7573 7369 616e 7320 3d20 696e  m_gaussians = in
+00028b30: 7428 7374 7228 6374 782e 496e 7465 6765  t(str(ctx.Intege
+00028b40: 7228 2929 290a 0a20 2020 2020 2020 2020  r()))..         
+00028b50: 2020 2020 2020 2066 756e 635b 276e 616d         func['nam
+00028b60: 6527 5d20 3d20 6675 6e63 5479 7065 0a20  e'] = funcType. 
+00028b70: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00028b80: 756e 635b 276e 756d 5f67 6175 7373 6961  unc['num_gaussia
+00028b90: 6e73 275d 203d 206e 756d 5f67 6175 7373  ns'] = num_gauss
+00028ba0: 6961 6e73 0a0a 2020 2020 2020 2020 2020  ians..          
+00028bb0: 2020 2020 2020 6966 206e 756d 5f67 6175        if num_gau
+00028bc0: 7373 6961 6e73 203c 3d20 303a 0a20 2020  ssians <= 0:.   
 00028bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028be0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-00028bf0: 7b66 756e 6354 7970 657d 2027 6d69 6e3d  {funcType} 'min=
-00028c00: 7b5f 6d69 6e7d 2720 6d75 7374 2062 6520  {_min}' must be 
-00028c10: 6c65 7373 2074 6861 6e20 6f72 2065 7175  less than or equ
-00028c20: 616c 2074 6f20 276d 6178 3d7b 5f6d 6178  al to 'max={_max
-00028c30: 7d27 2e22 290a 0a20 2020 2020 2020 2020  }'.")..         
-00028c40: 2020 2020 2020 2069 6620 6c65 6e28 7365         if len(se
-00028c50: 6c66 2e6e 756d 6265 7246 5365 6c65 6374  lf.numberFSelect
-00028c60: 696f 6e29 203e 2032 3a0a 2020 2020 2020  ion) > 2:.      
-00028c70: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-00028c80: 7373 0a20 2020 2020 2020 2020 2020 2020  ss.             
-00028c90: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00028ca0: 2020 2020 2020 2020 2020 2020 2076 616c               val
-00028cb0: 6964 203d 2046 616c 7365 0a20 2020 2020  id = False.     
-00028cc0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00028cd0: 656c 662e 5f5f 662e 6170 7065 6e64 2866  elf.__f.append(f
-00028ce0: 225b 496e 7661 6c69 6420 6461 7461 5d20  "[Invalid data] 
-00028cf0: 7b73 656c 662e 5f5f 6765 7443 7572 7265  {self.__getCurre
-00028d00: 6e74 5265 7374 7261 696e 7428 297d 220a  ntRestraint()}".
-00028d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028d30: 2020 2020 6622 7b66 756e 6354 7970 657d      f"{funcType}
-00028d40: 2072 6571 7569 7265 7320 7061 7261 6d65   requires parame
-00028d50: 7465 7273 2061 6674 6572 2074 6865 2066  ters after the f
-00028d60: 6972 7374 2027 6d69 6e27 2061 6e64 2074  irst 'min' and t
-00028d70: 6865 2073 6563 6f6e 6420 276d 6178 2720  he second 'max' 
-00028d80: 7661 6c75 6573 2e22 290a 0a20 2020 2020  values.")..     
-00028d90: 2020 2020 2020 2065 6c69 6620 6374 782e         elif ctx.
-00028da0: 5553 4f47 2829 3a20 2023 206e 756d 5f67  USOG():  # num_g
-00028db0: 6175 7373 6961 6e73 206d 6561 6e31 2073  aussians mean1 s
-00028dc0: 6431 206d 6561 6e32 2073 6432 2e2e 2e0a  d1 mean2 sd2....
-00028dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028de0: 6675 6e63 5479 7065 203d 2027 5553 4f47  funcType = 'USOG
-00028df0: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
-00028e00: 2020 6e75 6d5f 6761 7573 7369 616e 7320    num_gaussians 
-00028e10: 3d20 696e 7428 7374 7228 6374 782e 496e  = int(str(ctx.In
-00028e20: 7465 6765 7228 2929 290a 0a20 2020 2020  teger()))..     
-00028e30: 2020 2020 2020 2020 2020 2066 756e 635b             func[
-00028e40: 276e 616d 6527 5d20 3d20 6675 6e63 5479  'name'] = funcTy
-00028e50: 7065 0a20 2020 2020 2020 2020 2020 2020  pe.             
-00028e60: 2020 2066 756e 635b 276e 756d 5f67 6175     func['num_gau
-00028e70: 7373 6961 6e73 275d 203d 206e 756d 5f67  ssians'] = num_g
-00028e80: 6175 7373 6961 6e73 0a0a 2020 2020 2020  aussians..      
-00028e90: 2020 2020 2020 2020 2020 6966 206e 756d            if num
-00028ea0: 5f67 6175 7373 6961 6e73 203c 3d20 303a  _gaussians <= 0:
-00028eb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028ec0: 2020 2020 2076 616c 6964 203d 2046 616c       valid = Fal
-00028ed0: 7365 0a20 2020 2020 2020 2020 2020 2020  se.             
-00028ee0: 2020 2020 2020 2073 656c 662e 5f5f 662e         self.__f.
-00028ef0: 6170 7065 6e64 2866 225b 496e 7661 6c69  append(f"[Invali
-00028f00: 6420 6461 7461 5d20 7b73 656c 662e 5f5f  d data] {self.__
-00028f10: 6765 7443 7572 7265 6e74 5265 7374 7261  getCurrentRestra
-00028f20: 696e 7428 297d 220a 2020 2020 2020 2020  int()}".        
-00028f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028f40: 2020 2020 2020 2020 2020 2020 6622 7b66              f"{f
-00028f50: 756e 6354 7970 657d 2074 6865 206e 756d  uncType} the num
-00028f60: 6265 7220 6f66 2047 6175 7373 6961 6e20  ber of Gaussian 
-00028f70: 6675 6e63 7469 6f6e 7320 276e 756d 5f67  functions 'num_g
-00028f80: 6175 7373 6961 6e73 3d7b 6e75 6d5f 6761  aussians={num_ga
-00028f90: 7573 7369 616e 737d 2720 6d75 7374 2062  ussians}' must b
-00028fa0: 6520 6120 706f 7369 7469 7665 2076 616c  e a positive val
-00028fb0: 7565 2e22 290a 2020 2020 2020 2020 2020  ue.").          
-00028fc0: 2020 2020 2020 656c 6966 206c 656e 2873        elif len(s
-00028fd0: 656c 662e 6e75 6d62 6572 4653 656c 6563  elf.numberFSelec
-00028fe0: 7469 6f6e 2920 3e20 6e75 6d5f 6761 7573  tion) > num_gaus
-00028ff0: 7369 616e 7320 2a20 3220 2d20 313a 0a20  sians * 2 - 1:. 
-00029000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029010: 2020 2066 756e 635b 276d 6561 6e27 5d20     func['mean'] 
-00029020: 3d20 5b5d 0a20 2020 2020 2020 2020 2020  = [].           
-00029030: 2020 2020 2020 2020 2066 756e 635b 2773           func['s
-00029040: 6427 5d20 3d20 5b5d 0a20 2020 2020 2020  d'] = [].       
-00029050: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00029060: 206e 2069 6e20 7261 6e67 6528 6e75 6d5f   n in range(num_
-00029070: 6761 7573 7369 616e 7329 3a0a 2020 2020  gaussians):.    
-00029080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029090: 2020 2020 7020 3d20 6e20 2a20 320a 2020      p = n * 2.  
-000290a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000290b0: 2020 2020 2020 6d65 616e 203d 2073 656c        mean = sel
-000290c0: 662e 6e75 6d62 6572 4653 656c 6563 7469  f.numberFSelecti
-000290d0: 6f6e 5b70 5d0a 2020 2020 2020 2020 2020  on[p].          
-000290e0: 2020 2020 2020 2020 2020 2020 2020 7364                sd
-000290f0: 203d 2073 656c 662e 6e75 6d62 6572 4653   = self.numberFS
-00029100: 656c 6563 7469 6f6e 5b70 202b 2031 5d0a  election[p + 1].
-00029110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00029120: 2020 2020 2020 2020 2066 756e 635b 276d           func['m
-00029130: 6561 6e27 5d2e 6170 7065 6e64 286d 6561  ean'].append(mea
-00029140: 6e29 0a20 2020 2020 2020 2020 2020 2020  n).             
-00029150: 2020 2020 2020 2020 2020 2066 756e 635b             func[
-00029160: 2773 6427 5d2e 6170 7065 6e64 2873 6429  'sd'].append(sd)
-00029170: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00029180: 2020 2020 2020 2020 2020 6966 206e 756d            if num
-00029190: 5f67 6175 7373 6961 6e73 203d 3d20 313a  _gaussians == 1:
-000291a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000291b0: 2020 2020 2020 2020 2020 2020 2066 756e               fun
-000291c0: 635b 2774 6172 6765 745f 7661 6c75 6527  c['target_value'
-000291d0: 5d20 3d20 6d65 616e 0a20 2020 2020 2020  ] = mean.       
-000291e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000291f0: 2020 2020 2066 756e 635b 276c 6f77 6572       func['lower
-00029200: 5f6c 696d 6974 275d 203d 206d 6561 6e20  _limit'] = mean 
-00029210: 2d20 7364 0a20 2020 2020 2020 2020 2020  - sd.           
-00029220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029230: 2066 756e 635b 2775 7070 6572 5f6c 696d   func['upper_lim
-00029240: 6974 275d 203d 206d 6561 6e20 2b20 7364  it'] = mean + sd
-00029250: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00029260: 2020 2020 2020 2020 2020 6966 2073 6420            if sd 
-00029270: 3c3d 2030 2e30 3a0a 2020 2020 2020 2020  <= 0.0:.        
-00029280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029290: 2020 2020 7661 6c69 6420 3d20 4661 6c73      valid = Fals
-000292a0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-000292b0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000292c0: 6c66 2e5f 5f66 2e61 7070 656e 6428 6622  lf.__f.append(f"
-000292d0: 5b49 6e76 616c 6964 2064 6174 615d 207b  [Invalid data] {
-000292e0: 7365 6c66 2e5f 5f67 6574 4375 7272 656e  self.__getCurren
-000292f0: 7452 6573 7472 6169 6e74 2829 7d22 0a20  tRestraint()}". 
-00029300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029320: 2020 2020 2020 2020 2020 2066 227b 6675             f"{fu
-00029330: 6e63 5479 7065 7d20 7374 616e 6461 7264  ncType} standard
-00029340: 2064 6576 6961 7469 6f6e 2027 7364 3d7b   deviation 'sd={
-00029350: 7364 7d27 206f 6620 7b6e 2b31 7d74 6820  sd}' of {n+1}th 
-00029360: 6675 6e63 7469 6f6e 206d 7573 7420 6265  function must be
-00029370: 2061 2070 6f73 6974 6976 6520 7661 6c75   a positive valu
-00029380: 652e 2229 0a20 2020 2020 2020 2020 2020  e.").           
-00029390: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-000293a0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-000293b0: 616c 6964 203d 2046 616c 7365 0a20 2020  alid = False.   
-000293c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000293d0: 2073 656c 662e 5f5f 662e 6170 7065 6e64   self.__f.append
-000293e0: 2866 225b 496e 7661 6c69 6420 6461 7461  (f"[Invalid data
-000293f0: 5d20 7b73 656c 662e 5f5f 6765 7443 7572  ] {self.__getCur
-00029400: 7265 6e74 5265 7374 7261 696e 7428 297d  rentRestraint()}
-00029410: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00029420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029430: 2020 2020 2020 6622 7b66 756e 6354 7970        f"{funcTyp
-00029440: 657d 2072 6571 7569 7265 7320 636f 6e73  e} requires cons
-00029450: 6563 7574 6976 6520 3220 7061 7261 6d65  ecutive 2 parame
-00029460: 7465 7273 2028 6d65 616e 2c20 7364 2920  ters (mean, sd) 
-00029470: 666f 7220 6561 6368 2047 6175 7373 6961  for each Gaussia
-00029480: 6e20 6675 6e63 7469 6f6e 2061 6674 6572  n function after
-00029490: 2074 6865 2066 6972 7374 2027 6e75 6d5f   the first 'num_
-000294a0: 6761 7573 7369 616e 7327 2076 616c 7565  gaussians' value
-000294b0: 2e22 290a 0a20 2020 2020 2020 2020 2020  .")..           
-000294c0: 2065 6c69 6620 6374 782e 534f 4728 293a   elif ctx.SOG():
-000294d0: 2020 2320 6e75 6d5f 6761 7573 7369 616e    # num_gaussian
-000294e0: 7320 6d65 616e 3120 7364 3120 7765 6967  s mean1 sd1 weig
-000294f0: 6874 3120 6d65 616e 3220 7364 3220 7765  ht1 mean2 sd2 we
-00029500: 6967 6874 322e 2e2e 0a20 2020 2020 2020  ight2....       
-00029510: 2020 2020 2020 2020 2066 756e 6354 7970           funcTyp
-00029520: 6520 3d20 2753 4f47 270a 2020 2020 2020  e = 'SOG'.      
-00029530: 2020 2020 2020 2020 2020 6e75 6d5f 6761            num_ga
-00029540: 7573 7369 616e 7320 3d20 696e 7428 7374  ussians = int(st
-00029550: 7228 6374 782e 496e 7465 6765 7228 2929  r(ctx.Integer())
-00029560: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-00029570: 2020 2066 756e 635b 276e 616d 6527 5d20     func['name'] 
-00029580: 3d20 6675 6e63 5479 7065 0a20 2020 2020  = funcType.     
-00029590: 2020 2020 2020 2020 2020 2066 756e 635b             func[
-000295a0: 276e 756d 5f67 6175 7373 6961 6e73 275d  'num_gaussians']
-000295b0: 203d 206e 756d 5f67 6175 7373 6961 6e73   = num_gaussians
-000295c0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000295d0: 2020 6966 206e 756d 5f67 6175 7373 6961    if num_gaussia
-000295e0: 6e73 203c 3d20 303a 0a20 2020 2020 2020  ns <= 0:.       
-000295f0: 2020 2020 2020 2020 2020 2020 2076 616c               val
-00029600: 6964 203d 2046 616c 7365 0a20 2020 2020  id = False.     
-00029610: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00029620: 656c 662e 5f5f 662e 6170 7065 6e64 2866  elf.__f.append(f
-00029630: 225b 496e 7661 6c69 6420 6461 7461 5d20  "[Invalid data] 
-00029640: 7b73 656c 662e 5f5f 6765 7443 7572 7265  {self.__getCurre
-00029650: 6e74 5265 7374 7261 696e 7428 297d 220a  ntRestraint()}".
-00029660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029680: 2020 2020 6622 7b66 756e 6354 7970 657d      f"{funcType}
-00029690: 2074 6865 206e 756d 6265 7220 6f66 2047   the number of G
-000296a0: 6175 7373 6961 6e20 6675 6e63 7469 6f6e  aussian function
-000296b0: 7320 276e 756d 5f67 6175 7373 6961 6e73  s 'num_gaussians
-000296c0: 3d7b 6e75 6d5f 6761 7573 7369 616e 737d  ={num_gaussians}
-000296d0: 2720 6d75 7374 2062 6520 6120 706f 7369  ' must be a posi
-000296e0: 7469 7665 2076 616c 7565 2e22 290a 2020  tive value.").  
-000296f0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00029700: 6966 206c 656e 2873 656c 662e 6e75 6d62  if len(self.numb
-00029710: 6572 4653 656c 6563 7469 6f6e 2920 3e20  erFSelection) > 
-00029720: 6e75 6d5f 6761 7573 7369 616e 7320 2a20  num_gaussians * 
-00029730: 3320 2d20 313a 0a20 2020 2020 2020 2020  3 - 1:.         
-00029740: 2020 2020 2020 2020 2020 2066 756e 635b             func[
-00029750: 276d 6561 6e27 5d20 3d20 5b5d 0a20 2020  'mean'] = [].   
-00029760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029770: 2066 756e 635b 2773 6427 5d20 3d20 5b5d   func['sd'] = []
-00029780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00029790: 2020 2020 2066 756e 635b 2777 6569 6768       func['weigh
-000297a0: 7427 5d20 3d20 5b5d 0a20 2020 2020 2020  t'] = [].       
-000297b0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-000297c0: 206e 2069 6e20 7261 6e67 6528 6e75 6d5f   n in range(num_
-000297d0: 6761 7573 7369 616e 7329 3a0a 2020 2020  gaussians):.    
-000297e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000297f0: 2020 2020 7020 3d20 6e20 2a20 330a 2020      p = n * 3.  
+00028be0: 2076 616c 6964 203d 2046 616c 7365 0a20   valid = False. 
+00028bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028c00: 2020 2073 656c 662e 5f5f 662e 6170 7065     self.__f.appe
+00028c10: 6e64 2866 225b 496e 7661 6c69 6420 6461  nd(f"[Invalid da
+00028c20: 7461 5d20 7b73 656c 662e 5f5f 6765 7443  ta] {self.__getC
+00028c30: 7572 7265 6e74 5265 7374 7261 696e 7428  urrentRestraint(
+00028c40: 297d 220a 2020 2020 2020 2020 2020 2020  )}".            
+00028c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028c60: 2020 2020 2020 2020 6622 7b66 756e 6354          f"{funcT
+00028c70: 7970 657d 2074 6865 206e 756d 6265 7220  ype} the number 
+00028c80: 6f66 2047 6175 7373 6961 6e20 6675 6e63  of Gaussian func
+00028c90: 7469 6f6e 7320 276e 756d 5f67 6175 7373  tions 'num_gauss
+00028ca0: 6961 6e73 3d7b 6e75 6d5f 6761 7573 7369  ians={num_gaussi
+00028cb0: 616e 737d 2720 6d75 7374 2062 6520 6120  ans}' must be a 
+00028cc0: 706f 7369 7469 7665 2076 616c 7565 2e22  positive value."
+00028cd0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00028ce0: 2020 656c 6966 206c 656e 2873 656c 662e    elif len(self.
+00028cf0: 6e75 6d62 6572 4653 656c 6563 7469 6f6e  numberFSelection
+00028d00: 2920 3e20 6e75 6d5f 6761 7573 7369 616e  ) > num_gaussian
+00028d10: 7320 2a20 3220 2d20 313a 0a20 2020 2020  s * 2 - 1:.     
+00028d20: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00028d30: 756e 635b 276d 6561 6e27 5d20 3d20 5b5d  unc['mean'] = []
+00028d40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028d50: 2020 2020 2066 756e 635b 2773 6427 5d20       func['sd'] 
+00028d60: 3d20 5b5d 0a20 2020 2020 2020 2020 2020  = [].           
+00028d70: 2020 2020 2020 2020 2066 6f72 206e 2069           for n i
+00028d80: 6e20 7261 6e67 6528 6e75 6d5f 6761 7573  n range(num_gaus
+00028d90: 7369 616e 7329 3a0a 2020 2020 2020 2020  sians):.        
+00028da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028db0: 7020 3d20 6e20 2a20 320a 2020 2020 2020  p = n * 2.      
+00028dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028dd0: 2020 6d65 616e 203d 2073 656c 662e 6e75    mean = self.nu
+00028de0: 6d62 6572 4653 656c 6563 7469 6f6e 5b70  mberFSelection[p
+00028df0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00028e00: 2020 2020 2020 2020 2020 7364 203d 2073            sd = s
+00028e10: 656c 662e 6e75 6d62 6572 4653 656c 6563  elf.numberFSelec
+00028e20: 7469 6f6e 5b70 202b 2031 5d0a 0a20 2020  tion[p + 1]..   
+00028e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028e40: 2020 2020 2066 756e 635b 276d 6561 6e27       func['mean'
+00028e50: 5d2e 6170 7065 6e64 286d 6561 6e29 0a20  ].append(mean). 
+00028e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028e70: 2020 2020 2020 2066 756e 635b 2773 6427         func['sd'
+00028e80: 5d2e 6170 7065 6e64 2873 6429 0a0a 2020  ].append(sd)..  
+00028e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028ea0: 2020 2020 2020 6966 206e 756d 5f67 6175        if num_gau
+00028eb0: 7373 6961 6e73 203d 3d20 313a 0a20 2020  ssians == 1:.   
+00028ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028ed0: 2020 2020 2020 2020 2066 756e 635b 2774           func['t
+00028ee0: 6172 6765 745f 7661 6c75 6527 5d20 3d20  arget_value'] = 
+00028ef0: 6d65 616e 0a20 2020 2020 2020 2020 2020  mean.           
+00028f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028f10: 2066 756e 635b 276c 6f77 6572 5f6c 696d   func['lower_lim
+00028f20: 6974 275d 203d 206d 6561 6e20 2d20 7364  it'] = mean - sd
+00028f30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028f40: 2020 2020 2020 2020 2020 2020 2066 756e               fun
+00028f50: 635b 2775 7070 6572 5f6c 696d 6974 275d  c['upper_limit']
+00028f60: 203d 206d 6561 6e20 2b20 7364 0a0a 2020   = mean + sd..  
+00028f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028f80: 2020 2020 2020 6966 2073 6420 3c3d 2030        if sd <= 0
+00028f90: 2e30 3a0a 2020 2020 2020 2020 2020 2020  .0:.            
+00028fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028fb0: 7661 6c69 6420 3d20 4661 6c73 650a 2020  valid = False.  
+00028fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028fd0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00028fe0: 5f66 2e61 7070 656e 6428 6622 5b49 6e76  _f.append(f"[Inv
+00028ff0: 616c 6964 2064 6174 615d 207b 7365 6c66  alid data] {self
+00029000: 2e5f 5f67 6574 4375 7272 656e 7452 6573  .__getCurrentRes
+00029010: 7472 6169 6e74 2829 7d22 0a20 2020 2020  traint()}".     
+00029020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029040: 2020 2020 2020 2066 227b 6675 6e63 5479         f"{funcTy
+00029050: 7065 7d20 7374 616e 6461 7264 2064 6576  pe} standard dev
+00029060: 6961 7469 6f6e 2027 7364 3d7b 7364 7d27  iation 'sd={sd}'
+00029070: 206f 6620 7b6e 2b31 7d74 6820 6675 6e63   of {n+1}th func
+00029080: 7469 6f6e 206d 7573 7420 6265 2061 2070  tion must be a p
+00029090: 6f73 6974 6976 6520 7661 6c75 652e 2229  ositive value.")
+000290a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000290b0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+000290c0: 2020 2020 2020 2020 2020 2076 616c 6964             valid
+000290d0: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
+000290e0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000290f0: 662e 5f5f 662e 6170 7065 6e64 2866 225b  f.__f.append(f"[
+00029100: 496e 7661 6c69 6420 6461 7461 5d20 7b73  Invalid data] {s
+00029110: 656c 662e 5f5f 6765 7443 7572 7265 6e74  elf.__getCurrent
+00029120: 5265 7374 7261 696e 7428 297d 220a 2020  Restraint()}".  
+00029130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029150: 2020 6622 7b66 756e 6354 7970 657d 2072    f"{funcType} r
+00029160: 6571 7569 7265 7320 636f 6e73 6563 7574  equires consecut
+00029170: 6976 6520 3220 7061 7261 6d65 7465 7273  ive 2 parameters
+00029180: 2028 6d65 616e 2c20 7364 2920 666f 7220   (mean, sd) for 
+00029190: 6561 6368 2047 6175 7373 6961 6e20 6675  each Gaussian fu
+000291a0: 6e63 7469 6f6e 2061 6674 6572 2074 6865  nction after the
+000291b0: 2066 6972 7374 2027 6e75 6d5f 6761 7573   first 'num_gaus
+000291c0: 7369 616e 7327 2076 616c 7565 2e22 290a  sians' value.").
+000291d0: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+000291e0: 6620 6374 782e 534f 4728 293a 2020 2320  f ctx.SOG():  # 
+000291f0: 6e75 6d5f 6761 7573 7369 616e 7320 6d65  num_gaussians me
+00029200: 616e 3120 7364 3120 7765 6967 6874 3120  an1 sd1 weight1 
+00029210: 6d65 616e 3220 7364 3220 7765 6967 6874  mean2 sd2 weight
+00029220: 322e 2e2e 0a20 2020 2020 2020 2020 2020  2....           
+00029230: 2020 2020 2066 756e 6354 7970 6520 3d20       funcType = 
+00029240: 2753 4f47 270a 2020 2020 2020 2020 2020  'SOG'.          
+00029250: 2020 2020 2020 6e75 6d5f 6761 7573 7369        num_gaussi
+00029260: 616e 7320 3d20 696e 7428 7374 7228 6374  ans = int(str(ct
+00029270: 782e 496e 7465 6765 7228 2929 290a 0a20  x.Integer())).. 
+00029280: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00029290: 756e 635b 276e 616d 6527 5d20 3d20 6675  unc['name'] = fu
+000292a0: 6e63 5479 7065 0a20 2020 2020 2020 2020  ncType.         
+000292b0: 2020 2020 2020 2066 756e 635b 276e 756d         func['num
+000292c0: 5f67 6175 7373 6961 6e73 275d 203d 206e  _gaussians'] = n
+000292d0: 756d 5f67 6175 7373 6961 6e73 0a0a 2020  um_gaussians..  
+000292e0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000292f0: 206e 756d 5f67 6175 7373 6961 6e73 203c   num_gaussians <
+00029300: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
+00029310: 2020 2020 2020 2020 2076 616c 6964 203d           valid =
+00029320: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
+00029330: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00029340: 5f5f 662e 6170 7065 6e64 2866 225b 496e  __f.append(f"[In
+00029350: 7661 6c69 6420 6461 7461 5d20 7b73 656c  valid data] {sel
+00029360: 662e 5f5f 6765 7443 7572 7265 6e74 5265  f.__getCurrentRe
+00029370: 7374 7261 696e 7428 297d 220a 2020 2020  straint()}".    
+00029380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000293a0: 6622 7b66 756e 6354 7970 657d 2074 6865  f"{funcType} the
+000293b0: 206e 756d 6265 7220 6f66 2047 6175 7373   number of Gauss
+000293c0: 6961 6e20 6675 6e63 7469 6f6e 7320 276e  ian functions 'n
+000293d0: 756d 5f67 6175 7373 6961 6e73 3d7b 6e75  um_gaussians={nu
+000293e0: 6d5f 6761 7573 7369 616e 737d 2720 6d75  m_gaussians}' mu
+000293f0: 7374 2062 6520 6120 706f 7369 7469 7665  st be a positive
+00029400: 2076 616c 7565 2e22 290a 2020 2020 2020   value.").      
+00029410: 2020 2020 2020 2020 2020 656c 6966 206c            elif l
+00029420: 656e 2873 656c 662e 6e75 6d62 6572 4653  en(self.numberFS
+00029430: 656c 6563 7469 6f6e 2920 3e20 6e75 6d5f  election) > num_
+00029440: 6761 7573 7369 616e 7320 2a20 3320 2d20  gaussians * 3 - 
+00029450: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
+00029460: 2020 2020 2020 2066 756e 635b 276d 6561         func['mea
+00029470: 6e27 5d20 3d20 5b5d 0a20 2020 2020 2020  n'] = [].       
+00029480: 2020 2020 2020 2020 2020 2020 2066 756e               fun
+00029490: 635b 2773 6427 5d20 3d20 5b5d 0a20 2020  c['sd'] = [].   
+000294a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000294b0: 2066 756e 635b 2777 6569 6768 7427 5d20   func['weight'] 
+000294c0: 3d20 5b5d 0a20 2020 2020 2020 2020 2020  = [].           
+000294d0: 2020 2020 2020 2020 2066 6f72 206e 2069           for n i
+000294e0: 6e20 7261 6e67 6528 6e75 6d5f 6761 7573  n range(num_gaus
+000294f0: 7369 616e 7329 3a0a 2020 2020 2020 2020  sians):.        
+00029500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029510: 7020 3d20 6e20 2a20 330a 2020 2020 2020  p = n * 3.      
+00029520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029530: 2020 6d65 616e 203d 2073 656c 662e 6e75    mean = self.nu
+00029540: 6d62 6572 4653 656c 6563 7469 6f6e 5b70  mberFSelection[p
+00029550: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00029560: 2020 2020 2020 2020 2020 7364 203d 2073            sd = s
+00029570: 656c 662e 6e75 6d62 6572 4653 656c 6563  elf.numberFSelec
+00029580: 7469 6f6e 5b70 202b 2031 5d0a 2020 2020  tion[p + 1].    
+00029590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000295a0: 2020 2020 7765 6967 6874 203d 2073 656c      weight = sel
+000295b0: 662e 6e75 6d62 6572 4653 656c 6563 7469  f.numberFSelecti
+000295c0: 6f6e 5b70 202b 2032 5d0a 0a20 2020 2020  on[p + 2]..     
+000295d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000295e0: 2020 2066 756e 635b 276d 6561 6e27 5d2e     func['mean'].
+000295f0: 6170 7065 6e64 286d 6561 6e29 0a20 2020  append(mean).   
+00029600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029610: 2020 2020 2066 756e 635b 2773 6427 5d2e       func['sd'].
+00029620: 6170 7065 6e64 2873 6429 0a20 2020 2020  append(sd).     
+00029630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029640: 2020 2066 756e 635b 2777 6569 6768 7427     func['weight'
+00029650: 5d2e 6170 7065 6e64 2877 6569 6768 7429  ].append(weight)
+00029660: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00029670: 2020 2020 2020 2020 2020 6966 206e 756d            if num
+00029680: 5f67 6175 7373 6961 6e73 203d 3d20 313a  _gaussians == 1:
+00029690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000296a0: 2020 2020 2020 2020 2020 2020 2066 756e               fun
+000296b0: 635b 2774 6172 6765 745f 7661 6c75 6527  c['target_value'
+000296c0: 5d20 3d20 6d65 616e 0a20 2020 2020 2020  ] = mean.       
+000296d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000296e0: 2020 2020 2066 756e 635b 276c 6f77 6572       func['lower
+000296f0: 5f6c 696d 6974 275d 203d 206d 6561 6e20  _limit'] = mean 
+00029700: 2d20 7364 0a20 2020 2020 2020 2020 2020  - sd.           
+00029710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029720: 2066 756e 635b 2775 7070 6572 5f6c 696d   func['upper_lim
+00029730: 6974 275d 203d 206d 6561 6e20 2b20 7364  it'] = mean + sd
+00029740: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00029750: 2020 2020 2020 2020 2020 6966 2073 6420            if sd 
+00029760: 3c3d 2030 2e30 3a0a 2020 2020 2020 2020  <= 0.0:.        
+00029770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029780: 2020 2020 7661 6c69 6420 3d20 4661 6c73      valid = Fals
+00029790: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+000297a0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000297b0: 6c66 2e5f 5f66 2e61 7070 656e 6428 6622  lf.__f.append(f"
+000297c0: 5b49 6e76 616c 6964 2064 6174 615d 207b  [Invalid data] {
+000297d0: 7365 6c66 2e5f 5f67 6574 4375 7272 656e  self.__getCurren
+000297e0: 7452 6573 7472 6169 6e74 2829 7d22 0a20  tRestraint()}". 
+000297f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00029800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029810: 2020 2020 2020 6d65 616e 203d 2073 656c        mean = sel
-00029820: 662e 6e75 6d62 6572 4653 656c 6563 7469  f.numberFSelecti
-00029830: 6f6e 5b70 5d0a 2020 2020 2020 2020 2020  on[p].          
-00029840: 2020 2020 2020 2020 2020 2020 2020 7364                sd
-00029850: 203d 2073 656c 662e 6e75 6d62 6572 4653   = self.numberFS
-00029860: 656c 6563 7469 6f6e 5b70 202b 2031 5d0a  election[p + 1].
-00029870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029880: 2020 2020 2020 2020 7765 6967 6874 203d          weight =
-00029890: 2073 656c 662e 6e75 6d62 6572 4653 656c   self.numberFSel
-000298a0: 6563 7469 6f6e 5b70 202b 2032 5d0a 0a20  ection[p + 2].. 
-000298b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000298c0: 2020 2020 2020 2066 756e 635b 276d 6561         func['mea
-000298d0: 6e27 5d2e 6170 7065 6e64 286d 6561 6e29  n'].append(mean)
-000298e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000298f0: 2020 2020 2020 2020 2066 756e 635b 2773           func['s
-00029900: 6427 5d2e 6170 7065 6e64 2873 6429 0a20  d'].append(sd). 
-00029910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029920: 2020 2020 2020 2066 756e 635b 2777 6569         func['wei
-00029930: 6768 7427 5d2e 6170 7065 6e64 2877 6569  ght'].append(wei
-00029940: 6768 7429 0a0a 2020 2020 2020 2020 2020  ght)..          
-00029950: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00029960: 206e 756d 5f67 6175 7373 6961 6e73 203d   num_gaussians =
-00029970: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
-00029980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029990: 2066 756e 635b 2774 6172 6765 745f 7661   func['target_va
-000299a0: 6c75 6527 5d20 3d20 6d65 616e 0a20 2020  lue'] = mean.   
-000299b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000299c0: 2020 2020 2020 2020 2066 756e 635b 276c           func['l
-000299d0: 6f77 6572 5f6c 696d 6974 275d 203d 206d  ower_limit'] = m
-000299e0: 6561 6e20 2d20 7364 0a20 2020 2020 2020  ean - sd.       
-000299f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029a00: 2020 2020 2066 756e 635b 2775 7070 6572       func['upper
-00029a10: 5f6c 696d 6974 275d 203d 206d 6561 6e20  _limit'] = mean 
-00029a20: 2b20 7364 0a0a 2020 2020 2020 2020 2020  + sd..          
-00029a30: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00029a40: 2073 6420 3c3d 2030 2e30 3a0a 2020 2020   sd <= 0.0:.    
+00029810: 2020 2020 2020 2020 2020 2066 227b 6675             f"{fu
+00029820: 6e63 5479 7065 7d20 7374 616e 6461 7264  ncType} standard
+00029830: 2064 6576 6961 7469 6f6e 2027 7364 3d7b   deviation 'sd={
+00029840: 7364 7d27 206f 6620 7b6e 2b31 7d74 6820  sd}' of {n+1}th 
+00029850: 6675 6e63 7469 6f6e 206d 7573 7420 6265  function must be
+00029860: 2061 2070 6f73 6974 6976 6520 7661 6c75   a positive valu
+00029870: 652e 2229 0a20 2020 2020 2020 2020 2020  e.").           
+00029880: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00029890: 7765 6967 6874 203c 2030 2e30 3a0a 2020  weight < 0.0:.  
+000298a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000298b0: 2020 2020 2020 2020 2020 7661 6c69 6420            valid 
+000298c0: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
+000298d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000298e0: 2020 2020 7365 6c66 2e5f 5f66 2e61 7070      self.__f.app
+000298f0: 656e 6428 6622 5b49 6e76 616c 6964 2064  end(f"[Invalid d
+00029900: 6174 615d 207b 7365 6c66 2e5f 5f67 6574  ata] {self.__get
+00029910: 4375 7272 656e 7452 6573 7472 6169 6e74  CurrentRestraint
+00029920: 2829 7d22 0a20 2020 2020 2020 2020 2020  ()}".           
+00029930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029950: 2066 227b 6675 6e63 5479 7065 7d20 2777   f"{funcType} 'w
+00029960: 6569 6768 743d 7b77 6569 6768 747d 2720  eight={weight}' 
+00029970: 6f66 207b 6e2b 317d 7468 2066 756e 6374  of {n+1}th funct
+00029980: 696f 6e20 6d75 7374 206e 6f74 2062 6520  ion must not be 
+00029990: 6120 6e65 6761 7469 7665 2076 616c 7565  a negative value
+000299a0: 2e22 290a 2020 2020 2020 2020 2020 2020  .").            
+000299b0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+000299c0: 2077 6569 6768 7420 3d3d 2030 2e30 3a0a   weight == 0.0:.
+000299d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000299e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000299f0: 2e5f 5f66 2e61 7070 656e 6428 6622 5b52  .__f.append(f"[R
+00029a00: 616e 6765 2076 616c 7565 2077 6172 6e69  ange value warni
+00029a10: 6e67 5d20 7b73 656c 662e 5f5f 6765 7443  ng] {self.__getC
+00029a20: 7572 7265 6e74 5265 7374 7261 696e 7428  urrentRestraint(
+00029a30: 297d 220a 2020 2020 2020 2020 2020 2020  )}".            
+00029a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00029a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029a60: 2020 2020 2020 2020 7661 6c69 6420 3d20          valid = 
-00029a70: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
-00029a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029a90: 2020 7365 6c66 2e5f 5f66 2e61 7070 656e    self.__f.appen
-00029aa0: 6428 6622 5b49 6e76 616c 6964 2064 6174  d(f"[Invalid dat
-00029ab0: 615d 207b 7365 6c66 2e5f 5f67 6574 4375  a] {self.__getCu
-00029ac0: 7272 656e 7452 6573 7472 6169 6e74 2829  rrentRestraint()
-00029ad0: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
-00029ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029af0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00029b00: 227b 6675 6e63 5479 7065 7d20 7374 616e  "{funcType} stan
-00029b10: 6461 7264 2064 6576 6961 7469 6f6e 2027  dard deviation '
-00029b20: 7364 3d7b 7364 7d27 206f 6620 7b6e 2b31  sd={sd}' of {n+1
-00029b30: 7d74 6820 6675 6e63 7469 6f6e 206d 7573  }th function mus
-00029b40: 7420 6265 2061 2070 6f73 6974 6976 6520  t be a positive 
-00029b50: 7661 6c75 652e 2229 0a20 2020 2020 2020  value.").       
-00029b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029b70: 2069 6620 7765 6967 6874 203c 2030 2e30   if weight < 0.0
-00029b80: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00029b90: 2020 2020 2020 2020 2020 2020 2020 7661                va
-00029ba0: 6c69 6420 3d20 4661 6c73 650a 2020 2020  lid = False.    
-00029bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029bc0: 2020 2020 2020 2020 7365 6c66 2e5f 5f66          self.__f
-00029bd0: 2e61 7070 656e 6428 6622 5b49 6e76 616c  .append(f"[Inval
-00029be0: 6964 2064 6174 615d 207b 7365 6c66 2e5f  id data] {self._
-00029bf0: 5f67 6574 4375 7272 656e 7452 6573 7472  _getCurrentRestr
-00029c00: 6169 6e74 2829 7d22 0a20 2020 2020 2020  aint()}".       
-00029c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029c30: 2020 2020 2066 227b 6675 6e63 5479 7065       f"{funcType
-00029c40: 7d20 2777 6569 6768 743d 7b77 6569 6768  } 'weight={weigh
-00029c50: 747d 2720 6f66 207b 6e2b 317d 7468 2066  t}' of {n+1}th f
-00029c60: 756e 6374 696f 6e20 6d75 7374 206e 6f74  unction must not
-00029c70: 2062 6520 6120 6e65 6761 7469 7665 2076   be a negative v
-00029c80: 616c 7565 2e22 290a 2020 2020 2020 2020  alue.").        
-00029c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029ca0: 656c 6966 2077 6569 6768 7420 3d3d 2030  elif weight == 0
-00029cb0: 2e30 3a0a 2020 2020 2020 2020 2020 2020  .0:.            
-00029cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029cd0: 7365 6c66 2e5f 5f66 2e61 7070 656e 6428  self.__f.append(
-00029ce0: 6622 5b52 616e 6765 2076 616c 7565 2077  f"[Range value w
-00029cf0: 6172 6e69 6e67 5d20 7b73 656c 662e 5f5f  arning] {self.__
-00029d00: 6765 7443 7572 7265 6e74 5265 7374 7261  getCurrentRestra
-00029d10: 696e 7428 297d 220a 2020 2020 2020 2020  int()}".        
-00029d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029d40: 2020 2020 6622 7b66 756e 6354 7970 657d      f"{funcType}
-00029d50: 2027 7765 6967 6874 3d7b 7765 6967 6874   'weight={weight
-00029d60: 7d27 206f 6620 7b6e 2b31 7d74 6820 6675  }' of {n+1}th fu
-00029d70: 6e63 7469 6f6e 2073 686f 756c 6420 6265  nction should be
-00029d80: 2061 2070 6f73 6974 6976 6520 7661 6c75   a positive valu
-00029d90: 652e 2229 0a20 2020 2020 2020 2020 2020  e.").           
-00029da0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00029db0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-00029dc0: 616c 6964 203d 2046 616c 7365 0a20 2020  alid = False.   
-00029dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029de0: 2073 656c 662e 5f5f 662e 6170 7065 6e64   self.__f.append
-00029df0: 2866 225b 496e 7661 6c69 6420 6461 7461  (f"[Invalid data
-00029e00: 5d20 7b73 656c 662e 5f5f 6765 7443 7572  ] {self.__getCur
-00029e10: 7265 6e74 5265 7374 7261 696e 7428 297d  rentRestraint()}
-00029e20: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00029e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029e40: 2020 2020 2020 6622 7b66 756e 6354 7970        f"{funcTyp
-00029e50: 657d 2072 6571 7569 7265 7320 636f 6e73  e} requires cons
-00029e60: 6563 7574 6976 6520 3320 7061 7261 6d65  ecutive 3 parame
-00029e70: 7465 7273 2028 6d65 616e 2c20 7364 2c20  ters (mean, sd, 
-00029e80: 7765 6967 6874 2920 666f 7220 6561 6368  weight) for each
-00029e90: 2047 6175 7373 6961 6e20 6675 6e63 7469   Gaussian functi
-00029ea0: 6f6e 2061 6674 6572 2074 6865 2066 6972  on after the fir
-00029eb0: 7374 2027 6e75 6d5f 6761 7573 7369 616e  st 'num_gaussian
-00029ec0: 7327 2076 616c 7565 2e22 290a 0a20 2020  s' value.")..   
-00029ed0: 2020 2020 2020 2020 2069 6620 7661 6c69           if vali
-00029ee0: 643a 0a20 2020 2020 2020 2020 2020 2020  d:.             
-00029ef0: 2020 2073 656c 662e 7374 6163 6b46 756e     self.stackFun
-00029f00: 6373 2e61 7070 656e 6428 6675 6e63 290a  cs.append(func).
-00029f10: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
-00029f20: 5661 6c75 6545 7272 6f72 3a0a 2020 2020  ValueError:.    
-00029f30: 2020 2020 2020 2020 7061 7373 0a20 2020          pass.   
-00029f40: 2020 2020 2066 696e 616c 6c79 3a0a 2020       finally:.  
-00029f50: 2020 2020 2020 2020 2020 7365 6c66 2e6e            self.n
-00029f60: 756d 6265 7246 5365 6c65 6374 696f 6e2e  umberFSelection.
-00029f70: 636c 6561 7228 290a 0a20 2020 2023 2045  clear()..    # E
-00029f80: 6e74 6572 2061 2070 6172 7365 2074 7265  nter a parse tre
-00029f90: 6520 7072 6f64 7563 6564 2062 7920 526f  e produced by Ro
-00029fa0: 7365 7474 614d 5250 6172 7365 7223 7264  settaMRParser#rd
-00029fb0: 635f 7265 7374 7261 696e 7473 2e0a 2020  c_restraints..  
-00029fc0: 2020 6465 6620 656e 7465 7252 6463 5f72    def enterRdc_r
-00029fd0: 6573 7472 6169 6e74 7328 7365 6c66 2c20  estraints(self, 
-00029fe0: 6374 783a 2052 6f73 6574 7461 4d52 5061  ctx: RosettaMRPa
-00029ff0: 7273 6572 2e52 6463 5f72 6573 7472 6169  rser.Rdc_restrai
-0002a000: 6e74 7343 6f6e 7465 7874 293a 2020 2320  ntsContext):  # 
-0002a010: 7079 6c69 6e74 3a20 6469 7361 626c 653d  pylint: disable=
-0002a020: 756e 7573 6564 2d61 7267 756d 656e 740a  unused-argument.
-0002a030: 2020 2020 2020 2020 7365 6c66 2e5f 5f63          self.__c
-0002a040: 7572 5f73 7562 7479 7065 203d 2027 7264  ur_subtype = 'rd
-0002a050: 6327 0a0a 2020 2020 2320 4578 6974 2061  c'..    # Exit a
-0002a060: 2070 6172 7365 2074 7265 6520 7072 6f64   parse tree prod
-0002a070: 7563 6564 2062 7920 526f 7365 7474 614d  uced by RosettaM
-0002a080: 5250 6172 7365 7223 7264 635f 7265 7374  RParser#rdc_rest
-0002a090: 7261 696e 7473 2e0a 2020 2020 6465 6620  raints..    def 
-0002a0a0: 6578 6974 5264 635f 7265 7374 7261 696e  exitRdc_restrain
-0002a0b0: 7473 2873 656c 662c 2063 7478 3a20 526f  ts(self, ctx: Ro
-0002a0c0: 7365 7474 614d 5250 6172 7365 722e 5264  settaMRParser.Rd
-0002a0d0: 635f 7265 7374 7261 696e 7473 436f 6e74  c_restraintsCont
-0002a0e0: 6578 7429 3a20 2023 2070 796c 696e 743a  ext):  # pylint:
-0002a0f0: 2064 6973 6162 6c65 3d75 6e75 7365 642d   disable=unused-
-0002a100: 6172 6775 6d65 6e74 0a20 2020 2020 2020  argument.       
-0002a110: 2070 6173 730a 0a20 2020 2023 2045 6e74   pass..    # Ent
-0002a120: 6572 2061 2070 6172 7365 2074 7265 6520  er a parse tree 
-0002a130: 7072 6f64 7563 6564 2062 7920 526f 7365  produced by Rose
-0002a140: 7474 614d 5250 6172 7365 7223 7264 635f  ttaMRParser#rdc_
-0002a150: 7265 7374 7261 696e 742e 0a20 2020 2064  restraint..    d
-0002a160: 6566 2065 6e74 6572 5264 635f 7265 7374  ef enterRdc_rest
-0002a170: 7261 696e 7428 7365 6c66 2c20 6374 783a  raint(self, ctx:
-0002a180: 2052 6f73 6574 7461 4d52 5061 7273 6572   RosettaMRParser
-0002a190: 2e52 6463 5f72 6573 7472 6169 6e74 436f  .Rdc_restraintCo
-0002a1a0: 6e74 6578 7429 3a20 2023 2070 796c 696e  ntext):  # pylin
-0002a1b0: 743a 2064 6973 6162 6c65 3d75 6e75 7365  t: disable=unuse
-0002a1c0: 642d 6172 6775 6d65 6e74 0a20 2020 2020  d-argument.     
-0002a1d0: 2020 2073 656c 662e 7264 6352 6573 7472     self.rdcRestr
-0002a1e0: 6169 6e74 7320 2b3d 2031 0a0a 2020 2020  aints += 1..    
-0002a1f0: 2020 2020 7365 6c66 2e61 746f 6d53 656c      self.atomSel
-0002a200: 6563 7469 6f6e 5365 742e 636c 6561 7228  ectionSet.clear(
-0002a210: 290a 0a20 2020 2023 2045 7869 7420 6120  )..    # Exit a 
-0002a220: 7061 7273 6520 7472 6565 2070 726f 6475  parse tree produ
-0002a230: 6365 6420 6279 2052 6f73 6574 7461 4d52  ced by RosettaMR
-0002a240: 5061 7273 6572 2372 6463 5f72 6573 7472  Parser#rdc_restr
-0002a250: 6169 6e74 2e0a 2020 2020 6465 6620 6578  aint..    def ex
-0002a260: 6974 5264 635f 7265 7374 7261 696e 7428  itRdc_restraint(
-0002a270: 7365 6c66 2c20 6374 783a 2052 6f73 6574  self, ctx: Roset
-0002a280: 7461 4d52 5061 7273 6572 2e52 6463 5f72  taMRParser.Rdc_r
-0002a290: 6573 7472 6169 6e74 436f 6e74 6578 7429  estraintContext)
-0002a2a0: 3a0a 0a20 2020 2020 2020 2074 7279 3a0a  :..        try:.
-0002a2b0: 0a20 2020 2020 2020 2020 2020 2073 6571  .            seq
-0002a2c0: 4964 3120 3d20 696e 7428 7374 7228 6374  Id1 = int(str(ct
-0002a2d0: 782e 496e 7465 6765 7228 3029 2929 0a20  x.Integer(0))). 
-0002a2e0: 2020 2020 2020 2020 2020 2061 746f 6d49             atomI
-0002a2f0: 6431 203d 2073 7472 2863 7478 2e53 696d  d1 = str(ctx.Sim
-0002a300: 706c 655f 6e61 6d65 2830 2929 2e75 7070  ple_name(0)).upp
-0002a310: 6572 2829 0a20 2020 2020 2020 2020 2020  er().           
-0002a320: 2073 6571 4964 3220 3d20 696e 7428 7374   seqId2 = int(st
-0002a330: 7228 6374 782e 496e 7465 6765 7228 3129  r(ctx.Integer(1)
-0002a340: 2929 0a20 2020 2020 2020 2020 2020 2061  )).            a
-0002a350: 746f 6d49 6432 203d 2073 7472 2863 7478  tomId2 = str(ctx
-0002a360: 2e53 696d 706c 655f 6e61 6d65 2831 2929  .Simple_name(1))
-0002a370: 2e75 7070 6572 2829 0a0a 2020 2020 2020  .upper()..      
-0002a380: 2020 2020 2020 6966 206c 656e 2873 656c        if len(sel
-0002a390: 662e 6e75 6d62 6572 5365 6c65 6374 696f  f.numberSelectio
-0002a3a0: 6e29 203d 3d20 3020 6f72 204e 6f6e 6520  n) == 0 or None 
-0002a3b0: 696e 2073 656c 662e 6e75 6d62 6572 5365  in self.numberSe
-0002a3c0: 6c65 6374 696f 6e3a 0a20 2020 2020 2020  lection:.       
-0002a3d0: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
-0002a3e0: 0a20 2020 2020 2020 2020 2020 2074 6172  .            tar
-0002a3f0: 6765 745f 7661 6c75 6520 3d20 7365 6c66  get_value = self
-0002a400: 2e6e 756d 6265 7253 656c 6563 7469 6f6e  .numberSelection
-0002a410: 5b30 5d0a 0a20 2020 2020 2020 2020 2020  [0]..           
-0002a420: 2076 616c 6964 5261 6e67 6520 3d20 5472   validRange = Tr
-0002a430: 7565 0a20 2020 2020 2020 2020 2020 2064  ue.            d
-0002a440: 7374 4675 6e63 203d 207b 2777 6569 6768  stFunc = {'weigh
-0002a450: 7427 3a20 312e 307d 0a0a 2020 2020 2020  t': 1.0}..      
-0002a460: 2020 2020 2020 6966 2074 6172 6765 745f        if target_
-0002a470: 7661 6c75 6520 6973 206e 6f74 204e 6f6e  value is not Non
-0002a480: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0002a490: 2020 2069 6620 5244 435f 4552 524f 525f     if RDC_ERROR_
-0002a4a0: 4d49 4e20 3c20 7461 7267 6574 5f76 616c  MIN < target_val
-0002a4b0: 7565 203c 2052 4443 5f45 5252 4f52 5f4d  ue < RDC_ERROR_M
-0002a4c0: 4158 3a0a 2020 2020 2020 2020 2020 2020  AX:.            
-0002a4d0: 2020 2020 2020 2020 6473 7446 756e 635b          dstFunc[
-0002a4e0: 2774 6172 6765 745f 7661 6c75 6527 5d20  'target_value'] 
-0002a4f0: 3d20 6622 7b74 6172 6765 745f 7661 6c75  = f"{target_valu
-0002a500: 657d 220a 2020 2020 2020 2020 2020 2020  e}".            
-0002a510: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0002a520: 2020 2020 2020 2020 2020 2020 2020 7661                va
-0002a530: 6c69 6452 616e 6765 203d 2046 616c 7365  lidRange = False
-0002a540: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002a550: 2020 2020 2073 656c 662e 5f5f 662e 6170       self.__f.ap
-0002a560: 7065 6e64 2866 225b 5261 6e67 6520 7661  pend(f"[Range va
-0002a570: 6c75 6520 6572 726f 725d 207b 7365 6c66  lue error] {self
-0002a580: 2e5f 5f67 6574 4375 7272 656e 7452 6573  .__getCurrentRes
-0002a590: 7472 6169 6e74 2829 7d22 0a20 2020 2020  traint()}".     
-0002a5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a5b0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0002a5c0: 2254 6865 2074 6172 6765 7420 7661 6c75  "The target valu
-0002a5d0: 653d 277b 7461 7267 6574 5f76 616c 7565  e='{target_value
-0002a5e0: 7d27 206d 7573 7420 6265 2077 6974 6869  }' must be withi
-0002a5f0: 6e20 7261 6e67 6520 7b52 4443 5f52 4553  n range {RDC_RES
-0002a600: 5452 4149 4e54 5f45 5252 4f52 7d2e 2229  TRAINT_ERROR}.")
-0002a610: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0002a620: 206e 6f74 2076 616c 6964 5261 6e67 653a   not validRange:
-0002a630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002a640: 2072 6574 7572 6e0a 0a20 2020 2020 2020   return..       
-0002a650: 2020 2020 2069 6620 7461 7267 6574 5f76       if target_v
-0002a660: 616c 7565 2069 7320 6e6f 7420 4e6f 6e65  alue is not None
-0002a670: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002a680: 2020 6966 2052 4443 5f52 414e 4745 5f4d    if RDC_RANGE_M
-0002a690: 494e 203c 2074 6172 6765 745f 7661 6c75  IN < target_valu
-0002a6a0: 6520 3c20 5244 435f 5241 4e47 455f 4d41  e < RDC_RANGE_MA
-0002a6b0: 583a 0a20 2020 2020 2020 2020 2020 2020  X:.             
-0002a6c0: 2020 2020 2020 2070 6173 730a 2020 2020         pass.    
-0002a6d0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0002a6e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002a6f0: 2020 2020 2020 7365 6c66 2e5f 5f66 2e61        self.__f.a
-0002a700: 7070 656e 6428 6622 5b52 616e 6765 2076  ppend(f"[Range v
-0002a710: 616c 7565 2077 6172 6e69 6e67 5d20 7b73  alue warning] {s
-0002a720: 656c 662e 5f5f 6765 7443 7572 7265 6e74  elf.__getCurrent
-0002a730: 5265 7374 7261 696e 7428 297d 220a 2020  Restraint()}".  
-0002a740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a760: 2020 6622 5468 6520 7461 7267 6574 2076    f"The target v
-0002a770: 616c 7565 3d27 7b74 6172 6765 745f 7661  alue='{target_va
-0002a780: 6c75 657d 2720 7368 6f75 6c64 2062 6520  lue}' should be 
-0002a790: 7769 7468 696e 2072 616e 6765 207b 5244  within range {RD
-0002a7a0: 435f 5245 5354 5241 494e 545f 5241 4e47  C_RESTRAINT_RANG
-0002a7b0: 457d 2e22 290a 0a20 2020 2020 2020 2020  E}.")..         
-0002a7c0: 2020 2069 6620 6e6f 7420 7365 6c66 2e5f     if not self._
-0002a7d0: 5f68 6173 506f 6c79 5365 713a 0a20 2020  _hasPolySeq:.   
-0002a7e0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-0002a7f0: 7572 6e0a 0a20 2020 2020 2020 2020 2020  urn..           
-0002a800: 2073 656c 662e 5f5f 7265 7472 6965 7665   self.__retrieve
-0002a810: 4c6f 6361 6c53 6571 5363 6865 6d65 2829  LocalSeqScheme()
-0002a820: 0a0a 2020 2020 2020 2020 2020 2020 6368  ..            ch
-0002a830: 6169 6e41 7373 6967 6e31 203d 2073 656c  ainAssign1 = sel
-0002a840: 662e 6173 7369 676e 436f 6f72 6450 6f6c  f.assignCoordPol
-0002a850: 796d 6572 5365 7175 656e 6365 2873 6571  ymerSequence(seq
-0002a860: 4964 312c 2061 746f 6d49 6431 290a 2020  Id1, atomId1).  
-0002a870: 2020 2020 2020 2020 2020 6368 6169 6e41            chainA
-0002a880: 7373 6967 6e32 203d 2073 656c 662e 6173  ssign2 = self.as
-0002a890: 7369 676e 436f 6f72 6450 6f6c 796d 6572  signCoordPolymer
-0002a8a0: 5365 7175 656e 6365 2873 6571 4964 322c  Sequence(seqId2,
-0002a8b0: 2061 746f 6d49 6432 290a 0a20 2020 2020   atomId2)..     
-0002a8c0: 2020 2020 2020 2069 6620 6c65 6e28 6368         if len(ch
-0002a8d0: 6169 6e41 7373 6967 6e31 2920 3d3d 2030  ainAssign1) == 0
-0002a8e0: 206f 7220 6c65 6e28 6368 6169 6e41 7373   or len(chainAss
-0002a8f0: 6967 6e32 2920 3d3d 2030 3a0a 2020 2020  ign2) == 0:.    
-0002a900: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0002a910: 726e 0a0a 2020 2020 2020 2020 2020 2020  rn..            
-0002a920: 7365 6c66 2e73 656c 6563 7443 6f6f 7264  self.selectCoord
-0002a930: 4174 6f6d 7328 6368 6169 6e41 7373 6967  Atoms(chainAssig
-0002a940: 6e31 2c20 7365 7149 6431 2c20 6174 6f6d  n1, seqId1, atom
-0002a950: 4964 312c 2046 616c 7365 2c20 2761 6e20  Id1, False, 'an 
-0002a960: 5244 4327 290a 2020 2020 2020 2020 2020  RDC').          
-0002a970: 2020 7365 6c66 2e73 656c 6563 7443 6f6f    self.selectCoo
-0002a980: 7264 4174 6f6d 7328 6368 6169 6e41 7373  rdAtoms(chainAss
-0002a990: 6967 6e32 2c20 7365 7149 6432 2c20 6174  ign2, seqId2, at
-0002a9a0: 6f6d 4964 322c 2046 616c 7365 2c20 2761  omId2, False, 'a
-0002a9b0: 6e20 5244 4327 290a 0a20 2020 2020 2020  n RDC')..       
-0002a9c0: 2020 2020 2069 6620 6c65 6e28 7365 6c66       if len(self
-0002a9d0: 2e61 746f 6d53 656c 6563 7469 6f6e 5365  .atomSelectionSe
-0002a9e0: 7429 203c 2032 3a0a 2020 2020 2020 2020  t) < 2:.        
-0002a9f0: 2020 2020 2020 2020 7265 7475 726e 0a0a          return..
-0002aa00: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-0002aa10: 6f74 2073 656c 662e 6172 6555 6e69 7175  ot self.areUniqu
-0002aa20: 6543 6f6f 7264 4174 6f6d 7328 2761 6e20  eCoordAtoms('an 
-0002aa30: 5244 4327 293a 0a20 2020 2020 2020 2020  RDC'):.         
-0002aa40: 2020 2020 2020 2072 6574 7572 6e0a 0a20         return.. 
-0002aa50: 2020 2020 2020 2020 2020 2063 6861 696e             chain
-0002aa60: 5f69 645f 3120 3d20 7365 6c66 2e61 746f  _id_1 = self.ato
-0002aa70: 6d53 656c 6563 7469 6f6e 5365 745b 305d  mSelectionSet[0]
-0002aa80: 5b30 5d5b 2763 6861 696e 5f69 6427 5d0a  [0]['chain_id'].
-0002aa90: 2020 2020 2020 2020 2020 2020 7365 715f              seq_
-0002aaa0: 6964 5f31 203d 2073 656c 662e 6174 6f6d  id_1 = self.atom
-0002aab0: 5365 6c65 6374 696f 6e53 6574 5b30 5d5b  SelectionSet[0][
-0002aac0: 305d 5b27 7365 715f 6964 275d 0a20 2020  0]['seq_id'].   
-0002aad0: 2020 2020 2020 2020 2063 6f6d 705f 6964           comp_id
-0002aae0: 5f31 203d 2073 656c 662e 6174 6f6d 5365  _1 = self.atomSe
-0002aaf0: 6c65 6374 696f 6e53 6574 5b30 5d5b 305d  lectionSet[0][0]
-0002ab00: 5b27 636f 6d70 5f69 6427 5d0a 2020 2020  ['comp_id'].    
-0002ab10: 2020 2020 2020 2020 6174 6f6d 5f69 645f          atom_id_
-0002ab20: 3120 3d20 7365 6c66 2e61 746f 6d53 656c  1 = self.atomSel
-0002ab30: 6563 7469 6f6e 5365 745b 305d 5b30 5d5b  ectionSet[0][0][
-0002ab40: 2761 746f 6d5f 6964 275d 0a0a 2020 2020  'atom_id']..    
-0002ab50: 2020 2020 2020 2020 6368 6169 6e5f 6964          chain_id
-0002ab60: 5f32 203d 2073 656c 662e 6174 6f6d 5365  _2 = self.atomSe
-0002ab70: 6c65 6374 696f 6e53 6574 5b31 5d5b 305d  lectionSet[1][0]
-0002ab80: 5b27 6368 6169 6e5f 6964 275d 0a20 2020  ['chain_id'].   
-0002ab90: 2020 2020 2020 2020 2073 6571 5f69 645f           seq_id_
-0002aba0: 3220 3d20 7365 6c66 2e61 746f 6d53 656c  2 = self.atomSel
-0002abb0: 6563 7469 6f6e 5365 745b 315d 5b30 5d5b  ectionSet[1][0][
-0002abc0: 2773 6571 5f69 6427 5d0a 2020 2020 2020  'seq_id'].      
-0002abd0: 2020 2020 2020 636f 6d70 5f69 645f 3220        comp_id_2 
-0002abe0: 3d20 7365 6c66 2e61 746f 6d53 656c 6563  = self.atomSelec
-0002abf0: 7469 6f6e 5365 745b 315d 5b30 5d5b 2763  tionSet[1][0]['c
-0002ac00: 6f6d 705f 6964 275d 0a20 2020 2020 2020  omp_id'].       
-0002ac10: 2020 2020 2061 746f 6d5f 6964 5f32 203d       atom_id_2 =
-0002ac20: 2073 656c 662e 6174 6f6d 5365 6c65 6374   self.atomSelect
-0002ac30: 696f 6e53 6574 5b31 5d5b 305d 5b27 6174  ionSet[1][0]['at
-0002ac40: 6f6d 5f69 6427 5d0a 0a20 2020 2020 2020  om_id']..       
-0002ac50: 2020 2020 2069 6620 2861 746f 6d5f 6964       if (atom_id
-0002ac60: 5f31 5b30 5d20 6e6f 7420 696e 2049 534f  _1[0] not in ISO
-0002ac70: 544f 5045 5f4e 554d 4245 5253 5f4f 465f  TOPE_NUMBERS_OF_
-0002ac80: 4e4d 525f 4f42 535f 4e55 4353 2920 6f72  NMR_OBS_NUCS) or
-0002ac90: 2028 6174 6f6d 5f69 645f 325b 305d 206e   (atom_id_2[0] n
-0002aca0: 6f74 2069 6e20 4953 4f54 4f50 455f 4e55  ot in ISOTOPE_NU
-0002acb0: 4d42 4552 535f 4f46 5f4e 4d52 5f4f 4253  MBERS_OF_NMR_OBS
-0002acc0: 5f4e 5543 5329 3a0a 2020 2020 2020 2020  _NUCS):.        
-0002acd0: 2020 2020 2020 2020 7365 6c66 2e5f 5f66          self.__f
-0002ace0: 2e61 7070 656e 6428 6622 5b49 6e76 616c  .append(f"[Inval
-0002acf0: 6964 2064 6174 615d 207b 7365 6c66 2e5f  id data] {self._
-0002ad00: 5f67 6574 4375 7272 656e 7452 6573 7472  _getCurrentRestr
-0002ad10: 6169 6e74 2829 7d22 0a20 2020 2020 2020  aint()}".       
+00029a60: 6622 7b66 756e 6354 7970 657d 2027 7765  f"{funcType} 'we
+00029a70: 6967 6874 3d7b 7765 6967 6874 7d27 206f  ight={weight}' o
+00029a80: 6620 7b6e 2b31 7d74 6820 6675 6e63 7469  f {n+1}th functi
+00029a90: 6f6e 2073 686f 756c 6420 6265 2061 2070  on should be a p
+00029aa0: 6f73 6974 6976 6520 7661 6c75 652e 2229  ositive value.")
+00029ab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029ac0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00029ad0: 2020 2020 2020 2020 2020 2076 616c 6964             valid
+00029ae0: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
+00029af0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00029b00: 662e 5f5f 662e 6170 7065 6e64 2866 225b  f.__f.append(f"[
+00029b10: 496e 7661 6c69 6420 6461 7461 5d20 7b73  Invalid data] {s
+00029b20: 656c 662e 5f5f 6765 7443 7572 7265 6e74  elf.__getCurrent
+00029b30: 5265 7374 7261 696e 7428 297d 220a 2020  Restraint()}".  
+00029b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029b60: 2020 6622 7b66 756e 6354 7970 657d 2072    f"{funcType} r
+00029b70: 6571 7569 7265 7320 636f 6e73 6563 7574  equires consecut
+00029b80: 6976 6520 3320 7061 7261 6d65 7465 7273  ive 3 parameters
+00029b90: 2028 6d65 616e 2c20 7364 2c20 7765 6967   (mean, sd, weig
+00029ba0: 6874 2920 666f 7220 6561 6368 2047 6175  ht) for each Gau
+00029bb0: 7373 6961 6e20 6675 6e63 7469 6f6e 2061  ssian function a
+00029bc0: 6674 6572 2074 6865 2066 6972 7374 2027  fter the first '
+00029bd0: 6e75 6d5f 6761 7573 7369 616e 7327 2076  num_gaussians' v
+00029be0: 616c 7565 2e22 290a 0a20 2020 2020 2020  alue.")..       
+00029bf0: 2020 2020 2069 6620 7661 6c69 643a 0a20       if valid:. 
+00029c00: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00029c10: 656c 662e 7374 6163 6b46 756e 6373 2e61  elf.stackFuncs.a
+00029c20: 7070 656e 6428 6675 6e63 290a 0a20 2020  ppend(func)..   
+00029c30: 2020 2020 2065 7863 6570 7420 5661 6c75       except Valu
+00029c40: 6545 7272 6f72 3a0a 2020 2020 2020 2020  eError:.        
+00029c50: 2020 2020 7061 7373 0a20 2020 2020 2020      pass.       
+00029c60: 2066 696e 616c 6c79 3a0a 2020 2020 2020   finally:.      
+00029c70: 2020 2020 2020 7365 6c66 2e6e 756d 6265        self.numbe
+00029c80: 7246 5365 6c65 6374 696f 6e2e 636c 6561  rFSelection.clea
+00029c90: 7228 290a 0a20 2020 2023 2045 6e74 6572  r()..    # Enter
+00029ca0: 2061 2070 6172 7365 2074 7265 6520 7072   a parse tree pr
+00029cb0: 6f64 7563 6564 2062 7920 526f 7365 7474  oduced by Rosett
+00029cc0: 614d 5250 6172 7365 7223 7264 635f 7265  aMRParser#rdc_re
+00029cd0: 7374 7261 696e 7473 2e0a 2020 2020 6465  straints..    de
+00029ce0: 6620 656e 7465 7252 6463 5f72 6573 7472  f enterRdc_restr
+00029cf0: 6169 6e74 7328 7365 6c66 2c20 6374 783a  aints(self, ctx:
+00029d00: 2052 6f73 6574 7461 4d52 5061 7273 6572   RosettaMRParser
+00029d10: 2e52 6463 5f72 6573 7472 6169 6e74 7343  .Rdc_restraintsC
+00029d20: 6f6e 7465 7874 293a 2020 2320 7079 6c69  ontext):  # pyli
+00029d30: 6e74 3a20 6469 7361 626c 653d 756e 7573  nt: disable=unus
+00029d40: 6564 2d61 7267 756d 656e 740a 2020 2020  ed-argument.    
+00029d50: 2020 2020 7365 6c66 2e5f 5f63 7572 5f73      self.__cur_s
+00029d60: 7562 7479 7065 203d 2027 7264 6327 0a0a  ubtype = 'rdc'..
+00029d70: 2020 2020 2320 4578 6974 2061 2070 6172      # Exit a par
+00029d80: 7365 2074 7265 6520 7072 6f64 7563 6564  se tree produced
+00029d90: 2062 7920 526f 7365 7474 614d 5250 6172   by RosettaMRPar
+00029da0: 7365 7223 7264 635f 7265 7374 7261 696e  ser#rdc_restrain
+00029db0: 7473 2e0a 2020 2020 6465 6620 6578 6974  ts..    def exit
+00029dc0: 5264 635f 7265 7374 7261 696e 7473 2873  Rdc_restraints(s
+00029dd0: 656c 662c 2063 7478 3a20 526f 7365 7474  elf, ctx: Rosett
+00029de0: 614d 5250 6172 7365 722e 5264 635f 7265  aMRParser.Rdc_re
+00029df0: 7374 7261 696e 7473 436f 6e74 6578 7429  straintsContext)
+00029e00: 3a20 2023 2070 796c 696e 743a 2064 6973  :  # pylint: dis
+00029e10: 6162 6c65 3d75 6e75 7365 642d 6172 6775  able=unused-argu
+00029e20: 6d65 6e74 0a20 2020 2020 2020 2070 6173  ment.        pas
+00029e30: 730a 0a20 2020 2023 2045 6e74 6572 2061  s..    # Enter a
+00029e40: 2070 6172 7365 2074 7265 6520 7072 6f64   parse tree prod
+00029e50: 7563 6564 2062 7920 526f 7365 7474 614d  uced by RosettaM
+00029e60: 5250 6172 7365 7223 7264 635f 7265 7374  RParser#rdc_rest
+00029e70: 7261 696e 742e 0a20 2020 2064 6566 2065  raint..    def e
+00029e80: 6e74 6572 5264 635f 7265 7374 7261 696e  nterRdc_restrain
+00029e90: 7428 7365 6c66 2c20 6374 783a 2052 6f73  t(self, ctx: Ros
+00029ea0: 6574 7461 4d52 5061 7273 6572 2e52 6463  ettaMRParser.Rdc
+00029eb0: 5f72 6573 7472 6169 6e74 436f 6e74 6578  _restraintContex
+00029ec0: 7429 3a20 2023 2070 796c 696e 743a 2064  t):  # pylint: d
+00029ed0: 6973 6162 6c65 3d75 6e75 7365 642d 6172  isable=unused-ar
+00029ee0: 6775 6d65 6e74 0a20 2020 2020 2020 2073  gument.        s
+00029ef0: 656c 662e 7264 6352 6573 7472 6169 6e74  elf.rdcRestraint
+00029f00: 7320 2b3d 2031 0a0a 2020 2020 2020 2020  s += 1..        
+00029f10: 7365 6c66 2e61 746f 6d53 656c 6563 7469  self.atomSelecti
+00029f20: 6f6e 5365 742e 636c 6561 7228 290a 0a20  onSet.clear().. 
+00029f30: 2020 2023 2045 7869 7420 6120 7061 7273     # Exit a pars
+00029f40: 6520 7472 6565 2070 726f 6475 6365 6420  e tree produced 
+00029f50: 6279 2052 6f73 6574 7461 4d52 5061 7273  by RosettaMRPars
+00029f60: 6572 2372 6463 5f72 6573 7472 6169 6e74  er#rdc_restraint
+00029f70: 2e0a 2020 2020 6465 6620 6578 6974 5264  ..    def exitRd
+00029f80: 635f 7265 7374 7261 696e 7428 7365 6c66  c_restraint(self
+00029f90: 2c20 6374 783a 2052 6f73 6574 7461 4d52  , ctx: RosettaMR
+00029fa0: 5061 7273 6572 2e52 6463 5f72 6573 7472  Parser.Rdc_restr
+00029fb0: 6169 6e74 436f 6e74 6578 7429 3a0a 0a20  aintContext):.. 
+00029fc0: 2020 2020 2020 2074 7279 3a0a 0a20 2020         try:..   
+00029fd0: 2020 2020 2020 2020 2073 6571 4964 3120           seqId1 
+00029fe0: 3d20 696e 7428 7374 7228 6374 782e 496e  = int(str(ctx.In
+00029ff0: 7465 6765 7228 3029 2929 0a20 2020 2020  teger(0))).     
+0002a000: 2020 2020 2020 2061 746f 6d49 6431 203d         atomId1 =
+0002a010: 2073 7472 2863 7478 2e53 696d 706c 655f   str(ctx.Simple_
+0002a020: 6e61 6d65 2830 2929 2e75 7070 6572 2829  name(0)).upper()
+0002a030: 0a20 2020 2020 2020 2020 2020 2073 6571  .            seq
+0002a040: 4964 3220 3d20 696e 7428 7374 7228 6374  Id2 = int(str(ct
+0002a050: 782e 496e 7465 6765 7228 3129 2929 0a20  x.Integer(1))). 
+0002a060: 2020 2020 2020 2020 2020 2061 746f 6d49             atomI
+0002a070: 6432 203d 2073 7472 2863 7478 2e53 696d  d2 = str(ctx.Sim
+0002a080: 706c 655f 6e61 6d65 2831 2929 2e75 7070  ple_name(1)).upp
+0002a090: 6572 2829 0a0a 2020 2020 2020 2020 2020  er()..          
+0002a0a0: 2020 6966 206c 656e 2873 656c 662e 6e75    if len(self.nu
+0002a0b0: 6d62 6572 5365 6c65 6374 696f 6e29 203d  mberSelection) =
+0002a0c0: 3d20 3020 6f72 204e 6f6e 6520 696e 2073  = 0 or None in s
+0002a0d0: 656c 662e 6e75 6d62 6572 5365 6c65 6374  elf.numberSelect
+0002a0e0: 696f 6e3a 0a20 2020 2020 2020 2020 2020  ion:.           
+0002a0f0: 2020 2020 2072 6574 7572 6e0a 0a20 2020       return..   
+0002a100: 2020 2020 2020 2020 2074 6172 6765 745f           target_
+0002a110: 7661 6c75 6520 3d20 7365 6c66 2e6e 756d  value = self.num
+0002a120: 6265 7253 656c 6563 7469 6f6e 5b30 5d0a  berSelection[0].
+0002a130: 0a20 2020 2020 2020 2020 2020 2076 616c  .            val
+0002a140: 6964 5261 6e67 6520 3d20 5472 7565 0a20  idRange = True. 
+0002a150: 2020 2020 2020 2020 2020 2064 7374 4675             dstFu
+0002a160: 6e63 203d 207b 2777 6569 6768 7427 3a20  nc = {'weight': 
+0002a170: 312e 307d 0a0a 2020 2020 2020 2020 2020  1.0}..          
+0002a180: 2020 6966 2074 6172 6765 745f 7661 6c75    if target_valu
+0002a190: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
+0002a1a0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0002a1b0: 6620 5244 435f 4552 524f 525f 4d49 4e20  f RDC_ERROR_MIN 
+0002a1c0: 3c20 7461 7267 6574 5f76 616c 7565 203c  < target_value <
+0002a1d0: 2052 4443 5f45 5252 4f52 5f4d 4158 3a0a   RDC_ERROR_MAX:.
+0002a1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a1f0: 2020 2020 6473 7446 756e 635b 2774 6172      dstFunc['tar
+0002a200: 6765 745f 7661 6c75 6527 5d20 3d20 6622  get_value'] = f"
+0002a210: 7b74 6172 6765 745f 7661 6c75 657d 220a  {target_value}".
+0002a220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a230: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0002a240: 2020 2020 2020 2020 2020 7661 6c69 6452            validR
+0002a250: 616e 6765 203d 2046 616c 7365 0a20 2020  ange = False.   
+0002a260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a270: 2073 656c 662e 5f5f 662e 6170 7065 6e64   self.__f.append
+0002a280: 2866 225b 5261 6e67 6520 7661 6c75 6520  (f"[Range value 
+0002a290: 6572 726f 725d 207b 7365 6c66 2e5f 5f67  error] {self.__g
+0002a2a0: 6574 4375 7272 656e 7452 6573 7472 6169  etCurrentRestrai
+0002a2b0: 6e74 2829 7d22 0a20 2020 2020 2020 2020  nt()}".         
+0002a2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a2d0: 2020 2020 2020 2020 2020 2066 2254 6865             f"The
+0002a2e0: 2074 6172 6765 7420 7661 6c75 653d 277b   target value='{
+0002a2f0: 7461 7267 6574 5f76 616c 7565 7d27 206d  target_value}' m
+0002a300: 7573 7420 6265 2077 6974 6869 6e20 7261  ust be within ra
+0002a310: 6e67 6520 7b52 4443 5f52 4553 5452 4149  nge {RDC_RESTRAI
+0002a320: 4e54 5f45 5252 4f52 7d2e 2229 0a0a 2020  NT_ERROR}.")..  
+0002a330: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+0002a340: 2076 616c 6964 5261 6e67 653a 0a20 2020   validRange:.   
+0002a350: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+0002a360: 7572 6e0a 0a20 2020 2020 2020 2020 2020  urn..           
+0002a370: 2069 6620 7461 7267 6574 5f76 616c 7565   if target_value
+0002a380: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+0002a390: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0002a3a0: 2052 4443 5f52 414e 4745 5f4d 494e 203c   RDC_RANGE_MIN <
+0002a3b0: 2074 6172 6765 745f 7661 6c75 6520 3c20   target_value < 
+0002a3c0: 5244 435f 5241 4e47 455f 4d41 583a 0a20  RDC_RANGE_MAX:. 
+0002a3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a3e0: 2020 2070 6173 730a 2020 2020 2020 2020     pass.        
+0002a3f0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0002a400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a410: 2020 7365 6c66 2e5f 5f66 2e61 7070 656e    self.__f.appen
+0002a420: 6428 6622 5b52 616e 6765 2076 616c 7565  d(f"[Range value
+0002a430: 2077 6172 6e69 6e67 5d20 7b73 656c 662e   warning] {self.
+0002a440: 5f5f 6765 7443 7572 7265 6e74 5265 7374  __getCurrentRest
+0002a450: 7261 696e 7428 297d 220a 2020 2020 2020  raint()}".      
+0002a460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a470: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+0002a480: 5468 6520 7461 7267 6574 2076 616c 7565  The target value
+0002a490: 3d27 7b74 6172 6765 745f 7661 6c75 657d  ='{target_value}
+0002a4a0: 2720 7368 6f75 6c64 2062 6520 7769 7468  ' should be with
+0002a4b0: 696e 2072 616e 6765 207b 5244 435f 5245  in range {RDC_RE
+0002a4c0: 5354 5241 494e 545f 5241 4e47 457d 2e22  STRAINT_RANGE}."
+0002a4d0: 290a 0a20 2020 2020 2020 2020 2020 2069  )..            i
+0002a4e0: 6620 6e6f 7420 7365 6c66 2e5f 5f68 6173  f not self.__has
+0002a4f0: 506f 6c79 5365 713a 0a20 2020 2020 2020  PolySeq:.       
+0002a500: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
+0002a510: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0002a520: 662e 5f5f 7265 7472 6965 7665 4c6f 6361  f.__retrieveLoca
+0002a530: 6c53 6571 5363 6865 6d65 2829 0a0a 2020  lSeqScheme()..  
+0002a540: 2020 2020 2020 2020 2020 6368 6169 6e41            chainA
+0002a550: 7373 6967 6e31 203d 2073 656c 662e 6173  ssign1 = self.as
+0002a560: 7369 676e 436f 6f72 6450 6f6c 796d 6572  signCoordPolymer
+0002a570: 5365 7175 656e 6365 2873 6571 4964 312c  Sequence(seqId1,
+0002a580: 2061 746f 6d49 6431 290a 2020 2020 2020   atomId1).      
+0002a590: 2020 2020 2020 6368 6169 6e41 7373 6967        chainAssig
+0002a5a0: 6e32 203d 2073 656c 662e 6173 7369 676e  n2 = self.assign
+0002a5b0: 436f 6f72 6450 6f6c 796d 6572 5365 7175  CoordPolymerSequ
+0002a5c0: 656e 6365 2873 6571 4964 322c 2061 746f  ence(seqId2, ato
+0002a5d0: 6d49 6432 290a 0a20 2020 2020 2020 2020  mId2)..         
+0002a5e0: 2020 2069 6620 6c65 6e28 6368 6169 6e41     if len(chainA
+0002a5f0: 7373 6967 6e31 2920 3d3d 2030 206f 7220  ssign1) == 0 or 
+0002a600: 6c65 6e28 6368 6169 6e41 7373 6967 6e32  len(chainAssign2
+0002a610: 2920 3d3d 2030 3a0a 2020 2020 2020 2020  ) == 0:.        
+0002a620: 2020 2020 2020 2020 7265 7475 726e 0a0a          return..
+0002a630: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0002a640: 2e73 656c 6563 7443 6f6f 7264 4174 6f6d  .selectCoordAtom
+0002a650: 7328 6368 6169 6e41 7373 6967 6e31 2c20  s(chainAssign1, 
+0002a660: 7365 7149 6431 2c20 6174 6f6d 4964 312c  seqId1, atomId1,
+0002a670: 2046 616c 7365 2c20 2761 6e20 5244 4327   False, 'an RDC'
+0002a680: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+0002a690: 6c66 2e73 656c 6563 7443 6f6f 7264 4174  lf.selectCoordAt
+0002a6a0: 6f6d 7328 6368 6169 6e41 7373 6967 6e32  oms(chainAssign2
+0002a6b0: 2c20 7365 7149 6432 2c20 6174 6f6d 4964  , seqId2, atomId
+0002a6c0: 322c 2046 616c 7365 2c20 2761 6e20 5244  2, False, 'an RD
+0002a6d0: 4327 290a 0a20 2020 2020 2020 2020 2020  C')..           
+0002a6e0: 2069 6620 6c65 6e28 7365 6c66 2e61 746f   if len(self.ato
+0002a6f0: 6d53 656c 6563 7469 6f6e 5365 7429 203c  mSelectionSet) <
+0002a700: 2032 3a0a 2020 2020 2020 2020 2020 2020   2:.            
+0002a710: 2020 2020 7265 7475 726e 0a0a 2020 2020      return..    
+0002a720: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
+0002a730: 656c 662e 6172 6555 6e69 7175 6543 6f6f  elf.areUniqueCoo
+0002a740: 7264 4174 6f6d 7328 2761 6e20 5244 4327  rdAtoms('an RDC'
+0002a750: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0002a760: 2020 2072 6574 7572 6e0a 0a20 2020 2020     return..     
+0002a770: 2020 2020 2020 2063 6861 696e 5f69 645f         chain_id_
+0002a780: 3120 3d20 7365 6c66 2e61 746f 6d53 656c  1 = self.atomSel
+0002a790: 6563 7469 6f6e 5365 745b 305d 5b30 5d5b  ectionSet[0][0][
+0002a7a0: 2763 6861 696e 5f69 6427 5d0a 2020 2020  'chain_id'].    
+0002a7b0: 2020 2020 2020 2020 7365 715f 6964 5f31          seq_id_1
+0002a7c0: 203d 2073 656c 662e 6174 6f6d 5365 6c65   = self.atomSele
+0002a7d0: 6374 696f 6e53 6574 5b30 5d5b 305d 5b27  ctionSet[0][0]['
+0002a7e0: 7365 715f 6964 275d 0a20 2020 2020 2020  seq_id'].       
+0002a7f0: 2020 2020 2063 6f6d 705f 6964 5f31 203d       comp_id_1 =
+0002a800: 2073 656c 662e 6174 6f6d 5365 6c65 6374   self.atomSelect
+0002a810: 696f 6e53 6574 5b30 5d5b 305d 5b27 636f  ionSet[0][0]['co
+0002a820: 6d70 5f69 6427 5d0a 2020 2020 2020 2020  mp_id'].        
+0002a830: 2020 2020 6174 6f6d 5f69 645f 3120 3d20      atom_id_1 = 
+0002a840: 7365 6c66 2e61 746f 6d53 656c 6563 7469  self.atomSelecti
+0002a850: 6f6e 5365 745b 305d 5b30 5d5b 2761 746f  onSet[0][0]['ato
+0002a860: 6d5f 6964 275d 0a0a 2020 2020 2020 2020  m_id']..        
+0002a870: 2020 2020 6368 6169 6e5f 6964 5f32 203d      chain_id_2 =
+0002a880: 2073 656c 662e 6174 6f6d 5365 6c65 6374   self.atomSelect
+0002a890: 696f 6e53 6574 5b31 5d5b 305d 5b27 6368  ionSet[1][0]['ch
+0002a8a0: 6169 6e5f 6964 275d 0a20 2020 2020 2020  ain_id'].       
+0002a8b0: 2020 2020 2073 6571 5f69 645f 3220 3d20       seq_id_2 = 
+0002a8c0: 7365 6c66 2e61 746f 6d53 656c 6563 7469  self.atomSelecti
+0002a8d0: 6f6e 5365 745b 315d 5b30 5d5b 2773 6571  onSet[1][0]['seq
+0002a8e0: 5f69 6427 5d0a 2020 2020 2020 2020 2020  _id'].          
+0002a8f0: 2020 636f 6d70 5f69 645f 3220 3d20 7365    comp_id_2 = se
+0002a900: 6c66 2e61 746f 6d53 656c 6563 7469 6f6e  lf.atomSelection
+0002a910: 5365 745b 315d 5b30 5d5b 2763 6f6d 705f  Set[1][0]['comp_
+0002a920: 6964 275d 0a20 2020 2020 2020 2020 2020  id'].           
+0002a930: 2061 746f 6d5f 6964 5f32 203d 2073 656c   atom_id_2 = sel
+0002a940: 662e 6174 6f6d 5365 6c65 6374 696f 6e53  f.atomSelectionS
+0002a950: 6574 5b31 5d5b 305d 5b27 6174 6f6d 5f69  et[1][0]['atom_i
+0002a960: 6427 5d0a 0a20 2020 2020 2020 2020 2020  d']..           
+0002a970: 2069 6620 2861 746f 6d5f 6964 5f31 5b30   if (atom_id_1[0
+0002a980: 5d20 6e6f 7420 696e 2049 534f 544f 5045  ] not in ISOTOPE
+0002a990: 5f4e 554d 4245 5253 5f4f 465f 4e4d 525f  _NUMBERS_OF_NMR_
+0002a9a0: 4f42 535f 4e55 4353 2920 6f72 2028 6174  OBS_NUCS) or (at
+0002a9b0: 6f6d 5f69 645f 325b 305d 206e 6f74 2069  om_id_2[0] not i
+0002a9c0: 6e20 4953 4f54 4f50 455f 4e55 4d42 4552  n ISOTOPE_NUMBER
+0002a9d0: 535f 4f46 5f4e 4d52 5f4f 4253 5f4e 5543  S_OF_NMR_OBS_NUC
+0002a9e0: 5329 3a0a 2020 2020 2020 2020 2020 2020  S):.            
+0002a9f0: 2020 2020 7365 6c66 2e5f 5f66 2e61 7070      self.__f.app
+0002aa00: 656e 6428 6622 5b49 6e76 616c 6964 2064  end(f"[Invalid d
+0002aa10: 6174 615d 207b 7365 6c66 2e5f 5f67 6574  ata] {self.__get
+0002aa20: 4375 7272 656e 7452 6573 7472 6169 6e74  CurrentRestraint
+0002aa30: 2829 7d22 0a20 2020 2020 2020 2020 2020  ()}".           
+0002aa40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002aa50: 2020 2020 2022 4e6f 6e2d 6d61 676e 6574       "Non-magnet
+0002aa60: 6963 2073 7573 6365 7074 6962 6c65 2073  ic susceptible s
+0002aa70: 7069 6e20 6170 7065 6172 7320 696e 2052  pin appears in R
+0002aa80: 4443 2076 6563 746f 723b 2022 0a20 2020  DC vector; ".   
+0002aa90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002aaa0: 2020 2020 2020 2020 2020 2020 2066 2228               f"(
+0002aab0: 7b63 6861 696e 5f69 645f 317d 3a7b 7365  {chain_id_1}:{se
+0002aac0: 715f 6964 5f31 7d3a 7b63 6f6d 705f 6964  q_id_1}:{comp_id
+0002aad0: 5f31 7d3a 7b61 746f 6d5f 6964 5f31 7d2c  _1}:{atom_id_1},
+0002aae0: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+0002aaf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ab00: 2020 2066 227b 6368 6169 6e5f 6964 5f32     f"{chain_id_2
+0002ab10: 7d3a 7b73 6571 5f69 645f 327d 3a7b 636f  }:{seq_id_2}:{co
+0002ab20: 6d70 5f69 645f 327d 3a7b 6174 6f6d 5f69  mp_id_2}:{atom_i
+0002ab30: 645f 327d 292e 2229 0a20 2020 2020 2020  d_2}).").       
+0002ab40: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
+0002ab50: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0002ab60: 6368 6169 6e5f 6964 5f31 2021 3d20 6368  chain_id_1 != ch
+0002ab70: 6169 6e5f 6964 5f32 3a0a 2020 2020 2020  ain_id_2:.      
+0002ab80: 2020 2020 2020 2020 2020 7073 3120 3d20            ps1 = 
+0002ab90: 6e65 7874 2828 7073 2066 6f72 2070 7320  next((ps for ps 
+0002aba0: 696e 2073 656c 662e 5f5f 706f 6c79 5365  in self.__polySe
+0002abb0: 7120 6966 2070 735b 2761 7574 685f 6368  q if ps['auth_ch
+0002abc0: 6169 6e5f 6964 275d 203d 3d20 6368 6169  ain_id'] == chai
+0002abd0: 6e5f 6964 5f31 2061 6e64 2027 6964 656e  n_id_1 and 'iden
+0002abe0: 7469 6361 6c5f 6175 7468 5f63 6861 696e  tical_auth_chain
+0002abf0: 5f69 6427 2069 6e20 7073 292c 204e 6f6e  _id' in ps), Non
+0002ac00: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
+0002ac10: 2020 2070 7332 203d 206e 6578 7428 2870     ps2 = next((p
+0002ac20: 7320 666f 7220 7073 2069 6e20 7365 6c66  s for ps in self
+0002ac30: 2e5f 5f70 6f6c 7953 6571 2069 6620 7073  .__polySeq if ps
+0002ac40: 5b27 6175 7468 5f63 6861 696e 5f69 6427  ['auth_chain_id'
+0002ac50: 5d20 3d3d 2063 6861 696e 5f69 645f 3220  ] == chain_id_2 
+0002ac60: 616e 6420 2769 6465 6e74 6963 616c 5f61  and 'identical_a
+0002ac70: 7574 685f 6368 6169 6e5f 6964 2720 696e  uth_chain_id' in
+0002ac80: 2070 7329 2c20 4e6f 6e65 290a 2020 2020   ps), None).    
+0002ac90: 2020 2020 2020 2020 2020 2020 6966 2070              if p
+0002aca0: 7331 2069 7320 4e6f 6e65 2061 6e64 2070  s1 is None and p
+0002acb0: 7332 2069 7320 4e6f 6e65 3a0a 2020 2020  s2 is None:.    
+0002acc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002acd0: 7365 6c66 2e5f 5f66 2e61 7070 656e 6428  self.__f.append(
+0002ace0: 6622 5b49 6e76 616c 6964 2064 6174 615d  f"[Invalid data]
+0002acf0: 207b 7365 6c66 2e5f 5f67 6574 4375 7272   {self.__getCurr
+0002ad00: 656e 7452 6573 7472 6169 6e74 2829 7d22  entRestraint()}"
+0002ad10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 0002ad20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ad30: 2020 2020 2020 2020 2022 4e6f 6e2d 6d61           "Non-ma
-0002ad40: 676e 6574 6963 2073 7573 6365 7074 6962  gnetic susceptib
-0002ad50: 6c65 2073 7069 6e20 6170 7065 6172 7320  le spin appears 
-0002ad60: 696e 2052 4443 2076 6563 746f 723b 2022  in RDC vector; "
-0002ad70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002ad80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ad90: 2066 2228 7b63 6861 696e 5f69 645f 317d   f"({chain_id_1}
-0002ada0: 3a7b 7365 715f 6964 5f31 7d3a 7b63 6f6d  :{seq_id_1}:{com
-0002adb0: 705f 6964 5f31 7d3a 7b61 746f 6d5f 6964  p_id_1}:{atom_id
-0002adc0: 5f31 7d2c 2022 0a20 2020 2020 2020 2020  _1}, ".         
-0002add0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ade0: 2020 2020 2020 2066 227b 6368 6169 6e5f         f"{chain_
-0002adf0: 6964 5f32 7d3a 7b73 6571 5f69 645f 327d  id_2}:{seq_id_2}
-0002ae00: 3a7b 636f 6d70 5f69 645f 327d 3a7b 6174  :{comp_id_2}:{at
-0002ae10: 6f6d 5f69 645f 327d 292e 2229 0a20 2020  om_id_2}).").   
-0002ae20: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-0002ae30: 7572 6e0a 0a20 2020 2020 2020 2020 2020  urn..           
-0002ae40: 2069 6620 6368 6169 6e5f 6964 5f31 2021   if chain_id_1 !
-0002ae50: 3d20 6368 6169 6e5f 6964 5f32 3a0a 2020  = chain_id_2:.  
-0002ae60: 2020 2020 2020 2020 2020 2020 2020 7073                ps
-0002ae70: 3120 3d20 6e65 7874 2828 7073 2066 6f72  1 = next((ps for
-0002ae80: 2070 7320 696e 2073 656c 662e 5f5f 706f   ps in self.__po
-0002ae90: 6c79 5365 7120 6966 2070 735b 2761 7574  lySeq if ps['aut
-0002aea0: 685f 6368 6169 6e5f 6964 275d 203d 3d20  h_chain_id'] == 
-0002aeb0: 6368 6169 6e5f 6964 5f31 2061 6e64 2027  chain_id_1 and '
-0002aec0: 6964 656e 7469 6361 6c5f 6175 7468 5f63  identical_auth_c
-0002aed0: 6861 696e 5f69 6427 2069 6e20 7073 292c  hain_id' in ps),
-0002aee0: 204e 6f6e 6529 0a20 2020 2020 2020 2020   None).         
-0002aef0: 2020 2020 2020 2070 7332 203d 206e 6578         ps2 = nex
-0002af00: 7428 2870 7320 666f 7220 7073 2069 6e20  t((ps for ps in 
-0002af10: 7365 6c66 2e5f 5f70 6f6c 7953 6571 2069  self.__polySeq i
-0002af20: 6620 7073 5b27 6175 7468 5f63 6861 696e  f ps['auth_chain
-0002af30: 5f69 6427 5d20 3d3d 2063 6861 696e 5f69  _id'] == chain_i
-0002af40: 645f 3220 616e 6420 2769 6465 6e74 6963  d_2 and 'identic
-0002af50: 616c 5f61 7574 685f 6368 6169 6e5f 6964  al_auth_chain_id
-0002af60: 2720 696e 2070 7329 2c20 4e6f 6e65 290a  ' in ps), None).
-0002af70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002af80: 6966 2070 7331 2069 7320 4e6f 6e65 2061  if ps1 is None a
-0002af90: 6e64 2070 7332 2069 7320 4e6f 6e65 3a0a  nd ps2 is None:.
-0002afa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002afb0: 2020 2020 7365 6c66 2e5f 5f66 2e61 7070      self.__f.app
-0002afc0: 656e 6428 6622 5b49 6e76 616c 6964 2064  end(f"[Invalid d
-0002afd0: 6174 615d 207b 7365 6c66 2e5f 5f67 6574  ata] {self.__get
-0002afe0: 4375 7272 656e 7452 6573 7472 6169 6e74  CurrentRestraint
-0002aff0: 2829 7d22 0a20 2020 2020 2020 2020 2020  ()}".           
-0002b000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b010: 2020 2020 2020 2020 2022 466f 756e 6420           "Found 
-0002b020: 696e 7465 722d 6368 6169 6e20 5244 4320  inter-chain RDC 
-0002b030: 7665 6374 6f72 3b20 220a 2020 2020 2020  vector; ".      
-0002b040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b050: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-0002b060: 287b 6368 6169 6e5f 6964 5f31 7d3a 7b73  ({chain_id_1}:{s
-0002b070: 6571 5f69 645f 317d 3a7b 636f 6d70 5f69  eq_id_1}:{comp_i
-0002b080: 645f 317d 3a7b 6174 6f6d 5f69 645f 317d  d_1}:{atom_id_1}
-0002b090: 2c20 7b63 6861 696e 5f69 645f 327d 3a7b  , {chain_id_2}:{
-0002b0a0: 7365 715f 6964 5f32 7d3a 7b63 6f6d 705f  seq_id_2}:{comp_
-0002b0b0: 6964 5f32 7d3a 7b61 746f 6d5f 6964 5f32  id_2}:{atom_id_2
-0002b0c0: 7d29 2e22 290a 2020 2020 2020 2020 2020  }).").          
-0002b0d0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0002b0e0: 0a0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-0002b0f0: 6966 2061 6273 2873 6571 5f69 645f 3120  if abs(seq_id_1 
-0002b100: 2d20 7365 715f 6964 5f32 2920 3e20 313a  - seq_id_2) > 1:
-0002b110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002b120: 2070 7331 203d 206e 6578 7428 2870 7320   ps1 = next((ps 
-0002b130: 666f 7220 7073 2069 6e20 7365 6c66 2e5f  for ps in self._
-0002b140: 5f70 6f6c 7953 6571 2069 6620 7073 5b27  _polySeq if ps['
-0002b150: 6175 7468 5f63 6861 696e 5f69 6427 5d20  auth_chain_id'] 
-0002b160: 3d3d 2063 6861 696e 5f69 645f 3120 616e  == chain_id_1 an
-0002b170: 6420 2767 6170 5f69 6e5f 6175 7468 5f73  d 'gap_in_auth_s
-0002b180: 6571 2720 696e 2070 7320 616e 6420 7073  eq' in ps and ps
-0002b190: 5b27 6761 705f 696e 5f61 7574 685f 7365  ['gap_in_auth_se
-0002b1a0: 7127 5d29 2c20 4e6f 6e65 290a 2020 2020  q']), None).    
-0002b1b0: 2020 2020 2020 2020 2020 2020 6966 2070              if p
-0002b1c0: 7331 2069 7320 4e6f 6e65 3a0a 2020 2020  s1 is None:.    
-0002b1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b1e0: 7365 6c66 2e5f 5f66 2e61 7070 656e 6428  self.__f.append(
-0002b1f0: 6622 5b49 6e76 616c 6964 2064 6174 615d  f"[Invalid data]
-0002b200: 207b 7365 6c66 2e5f 5f67 6574 4375 7272   {self.__getCurr
-0002b210: 656e 7452 6573 7472 6169 6e74 2829 7d22  entRestraint()}"
-0002b220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002b230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b240: 2020 2020 2022 466f 756e 6420 696e 7465       "Found inte
-0002b250: 722d 7265 7369 6475 6520 5244 4320 7665  r-residue RDC ve
-0002b260: 6374 6f72 3b20 220a 2020 2020 2020 2020  ctor; ".        
-0002b270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b280: 2020 2020 2020 2020 2020 2020 6622 287b              f"({
-0002b290: 6368 6169 6e5f 6964 5f31 7d3a 7b73 6571  chain_id_1}:{seq
-0002b2a0: 5f69 645f 317d 3a7b 636f 6d70 5f69 645f  _id_1}:{comp_id_
-0002b2b0: 317d 3a7b 6174 6f6d 5f69 645f 317d 2c20  1}:{atom_id_1}, 
-0002b2c0: 7b63 6861 696e 5f69 645f 327d 3a7b 7365  {chain_id_2}:{se
-0002b2d0: 715f 6964 5f32 7d3a 7b63 6f6d 705f 6964  q_id_2}:{comp_id
-0002b2e0: 5f32 7d3a 7b61 746f 6d5f 6964 5f32 7d29  _2}:{atom_id_2})
-0002b2f0: 2e22 290a 2020 2020 2020 2020 2020 2020  .").            
-0002b300: 2020 2020 2020 2020 7265 7475 726e 0a0a          return..
-0002b310: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-0002b320: 2061 6273 2873 6571 5f69 645f 3120 2d20   abs(seq_id_1 - 
-0002b330: 7365 715f 6964 5f32 2920 3d3d 2031 3a0a  seq_id_2) == 1:.
-0002b340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002b350: 2069 6620 7365 6c66 2e5f 5f63 7353 7461   if self.__csSta
-0002b360: 742e 7065 7074 6964 654c 696b 6528 636f  t.peptideLike(co
-0002b370: 6d70 5f69 645f 3129 2061 6e64 2073 656c  mp_id_1) and sel
-0002b380: 662e 5f5f 6373 5374 6174 2e70 6570 7469  f.__csStat.pepti
-0002b390: 6465 4c69 6b65 2863 6f6d 705f 6964 5f32  deLike(comp_id_2
-0002b3a0: 2920 616e 645c 0a20 2020 2020 2020 2020  ) and\.         
-0002b3b0: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-0002b3c0: 2873 6571 5f69 645f 3120 3c20 7365 715f  (seq_id_1 < seq_
-0002b3d0: 6964 5f32 2061 6e64 2061 746f 6d5f 6964  id_2 and atom_id
-0002b3e0: 5f31 203d 3d20 2743 2720 616e 6420 6174  _1 == 'C' and at
-0002b3f0: 6f6d 5f69 645f 3220 696e 2072 6463 4262  om_id_2 in rdcBb
-0002b400: 5061 6972 436f 6465 290a 2020 2020 2020  PairCode).      
-0002b410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b420: 2020 206f 7220 2873 6571 5f69 645f 3120     or (seq_id_1 
-0002b430: 3e20 7365 715f 6964 5f32 2061 6e64 2061  > seq_id_2 and a
-0002b440: 746f 6d5f 6964 5f31 2069 6e20 7264 6342  tom_id_1 in rdcB
-0002b450: 6250 6169 7243 6f64 6520 616e 6420 6174  bPairCode and at
-0002b460: 6f6d 5f69 645f 3220 3d3d 2027 4327 2929  om_id_2 == 'C'))
-0002b470: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002b480: 2020 2020 2020 7061 7373 0a0a 2020 2020        pass..    
-0002b490: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0002b4a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002b4b0: 2020 2020 2020 7365 6c66 2e5f 5f66 2e61        self.__f.a
-0002b4c0: 7070 656e 6428 6622 5b49 6e76 616c 6964  ppend(f"[Invalid
-0002b4d0: 2064 6174 615d 207b 7365 6c66 2e5f 5f67   data] {self.__g
-0002b4e0: 6574 4375 7272 656e 7452 6573 7472 6169  etCurrentRestrai
-0002b4f0: 6e74 2829 7d22 0a20 2020 2020 2020 2020  nt()}".         
+0002ad30: 2020 2020 2022 466f 756e 6420 696e 7465       "Found inte
+0002ad40: 722d 6368 6169 6e20 5244 4320 7665 6374  r-chain RDC vect
+0002ad50: 6f72 3b20 220a 2020 2020 2020 2020 2020  or; ".          
+0002ad60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ad70: 2020 2020 2020 2020 2020 6622 287b 6368            f"({ch
+0002ad80: 6169 6e5f 6964 5f31 7d3a 7b73 6571 5f69  ain_id_1}:{seq_i
+0002ad90: 645f 317d 3a7b 636f 6d70 5f69 645f 317d  d_1}:{comp_id_1}
+0002ada0: 3a7b 6174 6f6d 5f69 645f 317d 2c20 7b63  :{atom_id_1}, {c
+0002adb0: 6861 696e 5f69 645f 327d 3a7b 7365 715f  hain_id_2}:{seq_
+0002adc0: 6964 5f32 7d3a 7b63 6f6d 705f 6964 5f32  id_2}:{comp_id_2
+0002add0: 7d3a 7b61 746f 6d5f 6964 5f32 7d29 2e22  }:{atom_id_2})."
+0002ade0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0002adf0: 2020 2020 2020 7265 7475 726e 0a0a 2020        return..  
+0002ae00: 2020 2020 2020 2020 2020 656c 6966 2061            elif a
+0002ae10: 6273 2873 6571 5f69 645f 3120 2d20 7365  bs(seq_id_1 - se
+0002ae20: 715f 6964 5f32 2920 3e20 313a 0a20 2020  q_id_2) > 1:.   
+0002ae30: 2020 2020 2020 2020 2020 2020 2070 7331               ps1
+0002ae40: 203d 206e 6578 7428 2870 7320 666f 7220   = next((ps for 
+0002ae50: 7073 2069 6e20 7365 6c66 2e5f 5f70 6f6c  ps in self.__pol
+0002ae60: 7953 6571 2069 6620 7073 5b27 6175 7468  ySeq if ps['auth
+0002ae70: 5f63 6861 696e 5f69 6427 5d20 3d3d 2063  _chain_id'] == c
+0002ae80: 6861 696e 5f69 645f 3120 616e 6420 2767  hain_id_1 and 'g
+0002ae90: 6170 5f69 6e5f 6175 7468 5f73 6571 2720  ap_in_auth_seq' 
+0002aea0: 696e 2070 7320 616e 6420 7073 5b27 6761  in ps and ps['ga
+0002aeb0: 705f 696e 5f61 7574 685f 7365 7127 5d29  p_in_auth_seq'])
+0002aec0: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
+0002aed0: 2020 2020 2020 2020 6966 2070 7331 2069          if ps1 i
+0002aee0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+0002aef0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0002af00: 2e5f 5f66 2e61 7070 656e 6428 6622 5b49  .__f.append(f"[I
+0002af10: 6e76 616c 6964 2064 6174 615d 207b 7365  nvalid data] {se
+0002af20: 6c66 2e5f 5f67 6574 4375 7272 656e 7452  lf.__getCurrentR
+0002af30: 6573 7472 6169 6e74 2829 7d22 0a20 2020  estraint()}".   
+0002af40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002af50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002af60: 2022 466f 756e 6420 696e 7465 722d 7265   "Found inter-re
+0002af70: 7369 6475 6520 5244 4320 7665 6374 6f72  sidue RDC vector
+0002af80: 3b20 220a 2020 2020 2020 2020 2020 2020  ; ".            
+0002af90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002afa0: 2020 2020 2020 2020 6622 287b 6368 6169          f"({chai
+0002afb0: 6e5f 6964 5f31 7d3a 7b73 6571 5f69 645f  n_id_1}:{seq_id_
+0002afc0: 317d 3a7b 636f 6d70 5f69 645f 317d 3a7b  1}:{comp_id_1}:{
+0002afd0: 6174 6f6d 5f69 645f 317d 2c20 7b63 6861  atom_id_1}, {cha
+0002afe0: 696e 5f69 645f 327d 3a7b 7365 715f 6964  in_id_2}:{seq_id
+0002aff0: 5f32 7d3a 7b63 6f6d 705f 6964 5f32 7d3a  _2}:{comp_id_2}:
+0002b000: 7b61 746f 6d5f 6964 5f32 7d29 2e22 290a  {atom_id_2}).").
+0002b010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b020: 2020 2020 7265 7475 726e 0a0a 2020 2020      return..    
+0002b030: 2020 2020 2020 2020 656c 6966 2061 6273          elif abs
+0002b040: 2873 6571 5f69 645f 3120 2d20 7365 715f  (seq_id_1 - seq_
+0002b050: 6964 5f32 2920 3d3d 2031 3a0a 0a20 2020  id_2) == 1:..   
+0002b060: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0002b070: 7365 6c66 2e5f 5f63 7353 7461 742e 7065  self.__csStat.pe
+0002b080: 7074 6964 654c 696b 6528 636f 6d70 5f69  ptideLike(comp_i
+0002b090: 645f 3129 2061 6e64 2073 656c 662e 5f5f  d_1) and self.__
+0002b0a0: 6373 5374 6174 2e70 6570 7469 6465 4c69  csStat.peptideLi
+0002b0b0: 6b65 2863 6f6d 705f 6964 5f32 2920 616e  ke(comp_id_2) an
+0002b0c0: 645c 0a20 2020 2020 2020 2020 2020 2020  d\.             
+0002b0d0: 2020 2020 2020 2020 2020 2028 2873 6571             ((seq
+0002b0e0: 5f69 645f 3120 3c20 7365 715f 6964 5f32  _id_1 < seq_id_2
+0002b0f0: 2061 6e64 2061 746f 6d5f 6964 5f31 203d   and atom_id_1 =
+0002b100: 3d20 2743 2720 616e 6420 6174 6f6d 5f69  = 'C' and atom_i
+0002b110: 645f 3220 696e 2072 6463 4262 5061 6972  d_2 in rdcBbPair
+0002b120: 436f 6465 290a 2020 2020 2020 2020 2020  Code).          
+0002b130: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+0002b140: 7220 2873 6571 5f69 645f 3120 3e20 7365  r (seq_id_1 > se
+0002b150: 715f 6964 5f32 2061 6e64 2061 746f 6d5f  q_id_2 and atom_
+0002b160: 6964 5f31 2069 6e20 7264 6342 6250 6169  id_1 in rdcBbPai
+0002b170: 7243 6f64 6520 616e 6420 6174 6f6d 5f69  rCode and atom_i
+0002b180: 645f 3220 3d3d 2027 4327 2929 3a0a 2020  d_2 == 'C')):.  
+0002b190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b1a0: 2020 7061 7373 0a0a 2020 2020 2020 2020    pass..        
+0002b1b0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0002b1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b1d0: 2020 7365 6c66 2e5f 5f66 2e61 7070 656e    self.__f.appen
+0002b1e0: 6428 6622 5b49 6e76 616c 6964 2064 6174  d(f"[Invalid dat
+0002b1f0: 615d 207b 7365 6c66 2e5f 5f67 6574 4375  a] {self.__getCu
+0002b200: 7272 656e 7452 6573 7472 6169 6e74 2829  rrentRestraint()
+0002b210: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
+0002b220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b230: 2020 2020 2020 2022 466f 756e 6420 696e         "Found in
+0002b240: 7465 722d 7265 7369 6475 6520 5244 4320  ter-residue RDC 
+0002b250: 7665 6374 6f72 3b20 220a 2020 2020 2020  vector; ".      
+0002b260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b270: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+0002b280: 287b 6368 6169 6e5f 6964 5f31 7d3a 7b73  ({chain_id_1}:{s
+0002b290: 6571 5f69 645f 317d 3a7b 636f 6d70 5f69  eq_id_1}:{comp_i
+0002b2a0: 645f 317d 3a7b 6174 6f6d 5f69 645f 317d  d_1}:{atom_id_1}
+0002b2b0: 2c20 7b63 6861 696e 5f69 645f 327d 3a7b  , {chain_id_2}:{
+0002b2c0: 7365 715f 6964 5f32 7d3a 7b63 6f6d 705f  seq_id_2}:{comp_
+0002b2d0: 6964 5f32 7d3a 7b61 746f 6d5f 6964 5f32  id_2}:{atom_id_2
+0002b2e0: 7d29 2e22 290a 2020 2020 2020 2020 2020  }).").          
+0002b2f0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0002b300: 0a0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+0002b310: 6966 2061 746f 6d5f 6964 5f31 203d 3d20  if atom_id_1 == 
+0002b320: 6174 6f6d 5f69 645f 323a 0a20 2020 2020  atom_id_2:.     
+0002b330: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0002b340: 5f5f 662e 6170 7065 6e64 2866 225b 496e  __f.append(f"[In
+0002b350: 7661 6c69 6420 6461 7461 5d20 7b73 656c  valid data] {sel
+0002b360: 662e 5f5f 6765 7443 7572 7265 6e74 5265  f.__getCurrentRe
+0002b370: 7374 7261 696e 7428 297d 220a 2020 2020  straint()}".    
+0002b380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b390: 2020 2020 2020 2020 2020 2020 2246 6f75              "Fou
+0002b3a0: 6e64 207a 6572 6f20 5244 4320 7665 6374  nd zero RDC vect
+0002b3b0: 6f72 3b20 220a 2020 2020 2020 2020 2020  or; ".          
+0002b3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b3d0: 2020 2020 2020 6622 287b 6368 6169 6e5f        f"({chain_
+0002b3e0: 6964 5f31 7d3a 7b73 6571 5f69 645f 317d  id_1}:{seq_id_1}
+0002b3f0: 3a7b 636f 6d70 5f69 645f 317d 3a7b 6174  :{comp_id_1}:{at
+0002b400: 6f6d 5f69 645f 317d 2c20 7b63 6861 696e  om_id_1}, {chain
+0002b410: 5f69 645f 327d 3a7b 7365 715f 6964 5f32  _id_2}:{seq_id_2
+0002b420: 7d3a 7b63 6f6d 705f 6964 5f32 7d3a 7b61  }:{comp_id_2}:{a
+0002b430: 746f 6d5f 6964 5f32 7d29 2e22 290a 2020  tom_id_2}).").  
+0002b440: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0002b450: 7475 726e 0a0a 2020 2020 2020 2020 2020  turn..          
+0002b460: 2020 656c 6966 2073 656c 662e 5f5f 6363    elif self.__cc
+0002b470: 552e 7570 6461 7465 4368 656d 436f 6d70  U.updateChemComp
+0002b480: 4469 6374 2863 6f6d 705f 6964 5f31 293a  Dict(comp_id_1):
+0002b490: 2020 2320 6d61 7463 6865 7320 7769 7468    # matches with
+0002b4a0: 2063 6f6d 705f 6964 2069 6e20 4343 440a   comp_id in CCD.
+0002b4b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002b4c0: 2069 6620 6e6f 7420 7365 6c66 2e5f 5f63   if not self.__c
+0002b4d0: 6355 2e68 6173 426f 6e64 2863 6f6d 705f  cU.hasBond(comp_
+0002b4e0: 6964 5f31 2c20 6174 6f6d 5f69 645f 312c  id_1, atom_id_1,
+0002b4f0: 2061 746f 6d5f 6964 5f32 293a 0a0a 2020   atom_id_2):..  
 0002b500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b510: 2020 2020 2020 2020 2020 2022 466f 756e             "Foun
-0002b520: 6420 696e 7465 722d 7265 7369 6475 6520  d inter-residue 
-0002b530: 5244 4320 7665 6374 6f72 3b20 220a 2020  RDC vector; ".  
-0002b540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b560: 2020 6622 287b 6368 6169 6e5f 6964 5f31    f"({chain_id_1
-0002b570: 7d3a 7b73 6571 5f69 645f 317d 3a7b 636f  }:{seq_id_1}:{co
-0002b580: 6d70 5f69 645f 317d 3a7b 6174 6f6d 5f69  mp_id_1}:{atom_i
-0002b590: 645f 317d 2c20 7b63 6861 696e 5f69 645f  d_1}, {chain_id_
-0002b5a0: 327d 3a7b 7365 715f 6964 5f32 7d3a 7b63  2}:{seq_id_2}:{c
-0002b5b0: 6f6d 705f 6964 5f32 7d3a 7b61 746f 6d5f  omp_id_2}:{atom_
-0002b5c0: 6964 5f32 7d29 2e22 290a 2020 2020 2020  id_2}).").      
-0002b5d0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0002b5e0: 7475 726e 0a0a 2020 2020 2020 2020 2020  turn..          
-0002b5f0: 2020 656c 6966 2061 746f 6d5f 6964 5f31    elif atom_id_1
-0002b600: 203d 3d20 6174 6f6d 5f69 645f 323a 0a20   == atom_id_2:. 
-0002b610: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0002b620: 656c 662e 5f5f 662e 6170 7065 6e64 2866  elf.__f.append(f
-0002b630: 225b 496e 7661 6c69 6420 6461 7461 5d20  "[Invalid data] 
-0002b640: 7b73 656c 662e 5f5f 6765 7443 7572 7265  {self.__getCurre
-0002b650: 6e74 5265 7374 7261 696e 7428 297d 220a  ntRestraint()}".
-0002b660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b680: 2246 6f75 6e64 207a 6572 6f20 5244 4320  "Found zero RDC 
-0002b690: 7665 6374 6f72 3b20 220a 2020 2020 2020  vector; ".      
-0002b6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b6b0: 2020 2020 2020 2020 2020 6622 287b 6368            f"({ch
-0002b6c0: 6169 6e5f 6964 5f31 7d3a 7b73 6571 5f69  ain_id_1}:{seq_i
-0002b6d0: 645f 317d 3a7b 636f 6d70 5f69 645f 317d  d_1}:{comp_id_1}
-0002b6e0: 3a7b 6174 6f6d 5f69 645f 317d 2c20 7b63  :{atom_id_1}, {c
-0002b6f0: 6861 696e 5f69 645f 327d 3a7b 7365 715f  hain_id_2}:{seq_
-0002b700: 6964 5f32 7d3a 7b63 6f6d 705f 6964 5f32  id_2}:{comp_id_2
-0002b710: 7d3a 7b61 746f 6d5f 6964 5f32 7d29 2e22  }:{atom_id_2})."
-0002b720: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0002b730: 2020 7265 7475 726e 0a0a 2020 2020 2020    return..      
-0002b740: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
-0002b750: 5f5f 6363 552e 7570 6461 7465 4368 656d  __ccU.updateChem
-0002b760: 436f 6d70 4469 6374 2863 6f6d 705f 6964  CompDict(comp_id
-0002b770: 5f31 293a 2020 2320 6d61 7463 6865 7320  _1):  # matches 
-0002b780: 7769 7468 2063 6f6d 705f 6964 2069 6e20  with comp_id in 
-0002b790: 4343 440a 0a20 2020 2020 2020 2020 2020  CCD..           
-0002b7a0: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
-0002b7b0: 2e5f 5f63 6355 2e68 6173 426f 6e64 2863  .__ccU.hasBond(c
-0002b7c0: 6f6d 705f 6964 5f31 2c20 6174 6f6d 5f69  omp_id_1, atom_i
-0002b7d0: 645f 312c 2061 746f 6d5f 6964 5f32 293a  d_1, atom_id_2):
-0002b7e0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002b7f0: 2020 2020 2020 6966 2073 656c 662e 5f5f        if self.__
-0002b800: 6e65 6654 2e76 616c 6964 6174 655f 636f  nefT.validate_co
-0002b810: 6d70 5f61 746f 6d28 636f 6d70 5f69 645f  mp_atom(comp_id_
-0002b820: 312c 2061 746f 6d5f 6964 5f31 2920 616e  1, atom_id_1) an
-0002b830: 6420 7365 6c66 2e5f 5f6e 6566 542e 7661  d self.__nefT.va
-0002b840: 6c69 6461 7465 5f63 6f6d 705f 6174 6f6d  lidate_comp_atom
-0002b850: 2863 6f6d 705f 6964 5f32 2c20 6174 6f6d  (comp_id_2, atom
-0002b860: 5f69 645f 3229 3a0a 2020 2020 2020 2020  _id_2):.        
+0002b510: 2020 6966 2073 656c 662e 5f5f 6e65 6654    if self.__nefT
+0002b520: 2e76 616c 6964 6174 655f 636f 6d70 5f61  .validate_comp_a
+0002b530: 746f 6d28 636f 6d70 5f69 645f 312c 2061  tom(comp_id_1, a
+0002b540: 746f 6d5f 6964 5f31 2920 616e 6420 7365  tom_id_1) and se
+0002b550: 6c66 2e5f 5f6e 6566 542e 7661 6c69 6461  lf.__nefT.valida
+0002b560: 7465 5f63 6f6d 705f 6174 6f6d 2863 6f6d  te_comp_atom(com
+0002b570: 705f 6964 5f32 2c20 6174 6f6d 5f69 645f  p_id_2, atom_id_
+0002b580: 3229 3a0a 2020 2020 2020 2020 2020 2020  2):.            
+0002b590: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0002b5a0: 2e5f 5f66 2e61 7070 656e 6428 6622 5b49  .__f.append(f"[I
+0002b5b0: 6e76 616c 6964 2064 6174 615d 207b 7365  nvalid data] {se
+0002b5c0: 6c66 2e5f 5f67 6574 4375 7272 656e 7452  lf.__getCurrentR
+0002b5d0: 6573 7472 6169 6e74 2829 7d22 0a20 2020  estraint()}".   
+0002b5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b600: 2020 2020 2022 466f 756e 6420 616e 2052       "Found an R
+0002b610: 4443 2076 6563 746f 7220 6f76 6572 206d  DC vector over m
+0002b620: 756c 7469 706c 6520 636f 7661 6c65 6e74  ultiple covalent
+0002b630: 2062 6f6e 6473 3b20 220a 2020 2020 2020   bonds; ".      
+0002b640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b660: 2020 6622 287b 6368 6169 6e5f 6964 5f31    f"({chain_id_1
+0002b670: 7d3a 7b73 6571 5f69 645f 317d 3a7b 636f  }:{seq_id_1}:{co
+0002b680: 6d70 5f69 645f 317d 3a7b 6174 6f6d 5f69  mp_id_1}:{atom_i
+0002b690: 645f 317d 2c20 7b63 6861 696e 5f69 645f  d_1}, {chain_id_
+0002b6a0: 327d 3a7b 7365 715f 6964 5f32 7d3a 7b63  2}:{seq_id_2}:{c
+0002b6b0: 6f6d 705f 6964 5f32 7d3a 7b61 746f 6d5f  omp_id_2}:{atom_
+0002b6c0: 6964 5f32 7d29 2e22 290a 2020 2020 2020  id_2}).").      
+0002b6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b6e0: 2020 7265 7475 726e 0a0a 2020 2020 2020    return..      
+0002b6f0: 2020 2020 2020 6966 2073 656c 662e 5f5f        if self.__
+0002b700: 6372 6561 7465 5366 4469 6374 3a0a 2020  createSfDict:.  
+0002b710: 2020 2020 2020 2020 2020 2020 2020 7366                sf
+0002b720: 203d 2073 656c 662e 5f5f 6765 7453 6628   = self.__getSf(
+0002b730: 706f 7465 6e74 6961 6c54 7970 653d 6765  potentialType=ge
+0002b740: 7450 6f74 656e 7469 616c 5479 7065 2873  tPotentialType(s
+0002b750: 656c 662e 5f5f 6669 6c65 5f74 7970 652c  elf.__file_type,
+0002b760: 2073 656c 662e 5f5f 6375 725f 7375 6274   self.__cur_subt
+0002b770: 7970 652c 2064 7374 4675 6e63 292c 0a20  ype, dstFunc),. 
+0002b780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b7a0: 2072 6463 436f 6465 3d67 6574 5264 6343   rdcCode=getRdcC
+0002b7b0: 6f64 6528 5b73 656c 662e 6174 6f6d 5365  ode([self.atomSe
+0002b7c0: 6c65 6374 696f 6e53 6574 5b30 5d5b 305d  lectionSet[0][0]
+0002b7d0: 2c20 7365 6c66 2e61 746f 6d53 656c 6563  , self.atomSelec
+0002b7e0: 7469 6f6e 5365 745b 315d 5b30 5d5d 2929  tionSet[1][0]]))
+0002b7f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002b800: 2073 665b 2769 6427 5d20 2b3d 2031 0a0a   sf['id'] += 1..
+0002b810: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0002b820: 6174 6f6d 312c 2061 746f 6d32 2069 6e20  atom1, atom2 in 
+0002b830: 6974 6572 746f 6f6c 732e 7072 6f64 7563  itertools.produc
+0002b840: 7428 7365 6c66 2e61 746f 6d53 656c 6563  t(self.atomSelec
+0002b850: 7469 6f6e 5365 745b 305d 2c0a 2020 2020  tionSet[0],.    
+0002b860: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002b870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b880: 7365 6c66 2e5f 5f66 2e61 7070 656e 6428  self.__f.append(
-0002b890: 6622 5b49 6e76 616c 6964 2064 6174 615d  f"[Invalid data]
-0002b8a0: 207b 7365 6c66 2e5f 5f67 6574 4375 7272   {self.__getCurr
-0002b8b0: 656e 7452 6573 7472 6169 6e74 2829 7d22  entRestraint()}"
-0002b8c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002b8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b8e0: 2020 2020 2020 2020 2022 466f 756e 6420           "Found 
-0002b8f0: 616e 2052 4443 2076 6563 746f 7220 6f76  an RDC vector ov
-0002b900: 6572 206d 756c 7469 706c 6520 636f 7661  er multiple cova
-0002b910: 6c65 6e74 2062 6f6e 6473 3b20 220a 2020  lent bonds; ".  
-0002b920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b940: 2020 2020 2020 6622 287b 6368 6169 6e5f        f"({chain_
-0002b950: 6964 5f31 7d3a 7b73 6571 5f69 645f 317d  id_1}:{seq_id_1}
-0002b960: 3a7b 636f 6d70 5f69 645f 317d 3a7b 6174  :{comp_id_1}:{at
-0002b970: 6f6d 5f69 645f 317d 2c20 7b63 6861 696e  om_id_1}, {chain
-0002b980: 5f69 645f 327d 3a7b 7365 715f 6964 5f32  _id_2}:{seq_id_2
-0002b990: 7d3a 7b63 6f6d 705f 6964 5f32 7d3a 7b61  }:{comp_id_2}:{a
-0002b9a0: 746f 6d5f 6964 5f32 7d29 2e22 290a 2020  tom_id_2}).").  
-0002b9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b9c0: 2020 2020 2020 7265 7475 726e 0a0a 2020        return..  
-0002b9d0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-0002b9e0: 662e 5f5f 6372 6561 7465 5366 4469 6374  f.__createSfDict
-0002b9f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002ba00: 2020 7366 203d 2073 656c 662e 5f5f 6765    sf = self.__ge
-0002ba10: 7453 6628 706f 7465 6e74 6961 6c54 7970  tSf(potentialTyp
-0002ba20: 653d 6765 7450 6f74 656e 7469 616c 5479  e=getPotentialTy
-0002ba30: 7065 2873 656c 662e 5f5f 6669 6c65 5f74  pe(self.__file_t
-0002ba40: 7970 652c 2073 656c 662e 5f5f 6375 725f  ype, self.__cur_
-0002ba50: 7375 6274 7970 652c 2064 7374 4675 6e63  subtype, dstFunc
-0002ba60: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-0002ba70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ba80: 2020 2020 2072 6463 436f 6465 3d67 6574       rdcCode=get
-0002ba90: 5264 6343 6f64 6528 5b73 656c 662e 6174  RdcCode([self.at
-0002baa0: 6f6d 5365 6c65 6374 696f 6e53 6574 5b30  omSelectionSet[0
-0002bab0: 5d5b 305d 2c20 7365 6c66 2e61 746f 6d53  ][0], self.atomS
-0002bac0: 656c 6563 7469 6f6e 5365 745b 315d 5b30  electionSet[1][0
-0002bad0: 5d5d 2929 0a20 2020 2020 2020 2020 2020  ]])).           
-0002bae0: 2020 2020 2073 665b 2769 6427 5d20 2b3d       sf['id'] +=
-0002baf0: 2031 0a0a 2020 2020 2020 2020 2020 2020   1..            
-0002bb00: 666f 7220 6174 6f6d 312c 2061 746f 6d32  for atom1, atom2
-0002bb10: 2069 6e20 6974 6572 746f 6f6c 732e 7072   in itertools.pr
-0002bb20: 6f64 7563 7428 7365 6c66 2e61 746f 6d53  oduct(self.atomS
-0002bb30: 656c 6563 7469 6f6e 5365 745b 305d 2c0a  electionSet[0],.
+0002b880: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0002b890: 6c66 2e61 746f 6d53 656c 6563 7469 6f6e  lf.atomSelection
+0002b8a0: 5365 745b 315d 293a 0a20 2020 2020 2020  Set[1]):.       
+0002b8b0: 2020 2020 2020 2020 2069 6620 6973 4964           if isId
+0002b8c0: 656e 7469 6361 6c52 6573 7472 6169 6e74  enticalRestraint
+0002b8d0: 285b 6174 6f6d 312c 2061 746f 6d32 5d29  ([atom1, atom2])
+0002b8e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002b8f0: 2020 2020 2020 636f 6e74 696e 7565 0a20        continue. 
+0002b900: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0002b910: 6620 6973 4c6f 6e67 5261 6e67 6552 6573  f isLongRangeRes
+0002b920: 7472 6169 6e74 285b 6174 6f6d 312c 2061  traint([atom1, a
+0002b930: 746f 6d32 5d2c 2073 656c 662e 5f5f 706f  tom2], self.__po
+0002b940: 6c79 5365 7120 6966 2073 656c 662e 5f5f  lySeq if self.__
+0002b950: 6761 7049 6e41 7574 6853 6571 2065 6c73  gapInAuthSeq els
+0002b960: 6520 4e6f 6e65 293a 0a20 2020 2020 2020  e None):.       
+0002b970: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
+0002b980: 7469 6e75 650a 2020 2020 2020 2020 2020  tinue.          
+0002b990: 2020 2020 2020 6966 2073 656c 662e 5f5f        if self.__
+0002b9a0: 6465 6275 673a 0a20 2020 2020 2020 2020  debug:.         
+0002b9b0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0002b9c0: 2866 2273 7562 7479 7065 3d7b 7365 6c66  (f"subtype={self
+0002b9d0: 2e5f 5f63 7572 5f73 7562 7479 7065 7d20  .__cur_subtype} 
+0002b9e0: 2843 532d 524f 5345 5454 413a 2052 4443  (CS-ROSETTA: RDC
+0002b9f0: 2920 6964 3d7b 7365 6c66 2e72 6463 5265  ) id={self.rdcRe
+0002ba00: 7374 7261 696e 7473 7d20 220a 2020 2020  straints} ".    
+0002ba10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ba20: 2020 2020 2020 6622 6174 6f6d 313d 7b61        f"atom1={a
+0002ba30: 746f 6d31 7d20 6174 6f6d 323d 7b61 746f  tom1} atom2={ato
+0002ba40: 6d32 7d20 7b64 7374 4675 6e63 7d22 290a  m2} {dstFunc}").
+0002ba50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ba60: 6966 2073 656c 662e 5f5f 6372 6561 7465  if self.__create
+0002ba70: 5366 4469 6374 2061 6e64 2073 6620 6973  SfDict and sf is
+0002ba80: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+0002ba90: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0002baa0: 665b 2769 6e64 6578 5f69 6427 5d20 2b3d  f['index_id'] +=
+0002bab0: 2031 0a20 2020 2020 2020 2020 2020 2020   1.             
+0002bac0: 2020 2020 2020 2072 6f77 203d 2067 6574         row = get
+0002bad0: 526f 7728 7365 6c66 2e5f 5f63 7572 5f73  Row(self.__cur_s
+0002bae0: 7562 7479 7065 2c20 7366 5b27 6964 275d  ubtype, sf['id']
+0002baf0: 2c20 7366 5b27 696e 6465 785f 6964 275d  , sf['index_id']
+0002bb00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002bb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bb20: 2020 2027 2e27 2c20 4e6f 6e65 2c20 4e6f     '.', None, No
+0002bb30: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
 0002bb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bb70: 2020 7365 6c66 2e61 746f 6d53 656c 6563    self.atomSelec
-0002bb80: 7469 6f6e 5365 745b 315d 293a 0a20 2020  tionSet[1]):.   
-0002bb90: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0002bba0: 6973 4964 656e 7469 6361 6c52 6573 7472  isIdenticalRestr
-0002bbb0: 6169 6e74 285b 6174 6f6d 312c 2061 746f  aint([atom1, ato
-0002bbc0: 6d32 5d29 3a0a 2020 2020 2020 2020 2020  m2]):.          
-0002bbd0: 2020 2020 2020 2020 2020 636f 6e74 696e            contin
-0002bbe0: 7565 0a20 2020 2020 2020 2020 2020 2020  ue.             
-0002bbf0: 2020 2069 6620 6973 4c6f 6e67 5261 6e67     if isLongRang
-0002bc00: 6552 6573 7472 6169 6e74 285b 6174 6f6d  eRestraint([atom
-0002bc10: 312c 2061 746f 6d32 5d2c 2073 656c 662e  1, atom2], self.
-0002bc20: 5f5f 706f 6c79 5365 7120 6966 2073 656c  __polySeq if sel
-0002bc30: 662e 5f5f 6761 7049 6e41 7574 6853 6571  f.__gapInAuthSeq
-0002bc40: 2065 6c73 6520 4e6f 6e65 293a 0a20 2020   else None):.   
-0002bc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bc60: 2063 6f6e 7469 6e75 650a 2020 2020 2020   continue.      
-0002bc70: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-0002bc80: 662e 5f5f 6465 6275 673a 0a20 2020 2020  f.__debug:.     
-0002bc90: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0002bca0: 7269 6e74 2866 2273 7562 7479 7065 3d7b  rint(f"subtype={
-0002bcb0: 7365 6c66 2e5f 5f63 7572 5f73 7562 7479  self.__cur_subty
-0002bcc0: 7065 7d20 2843 532d 524f 5345 5454 413a  pe} (CS-ROSETTA:
-0002bcd0: 2052 4443 2920 6964 3d7b 7365 6c66 2e72   RDC) id={self.r
-0002bce0: 6463 5265 7374 7261 696e 7473 7d20 220a  dcRestraints} ".
-0002bcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bd00: 2020 2020 2020 2020 2020 6622 6174 6f6d            f"atom
-0002bd10: 313d 7b61 746f 6d31 7d20 6174 6f6d 323d  1={atom1} atom2=
-0002bd20: 7b61 746f 6d32 7d20 7b64 7374 4675 6e63  {atom2} {dstFunc
-0002bd30: 7d22 290a 2020 2020 2020 2020 2020 2020  }").            
-0002bd40: 2020 2020 6966 2073 656c 662e 5f5f 6372      if self.__cr
-0002bd50: 6561 7465 5366 4469 6374 2061 6e64 2073  eateSfDict and s
-0002bd60: 6620 6973 206e 6f74 204e 6f6e 653a 0a20  f is not None:. 
-0002bd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bd80: 2020 2073 665b 2769 6e64 6578 5f69 6427     sf['index_id'
-0002bd90: 5d20 2b3d 2031 0a20 2020 2020 2020 2020  ] += 1.         
-0002bda0: 2020 2020 2020 2020 2020 2072 6f77 203d             row =
-0002bdb0: 2067 6574 526f 7728 7365 6c66 2e5f 5f63   getRow(self.__c
-0002bdc0: 7572 5f73 7562 7479 7065 2c20 7366 5b27  ur_subtype, sf['
-0002bdd0: 6964 275d 2c20 7366 5b27 696e 6465 785f  id'], sf['index_
-0002bde0: 6964 275d 2c0a 2020 2020 2020 2020 2020  id'],.          
-0002bdf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002be00: 2020 2020 2020 2027 2e27 2c20 4e6f 6e65         '.', None
-0002be10: 2c20 4e6f 6e65 2c0a 2020 2020 2020 2020  , None,.        
-0002be20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002be30: 2020 2020 2020 2020 2073 665b 276c 6973           sf['lis
-0002be40: 745f 6964 275d 2c20 7365 6c66 2e5f 5f65  t_id'], self.__e
-0002be50: 6e74 7279 4964 2c20 6473 7446 756e 632c  ntryId, dstFunc,
-0002be60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002be70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002be80: 2020 7365 6c66 2e5f 5f61 7574 6854 6f53    self.__authToS
-0002be90: 7461 7253 6571 2c20 7365 6c66 2e5f 5f61  tarSeq, self.__a
-0002bea0: 7574 6854 6f49 6e73 436f 6465 2c20 7365  uthToInsCode, se
-0002beb0: 6c66 2e5f 5f6f 6666 7365 7448 6f6c 6465  lf.__offsetHolde
-0002bec0: 722c 0a20 2020 2020 2020 2020 2020 2020  r,.             
-0002bed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bee0: 2020 2020 6174 6f6d 312c 2061 746f 6d32      atom1, atom2
-0002bef0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0002bf00: 2020 2020 2020 7366 5b27 6c6f 6f70 275d        sf['loop']
-0002bf10: 2e61 6464 5f64 6174 6128 726f 7729 0a0a  .add_data(row)..
-0002bf20: 2020 2020 2020 2020 6578 6365 7074 2056          except V
-0002bf30: 616c 7565 4572 726f 723a 0a20 2020 2020  alueError:.     
-0002bf40: 2020 2020 2020 2073 656c 662e 7264 6352         self.rdcR
-0002bf50: 6573 7472 6169 6e74 7320 2d3d 2031 0a20  estraints -= 1. 
-0002bf60: 2020 2020 2020 2065 7863 6570 7420 496e         except In
-0002bf70: 6465 7845 7272 6f72 3a0a 2020 2020 2020  dexError:.      
-0002bf80: 2020 2020 2020 7365 6c66 2e72 6463 5265        self.rdcRe
-0002bf90: 7374 7261 696e 7473 202d 3d20 310a 2020  straints -= 1.  
-0002bfa0: 2020 2020 2020 6669 6e61 6c6c 793a 0a20        finally:. 
-0002bfb0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0002bfc0: 6e75 6d62 6572 5365 6c65 6374 696f 6e2e  numberSelection.
-0002bfd0: 636c 6561 7228 290a 0a20 2020 2064 6566  clear()..    def
-0002bfe0: 2061 7265 556e 6971 7565 436f 6f72 6441   areUniqueCoordA
-0002bff0: 746f 6d73 2873 656c 662c 2073 7562 7479  toms(self, subty
-0002c000: 7065 5f6e 616d 6529 3a0a 2020 2020 2020  pe_name):.      
-0002c010: 2020 2222 2220 4368 6563 6b20 7768 6574    """ Check whet
-0002c020: 6865 7220 6174 6f6d 2073 656c 6563 7469  her atom selecti
-0002c030: 6f6e 2073 6574 7320 6172 6520 756e 6971  on sets are uniq
-0002c040: 7565 6c79 2061 7373 6967 6e65 642e 0a20  uely assigned.. 
-0002c050: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-0002c060: 2020 2020 666f 7220 5f61 746f 6d53 656c      for _atomSel
-0002c070: 6563 7469 6f6e 5365 7420 696e 2073 656c  ectionSet in sel
-0002c080: 662e 6174 6f6d 5365 6c65 6374 696f 6e53  f.atomSelectionS
-0002c090: 6574 3a0a 0a20 2020 2020 2020 2020 2020  et:..           
-0002c0a0: 2069 6620 6c65 6e28 5f61 746f 6d53 656c   if len(_atomSel
-0002c0b0: 6563 7469 6f6e 5365 7429 203c 2032 3a0a  ectionSet) < 2:.
-0002c0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c0d0: 636f 6e74 696e 7565 0a0a 2020 2020 2020  continue..      
-0002c0e0: 2020 2020 2020 666f 7220 2861 746f 6d31        for (atom1
-0002c0f0: 2c20 6174 6f6d 3229 2069 6e20 6974 6572  , atom2) in iter
-0002c100: 746f 6f6c 732e 636f 6d62 696e 6174 696f  tools.combinatio
-0002c110: 6e73 285f 6174 6f6d 5365 6c65 6374 696f  ns(_atomSelectio
-0002c120: 6e53 6574 2c20 3229 3a0a 2020 2020 2020  nSet, 2):.      
-0002c130: 2020 2020 2020 2020 2020 6966 2061 746f            if ato
-0002c140: 6d31 5b27 6368 6169 6e5f 6964 275d 2021  m1['chain_id'] !
-0002c150: 3d20 6174 6f6d 325b 2763 6861 696e 5f69  = atom2['chain_i
-0002c160: 6427 5d3a 0a20 2020 2020 2020 2020 2020  d']:.           
-0002c170: 2020 2020 2020 2020 2063 6f6e 7469 6e75           continu
-0002c180: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-0002c190: 2020 6966 2061 746f 6d31 5b27 7365 715f    if atom1['seq_
-0002c1a0: 6964 275d 2021 3d20 6174 6f6d 325b 2773  id'] != atom2['s
-0002c1b0: 6571 5f69 6427 5d3a 0a20 2020 2020 2020  eq_id']:.       
-0002c1c0: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
-0002c1d0: 7469 6e75 650a 2020 2020 2020 2020 2020  tinue.          
-0002c1e0: 2020 2020 2020 7365 6c66 2e5f 5f66 2e61        self.__f.a
-0002c1f0: 7070 656e 6428 6622 5b49 6e76 616c 6964  ppend(f"[Invalid
-0002c200: 2061 746f 6d20 7365 6c65 6374 696f 6e5d   atom selection]
-0002c210: 207b 7365 6c66 2e5f 5f67 6574 4375 7272   {self.__getCurr
-0002c220: 656e 7452 6573 7472 6169 6e74 2829 7d22  entRestraint()}"
-0002c230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002c240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c250: 2066 2241 6d62 6967 756f 7573 2061 746f   f"Ambiguous ato
-0002c260: 6d20 7365 6c65 6374 696f 6e20 277b 6174  m selection '{at
-0002c270: 6f6d 315b 2763 6861 696e 5f69 6427 5d7d  om1['chain_id']}
-0002c280: 3a7b 6174 6f6d 315b 2773 6571 5f69 6427  :{atom1['seq_id'
-0002c290: 5d7d 3a7b 6174 6f6d 315b 2763 6f6d 705f  ]}:{atom1['comp_
-0002c2a0: 6964 275d 7d3a 7b61 746f 6d31 5b27 6174  id']}:{atom1['at
-0002c2b0: 6f6d 5f69 6427 5d7d 206f 7220 220a 2020  om_id']} or ".  
-0002c2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c2d0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-0002c2e0: 7b61 746f 6d32 5b27 6174 6f6d 5f69 6427  {atom2['atom_id'
-0002c2f0: 5d7d 2720 6973 206e 6f74 2061 6c6c 6f77  ]}' is not allow
-0002c300: 6564 2061 7320 7b73 7562 7479 7065 5f6e  ed as {subtype_n
-0002c310: 616d 657d 2072 6573 7472 6169 6e74 2e22  ame} restraint."
-0002c320: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0002c330: 2020 7265 7475 726e 2046 616c 7365 0a0a    return False..
-0002c340: 2020 2020 2020 2020 7265 7475 726e 2054          return T
-0002c350: 7275 650a 0a20 2020 2023 2045 6e74 6572  rue..    # Enter
-0002c360: 2061 2070 6172 7365 2074 7265 6520 7072   a parse tree pr
-0002c370: 6f64 7563 6564 2062 7920 526f 7365 7474  oduced by Rosett
-0002c380: 614d 5250 6172 7365 7223 6469 7375 6c66  aMRParser#disulf
-0002c390: 6964 655f 626f 6e64 5f6c 696e 6b61 6765  ide_bond_linkage
-0002c3a0: 732e 0a20 2020 2064 6566 2065 6e74 6572  s..    def enter
-0002c3b0: 4469 7375 6c66 6964 655f 626f 6e64 5f6c  Disulfide_bond_l
-0002c3c0: 696e 6b61 6765 7328 7365 6c66 2c20 6374  inkages(self, ct
-0002c3d0: 783a 2052 6f73 6574 7461 4d52 5061 7273  x: RosettaMRPars
-0002c3e0: 6572 2e44 6973 756c 6669 6465 5f62 6f6e  er.Disulfide_bon
-0002c3f0: 645f 6c69 6e6b 6167 6573 436f 6e74 6578  d_linkagesContex
-0002c400: 7429 3a20 2023 2070 796c 696e 743a 2064  t):  # pylint: d
-0002c410: 6973 6162 6c65 3d75 6e75 7365 642d 6172  isable=unused-ar
-0002c420: 6775 6d65 6e74 0a20 2020 2020 2020 2073  gument.        s
-0002c430: 656c 662e 5f5f 6375 725f 7375 6274 7970  elf.__cur_subtyp
-0002c440: 6520 3d20 2773 7362 6f6e 6427 0a0a 2020  e = 'ssbond'..  
-0002c450: 2020 2320 4578 6974 2061 2070 6172 7365    # Exit a parse
-0002c460: 2074 7265 6520 7072 6f64 7563 6564 2062   tree produced b
-0002c470: 7920 526f 7365 7474 614d 5250 6172 7365  y RosettaMRParse
-0002c480: 7223 6469 7375 6c66 6964 655f 626f 6e64  r#disulfide_bond
-0002c490: 5f6c 696e 6b61 6765 732e 0a20 2020 2064  _linkages..    d
-0002c4a0: 6566 2065 7869 7444 6973 756c 6669 6465  ef exitDisulfide
-0002c4b0: 5f62 6f6e 645f 6c69 6e6b 6167 6573 2873  _bond_linkages(s
-0002c4c0: 656c 662c 2063 7478 3a20 526f 7365 7474  elf, ctx: Rosett
-0002c4d0: 614d 5250 6172 7365 722e 4469 7375 6c66  aMRParser.Disulf
-0002c4e0: 6964 655f 626f 6e64 5f6c 696e 6b61 6765  ide_bond_linkage
-0002c4f0: 7343 6f6e 7465 7874 293a 0a20 2020 2020  sContext):.     
-0002c500: 2020 2070 6173 730a 0a20 2020 2023 2045     pass..    # E
-0002c510: 6e74 6572 2061 2070 6172 7365 2074 7265  nter a parse tre
-0002c520: 6520 7072 6f64 7563 6564 2062 7920 526f  e produced by Ro
-0002c530: 7365 7474 614d 5250 6172 7365 7223 6469  settaMRParser#di
-0002c540: 7375 6c66 6964 655f 626f 6e64 5f6c 696e  sulfide_bond_lin
-0002c550: 6b61 6765 2e0a 2020 2020 6465 6620 656e  kage..    def en
-0002c560: 7465 7244 6973 756c 6669 6465 5f62 6f6e  terDisulfide_bon
-0002c570: 645f 6c69 6e6b 6167 6528 7365 6c66 2c20  d_linkage(self, 
-0002c580: 6374 783a 2052 6f73 6574 7461 4d52 5061  ctx: RosettaMRPa
-0002c590: 7273 6572 2e44 6973 756c 6669 6465 5f62  rser.Disulfide_b
-0002c5a0: 6f6e 645f 6c69 6e6b 6167 6543 6f6e 7465  ond_linkageConte
-0002c5b0: 7874 293a 2020 2320 7079 6c69 6e74 3a20  xt):  # pylint: 
-0002c5c0: 6469 7361 626c 653d 756e 7573 6564 2d61  disable=unused-a
-0002c5d0: 7267 756d 656e 740a 2020 2020 2020 2020  rgument.        
-0002c5e0: 7365 6c66 2e73 7362 6f6e 6452 6573 7472  self.ssbondRestr
-0002c5f0: 6169 6e74 7320 2b3d 2031 0a0a 2020 2020  aints += 1..    
-0002c600: 2020 2020 7365 6c66 2e61 746f 6d53 656c      self.atomSel
-0002c610: 6563 7469 6f6e 5365 742e 636c 6561 7228  ectionSet.clear(
-0002c620: 290a 0a20 2020 2023 2045 7869 7420 6120  )..    # Exit a 
-0002c630: 7061 7273 6520 7472 6565 2070 726f 6475  parse tree produ
-0002c640: 6365 6420 6279 2052 6f73 6574 7461 4d52  ced by RosettaMR
-0002c650: 5061 7273 6572 2364 6973 756c 6669 6465  Parser#disulfide
-0002c660: 5f62 6f6e 645f 6c69 6e6b 6167 652e 0a20  _bond_linkage.. 
-0002c670: 2020 2064 6566 2065 7869 7444 6973 756c     def exitDisul
-0002c680: 6669 6465 5f62 6f6e 645f 6c69 6e6b 6167  fide_bond_linkag
-0002c690: 6528 7365 6c66 2c20 6374 783a 2052 6f73  e(self, ctx: Ros
-0002c6a0: 6574 7461 4d52 5061 7273 6572 2e44 6973  ettaMRParser.Dis
-0002c6b0: 756c 6669 6465 5f62 6f6e 645f 6c69 6e6b  ulfide_bond_link
-0002c6c0: 6167 6543 6f6e 7465 7874 293a 0a0a 2020  ageContext):..  
-0002c6d0: 2020 2020 2020 7472 793a 0a0a 2020 2020        try:..    
-0002c6e0: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-0002c6f0: 2020 2020 2020 2020 2020 2020 2073 6571               seq
-0002c700: 4964 3120 3d20 696e 7428 7374 7228 6374  Id1 = int(str(ct
-0002c710: 782e 496e 7465 6765 7228 3029 2929 0a20  x.Integer(0))). 
-0002c720: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0002c730: 6571 4964 3220 3d20 696e 7428 7374 7228  eqId2 = int(str(
-0002c740: 6374 782e 496e 7465 6765 7228 3129 2929  ctx.Integer(1)))
-0002c750: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
-0002c760: 6570 7420 5661 6c75 6545 7272 6f72 3a0a  ept ValueError:.
-0002c770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c780: 7365 6c66 2e73 7362 6f6e 6452 6573 7472  self.ssbondRestr
-0002c790: 6169 6e74 7320 2d3d 2031 0a20 2020 2020  aints -= 1.     
-0002c7a0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0002c7b0: 6e0a 0a20 2020 2020 2020 2020 2020 2069  n..            i
-0002c7c0: 6620 6e6f 7420 7365 6c66 2e5f 5f68 6173  f not self.__has
-0002c7d0: 506f 6c79 5365 713a 0a20 2020 2020 2020  PolySeq:.       
-0002c7e0: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
-0002c7f0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0002c800: 662e 5f5f 7265 7472 6965 7665 4c6f 6361  f.__retrieveLoca
-0002c810: 6c53 6571 5363 6865 6d65 2829 0a0a 2020  lSeqScheme()..  
-0002c820: 2020 2020 2020 2020 2020 6368 6169 6e41            chainA
-0002c830: 7373 6967 6e31 203d 2073 656c 662e 6173  ssign1 = self.as
-0002c840: 7369 676e 436f 6f72 6450 6f6c 796d 6572  signCoordPolymer
-0002c850: 5365 7175 656e 6365 2873 6571 4964 3129  Sequence(seqId1)
-0002c860: 0a20 2020 2020 2020 2020 2020 2063 6861  .            cha
-0002c870: 696e 4173 7369 676e 3220 3d20 7365 6c66  inAssign2 = self
-0002c880: 2e61 7373 6967 6e43 6f6f 7264 506f 6c79  .assignCoordPoly
-0002c890: 6d65 7253 6571 7565 6e63 6528 7365 7149  merSequence(seqI
-0002c8a0: 6432 290a 0a20 2020 2020 2020 2020 2020  d2)..           
-0002c8b0: 2069 6620 6c65 6e28 6368 6169 6e41 7373   if len(chainAss
-0002c8c0: 6967 6e31 2920 3d3d 2030 206f 7220 6c65  ign1) == 0 or le
-0002c8d0: 6e28 6368 6169 6e41 7373 6967 6e32 2920  n(chainAssign2) 
-0002c8e0: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
-0002c8f0: 2020 2020 2020 7265 7475 726e 0a0a 2020        return..  
-0002c900: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
-0002c910: 656c 6563 7443 6f6f 7264 4174 6f6d 7328  electCoordAtoms(
-0002c920: 6368 6169 6e41 7373 6967 6e31 2c20 7365  chainAssign1, se
-0002c930: 7149 6431 2c20 2753 4727 290a 2020 2020  qId1, 'SG').    
-0002c940: 2020 2020 2020 2020 7365 6c66 2e73 656c          self.sel
-0002c950: 6563 7443 6f6f 7264 4174 6f6d 7328 6368  ectCoordAtoms(ch
-0002c960: 6169 6e41 7373 6967 6e32 2c20 7365 7149  ainAssign2, seqI
-0002c970: 6432 2c20 2753 4727 290a 0a20 2020 2020  d2, 'SG')..     
-0002c980: 2020 2020 2020 2069 6620 6c65 6e28 7365         if len(se
-0002c990: 6c66 2e61 746f 6d53 656c 6563 7469 6f6e  lf.atomSelection
-0002c9a0: 5365 7429 203c 2032 3a0a 2020 2020 2020  Set) < 2:.      
-0002c9b0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0002c9c0: 0a0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
-0002c9d0: 7220 6174 6f6d 3120 696e 2073 656c 662e  r atom1 in self.
-0002c9e0: 6174 6f6d 5365 6c65 6374 696f 6e53 6574  atomSelectionSet
-0002c9f0: 5b30 5d3a 0a20 2020 2020 2020 2020 2020  [0]:.           
-0002ca00: 2020 2020 2069 6620 6174 6f6d 315b 2763       if atom1['c
-0002ca10: 6f6d 705f 6964 275d 2021 3d20 2743 5953  omp_id'] != 'CYS
-0002ca20: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
-0002ca30: 2020 2020 2020 2073 656c 662e 5f5f 662e         self.__f.
-0002ca40: 6170 7065 6e64 2866 225b 496e 7661 6c69  append(f"[Invali
-0002ca50: 6420 6174 6f6d 2073 656c 6563 7469 6f6e  d atom selection
-0002ca60: 5d20 7b73 656c 662e 5f5f 6765 7443 7572  ] {self.__getCur
-0002ca70: 7265 6e74 5265 7374 7261 696e 7428 297d  rentRestraint()}
-0002ca80: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0002ca90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002caa0: 2020 2020 2020 6622 4661 696c 6564 2074        f"Failed t
-0002cab0: 6f20 7365 6c65 6374 2061 2043 7973 7465  o select a Cyste
-0002cac0: 696e 2072 6573 6964 7565 2066 6f72 2064  in residue for d
-0002cad0: 6973 756c 6669 6465 2062 6f6e 6420 6265  isulfide bond be
-0002cae0: 7477 6565 6e20 277b 7365 7149 6431 7d27  tween '{seqId1}'
-0002caf0: 2061 6e64 2027 7b73 6571 4964 327d 272e   and '{seqId2}'.
-0002cb00: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
-0002cb10: 2020 2020 2020 2072 6574 7572 6e0a 0a20         return.. 
-0002cb20: 2020 2020 2020 2020 2020 2066 6f72 2061             for a
-0002cb30: 746f 6d32 2069 6e20 7365 6c66 2e61 746f  tom2 in self.ato
-0002cb40: 6d53 656c 6563 7469 6f6e 5365 745b 315d  mSelectionSet[1]
-0002cb50: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002cb60: 2020 6966 2061 746f 6d32 5b27 636f 6d70    if atom2['comp
-0002cb70: 5f69 6427 5d20 213d 2027 4359 5327 3a0a  _id'] != 'CYS':.
+0002bb50: 2020 2020 2073 665b 276c 6973 745f 6964       sf['list_id
+0002bb60: 275d 2c20 7365 6c66 2e5f 5f65 6e74 7279  '], self.__entry
+0002bb70: 4964 2c20 6473 7446 756e 632c 0a20 2020  Id, dstFunc,.   
+0002bb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bb90: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0002bba0: 6c66 2e5f 5f61 7574 6854 6f53 7461 7253  lf.__authToStarS
+0002bbb0: 6571 2c20 7365 6c66 2e5f 5f61 7574 6854  eq, self.__authT
+0002bbc0: 6f49 6e73 436f 6465 2c20 7365 6c66 2e5f  oInsCode, self._
+0002bbd0: 5f6f 6666 7365 7448 6f6c 6465 722c 0a20  _offsetHolder,. 
+0002bbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bc00: 6174 6f6d 312c 2061 746f 6d32 290a 2020  atom1, atom2).  
+0002bc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bc20: 2020 7366 5b27 6c6f 6f70 275d 2e61 6464    sf['loop'].add
+0002bc30: 5f64 6174 6128 726f 7729 0a0a 2020 2020  _data(row)..    
+0002bc40: 2020 2020 6578 6365 7074 2056 616c 7565      except Value
+0002bc50: 4572 726f 723a 0a20 2020 2020 2020 2020  Error:.         
+0002bc60: 2020 2073 656c 662e 7264 6352 6573 7472     self.rdcRestr
+0002bc70: 6169 6e74 7320 2d3d 2031 0a20 2020 2020  aints -= 1.     
+0002bc80: 2020 2065 7863 6570 7420 496e 6465 7845     except IndexE
+0002bc90: 7272 6f72 3a0a 2020 2020 2020 2020 2020  rror:.          
+0002bca0: 2020 7365 6c66 2e72 6463 5265 7374 7261    self.rdcRestra
+0002bcb0: 696e 7473 202d 3d20 310a 2020 2020 2020  ints -= 1.      
+0002bcc0: 2020 6669 6e61 6c6c 793a 0a20 2020 2020    finally:.     
+0002bcd0: 2020 2020 2020 2073 656c 662e 6e75 6d62         self.numb
+0002bce0: 6572 5365 6c65 6374 696f 6e2e 636c 6561  erSelection.clea
+0002bcf0: 7228 290a 0a20 2020 2064 6566 2061 7265  r()..    def are
+0002bd00: 556e 6971 7565 436f 6f72 6441 746f 6d73  UniqueCoordAtoms
+0002bd10: 2873 656c 662c 2073 7562 7479 7065 5f6e  (self, subtype_n
+0002bd20: 616d 6529 3a0a 2020 2020 2020 2020 2222  ame):.        ""
+0002bd30: 2220 4368 6563 6b20 7768 6574 6865 7220  " Check whether 
+0002bd40: 6174 6f6d 2073 656c 6563 7469 6f6e 2073  atom selection s
+0002bd50: 6574 7320 6172 6520 756e 6971 7565 6c79  ets are uniquely
+0002bd60: 2061 7373 6967 6e65 642e 0a20 2020 2020   assigned..     
+0002bd70: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+0002bd80: 666f 7220 5f61 746f 6d53 656c 6563 7469  for _atomSelecti
+0002bd90: 6f6e 5365 7420 696e 2073 656c 662e 6174  onSet in self.at
+0002bda0: 6f6d 5365 6c65 6374 696f 6e53 6574 3a0a  omSelectionSet:.
+0002bdb0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0002bdc0: 6c65 6e28 5f61 746f 6d53 656c 6563 7469  len(_atomSelecti
+0002bdd0: 6f6e 5365 7429 203c 2032 3a0a 2020 2020  onSet) < 2:.    
+0002bde0: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
+0002bdf0: 696e 7565 0a0a 2020 2020 2020 2020 2020  inue..          
+0002be00: 2020 666f 7220 2861 746f 6d31 2c20 6174    for (atom1, at
+0002be10: 6f6d 3229 2069 6e20 6974 6572 746f 6f6c  om2) in itertool
+0002be20: 732e 636f 6d62 696e 6174 696f 6e73 285f  s.combinations(_
+0002be30: 6174 6f6d 5365 6c65 6374 696f 6e53 6574  atomSelectionSet
+0002be40: 2c20 3229 3a0a 2020 2020 2020 2020 2020  , 2):.          
+0002be50: 2020 2020 2020 6966 2061 746f 6d31 5b27        if atom1['
+0002be60: 6368 6169 6e5f 6964 275d 2021 3d20 6174  chain_id'] != at
+0002be70: 6f6d 325b 2763 6861 696e 5f69 6427 5d3a  om2['chain_id']:
+0002be80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002be90: 2020 2020 2063 6f6e 7469 6e75 650a 2020       continue.  
+0002bea0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0002beb0: 2061 746f 6d31 5b27 7365 715f 6964 275d   atom1['seq_id']
+0002bec0: 2021 3d20 6174 6f6d 325b 2773 6571 5f69   != atom2['seq_i
+0002bed0: 6427 5d3a 0a20 2020 2020 2020 2020 2020  d']:.           
+0002bee0: 2020 2020 2020 2020 2063 6f6e 7469 6e75           continu
+0002bef0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+0002bf00: 2020 7365 6c66 2e5f 5f66 2e61 7070 656e    self.__f.appen
+0002bf10: 6428 6622 5b49 6e76 616c 6964 2061 746f  d(f"[Invalid ato
+0002bf20: 6d20 7365 6c65 6374 696f 6e5d 207b 7365  m selection] {se
+0002bf30: 6c66 2e5f 5f67 6574 4375 7272 656e 7452  lf.__getCurrentR
+0002bf40: 6573 7472 6169 6e74 2829 7d22 0a20 2020  estraint()}".   
+0002bf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bf60: 2020 2020 2020 2020 2020 2020 2066 2241               f"A
+0002bf70: 6d62 6967 756f 7573 2061 746f 6d20 7365  mbiguous atom se
+0002bf80: 6c65 6374 696f 6e20 277b 6174 6f6d 315b  lection '{atom1[
+0002bf90: 2763 6861 696e 5f69 6427 5d7d 3a7b 6174  'chain_id']}:{at
+0002bfa0: 6f6d 315b 2773 6571 5f69 6427 5d7d 3a7b  om1['seq_id']}:{
+0002bfb0: 6174 6f6d 315b 2763 6f6d 705f 6964 275d  atom1['comp_id']
+0002bfc0: 7d3a 7b61 746f 6d31 5b27 6174 6f6d 5f69  }:{atom1['atom_i
+0002bfd0: 6427 5d7d 206f 7220 220a 2020 2020 2020  d']} or ".      
+0002bfe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bff0: 2020 2020 2020 2020 2020 6622 7b61 746f            f"{ato
+0002c000: 6d32 5b27 6174 6f6d 5f69 6427 5d7d 2720  m2['atom_id']}' 
+0002c010: 6973 206e 6f74 2061 6c6c 6f77 6564 2061  is not allowed a
+0002c020: 7320 7b73 7562 7479 7065 5f6e 616d 657d  s {subtype_name}
+0002c030: 2072 6573 7472 6169 6e74 2e22 290a 2020   restraint.").  
+0002c040: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0002c050: 7475 726e 2046 616c 7365 0a0a 2020 2020  turn False..    
+0002c060: 2020 2020 7265 7475 726e 2054 7275 650a      return True.
+0002c070: 0a20 2020 2023 2045 6e74 6572 2061 2070  .    # Enter a p
+0002c080: 6172 7365 2074 7265 6520 7072 6f64 7563  arse tree produc
+0002c090: 6564 2062 7920 526f 7365 7474 614d 5250  ed by RosettaMRP
+0002c0a0: 6172 7365 7223 6469 7375 6c66 6964 655f  arser#disulfide_
+0002c0b0: 626f 6e64 5f6c 696e 6b61 6765 732e 0a20  bond_linkages.. 
+0002c0c0: 2020 2064 6566 2065 6e74 6572 4469 7375     def enterDisu
+0002c0d0: 6c66 6964 655f 626f 6e64 5f6c 696e 6b61  lfide_bond_linka
+0002c0e0: 6765 7328 7365 6c66 2c20 6374 783a 2052  ges(self, ctx: R
+0002c0f0: 6f73 6574 7461 4d52 5061 7273 6572 2e44  osettaMRParser.D
+0002c100: 6973 756c 6669 6465 5f62 6f6e 645f 6c69  isulfide_bond_li
+0002c110: 6e6b 6167 6573 436f 6e74 6578 7429 3a20  nkagesContext): 
+0002c120: 2023 2070 796c 696e 743a 2064 6973 6162   # pylint: disab
+0002c130: 6c65 3d75 6e75 7365 642d 6172 6775 6d65  le=unused-argume
+0002c140: 6e74 0a20 2020 2020 2020 2073 656c 662e  nt.        self.
+0002c150: 5f5f 6375 725f 7375 6274 7970 6520 3d20  __cur_subtype = 
+0002c160: 2773 7362 6f6e 6427 0a0a 2020 2020 2320  'ssbond'..    # 
+0002c170: 4578 6974 2061 2070 6172 7365 2074 7265  Exit a parse tre
+0002c180: 6520 7072 6f64 7563 6564 2062 7920 526f  e produced by Ro
+0002c190: 7365 7474 614d 5250 6172 7365 7223 6469  settaMRParser#di
+0002c1a0: 7375 6c66 6964 655f 626f 6e64 5f6c 696e  sulfide_bond_lin
+0002c1b0: 6b61 6765 732e 0a20 2020 2064 6566 2065  kages..    def e
+0002c1c0: 7869 7444 6973 756c 6669 6465 5f62 6f6e  xitDisulfide_bon
+0002c1d0: 645f 6c69 6e6b 6167 6573 2873 656c 662c  d_linkages(self,
+0002c1e0: 2063 7478 3a20 526f 7365 7474 614d 5250   ctx: RosettaMRP
+0002c1f0: 6172 7365 722e 4469 7375 6c66 6964 655f  arser.Disulfide_
+0002c200: 626f 6e64 5f6c 696e 6b61 6765 7343 6f6e  bond_linkagesCon
+0002c210: 7465 7874 293a 0a20 2020 2020 2020 2070  text):.        p
+0002c220: 6173 730a 0a20 2020 2023 2045 6e74 6572  ass..    # Enter
+0002c230: 2061 2070 6172 7365 2074 7265 6520 7072   a parse tree pr
+0002c240: 6f64 7563 6564 2062 7920 526f 7365 7474  oduced by Rosett
+0002c250: 614d 5250 6172 7365 7223 6469 7375 6c66  aMRParser#disulf
+0002c260: 6964 655f 626f 6e64 5f6c 696e 6b61 6765  ide_bond_linkage
+0002c270: 2e0a 2020 2020 6465 6620 656e 7465 7244  ..    def enterD
+0002c280: 6973 756c 6669 6465 5f62 6f6e 645f 6c69  isulfide_bond_li
+0002c290: 6e6b 6167 6528 7365 6c66 2c20 6374 783a  nkage(self, ctx:
+0002c2a0: 2052 6f73 6574 7461 4d52 5061 7273 6572   RosettaMRParser
+0002c2b0: 2e44 6973 756c 6669 6465 5f62 6f6e 645f  .Disulfide_bond_
+0002c2c0: 6c69 6e6b 6167 6543 6f6e 7465 7874 293a  linkageContext):
+0002c2d0: 2020 2320 7079 6c69 6e74 3a20 6469 7361    # pylint: disa
+0002c2e0: 626c 653d 756e 7573 6564 2d61 7267 756d  ble=unused-argum
+0002c2f0: 656e 740a 2020 2020 2020 2020 7365 6c66  ent.        self
+0002c300: 2e73 7362 6f6e 6452 6573 7472 6169 6e74  .ssbondRestraint
+0002c310: 7320 2b3d 2031 0a0a 2020 2020 2020 2020  s += 1..        
+0002c320: 7365 6c66 2e61 746f 6d53 656c 6563 7469  self.atomSelecti
+0002c330: 6f6e 5365 742e 636c 6561 7228 290a 0a20  onSet.clear().. 
+0002c340: 2020 2023 2045 7869 7420 6120 7061 7273     # Exit a pars
+0002c350: 6520 7472 6565 2070 726f 6475 6365 6420  e tree produced 
+0002c360: 6279 2052 6f73 6574 7461 4d52 5061 7273  by RosettaMRPars
+0002c370: 6572 2364 6973 756c 6669 6465 5f62 6f6e  er#disulfide_bon
+0002c380: 645f 6c69 6e6b 6167 652e 0a20 2020 2064  d_linkage..    d
+0002c390: 6566 2065 7869 7444 6973 756c 6669 6465  ef exitDisulfide
+0002c3a0: 5f62 6f6e 645f 6c69 6e6b 6167 6528 7365  _bond_linkage(se
+0002c3b0: 6c66 2c20 6374 783a 2052 6f73 6574 7461  lf, ctx: Rosetta
+0002c3c0: 4d52 5061 7273 6572 2e44 6973 756c 6669  MRParser.Disulfi
+0002c3d0: 6465 5f62 6f6e 645f 6c69 6e6b 6167 6543  de_bond_linkageC
+0002c3e0: 6f6e 7465 7874 293a 0a0a 2020 2020 2020  ontext):..      
+0002c3f0: 2020 7472 793a 0a0a 2020 2020 2020 2020    try:..        
+0002c400: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+0002c410: 2020 2020 2020 2020 2073 6571 4964 3120           seqId1 
+0002c420: 3d20 696e 7428 7374 7228 6374 782e 496e  = int(str(ctx.In
+0002c430: 7465 6765 7228 3029 2929 0a20 2020 2020  teger(0))).     
+0002c440: 2020 2020 2020 2020 2020 2073 6571 4964             seqId
+0002c450: 3220 3d20 696e 7428 7374 7228 6374 782e  2 = int(str(ctx.
+0002c460: 496e 7465 6765 7228 3129 2929 0a20 2020  Integer(1))).   
+0002c470: 2020 2020 2020 2020 2065 7863 6570 7420           except 
+0002c480: 5661 6c75 6545 7272 6f72 3a0a 2020 2020  ValueError:.    
+0002c490: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0002c4a0: 2e73 7362 6f6e 6452 6573 7472 6169 6e74  .ssbondRestraint
+0002c4b0: 7320 2d3d 2031 0a20 2020 2020 2020 2020  s -= 1.         
+0002c4c0: 2020 2020 2020 2072 6574 7572 6e0a 0a20         return.. 
+0002c4d0: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+0002c4e0: 7420 7365 6c66 2e5f 5f68 6173 506f 6c79  t self.__hasPoly
+0002c4f0: 5365 713a 0a20 2020 2020 2020 2020 2020  Seq:.           
+0002c500: 2020 2020 2072 6574 7572 6e0a 0a20 2020       return..   
+0002c510: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
+0002c520: 7265 7472 6965 7665 4c6f 6361 6c53 6571  retrieveLocalSeq
+0002c530: 5363 6865 6d65 2829 0a0a 2020 2020 2020  Scheme()..      
+0002c540: 2020 2020 2020 6368 6169 6e41 7373 6967        chainAssig
+0002c550: 6e31 203d 2073 656c 662e 6173 7369 676e  n1 = self.assign
+0002c560: 436f 6f72 6450 6f6c 796d 6572 5365 7175  CoordPolymerSequ
+0002c570: 656e 6365 2873 6571 4964 3129 0a20 2020  ence(seqId1).   
+0002c580: 2020 2020 2020 2020 2063 6861 696e 4173           chainAs
+0002c590: 7369 676e 3220 3d20 7365 6c66 2e61 7373  sign2 = self.ass
+0002c5a0: 6967 6e43 6f6f 7264 506f 6c79 6d65 7253  ignCoordPolymerS
+0002c5b0: 6571 7565 6e63 6528 7365 7149 6432 290a  equence(seqId2).
+0002c5c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0002c5d0: 6c65 6e28 6368 6169 6e41 7373 6967 6e31  len(chainAssign1
+0002c5e0: 2920 3d3d 2030 206f 7220 6c65 6e28 6368  ) == 0 or len(ch
+0002c5f0: 6169 6e41 7373 6967 6e32 2920 3d3d 2030  ainAssign2) == 0
+0002c600: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002c610: 2020 7265 7475 726e 0a0a 2020 2020 2020    return..      
+0002c620: 2020 2020 2020 7365 6c66 2e73 656c 6563        self.selec
+0002c630: 7443 6f6f 7264 4174 6f6d 7328 6368 6169  tCoordAtoms(chai
+0002c640: 6e41 7373 6967 6e31 2c20 7365 7149 6431  nAssign1, seqId1
+0002c650: 2c20 2753 4727 290a 2020 2020 2020 2020  , 'SG').        
+0002c660: 2020 2020 7365 6c66 2e73 656c 6563 7443      self.selectC
+0002c670: 6f6f 7264 4174 6f6d 7328 6368 6169 6e41  oordAtoms(chainA
+0002c680: 7373 6967 6e32 2c20 7365 7149 6432 2c20  ssign2, seqId2, 
+0002c690: 2753 4727 290a 0a20 2020 2020 2020 2020  'SG')..         
+0002c6a0: 2020 2069 6620 6c65 6e28 7365 6c66 2e61     if len(self.a
+0002c6b0: 746f 6d53 656c 6563 7469 6f6e 5365 7429  tomSelectionSet)
+0002c6c0: 203c 2032 3a0a 2020 2020 2020 2020 2020   < 2:.          
+0002c6d0: 2020 2020 2020 7265 7475 726e 0a0a 2020        return..  
+0002c6e0: 2020 2020 2020 2020 2020 666f 7220 6174            for at
+0002c6f0: 6f6d 3120 696e 2073 656c 662e 6174 6f6d  om1 in self.atom
+0002c700: 5365 6c65 6374 696f 6e53 6574 5b30 5d3a  SelectionSet[0]:
+0002c710: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002c720: 2069 6620 6174 6f6d 315b 2763 6f6d 705f   if atom1['comp_
+0002c730: 6964 275d 2021 3d20 2743 5953 273a 0a20  id'] != 'CYS':. 
+0002c740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c750: 2020 2073 656c 662e 5f5f 662e 6170 7065     self.__f.appe
+0002c760: 6e64 2866 225b 496e 7661 6c69 6420 6174  nd(f"[Invalid at
+0002c770: 6f6d 2073 656c 6563 7469 6f6e 5d20 7b73  om selection] {s
+0002c780: 656c 662e 5f5f 6765 7443 7572 7265 6e74  elf.__getCurrent
+0002c790: 5265 7374 7261 696e 7428 297d 220a 2020  Restraint()}".  
+0002c7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c7c0: 2020 6622 4661 696c 6564 2074 6f20 7365    f"Failed to se
+0002c7d0: 6c65 6374 2061 2043 7973 7465 696e 2072  lect a Cystein r
+0002c7e0: 6573 6964 7565 2066 6f72 2064 6973 756c  esidue for disul
+0002c7f0: 6669 6465 2062 6f6e 6420 6265 7477 6565  fide bond betwee
+0002c800: 6e20 277b 7365 7149 6431 7d27 2061 6e64  n '{seqId1}' and
+0002c810: 2027 7b73 6571 4964 327d 272e 2229 0a20   '{seqId2}'."). 
+0002c820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c830: 2020 2072 6574 7572 6e0a 0a20 2020 2020     return..     
+0002c840: 2020 2020 2020 2066 6f72 2061 746f 6d32         for atom2
+0002c850: 2069 6e20 7365 6c66 2e61 746f 6d53 656c   in self.atomSel
+0002c860: 6563 7469 6f6e 5365 745b 315d 3a0a 2020  ectionSet[1]:.  
+0002c870: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0002c880: 2061 746f 6d32 5b27 636f 6d70 5f69 6427   atom2['comp_id'
+0002c890: 5d20 213d 2027 4359 5327 3a0a 2020 2020  ] != 'CYS':.    
+0002c8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c8b0: 7365 6c66 2e5f 5f66 2e61 7070 656e 6428  self.__f.append(
+0002c8c0: 6622 5b49 6e76 616c 6964 2061 746f 6d20  f"[Invalid atom 
+0002c8d0: 7365 6c65 6374 696f 6e5d 207b 7365 6c66  selection] {self
+0002c8e0: 2e5f 5f67 6574 4375 7272 656e 7452 6573  .__getCurrentRes
+0002c8f0: 7472 6169 6e74 2829 7d22 0a20 2020 2020  traint()}".     
+0002c900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c910: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0002c920: 2246 6169 6c65 6420 746f 2073 656c 6563  "Failed to selec
+0002c930: 7420 6120 4379 7374 6569 6e20 7265 7369  t a Cystein resi
+0002c940: 6475 6520 666f 7220 6469 7375 6c66 6964  due for disulfid
+0002c950: 6520 626f 6e64 2062 6574 7765 656e 2027  e bond between '
+0002c960: 7b73 6571 4964 317d 2720 616e 6420 277b  {seqId1}' and '{
+0002c970: 7365 7149 6432 7d27 2e22 290a 2020 2020  seqId2}'.").    
+0002c980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c990: 7265 7475 726e 0a0a 2020 2020 2020 2020  return..        
+0002c9a0: 2020 2020 6368 6169 6e5f 6964 5f31 203d      chain_id_1 =
+0002c9b0: 2073 656c 662e 6174 6f6d 5365 6c65 6374   self.atomSelect
+0002c9c0: 696f 6e53 6574 5b30 5d5b 305d 5b27 6368  ionSet[0][0]['ch
+0002c9d0: 6169 6e5f 6964 275d 0a20 2020 2020 2020  ain_id'].       
+0002c9e0: 2020 2020 2073 6571 5f69 645f 3120 3d20       seq_id_1 = 
+0002c9f0: 7365 6c66 2e61 746f 6d53 656c 6563 7469  self.atomSelecti
+0002ca00: 6f6e 5365 745b 305d 5b30 5d5b 2773 6571  onSet[0][0]['seq
+0002ca10: 5f69 6427 5d0a 2020 2020 2020 2020 2020  _id'].          
+0002ca20: 2020 6174 6f6d 5f69 645f 3120 3d20 7365    atom_id_1 = se
+0002ca30: 6c66 2e61 746f 6d53 656c 6563 7469 6f6e  lf.atomSelection
+0002ca40: 5365 745b 305d 5b30 5d5b 2761 746f 6d5f  Set[0][0]['atom_
+0002ca50: 6964 275d 0a0a 2020 2020 2020 2020 2020  id']..          
+0002ca60: 2020 6368 6169 6e5f 6964 5f32 203d 2073    chain_id_2 = s
+0002ca70: 656c 662e 6174 6f6d 5365 6c65 6374 696f  elf.atomSelectio
+0002ca80: 6e53 6574 5b31 5d5b 305d 5b27 6368 6169  nSet[1][0]['chai
+0002ca90: 6e5f 6964 275d 0a20 2020 2020 2020 2020  n_id'].         
+0002caa0: 2020 2073 6571 5f69 645f 3220 3d20 7365     seq_id_2 = se
+0002cab0: 6c66 2e61 746f 6d53 656c 6563 7469 6f6e  lf.atomSelection
+0002cac0: 5365 745b 315d 5b30 5d5b 2773 6571 5f69  Set[1][0]['seq_i
+0002cad0: 6427 5d0a 2020 2020 2020 2020 2020 2020  d'].            
+0002cae0: 6174 6f6d 5f69 645f 3220 3d20 7365 6c66  atom_id_2 = self
+0002caf0: 2e61 746f 6d53 656c 6563 7469 6f6e 5365  .atomSelectionSe
+0002cb00: 745b 315d 5b30 5d5b 2761 746f 6d5f 6964  t[1][0]['atom_id
+0002cb10: 275d 0a0a 2020 2020 2020 2020 2020 2020  ']..            
+0002cb20: 7472 793a 0a0a 2020 2020 2020 2020 2020  try:..          
+0002cb30: 2020 2020 2020 5f68 6561 6420 3d5c 0a20        _head =\. 
+0002cb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cb50: 2020 2073 656c 662e 5f5f 6352 2e67 6574     self.__cR.get
+0002cb60: 4469 6374 4c69 7374 5769 7468 4669 6c74  DictListWithFilt
+0002cb70: 6572 2827 6174 6f6d 5f73 6974 6527 2c0a  er('atom_site',.
 0002cb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cb90: 2020 2020 7365 6c66 2e5f 5f66 2e61 7070      self.__f.app
-0002cba0: 656e 6428 6622 5b49 6e76 616c 6964 2061  end(f"[Invalid a
-0002cbb0: 746f 6d20 7365 6c65 6374 696f 6e5d 207b  tom selection] {
-0002cbc0: 7365 6c66 2e5f 5f67 6574 4375 7272 656e  self.__getCurren
-0002cbd0: 7452 6573 7472 6169 6e74 2829 7d22 0a20  tRestraint()}". 
+0002cb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cbb0: 2020 2020 4341 5254 4e5f 4441 5441 5f49      CARTN_DATA_I
+0002cbc0: 5445 4d53 2c0a 2020 2020 2020 2020 2020  TEMS,.          
+0002cbd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002cbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cc00: 2020 2066 2246 6169 6c65 6420 746f 2073     f"Failed to s
-0002cc10: 656c 6563 7420 6120 4379 7374 6569 6e20  elect a Cystein 
-0002cc20: 7265 7369 6475 6520 666f 7220 6469 7375  residue for disu
-0002cc30: 6c66 6964 6520 626f 6e64 2062 6574 7765  lfide bond betwe
-0002cc40: 656e 2027 7b73 6571 4964 317d 2720 616e  en '{seqId1}' an
-0002cc50: 6420 277b 7365 7149 6432 7d27 2e22 290a  d '{seqId2}'.").
+0002cbf0: 2020 2020 2020 2020 2020 5b7b 276e 616d            [{'nam
+0002cc00: 6527 3a20 7365 6c66 2e5f 5f61 7574 6841  e': self.__authA
+0002cc10: 7379 6d49 642c 2027 7479 7065 273a 2027  symId, 'type': '
+0002cc20: 7374 7227 2c20 2776 616c 7565 273a 2063  str', 'value': c
+0002cc30: 6861 696e 5f69 645f 317d 2c0a 2020 2020  hain_id_1},.    
+0002cc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002cc60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cc70: 2020 2020 7265 7475 726e 0a0a 2020 2020      return..    
-0002cc80: 2020 2020 2020 2020 6368 6169 6e5f 6964          chain_id
-0002cc90: 5f31 203d 2073 656c 662e 6174 6f6d 5365  _1 = self.atomSe
-0002cca0: 6c65 6374 696f 6e53 6574 5b30 5d5b 305d  lectionSet[0][0]
-0002ccb0: 5b27 6368 6169 6e5f 6964 275d 0a20 2020  ['chain_id'].   
-0002ccc0: 2020 2020 2020 2020 2073 6571 5f69 645f           seq_id_
-0002ccd0: 3120 3d20 7365 6c66 2e61 746f 6d53 656c  1 = self.atomSel
-0002cce0: 6563 7469 6f6e 5365 745b 305d 5b30 5d5b  ectionSet[0][0][
-0002ccf0: 2773 6571 5f69 6427 5d0a 2020 2020 2020  'seq_id'].      
-0002cd00: 2020 2020 2020 6174 6f6d 5f69 645f 3120        atom_id_1 
-0002cd10: 3d20 7365 6c66 2e61 746f 6d53 656c 6563  = self.atomSelec
-0002cd20: 7469 6f6e 5365 745b 305d 5b30 5d5b 2761  tionSet[0][0]['a
-0002cd30: 746f 6d5f 6964 275d 0a0a 2020 2020 2020  tom_id']..      
-0002cd40: 2020 2020 2020 6368 6169 6e5f 6964 5f32        chain_id_2
-0002cd50: 203d 2073 656c 662e 6174 6f6d 5365 6c65   = self.atomSele
-0002cd60: 6374 696f 6e53 6574 5b31 5d5b 305d 5b27  ctionSet[1][0]['
-0002cd70: 6368 6169 6e5f 6964 275d 0a20 2020 2020  chain_id'].     
-0002cd80: 2020 2020 2020 2073 6571 5f69 645f 3220         seq_id_2 
-0002cd90: 3d20 7365 6c66 2e61 746f 6d53 656c 6563  = self.atomSelec
-0002cda0: 7469 6f6e 5365 745b 315d 5b30 5d5b 2773  tionSet[1][0]['s
-0002cdb0: 6571 5f69 6427 5d0a 2020 2020 2020 2020  eq_id'].        
-0002cdc0: 2020 2020 6174 6f6d 5f69 645f 3220 3d20      atom_id_2 = 
-0002cdd0: 7365 6c66 2e61 746f 6d53 656c 6563 7469  self.atomSelecti
-0002cde0: 6f6e 5365 745b 315d 5b30 5d5b 2761 746f  onSet[1][0]['ato
-0002cdf0: 6d5f 6964 275d 0a0a 2020 2020 2020 2020  m_id']..        
-0002ce00: 2020 2020 7472 793a 0a0a 2020 2020 2020      try:..      
-0002ce10: 2020 2020 2020 2020 2020 5f68 6561 6420            _head 
-0002ce20: 3d5c 0a20 2020 2020 2020 2020 2020 2020  =\.             
-0002ce30: 2020 2020 2020 2073 656c 662e 5f5f 6352         self.__cR
-0002ce40: 2e67 6574 4469 6374 4c69 7374 5769 7468  .getDictListWith
-0002ce50: 4669 6c74 6572 2827 6174 6f6d 5f73 6974  Filter('atom_sit
-0002ce60: 6527 2c0a 2020 2020 2020 2020 2020 2020  e',.            
-0002ce70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ce80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ce90: 2020 2020 2020 2020 4341 5254 4e5f 4441          CARTN_DA
-0002cea0: 5441 5f49 5445 4d53 2c0a 2020 2020 2020  TA_ITEMS,.      
-0002ceb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cc70: 207b 276e 616d 6527 3a20 7365 6c66 2e5f   {'name': self._
+0002cc80: 5f61 7574 6853 6571 4964 2c20 2774 7970  _authSeqId, 'typ
+0002cc90: 6527 3a20 2769 6e74 272c 2027 7661 6c75  e': 'int', 'valu
+0002cca0: 6527 3a20 7365 715f 6964 5f31 7d2c 0a20  e': seq_id_1},. 
+0002ccb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ccc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ccd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cce0: 2020 2020 7b27 6e61 6d65 273a 2073 656c      {'name': sel
+0002ccf0: 662e 5f5f 6175 7468 4174 6f6d 4964 2c20  f.__authAtomId, 
+0002cd00: 2774 7970 6527 3a20 2773 7472 272c 2027  'type': 'str', '
+0002cd10: 7661 6c75 6527 3a20 6174 6f6d 5f69 645f  value': atom_id_
+0002cd20: 317d 2c0a 2020 2020 2020 2020 2020 2020  1},.            
+0002cd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cd50: 2020 2020 2020 2020 207b 276e 616d 6527           {'name'
+0002cd60: 3a20 7365 6c66 2e5f 5f6d 6f64 656c 4e75  : self.__modelNu
+0002cd70: 6d4e 616d 652c 2027 7479 7065 273a 2027  mName, 'type': '
+0002cd80: 696e 7427 2c0a 2020 2020 2020 2020 2020  int',.          
+0002cd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cdb0: 2020 2020 2020 2020 2020 2020 2776 616c              'val
+0002cdc0: 7565 273a 2073 656c 662e 5f5f 7265 7072  ue': self.__repr
+0002cdd0: 6573 656e 7461 7469 7665 4d6f 6465 6c49  esentativeModelI
+0002cde0: 647d 2c0a 2020 2020 2020 2020 2020 2020  d},.            
+0002cdf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ce00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ce10: 2020 2020 2020 2020 207b 276e 616d 6527           {'name'
+0002ce20: 3a20 276c 6162 656c 5f61 6c74 5f69 6427  : 'label_alt_id'
+0002ce30: 2c20 2774 7970 6527 3a20 2765 6e75 6d27  , 'type': 'enum'
+0002ce40: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002ce50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ce60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ce70: 2020 2020 2020 2020 2765 6e75 6d27 3a20          'enum': 
+0002ce80: 2827 4127 297d 0a20 2020 2020 2020 2020  ('A')}.         
+0002ce90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ceb0: 2020 2020 2020 2020 2020 2020 5d29 0a0a              ])..
 0002cec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ced0: 2020 2020 2020 2020 2020 2020 2020 5b7b                [{
-0002cee0: 276e 616d 6527 3a20 7365 6c66 2e5f 5f61  'name': self.__a
-0002cef0: 7574 6841 7379 6d49 642c 2027 7479 7065  uthAsymId, 'type
-0002cf00: 273a 2027 7374 7227 2c20 2776 616c 7565  ': 'str', 'value
-0002cf10: 273a 2063 6861 696e 5f69 645f 317d 2c0a  ': chain_id_1},.
+0002ced0: 5f74 6169 6c20 3d5c 0a20 2020 2020 2020  _tail =\.       
+0002cee0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0002cef0: 662e 5f5f 6352 2e67 6574 4469 6374 4c69  f.__cR.getDictLi
+0002cf00: 7374 5769 7468 4669 6c74 6572 2827 6174  stWithFilter('at
+0002cf10: 6f6d 5f73 6974 6527 2c0a 2020 2020 2020  om_site',.      
 0002cf20: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002cf30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cf40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cf50: 2020 2020 207b 276e 616d 6527 3a20 7365       {'name': se
-0002cf60: 6c66 2e5f 5f61 7574 6853 6571 4964 2c20  lf.__authSeqId, 
-0002cf70: 2774 7970 6527 3a20 2769 6e74 272c 2027  'type': 'int', '
-0002cf80: 7661 6c75 6527 3a20 7365 715f 6964 5f31  value': seq_id_1
-0002cf90: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
-0002cfa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cfb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cfc0: 2020 2020 2020 2020 7b27 6e61 6d65 273a          {'name':
-0002cfd0: 2073 656c 662e 5f5f 6175 7468 4174 6f6d   self.__authAtom
-0002cfe0: 4964 2c20 2774 7970 6527 3a20 2773 7472  Id, 'type': 'str
-0002cff0: 272c 2027 7661 6c75 6527 3a20 6174 6f6d  ', 'value': atom
-0002d000: 5f69 645f 317d 2c0a 2020 2020 2020 2020  _id_1},.        
-0002d010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d030: 2020 2020 2020 2020 2020 2020 207b 276e               {'n
-0002d040: 616d 6527 3a20 7365 6c66 2e5f 5f6d 6f64  ame': self.__mod
-0002d050: 656c 4e75 6d4e 616d 652c 2027 7479 7065  elNumName, 'type
-0002d060: 273a 2027 696e 7427 2c0a 2020 2020 2020  ': 'int',.      
-0002d070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d0a0: 2776 616c 7565 273a 2073 656c 662e 5f5f  'value': self.__
-0002d0b0: 7265 7072 6573 656e 7461 7469 7665 4d6f  representativeMo
-0002d0c0: 6465 6c49 647d 2c0a 2020 2020 2020 2020  delId},.        
+0002cf40: 2020 2020 2020 2020 2020 2020 2020 4341                CA
+0002cf50: 5254 4e5f 4441 5441 5f49 5445 4d53 2c0a  RTN_DATA_ITEMS,.
+0002cf60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cf70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cf80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cf90: 2020 2020 5b7b 276e 616d 6527 3a20 7365      [{'name': se
+0002cfa0: 6c66 2e5f 5f61 7574 6841 7379 6d49 642c  lf.__authAsymId,
+0002cfb0: 2027 7479 7065 273a 2027 7374 7227 2c20   'type': 'str', 
+0002cfc0: 2776 616c 7565 273a 2063 6861 696e 5f69  'value': chain_i
+0002cfd0: 645f 327d 2c0a 2020 2020 2020 2020 2020  d_2},.          
+0002cfe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d000: 2020 2020 2020 2020 2020 207b 276e 616d             {'nam
+0002d010: 6527 3a20 7365 6c66 2e5f 5f61 7574 6853  e': self.__authS
+0002d020: 6571 4964 2c20 2774 7970 6527 3a20 2769  eqId, 'type': 'i
+0002d030: 6e74 272c 2027 7661 6c75 6527 3a20 7365  nt', 'value': se
+0002d040: 715f 6964 5f32 7d2c 0a20 2020 2020 2020  q_id_2},.       
+0002d050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d070: 2020 2020 2020 2020 2020 2020 2020 7b27                {'
+0002d080: 6e61 6d65 273a 2073 656c 662e 5f5f 6175  name': self.__au
+0002d090: 7468 4174 6f6d 4964 2c20 2774 7970 6527  thAtomId, 'type'
+0002d0a0: 3a20 2773 7472 272c 2027 7661 6c75 6527  : 'str', 'value'
+0002d0b0: 3a20 6174 6f6d 5f69 645f 327d 2c0a 2020  : atom_id_2},.  
+0002d0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002d0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002d0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d0f0: 2020 2020 2020 2020 2020 2020 207b 276e               {'n
-0002d100: 616d 6527 3a20 276c 6162 656c 5f61 6c74  ame': 'label_alt
-0002d110: 5f69 6427 2c20 2774 7970 6527 3a20 2765  _id', 'type': 'e
-0002d120: 6e75 6d27 2c0a 2020 2020 2020 2020 2020  num',.          
+0002d0f0: 2020 207b 276e 616d 6527 3a20 7365 6c66     {'name': self
+0002d100: 2e5f 5f6d 6f64 656c 4e75 6d4e 616d 652c  .__modelNumName,
+0002d110: 2027 7479 7065 273a 2027 696e 7427 2c0a   'type': 'int',.
+0002d120: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002d130: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002d140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d150: 2020 2020 2020 2020 2020 2020 2765 6e75              'enu
-0002d160: 6d27 3a20 2827 4127 297d 0a20 2020 2020  m': ('A')}.     
-0002d170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d150: 2020 2020 2020 2776 616c 7565 273a 2073        'value': s
+0002d160: 656c 662e 5f5f 7265 7072 6573 656e 7461  elf.__representa
+0002d170: 7469 7665 4d6f 6465 6c49 647d 2c0a 2020  tiveModelId},.  
 0002d180: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002d190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d1a0: 5d29 0a0a 2020 2020 2020 2020 2020 2020  ])..            
-0002d1b0: 2020 2020 5f74 6169 6c20 3d5c 0a20 2020      _tail =\.   
-0002d1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d1d0: 2073 656c 662e 5f5f 6352 2e67 6574 4469   self.__cR.getDi
-0002d1e0: 6374 4c69 7374 5769 7468 4669 6c74 6572  ctListWithFilter
-0002d1f0: 2827 6174 6f6d 5f73 6974 6527 2c0a 2020  ('atom_site',.  
+0002d1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d1b0: 2020 207b 276e 616d 6527 3a20 276c 6162     {'name': 'lab
+0002d1c0: 656c 5f61 6c74 5f69 6427 2c20 2774 7970  el_alt_id', 'typ
+0002d1d0: 6527 3a20 2765 6e75 6d27 2c0a 2020 2020  e': 'enum',.    
+0002d1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002d200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d230: 2020 4341 5254 4e5f 4441 5441 5f49 5445    CARTN_DATA_ITE
-0002d240: 4d53 2c0a 2020 2020 2020 2020 2020 2020  MS,.            
-0002d250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d270: 2020 2020 2020 2020 5b7b 276e 616d 6527          [{'name'
-0002d280: 3a20 7365 6c66 2e5f 5f61 7574 6841 7379  : self.__authAsy
-0002d290: 6d49 642c 2027 7479 7065 273a 2027 7374  mId, 'type': 'st
-0002d2a0: 7227 2c20 2776 616c 7565 273a 2063 6861  r', 'value': cha
-0002d2b0: 696e 5f69 645f 327d 2c0a 2020 2020 2020  in_id_2},.      
-0002d2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d2e0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-0002d2f0: 276e 616d 6527 3a20 7365 6c66 2e5f 5f61  'name': self.__a
-0002d300: 7574 6853 6571 4964 2c20 2774 7970 6527  uthSeqId, 'type'
-0002d310: 3a20 2769 6e74 272c 2027 7661 6c75 6527  : 'int', 'value'
-0002d320: 3a20 7365 715f 6964 5f32 7d2c 0a20 2020  : seq_id_2},.   
-0002d330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d360: 2020 7b27 6e61 6d65 273a 2073 656c 662e    {'name': self.
-0002d370: 5f5f 6175 7468 4174 6f6d 4964 2c20 2774  __authAtomId, 't
-0002d380: 7970 6527 3a20 2773 7472 272c 2027 7661  ype': 'str', 'va
-0002d390: 6c75 6527 3a20 6174 6f6d 5f69 645f 327d  lue': atom_id_2}
-0002d3a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002d3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d3d0: 2020 2020 2020 207b 276e 616d 6527 3a20         {'name': 
-0002d3e0: 7365 6c66 2e5f 5f6d 6f64 656c 4e75 6d4e  self.__modelNumN
-0002d3f0: 616d 652c 2027 7479 7065 273a 2027 696e  ame, 'type': 'in
-0002d400: 7427 2c0a 2020 2020 2020 2020 2020 2020  t',.            
-0002d410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d430: 2020 2020 2020 2020 2020 2776 616c 7565            'value
-0002d440: 273a 2073 656c 662e 5f5f 7265 7072 6573  ': self.__repres
-0002d450: 656e 7461 7469 7665 4d6f 6465 6c49 647d  entativeModelId}
-0002d460: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002d470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d490: 2020 2020 2020 207b 276e 616d 6527 3a20         {'name': 
-0002d4a0: 276c 6162 656c 5f61 6c74 5f69 6427 2c20  'label_alt_id', 
-0002d4b0: 2774 7970 6527 3a20 2765 6e75 6d27 2c0a  'type': 'enum',.
-0002d4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d4f0: 2020 2020 2020 2765 6e75 6d27 3a20 2827        'enum': ('
-0002d500: 4127 297d 0a20 2020 2020 2020 2020 2020  A')}.           
-0002d510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d530: 2020 2020 2020 2020 2020 5d29 0a0a 2020            ])..  
-0002d540: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0002d550: 206c 656e 285f 6865 6164 2920 3d3d 2031   len(_head) == 1
-0002d560: 2061 6e64 206c 656e 285f 7461 696c 2920   and len(_tail) 
-0002d570: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
-0002d580: 2020 2020 2020 2020 2020 6469 7374 616e            distan
-0002d590: 6365 203d 206e 756d 7079 2e6c 696e 616c  ce = numpy.linal
-0002d5a0: 672e 6e6f 726d 2874 6f4e 7041 7272 6179  g.norm(toNpArray
-0002d5b0: 285f 6865 6164 5b30 5d29 202d 2074 6f4e  (_head[0]) - toN
-0002d5c0: 7041 7272 6179 285f 7461 696c 5b30 5d29  pArray(_tail[0])
-0002d5d0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0002d5e0: 2020 2020 2020 6966 2064 6973 7461 6e63        if distanc
-0002d5f0: 6520 3e20 322e 353a 0a20 2020 2020 2020  e > 2.5:.       
-0002d600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d610: 2073 656c 662e 5f5f 662e 6170 7065 6e64   self.__f.append
-0002d620: 2866 225b 5261 6e67 6520 7661 6c75 6520  (f"[Range value 
-0002d630: 7761 726e 696e 675d 207b 7365 6c66 2e5f  warning] {self._
-0002d640: 5f67 6574 4375 7272 656e 7452 6573 7472  _getCurrentRestr
-0002d650: 6169 6e74 2829 7d22 0a20 2020 2020 2020  aint()}".       
-0002d660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d680: 2066 2254 6865 2064 6973 7461 6e63 6520   f"The distance 
-0002d690: 6f66 2074 6865 2064 6973 756c 6669 6465  of the disulfide
-0002d6a0: 2062 6f6e 6420 6c69 6e6b 6167 6520 287b   bond linkage ({
-0002d6b0: 6368 6169 6e5f 6964 5f31 7d3a 7b73 6571  chain_id_1}:{seq
-0002d6c0: 5f69 645f 317d 3a7b 6174 6f6d 5f69 645f  _id_1}:{atom_id_
-0002d6d0: 317d 202d 2022 0a20 2020 2020 2020 2020  1} - ".         
-0002d6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d6f0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0002d700: 227b 6368 6169 6e5f 6964 5f32 7d3a 7b73  "{chain_id_2}:{s
-0002d710: 6571 5f69 645f 327d 3a7b 6174 6f6d 5f69  eq_id_2}:{atom_i
-0002d720: 645f 327d 2920 6973 2074 6f6f 2066 6172  d_2}) is too far
-0002d730: 2061 7061 7274 2069 6e20 7468 6520 636f   apart in the co
-0002d740: 6f72 6469 6e61 7465 7320 287b 6469 7374  ordinates ({dist
-0002d750: 616e 6365 3a2e 3366 7dc3 8529 2e22 290a  ance:.3f}..).").
-0002d760: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
-0002d770: 6570 7420 4578 6365 7074 696f 6e20 6173  ept Exception as
-0002d780: 2065 3a0a 2020 2020 2020 2020 2020 2020   e:.            
-0002d790: 2020 2020 6966 2073 656c 662e 5f5f 7665      if self.__ve
-0002d7a0: 7262 6f73 653a 0a20 2020 2020 2020 2020  rbose:.         
-0002d7b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0002d7c0: 5f5f 6c66 682e 7772 6974 6528 6622 2b52  __lfh.write(f"+R
-0002d7d0: 6f73 6574 7461 4d52 5061 7273 6572 4c69  osettaMRParserLi
-0002d7e0: 7374 656e 6572 2e65 7869 7444 6973 756c  stener.exitDisul
-0002d7f0: 6669 6465 5f62 6f6e 645f 6c69 6e6b 6167  fide_bond_linkag
-0002d800: 6528 2920 2b2b 2045 7272 6f72 2020 2d20  e() ++ Error  - 
-0002d810: 7b73 7472 2865 297d 2229 0a0a 2020 2020  {str(e)}")..    
-0002d820: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0002d830: 5f5f 6372 6561 7465 5366 4469 6374 3a0a  __createSfDict:.
-0002d840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d850: 7366 203d 2073 656c 662e 5f5f 6765 7453  sf = self.__getS
-0002d860: 6628 290a 2020 2020 2020 2020 2020 2020  f().            
-0002d870: 2020 2020 7366 5b27 6964 275d 202b 3d20      sf['id'] += 
-0002d880: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
-0002d890: 2020 6d65 6d62 6572 4c6f 6769 6343 6f64    memberLogicCod
-0002d8a0: 6520 3d20 274f 5227 2069 6620 6c65 6e28  e = 'OR' if len(
-0002d8b0: 7365 6c66 2e61 746f 6d53 656c 6563 7469  self.atomSelecti
-0002d8c0: 6f6e 5365 745b 305d 2920 2a20 6c65 6e28  onSet[0]) * len(
-0002d8d0: 7365 6c66 2e61 746f 6d53 656c 6563 7469  self.atomSelecti
-0002d8e0: 6f6e 5365 745b 315d 2920 3e20 3120 656c  onSet[1]) > 1 el
-0002d8f0: 7365 2027 2e27 0a0a 2020 2020 2020 2020  se '.'..        
-0002d900: 2020 2020 6861 735f 696e 7472 615f 6368      has_intra_ch
-0002d910: 6169 6e2c 2072 6570 5f63 6861 696e 5f69  ain, rep_chain_i
-0002d920: 645f 7365 7420 3d20 6861 7349 6e74 7261  d_set = hasIntra
-0002d930: 4368 6169 6e52 6573 7472 6169 6e74 2873  ChainRestraint(s
-0002d940: 656c 662e 6174 6f6d 5365 6c65 6374 696f  elf.atomSelectio
-0002d950: 6e53 6574 290a 0a20 2020 2020 2020 2020  nSet)..         
-0002d960: 2020 2069 6620 7365 6c66 2e5f 5f63 7265     if self.__cre
-0002d970: 6174 6553 6644 6963 7420 616e 6420 6d65  ateSfDict and me
-0002d980: 6d62 6572 4c6f 6769 6343 6f64 6520 3d3d  mberLogicCode ==
-0002d990: 2027 4f52 2720 616e 6420 6861 735f 696e   'OR' and has_in
-0002d9a0: 7472 615f 6368 6169 6e20 616e 6420 6c65  tra_chain and le
-0002d9b0: 6e28 7265 705f 6368 6169 6e5f 6964 5f73  n(rep_chain_id_s
-0002d9c0: 6574 2920 3d3d 2031 3a0a 2020 2020 2020  et) == 1:.      
-0002d9d0: 2020 2020 2020 2020 2020 6d65 6d62 6572            member
-0002d9e0: 4c6f 6769 6343 6f64 6520 3d20 272e 270a  LogicCode = '.'.
-0002d9f0: 0a20 2020 2020 2020 2020 2020 206d 656d  .            mem
-0002da00: 6265 7249 6420 3d20 272e 270a 2020 2020  berId = '.'.    
-0002da10: 2020 2020 2020 2020 6966 206d 656d 6265          if membe
-0002da20: 724c 6f67 6963 436f 6465 203d 3d20 274f  rLogicCode == 'O
-0002da30: 5227 3a0a 2020 2020 2020 2020 2020 2020  R':.            
-0002da40: 2020 2020 6966 206c 656e 2873 656c 662e      if len(self.
-0002da50: 6174 6f6d 5365 6c65 6374 696f 6e53 6574  atomSelectionSet
-0002da60: 5b30 5d29 202a 206c 656e 2873 656c 662e  [0]) * len(self.
-0002da70: 6174 6f6d 5365 6c65 6374 696f 6e53 6574  atomSelectionSet
-0002da80: 5b31 5d29 203e 2031 5c0a 2020 2020 2020  [1]) > 1\.      
-0002da90: 2020 2020 2020 2020 2020 2020 2061 6e64               and
-0002daa0: 2028 6973 416d 6269 6741 746f 6d53 656c   (isAmbigAtomSel
-0002dab0: 6563 7469 6f6e 2873 656c 662e 6174 6f6d  ection(self.atom
-0002dac0: 5365 6c65 6374 696f 6e53 6574 5b30 5d2c  SelectionSet[0],
-0002dad0: 2073 656c 662e 5f5f 6373 5374 6174 290a   self.__csStat).
-0002dae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002daf0: 2020 2020 2020 2020 6f72 2069 7341 6d62          or isAmb
-0002db00: 6967 4174 6f6d 5365 6c65 6374 696f 6e28  igAtomSelection(
-0002db10: 7365 6c66 2e61 746f 6d53 656c 6563 7469  self.atomSelecti
-0002db20: 6f6e 5365 745b 315d 2c20 7365 6c66 2e5f  onSet[1], self._
-0002db30: 5f63 7353 7461 7429 293a 0a20 2020 2020  _csStat)):.     
-0002db40: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0002db50: 656d 6265 7249 6420 3d20 300a 2020 2020  emberId = 0.    
-0002db60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002db70: 5f61 746f 6d31 203d 205f 6174 6f6d 3220  _atom1 = _atom2 
-0002db80: 3d20 4e6f 6e65 0a0a 2020 2020 2020 2020  = None..        
-0002db90: 2020 2020 666f 7220 6174 6f6d 312c 2061      for atom1, a
-0002dba0: 746f 6d32 2069 6e20 6974 6572 746f 6f6c  tom2 in itertool
-0002dbb0: 732e 7072 6f64 7563 7428 7365 6c66 2e61  s.product(self.a
-0002dbc0: 746f 6d53 656c 6563 7469 6f6e 5365 745b  tomSelectionSet[
-0002dbd0: 305d 2c0a 2020 2020 2020 2020 2020 2020  0],.            
-0002dbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002dbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002dc00: 2020 2020 2020 7365 6c66 2e61 746f 6d53        self.atomS
-0002dc10: 656c 6563 7469 6f6e 5365 745b 315d 293a  electionSet[1]):
-0002dc20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002dc30: 2069 6620 6973 4964 656e 7469 6361 6c52   if isIdenticalR
-0002dc40: 6573 7472 6169 6e74 285b 6174 6f6d 312c  estraint([atom1,
-0002dc50: 2061 746f 6d32 5d29 3a0a 2020 2020 2020   atom2]):.      
-0002dc60: 2020 2020 2020 2020 2020 2020 2020 636f                co
-0002dc70: 6e74 696e 7565 0a20 2020 2020 2020 2020  ntinue.         
-0002dc80: 2020 2020 2020 2069 6620 6861 735f 696e         if has_in
-0002dc90: 7472 615f 6368 6169 6e20 616e 6420 2861  tra_chain and (a
-0002dca0: 746f 6d31 5b27 6368 6169 6e5f 6964 275d  tom1['chain_id']
-0002dcb0: 2021 3d20 6174 6f6d 325b 2763 6861 696e   != atom2['chain
-0002dcc0: 5f69 6427 5d20 6f72 2061 746f 6d31 5b27  _id'] or atom1['
-0002dcd0: 6368 6169 6e5f 6964 275d 206e 6f74 2069  chain_id'] not i
-0002dce0: 6e20 7265 705f 6368 6169 6e5f 6964 5f73  n rep_chain_id_s
-0002dcf0: 6574 293a 0a20 2020 2020 2020 2020 2020  et):.           
-0002dd00: 2020 2020 2020 2020 2063 6f6e 7469 6e75           continu
-0002dd10: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-0002dd20: 2020 6966 2073 656c 662e 5f5f 6465 6275    if self.__debu
-0002dd30: 673a 0a20 2020 2020 2020 2020 2020 2020  g:.             
-0002dd40: 2020 2020 2020 2070 7269 6e74 2866 2273         print(f"s
-0002dd50: 7562 7479 7065 3d7b 7365 6c66 2e5f 5f63  ubtype={self.__c
-0002dd60: 7572 5f73 7562 7479 7065 7d20 2843 532d  ur_subtype} (CS-
-0002dd70: 524f 5345 5454 413a 2064 6973 756c 6669  ROSETTA: disulfi
-0002dd80: 6465 2062 6f6e 6420 6c69 6e6b 6167 6529  de bond linkage)
-0002dd90: 2069 643d 7b73 656c 662e 7373 626f 6e64   id={self.ssbond
-0002dda0: 5265 7374 7261 696e 7473 7d20 220a 2020  Restraints} ".  
+0002d210: 2020 2765 6e75 6d27 3a20 2827 4127 297d    'enum': ('A')}
+0002d220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002d230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d250: 2020 2020 2020 5d29 0a0a 2020 2020 2020        ])..      
+0002d260: 2020 2020 2020 2020 2020 6966 206c 656e            if len
+0002d270: 285f 6865 6164 2920 3d3d 2031 2061 6e64  (_head) == 1 and
+0002d280: 206c 656e 285f 7461 696c 2920 3d3d 2031   len(_tail) == 1
+0002d290: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002d2a0: 2020 2020 2020 6469 7374 616e 6365 203d        distance =
+0002d2b0: 206e 756d 7079 2e6c 696e 616c 672e 6e6f   numpy.linalg.no
+0002d2c0: 726d 2874 6f4e 7041 7272 6179 285f 6865  rm(toNpArray(_he
+0002d2d0: 6164 5b30 5d29 202d 2074 6f4e 7041 7272  ad[0]) - toNpArr
+0002d2e0: 6179 285f 7461 696c 5b30 5d29 290a 2020  ay(_tail[0])).  
+0002d2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d300: 2020 6966 2064 6973 7461 6e63 6520 3e20    if distance > 
+0002d310: 322e 353a 0a20 2020 2020 2020 2020 2020  2.5:.           
+0002d320: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0002d330: 662e 5f5f 662e 6170 7065 6e64 2866 225b  f.__f.append(f"[
+0002d340: 5261 6e67 6520 7661 6c75 6520 7761 726e  Range value warn
+0002d350: 696e 675d 207b 7365 6c66 2e5f 5f67 6574  ing] {self.__get
+0002d360: 4375 7272 656e 7452 6573 7472 6169 6e74  CurrentRestraint
+0002d370: 2829 7d22 0a20 2020 2020 2020 2020 2020  ()}".           
+0002d380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d390: 2020 2020 2020 2020 2020 2020 2066 2254               f"T
+0002d3a0: 6865 2064 6973 7461 6e63 6520 6f66 2074  he distance of t
+0002d3b0: 6865 2064 6973 756c 6669 6465 2062 6f6e  he disulfide bon
+0002d3c0: 6420 6c69 6e6b 6167 6520 287b 6368 6169  d linkage ({chai
+0002d3d0: 6e5f 6964 5f31 7d3a 7b73 6571 5f69 645f  n_id_1}:{seq_id_
+0002d3e0: 317d 3a7b 6174 6f6d 5f69 645f 317d 202d  1}:{atom_id_1} -
+0002d3f0: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+0002d400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d410: 2020 2020 2020 2020 2020 2066 227b 6368             f"{ch
+0002d420: 6169 6e5f 6964 5f32 7d3a 7b73 6571 5f69  ain_id_2}:{seq_i
+0002d430: 645f 327d 3a7b 6174 6f6d 5f69 645f 327d  d_2}:{atom_id_2}
+0002d440: 2920 6973 2074 6f6f 2066 6172 2061 7061  ) is too far apa
+0002d450: 7274 2069 6e20 7468 6520 636f 6f72 6469  rt in the coordi
+0002d460: 6e61 7465 7320 287b 6469 7374 616e 6365  nates ({distance
+0002d470: 3a2e 3366 7dc3 8529 2e22 290a 0a20 2020  :.3f}..).")..   
+0002d480: 2020 2020 2020 2020 2065 7863 6570 7420           except 
+0002d490: 4578 6365 7074 696f 6e20 6173 2065 3a0a  Exception as e:.
+0002d4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d4b0: 6966 2073 656c 662e 5f5f 7665 7262 6f73  if self.__verbos
+0002d4c0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0002d4d0: 2020 2020 2020 2073 656c 662e 5f5f 6c66         self.__lf
+0002d4e0: 682e 7772 6974 6528 6622 2b52 6f73 6574  h.write(f"+Roset
+0002d4f0: 7461 4d52 5061 7273 6572 4c69 7374 656e  taMRParserListen
+0002d500: 6572 2e65 7869 7444 6973 756c 6669 6465  er.exitDisulfide
+0002d510: 5f62 6f6e 645f 6c69 6e6b 6167 6528 2920  _bond_linkage() 
+0002d520: 2b2b 2045 7272 6f72 2020 2d20 7b73 7472  ++ Error  - {str
+0002d530: 2865 297d 2229 0a0a 2020 2020 2020 2020  (e)}")..        
+0002d540: 2020 2020 6966 2073 656c 662e 5f5f 6372      if self.__cr
+0002d550: 6561 7465 5366 4469 6374 3a0a 2020 2020  eateSfDict:.    
+0002d560: 2020 2020 2020 2020 2020 2020 7366 203d              sf =
+0002d570: 2073 656c 662e 5f5f 6765 7453 6628 290a   self.__getSf().
+0002d580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d590: 7366 5b27 6964 275d 202b 3d20 310a 2020  sf['id'] += 1.  
+0002d5a0: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+0002d5b0: 6d62 6572 4c6f 6769 6343 6f64 6520 3d20  mberLogicCode = 
+0002d5c0: 274f 5227 2069 6620 6c65 6e28 7365 6c66  'OR' if len(self
+0002d5d0: 2e61 746f 6d53 656c 6563 7469 6f6e 5365  .atomSelectionSe
+0002d5e0: 745b 305d 2920 2a20 6c65 6e28 7365 6c66  t[0]) * len(self
+0002d5f0: 2e61 746f 6d53 656c 6563 7469 6f6e 5365  .atomSelectionSe
+0002d600: 745b 315d 2920 3e20 3120 656c 7365 2027  t[1]) > 1 else '
+0002d610: 2e27 0a0a 2020 2020 2020 2020 2020 2020  .'..            
+0002d620: 6861 735f 696e 7472 615f 6368 6169 6e2c  has_intra_chain,
+0002d630: 2072 6570 5f63 6861 696e 5f69 645f 7365   rep_chain_id_se
+0002d640: 7420 3d20 6861 7349 6e74 7261 4368 6169  t = hasIntraChai
+0002d650: 6e52 6573 7472 6169 6e74 2873 656c 662e  nRestraint(self.
+0002d660: 6174 6f6d 5365 6c65 6374 696f 6e53 6574  atomSelectionSet
+0002d670: 290a 0a20 2020 2020 2020 2020 2020 2069  )..            i
+0002d680: 6620 7365 6c66 2e5f 5f63 7265 6174 6553  f self.__createS
+0002d690: 6644 6963 7420 616e 6420 6d65 6d62 6572  fDict and member
+0002d6a0: 4c6f 6769 6343 6f64 6520 3d3d 2027 4f52  LogicCode == 'OR
+0002d6b0: 2720 616e 6420 6861 735f 696e 7472 615f  ' and has_intra_
+0002d6c0: 6368 6169 6e20 616e 6420 6c65 6e28 7265  chain and len(re
+0002d6d0: 705f 6368 6169 6e5f 6964 5f73 6574 2920  p_chain_id_set) 
+0002d6e0: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
+0002d6f0: 2020 2020 2020 6d65 6d62 6572 4c6f 6769        memberLogi
+0002d700: 6343 6f64 6520 3d20 272e 270a 0a20 2020  cCode = '.'..   
+0002d710: 2020 2020 2020 2020 206d 656d 6265 7249           memberI
+0002d720: 6420 3d20 272e 270a 2020 2020 2020 2020  d = '.'.        
+0002d730: 2020 2020 6966 206d 656d 6265 724c 6f67      if memberLog
+0002d740: 6963 436f 6465 203d 3d20 274f 5227 3a0a  icCode == 'OR':.
+0002d750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d760: 6966 206c 656e 2873 656c 662e 6174 6f6d  if len(self.atom
+0002d770: 5365 6c65 6374 696f 6e53 6574 5b30 5d29  SelectionSet[0])
+0002d780: 202a 206c 656e 2873 656c 662e 6174 6f6d   * len(self.atom
+0002d790: 5365 6c65 6374 696f 6e53 6574 5b31 5d29  SelectionSet[1])
+0002d7a0: 203e 2031 5c0a 2020 2020 2020 2020 2020   > 1\.          
+0002d7b0: 2020 2020 2020 2020 2061 6e64 2028 6973           and (is
+0002d7c0: 416d 6269 6741 746f 6d53 656c 6563 7469  AmbigAtomSelecti
+0002d7d0: 6f6e 2873 656c 662e 6174 6f6d 5365 6c65  on(self.atomSele
+0002d7e0: 6374 696f 6e53 6574 5b30 5d2c 2073 656c  ctionSet[0], sel
+0002d7f0: 662e 5f5f 6373 5374 6174 290a 2020 2020  f.__csStat).    
+0002d800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d810: 2020 2020 6f72 2069 7341 6d62 6967 4174      or isAmbigAt
+0002d820: 6f6d 5365 6c65 6374 696f 6e28 7365 6c66  omSelection(self
+0002d830: 2e61 746f 6d53 656c 6563 7469 6f6e 5365  .atomSelectionSe
+0002d840: 745b 315d 2c20 7365 6c66 2e5f 5f63 7353  t[1], self.__csS
+0002d850: 7461 7429 293a 0a20 2020 2020 2020 2020  tat)):.         
+0002d860: 2020 2020 2020 2020 2020 206d 656d 6265             membe
+0002d870: 7249 6420 3d20 300a 2020 2020 2020 2020  rId = 0.        
+0002d880: 2020 2020 2020 2020 2020 2020 5f61 746f              _ato
+0002d890: 6d31 203d 205f 6174 6f6d 3220 3d20 4e6f  m1 = _atom2 = No
+0002d8a0: 6e65 0a0a 2020 2020 2020 2020 2020 2020  ne..            
+0002d8b0: 666f 7220 6174 6f6d 312c 2061 746f 6d32  for atom1, atom2
+0002d8c0: 2069 6e20 6974 6572 746f 6f6c 732e 7072   in itertools.pr
+0002d8d0: 6f64 7563 7428 7365 6c66 2e61 746f 6d53  oduct(self.atomS
+0002d8e0: 656c 6563 7469 6f6e 5365 745b 305d 2c0a  electionSet[0],.
+0002d8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d920: 2020 7365 6c66 2e61 746f 6d53 656c 6563    self.atomSelec
+0002d930: 7469 6f6e 5365 745b 315d 293a 0a20 2020  tionSet[1]):.   
+0002d940: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0002d950: 6973 4964 656e 7469 6361 6c52 6573 7472  isIdenticalRestr
+0002d960: 6169 6e74 285b 6174 6f6d 312c 2061 746f  aint([atom1, ato
+0002d970: 6d32 5d29 3a0a 2020 2020 2020 2020 2020  m2]):.          
+0002d980: 2020 2020 2020 2020 2020 636f 6e74 696e            contin
+0002d990: 7565 0a20 2020 2020 2020 2020 2020 2020  ue.             
+0002d9a0: 2020 2069 6620 6861 735f 696e 7472 615f     if has_intra_
+0002d9b0: 6368 6169 6e20 616e 6420 2861 746f 6d31  chain and (atom1
+0002d9c0: 5b27 6368 6169 6e5f 6964 275d 2021 3d20  ['chain_id'] != 
+0002d9d0: 6174 6f6d 325b 2763 6861 696e 5f69 6427  atom2['chain_id'
+0002d9e0: 5d20 6f72 2061 746f 6d31 5b27 6368 6169  ] or atom1['chai
+0002d9f0: 6e5f 6964 275d 206e 6f74 2069 6e20 7265  n_id'] not in re
+0002da00: 705f 6368 6169 6e5f 6964 5f73 6574 293a  p_chain_id_set):
+0002da10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002da20: 2020 2020 2063 6f6e 7469 6e75 650a 2020       continue.  
+0002da30: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0002da40: 2073 656c 662e 5f5f 6465 6275 673a 0a20   self.__debug:. 
+0002da50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002da60: 2020 2070 7269 6e74 2866 2273 7562 7479     print(f"subty
+0002da70: 7065 3d7b 7365 6c66 2e5f 5f63 7572 5f73  pe={self.__cur_s
+0002da80: 7562 7479 7065 7d20 2843 532d 524f 5345  ubtype} (CS-ROSE
+0002da90: 5454 413a 2064 6973 756c 6669 6465 2062  TTA: disulfide b
+0002daa0: 6f6e 6420 6c69 6e6b 6167 6529 2069 643d  ond linkage) id=
+0002dab0: 7b73 656c 662e 7373 626f 6e64 5265 7374  {self.ssbondRest
+0002dac0: 7261 696e 7473 7d20 220a 2020 2020 2020  raints} ".      
+0002dad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dae0: 2020 2020 6622 6174 6f6d 313d 7b61 746f      f"atom1={ato
+0002daf0: 6d31 7d20 6174 6f6d 323d 7b61 746f 6d32  m1} atom2={atom2
+0002db00: 7d22 290a 2020 2020 2020 2020 2020 2020  }").            
+0002db10: 2020 2020 6966 2073 656c 662e 5f5f 6372      if self.__cr
+0002db20: 6561 7465 5366 4469 6374 2061 6e64 2073  eateSfDict and s
+0002db30: 6620 6973 206e 6f74 204e 6f6e 653a 0a20  f is not None:. 
+0002db40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002db50: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+0002db60: 286d 656d 6265 7249 642c 2069 6e74 293a  (memberId, int):
+0002db70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002db80: 2020 2020 2020 2020 2069 6620 5f61 746f           if _ato
+0002db90: 6d31 2069 7320 4e6f 6e65 206f 7220 6973  m1 is None or is
+0002dba0: 416d 6269 6741 746f 6d53 656c 6563 7469  AmbigAtomSelecti
+0002dbb0: 6f6e 285b 5f61 746f 6d31 2c20 6174 6f6d  on([_atom1, atom
+0002dbc0: 315d 2c20 7365 6c66 2e5f 5f63 7353 7461  1], self.__csSta
+0002dbd0: 7429 5c0a 2020 2020 2020 2020 2020 2020  t)\.            
+0002dbe0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+0002dbf0: 7220 6973 416d 6269 6741 746f 6d53 656c  r isAmbigAtomSel
+0002dc00: 6563 7469 6f6e 285b 5f61 746f 6d32 2c20  ection([_atom2, 
+0002dc10: 6174 6f6d 325d 2c20 7365 6c66 2e5f 5f63  atom2], self.__c
+0002dc20: 7353 7461 7429 3a0a 2020 2020 2020 2020  sStat):.        
+0002dc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dc40: 2020 2020 6d65 6d62 6572 4964 202b 3d20      memberId += 
+0002dc50: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
+0002dc60: 2020 2020 2020 2020 2020 2020 2020 5f61                _a
+0002dc70: 746f 6d31 2c20 5f61 746f 6d32 203d 2061  tom1, _atom2 = a
+0002dc80: 746f 6d31 2c20 6174 6f6d 320a 2020 2020  tom1, atom2.    
+0002dc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dca0: 7366 5b27 696e 6465 785f 6964 275d 202b  sf['index_id'] +
+0002dcb0: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
+0002dcc0: 2020 2020 2020 2020 726f 7720 3d20 6765          row = ge
+0002dcd0: 7452 6f77 2873 656c 662e 5f5f 6375 725f  tRow(self.__cur_
+0002dce0: 7375 6274 7970 652c 2073 665b 2769 6427  subtype, sf['id'
+0002dcf0: 5d2c 2073 665b 2769 6e64 6578 5f69 6427  ], sf['index_id'
+0002dd00: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0002dd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dd20: 2020 2020 272e 272c 206d 656d 6265 7249      '.', memberI
+0002dd30: 642c 206d 656d 6265 724c 6f67 6963 436f  d, memberLogicCo
+0002dd40: 6465 2c0a 2020 2020 2020 2020 2020 2020  de,.            
+0002dd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dd60: 2020 2020 2073 665b 276c 6973 745f 6964       sf['list_id
+0002dd70: 275d 2c20 7365 6c66 2e5f 5f65 6e74 7279  '], self.__entry
+0002dd80: 4964 2c20 6765 7444 7374 4675 6e63 466f  Id, getDstFuncFo
+0002dd90: 7253 7342 6f6e 6428 6174 6f6d 312c 2061  rSsBond(atom1, a
+0002dda0: 746f 6d32 292c 0a20 2020 2020 2020 2020  tom2),.         
 0002ddb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ddc0: 2020 2020 2020 2020 6622 6174 6f6d 313d          f"atom1=
-0002ddd0: 7b61 746f 6d31 7d20 6174 6f6d 323d 7b61  {atom1} atom2={a
-0002dde0: 746f 6d32 7d22 290a 2020 2020 2020 2020  tom2}").        
-0002ddf0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0002de00: 5f5f 6372 6561 7465 5366 4469 6374 2061  __createSfDict a
-0002de10: 6e64 2073 6620 6973 206e 6f74 204e 6f6e  nd sf is not Non
-0002de20: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0002de30: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0002de40: 616e 6365 286d 656d 6265 7249 642c 2069  ance(memberId, i
-0002de50: 6e74 293a 0a20 2020 2020 2020 2020 2020  nt):.           
-0002de60: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0002de70: 5f61 746f 6d31 2069 7320 4e6f 6e65 206f  _atom1 is None o
-0002de80: 7220 6973 416d 6269 6741 746f 6d53 656c  r isAmbigAtomSel
-0002de90: 6563 7469 6f6e 285b 5f61 746f 6d31 2c20  ection([_atom1, 
-0002dea0: 6174 6f6d 315d 2c20 7365 6c66 2e5f 5f63  atom1], self.__c
-0002deb0: 7353 7461 7429 5c0a 2020 2020 2020 2020  sStat)\.        
-0002dec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ded0: 2020 206f 7220 6973 416d 6269 6741 746f     or isAmbigAto
-0002dee0: 6d53 656c 6563 7469 6f6e 285b 5f61 746f  mSelection([_ato
-0002def0: 6d32 2c20 6174 6f6d 325d 2c20 7365 6c66  m2, atom2], self
-0002df00: 2e5f 5f63 7353 7461 7429 3a0a 2020 2020  .__csStat):.    
-0002df10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002df20: 2020 2020 2020 2020 6d65 6d62 6572 4964          memberId
-0002df30: 202b 3d20 310a 2020 2020 2020 2020 2020   += 1.          
-0002df40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002df50: 2020 5f61 746f 6d31 2c20 5f61 746f 6d32    _atom1, _atom2
-0002df60: 203d 2061 746f 6d31 2c20 6174 6f6d 320a   = atom1, atom2.
-0002df70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002df80: 2020 2020 7366 5b27 696e 6465 785f 6964      sf['index_id
-0002df90: 275d 202b 3d20 310a 2020 2020 2020 2020  '] += 1.        
-0002dfa0: 2020 2020 2020 2020 2020 2020 726f 7720              row 
-0002dfb0: 3d20 6765 7452 6f77 2873 656c 662e 5f5f  = getRow(self.__
-0002dfc0: 6375 725f 7375 6274 7970 652c 2073 665b  cur_subtype, sf[
-0002dfd0: 2769 6427 5d2c 2073 665b 2769 6e64 6578  'id'], sf['index
-0002dfe0: 5f69 6427 5d2c 0a20 2020 2020 2020 2020  _id'],.         
-0002dff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e000: 2020 2020 2020 2020 272e 272c 206d 656d          '.', mem
-0002e010: 6265 7249 642c 206d 656d 6265 724c 6f67  berId, memberLog
-0002e020: 6963 436f 6465 2c0a 2020 2020 2020 2020  icCode,.        
-0002e030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e040: 2020 2020 2020 2020 2073 665b 276c 6973           sf['lis
-0002e050: 745f 6964 275d 2c20 7365 6c66 2e5f 5f65  t_id'], self.__e
-0002e060: 6e74 7279 4964 2c20 6765 7444 7374 4675  ntryId, getDstFu
-0002e070: 6e63 466f 7253 7342 6f6e 6428 6174 6f6d  ncForSsBond(atom
-0002e080: 312c 2061 746f 6d32 292c 0a20 2020 2020  1, atom2),.     
-0002e090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e0a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0002e0b0: 2e5f 5f61 7574 6854 6f53 7461 7253 6571  .__authToStarSeq
-0002e0c0: 2c20 7365 6c66 2e5f 5f61 7574 6854 6f49  , self.__authToI
-0002e0d0: 6e73 436f 6465 2c20 7365 6c66 2e5f 5f6f  nsCode, self.__o
-0002e0e0: 6666 7365 7448 6f6c 6465 722c 0a20 2020  ffsetHolder,.   
-0002e0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e100: 2020 2020 2020 2020 2020 2020 2020 6174                at
-0002e110: 6f6d 312c 2061 746f 6d32 290a 2020 2020  om1, atom2).    
-0002e120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e130: 7366 5b27 6c6f 6f70 275d 2e61 6464 5f64  sf['loop'].add_d
-0002e140: 6174 6128 726f 7729 0a0a 2020 2020 2020  ata(row)..      
-0002e150: 2020 6669 6e61 6c6c 793a 0a20 2020 2020    finally:.     
-0002e160: 2020 2020 2020 2073 656c 662e 6174 6f6d         self.atom
-0002e170: 5365 6c65 6374 696f 6e53 6574 2e63 6c65  SelectionSet.cle
-0002e180: 6172 2829 0a0a 2020 2020 2320 456e 7465  ar()..    # Ente
-0002e190: 7220 6120 7061 7273 6520 7472 6565 2070  r a parse tree p
-0002e1a0: 726f 6475 6365 6420 6279 2052 6f73 6574  roduced by Roset
-0002e1b0: 7461 4d52 5061 7273 6572 236e 756d 6265  taMRParser#numbe
-0002e1c0: 722e 0a20 2020 2064 6566 2065 6e74 6572  r..    def enter
-0002e1d0: 4e75 6d62 6572 2873 656c 662c 2063 7478  Number(self, ctx
-0002e1e0: 3a20 526f 7365 7474 614d 5250 6172 7365  : RosettaMRParse
-0002e1f0: 722e 4e75 6d62 6572 436f 6e74 6578 7429  r.NumberContext)
-0002e200: 3a20 2023 2070 796c 696e 743a 2064 6973  :  # pylint: dis
-0002e210: 6162 6c65 3d75 6e75 7365 642d 6172 6775  able=unused-argu
-0002e220: 6d65 6e74 0a20 2020 2020 2020 2070 6173  ment.        pas
-0002e230: 730a 0a20 2020 2023 2045 7869 7420 6120  s..    # Exit a 
-0002e240: 7061 7273 6520 7472 6565 2070 726f 6475  parse tree produ
-0002e250: 6365 6420 6279 2052 6f73 6574 7461 4d52  ced by RosettaMR
-0002e260: 5061 7273 6572 236e 756d 6265 722e 0a20  Parser#number.. 
-0002e270: 2020 2064 6566 2065 7869 744e 756d 6265     def exitNumbe
-0002e280: 7228 7365 6c66 2c20 6374 783a 2052 6f73  r(self, ctx: Ros
-0002e290: 6574 7461 4d52 5061 7273 6572 2e4e 756d  ettaMRParser.Num
-0002e2a0: 6265 7243 6f6e 7465 7874 293a 0a20 2020  berContext):.   
-0002e2b0: 2020 2020 2069 6620 6374 782e 466c 6f61       if ctx.Floa
-0002e2c0: 7428 293a 0a20 2020 2020 2020 2020 2020  t():.           
-0002e2d0: 2073 656c 662e 6e75 6d62 6572 5365 6c65   self.numberSele
-0002e2e0: 6374 696f 6e2e 6170 7065 6e64 2866 6c6f  ction.append(flo
-0002e2f0: 6174 2873 7472 2863 7478 2e46 6c6f 6174  at(str(ctx.Float
-0002e300: 2829 2929 290a 0a20 2020 2020 2020 2065  ())))..        e
-0002e310: 6c69 6620 6374 782e 496e 7465 6765 7228  lif ctx.Integer(
-0002e320: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
-0002e330: 656c 662e 6e75 6d62 6572 5365 6c65 6374  elf.numberSelect
-0002e340: 696f 6e2e 6170 7065 6e64 2866 6c6f 6174  ion.append(float
-0002e350: 2873 7472 2863 7478 2e49 6e74 6567 6572  (str(ctx.Integer
-0002e360: 2829 2929 290a 0a20 2020 2020 2020 2065  ())))..        e
-0002e370: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0002e380: 2073 656c 662e 6e75 6d62 6572 5365 6c65   self.numberSele
-0002e390: 6374 696f 6e2e 6170 7065 6e64 284e 6f6e  ction.append(Non
-0002e3a0: 6529 0a0a 2020 2020 2320 456e 7465 7220  e)..    # Enter 
-0002e3b0: 6120 7061 7273 6520 7472 6565 2070 726f  a parse tree pro
-0002e3c0: 6475 6365 6420 6279 2052 6f73 6574 7461  duced by Rosetta
-0002e3d0: 4d52 5061 7273 6572 236e 756d 6265 725f  MRParser#number_
-0002e3e0: 662e 0a20 2020 2064 6566 2065 6e74 6572  f..    def enter
-0002e3f0: 4e75 6d62 6572 5f66 2873 656c 662c 2063  Number_f(self, c
-0002e400: 7478 3a20 526f 7365 7474 614d 5250 6172  tx: RosettaMRPar
-0002e410: 7365 722e 4e75 6d62 6572 5f66 436f 6e74  ser.Number_fCont
-0002e420: 6578 7429 3a20 2023 2070 796c 696e 743a  ext):  # pylint:
-0002e430: 2064 6973 6162 6c65 3d75 6e75 7365 642d   disable=unused-
-0002e440: 6172 6775 6d65 6e74 0a20 2020 2020 2020  argument.       
-0002e450: 2070 6173 730a 0a20 2020 2023 2045 7869   pass..    # Exi
-0002e460: 7420 6120 7061 7273 6520 7472 6565 2070  t a parse tree p
-0002e470: 726f 6475 6365 6420 6279 2052 6f73 6574  roduced by Roset
-0002e480: 7461 4d52 5061 7273 6572 236e 756d 6265  taMRParser#numbe
-0002e490: 725f 662e 0a20 2020 2064 6566 2065 7869  r_f..    def exi
-0002e4a0: 744e 756d 6265 725f 6628 7365 6c66 2c20  tNumber_f(self, 
-0002e4b0: 6374 783a 2052 6f73 6574 7461 4d52 5061  ctx: RosettaMRPa
-0002e4c0: 7273 6572 2e4e 756d 6265 725f 6643 6f6e  rser.Number_fCon
-0002e4d0: 7465 7874 293a 0a20 2020 2020 2020 2069  text):.        i
-0002e4e0: 6620 6374 782e 466c 6f61 7428 293a 0a20  f ctx.Float():. 
-0002e4f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0002e500: 6e75 6d62 6572 4653 656c 6563 7469 6f6e  numberFSelection
-0002e510: 2e61 7070 656e 6428 666c 6f61 7428 7374  .append(float(st
-0002e520: 7228 6374 782e 466c 6f61 7428 2929 2929  r(ctx.Float())))
-0002e530: 0a0a 2020 2020 2020 2020 656c 6966 2063  ..        elif c
-0002e540: 7478 2e49 6e74 6567 6572 2829 3a0a 2020  tx.Integer():.  
-0002e550: 2020 2020 2020 2020 2020 7365 6c66 2e6e            self.n
-0002e560: 756d 6265 7246 5365 6c65 6374 696f 6e2e  umberFSelection.
-0002e570: 6170 7065 6e64 2866 6c6f 6174 2873 7472  append(float(str
-0002e580: 2863 7478 2e49 6e74 6567 6572 2829 2929  (ctx.Integer()))
-0002e590: 290a 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
-0002e5a0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0002e5b0: 662e 6e75 6d62 6572 4653 656c 6563 7469  f.numberFSelecti
-0002e5c0: 6f6e 2e61 7070 656e 6428 4e6f 6e65 290a  on.append(None).
-0002e5d0: 0a20 2020 2064 6566 205f 5f67 6574 4375  .    def __getCu
-0002e5e0: 7272 656e 7452 6573 7472 6169 6e74 2873  rrentRestraint(s
-0002e5f0: 656c 6629 3a0a 2020 2020 2020 2020 6966  elf):.        if
-0002e600: 2073 656c 662e 5f5f 6375 725f 7375 6274   self.__cur_subt
-0002e610: 7970 6520 3d3d 2027 6469 7374 273a 0a20  ype == 'dist':. 
-0002e620: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0002e630: 6e20 6622 5b43 6865 636b 2074 6865 207b  n f"[Check the {
-0002e640: 7365 6c66 2e64 6973 7452 6573 7472 6169  self.distRestrai
-0002e650: 6e74 737d 7468 2072 6f77 206f 6620 6469  nts}th row of di
-0002e660: 7374 616e 6365 2072 6573 7472 6169 6e74  stance restraint
-0002e670: 735d 2022 0a20 2020 2020 2020 2069 6620  s] ".        if 
-0002e680: 7365 6c66 2e5f 5f63 7572 5f73 7562 7479  self.__cur_subty
-0002e690: 7065 203d 3d20 2761 6e67 273a 0a20 2020  pe == 'ang':.   
-0002e6a0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0002e6b0: 6622 5b43 6865 636b 2074 6865 207b 7365  f"[Check the {se
-0002e6c0: 6c66 2e61 6e67 5265 7374 7261 696e 7473  lf.angRestraints
-0002e6d0: 7d74 6820 726f 7720 6f66 2061 6e67 6c65  }th row of angle
-0002e6e0: 2072 6573 7472 6169 6e74 735d 2022 0a20   restraints] ". 
-0002e6f0: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
-0002e700: 5f63 7572 5f73 7562 7479 7065 203d 3d20  _cur_subtype == 
-0002e710: 2764 6968 6564 273a 0a20 2020 2020 2020  'dihed':.       
-0002e720: 2020 2020 2072 6574 7572 6e20 6622 5b43       return f"[C
-0002e730: 6865 636b 2074 6865 207b 7365 6c66 2e64  heck the {self.d
-0002e740: 6968 6564 5265 7374 7261 696e 7473 7d74  ihedRestraints}t
-0002e750: 6820 726f 7720 6f66 2064 6968 6564 7261  h row of dihedra
-0002e760: 6c20 616e 676c 6520 7265 7374 7261 696e  l angle restrain
-0002e770: 7473 5d20 220a 2020 2020 2020 2020 6966  ts] ".        if
-0002e780: 2073 656c 662e 5f5f 6375 725f 7375 6274   self.__cur_subt
-0002e790: 7970 6520 3d3d 2027 7264 6327 3a0a 2020  ype == 'rdc':.  
-0002e7a0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0002e7b0: 2066 225b 4368 6563 6b20 7468 6520 7b73   f"[Check the {s
-0002e7c0: 656c 662e 7264 6352 6573 7472 6169 6e74  elf.rdcRestraint
-0002e7d0: 737d 7468 2072 6f77 206f 6620 7265 7369  s}th row of resi
-0002e7e0: 6475 616c 2064 6970 6f6c 6172 2063 6f75  dual dipolar cou
-0002e7f0: 706c 696e 6720 7265 7374 7261 696e 7473  pling restraints
-0002e800: 5d20 220a 2020 2020 2020 2020 6966 2073  ] ".        if s
-0002e810: 656c 662e 5f5f 6375 725f 7375 6274 7970  elf.__cur_subtyp
-0002e820: 6520 3d3d 2027 6765 6f27 3a0a 2020 2020  e == 'geo':.    
-0002e830: 2020 2020 2020 2020 7265 7475 726e 2066          return f
-0002e840: 225b 4368 6563 6b20 7468 6520 7b73 656c  "[Check the {sel
-0002e850: 662e 6765 6f52 6573 7472 6169 6e74 737d  f.geoRestraints}
-0002e860: 7468 2072 6f77 206f 6620 636f 6f72 6469  th row of coordi
-0002e870: 6e61 7465 2067 656f 6d65 7472 7920 7265  nate geometry re
-0002e880: 7374 7261 696e 7473 5d20 220a 2020 2020  straints] ".    
-0002e890: 2020 2020 6966 2073 656c 662e 5f5f 6375      if self.__cu
-0002e8a0: 725f 7375 6274 7970 6520 3d3d 2027 7373  r_subtype == 'ss
-0002e8b0: 626f 6e64 273a 0a20 2020 2020 2020 2020  bond':.         
-0002e8c0: 2020 2072 6574 7572 6e20 6622 5b43 6865     return f"[Che
-0002e8d0: 636b 2074 6865 207b 7365 6c66 2e73 7362  ck the {self.ssb
-0002e8e0: 6f6e 6452 6573 7472 6169 6e74 737d 7468  ondRestraints}th
-0002e8f0: 2072 6f77 206f 6620 6469 7375 6c66 6964   row of disulfid
-0002e900: 6520 626f 6e64 2072 6573 7472 6169 6e74  e bond restraint
-0002e910: 735d 2022 0a20 2020 2020 2020 2072 6574  s] ".        ret
-0002e920: 7572 6e20 2727 0a0a 2020 2020 6465 6620  urn ''..    def 
-0002e930: 5f5f 7365 744c 6f63 616c 5365 7153 6368  __setLocalSeqSch
-0002e940: 656d 6528 7365 6c66 293a 0a20 2020 2020  eme(self):.     
-0002e950: 2020 2069 6620 276c 6f63 616c 5f73 6571     if 'local_seq
-0002e960: 5f73 6368 656d 6527 206e 6f74 2069 6e20  _scheme' not in 
-0002e970: 7365 6c66 2e72 6561 736f 6e73 466f 7252  self.reasonsForR
-0002e980: 6550 6172 7369 6e67 3a0a 2020 2020 2020  eParsing:.      
-0002e990: 2020 2020 2020 7365 6c66 2e72 6561 736f        self.reaso
-0002e9a0: 6e73 466f 7252 6550 6172 7369 6e67 5b27  nsForReParsing['
-0002e9b0: 6c6f 6361 6c5f 7365 715f 7363 6865 6d65  local_seq_scheme
-0002e9c0: 275d 203d 207b 7d0a 2020 2020 2020 2020  '] = {}.        
-0002e9d0: 6966 2073 656c 662e 5f5f 6375 725f 7375  if self.__cur_su
-0002e9e0: 6274 7970 6520 3d3d 2027 6469 7374 273a  btype == 'dist':
-0002e9f0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0002ea00: 662e 7265 6173 6f6e 7346 6f72 5265 5061  f.reasonsForRePa
-0002ea10: 7273 696e 675b 276c 6f63 616c 5f73 6571  rsing['local_seq
-0002ea20: 5f73 6368 656d 6527 5d5b 2873 656c 662e  _scheme'][(self.
-0002ea30: 5f5f 6375 725f 7375 6274 7970 652c 2073  __cur_subtype, s
-0002ea40: 656c 662e 6469 7374 5265 7374 7261 696e  elf.distRestrain
-0002ea50: 7473 295d 203d 2073 656c 662e 5f5f 7072  ts)] = self.__pr
-0002ea60: 6566 6572 4175 7468 5365 710a 2020 2020  eferAuthSeq.    
-0002ea70: 2020 2020 656c 6966 2073 656c 662e 5f5f      elif self.__
-0002ea80: 6375 725f 7375 6274 7970 6520 3d3d 2027  cur_subtype == '
-0002ea90: 616e 6727 3a0a 2020 2020 2020 2020 2020  ang':.          
-0002eaa0: 2020 7365 6c66 2e72 6561 736f 6e73 466f    self.reasonsFo
-0002eab0: 7252 6550 6172 7369 6e67 5b27 6c6f 6361  rReParsing['loca
-0002eac0: 6c5f 7365 715f 7363 6865 6d65 275d 5b28  l_seq_scheme'][(
-0002ead0: 7365 6c66 2e5f 5f63 7572 5f73 7562 7479  self.__cur_subty
-0002eae0: 7065 2c20 7365 6c66 2e61 6e67 5265 7374  pe, self.angRest
-0002eaf0: 7261 696e 7473 295d 203d 2073 656c 662e  raints)] = self.
-0002eb00: 5f5f 7072 6566 6572 4175 7468 5365 710a  __preferAuthSeq.
-0002eb10: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
-0002eb20: 662e 5f5f 6375 725f 7375 6274 7970 6520  f.__cur_subtype 
-0002eb30: 3d3d 2027 6469 6865 6427 3a0a 2020 2020  == 'dihed':.    
-0002eb40: 2020 2020 2020 2020 7365 6c66 2e72 6561          self.rea
-0002eb50: 736f 6e73 466f 7252 6550 6172 7369 6e67  sonsForReParsing
-0002eb60: 5b27 6c6f 6361 6c5f 7365 715f 7363 6865  ['local_seq_sche
-0002eb70: 6d65 275d 5b28 7365 6c66 2e5f 5f63 7572  me'][(self.__cur
-0002eb80: 5f73 7562 7479 7065 2c20 7365 6c66 2e64  _subtype, self.d
-0002eb90: 6968 6564 5265 7374 7261 696e 7473 295d  ihedRestraints)]
-0002eba0: 203d 2073 656c 662e 5f5f 7072 6566 6572   = self.__prefer
-0002ebb0: 4175 7468 5365 710a 2020 2020 2020 2020  AuthSeq.        
-0002ebc0: 656c 6966 2073 656c 662e 5f5f 6375 725f  elif self.__cur_
-0002ebd0: 7375 6274 7970 6520 3d3d 2027 7264 6327  subtype == 'rdc'
-0002ebe0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-0002ebf0: 6c66 2e72 6561 736f 6e73 466f 7252 6550  lf.reasonsForReP
-0002ec00: 6172 7369 6e67 5b27 6c6f 6361 6c5f 7365  arsing['local_se
-0002ec10: 715f 7363 6865 6d65 275d 5b28 7365 6c66  q_scheme'][(self
-0002ec20: 2e5f 5f63 7572 5f73 7562 7479 7065 2c20  .__cur_subtype, 
-0002ec30: 7365 6c66 2e72 6463 5265 7374 7261 696e  self.rdcRestrain
-0002ec40: 7473 295d 203d 2073 656c 662e 5f5f 7072  ts)] = self.__pr
-0002ec50: 6566 6572 4175 7468 5365 710a 2020 2020  eferAuthSeq.    
-0002ec60: 2020 2020 656c 6966 2073 656c 662e 5f5f      elif self.__
-0002ec70: 6375 725f 7375 6274 7970 6520 3d3d 2027  cur_subtype == '
-0002ec80: 6765 6f27 3a0a 2020 2020 2020 2020 2020  geo':.          
-0002ec90: 2020 7365 6c66 2e72 6561 736f 6e73 466f    self.reasonsFo
-0002eca0: 7252 6550 6172 7369 6e67 5b27 6c6f 6361  rReParsing['loca
-0002ecb0: 6c5f 7365 715f 7363 6865 6d65 275d 5b28  l_seq_scheme'][(
-0002ecc0: 7365 6c66 2e5f 5f63 7572 5f73 7562 7479  self.__cur_subty
-0002ecd0: 7065 2c20 7365 6c66 2e67 656f 5265 7374  pe, self.geoRest
-0002ece0: 7261 696e 7473 295d 203d 2073 656c 662e  raints)] = self.
-0002ecf0: 5f5f 7072 6566 6572 4175 7468 5365 710a  __preferAuthSeq.
-0002ed00: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
-0002ed10: 662e 5f5f 6375 725f 7375 6274 7970 6520  f.__cur_subtype 
-0002ed20: 3d3d 2027 7373 626f 6e64 273a 0a20 2020  == 'ssbond':.   
-0002ed30: 2020 2020 2020 2020 2073 656c 662e 7265           self.re
-0002ed40: 6173 6f6e 7346 6f72 5265 5061 7273 696e  asonsForReParsin
-0002ed50: 675b 276c 6f63 616c 5f73 6571 5f73 6368  g['local_seq_sch
-0002ed60: 656d 6527 5d5b 2873 656c 662e 5f5f 6375  eme'][(self.__cu
-0002ed70: 725f 7375 6274 7970 652c 2073 656c 662e  r_subtype, self.
-0002ed80: 7373 626f 6e64 5265 7374 7261 696e 7473  ssbondRestraints
-0002ed90: 295d 203d 2073 656c 662e 5f5f 7072 6566  )] = self.__pref
-0002eda0: 6572 4175 7468 5365 710a 2020 2020 2020  erAuthSeq.      
-0002edb0: 2020 6966 206e 6f74 2073 656c 662e 5f5f    if not self.__
-0002edc0: 7072 6566 6572 4175 7468 5365 713a 0a20  preferAuthSeq:. 
-0002edd0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0002ede0: 5f5f 7072 6566 6572 4c61 6265 6c53 6571  __preferLabelSeq
-0002edf0: 436f 756e 7420 2b3d 2031 0a20 2020 2020  Count += 1.     
-0002ee00: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
-0002ee10: 5f70 7265 6665 724c 6162 656c 5365 7143  _preferLabelSeqC
-0002ee20: 6f75 6e74 203e 204d 4158 5f50 5245 465f  ount > MAX_PREF_
-0002ee30: 4c41 4245 4c5f 5343 4845 4d45 5f43 4f55  LABEL_SCHEME_COU
-0002ee40: 4e54 3a0a 2020 2020 2020 2020 2020 2020  NT:.            
-0002ee50: 2020 2020 7365 6c66 2e72 6561 736f 6e73      self.reasons
-0002ee60: 466f 7252 6550 6172 7369 6e67 5b27 6c61  ForReParsing['la
-0002ee70: 6265 6c5f 7365 715f 7363 6865 6d65 275d  bel_seq_scheme']
-0002ee80: 203d 2054 7275 650a 0a20 2020 2064 6566   = True..    def
-0002ee90: 205f 5f72 6574 7269 6576 654c 6f63 616c   __retrieveLocal
-0002eea0: 5365 7153 6368 656d 6528 7365 6c66 293a  SeqScheme(self):
-0002eeb0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-0002eec0: 2e5f 5f72 6561 736f 6e73 2069 7320 4e6f  .__reasons is No
-0002eed0: 6e65 206f 7220 276c 6f63 616c 5f73 6571  ne or 'local_seq
-0002eee0: 5f73 6368 656d 6527 206e 6f74 2069 6e20  _scheme' not in 
-0002eef0: 7365 6c66 2e5f 5f72 6561 736f 6e73 3a0a  self.__reasons:.
-0002ef00: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0002ef10: 726e 0a20 2020 2020 2020 2069 6620 276c  rn.        if 'l
-0002ef20: 6162 656c 5f73 6571 5f73 6368 656d 6527  abel_seq_scheme'
-0002ef30: 2069 6e20 7365 6c66 2e5f 5f72 6561 736f   in self.__reaso
-0002ef40: 6e73 2061 6e64 2073 656c 662e 5f5f 7265  ns and self.__re
-0002ef50: 6173 6f6e 735b 276c 6162 656c 5f73 6571  asons['label_seq
-0002ef60: 5f73 6368 656d 6527 5d3a 0a20 2020 2020  _scheme']:.     
-0002ef70: 2020 2020 2020 2073 656c 662e 5f5f 7072         self.__pr
-0002ef80: 6566 6572 4175 7468 5365 7120 3d20 4661  eferAuthSeq = Fa
-0002ef90: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
-0002efa0: 7365 6c66 2e5f 5f61 7574 6853 6571 4964  self.__authSeqId
-0002efb0: 203d 2027 6c61 6265 6c5f 7365 715f 6964   = 'label_seq_id
-0002efc0: 270a 2020 2020 2020 2020 2020 2020 7265  '.            re
-0002efd0: 7475 726e 0a20 2020 2020 2020 2069 6620  turn.        if 
-0002efe0: 7365 6c66 2e5f 5f63 7572 5f73 7562 7479  self.__cur_subty
-0002eff0: 7065 203d 3d20 2764 6973 7427 3a0a 2020  pe == 'dist':.  
-0002f000: 2020 2020 2020 2020 2020 6b65 7920 3d20            key = 
-0002f010: 2873 656c 662e 5f5f 6375 725f 7375 6274  (self.__cur_subt
-0002f020: 7970 652c 2073 656c 662e 6469 7374 5265  ype, self.distRe
-0002f030: 7374 7261 696e 7473 290a 2020 2020 2020  straints).      
-0002f040: 2020 656c 6966 2073 656c 662e 5f5f 6375    elif self.__cu
-0002f050: 725f 7375 6274 7970 6520 3d3d 2027 616e  r_subtype == 'an
-0002f060: 6727 3a0a 2020 2020 2020 2020 2020 2020  g':.            
-0002f070: 6b65 7920 3d20 2873 656c 662e 5f5f 6375  key = (self.__cu
-0002f080: 725f 7375 6274 7970 652c 2073 656c 662e  r_subtype, self.
-0002f090: 616e 6752 6573 7472 6169 6e74 7329 0a20  angRestraints). 
-0002f0a0: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
-0002f0b0: 2e5f 5f63 7572 5f73 7562 7479 7065 203d  .__cur_subtype =
-0002f0c0: 3d20 2764 6968 6564 273a 0a20 2020 2020  = 'dihed':.     
-0002f0d0: 2020 2020 2020 206b 6579 203d 2028 7365         key = (se
-0002f0e0: 6c66 2e5f 5f63 7572 5f73 7562 7479 7065  lf.__cur_subtype
-0002f0f0: 2c20 7365 6c66 2e64 6968 6564 5265 7374  , self.dihedRest
-0002f100: 7261 696e 7473 290a 2020 2020 2020 2020  raints).        
-0002f110: 656c 6966 2073 656c 662e 5f5f 6375 725f  elif self.__cur_
-0002f120: 7375 6274 7970 6520 3d3d 2027 7264 6327  subtype == 'rdc'
-0002f130: 3a0a 2020 2020 2020 2020 2020 2020 6b65  :.            ke
-0002f140: 7920 3d20 2873 656c 662e 5f5f 6375 725f  y = (self.__cur_
-0002f150: 7375 6274 7970 652c 2073 656c 662e 7264  subtype, self.rd
-0002f160: 6352 6573 7472 6169 6e74 7329 0a20 2020  cRestraints).   
-0002f170: 2020 2020 2065 6c69 6620 7365 6c66 2e5f       elif self._
-0002f180: 5f63 7572 5f73 7562 7479 7065 203d 3d20  _cur_subtype == 
-0002f190: 2767 656f 273a 0a20 2020 2020 2020 2020  'geo':.         
-0002f1a0: 2020 206b 6579 203d 2028 7365 6c66 2e5f     key = (self._
-0002f1b0: 5f63 7572 5f73 7562 7479 7065 2c20 7365  _cur_subtype, se
-0002f1c0: 6c66 2e67 656f 5265 7374 7261 696e 7473  lf.geoRestraints
-0002f1d0: 290a 2020 2020 2020 2020 656c 6966 2073  ).        elif s
-0002f1e0: 656c 662e 5f5f 6375 725f 7375 6274 7970  elf.__cur_subtyp
-0002f1f0: 6520 3d3d 2027 7373 626f 6e64 273a 0a20  e == 'ssbond':. 
-0002f200: 2020 2020 2020 2020 2020 206b 6579 203d             key =
-0002f210: 2028 7365 6c66 2e5f 5f63 7572 5f73 7562   (self.__cur_sub
-0002f220: 7479 7065 2c20 7365 6c66 2e73 7362 6f6e  type, self.ssbon
-0002f230: 6452 6573 7472 6169 6e74 7329 0a20 2020  dRestraints).   
-0002f240: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0002f250: 2020 2020 2020 2072 6574 7572 6e0a 0a20         return.. 
-0002f260: 2020 2020 2020 2069 6620 6b65 7920 696e         if key in
-0002f270: 2073 656c 662e 5f5f 7265 6173 6f6e 735b   self.__reasons[
-0002f280: 276c 6f63 616c 5f73 6571 5f73 6368 656d  'local_seq_schem
-0002f290: 6527 5d3a 0a20 2020 2020 2020 2020 2020  e']:.           
-0002f2a0: 2073 656c 662e 5f5f 7072 6566 6572 4175   self.__preferAu
-0002f2b0: 7468 5365 7120 3d20 7365 6c66 2e5f 5f72  thSeq = self.__r
-0002f2c0: 6561 736f 6e73 5b27 6c6f 6361 6c5f 7365  easons['local_se
-0002f2d0: 715f 7363 6865 6d65 275d 5b6b 6579 5d0a  q_scheme'][key].
-0002f2e0: 0a20 2020 2064 6566 205f 5f61 6464 5366  .    def __addSf
-0002f2f0: 2873 656c 662c 2063 6f6e 7374 7261 696e  (self, constrain
-0002f300: 7454 7970 653d 4e6f 6e65 2c20 706f 7465  tType=None, pote
-0002f310: 6e74 6961 6c54 7970 653d 4e6f 6e65 2c20  ntialType=None, 
-0002f320: 7264 6343 6f64 653d 4e6f 6e65 293a 0a20  rdcCode=None):. 
-0002f330: 2020 2020 2020 2063 6f6e 7465 6e74 5f73         content_s
-0002f340: 7562 7479 7065 203d 2063 6f6e 7465 6e74  ubtype = content
-0002f350: 5375 6274 7970 654f 6628 7365 6c66 2e5f  SubtypeOf(self._
-0002f360: 5f63 7572 5f73 7562 7479 7065 290a 0a20  _cur_subtype).. 
-0002f370: 2020 2020 2020 2069 6620 636f 6e74 656e         if conten
-0002f380: 745f 7375 6274 7970 6520 6973 204e 6f6e  t_subtype is Non
-0002f390: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0002f3a0: 6574 7572 6e0a 0a20 2020 2020 2020 2073  eturn..        s
-0002f3b0: 656c 662e 5f5f 6c69 7374 4964 436f 756e  elf.__listIdCoun
-0002f3c0: 7465 7220 3d20 696e 634c 6973 7449 6443  ter = incListIdC
-0002f3d0: 6f75 6e74 6572 2873 656c 662e 5f5f 6375  ounter(self.__cu
-0002f3e0: 725f 7375 6274 7970 652c 2073 656c 662e  r_subtype, self.
-0002f3f0: 5f5f 6c69 7374 4964 436f 756e 7465 7229  __listIdCounter)
-0002f400: 0a0a 2020 2020 2020 2020 6b65 7920 3d20  ..        key = 
-0002f410: 2873 656c 662e 5f5f 6375 725f 7375 6274  (self.__cur_subt
-0002f420: 7970 652c 2063 6f6e 7374 7261 696e 7454  ype, constraintT
-0002f430: 7970 652c 2070 6f74 656e 7469 616c 5479  ype, potentialTy
-0002f440: 7065 2c20 7264 6343 6f64 652c 204e 6f6e  pe, rdcCode, Non
-0002f450: 6529 0a0a 2020 2020 2020 2020 6966 206b  e)..        if k
-0002f460: 6579 206e 6f74 2069 6e20 7365 6c66 2e73  ey not in self.s
-0002f470: 6644 6963 743a 0a20 2020 2020 2020 2020  fDict:.         
-0002f480: 2020 2073 656c 662e 7366 4469 6374 5b6b     self.sfDict[k
-0002f490: 6579 5d20 3d20 5b5d 0a0a 2020 2020 2020  ey] = []..      
-0002f4a0: 2020 6c69 7374 5f69 6420 3d20 7365 6c66    list_id = self
-0002f4b0: 2e5f 5f6c 6973 7449 6443 6f75 6e74 6572  .__listIdCounter
-0002f4c0: 5b63 6f6e 7465 6e74 5f73 7562 7479 7065  [content_subtype
-0002f4d0: 5d0a 0a20 2020 2020 2020 2072 6573 7472  ]..        restr
-0002f4e0: 6169 6e74 5f6e 616d 6520 3d20 6765 7452  aint_name = getR
-0002f4f0: 6573 7472 6169 6e74 4e61 6d65 2873 656c  estraintName(sel
-0002f500: 662e 5f5f 6375 725f 7375 6274 7970 6529  f.__cur_subtype)
-0002f510: 0a0a 2020 2020 2020 2020 7366 5f66 7261  ..        sf_fra
-0002f520: 6d65 636f 6465 203d 2027 524f 5345 5454  mecode = 'ROSETT
-0002f530: 415f 2720 2b20 7265 7374 7261 696e 745f  A_' + restraint_
-0002f540: 6e61 6d65 2e72 6570 6c61 6365 2827 2027  name.replace(' '
-0002f550: 2c20 275f 2729 202b 2066 275f 7b6c 6973  , '_') + f'_{lis
-0002f560: 745f 6964 7d27 0a0a 2020 2020 2020 2020  t_id}'..        
-0002f570: 7366 203d 2067 6574 5361 7665 6672 616d  sf = getSavefram
-0002f580: 6528 7365 6c66 2e5f 5f63 7572 5f73 7562  e(self.__cur_sub
-0002f590: 7479 7065 2c20 7366 5f66 7261 6d65 636f  type, sf_frameco
-0002f5a0: 6465 2c20 6c69 7374 5f69 642c 2073 656c  de, list_id, sel
-0002f5b0: 662e 5f5f 656e 7472 7949 642c 2073 656c  f.__entryId, sel
-0002f5c0: 662e 5f5f 6f72 6967 696e 616c 4669 6c65  f.__originalFile
-0002f5d0: 4e61 6d65 2c0a 2020 2020 2020 2020 2020  Name,.          
-0002f5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f5f0: 636f 6e73 7472 6169 6e74 5479 7065 3d63  constraintType=c
-0002f600: 6f6e 7374 7261 696e 7454 7970 652c 2070  onstraintType, p
-0002f610: 6f74 656e 7469 616c 5479 7065 3d70 6f74  otentialType=pot
-0002f620: 656e 7469 616c 5479 7065 2c20 7264 6343  entialType, rdcC
-0002f630: 6f64 653d 7264 6343 6f64 6529 0a0a 2020  ode=rdcCode)..  
-0002f640: 2020 2020 2020 6e6f 745f 7661 6c69 6420        not_valid 
-0002f650: 3d20 5472 7565 0a0a 2020 2020 2020 2020  = True..        
-0002f660: 6c70 203d 2067 6574 4c6f 6f70 2873 656c  lp = getLoop(sel
-0002f670: 662e 5f5f 6375 725f 7375 6274 7970 652c  f.__cur_subtype,
-0002f680: 2068 6173 496e 7343 6f64 653d 2873 656c   hasInsCode=(sel
-0002f690: 662e 5f5f 6175 7468 546f 496e 7343 6f64  f.__authToInsCod
-0002f6a0: 6520 6973 206e 6f74 204e 6f6e 6529 290a  e is not None)).
-0002f6b0: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
-0002f6c0: 7369 6e73 7461 6e63 6528 6c70 2c20 6469  sinstance(lp, di
-0002f6d0: 6374 293a 0a20 2020 2020 2020 2020 2020  ct):.           
-0002f6e0: 2073 662e 6164 645f 6c6f 6f70 286c 7029   sf.add_loop(lp)
-0002f6f0: 0a20 2020 2020 2020 2020 2020 206e 6f74  .            not
-0002f700: 5f76 616c 6964 203d 2046 616c 7365 0a0a  _valid = False..
-0002f710: 2020 2020 2020 2020 5f72 6573 7472 6169          _restrai
-0002f720: 6e74 5f6e 616d 6520 3d20 7265 7374 7261  nt_name = restra
-0002f730: 696e 745f 6e61 6d65 2e73 706c 6974 2829  int_name.split()
-0002f740: 0a0a 2020 2020 2020 2020 6974 656d 203d  ..        item =
-0002f750: 207b 2766 696c 655f 7479 7065 273a 2073   {'file_type': s
-0002f760: 656c 662e 5f5f 6669 6c65 5f74 7970 652c  elf.__file_type,
-0002f770: 2027 7361 7665 6672 616d 6527 3a20 7366   'saveframe': sf
-0002f780: 2c20 276c 6f6f 7027 3a20 6c70 2c20 276c  , 'loop': lp, 'l
-0002f790: 6973 745f 6964 273a 206c 6973 745f 6964  ist_id': list_id
-0002f7a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002f7b0: 2020 2769 6427 3a20 302c 2027 696e 6465    'id': 0, 'inde
-0002f7c0: 785f 6964 273a 2030 2c0a 2020 2020 2020  x_id': 0,.      
-0002f7d0: 2020 2020 2020 2020 2020 2763 6f6e 7374            'const
-0002f7e0: 7261 696e 745f 7479 7065 273a 2027 2027  raint_type': ' '
-0002f7f0: 2e6a 6f69 6e28 5f72 6573 7472 6169 6e74  .join(_restraint
-0002f800: 5f6e 616d 655b 3a2d 315d 297d 0a0a 2020  _name[:-1])}..  
-0002f810: 2020 2020 2020 6966 206e 6f74 5f76 616c        if not_val
-0002f820: 6964 3a0a 2020 2020 2020 2020 2020 2020  id:.            
-0002f830: 6974 656d 5b27 7461 6773 275d 203d 205b  item['tags'] = [
-0002f840: 5d0a 0a20 2020 2020 2020 2069 6620 7365  ]..        if se
-0002f850: 6c66 2e5f 5f63 7572 5f73 7562 7479 7065  lf.__cur_subtype
-0002f860: 203d 3d20 2764 6973 7427 3a0a 2020 2020   == 'dist':.    
-0002f870: 2020 2020 2020 2020 6974 656d 5b27 636f          item['co
-0002f880: 6e73 7472 6169 6e74 5f73 7562 7375 6274  nstraint_subsubt
-0002f890: 7970 6527 5d20 3d20 2773 696d 706c 6527  ype'] = 'simple'
-0002f8a0: 0a0a 2020 2020 2020 2020 7365 6c66 2e73  ..        self.s
-0002f8b0: 6644 6963 745b 6b65 795d 2e61 7070 656e  fDict[key].appen
-0002f8c0: 6428 6974 656d 290a 0a20 2020 2064 6566  d(item)..    def
-0002f8d0: 205f 5f67 6574 5366 2873 656c 662c 2063   __getSf(self, c
-0002f8e0: 6f6e 7374 7261 696e 7454 7970 653d 4e6f  onstraintType=No
-0002f8f0: 6e65 2c20 706f 7465 6e74 6961 6c54 7970  ne, potentialTyp
-0002f900: 653d 4e6f 6e65 2c20 7264 6343 6f64 653d  e=None, rdcCode=
-0002f910: 4e6f 6e65 293a 0a20 2020 2020 2020 206b  None):.        k
-0002f920: 6579 203d 2028 7365 6c66 2e5f 5f63 7572  ey = (self.__cur
-0002f930: 5f73 7562 7479 7065 2c20 636f 6e73 7472  _subtype, constr
-0002f940: 6169 6e74 5479 7065 2c20 706f 7465 6e74  aintType, potent
-0002f950: 6961 6c54 7970 652c 2072 6463 436f 6465  ialType, rdcCode
-0002f960: 2c20 4e6f 6e65 290a 0a20 2020 2020 2020  , None)..       
-0002f970: 2069 6620 6b65 7920 6e6f 7420 696e 2073   if key not in s
-0002f980: 656c 662e 7366 4469 6374 3a0a 2020 2020  elf.sfDict:.    
-0002f990: 2020 2020 2020 2020 7265 706c 6163 6564          replaced
-0002f9a0: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
-0002f9b0: 2020 2020 2069 6620 706f 7465 6e74 6961       if potentia
-0002f9c0: 6c54 7970 6520 6973 206e 6f74 204e 6f6e  lType is not Non
-0002f9d0: 6520 6f72 2072 6463 436f 6465 2069 7320  e or rdcCode is 
-0002f9e0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-0002f9f0: 2020 2020 2020 2020 2020 6f6c 645f 6b65            old_ke
-0002fa00: 7920 3d20 2873 656c 662e 5f5f 6375 725f  y = (self.__cur_
-0002fa10: 7375 6274 7970 652c 2063 6f6e 7374 7261  subtype, constra
-0002fa20: 696e 7454 7970 652c 204e 6f6e 652c 204e  intType, None, N
-0002fa30: 6f6e 652c 204e 6f6e 6529 0a20 2020 2020  one, None).     
-0002fa40: 2020 2020 2020 2020 2020 2069 6620 6f6c             if ol
-0002fa50: 645f 6b65 7920 696e 2073 656c 662e 7366  d_key in self.sf
-0002fa60: 4469 6374 3a0a 2020 2020 2020 2020 2020  Dict:.          
-0002fa70: 2020 2020 2020 2020 2020 7265 706c 6163            replac
-0002fa80: 6564 203d 2054 7275 650a 2020 2020 2020  ed = True.      
-0002fa90: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0002faa0: 6c66 2e73 6644 6963 745b 6b65 795d 203d  lf.sfDict[key] =
-0002fab0: 205b 7365 6c66 2e73 6644 6963 745b 6f6c   [self.sfDict[ol
-0002fac0: 645f 6b65 795d 2e70 6f70 282d 3129 5d0a  d_key].pop(-1)].
-0002fad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fae0: 2020 2020 6966 206c 656e 2873 656c 662e      if len(self.
-0002faf0: 7366 4469 6374 5b6f 6c64 5f6b 6579 5d29  sfDict[old_key])
-0002fb00: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
-0002fb10: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0002fb20: 656c 2073 656c 662e 7366 4469 6374 5b6f  el self.sfDict[o
-0002fb30: 6c64 5f6b 6579 5d0a 2020 2020 2020 2020  ld_key].        
-0002fb40: 2020 2020 2020 2020 2020 2020 7366 203d              sf =
-0002fb50: 2073 656c 662e 7366 4469 6374 5b6b 6579   self.sfDict[key
-0002fb60: 5d5b 2d31 5d5b 2773 6176 6566 7261 6d65  ][-1]['saveframe
-0002fb70: 275d 0a20 2020 2020 2020 2020 2020 2020  '].             
-0002fb80: 2020 2020 2020 2069 6478 203d 206e 6578         idx = nex
-0002fb90: 7428 2869 6478 2066 6f72 2069 6478 2c20  t((idx for idx, 
-0002fba0: 7420 696e 2065 6e75 6d65 7261 7465 2873  t in enumerate(s
-0002fbb0: 662e 7461 6773 2920 6966 2074 5b30 5d20  f.tags) if t[0] 
-0002fbc0: 3d3d 2027 506f 7465 6e74 6961 6c5f 7479  == 'Potential_ty
-0002fbd0: 7065 2729 2c20 2d31 290a 2020 2020 2020  pe'), -1).      
-0002fbe0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0002fbf0: 2069 6478 2021 3d20 2d31 3a0a 2020 2020   idx != -1:.    
-0002fc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fc10: 2020 2020 7366 2e74 6167 735b 6964 785d      sf.tags[idx]
-0002fc20: 5b31 5d20 3d20 706f 7465 6e74 6961 6c54  [1] = potentialT
-0002fc30: 7970 650a 2020 2020 2020 2020 2020 2020  ype.            
-0002fc40: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0002ddc0: 2020 2020 2020 2020 7365 6c66 2e5f 5f61          self.__a
+0002ddd0: 7574 6854 6f53 7461 7253 6571 2c20 7365  uthToStarSeq, se
+0002dde0: 6c66 2e5f 5f61 7574 6854 6f49 6e73 436f  lf.__authToInsCo
+0002ddf0: 6465 2c20 7365 6c66 2e5f 5f6f 6666 7365  de, self.__offse
+0002de00: 7448 6f6c 6465 722c 0a20 2020 2020 2020  tHolder,.       
+0002de10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002de20: 2020 2020 2020 2020 2020 6174 6f6d 312c            atom1,
+0002de30: 2061 746f 6d32 290a 2020 2020 2020 2020   atom2).        
+0002de40: 2020 2020 2020 2020 2020 2020 7366 5b27              sf['
+0002de50: 6c6f 6f70 275d 2e61 6464 5f64 6174 6128  loop'].add_data(
+0002de60: 726f 7729 0a0a 2020 2020 2020 2020 6669  row)..        fi
+0002de70: 6e61 6c6c 793a 0a20 2020 2020 2020 2020  nally:.         
+0002de80: 2020 2073 656c 662e 6174 6f6d 5365 6c65     self.atomSele
+0002de90: 6374 696f 6e53 6574 2e63 6c65 6172 2829  ctionSet.clear()
+0002dea0: 0a0a 2020 2020 2320 456e 7465 7220 6120  ..    # Enter a 
+0002deb0: 7061 7273 6520 7472 6565 2070 726f 6475  parse tree produ
+0002dec0: 6365 6420 6279 2052 6f73 6574 7461 4d52  ced by RosettaMR
+0002ded0: 5061 7273 6572 236e 756d 6265 722e 0a20  Parser#number.. 
+0002dee0: 2020 2064 6566 2065 6e74 6572 4e75 6d62     def enterNumb
+0002def0: 6572 2873 656c 662c 2063 7478 3a20 526f  er(self, ctx: Ro
+0002df00: 7365 7474 614d 5250 6172 7365 722e 4e75  settaMRParser.Nu
+0002df10: 6d62 6572 436f 6e74 6578 7429 3a20 2023  mberContext):  #
+0002df20: 2070 796c 696e 743a 2064 6973 6162 6c65   pylint: disable
+0002df30: 3d75 6e75 7365 642d 6172 6775 6d65 6e74  =unused-argument
+0002df40: 0a20 2020 2020 2020 2070 6173 730a 0a20  .        pass.. 
+0002df50: 2020 2023 2045 7869 7420 6120 7061 7273     # Exit a pars
+0002df60: 6520 7472 6565 2070 726f 6475 6365 6420  e tree produced 
+0002df70: 6279 2052 6f73 6574 7461 4d52 5061 7273  by RosettaMRPars
+0002df80: 6572 236e 756d 6265 722e 0a20 2020 2064  er#number..    d
+0002df90: 6566 2065 7869 744e 756d 6265 7228 7365  ef exitNumber(se
+0002dfa0: 6c66 2c20 6374 783a 2052 6f73 6574 7461  lf, ctx: Rosetta
+0002dfb0: 4d52 5061 7273 6572 2e4e 756d 6265 7243  MRParser.NumberC
+0002dfc0: 6f6e 7465 7874 293a 0a20 2020 2020 2020  ontext):.       
+0002dfd0: 2069 6620 6374 782e 466c 6f61 7428 293a   if ctx.Float():
+0002dfe0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0002dff0: 662e 6e75 6d62 6572 5365 6c65 6374 696f  f.numberSelectio
+0002e000: 6e2e 6170 7065 6e64 2866 6c6f 6174 2873  n.append(float(s
+0002e010: 7472 2863 7478 2e46 6c6f 6174 2829 2929  tr(ctx.Float()))
+0002e020: 290a 0a20 2020 2020 2020 2065 6c69 6620  )..        elif 
+0002e030: 6374 782e 496e 7465 6765 7228 293a 0a20  ctx.Integer():. 
+0002e040: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0002e050: 6e75 6d62 6572 5365 6c65 6374 696f 6e2e  numberSelection.
+0002e060: 6170 7065 6e64 2866 6c6f 6174 2873 7472  append(float(str
+0002e070: 2863 7478 2e49 6e74 6567 6572 2829 2929  (ctx.Integer()))
+0002e080: 290a 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
+0002e090: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0002e0a0: 662e 6e75 6d62 6572 5365 6c65 6374 696f  f.numberSelectio
+0002e0b0: 6e2e 6170 7065 6e64 284e 6f6e 6529 0a0a  n.append(None)..
+0002e0c0: 2020 2020 2320 456e 7465 7220 6120 7061      # Enter a pa
+0002e0d0: 7273 6520 7472 6565 2070 726f 6475 6365  rse tree produce
+0002e0e0: 6420 6279 2052 6f73 6574 7461 4d52 5061  d by RosettaMRPa
+0002e0f0: 7273 6572 236e 756d 6265 725f 662e 0a20  rser#number_f.. 
+0002e100: 2020 2064 6566 2065 6e74 6572 4e75 6d62     def enterNumb
+0002e110: 6572 5f66 2873 656c 662c 2063 7478 3a20  er_f(self, ctx: 
+0002e120: 526f 7365 7474 614d 5250 6172 7365 722e  RosettaMRParser.
+0002e130: 4e75 6d62 6572 5f66 436f 6e74 6578 7429  Number_fContext)
+0002e140: 3a20 2023 2070 796c 696e 743a 2064 6973  :  # pylint: dis
+0002e150: 6162 6c65 3d75 6e75 7365 642d 6172 6775  able=unused-argu
+0002e160: 6d65 6e74 0a20 2020 2020 2020 2070 6173  ment.        pas
+0002e170: 730a 0a20 2020 2023 2045 7869 7420 6120  s..    # Exit a 
+0002e180: 7061 7273 6520 7472 6565 2070 726f 6475  parse tree produ
+0002e190: 6365 6420 6279 2052 6f73 6574 7461 4d52  ced by RosettaMR
+0002e1a0: 5061 7273 6572 236e 756d 6265 725f 662e  Parser#number_f.
+0002e1b0: 0a20 2020 2064 6566 2065 7869 744e 756d  .    def exitNum
+0002e1c0: 6265 725f 6628 7365 6c66 2c20 6374 783a  ber_f(self, ctx:
+0002e1d0: 2052 6f73 6574 7461 4d52 5061 7273 6572   RosettaMRParser
+0002e1e0: 2e4e 756d 6265 725f 6643 6f6e 7465 7874  .Number_fContext
+0002e1f0: 293a 0a20 2020 2020 2020 2069 6620 6374  ):.        if ct
+0002e200: 782e 466c 6f61 7428 293a 0a20 2020 2020  x.Float():.     
+0002e210: 2020 2020 2020 2073 656c 662e 6e75 6d62         self.numb
+0002e220: 6572 4653 656c 6563 7469 6f6e 2e61 7070  erFSelection.app
+0002e230: 656e 6428 666c 6f61 7428 7374 7228 6374  end(float(str(ct
+0002e240: 782e 466c 6f61 7428 2929 2929 0a0a 2020  x.Float())))..  
+0002e250: 2020 2020 2020 656c 6966 2063 7478 2e49        elif ctx.I
+0002e260: 6e74 6567 6572 2829 3a0a 2020 2020 2020  nteger():.      
+0002e270: 2020 2020 2020 7365 6c66 2e6e 756d 6265        self.numbe
+0002e280: 7246 5365 6c65 6374 696f 6e2e 6170 7065  rFSelection.appe
+0002e290: 6e64 2866 6c6f 6174 2873 7472 2863 7478  nd(float(str(ctx
+0002e2a0: 2e49 6e74 6567 6572 2829 2929 290a 0a20  .Integer()))).. 
+0002e2b0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0002e2c0: 2020 2020 2020 2020 2073 656c 662e 6e75           self.nu
+0002e2d0: 6d62 6572 4653 656c 6563 7469 6f6e 2e61  mberFSelection.a
+0002e2e0: 7070 656e 6428 4e6f 6e65 290a 0a20 2020  ppend(None)..   
+0002e2f0: 2064 6566 205f 5f67 6574 4375 7272 656e   def __getCurren
+0002e300: 7452 6573 7472 6169 6e74 2873 656c 6629  tRestraint(self)
+0002e310: 3a0a 2020 2020 2020 2020 6966 2073 656c  :.        if sel
+0002e320: 662e 5f5f 6375 725f 7375 6274 7970 6520  f.__cur_subtype 
+0002e330: 3d3d 2027 6469 7374 273a 0a20 2020 2020  == 'dist':.     
+0002e340: 2020 2020 2020 2072 6574 7572 6e20 6622         return f"
+0002e350: 5b43 6865 636b 2074 6865 207b 7365 6c66  [Check the {self
+0002e360: 2e64 6973 7452 6573 7472 6169 6e74 737d  .distRestraints}
+0002e370: 7468 2072 6f77 206f 6620 6469 7374 616e  th row of distan
+0002e380: 6365 2072 6573 7472 6169 6e74 735d 2022  ce restraints] "
+0002e390: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+0002e3a0: 2e5f 5f63 7572 5f73 7562 7479 7065 203d  .__cur_subtype =
+0002e3b0: 3d20 2761 6e67 273a 0a20 2020 2020 2020  = 'ang':.       
+0002e3c0: 2020 2020 2072 6574 7572 6e20 6622 5b43       return f"[C
+0002e3d0: 6865 636b 2074 6865 207b 7365 6c66 2e61  heck the {self.a
+0002e3e0: 6e67 5265 7374 7261 696e 7473 7d74 6820  ngRestraints}th 
+0002e3f0: 726f 7720 6f66 2061 6e67 6c65 2072 6573  row of angle res
+0002e400: 7472 6169 6e74 735d 2022 0a20 2020 2020  traints] ".     
+0002e410: 2020 2069 6620 7365 6c66 2e5f 5f63 7572     if self.__cur
+0002e420: 5f73 7562 7479 7065 203d 3d20 2764 6968  _subtype == 'dih
+0002e430: 6564 273a 0a20 2020 2020 2020 2020 2020  ed':.           
+0002e440: 2072 6574 7572 6e20 6622 5b43 6865 636b   return f"[Check
+0002e450: 2074 6865 207b 7365 6c66 2e64 6968 6564   the {self.dihed
+0002e460: 5265 7374 7261 696e 7473 7d74 6820 726f  Restraints}th ro
+0002e470: 7720 6f66 2064 6968 6564 7261 6c20 616e  w of dihedral an
+0002e480: 676c 6520 7265 7374 7261 696e 7473 5d20  gle restraints] 
+0002e490: 220a 2020 2020 2020 2020 6966 2073 656c  ".        if sel
+0002e4a0: 662e 5f5f 6375 725f 7375 6274 7970 6520  f.__cur_subtype 
+0002e4b0: 3d3d 2027 7264 6327 3a0a 2020 2020 2020  == 'rdc':.      
+0002e4c0: 2020 2020 2020 7265 7475 726e 2066 225b        return f"[
+0002e4d0: 4368 6563 6b20 7468 6520 7b73 656c 662e  Check the {self.
+0002e4e0: 7264 6352 6573 7472 6169 6e74 737d 7468  rdcRestraints}th
+0002e4f0: 2072 6f77 206f 6620 7265 7369 6475 616c   row of residual
+0002e500: 2064 6970 6f6c 6172 2063 6f75 706c 696e   dipolar couplin
+0002e510: 6720 7265 7374 7261 696e 7473 5d20 220a  g restraints] ".
+0002e520: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0002e530: 5f5f 6375 725f 7375 6274 7970 6520 3d3d  __cur_subtype ==
+0002e540: 2027 6765 6f27 3a0a 2020 2020 2020 2020   'geo':.        
+0002e550: 2020 2020 7265 7475 726e 2066 225b 4368      return f"[Ch
+0002e560: 6563 6b20 7468 6520 7b73 656c 662e 6765  eck the {self.ge
+0002e570: 6f52 6573 7472 6169 6e74 737d 7468 2072  oRestraints}th r
+0002e580: 6f77 206f 6620 636f 6f72 6469 6e61 7465  ow of coordinate
+0002e590: 2067 656f 6d65 7472 7920 7265 7374 7261   geometry restra
+0002e5a0: 696e 7473 5d20 220a 2020 2020 2020 2020  ints] ".        
+0002e5b0: 6966 2073 656c 662e 5f5f 6375 725f 7375  if self.__cur_su
+0002e5c0: 6274 7970 6520 3d3d 2027 7373 626f 6e64  btype == 'ssbond
+0002e5d0: 273a 0a20 2020 2020 2020 2020 2020 2072  ':.            r
+0002e5e0: 6574 7572 6e20 6622 5b43 6865 636b 2074  eturn f"[Check t
+0002e5f0: 6865 207b 7365 6c66 2e73 7362 6f6e 6452  he {self.ssbondR
+0002e600: 6573 7472 6169 6e74 737d 7468 2072 6f77  estraints}th row
+0002e610: 206f 6620 6469 7375 6c66 6964 6520 626f   of disulfide bo
+0002e620: 6e64 2072 6573 7472 6169 6e74 735d 2022  nd restraints] "
+0002e630: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0002e640: 2727 0a0a 2020 2020 6465 6620 5f5f 7365  ''..    def __se
+0002e650: 744c 6f63 616c 5365 7153 6368 656d 6528  tLocalSeqScheme(
+0002e660: 7365 6c66 293a 0a20 2020 2020 2020 2069  self):.        i
+0002e670: 6620 276c 6f63 616c 5f73 6571 5f73 6368  f 'local_seq_sch
+0002e680: 656d 6527 206e 6f74 2069 6e20 7365 6c66  eme' not in self
+0002e690: 2e72 6561 736f 6e73 466f 7252 6550 6172  .reasonsForRePar
+0002e6a0: 7369 6e67 3a0a 2020 2020 2020 2020 2020  sing:.          
+0002e6b0: 2020 7365 6c66 2e72 6561 736f 6e73 466f    self.reasonsFo
+0002e6c0: 7252 6550 6172 7369 6e67 5b27 6c6f 6361  rReParsing['loca
+0002e6d0: 6c5f 7365 715f 7363 6865 6d65 275d 203d  l_seq_scheme'] =
+0002e6e0: 207b 7d0a 2020 2020 2020 2020 6966 2073   {}.        if s
+0002e6f0: 656c 662e 5f5f 6375 725f 7375 6274 7970  elf.__cur_subtyp
+0002e700: 6520 3d3d 2027 6469 7374 273a 0a20 2020  e == 'dist':.   
+0002e710: 2020 2020 2020 2020 2073 656c 662e 7265           self.re
+0002e720: 6173 6f6e 7346 6f72 5265 5061 7273 696e  asonsForReParsin
+0002e730: 675b 276c 6f63 616c 5f73 6571 5f73 6368  g['local_seq_sch
+0002e740: 656d 6527 5d5b 2873 656c 662e 5f5f 6375  eme'][(self.__cu
+0002e750: 725f 7375 6274 7970 652c 2073 656c 662e  r_subtype, self.
+0002e760: 6469 7374 5265 7374 7261 696e 7473 295d  distRestraints)]
+0002e770: 203d 2073 656c 662e 5f5f 7072 6566 6572   = self.__prefer
+0002e780: 4175 7468 5365 710a 2020 2020 2020 2020  AuthSeq.        
+0002e790: 656c 6966 2073 656c 662e 5f5f 6375 725f  elif self.__cur_
+0002e7a0: 7375 6274 7970 6520 3d3d 2027 616e 6727  subtype == 'ang'
+0002e7b0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+0002e7c0: 6c66 2e72 6561 736f 6e73 466f 7252 6550  lf.reasonsForReP
+0002e7d0: 6172 7369 6e67 5b27 6c6f 6361 6c5f 7365  arsing['local_se
+0002e7e0: 715f 7363 6865 6d65 275d 5b28 7365 6c66  q_scheme'][(self
+0002e7f0: 2e5f 5f63 7572 5f73 7562 7479 7065 2c20  .__cur_subtype, 
+0002e800: 7365 6c66 2e61 6e67 5265 7374 7261 696e  self.angRestrain
+0002e810: 7473 295d 203d 2073 656c 662e 5f5f 7072  ts)] = self.__pr
+0002e820: 6566 6572 4175 7468 5365 710a 2020 2020  eferAuthSeq.    
+0002e830: 2020 2020 656c 6966 2073 656c 662e 5f5f      elif self.__
+0002e840: 6375 725f 7375 6274 7970 6520 3d3d 2027  cur_subtype == '
+0002e850: 6469 6865 6427 3a0a 2020 2020 2020 2020  dihed':.        
+0002e860: 2020 2020 7365 6c66 2e72 6561 736f 6e73      self.reasons
+0002e870: 466f 7252 6550 6172 7369 6e67 5b27 6c6f  ForReParsing['lo
+0002e880: 6361 6c5f 7365 715f 7363 6865 6d65 275d  cal_seq_scheme']
+0002e890: 5b28 7365 6c66 2e5f 5f63 7572 5f73 7562  [(self.__cur_sub
+0002e8a0: 7479 7065 2c20 7365 6c66 2e64 6968 6564  type, self.dihed
+0002e8b0: 5265 7374 7261 696e 7473 295d 203d 2073  Restraints)] = s
+0002e8c0: 656c 662e 5f5f 7072 6566 6572 4175 7468  elf.__preferAuth
+0002e8d0: 5365 710a 2020 2020 2020 2020 656c 6966  Seq.        elif
+0002e8e0: 2073 656c 662e 5f5f 6375 725f 7375 6274   self.__cur_subt
+0002e8f0: 7970 6520 3d3d 2027 7264 6327 3a0a 2020  ype == 'rdc':.  
+0002e900: 2020 2020 2020 2020 2020 7365 6c66 2e72            self.r
+0002e910: 6561 736f 6e73 466f 7252 6550 6172 7369  easonsForReParsi
+0002e920: 6e67 5b27 6c6f 6361 6c5f 7365 715f 7363  ng['local_seq_sc
+0002e930: 6865 6d65 275d 5b28 7365 6c66 2e5f 5f63  heme'][(self.__c
+0002e940: 7572 5f73 7562 7479 7065 2c20 7365 6c66  ur_subtype, self
+0002e950: 2e72 6463 5265 7374 7261 696e 7473 295d  .rdcRestraints)]
+0002e960: 203d 2073 656c 662e 5f5f 7072 6566 6572   = self.__prefer
+0002e970: 4175 7468 5365 710a 2020 2020 2020 2020  AuthSeq.        
+0002e980: 656c 6966 2073 656c 662e 5f5f 6375 725f  elif self.__cur_
+0002e990: 7375 6274 7970 6520 3d3d 2027 6765 6f27  subtype == 'geo'
+0002e9a0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+0002e9b0: 6c66 2e72 6561 736f 6e73 466f 7252 6550  lf.reasonsForReP
+0002e9c0: 6172 7369 6e67 5b27 6c6f 6361 6c5f 7365  arsing['local_se
+0002e9d0: 715f 7363 6865 6d65 275d 5b28 7365 6c66  q_scheme'][(self
+0002e9e0: 2e5f 5f63 7572 5f73 7562 7479 7065 2c20  .__cur_subtype, 
+0002e9f0: 7365 6c66 2e67 656f 5265 7374 7261 696e  self.geoRestrain
+0002ea00: 7473 295d 203d 2073 656c 662e 5f5f 7072  ts)] = self.__pr
+0002ea10: 6566 6572 4175 7468 5365 710a 2020 2020  eferAuthSeq.    
+0002ea20: 2020 2020 656c 6966 2073 656c 662e 5f5f      elif self.__
+0002ea30: 6375 725f 7375 6274 7970 6520 3d3d 2027  cur_subtype == '
+0002ea40: 7373 626f 6e64 273a 0a20 2020 2020 2020  ssbond':.       
+0002ea50: 2020 2020 2073 656c 662e 7265 6173 6f6e       self.reason
+0002ea60: 7346 6f72 5265 5061 7273 696e 675b 276c  sForReParsing['l
+0002ea70: 6f63 616c 5f73 6571 5f73 6368 656d 6527  ocal_seq_scheme'
+0002ea80: 5d5b 2873 656c 662e 5f5f 6375 725f 7375  ][(self.__cur_su
+0002ea90: 6274 7970 652c 2073 656c 662e 7373 626f  btype, self.ssbo
+0002eaa0: 6e64 5265 7374 7261 696e 7473 295d 203d  ndRestraints)] =
+0002eab0: 2073 656c 662e 5f5f 7072 6566 6572 4175   self.__preferAu
+0002eac0: 7468 5365 710a 2020 2020 2020 2020 6966  thSeq.        if
+0002ead0: 206e 6f74 2073 656c 662e 5f5f 7072 6566   not self.__pref
+0002eae0: 6572 4175 7468 5365 713a 0a20 2020 2020  erAuthSeq:.     
+0002eaf0: 2020 2020 2020 2073 656c 662e 5f5f 7072         self.__pr
+0002eb00: 6566 6572 4c61 6265 6c53 6571 436f 756e  eferLabelSeqCoun
+0002eb10: 7420 2b3d 2031 0a20 2020 2020 2020 2020  t += 1.         
+0002eb20: 2020 2069 6620 7365 6c66 2e5f 5f70 7265     if self.__pre
+0002eb30: 6665 724c 6162 656c 5365 7143 6f75 6e74  ferLabelSeqCount
+0002eb40: 203e 204d 4158 5f50 5245 465f 4c41 4245   > MAX_PREF_LABE
+0002eb50: 4c5f 5343 4845 4d45 5f43 4f55 4e54 3a0a  L_SCHEME_COUNT:.
+0002eb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002eb70: 7365 6c66 2e72 6561 736f 6e73 466f 7252  self.reasonsForR
+0002eb80: 6550 6172 7369 6e67 5b27 6c61 6265 6c5f  eParsing['label_
+0002eb90: 7365 715f 7363 6865 6d65 275d 203d 2054  seq_scheme'] = T
+0002eba0: 7275 650a 0a20 2020 2064 6566 205f 5f72  rue..    def __r
+0002ebb0: 6574 7269 6576 654c 6f63 616c 5365 7153  etrieveLocalSeqS
+0002ebc0: 6368 656d 6528 7365 6c66 293a 0a20 2020  cheme(self):.   
+0002ebd0: 2020 2020 2069 6620 7365 6c66 2e5f 5f72       if self.__r
+0002ebe0: 6561 736f 6e73 2069 7320 4e6f 6e65 206f  easons is None o
+0002ebf0: 7220 276c 6f63 616c 5f73 6571 5f73 6368  r 'local_seq_sch
+0002ec00: 656d 6527 206e 6f74 2069 6e20 7365 6c66  eme' not in self
+0002ec10: 2e5f 5f72 6561 736f 6e73 3a0a 2020 2020  .__reasons:.    
+0002ec20: 2020 2020 2020 2020 7265 7475 726e 0a20          return. 
+0002ec30: 2020 2020 2020 2069 6620 276c 6162 656c         if 'label
+0002ec40: 5f73 6571 5f73 6368 656d 6527 2069 6e20  _seq_scheme' in 
+0002ec50: 7365 6c66 2e5f 5f72 6561 736f 6e73 2061  self.__reasons a
+0002ec60: 6e64 2073 656c 662e 5f5f 7265 6173 6f6e  nd self.__reason
+0002ec70: 735b 276c 6162 656c 5f73 6571 5f73 6368  s['label_seq_sch
+0002ec80: 656d 6527 5d3a 0a20 2020 2020 2020 2020  eme']:.         
+0002ec90: 2020 2073 656c 662e 5f5f 7072 6566 6572     self.__prefer
+0002eca0: 4175 7468 5365 7120 3d20 4661 6c73 650a  AuthSeq = False.
+0002ecb0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0002ecc0: 2e5f 5f61 7574 6853 6571 4964 203d 2027  .__authSeqId = '
+0002ecd0: 6c61 6265 6c5f 7365 715f 6964 270a 2020  label_seq_id'.  
+0002ece0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0002ecf0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+0002ed00: 2e5f 5f63 7572 5f73 7562 7479 7065 203d  .__cur_subtype =
+0002ed10: 3d20 2764 6973 7427 3a0a 2020 2020 2020  = 'dist':.      
+0002ed20: 2020 2020 2020 6b65 7920 3d20 2873 656c        key = (sel
+0002ed30: 662e 5f5f 6375 725f 7375 6274 7970 652c  f.__cur_subtype,
+0002ed40: 2073 656c 662e 6469 7374 5265 7374 7261   self.distRestra
+0002ed50: 696e 7473 290a 2020 2020 2020 2020 656c  ints).        el
+0002ed60: 6966 2073 656c 662e 5f5f 6375 725f 7375  if self.__cur_su
+0002ed70: 6274 7970 6520 3d3d 2027 616e 6727 3a0a  btype == 'ang':.
+0002ed80: 2020 2020 2020 2020 2020 2020 6b65 7920              key 
+0002ed90: 3d20 2873 656c 662e 5f5f 6375 725f 7375  = (self.__cur_su
+0002eda0: 6274 7970 652c 2073 656c 662e 616e 6752  btype, self.angR
+0002edb0: 6573 7472 6169 6e74 7329 0a20 2020 2020  estraints).     
+0002edc0: 2020 2065 6c69 6620 7365 6c66 2e5f 5f63     elif self.__c
+0002edd0: 7572 5f73 7562 7479 7065 203d 3d20 2764  ur_subtype == 'd
+0002ede0: 6968 6564 273a 0a20 2020 2020 2020 2020  ihed':.         
+0002edf0: 2020 206b 6579 203d 2028 7365 6c66 2e5f     key = (self._
+0002ee00: 5f63 7572 5f73 7562 7479 7065 2c20 7365  _cur_subtype, se
+0002ee10: 6c66 2e64 6968 6564 5265 7374 7261 696e  lf.dihedRestrain
+0002ee20: 7473 290a 2020 2020 2020 2020 656c 6966  ts).        elif
+0002ee30: 2073 656c 662e 5f5f 6375 725f 7375 6274   self.__cur_subt
+0002ee40: 7970 6520 3d3d 2027 7264 6327 3a0a 2020  ype == 'rdc':.  
+0002ee50: 2020 2020 2020 2020 2020 6b65 7920 3d20            key = 
+0002ee60: 2873 656c 662e 5f5f 6375 725f 7375 6274  (self.__cur_subt
+0002ee70: 7970 652c 2073 656c 662e 7264 6352 6573  ype, self.rdcRes
+0002ee80: 7472 6169 6e74 7329 0a20 2020 2020 2020  traints).       
+0002ee90: 2065 6c69 6620 7365 6c66 2e5f 5f63 7572   elif self.__cur
+0002eea0: 5f73 7562 7479 7065 203d 3d20 2767 656f  _subtype == 'geo
+0002eeb0: 273a 0a20 2020 2020 2020 2020 2020 206b  ':.            k
+0002eec0: 6579 203d 2028 7365 6c66 2e5f 5f63 7572  ey = (self.__cur
+0002eed0: 5f73 7562 7479 7065 2c20 7365 6c66 2e67  _subtype, self.g
+0002eee0: 656f 5265 7374 7261 696e 7473 290a 2020  eoRestraints).  
+0002eef0: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
+0002ef00: 5f5f 6375 725f 7375 6274 7970 6520 3d3d  __cur_subtype ==
+0002ef10: 2027 7373 626f 6e64 273a 0a20 2020 2020   'ssbond':.     
+0002ef20: 2020 2020 2020 206b 6579 203d 2028 7365         key = (se
+0002ef30: 6c66 2e5f 5f63 7572 5f73 7562 7479 7065  lf.__cur_subtype
+0002ef40: 2c20 7365 6c66 2e73 7362 6f6e 6452 6573  , self.ssbondRes
+0002ef50: 7472 6169 6e74 7329 0a20 2020 2020 2020  traints).       
+0002ef60: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0002ef70: 2020 2072 6574 7572 6e0a 0a20 2020 2020     return..     
+0002ef80: 2020 2069 6620 6b65 7920 696e 2073 656c     if key in sel
+0002ef90: 662e 5f5f 7265 6173 6f6e 735b 276c 6f63  f.__reasons['loc
+0002efa0: 616c 5f73 6571 5f73 6368 656d 6527 5d3a  al_seq_scheme']:
+0002efb0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0002efc0: 662e 5f5f 7072 6566 6572 4175 7468 5365  f.__preferAuthSe
+0002efd0: 7120 3d20 7365 6c66 2e5f 5f72 6561 736f  q = self.__reaso
+0002efe0: 6e73 5b27 6c6f 6361 6c5f 7365 715f 7363  ns['local_seq_sc
+0002eff0: 6865 6d65 275d 5b6b 6579 5d0a 0a20 2020  heme'][key]..   
+0002f000: 2064 6566 205f 5f61 6464 5366 2873 656c   def __addSf(sel
+0002f010: 662c 2063 6f6e 7374 7261 696e 7454 7970  f, constraintTyp
+0002f020: 653d 4e6f 6e65 2c20 706f 7465 6e74 6961  e=None, potentia
+0002f030: 6c54 7970 653d 4e6f 6e65 2c20 7264 6343  lType=None, rdcC
+0002f040: 6f64 653d 4e6f 6e65 293a 0a20 2020 2020  ode=None):.     
+0002f050: 2020 2063 6f6e 7465 6e74 5f73 7562 7479     content_subty
+0002f060: 7065 203d 2063 6f6e 7465 6e74 5375 6274  pe = contentSubt
+0002f070: 7970 654f 6628 7365 6c66 2e5f 5f63 7572  ypeOf(self.__cur
+0002f080: 5f73 7562 7479 7065 290a 0a20 2020 2020  _subtype)..     
+0002f090: 2020 2069 6620 636f 6e74 656e 745f 7375     if content_su
+0002f0a0: 6274 7970 6520 6973 204e 6f6e 653a 0a20  btype is None:. 
+0002f0b0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0002f0c0: 6e0a 0a20 2020 2020 2020 2073 656c 662e  n..        self.
+0002f0d0: 5f5f 6c69 7374 4964 436f 756e 7465 7220  __listIdCounter 
+0002f0e0: 3d20 696e 634c 6973 7449 6443 6f75 6e74  = incListIdCount
+0002f0f0: 6572 2873 656c 662e 5f5f 6375 725f 7375  er(self.__cur_su
+0002f100: 6274 7970 652c 2073 656c 662e 5f5f 6c69  btype, self.__li
+0002f110: 7374 4964 436f 756e 7465 7229 0a0a 2020  stIdCounter)..  
+0002f120: 2020 2020 2020 6b65 7920 3d20 2873 656c        key = (sel
+0002f130: 662e 5f5f 6375 725f 7375 6274 7970 652c  f.__cur_subtype,
+0002f140: 2063 6f6e 7374 7261 696e 7454 7970 652c   constraintType,
+0002f150: 2070 6f74 656e 7469 616c 5479 7065 2c20   potentialType, 
+0002f160: 7264 6343 6f64 652c 204e 6f6e 6529 0a0a  rdcCode, None)..
+0002f170: 2020 2020 2020 2020 6966 206b 6579 206e          if key n
+0002f180: 6f74 2069 6e20 7365 6c66 2e73 6644 6963  ot in self.sfDic
+0002f190: 743a 0a20 2020 2020 2020 2020 2020 2073  t:.            s
+0002f1a0: 656c 662e 7366 4469 6374 5b6b 6579 5d20  elf.sfDict[key] 
+0002f1b0: 3d20 5b5d 0a0a 2020 2020 2020 2020 6c69  = []..        li
+0002f1c0: 7374 5f69 6420 3d20 7365 6c66 2e5f 5f6c  st_id = self.__l
+0002f1d0: 6973 7449 6443 6f75 6e74 6572 5b63 6f6e  istIdCounter[con
+0002f1e0: 7465 6e74 5f73 7562 7479 7065 5d0a 0a20  tent_subtype].. 
+0002f1f0: 2020 2020 2020 2072 6573 7472 6169 6e74         restraint
+0002f200: 5f6e 616d 6520 3d20 6765 7452 6573 7472  _name = getRestr
+0002f210: 6169 6e74 4e61 6d65 2873 656c 662e 5f5f  aintName(self.__
+0002f220: 6375 725f 7375 6274 7970 6529 0a0a 2020  cur_subtype)..  
+0002f230: 2020 2020 2020 7366 5f66 7261 6d65 636f        sf_frameco
+0002f240: 6465 203d 2027 524f 5345 5454 415f 2720  de = 'ROSETTA_' 
+0002f250: 2b20 7265 7374 7261 696e 745f 6e61 6d65  + restraint_name
+0002f260: 2e72 6570 6c61 6365 2827 2027 2c20 275f  .replace(' ', '_
+0002f270: 2729 202b 2066 275f 7b6c 6973 745f 6964  ') + f'_{list_id
+0002f280: 7d27 0a0a 2020 2020 2020 2020 7366 203d  }'..        sf =
+0002f290: 2067 6574 5361 7665 6672 616d 6528 7365   getSaveframe(se
+0002f2a0: 6c66 2e5f 5f63 7572 5f73 7562 7479 7065  lf.__cur_subtype
+0002f2b0: 2c20 7366 5f66 7261 6d65 636f 6465 2c20  , sf_framecode, 
+0002f2c0: 6c69 7374 5f69 642c 2073 656c 662e 5f5f  list_id, self.__
+0002f2d0: 656e 7472 7949 642c 2073 656c 662e 5f5f  entryId, self.__
+0002f2e0: 6f72 6967 696e 616c 4669 6c65 4e61 6d65  originalFileName
+0002f2f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002f300: 2020 2020 2020 2020 2020 2020 636f 6e73              cons
+0002f310: 7472 6169 6e74 5479 7065 3d63 6f6e 7374  traintType=const
+0002f320: 7261 696e 7454 7970 652c 2070 6f74 656e  raintType, poten
+0002f330: 7469 616c 5479 7065 3d70 6f74 656e 7469  tialType=potenti
+0002f340: 616c 5479 7065 2c20 7264 6343 6f64 653d  alType, rdcCode=
+0002f350: 7264 6343 6f64 6529 0a0a 2020 2020 2020  rdcCode)..      
+0002f360: 2020 6e6f 745f 7661 6c69 6420 3d20 5472    not_valid = Tr
+0002f370: 7565 0a0a 2020 2020 2020 2020 6c70 203d  ue..        lp =
+0002f380: 2067 6574 4c6f 6f70 2873 656c 662e 5f5f   getLoop(self.__
+0002f390: 6375 725f 7375 6274 7970 652c 2068 6173  cur_subtype, has
+0002f3a0: 496e 7343 6f64 653d 2873 656c 662e 5f5f  InsCode=(self.__
+0002f3b0: 6175 7468 546f 496e 7343 6f64 6520 6973  authToInsCode is
+0002f3c0: 206e 6f74 204e 6f6e 6529 290a 2020 2020   not None)).    
+0002f3d0: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+0002f3e0: 7461 6e63 6528 6c70 2c20 6469 6374 293a  tance(lp, dict):
+0002f3f0: 0a20 2020 2020 2020 2020 2020 2073 662e  .            sf.
+0002f400: 6164 645f 6c6f 6f70 286c 7029 0a20 2020  add_loop(lp).   
+0002f410: 2020 2020 2020 2020 206e 6f74 5f76 616c           not_val
+0002f420: 6964 203d 2046 616c 7365 0a0a 2020 2020  id = False..    
+0002f430: 2020 2020 5f72 6573 7472 6169 6e74 5f6e      _restraint_n
+0002f440: 616d 6520 3d20 7265 7374 7261 696e 745f  ame = restraint_
+0002f450: 6e61 6d65 2e73 706c 6974 2829 0a0a 2020  name.split()..  
+0002f460: 2020 2020 2020 6974 656d 203d 207b 2766        item = {'f
+0002f470: 696c 655f 7479 7065 273a 2073 656c 662e  ile_type': self.
+0002f480: 5f5f 6669 6c65 5f74 7970 652c 2027 7361  __file_type, 'sa
+0002f490: 7665 6672 616d 6527 3a20 7366 2c20 276c  veframe': sf, 'l
+0002f4a0: 6f6f 7027 3a20 6c70 2c20 276c 6973 745f  oop': lp, 'list_
+0002f4b0: 6964 273a 206c 6973 745f 6964 2c0a 2020  id': list_id,.  
+0002f4c0: 2020 2020 2020 2020 2020 2020 2020 2769                'i
+0002f4d0: 6427 3a20 302c 2027 696e 6465 785f 6964  d': 0, 'index_id
+0002f4e0: 273a 2030 2c0a 2020 2020 2020 2020 2020  ': 0,.          
+0002f4f0: 2020 2020 2020 2763 6f6e 7374 7261 696e        'constrain
+0002f500: 745f 7479 7065 273a 2027 2027 2e6a 6f69  t_type': ' '.joi
+0002f510: 6e28 5f72 6573 7472 6169 6e74 5f6e 616d  n(_restraint_nam
+0002f520: 655b 3a2d 315d 297d 0a0a 2020 2020 2020  e[:-1])}..      
+0002f530: 2020 6966 206e 6f74 5f76 616c 6964 3a0a    if not_valid:.
+0002f540: 2020 2020 2020 2020 2020 2020 6974 656d              item
+0002f550: 5b27 7461 6773 275d 203d 205b 5d0a 0a20  ['tags'] = [].. 
+0002f560: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
+0002f570: 5f63 7572 5f73 7562 7479 7065 203d 3d20  _cur_subtype == 
+0002f580: 2764 6973 7427 3a0a 2020 2020 2020 2020  'dist':.        
+0002f590: 2020 2020 6974 656d 5b27 636f 6e73 7472      item['constr
+0002f5a0: 6169 6e74 5f73 7562 7375 6274 7970 6527  aint_subsubtype'
+0002f5b0: 5d20 3d20 2773 696d 706c 6527 0a0a 2020  ] = 'simple'..  
+0002f5c0: 2020 2020 2020 7365 6c66 2e73 6644 6963        self.sfDic
+0002f5d0: 745b 6b65 795d 2e61 7070 656e 6428 6974  t[key].append(it
+0002f5e0: 656d 290a 0a20 2020 2064 6566 205f 5f67  em)..    def __g
+0002f5f0: 6574 5366 2873 656c 662c 2063 6f6e 7374  etSf(self, const
+0002f600: 7261 696e 7454 7970 653d 4e6f 6e65 2c20  raintType=None, 
+0002f610: 706f 7465 6e74 6961 6c54 7970 653d 4e6f  potentialType=No
+0002f620: 6e65 2c20 7264 6343 6f64 653d 4e6f 6e65  ne, rdcCode=None
+0002f630: 293a 0a20 2020 2020 2020 206b 6579 203d  ):.        key =
+0002f640: 2028 7365 6c66 2e5f 5f63 7572 5f73 7562   (self.__cur_sub
+0002f650: 7479 7065 2c20 636f 6e73 7472 6169 6e74  type, constraint
+0002f660: 5479 7065 2c20 706f 7465 6e74 6961 6c54  Type, potentialT
+0002f670: 7970 652c 2072 6463 436f 6465 2c20 4e6f  ype, rdcCode, No
+0002f680: 6e65 290a 0a20 2020 2020 2020 2069 6620  ne)..        if 
+0002f690: 6b65 7920 6e6f 7420 696e 2073 656c 662e  key not in self.
+0002f6a0: 7366 4469 6374 3a0a 2020 2020 2020 2020  sfDict:.        
+0002f6b0: 2020 2020 7265 706c 6163 6564 203d 2046      replaced = F
+0002f6c0: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
+0002f6d0: 2069 6620 706f 7465 6e74 6961 6c54 7970   if potentialTyp
+0002f6e0: 6520 6973 206e 6f74 204e 6f6e 6520 6f72  e is not None or
+0002f6f0: 2072 6463 436f 6465 2069 7320 6e6f 7420   rdcCode is not 
+0002f700: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0002f710: 2020 2020 2020 6f6c 645f 6b65 7920 3d20        old_key = 
+0002f720: 2873 656c 662e 5f5f 6375 725f 7375 6274  (self.__cur_subt
+0002f730: 7970 652c 2063 6f6e 7374 7261 696e 7454  ype, constraintT
+0002f740: 7970 652c 204e 6f6e 652c 204e 6f6e 652c  ype, None, None,
+0002f750: 204e 6f6e 6529 0a20 2020 2020 2020 2020   None).         
+0002f760: 2020 2020 2020 2069 6620 6f6c 645f 6b65         if old_ke
+0002f770: 7920 696e 2073 656c 662e 7366 4469 6374  y in self.sfDict
+0002f780: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002f790: 2020 2020 2020 7265 706c 6163 6564 203d        replaced =
+0002f7a0: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
+0002f7b0: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
+0002f7c0: 6644 6963 745b 6b65 795d 203d 205b 7365  fDict[key] = [se
+0002f7d0: 6c66 2e73 6644 6963 745b 6f6c 645f 6b65  lf.sfDict[old_ke
+0002f7e0: 795d 2e70 6f70 282d 3129 5d0a 2020 2020  y].pop(-1)].    
+0002f7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f800: 6966 206c 656e 2873 656c 662e 7366 4469  if len(self.sfDi
+0002f810: 6374 5b6f 6c64 5f6b 6579 5d29 203d 3d20  ct[old_key]) == 
+0002f820: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
+0002f830: 2020 2020 2020 2020 2020 2064 656c 2073             del s
+0002f840: 656c 662e 7366 4469 6374 5b6f 6c64 5f6b  elf.sfDict[old_k
+0002f850: 6579 5d0a 2020 2020 2020 2020 2020 2020  ey].            
+0002f860: 2020 2020 2020 2020 7366 203d 2073 656c          sf = sel
+0002f870: 662e 7366 4469 6374 5b6b 6579 5d5b 2d31  f.sfDict[key][-1
+0002f880: 5d5b 2773 6176 6566 7261 6d65 275d 0a20  ]['saveframe']. 
+0002f890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f8a0: 2020 2069 6478 203d 206e 6578 7428 2869     idx = next((i
+0002f8b0: 6478 2066 6f72 2069 6478 2c20 7420 696e  dx for idx, t in
+0002f8c0: 2065 6e75 6d65 7261 7465 2873 662e 7461   enumerate(sf.ta
+0002f8d0: 6773 2920 6966 2074 5b30 5d20 3d3d 2027  gs) if t[0] == '
+0002f8e0: 506f 7465 6e74 6961 6c5f 7479 7065 2729  Potential_type')
+0002f8f0: 2c20 2d31 290a 2020 2020 2020 2020 2020  , -1).          
+0002f900: 2020 2020 2020 2020 2020 6966 2069 6478            if idx
+0002f910: 2021 3d20 2d31 3a0a 2020 2020 2020 2020   != -1:.        
+0002f920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f930: 7366 2e74 6167 735b 6964 785d 5b31 5d20  sf.tags[idx][1] 
+0002f940: 3d20 706f 7465 6e74 6961 6c54 7970 650a  = potentialType.
+0002f950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f960: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0002f970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f980: 2020 7366 2e61 6464 5f74 6167 2827 506f    sf.add_tag('Po
+0002f990: 7465 6e74 6961 6c5f 7479 7065 272c 2070  tential_type', p
+0002f9a0: 6f74 656e 7469 616c 5479 7065 290a 2020  otentialType).  
+0002f9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f9c0: 2020 6966 2072 6463 436f 6465 2069 7320    if rdcCode is 
+0002f9d0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+0002f9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f9f0: 2020 6964 7820 3d20 6e65 7874 2828 6964    idx = next((id
+0002fa00: 7820 666f 7220 6964 782c 2074 2069 6e20  x for idx, t in 
+0002fa10: 656e 756d 6572 6174 6528 7366 2e74 6167  enumerate(sf.tag
+0002fa20: 7329 2069 6620 745b 305d 203d 3d20 2744  s) if t[0] == 'D
+0002fa30: 6574 6169 6c73 2729 2c20 2d31 290a 2020  etails'), -1).  
+0002fa40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fa50: 2020 2020 2020 6966 2069 6478 2021 3d20        if idx != 
+0002fa60: 2d31 3a0a 2020 2020 2020 2020 2020 2020  -1:.            
+0002fa70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fa80: 7366 2e74 6167 735b 6964 785d 5b31 5d20  sf.tags[idx][1] 
+0002fa90: 3d20 7264 6343 6f64 650a 2020 2020 2020  = rdcCode.      
+0002faa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fab0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0002fac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fad0: 2020 2020 7366 2e61 6464 5f74 6167 2827      sf.add_tag('
+0002fae0: 4465 7461 696c 7327 2c20 7264 6343 6f64  Details', rdcCod
+0002faf0: 6529 0a20 2020 2020 2020 2020 2020 2069  e).            i
+0002fb00: 6620 6e6f 7420 7265 706c 6163 6564 3a0a  f not replaced:.
+0002fb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fb20: 7365 6c66 2e5f 5f61 6464 5366 2863 6f6e  self.__addSf(con
+0002fb30: 7374 7261 696e 7454 7970 653d 636f 6e73  straintType=cons
+0002fb40: 7472 6169 6e74 5479 7065 2c20 706f 7465  traintType, pote
+0002fb50: 6e74 6961 6c54 7970 653d 706f 7465 6e74  ntialType=potent
+0002fb60: 6961 6c54 7970 652c 2072 6463 436f 6465  ialType, rdcCode
+0002fb70: 3d72 6463 436f 6465 290a 0a20 2020 2020  =rdcCode)..     
+0002fb80: 2020 2072 6574 7572 6e20 7365 6c66 2e73     return self.s
+0002fb90: 6644 6963 745b 6b65 795d 5b2d 315d 0a0a  fDict[key][-1]..
+0002fba0: 2020 2020 6465 6620 6765 7443 6f6e 7465      def getConte
+0002fbb0: 6e74 5375 6274 7970 6528 7365 6c66 293a  ntSubtype(self):
+0002fbc0: 0a20 2020 2020 2020 2022 2222 2052 6574  .        """ Ret
+0002fbd0: 7572 6e20 636f 6e74 656e 7420 7375 6274  urn content subt
+0002fbe0: 7970 6520 6f66 2052 4f53 4554 5441 204d  ype of ROSETTA M
+0002fbf0: 5220 6669 6c65 2e0a 2020 2020 2020 2020  R file..        
+0002fc00: 2222 220a 0a20 2020 2020 2020 2063 6f6e  """..        con
+0002fc10: 7465 6e74 5375 6274 7970 6520 3d20 7b27  tentSubtype = {'
+0002fc20: 6469 7374 5f72 6573 7472 6169 6e74 273a  dist_restraint':
+0002fc30: 2073 656c 662e 6469 7374 5265 7374 7261   self.distRestra
+0002fc40: 696e 7473 2c0a 2020 2020 2020 2020 2020  ints,.          
 0002fc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fc60: 2020 2020 2020 7366 2e61 6464 5f74 6167        sf.add_tag
-0002fc70: 2827 506f 7465 6e74 6961 6c5f 7479 7065  ('Potential_type
-0002fc80: 272c 2070 6f74 656e 7469 616c 5479 7065  ', potentialType
-0002fc90: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0002fca0: 2020 2020 2020 6966 2072 6463 436f 6465        if rdcCode
-0002fcb0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0002fcc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fcd0: 2020 2020 2020 6964 7820 3d20 6e65 7874        idx = next
-0002fce0: 2828 6964 7820 666f 7220 6964 782c 2074  ((idx for idx, t
-0002fcf0: 2069 6e20 656e 756d 6572 6174 6528 7366   in enumerate(sf
-0002fd00: 2e74 6167 7329 2069 6620 745b 305d 203d  .tags) if t[0] =
-0002fd10: 3d20 2744 6574 6169 6c73 2729 2c20 2d31  = 'Details'), -1
-0002fd20: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0002fd30: 2020 2020 2020 2020 2020 6966 2069 6478            if idx
-0002fd40: 2021 3d20 2d31 3a0a 2020 2020 2020 2020   != -1:.        
+0002fc60: 2761 6e67 5f72 6573 7472 6169 6e74 273a  'ang_restraint':
+0002fc70: 2073 656c 662e 616e 6752 6573 7472 6169   self.angRestrai
+0002fc80: 6e74 732c 0a20 2020 2020 2020 2020 2020  nts,.           
+0002fc90: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0002fca0: 6469 6865 645f 7265 7374 7261 696e 7427  dihed_restraint'
+0002fcb0: 3a20 7365 6c66 2e64 6968 6564 5265 7374  : self.dihedRest
+0002fcc0: 7261 696e 7473 2c0a 2020 2020 2020 2020  raints,.        
+0002fcd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fce0: 2020 2772 6463 5f72 6573 7472 6169 6e74    'rdc_restraint
+0002fcf0: 273a 2073 656c 662e 7264 6352 6573 7472  ': self.rdcRestr
+0002fd00: 6169 6e74 732c 0a20 2020 2020 2020 2020  aints,.         
+0002fd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fd20: 2027 6765 6f5f 7265 7374 7261 696e 7427   'geo_restraint'
+0002fd30: 3a20 7365 6c66 2e67 656f 5265 7374 7261  : self.geoRestra
+0002fd40: 696e 7473 2c0a 2020 2020 2020 2020 2020  ints,.          
 0002fd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fd60: 2020 2020 7366 2e74 6167 735b 6964 785d      sf.tags[idx]
-0002fd70: 5b31 5d20 3d20 7264 6343 6f64 650a 2020  [1] = rdcCode.  
-0002fd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fd90: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0002fda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fdb0: 2020 2020 2020 2020 7366 2e61 6464 5f74          sf.add_t
-0002fdc0: 6167 2827 4465 7461 696c 7327 2c20 7264  ag('Details', rd
-0002fdd0: 6343 6f64 6529 0a20 2020 2020 2020 2020  cCode).         
-0002fde0: 2020 2069 6620 6e6f 7420 7265 706c 6163     if not replac
-0002fdf0: 6564 3a0a 2020 2020 2020 2020 2020 2020  ed:.            
-0002fe00: 2020 2020 7365 6c66 2e5f 5f61 6464 5366      self.__addSf
-0002fe10: 2863 6f6e 7374 7261 696e 7454 7970 653d  (constraintType=
-0002fe20: 636f 6e73 7472 6169 6e74 5479 7065 2c20  constraintType, 
-0002fe30: 706f 7465 6e74 6961 6c54 7970 653d 706f  potentialType=po
-0002fe40: 7465 6e74 6961 6c54 7970 652c 2072 6463  tentialType, rdc
-0002fe50: 436f 6465 3d72 6463 436f 6465 290a 0a20  Code=rdcCode).. 
-0002fe60: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0002fe70: 6c66 2e73 6644 6963 745b 6b65 795d 5b2d  lf.sfDict[key][-
-0002fe80: 315d 0a0a 2020 2020 6465 6620 6765 7443  1]..    def getC
-0002fe90: 6f6e 7465 6e74 5375 6274 7970 6528 7365  ontentSubtype(se
-0002fea0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-0002feb0: 2052 6574 7572 6e20 636f 6e74 656e 7420   Return content 
-0002fec0: 7375 6274 7970 6520 6f66 2052 4f53 4554  subtype of ROSET
-0002fed0: 5441 204d 5220 6669 6c65 2e0a 2020 2020  TA MR file..    
-0002fee0: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-0002fef0: 2063 6f6e 7465 6e74 5375 6274 7970 6520   contentSubtype 
-0002ff00: 3d20 7b27 6469 7374 5f72 6573 7472 6169  = {'dist_restrai
-0002ff10: 6e74 273a 2073 656c 662e 6469 7374 5265  nt': self.distRe
-0002ff20: 7374 7261 696e 7473 2c0a 2020 2020 2020  straints,.      
-0002ff30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ff40: 2020 2020 2761 6e67 5f72 6573 7472 6169      'ang_restrai
-0002ff50: 6e74 273a 2073 656c 662e 616e 6752 6573  nt': self.angRes
-0002ff60: 7472 6169 6e74 732c 0a20 2020 2020 2020  traints,.       
-0002ff70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ff80: 2020 2027 6469 6865 645f 7265 7374 7261     'dihed_restra
-0002ff90: 696e 7427 3a20 7365 6c66 2e64 6968 6564  int': self.dihed
-0002ffa0: 5265 7374 7261 696e 7473 2c0a 2020 2020  Restraints,.    
-0002ffb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ffc0: 2020 2020 2020 2772 6463 5f72 6573 7472        'rdc_restr
-0002ffd0: 6169 6e74 273a 2073 656c 662e 7264 6352  aint': self.rdcR
-0002ffe0: 6573 7472 6169 6e74 732c 0a20 2020 2020  estraints,.     
-0002fff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030000: 2020 2020 2027 6765 6f5f 7265 7374 7261       'geo_restra
-00030010: 696e 7427 3a20 7365 6c66 2e67 656f 5265  int': self.geoRe
-00030020: 7374 7261 696e 7473 2c0a 2020 2020 2020  straints,.      
-00030030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030040: 2020 2020 2773 7362 6f6e 645f 7265 7374      'ssbond_rest
-00030050: 7261 696e 7427 3a20 7365 6c66 2e73 7362  raint': self.ssb
-00030060: 6f6e 6452 6573 7472 6169 6e74 730a 2020  ondRestraints.  
-00030070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030080: 2020 2020 2020 2020 7d0a 0a20 2020 2020          }..     
-00030090: 2020 2072 6574 7572 6e20 7b6b 3a20 3120     return {k: 1 
-000300a0: 666f 7220 6b2c 2076 2069 6e20 636f 6e74  for k, v in cont
-000300b0: 656e 7453 7562 7479 7065 2e69 7465 6d73  entSubtype.items
-000300c0: 2829 2069 6620 7620 3e20 307d 0a0a 2020  () if v > 0}..  
-000300d0: 2020 6465 6620 6765 7445 6666 6563 7469    def getEffecti
-000300e0: 7665 436f 6e74 656e 7453 7562 7479 7065  veContentSubtype
-000300f0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00030100: 2222 2220 5265 7475 726e 2065 6666 6563  """ Return effec
-00030110: 7469 7665 2063 6f6e 7465 6e74 2073 7562  tive content sub
-00030120: 7479 7065 206f 6620 524f 5345 5454 4120  type of ROSETTA 
-00030130: 4d52 2066 696c 6520 2865 7863 6c75 6469  MR file (excludi
-00030140: 6e67 2043 532d 524f 5345 5454 4129 2e0a  ng CS-ROSETTA)..
-00030150: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
-00030160: 2020 2020 2063 6f6e 7465 6e74 5375 6274       contentSubt
-00030170: 7970 6520 3d20 7b27 6469 7374 5f72 6573  ype = {'dist_res
-00030180: 7472 6169 6e74 273a 2073 656c 662e 6469  traint': self.di
-00030190: 7374 5265 7374 7261 696e 7473 2c0a 2020  stRestraints,.  
-000301a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000301b0: 2020 2020 2020 2020 2761 6e67 5f72 6573          'ang_res
-000301c0: 7472 6169 6e74 273a 2073 656c 662e 616e  traint': self.an
-000301d0: 6752 6573 7472 6169 6e74 732c 0a20 2020  gRestraints,.   
-000301e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000301f0: 2020 2020 2020 2027 6469 6865 645f 7265         'dihed_re
-00030200: 7374 7261 696e 7427 3a20 7365 6c66 2e64  straint': self.d
-00030210: 6968 6564 5265 7374 7261 696e 7473 0a20  ihedRestraints. 
-00030220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030230: 2020 2020 2020 2020 207d 0a0a 2020 2020           }..    
-00030240: 2020 2020 7265 7475 726e 207b 6b3a 2031      return {k: 1
-00030250: 2066 6f72 206b 2c20 7620 696e 2063 6f6e   for k, v in con
-00030260: 7465 6e74 5375 6274 7970 652e 6974 656d  tentSubtype.item
-00030270: 7328 2920 6966 2076 203e 2030 7d0a 0a20  s() if v > 0}.. 
-00030280: 2020 2064 6566 2067 6574 506f 6c79 6d65     def getPolyme
-00030290: 7253 6571 7565 6e63 6528 7365 6c66 293a  rSequence(self):
-000302a0: 0a20 2020 2020 2020 2022 2222 2052 6574  .        """ Ret
-000302b0: 7572 6e20 706f 6c79 6d65 7220 7365 7175  urn polymer sequ
-000302c0: 656e 6365 206f 6620 524f 5345 5454 4120  ence of ROSETTA 
-000302d0: 4d52 2066 696c 652e 0a20 2020 2020 2020  MR file..       
-000302e0: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
-000302f0: 7572 6e20 4e6f 6e65 2069 6620 7365 6c66  urn None if self
-00030300: 2e5f 5f70 6f6c 7953 6571 5273 7420 6973  .__polySeqRst is
-00030310: 204e 6f6e 6520 6f72 206c 656e 2873 656c   None or len(sel
-00030320: 662e 5f5f 706f 6c79 5365 7152 7374 2920  f.__polySeqRst) 
-00030330: 3d3d 2030 2065 6c73 6520 7365 6c66 2e5f  == 0 else self._
-00030340: 5f70 6f6c 7953 6571 5273 740a 0a20 2020  _polySeqRst..   
-00030350: 2064 6566 2067 6574 5365 7175 656e 6365   def getSequence
-00030360: 416c 6967 6e6d 656e 7428 7365 6c66 293a  Alignment(self):
-00030370: 0a20 2020 2020 2020 2022 2222 2052 6574  .        """ Ret
-00030380: 7572 6e20 7365 7175 656e 6365 2061 6c69  urn sequence ali
-00030390: 676e 6d65 6e74 2062 6574 7765 656e 2063  gnment between c
-000303a0: 6f6f 7264 696e 6174 6573 2061 6e64 2052  oordinates and R
-000303b0: 4f53 4554 5441 204d 522e 0a20 2020 2020  OSETTA MR..     
-000303c0: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
-000303d0: 6574 7572 6e20 4e6f 6e65 2069 6620 7365  eturn None if se
-000303e0: 6c66 2e5f 5f73 6571 416c 6967 6e20 6973  lf.__seqAlign is
-000303f0: 204e 6f6e 6520 6f72 206c 656e 2873 656c   None or len(sel
-00030400: 662e 5f5f 7365 7141 6c69 676e 2920 3d3d  f.__seqAlign) ==
-00030410: 2030 2065 6c73 6520 7365 6c66 2e5f 5f73   0 else self.__s
-00030420: 6571 416c 6967 6e0a 0a20 2020 2064 6566  eqAlign..    def
-00030430: 2067 6574 4368 6169 6e41 7373 6967 6e6d   getChainAssignm
-00030440: 656e 7428 7365 6c66 293a 0a20 2020 2020  ent(self):.     
-00030450: 2020 2022 2222 2052 6574 7572 6e20 6368     """ Return ch
-00030460: 6169 6e20 6173 7369 676e 6d65 6e74 2062  ain assignment b
-00030470: 6574 7765 656e 2063 6f6f 7264 696e 6174  etween coordinat
-00030480: 6573 2061 6e64 2052 4f53 4554 5441 204d  es and ROSETTA M
-00030490: 522e 0a20 2020 2020 2020 2022 2222 0a20  R..        """. 
-000304a0: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
-000304b0: 6e65 2069 6620 7365 6c66 2e5f 5f63 6861  ne if self.__cha
-000304c0: 696e 4173 7369 676e 2069 7320 4e6f 6e65  inAssign is None
-000304d0: 206f 7220 6c65 6e28 7365 6c66 2e5f 5f63   or len(self.__c
-000304e0: 6861 696e 4173 7369 676e 2920 3d3d 2030  hainAssign) == 0
-000304f0: 2065 6c73 6520 7365 6c66 2e5f 5f63 6861   else self.__cha
-00030500: 696e 4173 7369 676e 0a0a 2020 2020 6465  inAssign..    de
-00030510: 6620 6765 7452 6561 736f 6e73 466f 7252  f getReasonsForR
-00030520: 6570 6172 7369 6e67 2873 656c 6629 3a0a  eparsing(self):.
-00030530: 2020 2020 2020 2020 2222 2220 5265 7475          """ Retu
-00030540: 726e 2072 6561 736f 6e73 2066 6f72 2072  rn reasons for r
-00030550: 652d 7061 7273 696e 6720 524f 5345 5454  e-parsing ROSETT
-00030560: 4120 4d52 2066 696c 652e 0a20 2020 2020  A MR file..     
-00030570: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
-00030580: 6574 7572 6e20 4e6f 6e65 2069 6620 6c65  eturn None if le
-00030590: 6e28 7365 6c66 2e72 6561 736f 6e73 466f  n(self.reasonsFo
-000305a0: 7252 6550 6172 7369 6e67 2920 3d3d 2030  rReParsing) == 0
-000305b0: 2065 6c73 6520 7365 6c66 2e72 6561 736f   else self.reaso
-000305c0: 6e73 466f 7252 6550 6172 7369 6e67 0a0a  nsForReParsing..
-000305d0: 2020 2020 6465 6620 6765 7453 6644 6963      def getSfDic
-000305e0: 7428 7365 6c66 293a 0a20 2020 2020 2020  t(self):.       
-000305f0: 2022 2222 2052 6574 7572 6e20 6120 6469   """ Return a di
-00030600: 6374 696f 6e61 7279 206f 6620 7079 6e6d  ctionary of pynm
-00030610: 7273 7461 7220 7361 7665 6672 616d 6573  rstar saveframes
-00030620: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00030630: 2020 2020 2020 6966 206c 656e 2873 656c        if len(sel
-00030640: 662e 7366 4469 6374 2920 3d3d 2030 3a0a  f.sfDict) == 0:.
-00030650: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00030660: 726e 2073 656c 662e 5f5f 6c69 7374 4964  rn self.__listId
-00030670: 436f 756e 7465 722c 204e 6f6e 650a 2020  Counter, None.  
-00030680: 2020 2020 2020 6967 6e5f 6b65 7973 203d        ign_keys =
-00030690: 205b 5d0a 2020 2020 2020 2020 666f 7220   [].        for 
-000306a0: 6b2c 2076 2069 6e20 7365 6c66 2e73 6644  k, v in self.sfD
-000306b0: 6963 742e 6974 656d 7328 293a 0a20 2020  ict.items():.   
-000306c0: 2020 2020 2020 2020 2066 6f72 2069 7465           for ite
-000306d0: 6d20 696e 2072 6576 6572 7365 6428 7629  m in reversed(v)
-000306e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000306f0: 2020 6966 2069 7465 6d5b 2769 6e64 6578    if item['index
-00030700: 5f69 6427 5d20 3d3d 2030 3a0a 2020 2020  _id'] == 0:.    
-00030710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030720: 762e 7265 6d6f 7665 2869 7465 6d29 0a20  v.remove(item). 
-00030730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030740: 2020 2069 6620 6c65 6e28 7629 203d 3d20     if len(v) == 
-00030750: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-00030760: 2020 2020 2020 2020 2020 2069 676e 5f6b             ign_k
-00030770: 6579 732e 6170 7065 6e64 286b 290a 2020  eys.append(k).  
-00030780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030790: 2020 7365 6c66 2e5f 5f6c 6973 7449 6443    self.__listIdC
-000307a0: 6f75 6e74 6572 203d 2064 6563 4c69 7374  ounter = decList
-000307b0: 4964 436f 756e 7465 7228 6b5b 305d 2c20  IdCounter(k[0], 
-000307c0: 7365 6c66 2e5f 5f6c 6973 7449 6443 6f75  self.__listIdCou
-000307d0: 6e74 6572 290a 2020 2020 2020 2020 666f  nter).        fo
-000307e0: 7220 6b20 696e 2069 676e 5f6b 6579 733a  r k in ign_keys:
-000307f0: 0a20 2020 2020 2020 2020 2020 2064 656c  .            del
-00030800: 2073 656c 662e 7366 4469 6374 5b6b 5d0a   self.sfDict[k].
-00030810: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00030820: 656c 662e 5f5f 6c69 7374 4964 436f 756e  elf.__listIdCoun
-00030830: 7465 722c 204e 6f6e 6520 6966 206c 656e  ter, None if len
-00030840: 2873 656c 662e 7366 4469 6374 2920 3d3d  (self.sfDict) ==
-00030850: 2030 2065 6c73 6520 7365 6c66 2e73 6644   0 else self.sfD
-00030860: 6963 740a 0a23 2064 656c 2052 6f73 6574  ict..# del Roset
-00030870: 7461 4d52 5061 7273 6572 0a              taMRParser.
+0002fd60: 2773 7362 6f6e 645f 7265 7374 7261 696e  'ssbond_restrain
+0002fd70: 7427 3a20 7365 6c66 2e73 7362 6f6e 6452  t': self.ssbondR
+0002fd80: 6573 7472 6169 6e74 730a 2020 2020 2020  estraints.      
+0002fd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fda0: 2020 2020 7d0a 0a20 2020 2020 2020 2072      }..        r
+0002fdb0: 6574 7572 6e20 7b6b 3a20 3120 666f 7220  eturn {k: 1 for 
+0002fdc0: 6b2c 2076 2069 6e20 636f 6e74 656e 7453  k, v in contentS
+0002fdd0: 7562 7479 7065 2e69 7465 6d73 2829 2069  ubtype.items() i
+0002fde0: 6620 7620 3e20 307d 0a0a 2020 2020 6465  f v > 0}..    de
+0002fdf0: 6620 6765 7445 6666 6563 7469 7665 436f  f getEffectiveCo
+0002fe00: 6e74 656e 7453 7562 7479 7065 2873 656c  ntentSubtype(sel
+0002fe10: 6629 3a0a 2020 2020 2020 2020 2222 2220  f):.        """ 
+0002fe20: 5265 7475 726e 2065 6666 6563 7469 7665  Return effective
+0002fe30: 2063 6f6e 7465 6e74 2073 7562 7479 7065   content subtype
+0002fe40: 206f 6620 524f 5345 5454 4120 4d52 2066   of ROSETTA MR f
+0002fe50: 696c 6520 2865 7863 6c75 6469 6e67 2043  ile (excluding C
+0002fe60: 532d 524f 5345 5454 4129 2e0a 2020 2020  S-ROSETTA)..    
+0002fe70: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+0002fe80: 2063 6f6e 7465 6e74 5375 6274 7970 6520   contentSubtype 
+0002fe90: 3d20 7b27 6469 7374 5f72 6573 7472 6169  = {'dist_restrai
+0002fea0: 6e74 273a 2073 656c 662e 6469 7374 5265  nt': self.distRe
+0002feb0: 7374 7261 696e 7473 2c0a 2020 2020 2020  straints,.      
+0002fec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fed0: 2020 2020 2761 6e67 5f72 6573 7472 6169      'ang_restrai
+0002fee0: 6e74 273a 2073 656c 662e 616e 6752 6573  nt': self.angRes
+0002fef0: 7472 6169 6e74 732c 0a20 2020 2020 2020  traints,.       
+0002ff00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ff10: 2020 2027 6469 6865 645f 7265 7374 7261     'dihed_restra
+0002ff20: 696e 7427 3a20 7365 6c66 2e64 6968 6564  int': self.dihed
+0002ff30: 5265 7374 7261 696e 7473 0a20 2020 2020  Restraints.     
+0002ff40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ff50: 2020 2020 207d 0a0a 2020 2020 2020 2020       }..        
+0002ff60: 7265 7475 726e 207b 6b3a 2031 2066 6f72  return {k: 1 for
+0002ff70: 206b 2c20 7620 696e 2063 6f6e 7465 6e74   k, v in content
+0002ff80: 5375 6274 7970 652e 6974 656d 7328 2920  Subtype.items() 
+0002ff90: 6966 2076 203e 2030 7d0a 0a20 2020 2064  if v > 0}..    d
+0002ffa0: 6566 2067 6574 506f 6c79 6d65 7253 6571  ef getPolymerSeq
+0002ffb0: 7565 6e63 6528 7365 6c66 293a 0a20 2020  uence(self):.   
+0002ffc0: 2020 2020 2022 2222 2052 6574 7572 6e20       """ Return 
+0002ffd0: 706f 6c79 6d65 7220 7365 7175 656e 6365  polymer sequence
+0002ffe0: 206f 6620 524f 5345 5454 4120 4d52 2066   of ROSETTA MR f
+0002fff0: 696c 652e 0a20 2020 2020 2020 2022 2222  ile..        """
+00030000: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00030010: 4e6f 6e65 2069 6620 7365 6c66 2e5f 5f70  None if self.__p
+00030020: 6f6c 7953 6571 5273 7420 6973 204e 6f6e  olySeqRst is Non
+00030030: 6520 6f72 206c 656e 2873 656c 662e 5f5f  e or len(self.__
+00030040: 706f 6c79 5365 7152 7374 2920 3d3d 2030  polySeqRst) == 0
+00030050: 2065 6c73 6520 7365 6c66 2e5f 5f70 6f6c   else self.__pol
+00030060: 7953 6571 5273 740a 0a20 2020 2064 6566  ySeqRst..    def
+00030070: 2067 6574 5365 7175 656e 6365 416c 6967   getSequenceAlig
+00030080: 6e6d 656e 7428 7365 6c66 293a 0a20 2020  nment(self):.   
+00030090: 2020 2020 2022 2222 2052 6574 7572 6e20       """ Return 
+000300a0: 7365 7175 656e 6365 2061 6c69 676e 6d65  sequence alignme
+000300b0: 6e74 2062 6574 7765 656e 2063 6f6f 7264  nt between coord
+000300c0: 696e 6174 6573 2061 6e64 2052 4f53 4554  inates and ROSET
+000300d0: 5441 204d 522e 0a20 2020 2020 2020 2022  TA MR..        "
+000300e0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+000300f0: 6e20 4e6f 6e65 2069 6620 7365 6c66 2e5f  n None if self._
+00030100: 5f73 6571 416c 6967 6e20 6973 204e 6f6e  _seqAlign is Non
+00030110: 6520 6f72 206c 656e 2873 656c 662e 5f5f  e or len(self.__
+00030120: 7365 7141 6c69 676e 2920 3d3d 2030 2065  seqAlign) == 0 e
+00030130: 6c73 6520 7365 6c66 2e5f 5f73 6571 416c  lse self.__seqAl
+00030140: 6967 6e0a 0a20 2020 2064 6566 2067 6574  ign..    def get
+00030150: 4368 6169 6e41 7373 6967 6e6d 656e 7428  ChainAssignment(
+00030160: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+00030170: 2222 2052 6574 7572 6e20 6368 6169 6e20  "" Return chain 
+00030180: 6173 7369 676e 6d65 6e74 2062 6574 7765  assignment betwe
+00030190: 656e 2063 6f6f 7264 696e 6174 6573 2061  en coordinates a
+000301a0: 6e64 2052 4f53 4554 5441 204d 522e 0a20  nd ROSETTA MR.. 
+000301b0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000301c0: 2020 2072 6574 7572 6e20 4e6f 6e65 2069     return None i
+000301d0: 6620 7365 6c66 2e5f 5f63 6861 696e 4173  f self.__chainAs
+000301e0: 7369 676e 2069 7320 4e6f 6e65 206f 7220  sign is None or 
+000301f0: 6c65 6e28 7365 6c66 2e5f 5f63 6861 696e  len(self.__chain
+00030200: 4173 7369 676e 2920 3d3d 2030 2065 6c73  Assign) == 0 els
+00030210: 6520 7365 6c66 2e5f 5f63 6861 696e 4173  e self.__chainAs
+00030220: 7369 676e 0a0a 2020 2020 6465 6620 6765  sign..    def ge
+00030230: 7452 6561 736f 6e73 466f 7252 6570 6172  tReasonsForRepar
+00030240: 7369 6e67 2873 656c 6629 3a0a 2020 2020  sing(self):.    
+00030250: 2020 2020 2222 2220 5265 7475 726e 2072      """ Return r
+00030260: 6561 736f 6e73 2066 6f72 2072 652d 7061  easons for re-pa
+00030270: 7273 696e 6720 524f 5345 5454 4120 4d52  rsing ROSETTA MR
+00030280: 2066 696c 652e 0a20 2020 2020 2020 2022   file..        "
+00030290: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+000302a0: 6e20 4e6f 6e65 2069 6620 6c65 6e28 7365  n None if len(se
+000302b0: 6c66 2e72 6561 736f 6e73 466f 7252 6550  lf.reasonsForReP
+000302c0: 6172 7369 6e67 2920 3d3d 2030 2065 6c73  arsing) == 0 els
+000302d0: 6520 7365 6c66 2e72 6561 736f 6e73 466f  e self.reasonsFo
+000302e0: 7252 6550 6172 7369 6e67 0a0a 2020 2020  rReParsing..    
+000302f0: 6465 6620 6765 7453 6644 6963 7428 7365  def getSfDict(se
+00030300: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00030310: 2052 6574 7572 6e20 6120 6469 6374 696f   Return a dictio
+00030320: 6e61 7279 206f 6620 7079 6e6d 7273 7461  nary of pynmrsta
+00030330: 7220 7361 7665 6672 616d 6573 2e0a 2020  r saveframes..  
+00030340: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00030350: 2020 6966 206c 656e 2873 656c 662e 7366    if len(self.sf
+00030360: 4469 6374 2920 3d3d 2030 3a0a 2020 2020  Dict) == 0:.    
+00030370: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00030380: 656c 662e 5f5f 6c69 7374 4964 436f 756e  elf.__listIdCoun
+00030390: 7465 722c 204e 6f6e 650a 2020 2020 2020  ter, None.      
+000303a0: 2020 6967 6e5f 6b65 7973 203d 205b 5d0a    ign_keys = [].
+000303b0: 2020 2020 2020 2020 666f 7220 6b2c 2076          for k, v
+000303c0: 2069 6e20 7365 6c66 2e73 6644 6963 742e   in self.sfDict.
+000303d0: 6974 656d 7328 293a 0a20 2020 2020 2020  items():.       
+000303e0: 2020 2020 2066 6f72 2069 7465 6d20 696e       for item in
+000303f0: 2072 6576 6572 7365 6428 7629 3a0a 2020   reversed(v):.  
+00030400: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00030410: 2069 7465 6d5b 2769 6e64 6578 5f69 6427   item['index_id'
+00030420: 5d20 3d3d 2030 3a0a 2020 2020 2020 2020  ] == 0:.        
+00030430: 2020 2020 2020 2020 2020 2020 762e 7265              v.re
+00030440: 6d6f 7665 2869 7465 6d29 0a20 2020 2020  move(item).     
+00030450: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00030460: 6620 6c65 6e28 7629 203d 3d20 303a 0a20  f len(v) == 0:. 
+00030470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030480: 2020 2020 2020 2069 676e 5f6b 6579 732e         ign_keys.
+00030490: 6170 7065 6e64 286b 290a 2020 2020 2020  append(k).      
+000304a0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000304b0: 6c66 2e5f 5f6c 6973 7449 6443 6f75 6e74  lf.__listIdCount
+000304c0: 6572 203d 2064 6563 4c69 7374 4964 436f  er = decListIdCo
+000304d0: 756e 7465 7228 6b5b 305d 2c20 7365 6c66  unter(k[0], self
+000304e0: 2e5f 5f6c 6973 7449 6443 6f75 6e74 6572  .__listIdCounter
+000304f0: 290a 2020 2020 2020 2020 666f 7220 6b20  ).        for k 
+00030500: 696e 2069 676e 5f6b 6579 733a 0a20 2020  in ign_keys:.   
+00030510: 2020 2020 2020 2020 2064 656c 2073 656c           del sel
+00030520: 662e 7366 4469 6374 5b6b 5d0a 2020 2020  f.sfDict[k].    
+00030530: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00030540: 5f5f 6c69 7374 4964 436f 756e 7465 722c  __listIdCounter,
+00030550: 204e 6f6e 6520 6966 206c 656e 2873 656c   None if len(sel
+00030560: 662e 7366 4469 6374 2920 3d3d 2030 2065  f.sfDict) == 0 e
+00030570: 6c73 6520 7365 6c66 2e73 6644 6963 740a  lse self.sfDict.
+00030580: 0a23 2064 656c 2052 6f73 6574 7461 4d52  .# del RosettaMR
+00030590: 5061 7273 6572 0a                        Parser.
```

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/RosettaMRReader.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/RosettaMRReader.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/SybylMRLexer.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/SybylMRLexer.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/SybylMRParser.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/SybylMRParser.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/SybylMRParserListener.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/SybylMRParserListener.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/SybylMRReader.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/SybylMRReader.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/XplorMRLexer.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/XplorMRLexer.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/XplorMRParser.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/XplorMRParser.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/XplorMRParserListener.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/XplorMRParserListener.py`

 * *Files 0% similar despite different names*

```diff
@@ -28950,12003 +28950,12042 @@
 00071150: 5d20 3d20 5f63 6f6f 7264 4174 6f6d 5369  ] = _coordAtomSi
 00071160: 7465 5b27 7479 7065 5f73 796d 626f 6c27  te['type_symbol'
 00071170: 5d5b 5f63 6f6f 7264 4174 6f6d 5369 7465  ][_coordAtomSite
 00071180: 5b27 6174 6f6d 5f69 6427 5d2e 696e 6465  ['atom_id'].inde
 00071190: 7828 5f61 746f 6d49 6429 5d0a 2020 2020  x(_atomId)].    
 000711a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000711b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000711c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000711d0: 2e5f 5f70 7265 6665 7241 7574 6853 6571  .__preferAuthSeq
-000711e0: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
+000711c0: 2020 2020 2020 2020 2020 2020 2222 220a              """.
+000711d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000711e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000711f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071210: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
-00071220: 6175 7468 5365 7149 6420 3d20 276c 6162  authSeqId = 'lab
-00071230: 656c 5f73 6571 5f69 6427 0a20 2020 2020  el_seq_id'.     
-00071240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071260: 2020 2020 2020 2020 2020 2073 6571 4b65             seqKe
-00071270: 7920 3d20 5f73 6571 4b65 790a 2020 2020  y = _seqKey.    
+00071200: 7365 6c66 2e5f 5f70 7265 6665 7241 7574  self.__preferAut
+00071210: 6853 6571 203d 2046 616c 7365 0a20 2020  hSeq = False.   
+00071220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071240: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00071250: 662e 5f5f 6175 7468 5365 7149 6420 3d20  f.__authSeqId = 
+00071260: 276c 6162 656c 5f73 6571 5f69 6427 0a20  'label_seq_id'. 
+00071270: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00071280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000712a0: 2020 2020 2020 2020 2020 2020 6368 6169              chai
-000712b0: 6e49 642c 2073 6571 4964 203d 2073 6571  nId, seqId = seq
-000712c0: 4b65 790a 2020 2020 2020 2020 2020 2020  Key.            
+00071290: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000712a0: 6571 4b65 7920 3d20 5f73 6571 4b65 790a  eqKey = _seqKey.
+000712b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000712c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000712d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000712e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000712f0: 2020 2020 6966 206c 656e 2873 656c 662e      if len(self.
-00071300: 6174 6f6d 5365 6c65 6374 696f 6e53 6574  atomSelectionSet
-00071310: 2920 3e20 303a 0a20 2020 2020 2020 2020  ) > 0:.         
-00071320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071340: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00071350: 5f5f 7365 744c 6f63 616c 5365 7153 6368  __setLocalSeqSch
-00071360: 656d 6528 290a 2020 2020 2020 2020 2020  eme().          
-00071370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071390: 2020 656c 6966 2027 616c 745f 6174 6f6d    elif 'alt_atom
-000713a0: 5f69 6427 2069 6e20 5f63 6f6f 7264 4174  _id' in _coordAt
-000713b0: 6f6d 5369 7465 2061 6e64 205f 6174 6f6d  omSite and _atom
-000713c0: 4964 2069 6e20 5f63 6f6f 7264 4174 6f6d  Id in _coordAtom
-000713d0: 5369 7465 5b27 616c 745f 6174 6f6d 5f69  Site['alt_atom_i
-000713e0: 6427 5d3a 0a20 2020 2020 2020 2020 2020  d']:.           
-000713f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071410: 2020 2020 205f 6174 6f6d 203d 207b 7d0a       _atom = {}.
-00071420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071450: 5f61 746f 6d5b 2763 6f6d 705f 6964 275d  _atom['comp_id']
-00071460: 203d 205f 636f 6d70 4964 0a20 2020 2020   = _compId.     
-00071470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071490: 2020 2020 2020 2020 2020 205f 6174 6f6d             _atom
-000714a0: 5b27 7479 7065 5f73 796d 626f 6c27 5d20  ['type_symbol'] 
-000714b0: 3d20 5f63 6f6f 7264 4174 6f6d 5369 7465  = _coordAtomSite
-000714c0: 5b27 7479 7065 5f73 796d 626f 6c27 5d5b  ['type_symbol'][
-000714d0: 5f63 6f6f 7264 4174 6f6d 5369 7465 5b27  _coordAtomSite['
-000714e0: 616c 745f 6174 6f6d 5f69 6427 5d2e 696e  alt_atom_id'].in
-000714f0: 6465 7828 5f61 746f 6d49 6429 5d0a 2020  dex(_atomId)].  
-00071500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071520: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00071530: 6c66 2e5f 5f70 7265 6665 7241 7574 6853  lf.__preferAuthS
-00071540: 6571 203d 2046 616c 7365 0a20 2020 2020  eq = False.     
-00071550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071570: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00071580: 5f5f 6175 7468 5365 7149 6420 3d20 276c  __authSeqId = 'l
-00071590: 6162 656c 5f73 6571 5f69 6427 0a20 2020  abel_seq_id'.   
+000712e0: 6368 6169 6e49 642c 2073 6571 4964 203d  chainId, seqId =
+000712f0: 2073 6571 4b65 790a 2020 2020 2020 2020   seqKey.        
+00071300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071320: 2020 2020 2020 2020 6966 206c 656e 2873          if len(s
+00071330: 656c 662e 6174 6f6d 5365 6c65 6374 696f  elf.atomSelectio
+00071340: 6e53 6574 2920 3e20 303a 0a20 2020 2020  nSet) > 0:.     
+00071350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071370: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00071380: 656c 662e 5f5f 7365 744c 6f63 616c 5365  elf.__setLocalSe
+00071390: 7153 6368 656d 6528 290a 2020 2020 2020  qScheme().      
+000713a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000713b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000713c0: 2020 2020 2020 2020 2020 2222 220a 2020            """.  
+000713d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000713e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000713f0: 2020 2020 2020 2020 2020 656c 6966 2027            elif '
+00071400: 616c 745f 6174 6f6d 5f69 6427 2069 6e20  alt_atom_id' in 
+00071410: 5f63 6f6f 7264 4174 6f6d 5369 7465 2061  _coordAtomSite a
+00071420: 6e64 205f 6174 6f6d 4964 2069 6e20 5f63  nd _atomId in _c
+00071430: 6f6f 7264 4174 6f6d 5369 7465 5b27 616c  oordAtomSite['al
+00071440: 745f 6174 6f6d 5f69 6427 5d3a 0a20 2020  t_atom_id']:.   
+00071450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071470: 2020 2020 2020 2020 2020 2020 205f 6174               _at
+00071480: 6f6d 203d 207b 7d0a 2020 2020 2020 2020  om = {}.        
+00071490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000714a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000714b0: 2020 2020 2020 2020 5f61 746f 6d5b 2763          _atom['c
+000714c0: 6f6d 705f 6964 275d 203d 205f 636f 6d70  omp_id'] = _comp
+000714d0: 4964 0a20 2020 2020 2020 2020 2020 2020  Id.             
+000714e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000714f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071500: 2020 205f 6174 6f6d 5b27 7479 7065 5f73     _atom['type_s
+00071510: 796d 626f 6c27 5d20 3d20 5f63 6f6f 7264  ymbol'] = _coord
+00071520: 4174 6f6d 5369 7465 5b27 7479 7065 5f73  AtomSite['type_s
+00071530: 796d 626f 6c27 5d5b 5f63 6f6f 7264 4174  ymbol'][_coordAt
+00071540: 6f6d 5369 7465 5b27 616c 745f 6174 6f6d  omSite['alt_atom
+00071550: 5f69 6427 5d2e 696e 6465 7828 5f61 746f  _id'].index(_ato
+00071560: 6d49 6429 5d0a 2020 2020 2020 2020 2020  mId)].          
+00071570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071590: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
 000715a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000715b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000715c0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-000715d0: 662e 5f5f 6175 7468 4174 6f6d 4964 203d  f.__authAtomId =
-000715e0: 2027 6175 7468 5f61 746f 6d5f 6964 270a   'auth_atom_id'.
+000715c0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+000715d0: 5f70 7265 6665 7241 7574 6853 6571 203d  _preferAuthSeq =
+000715e0: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
 000715f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00071600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071620: 7365 714b 6579 203d 205f 7365 714b 6579  seqKey = _seqKey
-00071630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00071610: 2020 2020 2020 2073 656c 662e 5f5f 6175         self.__au
+00071620: 7468 5365 7149 6420 3d20 276c 6162 656c  thSeqId = 'label
+00071630: 5f73 6571 5f69 6427 0a20 2020 2020 2020  _seq_id'.       
 00071640: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00071650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071660: 2063 6861 696e 4964 2c20 7365 7149 6420   chainId, seqId 
-00071670: 3d20 7365 714b 6579 0a20 2020 2020 2020  = seqKey.       
-00071680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071660: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
+00071670: 6175 7468 4174 6f6d 4964 203d 2027 6175  authAtomId = 'au
+00071680: 7468 5f61 746f 6d5f 6964 270a 2020 2020  th_atom_id'.    
 00071690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000716a0: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
-000716b0: 7365 6c66 2e61 746f 6d53 656c 6563 7469  self.atomSelecti
-000716c0: 6f6e 5365 7429 203e 2030 3a0a 2020 2020  onSet) > 0:.    
+000716a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000716b0: 2020 2020 2020 2020 2020 2020 7365 714b              seqK
+000716c0: 6579 203d 205f 7365 714b 6579 0a20 2020  ey = _seqKey.   
 000716d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000716e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000716f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071700: 7365 6c66 2e5f 5f73 6574 4c6f 6361 6c53  self.__setLocalS
-00071710: 6571 5363 6865 6d65 2829 0a20 2020 2020  eqScheme().     
+000716f0: 2020 2020 2020 2020 2020 2020 2063 6861               cha
+00071700: 696e 4964 2c20 7365 7149 6420 3d20 7365  inId, seqId = se
+00071710: 714b 6579 0a20 2020 2020 2020 2020 2020  qKey.           
 00071720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071730: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00071740: 6c69 6620 5f73 6571 4964 5f20 696e 2070  lif _seqId_ in p
-00071750: 735b 2761 7574 685f 7365 715f 6964 275d  s['auth_seq_id']
-00071760: 2061 6e64 2061 746f 6d53 7065 6369 6669   and atomSpecifi
-00071770: 6564 3a0a 2020 2020 2020 2020 2020 2020  ed:.            
+00071730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071740: 2020 2020 2069 6620 6c65 6e28 7365 6c66       if len(self
+00071750: 2e61 746f 6d53 656c 6563 7469 6f6e 5365  .atomSelectionSe
+00071760: 7429 203e 2030 3a0a 2020 2020 2020 2020  t) > 0:.        
+00071770: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00071780: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00071790: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000717a0: 2e5f 5f70 7265 6665 7241 7574 6853 6571  .__preferAuthSeq
-000717b0: 203d 2054 7275 650a 2020 2020 2020 2020   = True.        
+000717a0: 2e5f 5f73 6574 4c6f 6361 6c53 6571 5363  .__setLocalSeqSc
+000717b0: 6865 6d65 2829 0a20 2020 2020 2020 2020  heme().         
 000717c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000717d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000717e0: 5f73 6571 4b65 792c 205f 636f 6f72 6441  _seqKey, _coordA
-000717f0: 746f 6d53 6974 6520 3d20 7365 6c66 2e67  tomSite = self.g
-00071800: 6574 436f 6f72 6441 746f 6d53 6974 654f  etCoordAtomSiteO
-00071810: 6628 6368 6169 6e49 642c 205f 7365 7149  f(chainId, _seqI
-00071820: 645f 2c20 6369 6643 6865 636b 290a 2020  d_, cifCheck).  
-00071830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071850: 2020 2020 2020 6966 205f 636f 6f72 6441        if _coordA
-00071860: 746f 6d53 6974 6520 6973 206e 6f74 204e  tomSite is not N
-00071870: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00071880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000717e0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000717f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071800: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00071810: 6c69 6620 5f73 6571 4964 5f20 696e 2070  lif _seqId_ in p
+00071820: 735b 2761 7574 685f 7365 715f 6964 275d  s['auth_seq_id']
+00071830: 2061 6e64 2061 746f 6d53 7065 6369 6669   and atomSpecifi
+00071840: 6564 3a0a 2020 2020 2020 2020 2020 2020  ed:.            
+00071850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071860: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00071870: 2e5f 5f70 7265 6665 7241 7574 6853 6571  .__preferAuthSeq
+00071880: 203d 2054 7275 650a 2020 2020 2020 2020   = True.        
 00071890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000718a0: 205f 636f 6d70 4964 203d 205f 636f 6f72   _compId = _coor
-000718b0: 6441 746f 6d53 6974 655b 2763 6f6d 705f  dAtomSite['comp_
-000718c0: 6964 275d 0a20 2020 2020 2020 2020 2020  id'].           
-000718d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000718e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000718f0: 205f 6174 6f6d 4964 203d 2073 656c 662e   _atomId = self.
-00071900: 6765 7441 746f 6d49 644c 6973 7428 5f66  getAtomIdList(_f
-00071910: 6163 746f 722c 205f 636f 6d70 4964 2c20  actor, _compId, 
-00071920: 6174 6f6d 4964 295b 305d 0a20 2020 2020  atomId)[0].     
-00071930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071950: 2020 2020 2020 2069 6620 5f61 746f 6d49         if _atomI
-00071960: 6420 696e 205f 636f 6f72 6441 746f 6d53  d in _coordAtomS
-00071970: 6974 655b 2761 746f 6d5f 6964 275d 3a0a  ite['atom_id']:.
-00071980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000718a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000718b0: 5f73 6571 4b65 792c 205f 636f 6f72 6441  _seqKey, _coordA
+000718c0: 746f 6d53 6974 6520 3d20 7365 6c66 2e67  tomSite = self.g
+000718d0: 6574 436f 6f72 6441 746f 6d53 6974 654f  etCoordAtomSiteO
+000718e0: 6628 6368 6169 6e49 642c 205f 7365 7149  f(chainId, _seqI
+000718f0: 645f 2c20 6369 6643 6865 636b 290a 2020  d_, cifCheck).  
+00071900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071920: 2020 2020 2020 6966 205f 636f 6f72 6441        if _coordA
+00071930: 746f 6d53 6974 6520 6973 206e 6f74 204e  tomSite is not N
+00071940: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00071950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071970: 205f 636f 6d70 4964 203d 205f 636f 6f72   _compId = _coor
+00071980: 6441 746f 6d53 6974 655b 2763 6f6d 705f  dAtomSite['comp_
+00071990: 6964 275d 0a20 2020 2020 2020 2020 2020  id'].           
 000719a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000719b0: 5f61 746f 6d20 3d20 7b7d 0a20 2020 2020  _atom = {}.     
-000719c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000719d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000719e0: 2020 2020 2020 2020 2020 205f 6174 6f6d             _atom
-000719f0: 5b27 636f 6d70 5f69 6427 5d20 3d20 5f63  ['comp_id'] = _c
-00071a00: 6f6d 7049 640a 2020 2020 2020 2020 2020  ompId.          
+000719b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000719c0: 205f 6174 6f6d 4964 203d 2073 656c 662e   _atomId = self.
+000719d0: 6765 7441 746f 6d49 644c 6973 7428 5f66  getAtomIdList(_f
+000719e0: 6163 746f 722c 205f 636f 6d70 4964 2c20  actor, _compId, 
+000719f0: 6174 6f6d 4964 295b 305d 0a20 2020 2020  atomId)[0].     
+00071a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00071a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071a30: 2020 2020 2020 5f61 746f 6d5b 2774 7970        _atom['typ
-00071a40: 655f 7379 6d62 6f6c 275d 203d 205f 636f  e_symbol'] = _co
-00071a50: 6f72 6441 746f 6d53 6974 655b 2774 7970  ordAtomSite['typ
-00071a60: 655f 7379 6d62 6f6c 275d 5b5f 636f 6f72  e_symbol'][_coor
-00071a70: 6441 746f 6d53 6974 655b 2761 746f 6d5f  dAtomSite['atom_
-00071a80: 6964 275d 2e69 6e64 6578 285f 6174 6f6d  id'].index(_atom
-00071a90: 4964 295d 0a20 2020 2020 2020 2020 2020  Id)].           
+00071a20: 2020 2020 2020 2069 6620 5f61 746f 6d49         if _atomI
+00071a30: 6420 696e 205f 636f 6f72 6441 746f 6d53  d in _coordAtomS
+00071a40: 6974 655b 2761 746f 6d5f 6964 275d 3a0a  ite['atom_id']:.
+00071a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071a80: 5f61 746f 6d20 3d20 7b7d 0a20 2020 2020  _atom = {}.     
+00071a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00071aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071ac0: 2020 2020 2073 656c 662e 5f5f 6175 7468       self.__auth
-00071ad0: 5365 7149 6420 3d20 2761 7574 685f 7365  SeqId = 'auth_se
-00071ae0: 715f 6964 270a 2020 2020 2020 2020 2020  q_id'.          
+00071ab0: 2020 2020 2020 2020 2020 205f 6174 6f6d             _atom
+00071ac0: 5b27 636f 6d70 5f69 6427 5d20 3d20 5f63  ['comp_id'] = _c
+00071ad0: 6f6d 7049 640a 2020 2020 2020 2020 2020  ompId.          
+00071ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00071af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071b10: 2020 2020 2020 7365 714b 6579 203d 205f        seqKey = _
-00071b20: 7365 714b 6579 0a20 2020 2020 2020 2020  seqKey.         
-00071b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071b50: 2020 2020 2020 2063 6861 696e 4964 2c20         chainId, 
-00071b60: 7365 7149 6420 3d20 7365 714b 6579 0a20  seqId = seqKey. 
+00071b00: 2020 2020 2020 5f61 746f 6d5b 2774 7970        _atom['typ
+00071b10: 655f 7379 6d62 6f6c 275d 203d 205f 636f  e_symbol'] = _co
+00071b20: 6f72 6441 746f 6d53 6974 655b 2774 7970  ordAtomSite['typ
+00071b30: 655f 7379 6d62 6f6c 275d 5b5f 636f 6f72  e_symbol'][_coor
+00071b40: 6441 746f 6d53 6974 655b 2761 746f 6d5f  dAtomSite['atom_
+00071b50: 6964 275d 2e69 6e64 6578 285f 6174 6f6d  id'].index(_atom
+00071b60: 4964 295d 0a20 2020 2020 2020 2020 2020  Id)].           
 00071b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00071b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071b90: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00071ba0: 6620 6c65 6e28 7365 6c66 2e61 746f 6d53  f len(self.atomS
-00071bb0: 656c 6563 7469 6f6e 5365 7429 203e 2030  electionSet) > 0
-00071bc0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00071b90: 2020 2020 2073 656c 662e 5f5f 6175 7468       self.__auth
+00071ba0: 5365 7149 6420 3d20 2761 7574 685f 7365  SeqId = 'auth_se
+00071bb0: 715f 6964 270a 2020 2020 2020 2020 2020  q_id'.          
+00071bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00071bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071bf0: 2020 2020 2020 7365 6c66 2e5f 5f73 6574        self.__set
-00071c00: 4c6f 6361 6c53 6571 5363 6865 6d65 2829  LocalSeqScheme()
-00071c10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00071c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071c30: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-00071c40: 6620 2761 6c74 5f61 746f 6d5f 6964 2720  f 'alt_atom_id' 
-00071c50: 696e 205f 636f 6f72 6441 746f 6d53 6974  in _coordAtomSit
-00071c60: 6520 616e 6420 5f61 746f 6d49 6420 696e  e and _atomId in
-00071c70: 205f 636f 6f72 6441 746f 6d53 6974 655b   _coordAtomSite[
-00071c80: 2761 6c74 5f61 746f 6d5f 6964 275d 3a0a  'alt_atom_id']:.
-00071c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071be0: 2020 2020 2020 7365 714b 6579 203d 205f        seqKey = _
+00071bf0: 7365 714b 6579 0a20 2020 2020 2020 2020  seqKey.         
+00071c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071c20: 2020 2020 2020 2063 6861 696e 4964 2c20         chainId, 
+00071c30: 7365 7149 6420 3d20 7365 714b 6579 0a20  seqId = seqKey. 
+00071c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071c60: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00071c70: 6620 6c65 6e28 7365 6c66 2e61 746f 6d53  f len(self.atomS
+00071c80: 656c 6563 7469 6f6e 5365 7429 203e 2030  electionSet) > 0
+00071c90: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
 00071ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00071cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071cc0: 5f61 746f 6d20 3d20 7b7d 0a20 2020 2020  _atom = {}.     
-00071cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071cf0: 2020 2020 2020 2020 2020 205f 6174 6f6d             _atom
-00071d00: 5b27 636f 6d70 5f69 6427 5d20 3d20 5f63  ['comp_id'] = _c
-00071d10: 6f6d 7049 640a 2020 2020 2020 2020 2020  ompId.          
-00071d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071d40: 2020 2020 2020 5f61 746f 6d5b 2774 7970        _atom['typ
-00071d50: 655f 7379 6d62 6f6c 275d 203d 205f 636f  e_symbol'] = _co
-00071d60: 6f72 6441 746f 6d53 6974 655b 2774 7970  ordAtomSite['typ
-00071d70: 655f 7379 6d62 6f6c 275d 5b5f 636f 6f72  e_symbol'][_coor
-00071d80: 6441 746f 6d53 6974 655b 2761 6c74 5f61  dAtomSite['alt_a
-00071d90: 746f 6d5f 6964 275d 2e69 6e64 6578 285f  tom_id'].index(_
-00071da0: 6174 6f6d 4964 295d 0a20 2020 2020 2020  atomId)].       
+00071cc0: 2020 2020 2020 7365 6c66 2e5f 5f73 6574        self.__set
+00071cd0: 4c6f 6361 6c53 6571 5363 6865 6d65 2829  LocalSeqScheme()
+00071ce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00071cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071d00: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+00071d10: 6620 2761 6c74 5f61 746f 6d5f 6964 2720  f 'alt_atom_id' 
+00071d20: 696e 205f 636f 6f72 6441 746f 6d53 6974  in _coordAtomSit
+00071d30: 6520 616e 6420 5f61 746f 6d49 6420 696e  e and _atomId in
+00071d40: 205f 636f 6f72 6441 746f 6d53 6974 655b   _coordAtomSite[
+00071d50: 2761 6c74 5f61 746f 6d5f 6964 275d 3a0a  'alt_atom_id']:.
+00071d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071d90: 5f61 746f 6d20 3d20 7b7d 0a20 2020 2020  _atom = {}.     
+00071da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00071db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071dd0: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
-00071de0: 6175 7468 5365 7149 6420 3d20 2761 7574  authSeqId = 'aut
-00071df0: 685f 7365 715f 6964 270a 2020 2020 2020  h_seq_id'.      
+00071dc0: 2020 2020 2020 2020 2020 205f 6174 6f6d             _atom
+00071dd0: 5b27 636f 6d70 5f69 6427 5d20 3d20 5f63  ['comp_id'] = _c
+00071de0: 6f6d 7049 640a 2020 2020 2020 2020 2020  ompId.          
+00071df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00071e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071e20: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00071e30: 5f61 7574 6841 746f 6d49 6420 3d20 2761  _authAtomId = 'a
-00071e40: 7574 685f 6174 6f6d 5f69 6427 0a20 2020  uth_atom_id'.   
-00071e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071e70: 2020 2020 2020 2020 2020 2020 2073 6571               seq
-00071e80: 4b65 7920 3d20 5f73 6571 4b65 790a 2020  Key = _seqKey.  
+00071e10: 2020 2020 2020 5f61 746f 6d5b 2774 7970        _atom['typ
+00071e20: 655f 7379 6d62 6f6c 275d 203d 205f 636f  e_symbol'] = _co
+00071e30: 6f72 6441 746f 6d53 6974 655b 2774 7970  ordAtomSite['typ
+00071e40: 655f 7379 6d62 6f6c 275d 5b5f 636f 6f72  e_symbol'][_coor
+00071e50: 6441 746f 6d53 6974 655b 2761 6c74 5f61  dAtomSite['alt_a
+00071e60: 746f 6d5f 6964 275d 2e69 6e64 6578 285f  tom_id'].index(_
+00071e70: 6174 6f6d 4964 295d 0a20 2020 2020 2020  atomId)].       
+00071e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00071e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071eb0: 2020 2020 2020 2020 2020 2020 2020 6368                ch
-00071ec0: 6169 6e49 642c 2073 6571 4964 203d 2073  ainId, seqId = s
-00071ed0: 6571 4b65 790a 2020 2020 2020 2020 2020  eqKey.          
+00071ea0: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
+00071eb0: 6175 7468 5365 7149 6420 3d20 2761 7574  authSeqId = 'aut
+00071ec0: 685f 7365 715f 6964 270a 2020 2020 2020  h_seq_id'.      
+00071ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00071ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071f00: 2020 2020 2020 6966 206c 656e 2873 656c        if len(sel
-00071f10: 662e 6174 6f6d 5365 6c65 6374 696f 6e53  f.atomSelectionS
-00071f20: 6574 2920 3e20 303a 0a20 2020 2020 2020  et) > 0:.       
+00071ef0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00071f00: 5f61 7574 6841 746f 6d49 6420 3d20 2761  _authAtomId = 'a
+00071f10: 7574 685f 6174 6f6d 5f69 6427 0a20 2020  uth_atom_id'.   
+00071f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00071f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071f50: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00071f60: 662e 5f5f 7365 744c 6f63 616c 5365 7153  f.__setLocalSeqS
-00071f70: 6368 656d 6528 290a 2020 2020 2020 2020  cheme().        
-00071f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071fa0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00071f40: 2020 2020 2020 2020 2020 2020 2073 6571               seq
+00071f50: 4b65 7920 3d20 5f73 6571 4b65 790a 2020  Key = _seqKey.  
+00071f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00071f80: 2020 2020 2020 2020 2020 2020 2020 6368                ch
+00071f90: 6169 6e49 642c 2073 6571 4964 203d 2073  ainId, seqId = s
+00071fa0: 6571 4b65 790a 2020 2020 2020 2020 2020  eqKey.          
 00071fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00071fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00071fd0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00071fe0: 5f70 7265 6665 7241 7574 6853 6571 203d  _preferAuthSeq =
-00071ff0: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
+00071fd0: 2020 2020 2020 6966 206c 656e 2873 656c        if len(sel
+00071fe0: 662e 6174 6f6d 5365 6c65 6374 696f 6e53  f.atomSelectionS
+00071ff0: 6574 2920 3e20 303a 0a20 2020 2020 2020  et) > 0:.       
 00072000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072010: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00072020: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00072030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072050: 2073 656c 662e 5f5f 7072 6566 6572 4175   self.__preferAu
-00072060: 7468 5365 7120 3d20 4661 6c73 650a 0a20  thSeq = False.. 
-00072070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072080: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00072090: 6c69 6620 7365 6c66 2e5f 5f70 7265 6665  lif self.__prefe
-000720a0: 7241 7574 6853 6571 2061 6e64 2061 746f  rAuthSeq and ato
-000720b0: 6d53 7065 6369 6669 6564 3a0a 2020 2020  mSpecified:.    
-000720c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072020: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00072030: 662e 5f5f 7365 744c 6f63 616c 5365 7153  f.__setLocalSeqS
+00072040: 6368 656d 6528 290a 2020 2020 2020 2020  cheme().        
+00072050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072070: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00072080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000720a0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+000720b0: 5f70 7265 6665 7241 7574 6853 6571 203d  _preferAuthSeq =
+000720c0: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
 000720d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000720e0: 6966 206c 656e 2873 656c 662e 6174 6f6d  if len(self.atom
-000720f0: 5365 6c65 6374 696f 6e53 6574 2920 3d3d  SelectionSet) ==
-00072100: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+000720e0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000720f0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00072100: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00072110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072120: 2020 2020 2020 2020 2020 2020 5f73 6571              _seq
-00072130: 4b65 792c 205f 636f 6f72 6441 746f 6d53  Key, _coordAtomS
-00072140: 6974 6520 3d20 7365 6c66 2e67 6574 436f  ite = self.getCo
-00072150: 6f72 6441 746f 6d53 6974 654f 6628 6368  ordAtomSiteOf(ch
-00072160: 6169 6e49 642c 2073 6571 4964 2c20 6369  ainId, seqId, ci
-00072170: 6643 6865 636b 2c20 6173 6973 3d46 616c  fCheck, asis=Fal
-00072180: 7365 290a 2020 2020 2020 2020 2020 2020  se).            
+00072120: 2073 656c 662e 5f5f 7072 6566 6572 4175   self.__preferAu
+00072130: 7468 5365 7120 3d20 4661 6c73 650a 0a20  thSeq = False.. 
+00072140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072150: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00072160: 6c69 6620 7365 6c66 2e5f 5f70 7265 6665  lif self.__prefe
+00072170: 7241 7574 6853 6571 2061 6e64 2061 746f  rAuthSeq and ato
+00072180: 6d53 7065 6369 6669 6564 3a0a 2020 2020  mSpecified:.    
 00072190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000721a0: 2020 2020 2020 2020 2020 2020 6966 205f              if _
-000721b0: 636f 6f72 6441 746f 6d53 6974 6520 6973  coordAtomSite is
-000721c0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-000721d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000721a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000721b0: 6966 206c 656e 2873 656c 662e 6174 6f6d  if len(self.atom
+000721c0: 5365 6c65 6374 696f 6e53 6574 2920 3d3d  SelectionSet) ==
+000721d0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
 000721e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000721f0: 2020 2020 2020 205f 636f 6d70 4964 203d         _compId =
-00072200: 205f 636f 6f72 6441 746f 6d53 6974 655b   _coordAtomSite[
-00072210: 2763 6f6d 705f 6964 275d 0a20 2020 2020  'comp_id'].     
-00072220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072240: 2020 2020 2020 205f 6174 6f6d 4964 203d         _atomId =
-00072250: 2073 656c 662e 6765 7441 746f 6d49 644c   self.getAtomIdL
-00072260: 6973 7428 5f66 6163 746f 722c 205f 636f  ist(_factor, _co
-00072270: 6d70 4964 2c20 6174 6f6d 4964 295b 305d  mpId, atomId)[0]
-00072280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00072290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000722a0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000722b0: 5f61 746f 6d49 6420 696e 205f 636f 6f72  _atomId in _coor
-000722c0: 6441 746f 6d53 6974 655b 2761 746f 6d5f  dAtomSite['atom_
-000722d0: 6964 275d 3a0a 2020 2020 2020 2020 2020  id']:.          
-000722e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000721f0: 2020 2020 2020 2020 2020 2020 5f73 6571              _seq
+00072200: 4b65 792c 205f 636f 6f72 6441 746f 6d53  Key, _coordAtomS
+00072210: 6974 6520 3d20 7365 6c66 2e67 6574 436f  ite = self.getCo
+00072220: 6f72 6441 746f 6d53 6974 654f 6628 6368  ordAtomSiteOf(ch
+00072230: 6169 6e49 642c 2073 6571 4964 2c20 6369  ainId, seqId, ci
+00072240: 6643 6865 636b 2c20 6173 6973 3d46 616c  fCheck, asis=Fal
+00072250: 7365 290a 2020 2020 2020 2020 2020 2020  se).            
+00072260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072270: 2020 2020 2020 2020 2020 2020 6966 205f              if _
+00072280: 636f 6f72 6441 746f 6d53 6974 6520 6973  coordAtomSite is
+00072290: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+000722a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000722b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000722c0: 2020 2020 2020 205f 636f 6d70 4964 203d         _compId =
+000722d0: 205f 636f 6f72 6441 746f 6d53 6974 655b   _coordAtomSite[
+000722e0: 2763 6f6d 705f 6964 275d 0a20 2020 2020  'comp_id'].     
 000722f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072300: 2020 2020 2020 5f61 746f 6d20 3d20 7b7d        _atom = {}
-00072310: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00072320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072340: 205f 6174 6f6d 5b27 636f 6d70 5f69 6427   _atom['comp_id'
-00072350: 5d20 3d20 5f63 6f6d 7049 640a 2020 2020  ] = _compId.    
+00072300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072310: 2020 2020 2020 205f 6174 6f6d 4964 203d         _atomId =
+00072320: 2073 656c 662e 6765 7441 746f 6d49 644c   self.getAtomIdL
+00072330: 6973 7428 5f66 6163 746f 722c 205f 636f  ist(_factor, _co
+00072340: 6d70 4964 2c20 6174 6f6d 4964 295b 305d  mpId, atomId)[0]
+00072350: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00072360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072380: 2020 2020 2020 2020 2020 2020 5f61 746f              _ato
-00072390: 6d5b 2774 7970 655f 7379 6d62 6f6c 275d  m['type_symbol']
-000723a0: 203d 205f 636f 6f72 6441 746f 6d53 6974   = _coordAtomSit
-000723b0: 655b 2774 7970 655f 7379 6d62 6f6c 275d  e['type_symbol']
-000723c0: 5b5f 636f 6f72 6441 746f 6d53 6974 655b  [_coordAtomSite[
-000723d0: 2761 746f 6d5f 6964 275d 2e69 6e64 6578  'atom_id'].index
-000723e0: 285f 6174 6f6d 4964 295d 0a20 2020 2020  (_atomId)].     
+00072370: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00072380: 5f61 746f 6d49 6420 696e 205f 636f 6f72  _atomId in _coor
+00072390: 6441 746f 6d53 6974 655b 2761 746f 6d5f  dAtomSite['atom_
+000723a0: 6964 275d 3a0a 2020 2020 2020 2020 2020  id']:.          
+000723b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000723c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000723d0: 2020 2020 2020 5f61 746f 6d20 3d20 7b7d        _atom = {}
+000723e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 000723f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00072400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072410: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00072420: 5f5f 7072 6566 6572 4175 7468 5365 7120  __preferAuthSeq 
-00072430: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
+00072410: 205f 6174 6f6d 5b27 636f 6d70 5f69 6427   _atom['comp_id'
+00072420: 5d20 3d20 5f63 6f6d 7049 640a 2020 2020  ] = _compId.    
+00072430: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00072440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072460: 2020 2020 2020 2020 7365 6c66 2e5f 5f61          self.__a
-00072470: 7574 6853 6571 4964 203d 2027 6c61 6265  uthSeqId = 'labe
-00072480: 6c5f 7365 715f 6964 270a 2020 2020 2020  l_seq_id'.      
-00072490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000724a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000724b0: 2020 2020 2020 2020 2020 7365 714b 6579            seqKey
-000724c0: 203d 205f 7365 714b 6579 0a20 2020 2020   = _seqKey.     
+00072450: 2020 2020 2020 2020 2020 2020 5f61 746f              _ato
+00072460: 6d5b 2774 7970 655f 7379 6d62 6f6c 275d  m['type_symbol']
+00072470: 203d 205f 636f 6f72 6441 746f 6d53 6974   = _coordAtomSit
+00072480: 655b 2774 7970 655f 7379 6d62 6f6c 275d  e['type_symbol']
+00072490: 5b5f 636f 6f72 6441 746f 6d53 6974 655b  [_coordAtomSite[
+000724a0: 2761 746f 6d5f 6964 275d 2e69 6e64 6578  'atom_id'].index
+000724b0: 285f 6174 6f6d 4964 295d 0a20 2020 2020  (_atomId)].     
+000724c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000724d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000724e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000724f0: 2020 2020 2020 2020 2020 2063 6861 696e             chain
-00072500: 4964 2c20 7365 7149 6420 3d20 7365 714b  Id, seqId = seqK
-00072510: 6579 0a20 2020 2020 2020 2020 2020 2020  ey.             
-00072520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072540: 2020 2069 6620 6c65 6e28 7365 6c66 2e61     if len(self.a
-00072550: 746f 6d53 656c 6563 7469 6f6e 5365 7429  tomSelectionSet)
-00072560: 203e 2030 3a0a 2020 2020 2020 2020 2020   > 0:.          
-00072570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072590: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-000725a0: 5f73 6574 4c6f 6361 6c53 6571 5363 6865  _setLocalSeqSche
-000725b0: 6d65 2829 0a20 2020 2020 2020 2020 2020  me().           
-000725c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000724e0: 2020 2020 2020 2020 2020 2022 2222 0a20             """. 
+000724f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072510: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00072520: 656c 662e 5f5f 7072 6566 6572 4175 7468  elf.__preferAuth
+00072530: 5365 7120 3d20 4661 6c73 650a 2020 2020  Seq = False.    
+00072540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072560: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00072570: 2e5f 5f61 7574 6853 6571 4964 203d 2027  .__authSeqId = '
+00072580: 6c61 6265 6c5f 7365 715f 6964 270a 2020  label_seq_id'.  
+00072590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000725a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000725b0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000725c0: 714b 6579 203d 205f 7365 714b 6579 0a20  qKey = _seqKey. 
 000725d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000725e0: 2065 6c69 6620 2761 6c74 5f61 746f 6d5f   elif 'alt_atom_
-000725f0: 6964 2720 696e 205f 636f 6f72 6441 746f  id' in _coordAto
-00072600: 6d53 6974 6520 616e 6420 5f61 746f 6d49  mSite and _atomI
-00072610: 6420 696e 205f 636f 6f72 6441 746f 6d53  d in _coordAtomS
-00072620: 6974 655b 2761 6c74 5f61 746f 6d5f 6964  ite['alt_atom_id
-00072630: 275d 3a0a 2020 2020 2020 2020 2020 2020  ']:.            
-00072640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072660: 2020 2020 5f61 746f 6d20 3d20 7b7d 0a20      _atom = {}. 
+000725e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000725f0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00072600: 6861 696e 4964 2c20 7365 7149 6420 3d20  hainId, seqId = 
+00072610: 7365 714b 6579 0a20 2020 2020 2020 2020  seqKey.         
+00072620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072640: 2020 2020 2020 2069 6620 6c65 6e28 7365         if len(se
+00072650: 6c66 2e61 746f 6d53 656c 6563 7469 6f6e  lf.atomSelection
+00072660: 5365 7429 203e 2030 3a0a 2020 2020 2020  Set) > 0:.      
 00072670: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00072680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072690: 2020 2020 2020 2020 2020 2020 2020 205f                 _
-000726a0: 6174 6f6d 5b27 636f 6d70 5f69 6427 5d20  atom['comp_id'] 
-000726b0: 3d20 5f63 6f6d 7049 640a 2020 2020 2020  = _compId.      
+00072690: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000726a0: 6c66 2e5f 5f73 6574 4c6f 6361 6c53 6571  lf.__setLocalSeq
+000726b0: 5363 6865 6d65 2829 0a20 2020 2020 2020  Scheme().       
 000726c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000726d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000726e0: 2020 2020 2020 2020 2020 5f61 746f 6d5b            _atom[
-000726f0: 2774 7970 655f 7379 6d62 6f6c 275d 203d  'type_symbol'] =
-00072700: 205f 636f 6f72 6441 746f 6d53 6974 655b   _coordAtomSite[
-00072710: 2774 7970 655f 7379 6d62 6f6c 275d 5b5f  'type_symbol'][_
-00072720: 636f 6f72 6441 746f 6d53 6974 655b 2761  coordAtomSite['a
-00072730: 6c74 5f61 746f 6d5f 6964 275d 2e69 6e64  lt_atom_id'].ind
-00072740: 6578 285f 6174 6f6d 4964 295d 0a20 2020  ex(_atomId)].   
-00072750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072770: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00072780: 662e 5f5f 7072 6566 6572 4175 7468 5365  f.__preferAuthSe
-00072790: 7120 3d20 4661 6c73 650a 2020 2020 2020  q = False.      
-000727a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000726e0: 2020 2020 2020 2020 2022 2222 0a20 2020           """.   
+000726f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072710: 2020 2020 2020 2020 2065 6c69 6620 2761           elif 'a
+00072720: 6c74 5f61 746f 6d5f 6964 2720 696e 205f  lt_atom_id' in _
+00072730: 636f 6f72 6441 746f 6d53 6974 6520 616e  coordAtomSite an
+00072740: 6420 5f61 746f 6d49 6420 696e 205f 636f  d _atomId in _co
+00072750: 6f72 6441 746f 6d53 6974 655b 2761 6c74  ordAtomSite['alt
+00072760: 5f61 746f 6d5f 6964 275d 3a0a 2020 2020  _atom_id']:.    
+00072770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072790: 2020 2020 2020 2020 2020 2020 5f61 746f              _ato
+000727a0: 6d20 3d20 7b7d 0a20 2020 2020 2020 2020  m = {}.         
 000727b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000727c0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-000727d0: 5f61 7574 6853 6571 4964 203d 2027 6c61  _authSeqId = 'la
-000727e0: 6265 6c5f 7365 715f 6964 270a 2020 2020  bel_seq_id'.    
-000727f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000727c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000727d0: 2020 2020 2020 205f 6174 6f6d 5b27 636f         _atom['co
+000727e0: 6d70 5f69 6427 5d20 3d20 5f63 6f6d 7049  mp_id'] = _compI
+000727f0: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
 00072800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072810: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00072820: 2e5f 5f61 7574 6841 746f 6d49 6420 3d20  .__authAtomId = 
-00072830: 2761 7574 685f 6174 6f6d 5f69 6427 0a20  'auth_atom_id'. 
-00072840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072860: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00072870: 6571 4b65 7920 3d20 5f73 6571 4b65 790a  eqKey = _seqKey.
-00072880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072820: 2020 5f61 746f 6d5b 2774 7970 655f 7379    _atom['type_sy
+00072830: 6d62 6f6c 275d 203d 205f 636f 6f72 6441  mbol'] = _coordA
+00072840: 746f 6d53 6974 655b 2774 7970 655f 7379  tomSite['type_sy
+00072850: 6d62 6f6c 275d 5b5f 636f 6f72 6441 746f  mbol'][_coordAto
+00072860: 6d53 6974 655b 2761 6c74 5f61 746f 6d5f  mSite['alt_atom_
+00072870: 6964 275d 2e69 6e64 6578 285f 6174 6f6d  id'].index(_atom
+00072880: 4964 295d 0a20 2020 2020 2020 2020 2020  Id)].           
 00072890: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000728a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000728b0: 6368 6169 6e49 642c 2073 6571 4964 203d  chainId, seqId =
-000728c0: 2073 6571 4b65 790a 2020 2020 2020 2020   seqKey.        
+000728b0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000728c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000728d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000728e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000728f0: 2020 2020 2020 2020 6966 206c 656e 2873          if len(s
-00072900: 656c 662e 6174 6f6d 5365 6c65 6374 696f  elf.atomSelectio
-00072910: 6e53 6574 2920 3e20 303a 0a20 2020 2020  nSet) > 0:.     
+000728e0: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
+000728f0: 7072 6566 6572 4175 7468 5365 7120 3d20  preferAuthSeq = 
+00072900: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
+00072910: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00072920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072940: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00072950: 656c 662e 5f5f 7365 744c 6f63 616c 5365  elf.__setLocalSe
-00072960: 7153 6368 656d 6528 290a 2020 2020 2020  qScheme().      
+00072930: 2020 2020 2020 7365 6c66 2e5f 5f61 7574        self.__aut
+00072940: 6853 6571 4964 203d 2027 6c61 6265 6c5f  hSeqId = 'label_
+00072950: 7365 715f 6964 270a 2020 2020 2020 2020  seq_id'.        
+00072960: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00072970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072980: 2020 2020 2020 2020 2020 656c 6966 205f            elif _
-00072990: 7365 7149 645f 2069 6e20 7073 5b27 6175  seqId_ in ps['au
-000729a0: 7468 5f73 6571 5f69 6427 5d20 616e 6420  th_seq_id'] and 
-000729b0: 6174 6f6d 5370 6563 6966 6965 643a 0a20  atomSpecified:. 
+00072980: 2020 2020 2020 2020 7365 6c66 2e5f 5f61          self.__a
+00072990: 7574 6841 746f 6d49 6420 3d20 2761 7574  uthAtomId = 'aut
+000729a0: 685f 6174 6f6d 5f69 6427 0a20 2020 2020  h_atom_id'.     
+000729b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000729c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000729d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000729e0: 2020 2069 6620 6c65 6e28 7365 6c66 2e61     if len(self.a
-000729f0: 746f 6d53 656c 6563 7469 6f6e 5365 7429  tomSelectionSet)
-00072a00: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
-00072a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072a20: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00072a30: 656c 662e 5f5f 7072 6566 6572 4175 7468  elf.__preferAuth
-00072a40: 5365 7120 3d20 5472 7565 0a20 2020 2020  Seq = True.     
+000729d0: 2020 2020 2020 2020 2020 2073 6571 4b65             seqKe
+000729e0: 7920 3d20 5f73 6571 4b65 790a 2020 2020  y = _seqKey.    
+000729f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072a10: 2020 2020 2020 2020 2020 2020 6368 6169              chai
+00072a20: 6e49 642c 2073 6571 4964 203d 2073 6571  nId, seqId = seq
+00072a30: 4b65 790a 2020 2020 2020 2020 2020 2020  Key.            
+00072a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00072a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072a70: 2020 205f 7365 714b 6579 2c20 5f63 6f6f     _seqKey, _coo
-00072a80: 7264 4174 6f6d 5369 7465 203d 2073 656c  rdAtomSite = sel
-00072a90: 662e 6765 7443 6f6f 7264 4174 6f6d 5369  f.getCoordAtomSi
-00072aa0: 7465 4f66 2863 6861 696e 4964 2c20 5f73  teOf(chainId, _s
-00072ab0: 6571 4964 5f2c 2063 6966 4368 6563 6b29  eqId_, cifCheck)
-00072ac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00072ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072ae0: 2020 2020 2020 2020 2069 6620 5f63 6f6f           if _coo
-00072af0: 7264 4174 6f6d 5369 7465 2069 7320 6e6f  rdAtomSite is no
-00072b00: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+00072a60: 2020 2020 6966 206c 656e 2873 656c 662e      if len(self.
+00072a70: 6174 6f6d 5365 6c65 6374 696f 6e53 6574  atomSelectionSet
+00072a80: 2920 3e20 303a 0a20 2020 2020 2020 2020  ) > 0:.         
+00072a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072ab0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00072ac0: 5f5f 7365 744c 6f63 616c 5365 7153 6368  __setLocalSeqSch
+00072ad0: 656d 6528 290a 2020 2020 2020 2020 2020  eme().          
+00072ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072b00: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
 00072b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072b30: 2020 2020 5f63 6f6d 7049 6420 3d20 5f63      _compId = _c
-00072b40: 6f6f 7264 4174 6f6d 5369 7465 5b27 636f  oordAtomSite['co
-00072b50: 6d70 5f69 6427 5d0a 2020 2020 2020 2020  mp_id'].        
+00072b20: 2020 2020 2020 2020 2020 656c 6966 205f            elif _
+00072b30: 7365 7149 645f 2069 6e20 7073 5b27 6175  seqId_ in ps['au
+00072b40: 7468 5f73 6571 5f69 6427 5d20 616e 6420  th_seq_id'] and 
+00072b50: 6174 6f6d 5370 6563 6966 6965 643a 0a20  atomSpecified:. 
 00072b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00072b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072b80: 2020 2020 5f61 746f 6d49 6420 3d20 7365      _atomId = se
-00072b90: 6c66 2e67 6574 4174 6f6d 4964 4c69 7374  lf.getAtomIdList
-00072ba0: 285f 6661 6374 6f72 2c20 5f63 6f6d 7049  (_factor, _compI
-00072bb0: 642c 2061 746f 6d49 6429 5b30 5d0a 2020  d, atomId)[0].  
-00072bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072be0: 2020 2020 2020 2020 2020 6966 205f 6174            if _at
-00072bf0: 6f6d 4964 2069 6e20 5f63 6f6f 7264 4174  omId in _coordAt
-00072c00: 6f6d 5369 7465 5b27 6174 6f6d 5f69 6427  omSite['atom_id'
-00072c10: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
-00072c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072c40: 2020 205f 6174 6f6d 203d 207b 7d0a 2020     _atom = {}.  
-00072c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072c70: 2020 2020 2020 2020 2020 2020 2020 5f61                _a
-00072c80: 746f 6d5b 2763 6f6d 705f 6964 275d 203d  tom['comp_id'] =
-00072c90: 205f 636f 6d70 4964 0a20 2020 2020 2020   _compId.       
-00072ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072b80: 2020 2069 6620 6c65 6e28 7365 6c66 2e61     if len(self.a
+00072b90: 746f 6d53 656c 6563 7469 6f6e 5365 7429  tomSelectionSet)
+00072ba0: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
+00072bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072bc0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00072bd0: 656c 662e 5f5f 7072 6566 6572 4175 7468  elf.__preferAuth
+00072be0: 5365 7120 3d20 5472 7565 0a20 2020 2020  Seq = True.     
+00072bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072c10: 2020 205f 7365 714b 6579 2c20 5f63 6f6f     _seqKey, _coo
+00072c20: 7264 4174 6f6d 5369 7465 203d 2073 656c  rdAtomSite = sel
+00072c30: 662e 6765 7443 6f6f 7264 4174 6f6d 5369  f.getCoordAtomSi
+00072c40: 7465 4f66 2863 6861 696e 4964 2c20 5f73  teOf(chainId, _s
+00072c50: 6571 4964 5f2c 2063 6966 4368 6563 6b29  eqId_, cifCheck)
+00072c60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00072c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072c80: 2020 2020 2020 2020 2069 6620 5f63 6f6f           if _coo
+00072c90: 7264 4174 6f6d 5369 7465 2069 7320 6e6f  rdAtomSite is no
+00072ca0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
 00072cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072cc0: 2020 2020 2020 2020 205f 6174 6f6d 5b27           _atom['
-00072cd0: 7479 7065 5f73 796d 626f 6c27 5d20 3d20  type_symbol'] = 
-00072ce0: 5f63 6f6f 7264 4174 6f6d 5369 7465 5b27  _coordAtomSite['
-00072cf0: 7479 7065 5f73 796d 626f 6c27 5d5b 5f63  type_symbol'][_c
-00072d00: 6f6f 7264 4174 6f6d 5369 7465 5b27 6174  oordAtomSite['at
-00072d10: 6f6d 5f69 6427 5d2e 696e 6465 7828 5f61  om_id'].index(_a
-00072d20: 746f 6d49 6429 5d0a 2020 2020 2020 2020  tomId)].        
-00072d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072d50: 2020 2020 2020 2020 7365 6c66 2e5f 5f61          self.__a
-00072d60: 7574 6853 6571 4964 203d 2027 6175 7468  uthSeqId = 'auth
-00072d70: 5f73 6571 5f69 6427 0a20 2020 2020 2020  _seq_id'.       
-00072d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072da0: 2020 2020 2020 2020 2073 6571 4b65 7920           seqKey 
-00072db0: 3d20 5f73 6571 4b65 790a 2020 2020 2020  = _seqKey.      
+00072cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072cd0: 2020 2020 5f63 6f6d 7049 6420 3d20 5f63      _compId = _c
+00072ce0: 6f6f 7264 4174 6f6d 5369 7465 5b27 636f  oordAtomSite['co
+00072cf0: 6d70 5f69 6427 5d0a 2020 2020 2020 2020  mp_id'].        
+00072d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072d20: 2020 2020 5f61 746f 6d49 6420 3d20 7365      _atomId = se
+00072d30: 6c66 2e67 6574 4174 6f6d 4964 4c69 7374  lf.getAtomIdList
+00072d40: 285f 6661 6374 6f72 2c20 5f63 6f6d 7049  (_factor, _compI
+00072d50: 642c 2061 746f 6d49 6429 5b30 5d0a 2020  d, atomId)[0].  
+00072d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072d80: 2020 2020 2020 2020 2020 6966 205f 6174            if _at
+00072d90: 6f6d 4964 2069 6e20 5f63 6f6f 7264 4174  omId in _coordAt
+00072da0: 6f6d 5369 7465 5b27 6174 6f6d 5f69 6427  omSite['atom_id'
+00072db0: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
 00072dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00072dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072de0: 2020 2020 2020 2020 2020 6368 6169 6e49            chainI
-00072df0: 642c 2073 6571 4964 203d 2073 6571 4b65  d, seqId = seqKe
-00072e00: 790a 2020 2020 2020 2020 2020 2020 2020  y.              
-00072e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072e30: 2020 6966 206c 656e 2873 656c 662e 6174    if len(self.at
-00072e40: 6f6d 5365 6c65 6374 696f 6e53 6574 2920  omSelectionSet) 
-00072e50: 3e20 303a 0a20 2020 2020 2020 2020 2020  > 0:.           
-00072e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072e80: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
-00072e90: 7365 744c 6f63 616c 5365 7153 6368 656d  setLocalSeqSchem
-00072ea0: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
-00072eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072ed0: 656c 6966 2027 616c 745f 6174 6f6d 5f69  elif 'alt_atom_i
-00072ee0: 6427 2069 6e20 5f63 6f6f 7264 4174 6f6d  d' in _coordAtom
-00072ef0: 5369 7465 2061 6e64 205f 6174 6f6d 4964  Site and _atomId
-00072f00: 2069 6e20 5f63 6f6f 7264 4174 6f6d 5369   in _coordAtomSi
-00072f10: 7465 5b27 616c 745f 6174 6f6d 5f69 6427  te['alt_atom_id'
-00072f20: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
+00072de0: 2020 205f 6174 6f6d 203d 207b 7d0a 2020     _atom = {}.  
+00072df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072e10: 2020 2020 2020 2020 2020 2020 2020 5f61                _a
+00072e20: 746f 6d5b 2763 6f6d 705f 6964 275d 203d  tom['comp_id'] =
+00072e30: 205f 636f 6d70 4964 0a20 2020 2020 2020   _compId.       
+00072e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072e60: 2020 2020 2020 2020 205f 6174 6f6d 5b27           _atom['
+00072e70: 7479 7065 5f73 796d 626f 6c27 5d20 3d20  type_symbol'] = 
+00072e80: 5f63 6f6f 7264 4174 6f6d 5369 7465 5b27  _coordAtomSite['
+00072e90: 7479 7065 5f73 796d 626f 6c27 5d5b 5f63  type_symbol'][_c
+00072ea0: 6f6f 7264 4174 6f6d 5369 7465 5b27 6174  oordAtomSite['at
+00072eb0: 6f6d 5f69 6427 5d2e 696e 6465 7828 5f61  om_id'].index(_a
+00072ec0: 746f 6d49 6429 5d0a 2020 2020 2020 2020  tomId)].        
+00072ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072ef0: 2020 2020 2020 2020 7365 6c66 2e5f 5f61          self.__a
+00072f00: 7574 6853 6571 4964 203d 2027 6175 7468  uthSeqId = 'auth
+00072f10: 5f73 6571 5f69 6427 0a20 2020 2020 2020  _seq_id'.       
+00072f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00072f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072f50: 2020 205f 6174 6f6d 203d 207b 7d0a 2020     _atom = {}.  
+00072f40: 2020 2020 2020 2020 2022 2222 0a20 2020           """.   
+00072f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00072f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072f80: 2020 2020 2020 2020 2020 2020 2020 5f61                _a
-00072f90: 746f 6d5b 2763 6f6d 705f 6964 275d 203d  tom['comp_id'] =
-00072fa0: 205f 636f 6d70 4964 0a20 2020 2020 2020   _compId.       
-00072fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072fd0: 2020 2020 2020 2020 205f 6174 6f6d 5b27           _atom['
-00072fe0: 7479 7065 5f73 796d 626f 6c27 5d20 3d20  type_symbol'] = 
-00072ff0: 5f63 6f6f 7264 4174 6f6d 5369 7465 5b27  _coordAtomSite['
-00073000: 7479 7065 5f73 796d 626f 6c27 5d5b 5f63  type_symbol'][_c
-00073010: 6f6f 7264 4174 6f6d 5369 7465 5b27 616c  oordAtomSite['al
-00073020: 745f 6174 6f6d 5f69 6427 5d2e 696e 6465  t_atom_id'].inde
-00073030: 7828 5f61 746f 6d49 6429 5d0a 2020 2020  x(_atomId)].    
+00072f70: 2020 2020 2020 2020 2020 2020 2073 6571               seq
+00072f80: 4b65 7920 3d20 5f73 6571 4b65 790a 2020  Key = _seqKey.  
+00072f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072fb0: 2020 2020 2020 2020 2020 2020 2020 6368                ch
+00072fc0: 6169 6e49 642c 2073 6571 4964 203d 2073  ainId, seqId = s
+00072fd0: 6571 4b65 790a 2020 2020 2020 2020 2020  eqKey.          
+00072fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073000: 2020 2020 2020 6966 206c 656e 2873 656c        if len(sel
+00073010: 662e 6174 6f6d 5365 6c65 6374 696f 6e53  f.atomSelectionS
+00073020: 6574 2920 3e20 303a 0a20 2020 2020 2020  et) > 0:.       
+00073030: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00073040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073060: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00073070: 2e5f 5f61 7574 6853 6571 4964 203d 2027  .__authSeqId = '
-00073080: 6175 7468 5f73 6571 5f69 6427 0a20 2020  auth_seq_id'.   
+00073050: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00073060: 662e 5f5f 7365 744c 6f63 616c 5365 7153  f.__setLocalSeqS
+00073070: 6368 656d 6528 290a 2020 2020 2020 2020  cheme().        
+00073080: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00073090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000730a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000730b0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-000730c0: 662e 5f5f 6175 7468 4174 6f6d 4964 203d  f.__authAtomId =
-000730d0: 2027 6175 7468 5f61 746f 6d5f 6964 270a   'auth_atom_id'.
-000730e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000730f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073110: 7365 714b 6579 203d 205f 7365 714b 6579  seqKey = _seqKey
-00073120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000730a0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000730b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000730c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000730d0: 2020 2020 2020 2020 656c 6966 2027 616c          elif 'al
+000730e0: 745f 6174 6f6d 5f69 6427 2069 6e20 5f63  t_atom_id' in _c
+000730f0: 6f6f 7264 4174 6f6d 5369 7465 2061 6e64  oordAtomSite and
+00073100: 205f 6174 6f6d 4964 2069 6e20 5f63 6f6f   _atomId in _coo
+00073110: 7264 4174 6f6d 5369 7465 5b27 616c 745f  rdAtomSite['alt_
+00073120: 6174 6f6d 5f69 6427 5d3a 0a20 2020 2020  atom_id']:.     
 00073130: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00073140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073150: 2063 6861 696e 4964 2c20 7365 7149 6420   chainId, seqId 
-00073160: 3d20 7365 714b 6579 0a20 2020 2020 2020  = seqKey.       
+00073150: 2020 2020 2020 2020 2020 205f 6174 6f6d             _atom
+00073160: 203d 207b 7d0a 2020 2020 2020 2020 2020   = {}.          
 00073170: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00073180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073190: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
-000731a0: 7365 6c66 2e61 746f 6d53 656c 6563 7469  self.atomSelecti
-000731b0: 6f6e 5365 7429 203e 2030 3a0a 2020 2020  onSet) > 0:.    
+00073190: 2020 2020 2020 5f61 746f 6d5b 2763 6f6d        _atom['com
+000731a0: 705f 6964 275d 203d 205f 636f 6d70 4964  p_id'] = _compId
+000731b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 000731c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000731d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000731e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000731f0: 7365 6c66 2e5f 5f73 6574 4c6f 6361 6c53  self.__setLocalS
-00073200: 6571 5363 6865 6d65 2829 0a20 2020 2020  eqScheme().     
-00073210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073230: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00073240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000731e0: 205f 6174 6f6d 5b27 7479 7065 5f73 796d   _atom['type_sym
+000731f0: 626f 6c27 5d20 3d20 5f63 6f6f 7264 4174  bol'] = _coordAt
+00073200: 6f6d 5369 7465 5b27 7479 7065 5f73 796d  omSite['type_sym
+00073210: 626f 6c27 5d5b 5f63 6f6f 7264 4174 6f6d  bol'][_coordAtom
+00073220: 5369 7465 5b27 616c 745f 6174 6f6d 5f69  Site['alt_atom_i
+00073230: 6427 5d2e 696e 6465 7828 5f61 746f 6d49  d'].index(_atomI
+00073240: 6429 5d0a 2020 2020 2020 2020 2020 2020  d)].            
 00073250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073260: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00073270: 662e 5f5f 7072 6566 6572 4175 7468 5365  f.__preferAuthSe
-00073280: 7120 3d20 4661 6c73 650a 2020 2020 2020  q = False.      
-00073290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073270: 2020 2020 7365 6c66 2e5f 5f61 7574 6853      self.__authS
+00073280: 6571 4964 203d 2027 6175 7468 5f73 6571  eqId = 'auth_seq
+00073290: 5f69 6427 0a20 2020 2020 2020 2020 2020  _id'.           
 000732a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000732b0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-000732c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000732d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000732e0: 2020 2020 7365 6c66 2e5f 5f70 7265 6665      self.__prefe
-000732f0: 7241 7574 6853 6571 203d 2046 616c 7365  rAuthSeq = False
-00073300: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00073310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073320: 2020 6966 205f 6174 6f6d 2069 7320 6e6f    if _atom is no
-00073330: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00073340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073350: 2020 2020 2020 2020 2020 2020 5f63 6f6d              _com
-00073360: 7049 644c 6973 7420 3d20 4e6f 6e65 2069  pIdList = None i
-00073370: 6620 2763 6f6d 705f 6964 2720 6e6f 7420  f 'comp_id' not 
-00073380: 696e 205f 6661 6374 6f72 2065 6c73 6520  in _factor else 
-00073390: 5b74 7261 6e73 6c61 7465 546f 5374 6452  [translateToStdR
-000733a0: 6573 4e61 6d65 285f 636f 6d70 4964 2c20  esName(_compId, 
-000733b0: 7365 6c66 2e5f 5f63 6355 2920 666f 7220  self.__ccU) for 
-000733c0: 5f63 6f6d 7049 6420 696e 205f 6661 6374  _compId in _fact
-000733d0: 6f72 5b27 636f 6d70 5f69 6427 5d5d 0a20  or['comp_id']]. 
-000733e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000733f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073400: 2020 2069 6620 2827 636f 6d70 5f69 6427     if ('comp_id'
-00073410: 206e 6f74 2069 6e20 5f66 6163 746f 7220   not in _factor 
-00073420: 6f72 205f 6174 6f6d 5b27 636f 6d70 5f69  or _atom['comp_i
-00073430: 6427 5d20 696e 205f 636f 6d70 4964 4c69  d'] in _compIdLi
-00073440: 7374 295c 0a20 2020 2020 2020 2020 2020  st)\.           
+000732b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000732c0: 2020 2020 2073 656c 662e 5f5f 6175 7468       self.__auth
+000732d0: 4174 6f6d 4964 203d 2027 6175 7468 5f61  AtomId = 'auth_a
+000732e0: 746f 6d5f 6964 270a 2020 2020 2020 2020  tom_id'.        
+000732f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073310: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00073320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073340: 2020 2020 2020 2020 2020 2020 7365 714b              seqK
+00073350: 6579 203d 205f 7365 714b 6579 0a20 2020  ey = _seqKey.   
+00073360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073380: 2020 2020 2020 2020 2020 2020 2063 6861               cha
+00073390: 696e 4964 2c20 7365 7149 6420 3d20 7365  inId, seqId = se
+000733a0: 714b 6579 0a20 2020 2020 2020 2020 2020  qKey.           
+000733b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000733c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000733d0: 2020 2020 2069 6620 6c65 6e28 7365 6c66       if len(self
+000733e0: 2e61 746f 6d53 656c 6563 7469 6f6e 5365  .atomSelectionSe
+000733f0: 7429 203e 2030 3a0a 2020 2020 2020 2020  t) > 0:.        
+00073400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073420: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00073430: 2e5f 5f73 6574 4c6f 6361 6c53 6571 5363  .__setLocalSeqSc
+00073440: 6865 6d65 2829 0a20 2020 2020 2020 2020  heme().         
 00073450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073460: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-00073470: 2827 7479 7065 5f73 796d 626f 6c27 206e  ('type_symbol' n
-00073480: 6f74 2069 6e20 5f66 6163 746f 7220 6f72  ot in _factor or
-00073490: 205f 6174 6f6d 5b27 7479 7065 5f73 796d   _atom['type_sym
-000734a0: 626f 6c27 5d20 696e 205f 6661 6374 6f72  bol'] in _factor
-000734b0: 5b27 7479 7065 5f73 796d 626f 6c27 5d29  ['type_symbol'])
-000734c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000734d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000734e0: 2020 2020 2020 2020 2020 7365 6c65 6374            select
-000734f0: 696f 6e20 3d20 7b27 6368 6169 6e5f 6964  ion = {'chain_id
-00073500: 273a 2063 6861 696e 4964 2c20 2773 6571  ': chainId, 'seq
-00073510: 5f69 6427 3a20 7365 7149 642c 2027 636f  _id': seqId, 'co
-00073520: 6d70 5f69 6427 3a20 5f61 746f 6d5b 2763  mp_id': _atom['c
-00073530: 6f6d 705f 6964 275d 2c20 2761 746f 6d5f  omp_id'], 'atom_
-00073540: 6964 273a 205f 6174 6f6d 4964 7d0a 2020  id': _atomId}.  
-00073550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073570: 2020 2020 2020 6966 206c 656e 2873 656c        if len(sel
-00073580: 662e 5f5f 6375 725f 6175 7468 5f61 746f  f.__cur_auth_ato
-00073590: 6d5f 6964 2920 3e20 303a 0a20 2020 2020  m_id) > 0:.     
-000735a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073470: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00073480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000734a0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000734b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000734c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000734d0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000734e0: 662e 5f5f 7072 6566 6572 4175 7468 5365  f.__preferAuthSe
+000734f0: 7120 3d20 4661 6c73 650a 2020 2020 2020  q = False.      
+00073500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073520: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00073530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073550: 2020 2020 7365 6c66 2e5f 5f70 7265 6665      self.__prefe
+00073560: 7241 7574 6853 6571 203d 2046 616c 7365  rAuthSeq = False
+00073570: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00073580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073590: 2020 6966 205f 6174 6f6d 2069 7320 6e6f    if _atom is no
+000735a0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
 000735b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000735c0: 2020 2020 2020 2073 656c 6563 7469 6f6e         selection
-000735d0: 5b27 6175 7468 5f61 746f 6d5f 6964 275d  ['auth_atom_id']
-000735e0: 203d 2073 656c 662e 5f5f 6375 725f 6175   = self.__cur_au
-000735f0: 7468 5f61 746f 6d5f 6964 0a20 2020 2020  th_atom_id.     
-00073600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073620: 2020 2069 6620 6e6f 7420 6174 6f6d 5370     if not atomSp
-00073630: 6563 6966 6965 6420 6f72 206e 6f74 2073  ecified or not s
-00073640: 6571 5370 6563 6966 6965 643a 0a20 2020  eqSpecified:.   
+000735c0: 2020 2020 2020 2020 2020 2020 5f63 6f6d              _com
+000735d0: 7049 644c 6973 7420 3d20 4e6f 6e65 2069  pIdList = None i
+000735e0: 6620 2763 6f6d 705f 6964 2720 6e6f 7420  f 'comp_id' not 
+000735f0: 696e 205f 6661 6374 6f72 2065 6c73 6520  in _factor else 
+00073600: 5b74 7261 6e73 6c61 7465 546f 5374 6452  [translateToStdR
+00073610: 6573 4e61 6d65 285f 636f 6d70 4964 2c20  esName(_compId, 
+00073620: 7365 6c66 2e5f 5f63 6355 2920 666f 7220  self.__ccU) for 
+00073630: 5f63 6f6d 7049 6420 696e 205f 6661 6374  _compId in _fact
+00073640: 6f72 5b27 636f 6d70 5f69 6427 5d5d 0a20  or['comp_id']]. 
 00073650: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00073660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073670: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00073680: 2e5f 5f63 6355 2e75 7064 6174 6543 6865  .__ccU.updateChe
-00073690: 6d43 6f6d 7044 6963 7428 636f 6d70 4964  mCompDict(compId
-000736a0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-000736b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073670: 2020 2069 6620 2827 636f 6d70 5f69 6427     if ('comp_id'
+00073680: 206e 6f74 2069 6e20 5f66 6163 746f 7220   not in _factor 
+00073690: 6f72 205f 6174 6f6d 5b27 636f 6d70 5f69  or _atom['comp_i
+000736a0: 6427 5d20 696e 205f 636f 6d70 4964 4c69  d'] in _compIdLi
+000736b0: 7374 295c 0a20 2020 2020 2020 2020 2020  st)\.           
 000736c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000736d0: 2020 2063 6361 203d 206e 6578 7428 2863     cca = next((c
-000736e0: 6361 2066 6f72 2063 6361 2069 6e20 7365  ca for cca in se
-000736f0: 6c66 2e5f 5f63 6355 2e6c 6173 7441 746f  lf.__ccU.lastAto
-00073700: 6d4c 6973 7420 6966 2063 6361 5b73 656c  mList if cca[sel
-00073710: 662e 5f5f 6363 552e 6363 6141 746f 6d49  f.__ccU.ccaAtomI
-00073720: 645d 203d 3d20 5f61 746f 6d49 6429 2c20  d] == _atomId), 
-00073730: 4e6f 6e65 290a 2020 2020 2020 2020 2020  None).          
+000736d0: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+000736e0: 2827 7479 7065 5f73 796d 626f 6c27 206e  ('type_symbol' n
+000736f0: 6f74 2069 6e20 5f66 6163 746f 7220 6f72  ot in _factor or
+00073700: 205f 6174 6f6d 5b27 7479 7065 5f73 796d   _atom['type_sym
+00073710: 626f 6c27 5d20 696e 205f 6661 6374 6f72  bol'] in _factor
+00073720: 5b27 7479 7065 5f73 796d 626f 6c27 5d29  ['type_symbol'])
+00073730: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
 00073740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073760: 2020 2020 2020 6966 2063 6361 2069 7320        if cca is 
-00073770: 4e6f 6e65 206f 7220 2863 6361 2069 7320  None or (cca is 
-00073780: 6e6f 7420 4e6f 6e65 2061 6e64 2063 6361  not None and cca
-00073790: 5b73 656c 662e 5f5f 6363 552e 6363 614c  [self.__ccU.ccaL
-000737a0: 6561 7669 6e67 4174 6f6d 466c 6167 5d20  eavingAtomFlag] 
-000737b0: 3d3d 2027 5927 293a 0a20 2020 2020 2020  == 'Y'):.       
+00073750: 2020 2020 2020 2020 2020 7365 6c65 6374            select
+00073760: 696f 6e20 3d20 7b27 6368 6169 6e5f 6964  ion = {'chain_id
+00073770: 273a 2063 6861 696e 4964 2c20 2773 6571  ': chainId, 'seq
+00073780: 5f69 6427 3a20 7365 7149 642c 2027 636f  _id': seqId, 'co
+00073790: 6d70 5f69 6427 3a20 5f61 746f 6d5b 2763  mp_id': _atom['c
+000737a0: 6f6d 705f 6964 275d 2c20 2761 746f 6d5f  omp_id'], 'atom_
+000737b0: 6964 273a 205f 6174 6f6d 4964 7d0a 2020  id': _atomId}.  
 000737c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000737d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000737e0: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
-000737f0: 7469 6e75 650a 2020 2020 2020 2020 2020  tinue.          
-00073800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073810: 2020 2020 2020 2020 2020 2020 2020 5f61                _a
-00073820: 746f 6d53 656c 6563 7469 6f6e 2e61 7070  tomSelection.app
-00073830: 656e 6428 7365 6c65 6374 696f 6e29 0a20  end(selection). 
-00073840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073850: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00073860: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+000737e0: 2020 2020 2020 6966 206c 656e 2873 656c        if len(sel
+000737f0: 662e 5f5f 6375 725f 6175 7468 5f61 746f  f.__cur_auth_ato
+00073800: 6d5f 6964 2920 3e20 303a 0a20 2020 2020  m_id) > 0:.     
+00073810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073830: 2020 2020 2020 2073 656c 6563 7469 6f6e         selection
+00073840: 5b27 6175 7468 5f61 746f 6d5f 6964 275d  ['auth_atom_id']
+00073850: 203d 2073 656c 662e 5f5f 6375 725f 6175   = self.__cur_au
+00073860: 7468 5f61 746f 6d5f 6964 0a20 2020 2020  th_atom_id.     
 00073870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073880: 2020 2020 2020 2020 2063 6364 4368 6563           ccdChec
-00073890: 6b20 3d20 5472 7565 0a0a 2020 2020 2020  k = True..      
-000738a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000738b0: 2020 2020 2020 6966 2028 6c65 6e28 5f66        if (len(_f
-000738c0: 6163 746f 725b 2763 6861 696e 5f69 6427  actor['chain_id'
-000738d0: 5d29 203e 2031 206f 7220 6c65 6e28 5f66  ]) > 1 or len(_f
-000738e0: 6163 746f 725b 2773 6571 5f69 6427 5d29  actor['seq_id'])
-000738f0: 203e 2031 2920 616e 6420 6e6f 7420 6174   > 1) and not at
-00073900: 6f6d 5370 6563 6966 6965 643a 0a20 2020  omSpecified:.   
-00073910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073920: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
-00073930: 7469 6e75 650a 0a20 2020 2020 2020 2020  tinue..         
-00073940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073950: 2020 2069 6620 6973 506f 6c79 5365 7120     if isPolySeq 
-00073960: 616e 6420 2761 6d62 6967 5f61 7574 685f  and 'ambig_auth_
-00073970: 7365 715f 6964 2720 696e 2070 7320 616e  seq_id' in ps an
-00073980: 6420 5f73 6571 4964 2069 6e20 7073 5b27  d _seqId in ps['
-00073990: 616d 6269 675f 6175 7468 5f73 6571 5f69  ambig_auth_seq_i
-000739a0: 6427 5d3a 0a20 2020 2020 2020 2020 2020  d']:.           
+00073880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073890: 2020 2069 6620 6e6f 7420 6174 6f6d 5370     if not atomSp
+000738a0: 6563 6966 6965 6420 6f72 206e 6f74 2073  ecified or not s
+000738b0: 6571 5370 6563 6966 6965 643a 0a20 2020  eqSpecified:.   
+000738c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000738d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000738e0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+000738f0: 2e5f 5f63 6355 2e75 7064 6174 6543 6865  .__ccU.updateChe
+00073900: 6d43 6f6d 7044 6963 7428 636f 6d70 4964  mCompDict(compId
+00073910: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00073920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073940: 2020 2063 6361 203d 206e 6578 7428 2863     cca = next((c
+00073950: 6361 2066 6f72 2063 6361 2069 6e20 7365  ca for cca in se
+00073960: 6c66 2e5f 5f63 6355 2e6c 6173 7441 746f  lf.__ccU.lastAto
+00073970: 6d4c 6973 7420 6966 2063 6361 5b73 656c  mList if cca[sel
+00073980: 662e 5f5f 6363 552e 6363 6141 746f 6d49  f.__ccU.ccaAtomI
+00073990: 645d 203d 3d20 5f61 746f 6d49 6429 2c20  d] == _atomId), 
+000739a0: 4e6f 6e65 290a 2020 2020 2020 2020 2020  None).          
 000739b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000739c0: 2020 2020 2063 6f6e 7469 6e75 650a 0a20       continue.. 
-000739d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000739e0: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
-000739f0: 7420 6973 506f 6c79 5365 7120 616e 6420  t isPolySeq and 
-00073a00: 2761 6c74 5f61 7574 685f 7365 715f 6964  'alt_auth_seq_id
-00073a10: 2720 696e 2070 7320 616e 6420 5f73 6571  ' in ps and _seq
-00073a20: 4964 2069 6e20 7073 5b27 6175 7468 5f73  Id in ps['auth_s
-00073a30: 6571 5f69 6427 5d20 616e 6420 5f73 6571  eq_id'] and _seq
-00073a40: 4964 206e 6f74 2069 6e20 7073 5b27 616c  Id not in ps['al
-00073a50: 745f 6175 7468 5f73 6571 5f69 6427 5d3a  t_auth_seq_id']:
-00073a60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000739c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000739d0: 2020 2020 2020 6966 2063 6361 2069 7320        if cca is 
+000739e0: 4e6f 6e65 206f 7220 2863 6361 2069 7320  None or (cca is 
+000739f0: 6e6f 7420 4e6f 6e65 2061 6e64 2063 6361  not None and cca
+00073a00: 5b73 656c 662e 5f5f 6363 552e 6363 614c  [self.__ccU.ccaL
+00073a10: 6561 7669 6e67 4174 6f6d 466c 6167 5d20  eavingAtomFlag] 
+00073a20: 3d3d 2027 5927 293a 0a20 2020 2020 2020  == 'Y'):.       
+00073a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073a50: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
+00073a60: 7469 6e75 650a 2020 2020 2020 2020 2020  tinue.          
 00073a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073a80: 2063 6f6e 7469 6e75 650a 0a20 2020 2020   continue..     
-00073a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073aa0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-00073ab0: 616e 6365 286f 7269 6741 746f 6d49 642c  ance(origAtomId,
-00073ac0: 2073 7472 2920 616e 6420 6f72 6967 4174   str) and origAt
-00073ad0: 6f6d 4964 2e73 7461 7274 7377 6974 6828  omId.startswith(
-00073ae0: 272a 2729 3a0a 2020 2020 2020 2020 2020  '*'):.          
-00073af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073b00: 2020 2020 2020 636f 6e74 696e 7565 0a0a        continue..
+00073a80: 2020 2020 2020 2020 2020 2020 2020 5f61                _a
+00073a90: 746f 6d53 656c 6563 7469 6f6e 2e61 7070  tomSelection.app
+00073aa0: 656e 6428 7365 6c65 6374 696f 6e29 0a20  end(selection). 
+00073ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073ac0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00073ad0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00073ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073af0: 2020 2020 2020 2020 2063 6364 4368 6563           ccdChec
+00073b00: 6b20 3d20 5472 7565 0a0a 2020 2020 2020  k = True..      
 00073b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073b20: 2020 2020 2020 2020 2020 2020 6966 2063              if c
-00073b30: 6364 4368 6563 6b20 616e 6420 636f 6d70  cdCheck and comp
-00073b40: 4964 2069 7320 6e6f 7420 4e6f 6e65 2061  Id is not None a
-00073b50: 6e64 205f 6174 6f6d 4964 206e 6f74 2069  nd _atomId not i
-00073b60: 6e20 5850 4c4f 525f 5244 435f 5052 494e  n XPLOR_RDC_PRIN
-00073b70: 4349 5041 4c5f 4158 4953 5f4e 414d 4553  CIPAL_AXIS_NAMES
-00073b80: 2061 6e64 205f 6174 6f6d 4964 206e 6f74   and _atomId not
-00073b90: 2069 6e20 5850 4c4f 525f 4e49 5452 4f58   in XPLOR_NITROX
-00073ba0: 4944 455f 4e41 4d45 533a 0a20 2020 2020  IDE_NAMES:.     
+00073b20: 2020 2020 2020 6966 2028 6c65 6e28 5f66        if (len(_f
+00073b30: 6163 746f 725b 2763 6861 696e 5f69 6427  actor['chain_id'
+00073b40: 5d29 203e 2031 206f 7220 6c65 6e28 5f66  ]) > 1 or len(_f
+00073b50: 6163 746f 725b 2773 6571 5f69 6427 5d29  actor['seq_id'])
+00073b60: 203e 2031 2920 616e 6420 6e6f 7420 6174   > 1) and not at
+00073b70: 6f6d 5370 6563 6966 6965 643a 0a20 2020  omSpecified:.   
+00073b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073b90: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
+00073ba0: 7469 6e75 650a 0a20 2020 2020 2020 2020  tinue..         
 00073bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073bc0: 2020 2020 2020 2020 2020 205f 636f 6d70             _comp
-00073bd0: 4964 4c69 7374 203d 204e 6f6e 6520 6966  IdList = None if
-00073be0: 2027 636f 6d70 5f69 6427 206e 6f74 2069   'comp_id' not i
-00073bf0: 6e20 5f66 6163 746f 7220 656c 7365 205b  n _factor else [
-00073c00: 7472 616e 736c 6174 6554 6f53 7464 5265  translateToStdRe
-00073c10: 734e 616d 6528 5f63 6f6d 7049 642c 2073  sName(_compId, s
-00073c20: 656c 662e 5f5f 6363 5529 2066 6f72 205f  elf.__ccU) for _
-00073c30: 636f 6d70 4964 2069 6e20 5f66 6163 746f  compId in _facto
-00073c40: 725b 2763 6f6d 705f 6964 275d 5d0a 2020  r['comp_id']].  
-00073c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073c60: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00073c70: 2073 656c 662e 5f5f 6363 552e 7570 6461   self.__ccU.upda
-00073c80: 7465 4368 656d 436f 6d70 4469 6374 2863  teChemCompDict(c
-00073c90: 6f6d 7049 6429 2061 6e64 2028 2763 6f6d  ompId) and ('com
-00073ca0: 705f 6964 2720 6e6f 7420 696e 205f 6661  p_id' not in _fa
-00073cb0: 6374 6f72 206f 7220 636f 6d70 4964 2069  ctor or compId i
-00073cc0: 6e20 5f63 6f6d 7049 644c 6973 7429 3a0a  n _compIdList):.
-00073cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073bc0: 2020 2069 6620 6973 506f 6c79 5365 7120     if isPolySeq 
+00073bd0: 616e 6420 2761 6d62 6967 5f61 7574 685f  and 'ambig_auth_
+00073be0: 7365 715f 6964 2720 696e 2070 7320 616e  seq_id' in ps an
+00073bf0: 6420 5f73 6571 4964 2069 6e20 7073 5b27  d _seqId in ps['
+00073c00: 616d 6269 675f 6175 7468 5f73 6571 5f69  ambig_auth_seq_i
+00073c10: 6427 5d3a 0a20 2020 2020 2020 2020 2020  d']:.           
+00073c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073c30: 2020 2020 2063 6f6e 7469 6e75 650a 0a20       continue.. 
+00073c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073c50: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+00073c60: 7420 6973 506f 6c79 5365 7120 616e 6420  t isPolySeq and 
+00073c70: 2761 6c74 5f61 7574 685f 7365 715f 6964  'alt_auth_seq_id
+00073c80: 2720 696e 2070 7320 616e 6420 5f73 6571  ' in ps and _seq
+00073c90: 4964 2069 6e20 7073 5b27 6175 7468 5f73  Id in ps['auth_s
+00073ca0: 6571 5f69 6427 5d20 616e 6420 5f73 6571  eq_id'] and _seq
+00073cb0: 4964 206e 6f74 2069 6e20 7073 5b27 616c  Id not in ps['al
+00073cc0: 745f 6175 7468 5f73 6571 5f69 6427 5d3a  t_auth_seq_id']:
+00073cd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00073ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073cf0: 2020 2020 6966 206c 656e 286f 7269 6741      if len(origA
-00073d00: 746f 6d49 6429 203e 2031 3a0a 2020 2020  tomId) > 1:.    
-00073d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073d30: 2020 2020 7479 7065 5379 6d62 6f6c 7320      typeSymbols 
-00073d40: 3d20 7365 7428 290a 2020 2020 2020 2020  = set().        
-00073d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073cf0: 2063 6f6e 7469 6e75 650a 0a20 2020 2020   continue..     
+00073d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073d10: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00073d20: 616e 6365 286f 7269 6741 746f 6d49 642c  ance(origAtomId,
+00073d30: 2073 7472 2920 616e 6420 6f72 6967 4174   str) and origAt
+00073d40: 6f6d 4964 2e73 7461 7274 7377 6974 6828  omId.startswith(
+00073d50: 272a 2729 3a0a 2020 2020 2020 2020 2020  '*'):.          
 00073d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073d70: 666f 7220 5f61 746f 6d49 645f 2069 6e20  for _atomId_ in 
-00073d80: 6f72 6967 4174 6f6d 4964 3a0a 2020 2020  origAtomId:.    
-00073d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073db0: 2020 2020 2020 2020 7479 7065 5379 6d62          typeSymb
-00073dc0: 6f6c 203d 206e 6578 7428 2863 6361 5b73  ol = next((cca[s
-00073dd0: 656c 662e 5f5f 6363 552e 6363 6154 7970  elf.__ccU.ccaTyp
-00073de0: 6553 796d 626f 6c5d 2066 6f72 2063 6361  eSymbol] for cca
-00073df0: 2069 6e20 7365 6c66 2e5f 5f63 6355 2e6c   in self.__ccU.l
-00073e00: 6173 7441 746f 6d4c 6973 7420 6966 2063  astAtomList if c
-00073e10: 6361 5b73 656c 662e 5f5f 6363 552e 6363  ca[self.__ccU.cc
-00073e20: 6141 746f 6d49 645d 203d 3d20 5f61 746f  aAtomId] == _ato
-00073e30: 6d49 645f 292c 204e 6f6e 6529 0a20 2020  mId_), None).   
-00073e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073e60: 2020 2020 2020 2020 2069 6620 7479 7065           if type
-00073e70: 5379 6d62 6f6c 2069 7320 6e6f 7420 4e6f  Symbol is not No
-00073e80: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00073e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073eb0: 2020 2020 7479 7065 5379 6d62 6f6c 732e      typeSymbols.
-00073ec0: 6164 6428 7479 7065 5379 6d62 6f6c 290a  add(typeSymbol).
-00073ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073f00: 6966 206c 656e 2874 7970 6553 796d 626f  if len(typeSymbo
-00073f10: 6c73 2920 3e20 313a 0a20 2020 2020 2020  ls) > 1:.       
-00073f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073f40: 2020 2020 2020 2020 2020 2020 2062 7265               bre
-00073f50: 616b 0a20 2020 2020 2020 2020 2020 2020  ak.             
-00073f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073f70: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-00073f80: 6e28 7479 7065 5379 6d62 6f6c 7329 203e  n(typeSymbols) >
-00073f90: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-00073fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073fc0: 636f 6e74 696e 7565 0a20 2020 2020 2020  continue.       
+00073d70: 2020 2020 2020 636f 6e74 696e 7565 0a0a        continue..
+00073d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073d90: 2020 2020 2020 2020 2020 2020 6966 2063              if c
+00073da0: 6364 4368 6563 6b20 616e 6420 636f 6d70  cdCheck and comp
+00073db0: 4964 2069 7320 6e6f 7420 4e6f 6e65 2061  Id is not None a
+00073dc0: 6e64 205f 6174 6f6d 4964 206e 6f74 2069  nd _atomId not i
+00073dd0: 6e20 5850 4c4f 525f 5244 435f 5052 494e  n XPLOR_RDC_PRIN
+00073de0: 4349 5041 4c5f 4158 4953 5f4e 414d 4553  CIPAL_AXIS_NAMES
+00073df0: 2061 6e64 205f 6174 6f6d 4964 206e 6f74   and _atomId not
+00073e00: 2069 6e20 5850 4c4f 525f 4e49 5452 4f58   in XPLOR_NITROX
+00073e10: 4944 455f 4e41 4d45 533a 0a20 2020 2020  IDE_NAMES:.     
+00073e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073e30: 2020 2020 2020 2020 2020 205f 636f 6d70             _comp
+00073e40: 4964 4c69 7374 203d 204e 6f6e 6520 6966  IdList = None if
+00073e50: 2027 636f 6d70 5f69 6427 206e 6f74 2069   'comp_id' not i
+00073e60: 6e20 5f66 6163 746f 7220 656c 7365 205b  n _factor else [
+00073e70: 7472 616e 736c 6174 6554 6f53 7464 5265  translateToStdRe
+00073e80: 734e 616d 6528 5f63 6f6d 7049 642c 2073  sName(_compId, s
+00073e90: 656c 662e 5f5f 6363 5529 2066 6f72 205f  elf.__ccU) for _
+00073ea0: 636f 6d70 4964 2069 6e20 5f66 6163 746f  compId in _facto
+00073eb0: 725b 2763 6f6d 705f 6964 275d 5d0a 2020  r['comp_id']].  
+00073ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073ed0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00073ee0: 2073 656c 662e 5f5f 6363 552e 7570 6461   self.__ccU.upda
+00073ef0: 7465 4368 656d 436f 6d70 4469 6374 2863  teChemCompDict(c
+00073f00: 6f6d 7049 6429 2061 6e64 2028 2763 6f6d  ompId) and ('com
+00073f10: 705f 6964 2720 6e6f 7420 696e 205f 6661  p_id' not in _fa
+00073f20: 6374 6f72 206f 7220 636f 6d70 4964 2069  ctor or compId i
+00073f30: 6e20 5f63 6f6d 7049 644c 6973 7429 3a0a  n _compIdList):.
+00073f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073f60: 2020 2020 6966 206c 656e 286f 7269 6741      if len(origA
+00073f70: 746f 6d49 6429 203e 2031 3a0a 2020 2020  tomId) > 1:.    
+00073f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073fa0: 2020 2020 7479 7065 5379 6d62 6f6c 7320      typeSymbols 
+00073fb0: 3d20 7365 7428 290a 2020 2020 2020 2020  = set().        
+00073fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00073fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073fe0: 2020 2020 2020 2020 2020 2020 2063 6361               cca
-00073ff0: 203d 206e 6578 7428 2863 6361 2066 6f72   = next((cca for
-00074000: 2063 6361 2069 6e20 7365 6c66 2e5f 5f63   cca in self.__c
-00074010: 6355 2e6c 6173 7441 746f 6d4c 6973 7420  cU.lastAtomList 
-00074020: 6966 2063 6361 5b73 656c 662e 5f5f 6363  if cca[self.__cc
-00074030: 552e 6363 6141 746f 6d49 645d 203d 3d20  U.ccaAtomId] == 
-00074040: 5f61 746f 6d49 6429 2c20 4e6f 6e65 290a  _atomId), None).
-00074050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074070: 2020 2020 6966 2063 6361 2069 7320 6e6f      if cca is no
-00074080: 7420 4e6f 6e65 2061 6e64 2063 6361 5b73  t None and cca[s
-00074090: 656c 662e 5f5f 6363 552e 6363 614c 6561  elf.__ccU.ccaLea
-000740a0: 7669 6e67 4174 6f6d 466c 6167 5d20 3d3d  vingAtomFlag] ==
-000740b0: 2027 5927 2061 6e64 2028 6e6f 7420 6174   'Y' and (not at
-000740c0: 6f6d 5370 6563 6966 6965 6420 6f72 206e  omSpecified or n
-000740d0: 6f74 2073 6571 5370 6563 6966 6965 6429  ot seqSpecified)
-000740e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000740f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074100: 2020 2020 2020 2020 2020 636f 6e74 696e            contin
-00074110: 7565 0a20 2020 2020 2020 2020 2020 2020  ue.             
-00074120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074130: 2020 2020 2020 2069 6620 6363 6120 6973         if cca is
-00074140: 206e 6f74 204e 6f6e 6520 616e 6420 2827   not None and ('
-00074150: 7479 7065 5f73 796d 626f 6c27 206e 6f74  type_symbol' not
-00074160: 2069 6e20 5f66 6163 746f 7220 6f72 2063   in _factor or c
-00074170: 6361 5b73 656c 662e 5f5f 6363 552e 6363  ca[self.__ccU.cc
-00074180: 6154 7970 6553 796d 626f 6c5d 2069 6e20  aTypeSymbol] in 
-00074190: 5f66 6163 746f 725b 2774 7970 655f 7379  _factor['type_sy
-000741a0: 6d62 6f6c 275d 293a 0a20 2020 2020 2020  mbol']):.       
-000741b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000741c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000741d0: 2073 656c 6563 7469 6f6e 203d 207b 2763   selection = {'c
-000741e0: 6861 696e 5f69 6427 3a20 6368 6169 6e49  hain_id': chainI
-000741f0: 642c 2027 7365 715f 6964 273a 2073 6571  d, 'seq_id': seq
-00074200: 4964 2c20 2763 6f6d 705f 6964 273a 2063  Id, 'comp_id': c
-00074210: 6f6d 7049 642c 2027 6174 6f6d 5f69 6427  ompId, 'atom_id'
-00074220: 3a20 5f61 746f 6d49 647d 0a20 2020 2020  : _atomId}.     
-00074230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073fe0: 666f 7220 5f61 746f 6d49 645f 2069 6e20  for _atomId_ in 
+00073ff0: 6f72 6967 4174 6f6d 4964 3a0a 2020 2020  origAtomId:.    
+00074000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074020: 2020 2020 2020 2020 7479 7065 5379 6d62          typeSymb
+00074030: 6f6c 203d 206e 6578 7428 2863 6361 5b73  ol = next((cca[s
+00074040: 656c 662e 5f5f 6363 552e 6363 6154 7970  elf.__ccU.ccaTyp
+00074050: 6553 796d 626f 6c5d 2066 6f72 2063 6361  eSymbol] for cca
+00074060: 2069 6e20 7365 6c66 2e5f 5f63 6355 2e6c   in self.__ccU.l
+00074070: 6173 7441 746f 6d4c 6973 7420 6966 2063  astAtomList if c
+00074080: 6361 5b73 656c 662e 5f5f 6363 552e 6363  ca[self.__ccU.cc
+00074090: 6141 746f 6d49 645d 203d 3d20 5f61 746f  aAtomId] == _ato
+000740a0: 6d49 645f 292c 204e 6f6e 6529 0a20 2020  mId_), None).   
+000740b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000740c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000740d0: 2020 2020 2020 2020 2069 6620 7479 7065           if type
+000740e0: 5379 6d62 6f6c 2069 7320 6e6f 7420 4e6f  Symbol is not No
+000740f0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00074100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074120: 2020 2020 7479 7065 5379 6d62 6f6c 732e      typeSymbols.
+00074130: 6164 6428 7479 7065 5379 6d62 6f6c 290a  add(typeSymbol).
+00074140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074170: 6966 206c 656e 2874 7970 6553 796d 626f  if len(typeSymbo
+00074180: 6c73 2920 3e20 313a 0a20 2020 2020 2020  ls) > 1:.       
+00074190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000741a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000741b0: 2020 2020 2020 2020 2020 2020 2062 7265               bre
+000741c0: 616b 0a20 2020 2020 2020 2020 2020 2020  ak.             
+000741d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000741e0: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+000741f0: 6e28 7479 7065 5379 6d62 6f6c 7329 203e  n(typeSymbols) >
+00074200: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+00074210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074230: 636f 6e74 696e 7565 0a20 2020 2020 2020  continue.       
 00074240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074250: 2020 2069 6620 6c65 6e28 7365 6c66 2e5f     if len(self._
-00074260: 5f63 7572 5f61 7574 685f 6174 6f6d 5f69  _cur_auth_atom_i
-00074270: 6429 203e 2030 3a0a 2020 2020 2020 2020  d) > 0:.        
-00074280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000742a0: 2020 2020 7365 6c65 6374 696f 6e5b 2761      selection['a
-000742b0: 7574 685f 6174 6f6d 5f69 6427 5d20 3d20  uth_atom_id'] = 
-000742c0: 7365 6c66 2e5f 5f63 7572 5f61 7574 685f  self.__cur_auth_
-000742d0: 6174 6f6d 5f69 640a 2020 2020 2020 2020  atom_id.        
-000742e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000742f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074300: 6966 205f 6174 6f6d 4964 2e73 7461 7274  if _atomId.start
-00074310: 7377 6974 6828 2748 4f50 2729 2061 6e64  swith('HOP') and
-00074320: 2069 7369 6e73 7461 6e63 6528 6f72 6967   isinstance(orig
-00074330: 4174 6f6d 4964 2c20 7374 7229 2061 6e64  AtomId, str) and
-00074340: 2027 2a27 2069 6e20 6f72 6967 4174 6f6d   '*' in origAtom
-00074350: 4964 3a0a 2020 2020 2020 2020 2020 2020  Id:.            
+00074250: 2020 2020 2020 2020 2020 2020 2063 6361               cca
+00074260: 203d 206e 6578 7428 2863 6361 2066 6f72   = next((cca for
+00074270: 2063 6361 2069 6e20 7365 6c66 2e5f 5f63   cca in self.__c
+00074280: 6355 2e6c 6173 7441 746f 6d4c 6973 7420  cU.lastAtomList 
+00074290: 6966 2063 6361 5b73 656c 662e 5f5f 6363  if cca[self.__cc
+000742a0: 552e 6363 6141 746f 6d49 645d 203d 3d20  U.ccaAtomId] == 
+000742b0: 5f61 746f 6d49 6429 2c20 4e6f 6e65 290a  _atomId), None).
+000742c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000742d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000742e0: 2020 2020 6966 2063 6361 2069 7320 6e6f      if cca is no
+000742f0: 7420 4e6f 6e65 2061 6e64 2063 6361 5b73  t None and cca[s
+00074300: 656c 662e 5f5f 6363 552e 6363 614c 6561  elf.__ccU.ccaLea
+00074310: 7669 6e67 4174 6f6d 466c 6167 5d20 3d3d  vingAtomFlag] ==
+00074320: 2027 5927 2061 6e64 2028 6e6f 7420 6174   'Y' and (not at
+00074330: 6f6d 5370 6563 6966 6965 6420 6f72 206e  omSpecified or n
+00074340: 6f74 2073 6571 5370 6563 6966 6965 6429  ot seqSpecified)
+00074350: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
 00074360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074380: 636f 6e74 696e 7565 0a20 2020 2020 2020  continue.       
+00074370: 2020 2020 2020 2020 2020 636f 6e74 696e            contin
+00074380: 7565 0a20 2020 2020 2020 2020 2020 2020  ue.             
 00074390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000743a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000743b0: 2069 6620 6e6f 7420 7365 7153 7065 6369   if not seqSpeci
-000743c0: 6669 6564 3a0a 2020 2020 2020 2020 2020  fied:.          
-000743d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000743e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000743f0: 2020 636f 6e74 696e 7565 0a20 2020 2020    continue.     
-00074400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074420: 2020 205f 6174 6f6d 5365 6c65 6374 696f     _atomSelectio
-00074430: 6e2e 6170 7065 6e64 2873 656c 6563 7469  n.append(selecti
-00074440: 6f6e 290a 2020 2020 2020 2020 2020 2020  on).            
-00074450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074460: 2020 2020 2020 2020 2020 2020 6966 2063              if c
-00074470: 6966 4368 6563 6b20 616e 6420 7365 714b  ifCheck and seqK
-00074480: 6579 206e 6f74 2069 6e20 7365 6c66 2e5f  ey not in self._
-00074490: 5f63 6f6f 7264 556e 6f62 7352 6573 2061  _coordUnobsRes a
-000744a0: 6e64 2073 656c 662e 5f5f 6363 552e 6c61  nd self.__ccU.la
-000744b0: 7374 4368 656d 436f 6d70 4469 6374 5b27  stChemCompDict['
-000744c0: 5f63 6865 6d5f 636f 6d70 2e70 6462 785f  _chem_comp.pdbx_
-000744d0: 7265 6c65 6173 655f 7374 6174 7573 275d  release_status']
-000744e0: 203d 3d20 2752 454c 273a 0a20 2020 2020   == 'REL':.     
+000743a0: 2020 2020 2020 2069 6620 6363 6120 6973         if cca is
+000743b0: 206e 6f74 204e 6f6e 6520 616e 6420 2827   not None and ('
+000743c0: 7479 7065 5f73 796d 626f 6c27 206e 6f74  type_symbol' not
+000743d0: 2069 6e20 5f66 6163 746f 7220 6f72 2063   in _factor or c
+000743e0: 6361 5b73 656c 662e 5f5f 6363 552e 6363  ca[self.__ccU.cc
+000743f0: 6154 7970 6553 796d 626f 6c5d 2069 6e20  aTypeSymbol] in 
+00074400: 5f66 6163 746f 725b 2774 7970 655f 7379  _factor['type_sy
+00074410: 6d62 6f6c 275d 293a 0a20 2020 2020 2020  mbol']):.       
+00074420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074440: 2073 656c 6563 7469 6f6e 203d 207b 2763   selection = {'c
+00074450: 6861 696e 5f69 6427 3a20 6368 6169 6e49  hain_id': chainI
+00074460: 642c 2027 7365 715f 6964 273a 2073 6571  d, 'seq_id': seq
+00074470: 4964 2c20 2763 6f6d 705f 6964 273a 2063  Id, 'comp_id': c
+00074480: 6f6d 7049 642c 2027 6174 6f6d 5f69 6427  ompId, 'atom_id'
+00074490: 3a20 5f61 746f 6d49 647d 0a20 2020 2020  : _atomId}.     
+000744a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000744b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000744c0: 2020 2069 6620 6c65 6e28 7365 6c66 2e5f     if len(self._
+000744d0: 5f63 7572 5f61 7574 685f 6174 6f6d 5f69  _cur_auth_atom_i
+000744e0: 6429 203e 2030 3a0a 2020 2020 2020 2020  d) > 0:.        
 000744f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00074500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074510: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
-00074520: 5f63 7572 5f73 7562 7479 7065 2021 3d20  _cur_subtype != 
-00074530: 2770 6c61 6e65 2720 616e 6420 636f 6f72  'plane' and coor
-00074540: 6441 746f 6d53 6974 6520 6973 206e 6f74  dAtomSite is not
-00074550: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00074510: 2020 2020 7365 6c65 6374 696f 6e5b 2761      selection['a
+00074520: 7574 685f 6174 6f6d 5f69 6427 5d20 3d20  uth_atom_id'] = 
+00074530: 7365 6c66 2e5f 5f63 7572 5f61 7574 685f  self.__cur_auth_
+00074540: 6174 6f6d 5f69 640a 2020 2020 2020 2020  atom_id.        
+00074550: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00074560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074580: 2020 2020 2020 2063 6865 636b 6564 203d         checked =
-00074590: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
-000745a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000745b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000745c0: 2020 2020 2020 2069 6620 7365 7149 6420         if seqId 
-000745d0: 3d3d 2031 206f 7220 2863 6861 696e 4964  == 1 or (chainId
-000745e0: 2c20 7365 7149 6420 2d20 3129 2069 6e20  , seqId - 1) in 
-000745f0: 7365 6c66 2e5f 5f63 6f6f 7264 556e 6f62  self.__coordUnob
-00074600: 7352 6573 206f 7220 7365 7149 6420 3d3d  sRes or seqId ==
-00074610: 2070 735b 2761 7574 685f 7365 715f 6964   ps['auth_seq_id
-00074620: 275d 5b30 5d3a 0a20 2020 2020 2020 2020  '][0]:.         
-00074630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074570: 6966 205f 6174 6f6d 4964 2e73 7461 7274  if _atomId.start
+00074580: 7377 6974 6828 2748 4f50 2729 2061 6e64  swith('HOP') and
+00074590: 2069 7369 6e73 7461 6e63 6528 6f72 6967   isinstance(orig
+000745a0: 4174 6f6d 4964 2c20 7374 7229 2061 6e64  AtomId, str) and
+000745b0: 2027 2a27 2069 6e20 6f72 6967 4174 6f6d   '*' in origAtom
+000745c0: 4964 3a0a 2020 2020 2020 2020 2020 2020  Id:.            
+000745d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000745e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000745f0: 636f 6e74 696e 7565 0a20 2020 2020 2020  continue.       
+00074600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074620: 2069 6620 6e6f 7420 7365 7153 7065 6369   if not seqSpeci
+00074630: 6669 6564 3a0a 2020 2020 2020 2020 2020  fied:.          
 00074640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074650: 2020 2020 2020 2020 2020 2069 6620 636f             if co
-00074660: 6f72 6441 746f 6d53 6974 6520 6973 206e  ordAtomSite is n
-00074670: 6f74 204e 6f6e 6520 616e 6420 2828 5f61  ot None and ((_a
-00074680: 746f 6d49 6420 696e 2061 6d69 6e6f 5072  tomId in aminoPr
-00074690: 6f74 6f6e 436f 6465 2061 6e64 2027 4831  otonCode and 'H1
-000746a0: 2720 696e 2061 746f 6d53 6974 6541 746f  ' in atomSiteAto
-000746b0: 6d49 6429 0a20 2020 2020 2020 2020 2020  mId).           
+00074650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074660: 2020 636f 6e74 696e 7565 0a20 2020 2020    continue.     
+00074670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074690: 2020 205f 6174 6f6d 5365 6c65 6374 696f     _atomSelectio
+000746a0: 6e2e 6170 7065 6e64 2873 656c 6563 7469  n.append(selecti
+000746b0: 6f6e 290a 2020 2020 2020 2020 2020 2020  on).            
 000746c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000746d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000746e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000746f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074700: 2020 2020 2020 2020 2020 206f 7220 5f61             or _a
-00074710: 746f 6d49 6420 3d3d 2027 5027 206f 7220  tomId == 'P' or 
-00074720: 5f61 746f 6d49 642e 7374 6172 7473 7769  _atomId.startswi
-00074730: 7468 2827 484f 5027 2929 3a0a 2020 2020  th('HOP')):.    
-00074740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000746d0: 2020 2020 2020 2020 2020 2020 6966 2063              if c
+000746e0: 6966 4368 6563 6b20 616e 6420 7365 714b  ifCheck and seqK
+000746f0: 6579 206e 6f74 2069 6e20 7365 6c66 2e5f  ey not in self._
+00074700: 5f63 6f6f 7264 556e 6f62 7352 6573 2061  _coordUnobsRes a
+00074710: 6e64 2073 656c 662e 5f5f 6363 552e 6c61  nd self.__ccU.la
+00074720: 7374 4368 656d 436f 6d70 4469 6374 5b27  stChemCompDict['
+00074730: 5f63 6865 6d5f 636f 6d70 2e70 6462 785f  _chem_comp.pdbx_
+00074740: 7265 6c65 6173 655f 7374 6174 7573 275d  release_status']
+00074750: 203d 3d20 2752 454c 273a 0a20 2020 2020   == 'REL':.     
 00074760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074770: 2020 2020 6368 6563 6b65 6420 3d20 5472      checked = Tr
-00074780: 7565 0a20 2020 2020 2020 2020 2020 2020  ue.             
-00074790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000747a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000747b0: 2020 2069 6620 5f61 746f 6d49 645b 305d     if _atomId[0]
-000747c0: 2069 6e20 7072 6f74 6f6e 4265 6769 6e43   in protonBeginC
-000747d0: 6f64 653a 0a20 2020 2020 2020 2020 2020  ode:.           
+00074770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074780: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
+00074790: 5f63 7572 5f73 7562 7479 7065 2021 3d20  _cur_subtype != 
+000747a0: 2770 6c61 6e65 2720 616e 6420 636f 6f72  'plane' and coor
+000747b0: 6441 746f 6d53 6974 6520 6973 206e 6f74  dAtomSite is not
+000747c0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+000747d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000747e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000747f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074800: 2020 2020 2020 2020 2062 6f6e 6465 6454           bondedT
-00074810: 6f20 3d20 7365 6c66 2e5f 5f63 6355 2e67  o = self.__ccU.g
-00074820: 6574 426f 6e64 6564 4174 6f6d 7328 636f  etBondedAtoms(co
-00074830: 6d70 4964 2c20 5f61 746f 6d49 6429 0a20  mpId, _atomId). 
-00074840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074870: 2020 2069 6620 6c65 6e28 626f 6e64 6564     if len(bonded
-00074880: 546f 2920 3e20 303a 0a20 2020 2020 2020  To) > 0:.       
-00074890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000747f0: 2020 2020 2020 2063 6865 636b 6564 203d         checked =
+00074800: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
+00074810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074830: 2020 2020 2020 2069 6620 7365 7149 6420         if seqId 
+00074840: 3d3d 2031 206f 7220 2863 6861 696e 4964  == 1 or (chainId
+00074850: 2c20 7365 7149 6420 2d20 3129 2069 6e20  , seqId - 1) in 
+00074860: 7365 6c66 2e5f 5f63 6f6f 7264 556e 6f62  self.__coordUnob
+00074870: 7352 6573 206f 7220 7365 7149 6420 3d3d  sRes or seqId ==
+00074880: 2070 735b 2761 7574 685f 7365 715f 6964   ps['auth_seq_id
+00074890: 275d 5b30 5d3a 0a20 2020 2020 2020 2020  '][0]:.         
 000748a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000748b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000748c0: 2069 6620 636f 6f72 6441 746f 6d53 6974   if coordAtomSit
-000748d0: 6520 6973 206e 6f74 204e 6f6e 6520 616e  e is not None an
-000748e0: 6420 626f 6e64 6564 546f 5b30 5d20 696e  d bondedTo[0] in
-000748f0: 2061 746f 6d53 6974 6541 746f 6d49 6420   atomSiteAtomId 
-00074900: 616e 6420 6363 615b 7365 6c66 2e5f 5f63  and cca[self.__c
-00074910: 6355 2e63 6361 4c65 6176 696e 6741 746f  cU.ccaLeavingAto
-00074920: 6d46 6c61 675d 2021 3d20 2759 273a 0a20  mFlag] != 'Y':. 
+000748c0: 2020 2020 2020 2020 2020 2069 6620 636f             if co
+000748d0: 6f72 6441 746f 6d53 6974 6520 6973 206e  ordAtomSite is n
+000748e0: 6f74 204e 6f6e 6520 616e 6420 2828 5f61  ot None and ((_a
+000748f0: 746f 6d49 6420 696e 2061 6d69 6e6f 5072  tomId in aminoPr
+00074900: 6f74 6f6e 436f 6465 2061 6e64 2027 4831  otonCode and 'H1
+00074910: 2720 696e 2061 746f 6d53 6974 6541 746f  ' in atomSiteAto
+00074920: 6d49 6429 0a20 2020 2020 2020 2020 2020  mId).           
 00074930: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00074940: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00074950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074960: 2020 2020 2020 2020 2020 2063 6865 636b             check
-00074970: 6564 203d 2054 7275 650a 2020 2020 2020  ed = True.      
-00074980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000749a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000749b0: 2020 2020 2020 6966 206c 656e 286f 7269        if len(ori
-000749c0: 6741 746f 6d49 6429 203d 3d20 313a 0a20  gAtomId) == 1:. 
+00074960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074970: 2020 2020 2020 2020 2020 206f 7220 5f61             or _a
+00074980: 746f 6d49 6420 3d3d 2027 5027 206f 7220  tomId == 'P' or 
+00074990: 5f61 746f 6d49 642e 7374 6172 7473 7769  _atomId.startswi
+000749a0: 7468 2827 484f 5027 2929 3a0a 2020 2020  th('HOP')):.    
+000749b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000749c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000749d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000749e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000749f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074a00: 2020 2020 2020 2020 2020 2020 2020 205f                 _
-00074a10: 6174 6f6d 5365 6c65 6374 696f 6e5b 2d31  atomSelection[-1
-00074a20: 5d5b 2768 7964 726f 6765 6e5f 6e6f 745f  ]['hydrogen_not_
-00074a30: 696e 7374 616e 7469 6174 6564 275d 203d  instantiated'] =
-00074a40: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
+000749e0: 2020 2020 6368 6563 6b65 6420 3d20 5472      checked = Tr
+000749f0: 7565 0a20 2020 2020 2020 2020 2020 2020  ue.             
+00074a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074a20: 2020 2069 6620 5f61 746f 6d49 645b 305d     if _atomId[0]
+00074a30: 2069 6e20 7072 6f74 6f6e 4265 6769 6e43   in protonBeginC
+00074a40: 6f64 653a 0a20 2020 2020 2020 2020 2020  ode:.           
 00074a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00074a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074a80: 2020 2020 2020 7365 6c66 2e5f 5f66 2e61        self.__f.a
-00074a90: 7070 656e 6428 6622 5b48 7964 726f 6765  ppend(f"[Hydroge
-00074aa0: 6e20 6e6f 7420 696e 7374 616e 7469 6174  n not instantiat
-00074ab0: 6564 5d20 7b73 656c 662e 5f5f 6765 7443  ed] {self.__getC
-00074ac0: 7572 7265 6e74 5265 7374 7261 696e 7428  urrentRestraint(
-00074ad0: 297d 220a 2020 2020 2020 2020 2020 2020  )}".            
-00074ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074a70: 2020 2020 2020 2020 2062 6f6e 6465 6454           bondedT
+00074a80: 6f20 3d20 7365 6c66 2e5f 5f63 6355 2e67  o = self.__ccU.g
+00074a90: 6574 426f 6e64 6564 4174 6f6d 7328 636f  etBondedAtoms(co
+00074aa0: 6d70 4964 2c20 5f61 746f 6d49 6429 0a20  mpId, _atomId). 
+00074ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074ae0: 2020 2069 6620 6c65 6e28 626f 6e64 6564     if len(bonded
+00074af0: 546f 2920 3e20 303a 0a20 2020 2020 2020  To) > 0:.       
 00074b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00074b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074b20: 2020 2020 6622 7b63 6861 696e 4964 7d3a      f"{chainId}:
-00074b30: 7b73 6571 4964 7d3a 7b63 6f6d 7049 647d  {seqId}:{compId}
-00074b40: 3a7b 6f72 6967 4174 6f6d 4964 7d20 6973  :{origAtomId} is
-00074b50: 206e 6f74 2070 726f 7065 726c 7920 696e   not properly in
-00074b60: 7374 616e 7469 6174 6564 2069 6e20 7468  stantiated in th
-00074b70: 6520 636f 6f72 6469 6e61 7465 732e 2022  e coordinates. "
-00074b80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00074b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074b30: 2069 6620 636f 6f72 6441 746f 6d53 6974   if coordAtomSit
+00074b40: 6520 6973 206e 6f74 204e 6f6e 6520 616e  e is not None an
+00074b50: 6420 626f 6e64 6564 546f 5b30 5d20 696e  d bondedTo[0] in
+00074b60: 2061 746f 6d53 6974 6541 746f 6d49 6420   atomSiteAtomId 
+00074b70: 616e 6420 6363 615b 7365 6c66 2e5f 5f63  and cca[self.__c
+00074b80: 6355 2e63 6361 4c65 6176 696e 6741 746f  cU.ccaLeavingAto
+00074b90: 6d46 6c61 675d 2021 3d20 2759 273a 0a20  mFlag] != 'Y':. 
 00074ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00074bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00074bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074bd0: 2022 506c 6561 7365 2072 652d 7570 6c6f   "Please re-uplo
-00074be0: 6164 2074 6865 206d 6f64 656c 2066 696c  ad the model fil
-00074bf0: 652e 2229 0a20 2020 2020 2020 2020 2020  e.").           
+00074bd0: 2020 2020 2020 2020 2020 2063 6865 636b             check
+00074be0: 6564 203d 2054 7275 650a 2020 2020 2020  ed = True.      
+00074bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00074c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00074c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074c20: 2020 2020 2069 6620 6e6f 7420 6368 6563       if not chec
-00074c30: 6b65 6420 616e 6420 6e6f 7420 7365 6c66  ked and not self
-00074c40: 2e5f 5f63 7572 5f75 6e69 6f6e 5f65 7870  .__cur_union_exp
-00074c50: 723a 0a20 2020 2020 2020 2020 2020 2020  r:.             
+00074c20: 2020 2020 2020 6966 206c 656e 286f 7269        if len(ori
+00074c30: 6741 746f 6d49 6429 203d 3d20 313a 0a20  gAtomId) == 1:. 
+00074c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00074c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074c80: 2020 2020 2020 2069 6620 6368 6169 6e49         if chainI
-00074c90: 6420 696e 204c 4152 4745 5f41 5359 4d5f  d in LARGE_ASYM_
-00074ca0: 4944 3a0a 2020 2020 2020 2020 2020 2020  ID:.            
-00074cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074c70: 2020 2020 2020 2020 2020 2020 2020 205f                 _
+00074c80: 6174 6f6d 5365 6c65 6374 696f 6e5b 2d31  atomSelection[-1
+00074c90: 5d5b 2768 7964 726f 6765 6e5f 6e6f 745f  ]['hydrogen_not_
+00074ca0: 696e 7374 616e 7469 6174 6564 275d 203d  instantiated'] =
+00074cb0: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
 00074cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074cd0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-00074ce0: 7350 6f6c 7953 6571 2061 6e64 206e 6f74  sPolySeq and not
-00074cf0: 2073 656c 662e 5f5f 7072 6566 6572 4175   self.__preferAu
-00074d00: 7468 5365 715c 0a20 2020 2020 2020 2020  thSeq\.         
-00074d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074d40: 2020 616e 6420 2827 6c61 6265 6c5f 7365    and ('label_se
-00074d50: 715f 6f66 6673 6574 2720 6e6f 7420 696e  q_offset' not in
-00074d60: 2073 656c 662e 7265 6173 6f6e 7346 6f72   self.reasonsFor
-00074d70: 5265 5061 7273 696e 670a 2020 2020 2020  ReParsing.      
+00074cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074cf0: 2020 2020 2020 7365 6c66 2e5f 5f66 2e61        self.__f.a
+00074d00: 7070 656e 6428 6622 5b48 7964 726f 6765  ppend(f"[Hydroge
+00074d10: 6e20 6e6f 7420 696e 7374 616e 7469 6174  n not instantiat
+00074d20: 6564 5d20 7b73 656c 662e 5f5f 6765 7443  ed] {self.__getC
+00074d30: 7572 7265 6e74 5265 7374 7261 696e 7428  urrentRestraint(
+00074d40: 297d 220a 2020 2020 2020 2020 2020 2020  )}".            
+00074d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00074d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074db0: 2020 2020 2020 2020 2020 6f72 2063 6861            or cha
-00074dc0: 696e 4964 206e 6f74 2069 6e20 7365 6c66  inId not in self
-00074dd0: 2e72 6561 736f 6e73 466f 7252 6550 6172  .reasonsForRePar
-00074de0: 7369 6e67 5b27 6c61 6265 6c5f 7365 715f  sing['label_seq_
-00074df0: 6f66 6673 6574 275d 293a 0a20 2020 2020  offset']):.     
+00074d90: 2020 2020 6622 7b63 6861 696e 4964 7d3a      f"{chainId}:
+00074da0: 7b73 6571 4964 7d3a 7b63 6f6d 7049 647d  {seqId}:{compId}
+00074db0: 3a7b 6f72 6967 4174 6f6d 4964 7d20 6973  :{origAtomId} is
+00074dc0: 206e 6f74 2070 726f 7065 726c 7920 696e   not properly in
+00074dd0: 7374 616e 7469 6174 6564 2069 6e20 7468  stantiated in th
+00074de0: 6520 636f 6f72 6469 6e61 7465 732e 2022  e coordinates. "
+00074df0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00074e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00074e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00074e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074e30: 2020 2020 2020 2069 6620 276c 6162 656c         if 'label
-00074e40: 5f73 6571 5f6f 6666 7365 7427 206e 6f74  _seq_offset' not
-00074e50: 2069 6e20 7365 6c66 2e72 6561 736f 6e73   in self.reasons
-00074e60: 466f 7252 6550 6172 7369 6e67 3a0a 2020  ForReParsing:.  
+00074e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074e40: 2022 506c 6561 7365 2072 652d 7570 6c6f   "Please re-uplo
+00074e50: 6164 2074 6865 206d 6f64 656c 2066 696c  ad the model fil
+00074e60: 652e 2229 0a20 2020 2020 2020 2020 2020  e.").           
 00074e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00074e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074ea0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00074eb0: 6c66 2e72 6561 736f 6e73 466f 7252 6550  lf.reasonsForReP
-00074ec0: 6172 7369 6e67 5b27 6c61 6265 6c5f 7365  arsing['label_se
-00074ed0: 715f 6f66 6673 6574 275d 203d 207b 7d0a  q_offset'] = {}.
+00074e90: 2020 2020 2069 6620 6e6f 7420 6368 6563       if not chec
+00074ea0: 6b65 6420 616e 6420 6e6f 7420 7365 6c66  ked and not self
+00074eb0: 2e5f 5f63 7572 5f75 6e69 6f6e 5f65 7870  .__cur_union_exp
+00074ec0: 723a 0a20 2020 2020 2020 2020 2020 2020  r:.             
+00074ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00074ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074f10: 2020 2020 2020 2020 2020 2020 6f66 6673              offs
-00074f20: 6574 203d 2073 656c 662e 6765 744c 6162  et = self.getLab
-00074f30: 656c 5365 714f 6666 7365 7444 7565 546f  elSeqOffsetDueTo
-00074f40: 556e 6f62 7328 7073 290a 2020 2020 2020  Unobs(ps).      
-00074f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074f80: 2020 2020 2020 7365 6c66 2e72 6561 736f        self.reaso
-00074f90: 6e73 466f 7252 6550 6172 7369 6e67 5b27  nsForReParsing['
-00074fa0: 6c61 6265 6c5f 7365 715f 6f66 6673 6574  label_seq_offset
-00074fb0: 275d 5b63 6861 696e 4964 5d20 3d20 6f66  '][chainId] = of
-00074fc0: 6673 6574 0a20 2020 2020 2020 2020 2020  fset.           
-00074fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074ef0: 2020 2020 2020 2069 6620 6368 6169 6e49         if chainI
+00074f00: 6420 696e 204c 4152 4745 5f41 5359 4d5f  d in LARGE_ASYM_
+00074f10: 4944 3a0a 2020 2020 2020 2020 2020 2020  ID:.            
+00074f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074f40: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00074f50: 7350 6f6c 7953 6571 2061 6e64 206e 6f74  sPolySeq and not
+00074f60: 2073 656c 662e 5f5f 7072 6566 6572 4175   self.__preferAu
+00074f70: 7468 5365 715c 0a20 2020 2020 2020 2020  thSeq\.         
+00074f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00074fb0: 2020 616e 6420 2827 6c61 6265 6c5f 7365    and ('label_se
+00074fc0: 715f 6f66 6673 6574 2720 6e6f 7420 696e  q_offset' not in
+00074fd0: 2073 656c 662e 7265 6173 6f6e 7346 6f72   self.reasonsFor
+00074fe0: 5265 5061 7273 696e 670a 2020 2020 2020  ReParsing.      
 00074ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075000: 2069 6620 6f66 6673 6574 2021 3d20 303a   if offset != 0:
-00075010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00075020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075050: 2073 656c 662e 7265 6173 6f6e 7346 6f72   self.reasonsFor
-00075060: 5265 5061 7273 696e 675b 276c 6162 656c  ReParsing['label
-00075070: 5f73 6571 5f73 6368 656d 6527 5d20 3d20  _seq_scheme'] = 
-00075080: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
+00075000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075020: 2020 2020 2020 2020 2020 6f72 2063 6861            or cha
+00075030: 696e 4964 206e 6f74 2069 6e20 7365 6c66  inId not in self
+00075040: 2e72 6561 736f 6e73 466f 7252 6550 6172  .reasonsForRePar
+00075050: 7369 6e67 5b27 6c61 6265 6c5f 7365 715f  sing['label_seq_
+00075060: 6f66 6673 6574 275d 293a 0a20 2020 2020  offset']):.     
+00075070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075080: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00075090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000750a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000750b0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000750c0: 7365 7149 6420 3c20 3120 616e 6420 6c65  seqId < 1 and le
-000750d0: 6e28 7365 6c66 2e5f 5f70 6f6c 7953 6571  n(self.__polySeq
-000750e0: 2920 3d3d 2031 3a0a 2020 2020 2020 2020  ) == 1:.        
+000750a0: 2020 2020 2020 2069 6620 276c 6162 656c         if 'label
+000750b0: 5f73 6571 5f6f 6666 7365 7427 206e 6f74  _seq_offset' not
+000750c0: 2069 6e20 7365 6c66 2e72 6561 736f 6e73   in self.reasons
+000750d0: 466f 7252 6550 6172 7369 6e67 3a0a 2020  ForReParsing:.  
+000750e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000750f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00075100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075120: 2020 2020 7365 6c66 2e5f 5f66 2e61 7070      self.__f.app
-00075130: 656e 6428 6622 5b41 746f 6d20 6e6f 7420  end(f"[Atom not 
-00075140: 666f 756e 645d 207b 7365 6c66 2e5f 5f67  found] {self.__g
-00075150: 6574 4375 7272 656e 7452 6573 7472 6169  etCurrentRestrai
-00075160: 6e74 2829 7d22 0a20 2020 2020 2020 2020  nt()}".         
+00075110: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00075120: 6c66 2e72 6561 736f 6e73 466f 7252 6550  lf.reasonsForReP
+00075130: 6172 7369 6e67 5b27 6c61 6265 6c5f 7365  arsing['label_se
+00075140: 715f 6f66 6673 6574 275d 203d 207b 7d0a  q_offset'] = {}.
+00075150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075160: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00075170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000751a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000751b0: 2020 2066 227b 6368 6169 6e49 647d 3a7b     f"{chainId}:{
-000751c0: 7365 7149 647d 3a7b 636f 6d70 4964 7d3a  seqId}:{compId}:
-000751d0: 7b6f 7269 6741 746f 6d49 647d 2069 7320  {origAtomId} is 
-000751e0: 6e6f 7420 7072 6573 656e 7420 696e 2074  not present in t
-000751f0: 6865 2063 6f6f 7264 696e 6174 6573 2e20  he coordinates. 
-00075200: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00075210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075240: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-00075250: 5468 6520 7265 7369 6475 6520 6e75 6d62  The residue numb
-00075260: 6572 2027 7b73 6571 4964 7d27 2069 7320  er '{seqId}' is 
-00075270: 6e6f 7420 7072 6573 656e 7420 220a 2020  not present ".  
-00075280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075180: 2020 2020 2020 2020 2020 2020 6f66 6673              offs
+00075190: 6574 203d 2073 656c 662e 6765 744c 6162  et = self.getLab
+000751a0: 656c 5365 714f 6666 7365 7444 7565 546f  elSeqOffsetDueTo
+000751b0: 556e 6f62 7328 7073 290a 2020 2020 2020  Unobs(ps).      
+000751c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000751d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000751e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000751f0: 2020 2020 2020 7365 6c66 2e72 6561 736f        self.reaso
+00075200: 6e73 466f 7252 6550 6172 7369 6e67 5b27  nsForReParsing['
+00075210: 6c61 6265 6c5f 7365 715f 6f66 6673 6574  label_seq_offset
+00075220: 275d 5b63 6861 696e 4964 5d20 3d20 6f66  '][chainId] = of
+00075230: 6673 6574 0a20 2020 2020 2020 2020 2020  fset.           
+00075240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075270: 2069 6620 6f66 6673 6574 2021 3d20 303a   if offset != 0:
+00075280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00075290: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000752a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000752b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000752c0: 2020 2020 2020 2020 2020 6622 696e 2070            f"in p
-000752d0: 6f6c 796d 6572 2073 6571 7565 6e63 6520  olymer sequence 
-000752e0: 6f66 2063 6861 696e 207b 6368 6169 6e49  of chain {chainI
-000752f0: 647d 206f 6620 7468 6520 636f 6f72 6469  d} of the coordi
-00075300: 6e61 7465 732e 2022 0a20 2020 2020 2020  nates. ".       
+000752c0: 2073 656c 662e 7265 6173 6f6e 7346 6f72   self.reasonsFor
+000752d0: 5265 5061 7273 696e 675b 276c 6162 656c  ReParsing['label
+000752e0: 5f73 6571 5f73 6368 656d 6527 5d20 3d20  _seq_scheme'] = 
+000752f0: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
+00075300: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00075310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075350: 2020 2020 2022 506c 6561 7365 2075 7064       "Please upd
-00075360: 6174 6520 7468 6520 7365 7175 656e 6365  ate the sequence
-00075370: 2069 6e20 7468 6520 4d61 6372 6f6d 6f6c   in the Macromol
-00075380: 6563 756c 6573 2070 6167 652e 2229 0a20  ecules page."). 
-00075390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000753a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000753b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000753c0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-000753d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075320: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00075330: 7365 7149 6420 3c20 3120 616e 6420 6c65  seqId < 1 and le
+00075340: 6e28 7365 6c66 2e5f 5f70 6f6c 7953 6571  n(self.__polySeq
+00075350: 2920 3d3d 2031 3a0a 2020 2020 2020 2020  ) == 1:.        
+00075360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075390: 2020 2020 7365 6c66 2e5f 5f66 2e61 7070      self.__f.app
+000753a0: 656e 6428 6622 5b41 746f 6d20 6e6f 7420  end(f"[Atom not 
+000753b0: 666f 756e 645d 207b 7365 6c66 2e5f 5f67  found] {self.__g
+000753c0: 6574 4375 7272 656e 7452 6573 7472 6169  etCurrentRestrai
+000753d0: 6e74 2829 7d22 0a20 2020 2020 2020 2020  nt()}".         
 000753e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000753f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075400: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
-00075410: 662e 6170 7065 6e64 2866 225b 4174 6f6d  f.append(f"[Atom
-00075420: 206e 6f74 2066 6f75 6e64 5d20 7b73 656c   not found] {sel
-00075430: 662e 5f5f 6765 7443 7572 7265 6e74 5265  f.__getCurrentRe
-00075440: 7374 7261 696e 7428 297d 220a 2020 2020  straint()}".    
-00075450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075420: 2020 2066 227b 6368 6169 6e49 647d 3a7b     f"{chainId}:{
+00075430: 7365 7149 647d 3a7b 636f 6d70 4964 7d3a  seqId}:{compId}:
+00075440: 7b6f 7269 6741 746f 6d49 647d 2069 7320  {origAtomId} is 
+00075450: 6e6f 7420 7072 6573 656e 7420 696e 2074  not present in t
+00075460: 6865 2063 6f6f 7264 696e 6174 6573 2e20  he coordinates. 
+00075470: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
 00075480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075490: 2020 2020 2020 2020 6622 7b63 6861 696e          f"{chain
-000754a0: 4964 7d3a 7b73 6571 4964 7d3a 7b63 6f6d  Id}:{seqId}:{com
-000754b0: 7049 647d 3a7b 6f72 6967 4174 6f6d 4964  pId}:{origAtomId
-000754c0: 7d20 6973 206e 6f74 2070 7265 7365 6e74  } is not present
-000754d0: 2069 6e20 7468 6520 636f 6f72 6469 6e61   in the coordina
-000754e0: 7465 732e 2229 0a20 2020 2020 2020 2020  tes.").         
+00075490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000754a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000754b0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+000754c0: 5468 6520 7265 7369 6475 6520 6e75 6d62  The residue numb
+000754d0: 6572 2027 7b73 6571 4964 7d27 2069 7320  er '{seqId}' is 
+000754e0: 6e6f 7420 7072 6573 656e 7420 220a 2020  not present ".  
 000754f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075500: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00075510: 6363 6120 6973 204e 6f6e 6520 616e 6420  cca is None and 
-00075520: 2774 7970 655f 7379 6d62 6f6c 2720 6e6f  'type_symbol' no
-00075530: 7420 696e 205f 6661 6374 6f72 2061 6e64  t in _factor and
-00075540: 2027 6174 6f6d 5f69 6473 2720 6e6f 7420   'atom_ids' not 
-00075550: 696e 205f 6661 6374 6f72 3a0a 2020 2020  in _factor:.    
-00075560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075580: 2020 2020 6966 2073 6571 4964 203d 3d20      if seqId == 
-00075590: 3120 6f72 2028 6368 6169 6e49 642c 2073  1 or (chainId, s
-000755a0: 6571 4964 202d 2031 2920 696e 2073 656c  eqId - 1) in sel
-000755b0: 662e 5f5f 636f 6f72 6455 6e6f 6273 5265  f.__coordUnobsRe
-000755c0: 7320 6f72 2073 6571 4964 203d 3d20 7073  s or seqId == ps
-000755d0: 5b27 6175 7468 5f73 6571 5f69 6427 5d5b  ['auth_seq_id'][
-000755e0: 305d 3a0a 2020 2020 2020 2020 2020 2020  0]:.            
-000755f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075530: 2020 2020 2020 2020 2020 6622 696e 2070            f"in p
+00075540: 6f6c 796d 6572 2073 6571 7565 6e63 6520  olymer sequence 
+00075550: 6f66 2063 6861 696e 207b 6368 6169 6e49  of chain {chainI
+00075560: 647d 206f 6620 7468 6520 636f 6f72 6469  d} of the coordi
+00075570: 6e61 7465 732e 2022 0a20 2020 2020 2020  nates. ".       
+00075580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000755a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000755b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000755c0: 2020 2020 2022 506c 6561 7365 2075 7064       "Please upd
+000755d0: 6174 6520 7468 6520 7365 7175 656e 6365  ate the sequence
+000755e0: 2069 6e20 7468 6520 4d61 6372 6f6d 6f6c   in the Macromol
+000755f0: 6563 756c 6573 2070 6167 652e 2229 0a20  ecules page."). 
 00075600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075610: 6966 2063 6f6f 7264 4174 6f6d 5369 7465  if coordAtomSite
-00075620: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
-00075630: 2028 285f 6174 6f6d 4964 2069 6e20 616d   ((_atomId in am
-00075640: 696e 6f50 726f 746f 6e43 6f64 6520 616e  inoProtonCode an
-00075650: 6420 2748 3127 2069 6e20 6174 6f6d 5369  d 'H1' in atomSi
-00075660: 7465 4174 6f6d 4964 290a 2020 2020 2020  teAtomId).      
-00075670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000756a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000756b0: 2020 2020 2020 2020 6f72 205f 6174 6f6d          or _atom
-000756c0: 4964 203d 3d20 2750 2720 6f72 205f 6174  Id == 'P' or _at
-000756d0: 6f6d 4964 2e73 7461 7274 7377 6974 6828  omId.startswith(
-000756e0: 2748 4f50 2729 293a 0a20 2020 2020 2020  'HOP')):.       
+00075610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075630: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00075640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075670: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
+00075680: 662e 6170 7065 6e64 2866 225b 4174 6f6d  f.append(f"[Atom
+00075690: 206e 6f74 2066 6f75 6e64 5d20 7b73 656c   not found] {sel
+000756a0: 662e 5f5f 6765 7443 7572 7265 6e74 5265  f.__getCurrentRe
+000756b0: 7374 7261 696e 7428 297d 220a 2020 2020  straint()}".    
+000756c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000756d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000756e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000756f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075710: 2020 2020 2020 2020 2063 6f6e 7469 6e75           continu
-00075720: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00075730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075740: 2020 2020 2020 2020 2020 2320 2222 220a            # """.
-00075750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075700: 2020 2020 2020 2020 6622 7b63 6861 696e          f"{chain
+00075710: 4964 7d3a 7b73 6571 4964 7d3a 7b63 6f6d  Id}:{seqId}:{com
+00075720: 7049 647d 3a7b 6f72 6967 4174 6f6d 4964  pId}:{origAtomId
+00075730: 7d20 6973 206e 6f74 2070 7265 7365 6e74  } is not present
+00075740: 2069 6e20 7468 6520 636f 6f72 6469 6e61   in the coordina
+00075750: 7465 732e 2229 0a20 2020 2020 2020 2020  tes.").         
 00075760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075770: 2020 2020 2020 2020 2320 6966 2073 656c          # if sel
-00075780: 662e 5f5f 7265 6173 6f6e 7320 6973 204e  f.__reasons is N
-00075790: 6f6e 6520 616e 6420 7365 714b 6579 2069  one and seqKey i
-000757a0: 6e20 7365 6c66 2e5f 5f61 7574 6854 6f4c  n self.__authToL
-000757b0: 6162 656c 5365 713a 0a20 2020 2020 2020  abelSeq:.       
-000757c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075770: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00075780: 6363 6120 6973 204e 6f6e 6520 616e 6420  cca is None and 
+00075790: 2774 7970 655f 7379 6d62 6f6c 2720 6e6f  'type_symbol' no
+000757a0: 7420 696e 205f 6661 6374 6f72 2061 6e64  t in _factor and
+000757b0: 2027 6174 6f6d 5f69 6473 2720 6e6f 7420   'atom_ids' not 
+000757c0: 696e 205f 6661 6374 6f72 3a0a 2020 2020  in _factor:.    
 000757d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000757e0: 2023 2020 2020 205f 2c20 5f73 6571 4964   #     _, _seqId
-000757f0: 203d 2073 656c 662e 5f5f 6175 7468 546f   = self.__authTo
-00075800: 4c61 6265 6c53 6571 5b73 6571 4b65 795d  LabelSeq[seqKey]
-00075810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00075820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075830: 2020 2020 2020 2020 2023 2020 2020 2069           #     i
-00075840: 6620 7073 2069 7320 6e6f 7420 4e6f 6e65  f ps is not None
-00075850: 2061 6e64 205f 7365 7149 6420 696e 2070   and _seqId in p
-00075860: 735b 2761 7574 685f 7365 715f 6964 275d  s['auth_seq_id']
-00075870: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00075880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075890: 2020 2020 2020 2020 2020 2320 2020 2020            #     
-000758a0: 2020 2020 5f63 6f6d 7049 6420 3d20 7073      _compId = ps
-000758b0: 5b27 636f 6d70 5f69 6427 5d5b 7073 5b27  ['comp_id'][ps['
-000758c0: 6175 7468 5f73 6571 5f69 6427 5d2e 696e  auth_seq_id'].in
-000758d0: 6465 7828 5f73 6571 4964 295d 0a20 2020  dex(_seqId)].   
+000757e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000757f0: 2020 2020 6966 2073 6571 4964 203d 3d20      if seqId == 
+00075800: 3120 6f72 2028 6368 6169 6e49 642c 2073  1 or (chainId, s
+00075810: 6571 4964 202d 2031 2920 696e 2073 656c  eqId - 1) in sel
+00075820: 662e 5f5f 636f 6f72 6455 6e6f 6273 5265  f.__coordUnobsRe
+00075830: 7320 6f72 2073 6571 4964 203d 3d20 7073  s or seqId == ps
+00075840: 5b27 6175 7468 5f73 6571 5f69 6427 5d5b  ['auth_seq_id'][
+00075850: 305d 3a0a 2020 2020 2020 2020 2020 2020  0]:.            
+00075860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075880: 6966 2063 6f6f 7264 4174 6f6d 5369 7465  if coordAtomSite
+00075890: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
+000758a0: 2028 285f 6174 6f6d 4964 2069 6e20 616d   ((_atomId in am
+000758b0: 696e 6f50 726f 746f 6e43 6f64 6520 616e  inoProtonCode an
+000758c0: 6420 2748 3127 2069 6e20 6174 6f6d 5369  d 'H1' in atomSi
+000758d0: 7465 4174 6f6d 4964 290a 2020 2020 2020  teAtomId).      
 000758e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000758f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075900: 2020 2020 2023 2020 2020 2020 2020 2069       #         i
-00075910: 6620 7365 6c66 2e5f 5f63 6355 2e75 7064  f self.__ccU.upd
-00075920: 6174 6543 6865 6d43 6f6d 7044 6963 7428  ateChemCompDict(
-00075930: 5f63 6f6d 7049 6429 3a0a 2020 2020 2020  _compId):.      
-00075940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075960: 2020 2320 2020 2020 2020 2020 2020 2020    #             
-00075970: 6363 6120 3d20 6e65 7874 2828 6363 6120  cca = next((cca 
-00075980: 666f 7220 6363 6120 696e 2073 656c 662e  for cca in self.
-00075990: 5f5f 6363 552e 6c61 7374 4174 6f6d 4c69  __ccU.lastAtomLi
-000759a0: 7374 2069 6620 6363 615b 7365 6c66 2e5f  st if cca[self._
-000759b0: 5f63 6355 2e63 6361 4174 6f6d 4964 5d20  _ccU.ccaAtomId] 
-000759c0: 3d3d 205f 6174 6f6d 4964 292c 204e 6f6e  == _atomId), Non
-000759d0: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
-000759e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000759f0: 2020 2020 2020 2020 2020 2023 2020 2020             #    
-00075a00: 2020 2020 2020 2020 2069 6620 6363 6120           if cca 
-00075a10: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-00075a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075920: 2020 2020 2020 2020 6f72 205f 6174 6f6d          or _atom
+00075930: 4964 203d 3d20 2750 2720 6f72 205f 6174  Id == 'P' or _at
+00075940: 6f6d 4964 2e73 7461 7274 7377 6974 6828  omId.startswith(
+00075950: 2748 4f50 2729 293a 0a20 2020 2020 2020  'HOP')):.       
+00075960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075980: 2020 2020 2020 2020 2063 6f6e 7469 6e75           continu
+00075990: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+000759a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000759b0: 2020 2020 2020 2020 2020 2320 2222 220a            # """.
+000759c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000759d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000759e0: 2020 2020 2020 2020 2320 6966 2073 656c          # if sel
+000759f0: 662e 5f5f 7265 6173 6f6e 7320 6973 204e  f.__reasons is N
+00075a00: 6f6e 6520 616e 6420 7365 714b 6579 2069  one and seqKey i
+00075a10: 6e20 7365 6c66 2e5f 5f61 7574 6854 6f4c  n self.__authToL
+00075a20: 6162 656c 5365 713a 0a20 2020 2020 2020  abelSeq:.       
 00075a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075a40: 2020 2020 2023 2020 2020 2020 2020 2020       #          
-00075a50: 2020 2020 2020 2069 6620 276c 6162 656c         if 'label
-00075a60: 5f73 6571 5f73 6368 656d 6527 206e 6f74  _seq_scheme' not
-00075a70: 2069 6e20 7365 6c66 2e72 6561 736f 6e73   in self.reasons
-00075a80: 466f 7252 6550 6172 7369 6e67 3a0a 2020  ForReParsing:.  
+00075a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075a50: 2023 2020 2020 205f 2c20 5f73 6571 4964   #     _, _seqId
+00075a60: 203d 2073 656c 662e 5f5f 6175 7468 546f   = self.__authTo
+00075a70: 4c61 6265 6c53 6571 5b73 6571 4b65 795d  LabelSeq[seqKey]
+00075a80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00075a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075ab0: 2020 2020 2020 2320 2020 2020 2020 2020        #         
-00075ac0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00075ad0: 2e72 6561 736f 6e73 466f 7252 6550 6172  .reasonsForRePar
-00075ae0: 7369 6e67 5b27 6c61 6265 6c5f 7365 715f  sing['label_seq_
-00075af0: 7363 6865 6d65 275d 203d 2054 7275 650a  scheme'] = True.
-00075b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075b20: 2020 2020 2020 2020 2320 2222 220a 2020          # """.  
-00075b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075b50: 2020 2020 2020 6966 2063 6966 4368 6563        if cifChec
-00075b60: 6b20 616e 6420 7365 6c66 2e5f 5f63 7572  k and self.__cur
-00075b70: 5f73 7562 7479 7065 2021 3d20 2770 6c61  _subtype != 'pla
-00075b80: 6e65 275c 0a20 2020 2020 2020 2020 2020  ne'\.           
-00075b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075bb0: 616e 6420 2773 6571 5f69 6427 2069 6e20  and 'seq_id' in 
-00075bc0: 5f66 6163 746f 7220 616e 6420 6c65 6e28  _factor and len(
-00075bd0: 5f66 6163 746f 725b 2773 6571 5f69 6427  _factor['seq_id'
-00075be0: 5d29 203d 3d20 315c 0a20 2020 2020 2020  ]) == 1\.       
-00075bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075c10: 2020 2020 616e 6420 2873 656c 662e 5f5f      and (self.__
-00075c20: 7265 6173 6f6e 7320 6973 204e 6f6e 6520  reasons is None 
-00075c30: 6f72 2027 6e6f 6e5f 706f 6c79 5f72 656d  or 'non_poly_rem
-00075c40: 6170 2720 6e6f 7420 696e 2073 656c 662e  ap' not in self.
-00075c50: 5f5f 7265 6173 6f6e 7329 5c0a 2020 2020  __reasons)\.    
-00075c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075c80: 2020 2020 2020 2061 6e64 206e 6f74 2073         and not s
-00075c90: 656c 662e 5f5f 6375 725f 756e 696f 6e5f  elf.__cur_union_
-00075ca0: 6578 7072 3a0a 2020 2020 2020 2020 2020  expr:.          
-00075cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075cd0: 2020 6966 2063 6861 696e 4964 2069 6e20    if chainId in 
-00075ce0: 4c41 5247 455f 4153 594d 5f49 443a 0a20  LARGE_ASYM_ID:. 
-00075cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075aa0: 2020 2020 2020 2020 2023 2020 2020 2069           #     i
+00075ab0: 6620 7073 2069 7320 6e6f 7420 4e6f 6e65  f ps is not None
+00075ac0: 2061 6e64 205f 7365 7149 6420 696e 2070   and _seqId in p
+00075ad0: 735b 2761 7574 685f 7365 715f 6964 275d  s['auth_seq_id']
+00075ae0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00075af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075b00: 2020 2020 2020 2020 2020 2320 2020 2020            #     
+00075b10: 2020 2020 5f63 6f6d 7049 6420 3d20 7073      _compId = ps
+00075b20: 5b27 636f 6d70 5f69 6427 5d5b 7073 5b27  ['comp_id'][ps['
+00075b30: 6175 7468 5f73 6571 5f69 6427 5d2e 696e  auth_seq_id'].in
+00075b40: 6465 7828 5f73 6571 4964 295d 0a20 2020  dex(_seqId)].   
+00075b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075b70: 2020 2020 2023 2020 2020 2020 2020 2069       #         i
+00075b80: 6620 7365 6c66 2e5f 5f63 6355 2e75 7064  f self.__ccU.upd
+00075b90: 6174 6543 6865 6d43 6f6d 7044 6963 7428  ateChemCompDict(
+00075ba0: 5f63 6f6d 7049 6429 3a0a 2020 2020 2020  _compId):.      
+00075bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075bd0: 2020 2320 2020 2020 2020 2020 2020 2020    #             
+00075be0: 6363 6120 3d20 6e65 7874 2828 6363 6120  cca = next((cca 
+00075bf0: 666f 7220 6363 6120 696e 2073 656c 662e  for cca in self.
+00075c00: 5f5f 6363 552e 6c61 7374 4174 6f6d 4c69  __ccU.lastAtomLi
+00075c10: 7374 2069 6620 6363 615b 7365 6c66 2e5f  st if cca[self._
+00075c20: 5f63 6355 2e63 6361 4174 6f6d 4964 5d20  _ccU.ccaAtomId] 
+00075c30: 3d3d 205f 6174 6f6d 4964 292c 204e 6f6e  == _atomId), Non
+00075c40: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
+00075c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075c60: 2020 2020 2020 2020 2020 2023 2020 2020             #    
+00075c70: 2020 2020 2020 2020 2069 6620 6363 6120           if cca 
+00075c80: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+00075c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075cb0: 2020 2020 2023 2020 2020 2020 2020 2020       #          
+00075cc0: 2020 2020 2020 2069 6620 276c 6162 656c         if 'label
+00075cd0: 5f73 6571 5f73 6368 656d 6527 206e 6f74  _seq_scheme' not
+00075ce0: 2069 6e20 7365 6c66 2e72 6561 736f 6e73   in self.reasons
+00075cf0: 466f 7252 6550 6172 7369 6e67 3a0a 2020  ForReParsing:.  
 00075d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075d10: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00075d20: 6620 7365 7149 6420 3c20 3120 616e 6420  f seqId < 1 and 
-00075d30: 6c65 6e28 7365 6c66 2e5f 5f70 6f6c 7953  len(self.__polyS
-00075d40: 6571 2920 3d3d 2031 3a0a 2020 2020 2020  eq) == 1:.      
-00075d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075d70: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00075d80: 6c66 2e5f 5f66 2e61 7070 656e 6428 6622  lf.__f.append(f"
-00075d90: 5b41 746f 6d20 6e6f 7420 666f 756e 645d  [Atom not found]
-00075da0: 207b 7365 6c66 2e5f 5f67 6574 4375 7272   {self.__getCurr
-00075db0: 656e 7452 6573 7472 6169 6e74 2829 7d22  entRestraint()}"
-00075dc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00075dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075e00: 2020 2020 2066 227b 6368 6169 6e49 647d       f"{chainId}
-00075e10: 3a7b 7365 7149 647d 3a7b 636f 6d70 4964  :{seqId}:{compId
-00075e20: 7d3a 7b6f 7269 6741 746f 6d49 647d 2069  }:{origAtomId} i
-00075e30: 7320 6e6f 7420 7072 6573 656e 7420 696e  s not present in
-00075e40: 2074 6865 2063 6f6f 7264 696e 6174 6573   the coordinates
-00075e50: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
+00075d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075d20: 2020 2020 2020 2320 2020 2020 2020 2020        #         
+00075d30: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00075d40: 2e72 6561 736f 6e73 466f 7252 6550 6172  .reasonsForRePar
+00075d50: 7369 6e67 5b27 6c61 6265 6c5f 7365 715f  sing['label_seq_
+00075d60: 7363 6865 6d65 275d 203d 2054 7275 650a  scheme'] = True.
+00075d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075d90: 2020 2020 2020 2020 2320 2222 220a 2020          # """.  
+00075da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075dc0: 2020 2020 2020 6966 2063 6966 4368 6563        if cifChec
+00075dd0: 6b20 616e 6420 7365 6c66 2e5f 5f63 7572  k and self.__cur
+00075de0: 5f73 7562 7479 7065 2021 3d20 2770 6c61  _subtype != 'pla
+00075df0: 6e65 275c 0a20 2020 2020 2020 2020 2020  ne'\.           
+00075e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075e20: 616e 6420 2773 6571 5f69 6427 2069 6e20  and 'seq_id' in 
+00075e30: 5f66 6163 746f 7220 616e 6420 6c65 6e28  _factor and len(
+00075e40: 5f66 6163 746f 725b 2773 6571 5f69 6427  _factor['seq_id'
+00075e50: 5d29 203d 3d20 315c 0a20 2020 2020 2020  ]) == 1\.       
 00075e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00075e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075e90: 2020 2020 2020 2020 6622 5468 6520 7265          f"The re
-00075ea0: 7369 6475 6520 6e75 6d62 6572 2027 7b73  sidue number '{s
-00075eb0: 6571 4964 7d27 2069 7320 6e6f 7420 7072  eqId}' is not pr
-00075ec0: 6573 656e 7420 696e 2070 6f6c 796d 6572  esent in polymer
-00075ed0: 2073 6571 7565 6e63 6520 6f66 2063 6861   sequence of cha
-00075ee0: 696e 207b 6368 6169 6e49 647d 206f 6620  in {chainId} of 
-00075ef0: 7468 6520 636f 6f72 6469 6e61 7465 732e  the coordinates.
-00075f00: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-00075f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075e80: 2020 2020 616e 6420 2873 656c 662e 5f5f      and (self.__
+00075e90: 7265 6173 6f6e 7320 6973 204e 6f6e 6520  reasons is None 
+00075ea0: 6f72 2027 6e6f 6e5f 706f 6c79 5f72 656d  or 'non_poly_rem
+00075eb0: 6170 2720 6e6f 7420 696e 2073 656c 662e  ap' not in self.
+00075ec0: 5f5f 7265 6173 6f6e 7329 5c0a 2020 2020  __reasons)\.    
+00075ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075ef0: 2020 2020 2020 2061 6e64 206e 6f74 2073         and not s
+00075f00: 656c 662e 5f5f 6375 725f 756e 696f 6e5f  elf.__cur_union_
+00075f10: 6578 7072 3a0a 2020 2020 2020 2020 2020  expr:.          
 00075f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00075f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075f40: 2020 2020 2020 2022 506c 6561 7365 2075         "Please u
-00075f50: 7064 6174 6520 7468 6520 7365 7175 656e  pdate the sequen
-00075f60: 6365 2069 6e20 7468 6520 4d61 6372 6f6d  ce in the Macrom
-00075f70: 6f6c 6563 756c 6573 2070 6167 652e 2229  olecules page.")
-00075f80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00075f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075fb0: 2065 6c69 6620 7365 7153 7065 6369 6669   elif seqSpecifi
-00075fc0: 6564 3a0a 2020 2020 2020 2020 2020 2020  ed:.            
+00075f40: 2020 6966 2063 6861 696e 4964 2069 6e20    if chainId in 
+00075f50: 4c41 5247 455f 4153 594d 5f49 443a 0a20  LARGE_ASYM_ID:. 
+00075f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075f80: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00075f90: 6620 7365 7149 6420 3c20 3120 616e 6420  f seqId < 1 and 
+00075fa0: 6c65 6e28 7365 6c66 2e5f 5f70 6f6c 7953  len(self.__polyS
+00075fb0: 6571 2920 3d3d 2031 3a0a 2020 2020 2020  eq) == 1:.      
+00075fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00075fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075ff0: 2020 2020 2020 2020 7365 6c66 2e5f 5f66          self.__f
-00076000: 2e61 7070 656e 6428 6622 5b41 746f 6d20  .append(f"[Atom 
-00076010: 6e6f 7420 666f 756e 645d 207b 7365 6c66  not found] {self
-00076020: 2e5f 5f67 6574 4375 7272 656e 7452 6573  .__getCurrentRes
-00076030: 7472 6169 6e74 2829 7d22 0a20 2020 2020  traint()}".     
+00075fe0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00075ff0: 6c66 2e5f 5f66 2e61 7070 656e 6428 6622  lf.__f.append(f"
+00076000: 5b41 746f 6d20 6e6f 7420 666f 756e 645d  [Atom not found]
+00076010: 207b 7365 6c66 2e5f 5f67 6574 4375 7272   {self.__getCurr
+00076020: 656e 7452 6573 7472 6169 6e74 2829 7d22  entRestraint()}"
+00076030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00076040: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00076050: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00076060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00076070: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00076080: 227b 6368 6169 6e49 647d 3a7b 7365 7149  "{chainId}:{seqI
-00076090: 647d 3a7b 636f 6d70 4964 7d3a 7b6f 7269  d}:{compId}:{ori
-000760a0: 6741 746f 6d49 647d 2069 7320 6e6f 7420  gAtomId} is not 
-000760b0: 7072 6573 656e 7420 696e 2074 6865 2063  present in the c
-000760c0: 6f6f 7264 696e 6174 6573 2e22 290a 0a20  oordinates.").. 
-000760d0: 2020 2020 2020 2072 6574 7572 6e20 666f         return fo
-000760e0: 756e 6443 6f6d 7049 640a 0a20 2020 2064  undCompId..    d
-000760f0: 6566 2067 6574 4f72 6967 5365 7149 6428  ef getOrigSeqId(
-00076100: 7365 6c66 2c20 7073 2c20 7365 7149 642c  self, ps, seqId,
-00076110: 2069 7350 6f6c 7953 6571 3d54 7275 6529   isPolySeq=True)
-00076120: 3a0a 2020 2020 2020 2020 2320 6966 2073  :.        # if s
-00076130: 656c 662e 5f5f 7265 6173 6f6e 7320 6973  elf.__reasons is
-00076140: 206e 6f74 204e 6f6e 6520 616e 6420 276c   not None and 'l
-00076150: 6162 656c 5f73 6571 5f73 6368 656d 6527  abel_seq_scheme'
-00076160: 2069 6e20 7365 6c66 2e5f 5f72 6561 736f   in self.__reaso
-00076170: 6e73 2061 6e64 2073 656c 662e 5f5f 7265  ns and self.__re
-00076180: 6173 6f6e 735b 276c 6162 656c 5f73 6571  asons['label_seq
-00076190: 5f73 6368 656d 6527 5d20 6f72 206e 6f74  _scheme'] or not
-000761a0: 2073 656c 662e 5f5f 7072 6566 6572 4175   self.__preferAu
-000761b0: 7468 5365 713a 0a20 2020 2020 2020 2069  thSeq:.        i
-000761c0: 6620 6e6f 7420 7365 6c66 2e5f 5f70 7265  f not self.__pre
-000761d0: 6665 7241 7574 6853 6571 3a0a 2020 2020  ferAuthSeq:.    
-000761e0: 2020 2020 2020 2020 6368 6169 6e49 6420          chainId 
-000761f0: 3d20 7073 5b27 6368 6169 6e5f 6964 275d  = ps['chain_id']
-00076200: 0a20 2020 2020 2020 2020 2020 206f 6666  .            off
-00076210: 7365 7420 3d20 300a 2020 2020 2020 2020  set = 0.        
-00076220: 2020 2020 6966 2069 7350 6f6c 7953 6571      if isPolySeq
-00076230: 2061 6e64 2073 656c 662e 5f5f 7265 6173   and self.__reas
-00076240: 6f6e 7320 6973 206e 6f74 204e 6f6e 6520  ons is not None 
-00076250: 616e 6420 276c 6162 656c 5f73 6571 5f6f  and 'label_seq_o
-00076260: 6666 7365 7427 2069 6e20 7365 6c66 2e5f  ffset' in self._
-00076270: 5f72 6561 736f 6e73 2061 6e64 2063 6861  _reasons and cha
-00076280: 696e 4964 2069 6e20 7365 6c66 2e5f 5f72  inId in self.__r
-00076290: 6561 736f 6e73 5b27 6c61 6265 6c5f 7365  easons['label_se
-000762a0: 715f 6f66 6673 6574 275d 3a0a 2020 2020  q_offset']:.    
-000762b0: 2020 2020 2020 2020 2020 2020 6f66 6673              offs
-000762c0: 6574 203d 2073 656c 662e 5f5f 7265 6173  et = self.__reas
-000762d0: 6f6e 735b 276c 6162 656c 5f73 6571 5f6f  ons['label_seq_o
-000762e0: 6666 7365 7427 5d5b 6368 6169 6e49 645d  ffset'][chainId]
-000762f0: 0a20 2020 2020 2020 2020 2020 2073 6571  .            seq
-00076300: 4b65 7920 3d20 2870 735b 2763 6861 696e  Key = (ps['chain
-00076310: 5f69 6427 2069 6620 6973 506f 6c79 5365  _id' if isPolySe
-00076320: 7120 656c 7365 2027 6175 7468 5f63 6861  q else 'auth_cha
-00076330: 696e 5f69 6427 5d2c 2073 6571 4964 290a  in_id'], seqId).
-00076340: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00076350: 6571 4b65 7920 696e 2073 656c 662e 5f5f  eqKey in self.__
-00076360: 6175 7468 546f 4c61 6265 6c53 6571 3a0a  authToLabelSeq:.
-00076370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00076380: 5f63 6861 696e 4964 2c20 5f73 6571 4964  _chainId, _seqId
-00076390: 203d 2073 656c 662e 5f5f 6175 7468 546f   = self.__authTo
-000763a0: 4c61 6265 6c53 6571 5b73 6571 4b65 795d  LabelSeq[seqKey]
-000763b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000763c0: 2069 6620 5f73 6571 4964 2069 6e20 7073   if _seqId in ps
-000763d0: 5b27 7365 715f 6964 275d 3a0a 2020 2020  ['seq_id']:.    
-000763e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000763f0: 7265 7475 726e 205f 7365 7149 6420 2b20  return _seqId + 
-00076400: 6f66 6673 6574 0a20 2020 2020 2020 2069  offset.        i
-00076410: 6620 7365 7149 6420 696e 2070 735b 2761  f seqId in ps['a
-00076420: 7574 685f 7365 715f 6964 275d 3a0a 2020  uth_seq_id']:.  
-00076430: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00076440: 2073 6571 4964 0a20 2020 2020 2020 2023   seqId.        #
-00076450: 2069 6620 7365 7149 6420 696e 2070 735b   if seqId in ps[
-00076460: 2773 6571 5f69 6427 5d3a 0a20 2020 2020  'seq_id']:.     
-00076470: 2020 2023 2020 2020 2072 6574 7572 6e20     #     return 
-00076480: 7073 5b27 6175 7468 5f73 6571 5f69 6427  ps['auth_seq_id'
-00076490: 5d5b 7073 5b27 7365 715f 6964 275d 2e69  ][ps['seq_id'].i
-000764a0: 6e64 6578 2873 6571 4964 295d 0a20 2020  ndex(seqId)].   
-000764b0: 2020 2020 2072 6574 7572 6e20 7365 7149       return seqI
-000764c0: 640a 0a20 2020 2064 6566 2067 6574 5265  d..    def getRe
-000764d0: 616c 5365 7149 6428 7365 6c66 2c20 7073  alSeqId(self, ps
-000764e0: 2c20 7365 7149 642c 2069 7350 6f6c 7953  , seqId, isPolyS
-000764f0: 6571 3d54 7275 6529 3a0a 2020 2020 2020  eq=True):.      
-00076500: 2020 2320 6966 2073 656c 662e 5f5f 7265    # if self.__re
-00076510: 6173 6f6e 7320 6973 206e 6f74 204e 6f6e  asons is not Non
-00076520: 6520 616e 6420 276c 6162 656c 5f73 6571  e and 'label_seq
-00076530: 5f73 6368 656d 6527 2069 6e20 7365 6c66  _scheme' in self
-00076540: 2e5f 5f72 6561 736f 6e73 2061 6e64 2073  .__reasons and s
-00076550: 656c 662e 5f5f 7265 6173 6f6e 735b 276c  elf.__reasons['l
-00076560: 6162 656c 5f73 6571 5f73 6368 656d 6527  abel_seq_scheme'
-00076570: 5d20 6f72 206e 6f74 2073 656c 662e 5f5f  ] or not self.__
-00076580: 7072 6566 6572 4175 7468 5365 713a 0a20  preferAuthSeq:. 
-00076590: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
-000765a0: 6c66 2e5f 5f70 7265 6665 7241 7574 6853  lf.__preferAuthS
-000765b0: 6571 3a0a 2020 2020 2020 2020 2020 2020  eq:.            
-000765c0: 6368 6169 6e49 6420 3d20 7073 5b27 6368  chainId = ps['ch
-000765d0: 6169 6e5f 6964 275d 0a20 2020 2020 2020  ain_id'].       
-000765e0: 2020 2020 206f 6666 7365 7420 3d20 300a       offset = 0.
-000765f0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-00076600: 7350 6f6c 7953 6571 2061 6e64 2073 656c  sPolySeq and sel
-00076610: 662e 5f5f 7265 6173 6f6e 7320 6973 206e  f.__reasons is n
-00076620: 6f74 204e 6f6e 6520 616e 6420 276c 6162  ot None and 'lab
-00076630: 656c 5f73 6571 5f6f 6666 7365 7427 2069  el_seq_offset' i
-00076640: 6e20 7365 6c66 2e5f 5f72 6561 736f 6e73  n self.__reasons
-00076650: 2061 6e64 2063 6861 696e 4964 2069 6e20   and chainId in 
-00076660: 7365 6c66 2e5f 5f72 6561 736f 6e73 5b27  self.__reasons['
-00076670: 6c61 6265 6c5f 7365 715f 6f66 6673 6574  label_seq_offset
-00076680: 275d 3a0a 2020 2020 2020 2020 2020 2020  ']:.            
-00076690: 2020 2020 6f66 6673 6574 203d 2073 656c      offset = sel
-000766a0: 662e 5f5f 7265 6173 6f6e 735b 276c 6162  f.__reasons['lab
-000766b0: 656c 5f73 6571 5f6f 6666 7365 7427 5d5b  el_seq_offset'][
-000766c0: 6368 6169 6e49 645d 0a20 2020 2020 2020  chainId].       
-000766d0: 2020 2020 2073 6571 4b65 7920 3d20 2870       seqKey = (p
-000766e0: 735b 2763 6861 696e 5f69 6427 2069 6620  s['chain_id' if 
-000766f0: 6973 506f 6c79 5365 7120 656c 7365 2027  isPolySeq else '
-00076700: 6175 7468 5f63 6861 696e 5f69 6427 5d2c  auth_chain_id'],
-00076710: 2073 6571 4964 202b 206f 6666 7365 7429   seqId + offset)
-00076720: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00076730: 7365 714b 6579 2069 6e20 7365 6c66 2e5f  seqKey in self._
-00076740: 5f6c 6162 656c 546f 4175 7468 5365 713a  _labelToAuthSeq:
-00076750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00076760: 205f 6368 6169 6e49 642c 205f 7365 7149   _chainId, _seqI
-00076770: 6420 3d20 7365 6c66 2e5f 5f6c 6162 656c  d = self.__label
-00076780: 546f 4175 7468 5365 715b 7365 714b 6579  ToAuthSeq[seqKey
-00076790: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-000767a0: 2020 6966 205f 7365 7149 6420 696e 2070    if _seqId in p
-000767b0: 735b 2761 7574 685f 7365 715f 6964 275d  s['auth_seq_id']
-000767c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000767d0: 2020 2020 2020 7265 7475 726e 205f 7365        return _se
-000767e0: 7149 640a 2020 2020 2020 2020 6966 2073  qId.        if s
-000767f0: 6571 4964 2069 6e20 7073 5b27 6175 7468  eqId in ps['auth
-00076800: 5f73 6571 5f69 6427 5d3a 0a20 2020 2020  _seq_id']:.     
-00076810: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00076820: 7149 640a 2020 2020 2020 2020 2320 6966  qId.        # if
-00076830: 2073 6571 4964 2069 6e20 7073 5b27 7365   seqId in ps['se
-00076840: 715f 6964 275d 3a0a 2020 2020 2020 2020  q_id']:.        
-00076850: 2320 2020 2020 7265 7475 726e 2070 735b  #     return ps[
-00076860: 2761 7574 685f 7365 715f 6964 275d 5b70  'auth_seq_id'][p
-00076870: 735b 2773 6571 5f69 6427 5d2e 696e 6465  s['seq_id'].inde
-00076880: 7828 7365 7149 6429 5d0a 2020 2020 2020  x(seqId)].      
-00076890: 2020 7265 7475 726e 2073 6571 4964 0a0a    return seqId..
-000768a0: 2020 2020 6465 6620 6765 7452 6561 6c43      def getRealC
-000768b0: 6861 696e 4964 2873 656c 662c 2063 6861  hainId(self, cha
-000768c0: 696e 4964 293a 0a20 2020 2020 2020 2069  inId):.        i
-000768d0: 6620 7365 6c66 2e5f 5f72 6561 736f 6e73  f self.__reasons
-000768e0: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
-000768f0: 2027 7365 676d 656e 745f 6964 5f6d 6973   'segment_id_mis
-00076900: 6d61 7463 6827 2069 6e20 7365 6c66 2e5f  match' in self._
-00076910: 5f72 6561 736f 6e73 2061 6e64 2063 6861  _reasons and cha
-00076920: 696e 4964 2069 6e20 7365 6c66 2e5f 5f72  inId in self.__r
-00076930: 6561 736f 6e73 5b27 7365 676d 656e 745f  easons['segment_
-00076940: 6964 5f6d 6973 6d61 7463 6827 5d3a 0a20  id_mismatch']:. 
-00076950: 2020 2020 2020 2020 2020 205f 6368 6169             _chai
-00076960: 6e49 6420 3d20 7365 6c66 2e5f 5f72 6561  nId = self.__rea
-00076970: 736f 6e73 5b27 7365 676d 656e 745f 6964  sons['segment_id
-00076980: 5f6d 6973 6d61 7463 6827 5d5b 6368 6169  _mismatch'][chai
-00076990: 6e49 645d 0a20 2020 2020 2020 2020 2020  nId].           
-000769a0: 2069 6620 5f63 6861 696e 4964 2069 7320   if _chainId is 
-000769b0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-000769c0: 2020 2020 2020 2020 2020 6368 6169 6e49            chainI
-000769d0: 6420 3d20 5f63 6861 696e 4964 0a20 2020  d = _chainId.   
-000769e0: 2020 2020 2072 6574 7572 6e20 6368 6169       return chai
-000769f0: 6e49 640a 0a20 2020 2064 6566 2075 7064  nId..    def upd
-00076a00: 6174 6553 6567 6d65 6e74 4964 4469 6374  ateSegmentIdDict
-00076a10: 2873 656c 662c 2066 6163 746f 722c 2063  (self, factor, c
-00076a20: 6861 696e 4964 2c20 7661 6c69 6429 3a0a  hainId, valid):.
-00076a30: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00076a40: 5f5f 7265 6173 6f6e 7320 6973 206e 6f74  __reasons is not
-00076a50: 204e 6f6e 6520 6f72 2027 616c 745f 6368   None or 'alt_ch
-00076a60: 6169 6e5f 6964 2720 6e6f 7420 696e 2066  ain_id' not in f
-00076a70: 6163 746f 725c 0a20 2020 2020 2020 2020  actor\.         
-00076a80: 2020 6f72 206c 656e 2873 656c 662e 7265    or len(self.re
-00076a90: 6173 6f6e 7346 6f72 5265 5061 7273 696e  asonsForReParsin
-00076aa0: 6729 203d 3d20 3020 6f72 2027 7365 676d  g) == 0 or 'segm
-00076ab0: 656e 745f 6964 5f6d 6973 6d61 7463 6827  ent_id_mismatch'
-00076ac0: 206e 6f74 2069 6e20 7365 6c66 2e72 6561   not in self.rea
-00076ad0: 736f 6e73 466f 7252 6550 6172 7369 6e67  sonsForReParsing
-00076ae0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00076af0: 7475 726e 0a20 2020 2020 2020 2061 6c74  turn.        alt
-00076b00: 4368 6169 6e49 6420 3d20 6661 6374 6f72  ChainId = factor
-00076b10: 5b27 616c 745f 6368 6169 6e5f 6964 275d  ['alt_chain_id']
-00076b20: 0a20 2020 2020 2020 2069 6620 616c 7443  .        if altC
-00076b30: 6861 696e 4964 206e 6f74 2069 6e20 7365  hainId not in se
-00076b40: 6c66 2e72 6561 736f 6e73 466f 7252 6550  lf.reasonsForReP
-00076b50: 6172 7369 6e67 5b27 7365 676d 656e 745f  arsing['segment_
-00076b60: 6964 5f6d 6973 6d61 7463 6827 5d3a 0a20  id_mismatch']:. 
-00076b70: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00076b80: 6e0a 2020 2020 2020 2020 6966 2063 6861  n.        if cha
-00076b90: 696e 4964 206e 6f74 2069 6e20 7365 6c66  inId not in self
-00076ba0: 2e72 6561 736f 6e73 466f 7252 6550 6172  .reasonsForRePar
-00076bb0: 7369 6e67 5b27 7365 676d 656e 745f 6964  sing['segment_id
-00076bc0: 5f6d 6174 6368 5f73 7461 7473 275d 5b61  _match_stats'][a
-00076bd0: 6c74 4368 6169 6e49 645d 3a0a 2020 2020  ltChainId]:.    
-00076be0: 2020 2020 2020 2020 7365 6c66 2e72 6561          self.rea
-00076bf0: 736f 6e73 466f 7252 6550 6172 7369 6e67  sonsForReParsing
-00076c00: 5b27 7365 676d 656e 745f 6964 5f6d 6174  ['segment_id_mat
-00076c10: 6368 5f73 7461 7473 275d 5b61 6c74 4368  ch_stats'][altCh
-00076c20: 6169 6e49 645d 5b63 6861 696e 4964 5d20  ainId][chainId] 
-00076c30: 3d20 300a 2020 2020 2020 2020 6966 2076  = 0.        if v
-00076c40: 616c 6964 3a0a 2020 2020 2020 2020 2020  alid:.          
-00076c50: 2020 7365 6c66 2e72 6561 736f 6e73 466f    self.reasonsFo
-00076c60: 7252 6550 6172 7369 6e67 5b27 7365 676d  rReParsing['segm
-00076c70: 656e 745f 6964 5f6d 6174 6368 5f73 7461  ent_id_match_sta
-00076c80: 7473 275d 5b61 6c74 4368 6169 6e49 645d  ts'][altChainId]
-00076c90: 5b63 6861 696e 4964 5d20 2b3d 2031 0a20  [chainId] += 1. 
-00076ca0: 2020 2020 2020 2073 7461 7473 203d 2073         stats = s
-00076cb0: 656c 662e 7265 6173 6f6e 7346 6f72 5265  elf.reasonsForRe
-00076cc0: 5061 7273 696e 675b 2773 6567 6d65 6e74  Parsing['segment
-00076cd0: 5f69 645f 6d61 7463 685f 7374 6174 7327  _id_match_stats'
-00076ce0: 5d5b 616c 7443 6861 696e 4964 5d0a 2020  ][altChainId].  
-00076cf0: 2020 2020 2020 5f63 6861 696e 4964 203d        _chainId =
-00076d00: 206d 6178 2873 7461 7473 2c20 6b65 793d   max(stats, key=
-00076d10: 6c61 6d62 6461 206b 6579 3a20 7374 6174  lambda key: stat
-00076d20: 735b 6b65 795d 295b 305d 0a20 2020 2020  s[key])[0].     
-00076d30: 2020 2073 656c 662e 7265 6173 6f6e 7346     self.reasonsF
-00076d40: 6f72 5265 5061 7273 696e 675b 2773 6567  orReParsing['seg
-00076d50: 6d65 6e74 5f69 645f 6d69 736d 6174 6368  ment_id_mismatch
-00076d60: 275d 5b61 6c74 4368 6169 6e49 645d 203d  '][altChainId] =
-00076d70: 205f 6368 6169 6e49 640a 2020 2020 2020   _chainId.      
-00076d80: 2020 2320 7472 7920 746f 2061 766f 6964    # try to avoid
-00076d90: 206d 756c 7469 706c 6520 7365 676d 656e   multiple segmen
-00076da0: 745f 6964 2061 7373 6967 6e6d 656e 7473  t_id assignments
-00076db0: 0a20 2020 2020 2020 2066 6f72 206b 2c20  .        for k, 
-00076dc0: 5f73 7461 7473 2069 6e20 7365 6c66 2e72  _stats in self.r
-00076dd0: 6561 736f 6e73 466f 7252 6550 6172 7369  easonsForReParsi
-00076de0: 6e67 5b27 7365 676d 656e 745f 6964 5f6d  ng['segment_id_m
-00076df0: 6174 6368 5f73 7461 7473 275d 2e69 7465  atch_stats'].ite
-00076e00: 6d73 2829 3a0a 2020 2020 2020 2020 2020  ms():.          
-00076e10: 2020 6966 206b 203d 3d20 616c 7443 6861    if k == altCha
-00076e20: 696e 4964 3a0a 2020 2020 2020 2020 2020  inId:.          
-00076e30: 2020 2020 2020 636f 6e74 696e 7565 0a20        continue. 
-00076e40: 2020 2020 2020 2020 2020 2069 6620 6368             if ch
-00076e50: 6169 6e49 6420 696e 205f 7374 6174 733a  ainId in _stats:
-00076e60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00076e70: 205f 7374 6174 735b 6368 6169 6e49 645d   _stats[chainId]
-00076e80: 202d 3d20 310a 0a20 2020 2064 6566 2067   -= 1..    def g
-00076e90: 6574 436f 6f72 6441 746f 6d53 6974 654f  etCoordAtomSiteO
-00076ea0: 6628 7365 6c66 2c20 6368 6169 6e49 642c  f(self, chainId,
-00076eb0: 2073 6571 4964 2c20 6369 6643 6865 636b   seqId, cifCheck
-00076ec0: 3d54 7275 652c 2061 7369 733d 5472 7565  =True, asis=True
-00076ed0: 293a 0a20 2020 2020 2020 2073 6571 4b65  ):.        seqKe
-00076ee0: 7920 3d20 2863 6861 696e 4964 2c20 7365  y = (chainId, se
-00076ef0: 7149 6429 0a20 2020 2020 2020 2069 6620  qId).        if 
-00076f00: 6173 6973 3a0a 2020 2020 2020 2020 2020  asis:.          
-00076f10: 2020 7265 7475 726e 2073 6571 4b65 792c    return seqKey,
-00076f20: 2073 656c 662e 5f5f 636f 6f72 6441 746f   self.__coordAto
-00076f30: 6d53 6974 655b 7365 714b 6579 5d20 6966  mSite[seqKey] if
-00076f40: 2063 6966 4368 6563 6b20 616e 6420 7365   cifCheck and se
-00076f50: 714b 6579 2069 6e20 7365 6c66 2e5f 5f63  qKey in self.__c
-00076f60: 6f6f 7264 4174 6f6d 5369 7465 2065 6c73  oordAtomSite els
-00076f70: 6520 4e6f 6e65 0a20 2020 2020 2020 2069  e None.        i
-00076f80: 6620 7365 714b 6579 2069 6e20 7365 6c66  f seqKey in self
-00076f90: 2e5f 5f6c 6162 656c 546f 4175 7468 5365  .__labelToAuthSe
-00076fa0: 713a 0a20 2020 2020 2020 2020 2020 2073  q:.            s
-00076fb0: 6571 4b65 7920 3d20 7365 6c66 2e5f 5f6c  eqKey = self.__l
-00076fc0: 6162 656c 546f 4175 7468 5365 715b 7365  abelToAuthSeq[se
-00076fd0: 714b 6579 5d0a 2020 2020 2020 2020 2020  qKey].          
-00076fe0: 2020 7265 7475 726e 2073 6571 4b65 792c    return seqKey,
-00076ff0: 2073 656c 662e 5f5f 636f 6f72 6441 746f   self.__coordAto
-00077000: 6d53 6974 655b 7365 714b 6579 5d20 6966  mSite[seqKey] if
-00077010: 2063 6966 4368 6563 6b20 616e 6420 7365   cifCheck and se
-00077020: 714b 6579 2069 6e20 7365 6c66 2e5f 5f63  qKey in self.__c
-00077030: 6f6f 7264 4174 6f6d 5369 7465 2065 6c73  oordAtomSite els
-00077040: 6520 4e6f 6e65 0a20 2020 2020 2020 2072  e None.        r
-00077050: 6574 7572 6e20 7365 714b 6579 2c20 4e6f  eturn seqKey, No
-00077060: 6e65 0a0a 2020 2020 6465 6620 6765 7441  ne..    def getA
-00077070: 746f 6d49 644c 6973 7428 7365 6c66 2c20  tomIdList(self, 
-00077080: 6661 6374 6f72 2c20 636f 6d70 4964 2c20  factor, compId, 
-00077090: 6174 6f6d 4964 293a 0a20 2020 2020 2020  atomId):.       
-000770a0: 206b 6579 203d 2028 636f 6d70 4964 2c20   key = (compId, 
-000770b0: 6174 6f6d 4964 2c20 2761 6c74 5f61 746f  atomId, 'alt_ato
-000770c0: 6d5f 6964 2720 696e 2066 6163 746f 7229  m_id' in factor)
-000770d0: 0a20 2020 2020 2020 2069 6620 6b65 7920  .        if key 
-000770e0: 696e 2073 656c 662e 5f5f 6361 6368 6564  in self.__cached
-000770f0: 4469 6374 466f 7241 746f 6d49 644c 6973  DictForAtomIdLis
-00077100: 743a 0a20 2020 2020 2020 2020 2020 2072  t:.            r
-00077110: 6574 7572 6e20 636f 7079 2e63 6f70 7928  eturn copy.copy(
-00077120: 7365 6c66 2e5f 5f63 6163 6865 6444 6963  self.__cachedDic
-00077130: 7446 6f72 4174 6f6d 4964 4c69 7374 5b6b  tForAtomIdList[k
-00077140: 6579 5d29 0a20 2020 2020 2020 2061 746f  ey]).        ato
-00077150: 6d49 6473 2c20 5f2c 2064 6574 6169 6c73  mIds, _, details
-00077160: 203d 2073 656c 662e 5f5f 6e65 6654 2e67   = self.__nefT.g
-00077170: 6574 5f76 616c 6964 5f73 7461 725f 6174  et_valid_star_at
-00077180: 6f6d 5f69 6e5f 7870 6c6f 7228 636f 6d70  om_in_xplor(comp
-00077190: 4964 2c20 6174 6f6d 4964 2c20 6c65 6176  Id, atomId, leav
-000771a0: 655f 756e 6d61 7463 6865 643d 5472 7565  e_unmatched=True
-000771b0: 290a 2020 2020 2020 2020 6966 2027 616c  ).        if 'al
-000771c0: 745f 6174 6f6d 5f69 6427 2069 6e20 6661  t_atom_id' in fa
-000771d0: 6374 6f72 2061 6e64 2064 6574 6169 6c73  ctor and details
-000771e0: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
-000771f0: 206c 656e 2861 746f 6d49 6429 203e 2031   len(atomId) > 1
-00077200: 2061 6e64 206e 6f74 2061 746f 6d49 645b   and not atomId[
-00077210: 2d31 5d2e 6973 616c 7068 6128 293a 0a20  -1].isalpha():. 
-00077220: 2020 2020 2020 2020 2020 2061 746f 6d49             atomI
-00077230: 6473 2c20 5f2c 2064 6574 6169 6c73 203d  ds, _, details =
-00077240: 2073 656c 662e 5f5f 6e65 6654 2e67 6574   self.__nefT.get
-00077250: 5f76 616c 6964 5f73 7461 725f 6174 6f6d  _valid_star_atom
-00077260: 5f69 6e5f 7870 6c6f 7228 636f 6d70 4964  _in_xplor(compId
-00077270: 2c20 6174 6f6d 4964 5b3a 2d31 5d2c 206c  , atomId[:-1], l
-00077280: 6561 7665 5f75 6e6d 6174 6368 6564 3d54  eave_unmatched=T
-00077290: 7275 6529 0a20 2020 2020 2020 2020 2020  rue).           
-000772a0: 2069 6620 6174 6f6d 4964 5b2d 315d 2e69   if atomId[-1].i
-000772b0: 7364 6967 6974 2829 2061 6e64 2069 6e74  sdigit() and int
-000772c0: 2861 746f 6d49 645b 2d31 5d29 203c 3d20  (atomId[-1]) <= 
-000772d0: 6c65 6e28 6174 6f6d 4964 7329 3a0a 2020  len(atomIds):.  
-000772e0: 2020 2020 2020 2020 2020 2020 2020 6174                at
-000772f0: 6f6d 4964 7320 3d20 5b61 746f 6d49 6473  omIds = [atomIds
-00077300: 5b69 6e74 2861 746f 6d49 645b 2d31 5d29  [int(atomId[-1])
-00077310: 202d 2031 5d5d 0a0a 2020 2020 2020 2020   - 1]]..        
-00077320: 6966 2064 6574 6169 6c73 2069 7320 6e6f  if details is no
-00077330: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00077340: 2020 2020 5f61 746f 6d49 6420 3d20 746f      _atomId = to
-00077350: 4e65 6645 7828 7472 616e 736c 6174 6554  NefEx(translateT
-00077360: 6f53 7464 4174 6f6d 4e61 6d65 2861 746f  oStdAtomName(ato
-00077370: 6d49 642c 2063 6f6d 7049 642c 2063 6355  mId, compId, ccU
-00077380: 3d73 656c 662e 5f5f 6363 5529 290a 2020  =self.__ccU)).  
-00077390: 2020 2020 2020 2020 2020 6966 205f 6174            if _at
-000773a0: 6f6d 4964 2021 3d20 6174 6f6d 4964 3a0a  omId != atomId:.
-000773b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000773c0: 6966 2061 746f 6d49 642e 7374 6172 7473  if atomId.starts
-000773d0: 7769 7468 2827 4854 2729 2061 6e64 206c  with('HT') and l
-000773e0: 656e 285f 6174 6f6d 4964 2920 3d3d 2032  en(_atomId) == 2
-000773f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00077400: 2020 2020 2020 5f61 746f 6d49 6420 3d20        _atomId = 
-00077410: 2748 270a 2020 2020 2020 2020 2020 2020  'H'.            
-00077420: 2020 2020 6174 6f6d 4964 7320 3d20 7365      atomIds = se
-00077430: 6c66 2e5f 5f6e 6566 542e 6765 745f 7661  lf.__nefT.get_va
-00077440: 6c69 645f 7374 6172 5f61 746f 6d5f 696e  lid_star_atom_in
-00077450: 5f78 706c 6f72 2863 6f6d 7049 642c 205f  _xplor(compId, _
-00077460: 6174 6f6d 4964 295b 305d 0a20 2020 2020  atomId)[0].     
-00077470: 2020 2073 656c 662e 5f5f 6361 6368 6564     self.__cached
-00077480: 4469 6374 466f 7241 746f 6d49 644c 6973  DictForAtomIdLis
-00077490: 745b 6b65 795d 203d 2061 746f 6d49 6473  t[key] = atomIds
-000774a0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000774b0: 6174 6f6d 4964 730a 0a20 2020 2064 6566  atomIds..    def
-000774c0: 2067 6574 4c61 6265 6c53 6571 4f66 6673   getLabelSeqOffs
-000774d0: 6574 4475 6554 6f55 6e6f 6273 2873 656c  etDueToUnobs(sel
-000774e0: 662c 2070 7329 3a0a 2020 2020 2020 2020  f, ps):.        
-000774f0: 6175 7468 4368 6169 6e49 6420 3d20 7073  authChainId = ps
-00077500: 5b27 6175 7468 5f63 6861 696e 5f69 6427  ['auth_chain_id'
-00077510: 5d0a 2020 2020 2020 2020 666f 7220 6c61  ].        for la
-00077520: 6265 6c53 6571 4964 2c20 6175 7468 5365  belSeqId, authSe
-00077530: 7149 6420 696e 207a 6970 2870 735b 2773  qId in zip(ps['s
-00077540: 6571 5f69 6427 5d2c 2070 735b 2761 7574  eq_id'], ps['aut
-00077550: 685f 7365 715f 6964 275d 293a 0a20 2020  h_seq_id']):.   
-00077560: 2020 2020 2020 2020 2073 6571 4b65 7920           seqKey 
-00077570: 3d20 2861 7574 6843 6861 696e 4964 2c20  = (authChainId, 
-00077580: 6175 7468 5365 7149 6429 0a20 2020 2020  authSeqId).     
-00077590: 2020 2020 2020 2069 6620 7365 714b 6579         if seqKey
-000775a0: 206e 6f74 2069 6e20 7365 6c66 2e5f 5f63   not in self.__c
-000775b0: 6f6f 7264 556e 6f62 7352 6573 3a0a 2020  oordUnobsRes:.  
-000775c0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-000775d0: 7475 726e 206c 6162 656c 5365 7149 6420  turn labelSeqId 
-000775e0: 2d20 310a 2020 2020 2020 2020 7265 7475  - 1.        retu
-000775f0: 726e 2070 735b 2773 6571 5f69 6427 5d5b  rn ps['seq_id'][
-00077600: 2d31 5d20 2d20 310a 0a20 2020 2064 6566  -1] - 1..    def
-00077610: 2064 6f65 734e 6f6e 506f 6c79 5365 7149   doesNonPolySeqI
-00077620: 644d 6174 6368 5769 7468 506f 6c79 5365  dMatchWithPolySe
-00077630: 7155 6e6f 6273 2873 656c 662c 2063 6861  qUnobs(self, cha
-00077640: 696e 4964 2c20 7365 7149 6429 3a0a 2020  inId, seqId):.  
-00077650: 2020 2020 2020 5f70 735f 203d 206e 6578        _ps_ = nex
-00077660: 7428 285f 7073 5f20 666f 7220 5f70 735f  t((_ps_ for _ps_
-00077670: 2069 6e20 7365 6c66 2e5f 5f70 6f6c 7953   in self.__polyS
-00077680: 6571 2069 6620 5f70 735f 5b27 6175 7468  eq if _ps_['auth
-00077690: 5f63 6861 696e 5f69 6427 5d20 3d3d 2063  _chain_id'] == c
-000776a0: 6861 696e 4964 292c 204e 6f6e 6529 0a20  hainId), None). 
-000776b0: 2020 2020 2020 2069 6620 5f70 735f 2069         if _ps_ i
-000776c0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-000776d0: 2020 2020 2020 2020 5f63 6861 696e 4964          _chainId
-000776e0: 5f20 3d20 5f70 735f 5b27 6368 6169 6e5f  _ = _ps_['chain_
-000776f0: 6964 275d 0a20 2020 2020 2020 2020 2020  id'].           
-00077700: 205f 7365 714b 6579 5f20 3d20 285f 6368   _seqKey_ = (_ch
-00077710: 6169 6e49 645f 2c20 7365 7149 6429 0a20  ainId_, seqId). 
-00077720: 2020 2020 2020 2020 2020 2069 6620 5f73             if _s
-00077730: 6571 4b65 795f 2069 6e20 7365 6c66 2e5f  eqKey_ in self._
-00077740: 5f6c 6162 656c 546f 4175 7468 5365 713a  _labelToAuthSeq:
-00077750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00077760: 2069 6620 7365 6c66 2e5f 5f6c 6162 656c   if self.__label
-00077770: 546f 4175 7468 5365 715b 5f73 6571 4b65  ToAuthSeq[_seqKe
-00077780: 795f 5d20 213d 205f 7365 714b 6579 5f3a  y_] != _seqKey_:
-00077790: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000777a0: 2020 2020 2069 6620 7365 6c66 2e5f 5f6c       if self.__l
-000777b0: 6162 656c 546f 4175 7468 5365 715b 5f73  abelToAuthSeq[_s
-000777c0: 6571 4b65 795f 5d20 696e 2073 656c 662e  eqKey_] in self.
-000777d0: 5f5f 636f 6f72 6455 6e6f 6273 5265 733a  __coordUnobsRes:
-000777e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000777f0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00077800: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
-00077810: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00077820: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00077830: 6178 5f6c 6162 656c 5f73 6571 5f69 6420  ax_label_seq_id 
-00077840: 3d20 5f70 735f 5b27 7365 715f 6964 275d  = _ps_['seq_id']
-00077850: 5b2d 315d 0a20 2020 2020 2020 2020 2020  [-1].           
-00077860: 2020 2020 2020 2020 205f 7365 7149 645f           _seqId_
-00077870: 203d 2073 6571 4964 202b 2031 0a20 2020   = seqId + 1.   
-00077880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077890: 2077 6869 6c65 205f 7365 7149 645f 203c   while _seqId_ <
-000778a0: 3d20 6d61 785f 6c61 6265 6c5f 7365 715f  = max_label_seq_
-000778b0: 6964 3a0a 2020 2020 2020 2020 2020 2020  id:.            
-000778c0: 2020 2020 2020 2020 2020 2020 6966 205f              if _
-000778d0: 7365 7149 645f 2069 6e20 5f70 735f 5b27  seqId_ in _ps_['
-000778e0: 7365 715f 6964 275d 3a0a 2020 2020 2020  seq_id']:.      
-000778f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077900: 2020 2020 2020 5f73 6571 4b65 795f 203d        _seqKey_ =
-00077910: 2028 5f63 6861 696e 4964 5f2c 205f 7365   (_chainId_, _se
-00077920: 7149 645f 290a 2020 2020 2020 2020 2020  qId_).          
-00077930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077940: 2020 6966 205f 7365 714b 6579 5f20 696e    if _seqKey_ in
-00077950: 2073 656c 662e 5f5f 6c61 6265 6c54 6f41   self.__labelToA
-00077960: 7574 6853 6571 2061 6e64 2073 656c 662e  uthSeq and self.
-00077970: 5f5f 6c61 6265 6c54 6f41 7574 6853 6571  __labelToAuthSeq
-00077980: 5b5f 7365 714b 6579 5f5d 2021 3d20 5f73  [_seqKey_] != _s
-00077990: 6571 4b65 795f 3a0a 2020 2020 2020 2020  eqKey_:.        
-000779a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000779b0: 2020 2020 2020 2020 6272 6561 6b0a 2020          break.  
-000779c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000779d0: 2020 2020 2020 5f73 6571 4964 5f20 2b3d        _seqId_ +=
-000779e0: 2031 0a20 2020 2020 2020 2020 2020 2020   1.             
-000779f0: 2020 2020 2020 2069 6620 5f73 6571 4964         if _seqId
-00077a00: 5f20 6e6f 7420 696e 205f 7073 5f5b 2773  _ not in _ps_['s
-00077a10: 6571 5f69 6427 5d3a 0a20 2020 2020 2020  eq_id']:.       
-00077a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077a30: 206d 696e 5f6c 6162 656c 5f73 6571 5f69   min_label_seq_i
-00077a40: 6420 3d20 5f70 735f 5b27 7365 715f 6964  d = _ps_['seq_id
-00077a50: 275d 5b30 5d0a 2020 2020 2020 2020 2020  '][0].          
-00077a60: 2020 2020 2020 2020 2020 2020 2020 5f73                _s
-00077a70: 6571 4964 5f20 3d20 7365 7149 6420 2d20  eqId_ = seqId - 
-00077a80: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
-00077a90: 2020 2020 2020 2020 2020 7768 696c 6520            while 
-00077aa0: 5f73 6571 4964 5f20 3e3d 206d 696e 5f6c  _seqId_ >= min_l
-00077ab0: 6162 656c 5f73 6571 5f69 643a 0a20 2020  abel_seq_id:.   
-00077ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077ad0: 2020 2020 2020 2020 2069 6620 5f73 6571           if _seq
-00077ae0: 4964 5f20 696e 205f 7073 5f5b 2773 6571  Id_ in _ps_['seq
-00077af0: 5f69 6427 5d3a 0a20 2020 2020 2020 2020  _id']:.         
-00077b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077b10: 2020 2020 2020 205f 7365 714b 6579 5f20         _seqKey_ 
-00077b20: 3d20 285f 6368 6169 6e49 645f 2c20 5f73  = (_chainId_, _s
-00077b30: 6571 4964 5f29 0a20 2020 2020 2020 2020  eqId_).         
-00077b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077b50: 2020 2020 2020 2069 6620 5f73 6571 4b65         if _seqKe
-00077b60: 795f 2069 6e20 7365 6c66 2e5f 5f6c 6162  y_ in self.__lab
-00077b70: 656c 546f 4175 7468 5365 7120 616e 6420  elToAuthSeq and 
-00077b80: 7365 6c66 2e5f 5f6c 6162 656c 546f 4175  self.__labelToAu
-00077b90: 7468 5365 715b 5f73 6571 4b65 795f 5d20  thSeq[_seqKey_] 
-00077ba0: 213d 205f 7365 714b 6579 5f3a 0a20 2020  != _seqKey_:.   
-00077bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077bd0: 2062 7265 616b 0a20 2020 2020 2020 2020   break.         
-00077be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077bf0: 2020 205f 7365 7149 645f 202d 3d20 310a     _seqId_ -= 1.
-00077c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077c10: 2020 2020 6966 205f 7365 7149 645f 2069      if _seqId_ i
-00077c20: 6e20 5f70 735f 5b27 7365 715f 6964 275d  n _ps_['seq_id']
-00077c30: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00077c40: 2020 2020 2020 2020 2020 5f73 6571 4b65            _seqKe
-00077c50: 795f 203d 2028 5f63 6861 696e 4964 5f2c  y_ = (_chainId_,
-00077c60: 205f 7365 7149 645f 290a 2020 2020 2020   _seqId_).      
-00077c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077c80: 2020 6966 205f 7365 714b 6579 5f20 696e    if _seqKey_ in
-00077c90: 2073 656c 662e 5f5f 6c61 6265 6c54 6f41   self.__labelToA
-00077ca0: 7574 6853 6571 2061 6e64 2073 656c 662e  uthSeq and self.
-00077cb0: 5f5f 6c61 6265 6c54 6f41 7574 6853 6571  __labelToAuthSeq
-00077cc0: 5b5f 7365 714b 6579 5f5d 2021 3d20 5f73  [_seqKey_] != _s
-00077cd0: 6571 4b65 795f 3a0a 2020 2020 2020 2020  eqKey_:.        
-00077ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077cf0: 2020 2020 5f5f 6368 6169 6e49 645f 5f2c      __chainId__,
-00077d00: 205f 5f73 6571 4964 5f5f 203d 2073 656c   __seqId__ = sel
-00077d10: 662e 5f5f 6c61 6265 6c54 6f41 7574 6853  f.__labelToAuthS
-00077d20: 6571 5b5f 7365 714b 6579 5f5d 0a20 2020  eq[_seqKey_].   
+00076070: 2020 2020 2066 227b 6368 6169 6e49 647d       f"{chainId}
+00076080: 3a7b 7365 7149 647d 3a7b 636f 6d70 4964  :{seqId}:{compId
+00076090: 7d3a 7b6f 7269 6741 746f 6d49 647d 2069  }:{origAtomId} i
+000760a0: 7320 6e6f 7420 7072 6573 656e 7420 696e  s not present in
+000760b0: 2074 6865 2063 6f6f 7264 696e 6174 6573   the coordinates
+000760c0: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
+000760d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000760e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000760f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00076100: 2020 2020 2020 2020 6622 5468 6520 7265          f"The re
+00076110: 7369 6475 6520 6e75 6d62 6572 2027 7b73  sidue number '{s
+00076120: 6571 4964 7d27 2069 7320 6e6f 7420 7072  eqId}' is not pr
+00076130: 6573 656e 7420 696e 2070 6f6c 796d 6572  esent in polymer
+00076140: 2073 6571 7565 6e63 6520 6f66 2063 6861   sequence of cha
+00076150: 696e 207b 6368 6169 6e49 647d 206f 6620  in {chainId} of 
+00076160: 7468 6520 636f 6f72 6469 6e61 7465 732e  the coordinates.
+00076170: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+00076180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00076190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000761a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000761b0: 2020 2020 2020 2022 506c 6561 7365 2075         "Please u
+000761c0: 7064 6174 6520 7468 6520 7365 7175 656e  pdate the sequen
+000761d0: 6365 2069 6e20 7468 6520 4d61 6372 6f6d  ce in the Macrom
+000761e0: 6f6c 6563 756c 6573 2070 6167 652e 2229  olecules page.")
+000761f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00076200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00076210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00076220: 2065 6c69 6620 7365 7153 7065 6369 6669   elif seqSpecifi
+00076230: 6564 3a0a 2020 2020 2020 2020 2020 2020  ed:.            
+00076240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00076250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00076260: 2020 2020 2020 2020 7365 6c66 2e5f 5f66          self.__f
+00076270: 2e61 7070 656e 6428 6622 5b41 746f 6d20  .append(f"[Atom 
+00076280: 6e6f 7420 666f 756e 645d 207b 7365 6c66  not found] {self
+00076290: 2e5f 5f67 6574 4375 7272 656e 7452 6573  .__getCurrentRes
+000762a0: 7472 6169 6e74 2829 7d22 0a20 2020 2020  traint()}".     
+000762b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000762c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000762d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000762e0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000762f0: 227b 6368 6169 6e49 647d 3a7b 7365 7149  "{chainId}:{seqI
+00076300: 647d 3a7b 636f 6d70 4964 7d3a 7b6f 7269  d}:{compId}:{ori
+00076310: 6741 746f 6d49 647d 2069 7320 6e6f 7420  gAtomId} is not 
+00076320: 7072 6573 656e 7420 696e 2074 6865 2063  present in the c
+00076330: 6f6f 7264 696e 6174 6573 2e22 290a 0a20  oordinates.").. 
+00076340: 2020 2020 2020 2072 6574 7572 6e20 666f         return fo
+00076350: 756e 6443 6f6d 7049 640a 0a20 2020 2064  undCompId..    d
+00076360: 6566 2067 6574 4f72 6967 5365 7149 6428  ef getOrigSeqId(
+00076370: 7365 6c66 2c20 7073 2c20 7365 7149 642c  self, ps, seqId,
+00076380: 2069 7350 6f6c 7953 6571 3d54 7275 6529   isPolySeq=True)
+00076390: 3a0a 2020 2020 2020 2020 2320 6966 2073  :.        # if s
+000763a0: 656c 662e 5f5f 7265 6173 6f6e 7320 6973  elf.__reasons is
+000763b0: 206e 6f74 204e 6f6e 6520 616e 6420 276c   not None and 'l
+000763c0: 6162 656c 5f73 6571 5f73 6368 656d 6527  abel_seq_scheme'
+000763d0: 2069 6e20 7365 6c66 2e5f 5f72 6561 736f   in self.__reaso
+000763e0: 6e73 2061 6e64 2073 656c 662e 5f5f 7265  ns and self.__re
+000763f0: 6173 6f6e 735b 276c 6162 656c 5f73 6571  asons['label_seq
+00076400: 5f73 6368 656d 6527 5d20 6f72 206e 6f74  _scheme'] or not
+00076410: 2073 656c 662e 5f5f 7072 6566 6572 4175   self.__preferAu
+00076420: 7468 5365 713a 0a20 2020 2020 2020 2069  thSeq:.        i
+00076430: 6620 6e6f 7420 7365 6c66 2e5f 5f70 7265  f not self.__pre
+00076440: 6665 7241 7574 6853 6571 3a0a 2020 2020  ferAuthSeq:.    
+00076450: 2020 2020 2020 2020 6368 6169 6e49 6420          chainId 
+00076460: 3d20 7073 5b27 6368 6169 6e5f 6964 275d  = ps['chain_id']
+00076470: 0a20 2020 2020 2020 2020 2020 206f 6666  .            off
+00076480: 7365 7420 3d20 300a 2020 2020 2020 2020  set = 0.        
+00076490: 2020 2020 6966 2069 7350 6f6c 7953 6571      if isPolySeq
+000764a0: 2061 6e64 2073 656c 662e 5f5f 7265 6173   and self.__reas
+000764b0: 6f6e 7320 6973 206e 6f74 204e 6f6e 6520  ons is not None 
+000764c0: 616e 6420 276c 6162 656c 5f73 6571 5f6f  and 'label_seq_o
+000764d0: 6666 7365 7427 2069 6e20 7365 6c66 2e5f  ffset' in self._
+000764e0: 5f72 6561 736f 6e73 2061 6e64 2063 6861  _reasons and cha
+000764f0: 696e 4964 2069 6e20 7365 6c66 2e5f 5f72  inId in self.__r
+00076500: 6561 736f 6e73 5b27 6c61 6265 6c5f 7365  easons['label_se
+00076510: 715f 6f66 6673 6574 275d 3a0a 2020 2020  q_offset']:.    
+00076520: 2020 2020 2020 2020 2020 2020 6f66 6673              offs
+00076530: 6574 203d 2073 656c 662e 5f5f 7265 6173  et = self.__reas
+00076540: 6f6e 735b 276c 6162 656c 5f73 6571 5f6f  ons['label_seq_o
+00076550: 6666 7365 7427 5d5b 6368 6169 6e49 645d  ffset'][chainId]
+00076560: 0a20 2020 2020 2020 2020 2020 2073 6571  .            seq
+00076570: 4b65 7920 3d20 2870 735b 2763 6861 696e  Key = (ps['chain
+00076580: 5f69 6427 2069 6620 6973 506f 6c79 5365  _id' if isPolySe
+00076590: 7120 656c 7365 2027 6175 7468 5f63 6861  q else 'auth_cha
+000765a0: 696e 5f69 6427 5d2c 2073 6571 4964 290a  in_id'], seqId).
+000765b0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+000765c0: 6571 4b65 7920 696e 2073 656c 662e 5f5f  eqKey in self.__
+000765d0: 6175 7468 546f 4c61 6265 6c53 6571 3a0a  authToLabelSeq:.
+000765e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000765f0: 5f63 6861 696e 4964 2c20 5f73 6571 4964  _chainId, _seqId
+00076600: 203d 2073 656c 662e 5f5f 6175 7468 546f   = self.__authTo
+00076610: 4c61 6265 6c53 6571 5b73 6571 4b65 795d  LabelSeq[seqKey]
+00076620: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00076630: 2069 6620 5f73 6571 4964 2069 6e20 7073   if _seqId in ps
+00076640: 5b27 7365 715f 6964 275d 3a0a 2020 2020  ['seq_id']:.    
+00076650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00076660: 7265 7475 726e 205f 7365 7149 6420 2b20  return _seqId + 
+00076670: 6f66 6673 6574 0a20 2020 2020 2020 2069  offset.        i
+00076680: 6620 7365 7149 6420 696e 2070 735b 2761  f seqId in ps['a
+00076690: 7574 685f 7365 715f 6964 275d 3a0a 2020  uth_seq_id']:.  
+000766a0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000766b0: 2073 6571 4964 0a20 2020 2020 2020 2023   seqId.        #
+000766c0: 2069 6620 7365 7149 6420 696e 2070 735b   if seqId in ps[
+000766d0: 2773 6571 5f69 6427 5d3a 0a20 2020 2020  'seq_id']:.     
+000766e0: 2020 2023 2020 2020 2072 6574 7572 6e20     #     return 
+000766f0: 7073 5b27 6175 7468 5f73 6571 5f69 6427  ps['auth_seq_id'
+00076700: 5d5b 7073 5b27 7365 715f 6964 275d 2e69  ][ps['seq_id'].i
+00076710: 6e64 6578 2873 6571 4964 295d 0a20 2020  ndex(seqId)].   
+00076720: 2020 2020 2072 6574 7572 6e20 7365 7149       return seqI
+00076730: 640a 0a20 2020 2064 6566 2067 6574 5265  d..    def getRe
+00076740: 616c 5365 7149 6428 7365 6c66 2c20 7073  alSeqId(self, ps
+00076750: 2c20 7365 7149 642c 2069 7350 6f6c 7953  , seqId, isPolyS
+00076760: 6571 3d54 7275 6529 3a0a 2020 2020 2020  eq=True):.      
+00076770: 2020 2320 6966 2073 656c 662e 5f5f 7265    # if self.__re
+00076780: 6173 6f6e 7320 6973 206e 6f74 204e 6f6e  asons is not Non
+00076790: 6520 616e 6420 276c 6162 656c 5f73 6571  e and 'label_seq
+000767a0: 5f73 6368 656d 6527 2069 6e20 7365 6c66  _scheme' in self
+000767b0: 2e5f 5f72 6561 736f 6e73 2061 6e64 2073  .__reasons and s
+000767c0: 656c 662e 5f5f 7265 6173 6f6e 735b 276c  elf.__reasons['l
+000767d0: 6162 656c 5f73 6571 5f73 6368 656d 6527  abel_seq_scheme'
+000767e0: 5d20 6f72 206e 6f74 2073 656c 662e 5f5f  ] or not self.__
+000767f0: 7072 6566 6572 4175 7468 5365 713a 0a20  preferAuthSeq:. 
+00076800: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
+00076810: 6c66 2e5f 5f70 7265 6665 7241 7574 6853  lf.__preferAuthS
+00076820: 6571 3a0a 2020 2020 2020 2020 2020 2020  eq:.            
+00076830: 6368 6169 6e49 6420 3d20 7073 5b27 6368  chainId = ps['ch
+00076840: 6169 6e5f 6964 275d 0a20 2020 2020 2020  ain_id'].       
+00076850: 2020 2020 206f 6666 7365 7420 3d20 300a       offset = 0.
+00076860: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00076870: 7350 6f6c 7953 6571 2061 6e64 2073 656c  sPolySeq and sel
+00076880: 662e 5f5f 7265 6173 6f6e 7320 6973 206e  f.__reasons is n
+00076890: 6f74 204e 6f6e 6520 616e 6420 276c 6162  ot None and 'lab
+000768a0: 656c 5f73 6571 5f6f 6666 7365 7427 2069  el_seq_offset' i
+000768b0: 6e20 7365 6c66 2e5f 5f72 6561 736f 6e73  n self.__reasons
+000768c0: 2061 6e64 2063 6861 696e 4964 2069 6e20   and chainId in 
+000768d0: 7365 6c66 2e5f 5f72 6561 736f 6e73 5b27  self.__reasons['
+000768e0: 6c61 6265 6c5f 7365 715f 6f66 6673 6574  label_seq_offset
+000768f0: 275d 3a0a 2020 2020 2020 2020 2020 2020  ']:.            
+00076900: 2020 2020 6f66 6673 6574 203d 2073 656c      offset = sel
+00076910: 662e 5f5f 7265 6173 6f6e 735b 276c 6162  f.__reasons['lab
+00076920: 656c 5f73 6571 5f6f 6666 7365 7427 5d5b  el_seq_offset'][
+00076930: 6368 6169 6e49 645d 0a20 2020 2020 2020  chainId].       
+00076940: 2020 2020 2073 6571 4b65 7920 3d20 2870       seqKey = (p
+00076950: 735b 2763 6861 696e 5f69 6427 2069 6620  s['chain_id' if 
+00076960: 6973 506f 6c79 5365 7120 656c 7365 2027  isPolySeq else '
+00076970: 6175 7468 5f63 6861 696e 5f69 6427 5d2c  auth_chain_id'],
+00076980: 2073 6571 4964 202b 206f 6666 7365 7429   seqId + offset)
+00076990: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000769a0: 7365 714b 6579 2069 6e20 7365 6c66 2e5f  seqKey in self._
+000769b0: 5f6c 6162 656c 546f 4175 7468 5365 713a  _labelToAuthSeq:
+000769c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000769d0: 205f 6368 6169 6e49 642c 205f 7365 7149   _chainId, _seqI
+000769e0: 6420 3d20 7365 6c66 2e5f 5f6c 6162 656c  d = self.__label
+000769f0: 546f 4175 7468 5365 715b 7365 714b 6579  ToAuthSeq[seqKey
+00076a00: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00076a10: 2020 6966 205f 7365 7149 6420 696e 2070    if _seqId in p
+00076a20: 735b 2761 7574 685f 7365 715f 6964 275d  s['auth_seq_id']
+00076a30: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00076a40: 2020 2020 2020 7265 7475 726e 205f 7365        return _se
+00076a50: 7149 640a 2020 2020 2020 2020 6966 2073  qId.        if s
+00076a60: 6571 4964 2069 6e20 7073 5b27 6175 7468  eqId in ps['auth
+00076a70: 5f73 6571 5f69 6427 5d3a 0a20 2020 2020  _seq_id']:.     
+00076a80: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00076a90: 7149 640a 2020 2020 2020 2020 2320 6966  qId.        # if
+00076aa0: 2073 6571 4964 2069 6e20 7073 5b27 7365   seqId in ps['se
+00076ab0: 715f 6964 275d 3a0a 2020 2020 2020 2020  q_id']:.        
+00076ac0: 2320 2020 2020 7265 7475 726e 2070 735b  #     return ps[
+00076ad0: 2761 7574 685f 7365 715f 6964 275d 5b70  'auth_seq_id'][p
+00076ae0: 735b 2773 6571 5f69 6427 5d2e 696e 6465  s['seq_id'].inde
+00076af0: 7828 7365 7149 6429 5d0a 2020 2020 2020  x(seqId)].      
+00076b00: 2020 7265 7475 726e 2073 6571 4964 0a0a    return seqId..
+00076b10: 2020 2020 6465 6620 6765 7452 6561 6c43      def getRealC
+00076b20: 6861 696e 4964 2873 656c 662c 2063 6861  hainId(self, cha
+00076b30: 696e 4964 293a 0a20 2020 2020 2020 2069  inId):.        i
+00076b40: 6620 7365 6c66 2e5f 5f72 6561 736f 6e73  f self.__reasons
+00076b50: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
+00076b60: 2027 7365 676d 656e 745f 6964 5f6d 6973   'segment_id_mis
+00076b70: 6d61 7463 6827 2069 6e20 7365 6c66 2e5f  match' in self._
+00076b80: 5f72 6561 736f 6e73 2061 6e64 2063 6861  _reasons and cha
+00076b90: 696e 4964 2069 6e20 7365 6c66 2e5f 5f72  inId in self.__r
+00076ba0: 6561 736f 6e73 5b27 7365 676d 656e 745f  easons['segment_
+00076bb0: 6964 5f6d 6973 6d61 7463 6827 5d3a 0a20  id_mismatch']:. 
+00076bc0: 2020 2020 2020 2020 2020 205f 6368 6169             _chai
+00076bd0: 6e49 6420 3d20 7365 6c66 2e5f 5f72 6561  nId = self.__rea
+00076be0: 736f 6e73 5b27 7365 676d 656e 745f 6964  sons['segment_id
+00076bf0: 5f6d 6973 6d61 7463 6827 5d5b 6368 6169  _mismatch'][chai
+00076c00: 6e49 645d 0a20 2020 2020 2020 2020 2020  nId].           
+00076c10: 2069 6620 5f63 6861 696e 4964 2069 7320   if _chainId is 
+00076c20: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00076c30: 2020 2020 2020 2020 2020 6368 6169 6e49            chainI
+00076c40: 6420 3d20 5f63 6861 696e 4964 0a20 2020  d = _chainId.   
+00076c50: 2020 2020 2072 6574 7572 6e20 6368 6169       return chai
+00076c60: 6e49 640a 0a20 2020 2064 6566 2075 7064  nId..    def upd
+00076c70: 6174 6553 6567 6d65 6e74 4964 4469 6374  ateSegmentIdDict
+00076c80: 2873 656c 662c 2066 6163 746f 722c 2063  (self, factor, c
+00076c90: 6861 696e 4964 2c20 7661 6c69 6429 3a0a  hainId, valid):.
+00076ca0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00076cb0: 5f5f 7265 6173 6f6e 7320 6973 206e 6f74  __reasons is not
+00076cc0: 204e 6f6e 6520 6f72 2027 616c 745f 6368   None or 'alt_ch
+00076cd0: 6169 6e5f 6964 2720 6e6f 7420 696e 2066  ain_id' not in f
+00076ce0: 6163 746f 725c 0a20 2020 2020 2020 2020  actor\.         
+00076cf0: 2020 6f72 206c 656e 2873 656c 662e 7265    or len(self.re
+00076d00: 6173 6f6e 7346 6f72 5265 5061 7273 696e  asonsForReParsin
+00076d10: 6729 203d 3d20 3020 6f72 2027 7365 676d  g) == 0 or 'segm
+00076d20: 656e 745f 6964 5f6d 6973 6d61 7463 6827  ent_id_mismatch'
+00076d30: 206e 6f74 2069 6e20 7365 6c66 2e72 6561   not in self.rea
+00076d40: 736f 6e73 466f 7252 6550 6172 7369 6e67  sonsForReParsing
+00076d50: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00076d60: 7475 726e 0a20 2020 2020 2020 2061 6c74  turn.        alt
+00076d70: 4368 6169 6e49 6420 3d20 6661 6374 6f72  ChainId = factor
+00076d80: 5b27 616c 745f 6368 6169 6e5f 6964 275d  ['alt_chain_id']
+00076d90: 0a20 2020 2020 2020 2069 6620 616c 7443  .        if altC
+00076da0: 6861 696e 4964 206e 6f74 2069 6e20 7365  hainId not in se
+00076db0: 6c66 2e72 6561 736f 6e73 466f 7252 6550  lf.reasonsForReP
+00076dc0: 6172 7369 6e67 5b27 7365 676d 656e 745f  arsing['segment_
+00076dd0: 6964 5f6d 6973 6d61 7463 6827 5d3a 0a20  id_mismatch']:. 
+00076de0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00076df0: 6e0a 2020 2020 2020 2020 6966 2063 6861  n.        if cha
+00076e00: 696e 4964 206e 6f74 2069 6e20 7365 6c66  inId not in self
+00076e10: 2e72 6561 736f 6e73 466f 7252 6550 6172  .reasonsForRePar
+00076e20: 7369 6e67 5b27 7365 676d 656e 745f 6964  sing['segment_id
+00076e30: 5f6d 6174 6368 5f73 7461 7473 275d 5b61  _match_stats'][a
+00076e40: 6c74 4368 6169 6e49 645d 3a0a 2020 2020  ltChainId]:.    
+00076e50: 2020 2020 2020 2020 7365 6c66 2e72 6561          self.rea
+00076e60: 736f 6e73 466f 7252 6550 6172 7369 6e67  sonsForReParsing
+00076e70: 5b27 7365 676d 656e 745f 6964 5f6d 6174  ['segment_id_mat
+00076e80: 6368 5f73 7461 7473 275d 5b61 6c74 4368  ch_stats'][altCh
+00076e90: 6169 6e49 645d 5b63 6861 696e 4964 5d20  ainId][chainId] 
+00076ea0: 3d20 300a 2020 2020 2020 2020 6966 2076  = 0.        if v
+00076eb0: 616c 6964 3a0a 2020 2020 2020 2020 2020  alid:.          
+00076ec0: 2020 7365 6c66 2e72 6561 736f 6e73 466f    self.reasonsFo
+00076ed0: 7252 6550 6172 7369 6e67 5b27 7365 676d  rReParsing['segm
+00076ee0: 656e 745f 6964 5f6d 6174 6368 5f73 7461  ent_id_match_sta
+00076ef0: 7473 275d 5b61 6c74 4368 6169 6e49 645d  ts'][altChainId]
+00076f00: 5b63 6861 696e 4964 5d20 2b3d 2031 0a20  [chainId] += 1. 
+00076f10: 2020 2020 2020 2073 7461 7473 203d 2073         stats = s
+00076f20: 656c 662e 7265 6173 6f6e 7346 6f72 5265  elf.reasonsForRe
+00076f30: 5061 7273 696e 675b 2773 6567 6d65 6e74  Parsing['segment
+00076f40: 5f69 645f 6d61 7463 685f 7374 6174 7327  _id_match_stats'
+00076f50: 5d5b 616c 7443 6861 696e 4964 5d0a 2020  ][altChainId].  
+00076f60: 2020 2020 2020 5f63 6861 696e 4964 203d        _chainId =
+00076f70: 206d 6178 2873 7461 7473 2c20 6b65 793d   max(stats, key=
+00076f80: 6c61 6d62 6461 206b 6579 3a20 7374 6174  lambda key: stat
+00076f90: 735b 6b65 795d 295b 305d 0a20 2020 2020  s[key])[0].     
+00076fa0: 2020 2073 656c 662e 7265 6173 6f6e 7346     self.reasonsF
+00076fb0: 6f72 5265 5061 7273 696e 675b 2773 6567  orReParsing['seg
+00076fc0: 6d65 6e74 5f69 645f 6d69 736d 6174 6368  ment_id_mismatch
+00076fd0: 275d 5b61 6c74 4368 6169 6e49 645d 203d  '][altChainId] =
+00076fe0: 205f 6368 6169 6e49 640a 2020 2020 2020   _chainId.      
+00076ff0: 2020 2320 7472 7920 746f 2061 766f 6964    # try to avoid
+00077000: 206d 756c 7469 706c 6520 7365 676d 656e   multiple segmen
+00077010: 745f 6964 2061 7373 6967 6e6d 656e 7473  t_id assignments
+00077020: 0a20 2020 2020 2020 2066 6f72 206b 2c20  .        for k, 
+00077030: 5f73 7461 7473 2069 6e20 7365 6c66 2e72  _stats in self.r
+00077040: 6561 736f 6e73 466f 7252 6550 6172 7369  easonsForReParsi
+00077050: 6e67 5b27 7365 676d 656e 745f 6964 5f6d  ng['segment_id_m
+00077060: 6174 6368 5f73 7461 7473 275d 2e69 7465  atch_stats'].ite
+00077070: 6d73 2829 3a0a 2020 2020 2020 2020 2020  ms():.          
+00077080: 2020 6966 206b 203d 3d20 616c 7443 6861    if k == altCha
+00077090: 696e 4964 3a0a 2020 2020 2020 2020 2020  inId:.          
+000770a0: 2020 2020 2020 636f 6e74 696e 7565 0a20        continue. 
+000770b0: 2020 2020 2020 2020 2020 2069 6620 6368             if ch
+000770c0: 6169 6e49 6420 696e 205f 7374 6174 733a  ainId in _stats:
+000770d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000770e0: 205f 7374 6174 735b 6368 6169 6e49 645d   _stats[chainId]
+000770f0: 202d 3d20 310a 0a20 2020 2064 6566 2067   -= 1..    def g
+00077100: 6574 436f 6f72 6441 746f 6d53 6974 654f  etCoordAtomSiteO
+00077110: 6628 7365 6c66 2c20 6368 6169 6e49 642c  f(self, chainId,
+00077120: 2073 6571 4964 2c20 6369 6643 6865 636b   seqId, cifCheck
+00077130: 3d54 7275 652c 2061 7369 733d 5472 7565  =True, asis=True
+00077140: 293a 0a20 2020 2020 2020 2073 6571 4b65  ):.        seqKe
+00077150: 7920 3d20 2863 6861 696e 4964 2c20 7365  y = (chainId, se
+00077160: 7149 6429 0a20 2020 2020 2020 2069 6620  qId).        if 
+00077170: 6173 6973 3a0a 2020 2020 2020 2020 2020  asis:.          
+00077180: 2020 7265 7475 726e 2073 6571 4b65 792c    return seqKey,
+00077190: 2073 656c 662e 5f5f 636f 6f72 6441 746f   self.__coordAto
+000771a0: 6d53 6974 655b 7365 714b 6579 5d20 6966  mSite[seqKey] if
+000771b0: 2063 6966 4368 6563 6b20 616e 6420 7365   cifCheck and se
+000771c0: 714b 6579 2069 6e20 7365 6c66 2e5f 5f63  qKey in self.__c
+000771d0: 6f6f 7264 4174 6f6d 5369 7465 2065 6c73  oordAtomSite els
+000771e0: 6520 4e6f 6e65 0a20 2020 2020 2020 2069  e None.        i
+000771f0: 6620 7365 714b 6579 2069 6e20 7365 6c66  f seqKey in self
+00077200: 2e5f 5f6c 6162 656c 546f 4175 7468 5365  .__labelToAuthSe
+00077210: 713a 0a20 2020 2020 2020 2020 2020 2073  q:.            s
+00077220: 6571 4b65 7920 3d20 7365 6c66 2e5f 5f6c  eqKey = self.__l
+00077230: 6162 656c 546f 4175 7468 5365 715b 7365  abelToAuthSeq[se
+00077240: 714b 6579 5d0a 2020 2020 2020 2020 2020  qKey].          
+00077250: 2020 7265 7475 726e 2073 6571 4b65 792c    return seqKey,
+00077260: 2073 656c 662e 5f5f 636f 6f72 6441 746f   self.__coordAto
+00077270: 6d53 6974 655b 7365 714b 6579 5d20 6966  mSite[seqKey] if
+00077280: 2063 6966 4368 6563 6b20 616e 6420 7365   cifCheck and se
+00077290: 714b 6579 2069 6e20 7365 6c66 2e5f 5f63  qKey in self.__c
+000772a0: 6f6f 7264 4174 6f6d 5369 7465 2065 6c73  oordAtomSite els
+000772b0: 6520 4e6f 6e65 0a20 2020 2020 2020 2072  e None.        r
+000772c0: 6574 7572 6e20 7365 714b 6579 2c20 4e6f  eturn seqKey, No
+000772d0: 6e65 0a0a 2020 2020 6465 6620 6765 7441  ne..    def getA
+000772e0: 746f 6d49 644c 6973 7428 7365 6c66 2c20  tomIdList(self, 
+000772f0: 6661 6374 6f72 2c20 636f 6d70 4964 2c20  factor, compId, 
+00077300: 6174 6f6d 4964 293a 0a20 2020 2020 2020  atomId):.       
+00077310: 206b 6579 203d 2028 636f 6d70 4964 2c20   key = (compId, 
+00077320: 6174 6f6d 4964 2c20 2761 6c74 5f61 746f  atomId, 'alt_ato
+00077330: 6d5f 6964 2720 696e 2066 6163 746f 7229  m_id' in factor)
+00077340: 0a20 2020 2020 2020 2069 6620 6b65 7920  .        if key 
+00077350: 696e 2073 656c 662e 5f5f 6361 6368 6564  in self.__cached
+00077360: 4469 6374 466f 7241 746f 6d49 644c 6973  DictForAtomIdLis
+00077370: 743a 0a20 2020 2020 2020 2020 2020 2072  t:.            r
+00077380: 6574 7572 6e20 636f 7079 2e63 6f70 7928  eturn copy.copy(
+00077390: 7365 6c66 2e5f 5f63 6163 6865 6444 6963  self.__cachedDic
+000773a0: 7446 6f72 4174 6f6d 4964 4c69 7374 5b6b  tForAtomIdList[k
+000773b0: 6579 5d29 0a20 2020 2020 2020 2061 746f  ey]).        ato
+000773c0: 6d49 6473 2c20 5f2c 2064 6574 6169 6c73  mIds, _, details
+000773d0: 203d 2073 656c 662e 5f5f 6e65 6654 2e67   = self.__nefT.g
+000773e0: 6574 5f76 616c 6964 5f73 7461 725f 6174  et_valid_star_at
+000773f0: 6f6d 5f69 6e5f 7870 6c6f 7228 636f 6d70  om_in_xplor(comp
+00077400: 4964 2c20 6174 6f6d 4964 2c20 6c65 6176  Id, atomId, leav
+00077410: 655f 756e 6d61 7463 6865 643d 5472 7565  e_unmatched=True
+00077420: 290a 2020 2020 2020 2020 6966 2027 616c  ).        if 'al
+00077430: 745f 6174 6f6d 5f69 6427 2069 6e20 6661  t_atom_id' in fa
+00077440: 6374 6f72 2061 6e64 2064 6574 6169 6c73  ctor and details
+00077450: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
+00077460: 206c 656e 2861 746f 6d49 6429 203e 2031   len(atomId) > 1
+00077470: 2061 6e64 206e 6f74 2061 746f 6d49 645b   and not atomId[
+00077480: 2d31 5d2e 6973 616c 7068 6128 293a 0a20  -1].isalpha():. 
+00077490: 2020 2020 2020 2020 2020 2061 746f 6d49             atomI
+000774a0: 6473 2c20 5f2c 2064 6574 6169 6c73 203d  ds, _, details =
+000774b0: 2073 656c 662e 5f5f 6e65 6654 2e67 6574   self.__nefT.get
+000774c0: 5f76 616c 6964 5f73 7461 725f 6174 6f6d  _valid_star_atom
+000774d0: 5f69 6e5f 7870 6c6f 7228 636f 6d70 4964  _in_xplor(compId
+000774e0: 2c20 6174 6f6d 4964 5b3a 2d31 5d2c 206c  , atomId[:-1], l
+000774f0: 6561 7665 5f75 6e6d 6174 6368 6564 3d54  eave_unmatched=T
+00077500: 7275 6529 0a20 2020 2020 2020 2020 2020  rue).           
+00077510: 2069 6620 6174 6f6d 4964 5b2d 315d 2e69   if atomId[-1].i
+00077520: 7364 6967 6974 2829 2061 6e64 2069 6e74  sdigit() and int
+00077530: 2861 746f 6d49 645b 2d31 5d29 203c 3d20  (atomId[-1]) <= 
+00077540: 6c65 6e28 6174 6f6d 4964 7329 3a0a 2020  len(atomIds):.  
+00077550: 2020 2020 2020 2020 2020 2020 2020 6174                at
+00077560: 6f6d 4964 7320 3d20 5b61 746f 6d49 6473  omIds = [atomIds
+00077570: 5b69 6e74 2861 746f 6d49 645b 2d31 5d29  [int(atomId[-1])
+00077580: 202d 2031 5d5d 0a0a 2020 2020 2020 2020   - 1]]..        
+00077590: 6966 2064 6574 6169 6c73 2069 7320 6e6f  if details is no
+000775a0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+000775b0: 2020 2020 5f61 746f 6d49 6420 3d20 746f      _atomId = to
+000775c0: 4e65 6645 7828 7472 616e 736c 6174 6554  NefEx(translateT
+000775d0: 6f53 7464 4174 6f6d 4e61 6d65 2861 746f  oStdAtomName(ato
+000775e0: 6d49 642c 2063 6f6d 7049 642c 2063 6355  mId, compId, ccU
+000775f0: 3d73 656c 662e 5f5f 6363 5529 290a 2020  =self.__ccU)).  
+00077600: 2020 2020 2020 2020 2020 6966 205f 6174            if _at
+00077610: 6f6d 4964 2021 3d20 6174 6f6d 4964 3a0a  omId != atomId:.
+00077620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077630: 6966 2061 746f 6d49 642e 7374 6172 7473  if atomId.starts
+00077640: 7769 7468 2827 4854 2729 2061 6e64 206c  with('HT') and l
+00077650: 656e 285f 6174 6f6d 4964 2920 3d3d 2032  en(_atomId) == 2
+00077660: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00077670: 2020 2020 2020 5f61 746f 6d49 6420 3d20        _atomId = 
+00077680: 2748 270a 2020 2020 2020 2020 2020 2020  'H'.            
+00077690: 2020 2020 6174 6f6d 4964 7320 3d20 7365      atomIds = se
+000776a0: 6c66 2e5f 5f6e 6566 542e 6765 745f 7661  lf.__nefT.get_va
+000776b0: 6c69 645f 7374 6172 5f61 746f 6d5f 696e  lid_star_atom_in
+000776c0: 5f78 706c 6f72 2863 6f6d 7049 642c 205f  _xplor(compId, _
+000776d0: 6174 6f6d 4964 295b 305d 0a20 2020 2020  atomId)[0].     
+000776e0: 2020 2073 656c 662e 5f5f 6361 6368 6564     self.__cached
+000776f0: 4469 6374 466f 7241 746f 6d49 644c 6973  DictForAtomIdLis
+00077700: 745b 6b65 795d 203d 2061 746f 6d49 6473  t[key] = atomIds
+00077710: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00077720: 6174 6f6d 4964 730a 0a20 2020 2064 6566  atomIds..    def
+00077730: 2067 6574 4c61 6265 6c53 6571 4f66 6673   getLabelSeqOffs
+00077740: 6574 4475 6554 6f55 6e6f 6273 2873 656c  etDueToUnobs(sel
+00077750: 662c 2070 7329 3a0a 2020 2020 2020 2020  f, ps):.        
+00077760: 6175 7468 4368 6169 6e49 6420 3d20 7073  authChainId = ps
+00077770: 5b27 6175 7468 5f63 6861 696e 5f69 6427  ['auth_chain_id'
+00077780: 5d0a 2020 2020 2020 2020 666f 7220 6c61  ].        for la
+00077790: 6265 6c53 6571 4964 2c20 6175 7468 5365  belSeqId, authSe
+000777a0: 7149 6420 696e 207a 6970 2870 735b 2773  qId in zip(ps['s
+000777b0: 6571 5f69 6427 5d2c 2070 735b 2761 7574  eq_id'], ps['aut
+000777c0: 685f 7365 715f 6964 275d 293a 0a20 2020  h_seq_id']):.   
+000777d0: 2020 2020 2020 2020 2073 6571 4b65 7920           seqKey 
+000777e0: 3d20 2861 7574 6843 6861 696e 4964 2c20  = (authChainId, 
+000777f0: 6175 7468 5365 7149 6429 0a20 2020 2020  authSeqId).     
+00077800: 2020 2020 2020 2069 6620 7365 714b 6579         if seqKey
+00077810: 206e 6f74 2069 6e20 7365 6c66 2e5f 5f63   not in self.__c
+00077820: 6f6f 7264 556e 6f62 7352 6573 3a0a 2020  oordUnobsRes:.  
+00077830: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00077840: 7475 726e 206c 6162 656c 5365 7149 6420  turn labelSeqId 
+00077850: 2d20 310a 2020 2020 2020 2020 7265 7475  - 1.        retu
+00077860: 726e 2070 735b 2773 6571 5f69 6427 5d5b  rn ps['seq_id'][
+00077870: 2d31 5d20 2d20 310a 0a20 2020 2064 6566  -1] - 1..    def
+00077880: 2064 6f65 734e 6f6e 506f 6c79 5365 7149   doesNonPolySeqI
+00077890: 644d 6174 6368 5769 7468 506f 6c79 5365  dMatchWithPolySe
+000778a0: 7155 6e6f 6273 2873 656c 662c 2063 6861  qUnobs(self, cha
+000778b0: 696e 4964 2c20 7365 7149 6429 3a0a 2020  inId, seqId):.  
+000778c0: 2020 2020 2020 5f70 735f 203d 206e 6578        _ps_ = nex
+000778d0: 7428 285f 7073 5f20 666f 7220 5f70 735f  t((_ps_ for _ps_
+000778e0: 2069 6e20 7365 6c66 2e5f 5f70 6f6c 7953   in self.__polyS
+000778f0: 6571 2069 6620 5f70 735f 5b27 6175 7468  eq if _ps_['auth
+00077900: 5f63 6861 696e 5f69 6427 5d20 3d3d 2063  _chain_id'] == c
+00077910: 6861 696e 4964 292c 204e 6f6e 6529 0a20  hainId), None). 
+00077920: 2020 2020 2020 2069 6620 5f70 735f 2069         if _ps_ i
+00077930: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+00077940: 2020 2020 2020 2020 5f63 6861 696e 4964          _chainId
+00077950: 5f20 3d20 5f70 735f 5b27 6368 6169 6e5f  _ = _ps_['chain_
+00077960: 6964 275d 0a20 2020 2020 2020 2020 2020  id'].           
+00077970: 205f 7365 714b 6579 5f20 3d20 285f 6368   _seqKey_ = (_ch
+00077980: 6169 6e49 645f 2c20 7365 7149 6429 0a20  ainId_, seqId). 
+00077990: 2020 2020 2020 2020 2020 2069 6620 5f73             if _s
+000779a0: 6571 4b65 795f 2069 6e20 7365 6c66 2e5f  eqKey_ in self._
+000779b0: 5f6c 6162 656c 546f 4175 7468 5365 713a  _labelToAuthSeq:
+000779c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000779d0: 2069 6620 7365 6c66 2e5f 5f6c 6162 656c   if self.__label
+000779e0: 546f 4175 7468 5365 715b 5f73 6571 4b65  ToAuthSeq[_seqKe
+000779f0: 795f 5d20 213d 205f 7365 714b 6579 5f3a  y_] != _seqKey_:
+00077a00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00077a10: 2020 2020 2069 6620 7365 6c66 2e5f 5f6c       if self.__l
+00077a20: 6162 656c 546f 4175 7468 5365 715b 5f73  abelToAuthSeq[_s
+00077a30: 6571 4b65 795f 5d20 696e 2073 656c 662e  eqKey_] in self.
+00077a40: 5f5f 636f 6f72 6455 6e6f 6273 5265 733a  __coordUnobsRes:
+00077a50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00077a60: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00077a70: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
+00077a80: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00077a90: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00077aa0: 6178 5f6c 6162 656c 5f73 6571 5f69 6420  ax_label_seq_id 
+00077ab0: 3d20 5f70 735f 5b27 7365 715f 6964 275d  = _ps_['seq_id']
+00077ac0: 5b2d 315d 0a20 2020 2020 2020 2020 2020  [-1].           
+00077ad0: 2020 2020 2020 2020 205f 7365 7149 645f           _seqId_
+00077ae0: 203d 2073 6571 4964 202b 2031 0a20 2020   = seqId + 1.   
+00077af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077b00: 2077 6869 6c65 205f 7365 7149 645f 203c   while _seqId_ <
+00077b10: 3d20 6d61 785f 6c61 6265 6c5f 7365 715f  = max_label_seq_
+00077b20: 6964 3a0a 2020 2020 2020 2020 2020 2020  id:.            
+00077b30: 2020 2020 2020 2020 2020 2020 6966 205f              if _
+00077b40: 7365 7149 645f 2069 6e20 5f70 735f 5b27  seqId_ in _ps_['
+00077b50: 7365 715f 6964 275d 3a0a 2020 2020 2020  seq_id']:.      
+00077b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077b70: 2020 2020 2020 5f73 6571 4b65 795f 203d        _seqKey_ =
+00077b80: 2028 5f63 6861 696e 4964 5f2c 205f 7365   (_chainId_, _se
+00077b90: 7149 645f 290a 2020 2020 2020 2020 2020  qId_).          
+00077ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077bb0: 2020 6966 205f 7365 714b 6579 5f20 696e    if _seqKey_ in
+00077bc0: 2073 656c 662e 5f5f 6c61 6265 6c54 6f41   self.__labelToA
+00077bd0: 7574 6853 6571 2061 6e64 2073 656c 662e  uthSeq and self.
+00077be0: 5f5f 6c61 6265 6c54 6f41 7574 6853 6571  __labelToAuthSeq
+00077bf0: 5b5f 7365 714b 6579 5f5d 2021 3d20 5f73  [_seqKey_] != _s
+00077c00: 6571 4b65 795f 3a0a 2020 2020 2020 2020  eqKey_:.        
+00077c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077c20: 2020 2020 2020 2020 6272 6561 6b0a 2020          break.  
+00077c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077c40: 2020 2020 2020 5f73 6571 4964 5f20 2b3d        _seqId_ +=
+00077c50: 2031 0a20 2020 2020 2020 2020 2020 2020   1.             
+00077c60: 2020 2020 2020 2069 6620 5f73 6571 4964         if _seqId
+00077c70: 5f20 6e6f 7420 696e 205f 7073 5f5b 2773  _ not in _ps_['s
+00077c80: 6571 5f69 6427 5d3a 0a20 2020 2020 2020  eq_id']:.       
+00077c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077ca0: 206d 696e 5f6c 6162 656c 5f73 6571 5f69   min_label_seq_i
+00077cb0: 6420 3d20 5f70 735f 5b27 7365 715f 6964  d = _ps_['seq_id
+00077cc0: 275d 5b30 5d0a 2020 2020 2020 2020 2020  '][0].          
+00077cd0: 2020 2020 2020 2020 2020 2020 2020 5f73                _s
+00077ce0: 6571 4964 5f20 3d20 7365 7149 6420 2d20  eqId_ = seqId - 
+00077cf0: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
+00077d00: 2020 2020 2020 2020 2020 7768 696c 6520            while 
+00077d10: 5f73 6571 4964 5f20 3e3d 206d 696e 5f6c  _seqId_ >= min_l
+00077d20: 6162 656c 5f73 6571 5f69 643a 0a20 2020  abel_seq_id:.   
 00077d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077d40: 2020 2020 2020 2020 205f 5f73 6571 4b65           __seqKe
-00077d50: 795f 5f20 3d20 285f 5f63 6861 696e 4964  y__ = (__chainId
-00077d60: 5f5f 2c20 5f5f 7365 7149 645f 5f20 2d20  __, __seqId__ - 
-00077d70: 285f 7365 7149 645f 202d 2073 6571 4964  (_seqId_ - seqId
-00077d80: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
-00077d90: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00077da0: 6620 5f5f 7365 714b 6579 5f5f 2069 6e20  f __seqKey__ in 
-00077db0: 7365 6c66 2e5f 5f63 6f6f 7264 556e 6f62  self.__coordUnob
-00077dc0: 7352 6573 3a0a 2020 2020 2020 2020 2020  sRes:.          
-00077dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00077de0: 2020 2020 2020 7265 7475 726e 2054 7275        return Tru
-00077df0: 650a 2020 2020 2020 2020 7265 7475 726e  e.        return
-00077e00: 2046 616c 7365 0a0a 2020 2020 6465 6620   False..    def 
-00077e10: 696e 7465 7273 6563 7469 6f6e 4661 6374  intersectionFact
-00077e20: 6f72 5f65 7870 7265 7373 696f 6e73 2873  or_expressions(s
-00077e30: 656c 662c 2061 746f 6d53 656c 6563 7469  elf, atomSelecti
-00077e40: 6f6e 3d4e 6f6e 6529 3a0a 2020 2020 2020  on=None):.      
-00077e50: 2020 7365 6c66 2e63 6f6e 7375 6d65 4661    self.consumeFa
-00077e60: 6374 6f72 5f65 7870 7265 7373 696f 6e73  ctor_expressions
-00077e70: 2863 6966 4368 6563 6b3d 4661 6c73 6529  (cifCheck=False)
-00077e80: 0a0a 2020 2020 2020 2020 7365 6c66 2e66  ..        self.f
-00077e90: 6163 746f 7220 3d20 7365 6c66 2e5f 5f69  actor = self.__i
-00077ea0: 6e74 6572 7365 6374 696f 6e46 6163 746f  ntersectionFacto
-00077eb0: 725f 6578 7072 6573 7369 6f6e 7328 7365  r_expressions(se
-00077ec0: 6c66 2e66 6163 746f 722c 2061 746f 6d53  lf.factor, atomS
-00077ed0: 656c 6563 7469 6f6e 290a 0a20 2020 2064  election)..    d
-00077ee0: 6566 205f 5f69 6e74 6572 7365 6374 696f  ef __intersectio
-00077ef0: 6e46 6163 746f 725f 6578 7072 6573 7369  nFactor_expressi
-00077f00: 6f6e 7328 7365 6c66 2c20 5f66 6163 746f  ons(self, _facto
-00077f10: 722c 2061 746f 6d53 656c 6563 7469 6f6e  r, atomSelection
-00077f20: 3d4e 6f6e 6529 3a20 2023 2070 796c 696e  =None):  # pylin
-00077f30: 743a 2064 6973 6162 6c65 3d6e 6f2d 7365  t: disable=no-se
-00077f40: 6c66 2d75 7365 0a20 2020 2020 2020 2069  lf-use.        i
-00077f50: 6620 2761 746f 6d5f 7365 6c65 6374 696f  f 'atom_selectio
-00077f60: 6e27 206e 6f74 2069 6e20 5f66 6163 746f  n' not in _facto
-00077f70: 723a 0a20 2020 2020 2020 2020 2020 205f  r:.            _
-00077f80: 6661 6374 6f72 5b27 6174 6f6d 5f73 656c  factor['atom_sel
-00077f90: 6563 7469 6f6e 275d 203d 2061 746f 6d53  ection'] = atomS
-00077fa0: 656c 6563 7469 6f6e 0a20 2020 2020 2020  election.       
-00077fb0: 2020 2020 2072 6574 7572 6e20 5f66 6163       return _fac
-00077fc0: 746f 720a 0a20 2020 2020 2020 2069 6620  tor..        if 
-00077fd0: 6174 6f6d 5365 6c65 6374 696f 6e20 6973  atomSelection is
-00077fe0: 204e 6f6e 6520 6f72 206c 656e 2861 746f   None or len(ato
-00077ff0: 6d53 656c 6563 7469 6f6e 2920 3d3d 2030  mSelection) == 0
-00078000: 3a0a 2020 2020 2020 2020 2020 2020 5f66  :.            _f
-00078010: 6163 746f 725b 2761 746f 6d5f 7365 6c65  actor['atom_sele
-00078020: 6374 696f 6e27 5d20 3d20 5b5d 0a0a 2020  ction'] = []..  
-00078030: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
-00078040: 7461 6e63 6528 6174 6f6d 5365 6c65 6374  tance(atomSelect
-00078050: 696f 6e5b 305d 2c20 7374 7229 2061 6e64  ion[0], str) and
-00078060: 2061 746f 6d53 656c 6563 7469 6f6e 5b30   atomSelection[0
-00078070: 5d20 3d3d 2027 2a27 3a0a 2020 2020 2020  ] == '*':.      
-00078080: 2020 2020 2020 7265 7475 726e 205f 6661        return _fa
-00078090: 6374 6f72 0a0a 2020 2020 2020 2020 5f61  ctor..        _a
-000780a0: 746f 6d53 656c 6563 7469 6f6e 203d 205b  tomSelection = [
-000780b0: 5d0a 2020 2020 2020 2020 666f 7220 5f61  ].        for _a
-000780c0: 746f 6d20 696e 205f 6661 6374 6f72 5b27  tom in _factor['
-000780d0: 6174 6f6d 5f73 656c 6563 7469 6f6e 275d  atom_selection']
-000780e0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-000780f0: 2069 7369 6e73 7461 6e63 6528 5f61 746f   isinstance(_ato
-00078100: 6d2c 2073 7472 2920 616e 6420 5f61 746f  m, str) and _ato
-00078110: 6d20 3d3d 2027 2a27 3a0a 2020 2020 2020  m == '*':.      
-00078120: 2020 2020 2020 2020 2020 5f66 6163 746f            _facto
-00078130: 725b 2761 746f 6d5f 7365 6c65 6374 696f  r['atom_selectio
-00078140: 6e27 5d20 3d20 6174 6f6d 5365 6c65 6374  n'] = atomSelect
-00078150: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
-00078160: 2020 2020 7265 7475 726e 205f 6661 6374      return _fact
-00078170: 6f72 0a20 2020 2020 2020 2020 2020 2069  or.            i
-00078180: 6620 5f61 746f 6d20 696e 2061 746f 6d53  f _atom in atomS
-00078190: 656c 6563 7469 6f6e 3a0a 2020 2020 2020  election:.      
-000781a0: 2020 2020 2020 2020 2020 5f61 746f 6d53            _atomS
-000781b0: 656c 6563 7469 6f6e 2e61 7070 656e 6428  election.append(
-000781c0: 5f61 746f 6d29 0a20 2020 2020 2020 2020  _atom).         
-000781d0: 2020 2065 6c69 6620 2768 7964 726f 6765     elif 'hydroge
-000781e0: 6e5f 6e6f 745f 696e 7374 616e 7469 6174  n_not_instantiat
-000781f0: 6564 2720 696e 205f 6174 6f6d 2061 6e64  ed' in _atom and
-00078200: 205f 6174 6f6d 5b27 6879 6472 6f67 656e   _atom['hydrogen
-00078210: 5f6e 6f74 5f69 6e73 7461 6e74 6961 7465  _not_instantiate
-00078220: 6427 5d3a 0a20 2020 2020 2020 2020 2020  d']:.           
-00078230: 2020 2020 2063 6861 696e 5f69 6420 3d20       chain_id = 
-00078240: 5f61 746f 6d5b 2763 6861 696e 5f69 6427  _atom['chain_id'
-00078250: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00078260: 2020 7365 715f 6964 203d 205f 6174 6f6d    seq_id = _atom
-00078270: 5b27 7365 715f 6964 275d 0a20 2020 2020  ['seq_id'].     
-00078280: 2020 2020 2020 2020 2020 2069 6620 616e             if an
-00078290: 7928 5f61 746f 6d32 2066 6f72 205f 6174  y(_atom2 for _at
-000782a0: 6f6d 3220 696e 2061 746f 6d53 656c 6563  om2 in atomSelec
-000782b0: 7469 6f6e 2069 6620 5f61 746f 6d32 5b27  tion if _atom2['
-000782c0: 6368 6169 6e5f 6964 275d 203d 3d20 6368  chain_id'] == ch
-000782d0: 6169 6e5f 6964 2061 6e64 205f 6174 6f6d  ain_id and _atom
-000782e0: 325b 2773 6571 5f69 6427 5d20 3d3d 2073  2['seq_id'] == s
-000782f0: 6571 5f69 6429 3a0a 2020 2020 2020 2020  eq_id):.        
-00078300: 2020 2020 2020 2020 2020 2020 5f61 746f              _ato
-00078310: 6d53 656c 6563 7469 6f6e 2e61 7070 656e  mSelection.appen
-00078320: 6428 5f61 746f 6d29 0a0a 2020 2020 2020  d(_atom)..      
-00078330: 2020 5f66 6163 746f 725b 2761 746f 6d5f    _factor['atom_
-00078340: 7365 6c65 6374 696f 6e27 5d20 3d20 5f61  selection'] = _a
-00078350: 746f 6d53 656c 6563 7469 6f6e 0a0a 2020  tomSelection..  
-00078360: 2020 2020 2020 7265 7475 726e 205f 6661        return _fa
-00078370: 6374 6f72 0a0a 2020 2020 6465 6620 5f5f  ctor..    def __
-00078380: 696e 7465 7273 6563 7469 6f6e 4174 6f6d  intersectionAtom
-00078390: 5f73 656c 6563 7469 6f6e 7328 7365 6c66  _selections(self
-000783a0: 2c20 5f73 656c 6563 7469 6f6e 312c 205f  , _selection1, _
-000783b0: 7365 6c65 6374 696f 6e32 293a 2020 2320  selection2):  # 
-000783c0: 7079 6c69 6e74 3a20 6469 7361 626c 653d  pylint: disable=
-000783d0: 6e6f 2d73 656c 662d 7573 650a 2020 2020  no-self-use.    
-000783e0: 2020 2020 6966 205f 7365 6c65 6374 696f      if _selectio
-000783f0: 6e31 2069 7320 4e6f 6e65 206f 7220 6c65  n1 is None or le
-00078400: 6e28 5f73 656c 6563 7469 6f6e 3129 203d  n(_selection1) =
-00078410: 3d20 3020 6f72 205f 7365 6c65 6374 696f  = 0 or _selectio
-00078420: 6e32 2069 7320 4e6f 6e65 206f 7220 6c65  n2 is None or le
-00078430: 6e28 5f73 656c 6563 7469 6f6e 3229 203d  n(_selection2) =
-00078440: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
-00078450: 2072 6574 7572 6e20 5b5d 0a0a 2020 2020   return []..    
-00078460: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00078470: 6528 5f73 656c 6563 7469 6f6e 325b 305d  e(_selection2[0]
-00078480: 2c20 7374 7229 2061 6e64 205f 7365 6c65  , str) and _sele
-00078490: 6374 696f 6e32 5b30 5d20 3d3d 2027 2a27  ction2[0] == '*'
-000784a0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-000784b0: 7475 726e 205f 7365 6c65 6374 696f 6e31  turn _selection1
-000784c0: 0a0a 2020 2020 2020 2020 6861 7341 7574  ..        hasAut
-000784d0: 6853 6571 4964 3120 3d20 616e 7928 5f61  hSeqId1 = any(_a
-000784e0: 746f 6d20 666f 7220 5f61 746f 6d20 696e  tom for _atom in
-000784f0: 205f 7365 6c65 6374 696f 6e31 2069 6620   _selection1 if 
-00078500: 2761 7574 685f 6174 6f6d 5f69 6427 2069  'auth_atom_id' i
-00078510: 6e20 5f61 746f 6d29 0a20 2020 2020 2020  n _atom).       
-00078520: 2068 6173 4175 7468 5365 7149 6432 203d   hasAuthSeqId2 =
-00078530: 2061 6e79 285f 6174 6f6d 2066 6f72 205f   any(_atom for _
-00078540: 6174 6f6d 2069 6e20 5f73 656c 6563 7469  atom in _selecti
-00078550: 6f6e 3220 6966 2027 6175 7468 5f61 746f  on2 if 'auth_ato
-00078560: 6d5f 6964 2720 696e 205f 6174 6f6d 290a  m_id' in _atom).
-00078570: 0a20 2020 2020 2020 205f 6174 6f6d 5365  .        _atomSe
-00078580: 6c65 6374 696f 6e20 3d20 5b5d 0a0a 2020  lection = []..  
-00078590: 2020 2020 2020 6966 206e 6f74 2068 6173        if not has
-000785a0: 4175 7468 5365 7149 6431 2061 6e64 206e  AuthSeqId1 and n
-000785b0: 6f74 2068 6173 4175 7468 5365 7149 6432  ot hasAuthSeqId2
-000785c0: 3a0a 2020 2020 2020 2020 2020 2020 666f  :.            fo
-000785d0: 7220 5f61 746f 6d20 696e 205f 7365 6c65  r _atom in _sele
-000785e0: 6374 696f 6e31 3a0a 2020 2020 2020 2020  ction1:.        
-000785f0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00078600: 7461 6e63 6528 5f61 746f 6d2c 2073 7472  tance(_atom, str
-00078610: 2920 616e 6420 5f61 746f 6d20 3d3d 2027  ) and _atom == '
-00078620: 2a27 3a0a 2020 2020 2020 2020 2020 2020  *':.            
-00078630: 2020 2020 2020 2020 7265 7475 726e 205f          return _
-00078640: 7365 6c65 6374 696f 6e32 0a20 2020 2020  selection2.     
-00078650: 2020 2020 2020 2020 2020 2069 6620 5f61             if _a
-00078660: 746f 6d20 696e 205f 7365 6c65 6374 696f  tom in _selectio
-00078670: 6e32 3a0a 2020 2020 2020 2020 2020 2020  n2:.            
-00078680: 2020 2020 2020 2020 5f61 746f 6d53 656c          _atomSel
-00078690: 6563 7469 6f6e 2e61 7070 656e 6428 5f61  ection.append(_a
-000786a0: 746f 6d29 0a20 2020 2020 2020 2020 2020  tom).           
-000786b0: 2020 2020 2065 6c69 6620 2768 7964 726f       elif 'hydro
-000786c0: 6765 6e5f 6e6f 745f 696e 7374 616e 7469  gen_not_instanti
-000786d0: 6174 6564 2720 696e 205f 6174 6f6d 2061  ated' in _atom a
-000786e0: 6e64 205f 6174 6f6d 5b27 6879 6472 6f67  nd _atom['hydrog
-000786f0: 656e 5f6e 6f74 5f69 6e73 7461 6e74 6961  en_not_instantia
-00078700: 7465 6427 5d3a 0a20 2020 2020 2020 2020  ted']:.         
-00078710: 2020 2020 2020 2020 2020 2063 6861 696e             chain
-00078720: 5f69 6420 3d20 5f61 746f 6d5b 2763 6861  _id = _atom['cha
-00078730: 696e 5f69 6427 5d0a 2020 2020 2020 2020  in_id'].        
-00078740: 2020 2020 2020 2020 2020 2020 7365 715f              seq_
-00078750: 6964 203d 205f 6174 6f6d 5b27 7365 715f  id = _atom['seq_
-00078760: 6964 275d 0a20 2020 2020 2020 2020 2020  id'].           
-00078770: 2020 2020 2020 2020 2069 6620 616e 7928           if any(
-00078780: 5f61 746f 6d32 2066 6f72 205f 6174 6f6d  _atom2 for _atom
-00078790: 3220 696e 205f 7365 6c65 6374 696f 6e32  2 in _selection2
-000787a0: 2069 6620 5f61 746f 6d32 5b27 6368 6169   if _atom2['chai
-000787b0: 6e5f 6964 275d 203d 3d20 6368 6169 6e5f  n_id'] == chain_
-000787c0: 6964 2061 6e64 205f 6174 6f6d 325b 2773  id and _atom2['s
-000787d0: 6571 5f69 6427 5d20 3d3d 2073 6571 5f69  eq_id'] == seq_i
-000787e0: 6429 3a0a 2020 2020 2020 2020 2020 2020  d):.            
-000787f0: 2020 2020 2020 2020 2020 2020 5f61 746f              _ato
-00078800: 6d53 656c 6563 7469 6f6e 2e61 7070 656e  mSelection.appen
-00078810: 6428 5f61 746f 6d29 0a0a 2020 2020 2020  d(_atom)..      
-00078820: 2020 656c 6966 2068 6173 4175 7468 5365    elif hasAuthSe
-00078830: 7149 6431 2061 6e64 206e 6f74 2068 6173  qId1 and not has
-00078840: 4175 7468 5365 7149 6432 3a0a 2020 2020  AuthSeqId2:.    
-00078850: 2020 2020 2020 2020 5f5f 7365 6c65 6374          __select
-00078860: 696f 6e31 203d 2063 6f70 792e 6465 6570  ion1 = copy.deep
-00078870: 636f 7079 285f 7365 6c65 6374 696f 6e31  copy(_selection1
-00078880: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
-00078890: 7220 5f61 746f 6d20 696e 205f 5f73 656c  r _atom in __sel
-000788a0: 6563 7469 6f6e 313a 0a20 2020 2020 2020  ection1:.       
-000788b0: 2020 2020 2020 2020 2069 6620 2761 7574           if 'aut
-000788c0: 685f 6174 6f6d 5f69 6427 2069 6e20 5f61  h_atom_id' in _a
-000788d0: 746f 6d3a 0a20 2020 2020 2020 2020 2020  tom:.           
-000788e0: 2020 2020 2020 2020 205f 6174 6f6d 2e70           _atom.p
-000788f0: 6f70 2827 6175 7468 5f61 746f 6d5f 6964  op('auth_atom_id
-00078900: 2729 0a20 2020 2020 2020 2020 2020 2066  ').            f
-00078910: 6f72 2069 6478 2c20 5f61 746f 6d20 696e  or idx, _atom in
-00078920: 2065 6e75 6d65 7261 7465 285f 5f73 656c   enumerate(__sel
-00078930: 6563 7469 6f6e 3129 3a0a 2020 2020 2020  ection1):.      
-00078940: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
-00078950: 6e73 7461 6e63 6528 5f61 746f 6d2c 2073  nstance(_atom, s
-00078960: 7472 2920 616e 6420 5f61 746f 6d20 3d3d  tr) and _atom ==
-00078970: 2027 2a27 3a0a 2020 2020 2020 2020 2020   '*':.          
-00078980: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00078990: 205f 7365 6c65 6374 696f 6e32 0a20 2020   _selection2.   
-000789a0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000789b0: 5f61 746f 6d20 696e 205f 7365 6c65 6374  _atom in _select
-000789c0: 696f 6e32 3a0a 2020 2020 2020 2020 2020  ion2:.          
-000789d0: 2020 2020 2020 2020 2020 5f61 746f 6d53            _atomS
-000789e0: 656c 6563 7469 6f6e 2e61 7070 656e 6428  election.append(
-000789f0: 5f73 656c 6563 7469 6f6e 315b 6964 785d  _selection1[idx]
-00078a00: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00078a10: 2020 656c 6966 2027 6879 6472 6f67 656e    elif 'hydrogen
-00078a20: 5f6e 6f74 5f69 6e73 7461 6e74 6961 7465  _not_instantiate
-00078a30: 6427 2069 6e20 5f61 746f 6d20 616e 6420  d' in _atom and 
-00078a40: 5f61 746f 6d5b 2768 7964 726f 6765 6e5f  _atom['hydrogen_
-00078a50: 6e6f 745f 696e 7374 616e 7469 6174 6564  not_instantiated
-00078a60: 275d 3a0a 2020 2020 2020 2020 2020 2020  ']:.            
-00078a70: 2020 2020 2020 2020 6368 6169 6e5f 6964          chain_id
-00078a80: 203d 205f 6174 6f6d 5b27 6368 6169 6e5f   = _atom['chain_
-00078a90: 6964 275d 0a20 2020 2020 2020 2020 2020  id'].           
-00078aa0: 2020 2020 2020 2020 2073 6571 5f69 6420           seq_id 
-00078ab0: 3d20 5f61 746f 6d5b 2773 6571 5f69 6427  = _atom['seq_id'
-00078ac0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00078ad0: 2020 2020 2020 6966 2061 6e79 285f 6174        if any(_at
-00078ae0: 6f6d 3220 666f 7220 5f61 746f 6d32 2069  om2 for _atom2 i
-00078af0: 6e20 5f73 656c 6563 7469 6f6e 3220 6966  n _selection2 if
-00078b00: 205f 6174 6f6d 325b 2763 6861 696e 5f69   _atom2['chain_i
-00078b10: 6427 5d20 3d3d 2063 6861 696e 5f69 6420  d'] == chain_id 
-00078b20: 616e 6420 5f61 746f 6d32 5b27 7365 715f  and _atom2['seq_
-00078b30: 6964 275d 203d 3d20 7365 715f 6964 293a  id'] == seq_id):
-00078b40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00078b50: 2020 2020 2020 2020 205f 6174 6f6d 5365           _atomSe
-00078b60: 6c65 6374 696f 6e2e 6170 7065 6e64 285f  lection.append(_
-00078b70: 7365 6c65 6374 696f 6e31 5b69 6478 5d29  selection1[idx])
-00078b80: 0a0a 2020 2020 2020 2020 656c 6966 206e  ..        elif n
-00078b90: 6f74 2068 6173 4175 7468 5365 7149 6431  ot hasAuthSeqId1
-00078ba0: 2061 6e64 2068 6173 4175 7468 5365 7149   and hasAuthSeqI
-00078bb0: 6432 3a0a 2020 2020 2020 2020 2020 2020  d2:.            
-00078bc0: 5f5f 7365 6c65 6374 696f 6e32 203d 2063  __selection2 = c
-00078bd0: 6f70 792e 6465 6570 636f 7079 285f 7365  opy.deepcopy(_se
-00078be0: 6c65 6374 696f 6e32 290a 2020 2020 2020  lection2).      
-00078bf0: 2020 2020 2020 666f 7220 6964 782c 205f        for idx, _
-00078c00: 6174 6f6d 2069 6e20 656e 756d 6572 6174  atom in enumerat
-00078c10: 6528 5f5f 7365 6c65 6374 696f 6e32 293a  e(__selection2):
-00078c20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00078c30: 2069 6620 2761 7574 685f 6174 6f6d 5f69   if 'auth_atom_i
-00078c40: 6427 2069 6e20 5f61 746f 6d3a 0a20 2020  d' in _atom:.   
-00078c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078c60: 205f 6174 6f6d 2e70 6f70 2827 6175 7468   _atom.pop('auth
-00078c70: 5f61 746f 6d5f 6964 2729 0a20 2020 2020  _atom_id').     
-00078c80: 2020 2020 2020 2066 6f72 2069 6478 2c20         for idx, 
-00078c90: 5f61 746f 6d20 696e 2065 6e75 6d65 7261  _atom in enumera
-00078ca0: 7465 285f 5f73 656c 6563 7469 6f6e 3229  te(__selection2)
-00078cb0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00078cc0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00078cd0: 5f61 746f 6d2c 2073 7472 2920 616e 6420  _atom, str) and 
-00078ce0: 5f61 746f 6d20 3d3d 2027 2a27 3a0a 2020  _atom == '*':.  
-00078cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078d00: 2020 7265 7475 726e 205f 7365 6c65 6374    return _select
-00078d10: 696f 6e31 0a20 2020 2020 2020 2020 2020  ion1.           
-00078d20: 2020 2020 2069 6620 5f61 746f 6d20 696e       if _atom in
-00078d30: 205f 7365 6c65 6374 696f 6e31 3a0a 2020   _selection1:.  
-00078d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078d50: 2020 5f61 746f 6d53 656c 6563 7469 6f6e    _atomSelection
-00078d60: 2e61 7070 656e 6428 5f73 656c 6563 7469  .append(_selecti
-00078d70: 6f6e 325b 6964 785d 290a 2020 2020 2020  on2[idx]).      
-00078d80: 2020 2020 2020 2020 2020 656c 6966 2027            elif '
-00078d90: 6879 6472 6f67 656e 5f6e 6f74 5f69 6e73  hydrogen_not_ins
-00078da0: 7461 6e74 6961 7465 6427 2069 6e20 5f61  tantiated' in _a
-00078db0: 746f 6d20 616e 6420 5f61 746f 6d5b 2768  tom and _atom['h
-00078dc0: 7964 726f 6765 6e5f 6e6f 745f 696e 7374  ydrogen_not_inst
-00078dd0: 616e 7469 6174 6564 275d 3a0a 2020 2020  antiated']:.    
-00078de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078df0: 6368 6169 6e5f 6964 203d 205f 6174 6f6d  chain_id = _atom
-00078e00: 5b27 6368 6169 6e5f 6964 275d 0a20 2020  ['chain_id'].   
-00078e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078e20: 2073 6571 5f69 6420 3d20 5f61 746f 6d5b   seq_id = _atom[
-00078e30: 2773 6571 5f69 6427 5d0a 2020 2020 2020  'seq_id'].      
-00078e40: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00078e50: 2061 6e79 285f 6174 6f6d 3120 666f 7220   any(_atom1 for 
-00078e60: 5f61 746f 6d31 2069 6e20 5f73 656c 6563  _atom1 in _selec
-00078e70: 7469 6f6e 3120 6966 205f 6174 6f6d 315b  tion1 if _atom1[
-00078e80: 2763 6861 696e 5f69 6427 5d20 3d3d 2063  'chain_id'] == c
-00078e90: 6861 696e 5f69 6420 616e 6420 5f61 746f  hain_id and _ato
-00078ea0: 6d31 5b27 7365 715f 6964 275d 203d 3d20  m1['seq_id'] == 
-00078eb0: 7365 715f 6964 293a 0a20 2020 2020 2020  seq_id):.       
+00077d40: 2020 2020 2020 2020 2069 6620 5f73 6571           if _seq
+00077d50: 4964 5f20 696e 205f 7073 5f5b 2773 6571  Id_ in _ps_['seq
+00077d60: 5f69 6427 5d3a 0a20 2020 2020 2020 2020  _id']:.         
+00077d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077d80: 2020 2020 2020 205f 7365 714b 6579 5f20         _seqKey_ 
+00077d90: 3d20 285f 6368 6169 6e49 645f 2c20 5f73  = (_chainId_, _s
+00077da0: 6571 4964 5f29 0a20 2020 2020 2020 2020  eqId_).         
+00077db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077dc0: 2020 2020 2020 2069 6620 5f73 6571 4b65         if _seqKe
+00077dd0: 795f 2069 6e20 7365 6c66 2e5f 5f6c 6162  y_ in self.__lab
+00077de0: 656c 546f 4175 7468 5365 7120 616e 6420  elToAuthSeq and 
+00077df0: 7365 6c66 2e5f 5f6c 6162 656c 546f 4175  self.__labelToAu
+00077e00: 7468 5365 715b 5f73 6571 4b65 795f 5d20  thSeq[_seqKey_] 
+00077e10: 213d 205f 7365 714b 6579 5f3a 0a20 2020  != _seqKey_:.   
+00077e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077e40: 2062 7265 616b 0a20 2020 2020 2020 2020   break.         
+00077e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077e60: 2020 205f 7365 7149 645f 202d 3d20 310a     _seqId_ -= 1.
+00077e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077e80: 2020 2020 6966 205f 7365 7149 645f 2069      if _seqId_ i
+00077e90: 6e20 5f70 735f 5b27 7365 715f 6964 275d  n _ps_['seq_id']
+00077ea0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00077eb0: 2020 2020 2020 2020 2020 5f73 6571 4b65            _seqKe
+00077ec0: 795f 203d 2028 5f63 6861 696e 4964 5f2c  y_ = (_chainId_,
+00077ed0: 205f 7365 7149 645f 290a 2020 2020 2020   _seqId_).      
+00077ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077ef0: 2020 6966 205f 7365 714b 6579 5f20 696e    if _seqKey_ in
+00077f00: 2073 656c 662e 5f5f 6c61 6265 6c54 6f41   self.__labelToA
+00077f10: 7574 6853 6571 2061 6e64 2073 656c 662e  uthSeq and self.
+00077f20: 5f5f 6c61 6265 6c54 6f41 7574 6853 6571  __labelToAuthSeq
+00077f30: 5b5f 7365 714b 6579 5f5d 2021 3d20 5f73  [_seqKey_] != _s
+00077f40: 6571 4b65 795f 3a0a 2020 2020 2020 2020  eqKey_:.        
+00077f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077f60: 2020 2020 5f5f 6368 6169 6e49 645f 5f2c      __chainId__,
+00077f70: 205f 5f73 6571 4964 5f5f 203d 2073 656c   __seqId__ = sel
+00077f80: 662e 5f5f 6c61 6265 6c54 6f41 7574 6853  f.__labelToAuthS
+00077f90: 6571 5b5f 7365 714b 6579 5f5d 0a20 2020  eq[_seqKey_].   
+00077fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00077fb0: 2020 2020 2020 2020 205f 5f73 6571 4b65           __seqKe
+00077fc0: 795f 5f20 3d20 285f 5f63 6861 696e 4964  y__ = (__chainId
+00077fd0: 5f5f 2c20 5f5f 7365 7149 645f 5f20 2d20  __, __seqId__ - 
+00077fe0: 285f 7365 7149 645f 202d 2073 6571 4964  (_seqId_ - seqId
+00077ff0: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+00078000: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00078010: 6620 5f5f 7365 714b 6579 5f5f 2069 6e20  f __seqKey__ in 
+00078020: 7365 6c66 2e5f 5f63 6f6f 7264 556e 6f62  self.__coordUnob
+00078030: 7352 6573 3a0a 2020 2020 2020 2020 2020  sRes:.          
+00078040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078050: 2020 2020 2020 7265 7475 726e 2054 7275        return Tru
+00078060: 650a 2020 2020 2020 2020 7265 7475 726e  e.        return
+00078070: 2046 616c 7365 0a0a 2020 2020 6465 6620   False..    def 
+00078080: 696e 7465 7273 6563 7469 6f6e 4661 6374  intersectionFact
+00078090: 6f72 5f65 7870 7265 7373 696f 6e73 2873  or_expressions(s
+000780a0: 656c 662c 2061 746f 6d53 656c 6563 7469  elf, atomSelecti
+000780b0: 6f6e 3d4e 6f6e 6529 3a0a 2020 2020 2020  on=None):.      
+000780c0: 2020 7365 6c66 2e63 6f6e 7375 6d65 4661    self.consumeFa
+000780d0: 6374 6f72 5f65 7870 7265 7373 696f 6e73  ctor_expressions
+000780e0: 2863 6966 4368 6563 6b3d 4661 6c73 6529  (cifCheck=False)
+000780f0: 0a0a 2020 2020 2020 2020 7365 6c66 2e66  ..        self.f
+00078100: 6163 746f 7220 3d20 7365 6c66 2e5f 5f69  actor = self.__i
+00078110: 6e74 6572 7365 6374 696f 6e46 6163 746f  ntersectionFacto
+00078120: 725f 6578 7072 6573 7369 6f6e 7328 7365  r_expressions(se
+00078130: 6c66 2e66 6163 746f 722c 2061 746f 6d53  lf.factor, atomS
+00078140: 656c 6563 7469 6f6e 290a 0a20 2020 2064  election)..    d
+00078150: 6566 205f 5f69 6e74 6572 7365 6374 696f  ef __intersectio
+00078160: 6e46 6163 746f 725f 6578 7072 6573 7369  nFactor_expressi
+00078170: 6f6e 7328 7365 6c66 2c20 5f66 6163 746f  ons(self, _facto
+00078180: 722c 2061 746f 6d53 656c 6563 7469 6f6e  r, atomSelection
+00078190: 3d4e 6f6e 6529 3a20 2023 2070 796c 696e  =None):  # pylin
+000781a0: 743a 2064 6973 6162 6c65 3d6e 6f2d 7365  t: disable=no-se
+000781b0: 6c66 2d75 7365 0a20 2020 2020 2020 2069  lf-use.        i
+000781c0: 6620 2761 746f 6d5f 7365 6c65 6374 696f  f 'atom_selectio
+000781d0: 6e27 206e 6f74 2069 6e20 5f66 6163 746f  n' not in _facto
+000781e0: 723a 0a20 2020 2020 2020 2020 2020 205f  r:.            _
+000781f0: 6661 6374 6f72 5b27 6174 6f6d 5f73 656c  factor['atom_sel
+00078200: 6563 7469 6f6e 275d 203d 2061 746f 6d53  ection'] = atomS
+00078210: 656c 6563 7469 6f6e 0a20 2020 2020 2020  election.       
+00078220: 2020 2020 2072 6574 7572 6e20 5f66 6163       return _fac
+00078230: 746f 720a 0a20 2020 2020 2020 2069 6620  tor..        if 
+00078240: 6174 6f6d 5365 6c65 6374 696f 6e20 6973  atomSelection is
+00078250: 204e 6f6e 6520 6f72 206c 656e 2861 746f   None or len(ato
+00078260: 6d53 656c 6563 7469 6f6e 2920 3d3d 2030  mSelection) == 0
+00078270: 3a0a 2020 2020 2020 2020 2020 2020 5f66  :.            _f
+00078280: 6163 746f 725b 2761 746f 6d5f 7365 6c65  actor['atom_sele
+00078290: 6374 696f 6e27 5d20 3d20 5b5d 0a0a 2020  ction'] = []..  
+000782a0: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
+000782b0: 7461 6e63 6528 6174 6f6d 5365 6c65 6374  tance(atomSelect
+000782c0: 696f 6e5b 305d 2c20 7374 7229 2061 6e64  ion[0], str) and
+000782d0: 2061 746f 6d53 656c 6563 7469 6f6e 5b30   atomSelection[0
+000782e0: 5d20 3d3d 2027 2a27 3a0a 2020 2020 2020  ] == '*':.      
+000782f0: 2020 2020 2020 7265 7475 726e 205f 6661        return _fa
+00078300: 6374 6f72 0a0a 2020 2020 2020 2020 5f61  ctor..        _a
+00078310: 746f 6d53 656c 6563 7469 6f6e 203d 205b  tomSelection = [
+00078320: 5d0a 2020 2020 2020 2020 666f 7220 5f61  ].        for _a
+00078330: 746f 6d20 696e 205f 6661 6374 6f72 5b27  tom in _factor['
+00078340: 6174 6f6d 5f73 656c 6563 7469 6f6e 275d  atom_selection']
+00078350: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00078360: 2069 7369 6e73 7461 6e63 6528 5f61 746f   isinstance(_ato
+00078370: 6d2c 2073 7472 2920 616e 6420 5f61 746f  m, str) and _ato
+00078380: 6d20 3d3d 2027 2a27 3a0a 2020 2020 2020  m == '*':.      
+00078390: 2020 2020 2020 2020 2020 5f66 6163 746f            _facto
+000783a0: 725b 2761 746f 6d5f 7365 6c65 6374 696f  r['atom_selectio
+000783b0: 6e27 5d20 3d20 6174 6f6d 5365 6c65 6374  n'] = atomSelect
+000783c0: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
+000783d0: 2020 2020 7265 7475 726e 205f 6661 6374      return _fact
+000783e0: 6f72 0a20 2020 2020 2020 2020 2020 2069  or.            i
+000783f0: 6620 5f61 746f 6d20 696e 2061 746f 6d53  f _atom in atomS
+00078400: 656c 6563 7469 6f6e 3a0a 2020 2020 2020  election:.      
+00078410: 2020 2020 2020 2020 2020 5f61 746f 6d53            _atomS
+00078420: 656c 6563 7469 6f6e 2e61 7070 656e 6428  election.append(
+00078430: 5f61 746f 6d29 0a20 2020 2020 2020 2020  _atom).         
+00078440: 2020 2065 6c69 6620 2768 7964 726f 6765     elif 'hydroge
+00078450: 6e5f 6e6f 745f 696e 7374 616e 7469 6174  n_not_instantiat
+00078460: 6564 2720 696e 205f 6174 6f6d 2061 6e64  ed' in _atom and
+00078470: 205f 6174 6f6d 5b27 6879 6472 6f67 656e   _atom['hydrogen
+00078480: 5f6e 6f74 5f69 6e73 7461 6e74 6961 7465  _not_instantiate
+00078490: 6427 5d3a 0a20 2020 2020 2020 2020 2020  d']:.           
+000784a0: 2020 2020 2063 6861 696e 5f69 6420 3d20       chain_id = 
+000784b0: 5f61 746f 6d5b 2763 6861 696e 5f69 6427  _atom['chain_id'
+000784c0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+000784d0: 2020 7365 715f 6964 203d 205f 6174 6f6d    seq_id = _atom
+000784e0: 5b27 7365 715f 6964 275d 0a20 2020 2020  ['seq_id'].     
+000784f0: 2020 2020 2020 2020 2020 2069 6620 616e             if an
+00078500: 7928 5f61 746f 6d32 2066 6f72 205f 6174  y(_atom2 for _at
+00078510: 6f6d 3220 696e 2061 746f 6d53 656c 6563  om2 in atomSelec
+00078520: 7469 6f6e 2069 6620 5f61 746f 6d32 5b27  tion if _atom2['
+00078530: 6368 6169 6e5f 6964 275d 203d 3d20 6368  chain_id'] == ch
+00078540: 6169 6e5f 6964 2061 6e64 205f 6174 6f6d  ain_id and _atom
+00078550: 325b 2773 6571 5f69 6427 5d20 3d3d 2073  2['seq_id'] == s
+00078560: 6571 5f69 6429 3a0a 2020 2020 2020 2020  eq_id):.        
+00078570: 2020 2020 2020 2020 2020 2020 5f61 746f              _ato
+00078580: 6d53 656c 6563 7469 6f6e 2e61 7070 656e  mSelection.appen
+00078590: 6428 5f61 746f 6d29 0a0a 2020 2020 2020  d(_atom)..      
+000785a0: 2020 5f66 6163 746f 725b 2761 746f 6d5f    _factor['atom_
+000785b0: 7365 6c65 6374 696f 6e27 5d20 3d20 5f61  selection'] = _a
+000785c0: 746f 6d53 656c 6563 7469 6f6e 0a0a 2020  tomSelection..  
+000785d0: 2020 2020 2020 7265 7475 726e 205f 6661        return _fa
+000785e0: 6374 6f72 0a0a 2020 2020 6465 6620 5f5f  ctor..    def __
+000785f0: 696e 7465 7273 6563 7469 6f6e 4174 6f6d  intersectionAtom
+00078600: 5f73 656c 6563 7469 6f6e 7328 7365 6c66  _selections(self
+00078610: 2c20 5f73 656c 6563 7469 6f6e 312c 205f  , _selection1, _
+00078620: 7365 6c65 6374 696f 6e32 293a 2020 2320  selection2):  # 
+00078630: 7079 6c69 6e74 3a20 6469 7361 626c 653d  pylint: disable=
+00078640: 6e6f 2d73 656c 662d 7573 650a 2020 2020  no-self-use.    
+00078650: 2020 2020 6966 205f 7365 6c65 6374 696f      if _selectio
+00078660: 6e31 2069 7320 4e6f 6e65 206f 7220 6c65  n1 is None or le
+00078670: 6e28 5f73 656c 6563 7469 6f6e 3129 203d  n(_selection1) =
+00078680: 3d20 3020 6f72 205f 7365 6c65 6374 696f  = 0 or _selectio
+00078690: 6e32 2069 7320 4e6f 6e65 206f 7220 6c65  n2 is None or le
+000786a0: 6e28 5f73 656c 6563 7469 6f6e 3229 203d  n(_selection2) =
+000786b0: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
+000786c0: 2072 6574 7572 6e20 5b5d 0a0a 2020 2020   return []..    
+000786d0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+000786e0: 6528 5f73 656c 6563 7469 6f6e 325b 305d  e(_selection2[0]
+000786f0: 2c20 7374 7229 2061 6e64 205f 7365 6c65  , str) and _sele
+00078700: 6374 696f 6e32 5b30 5d20 3d3d 2027 2a27  ction2[0] == '*'
+00078710: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00078720: 7475 726e 205f 7365 6c65 6374 696f 6e31  turn _selection1
+00078730: 0a0a 2020 2020 2020 2020 6861 7341 7574  ..        hasAut
+00078740: 6853 6571 4964 3120 3d20 616e 7928 5f61  hSeqId1 = any(_a
+00078750: 746f 6d20 666f 7220 5f61 746f 6d20 696e  tom for _atom in
+00078760: 205f 7365 6c65 6374 696f 6e31 2069 6620   _selection1 if 
+00078770: 2761 7574 685f 6174 6f6d 5f69 6427 2069  'auth_atom_id' i
+00078780: 6e20 5f61 746f 6d29 0a20 2020 2020 2020  n _atom).       
+00078790: 2068 6173 4175 7468 5365 7149 6432 203d   hasAuthSeqId2 =
+000787a0: 2061 6e79 285f 6174 6f6d 2066 6f72 205f   any(_atom for _
+000787b0: 6174 6f6d 2069 6e20 5f73 656c 6563 7469  atom in _selecti
+000787c0: 6f6e 3220 6966 2027 6175 7468 5f61 746f  on2 if 'auth_ato
+000787d0: 6d5f 6964 2720 696e 205f 6174 6f6d 290a  m_id' in _atom).
+000787e0: 0a20 2020 2020 2020 205f 6174 6f6d 5365  .        _atomSe
+000787f0: 6c65 6374 696f 6e20 3d20 5b5d 0a0a 2020  lection = []..  
+00078800: 2020 2020 2020 6966 206e 6f74 2068 6173        if not has
+00078810: 4175 7468 5365 7149 6431 2061 6e64 206e  AuthSeqId1 and n
+00078820: 6f74 2068 6173 4175 7468 5365 7149 6432  ot hasAuthSeqId2
+00078830: 3a0a 2020 2020 2020 2020 2020 2020 666f  :.            fo
+00078840: 7220 5f61 746f 6d20 696e 205f 7365 6c65  r _atom in _sele
+00078850: 6374 696f 6e31 3a0a 2020 2020 2020 2020  ction1:.        
+00078860: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00078870: 7461 6e63 6528 5f61 746f 6d2c 2073 7472  tance(_atom, str
+00078880: 2920 616e 6420 5f61 746f 6d20 3d3d 2027  ) and _atom == '
+00078890: 2a27 3a0a 2020 2020 2020 2020 2020 2020  *':.            
+000788a0: 2020 2020 2020 2020 7265 7475 726e 205f          return _
+000788b0: 7365 6c65 6374 696f 6e32 0a20 2020 2020  selection2.     
+000788c0: 2020 2020 2020 2020 2020 2069 6620 5f61             if _a
+000788d0: 746f 6d20 696e 205f 7365 6c65 6374 696f  tom in _selectio
+000788e0: 6e32 3a0a 2020 2020 2020 2020 2020 2020  n2:.            
+000788f0: 2020 2020 2020 2020 5f61 746f 6d53 656c          _atomSel
+00078900: 6563 7469 6f6e 2e61 7070 656e 6428 5f61  ection.append(_a
+00078910: 746f 6d29 0a20 2020 2020 2020 2020 2020  tom).           
+00078920: 2020 2020 2065 6c69 6620 2768 7964 726f       elif 'hydro
+00078930: 6765 6e5f 6e6f 745f 696e 7374 616e 7469  gen_not_instanti
+00078940: 6174 6564 2720 696e 205f 6174 6f6d 2061  ated' in _atom a
+00078950: 6e64 205f 6174 6f6d 5b27 6879 6472 6f67  nd _atom['hydrog
+00078960: 656e 5f6e 6f74 5f69 6e73 7461 6e74 6961  en_not_instantia
+00078970: 7465 6427 5d3a 0a20 2020 2020 2020 2020  ted']:.         
+00078980: 2020 2020 2020 2020 2020 2063 6861 696e             chain
+00078990: 5f69 6420 3d20 5f61 746f 6d5b 2763 6861  _id = _atom['cha
+000789a0: 696e 5f69 6427 5d0a 2020 2020 2020 2020  in_id'].        
+000789b0: 2020 2020 2020 2020 2020 2020 7365 715f              seq_
+000789c0: 6964 203d 205f 6174 6f6d 5b27 7365 715f  id = _atom['seq_
+000789d0: 6964 275d 0a20 2020 2020 2020 2020 2020  id'].           
+000789e0: 2020 2020 2020 2020 2069 6620 616e 7928           if any(
+000789f0: 5f61 746f 6d32 2066 6f72 205f 6174 6f6d  _atom2 for _atom
+00078a00: 3220 696e 205f 7365 6c65 6374 696f 6e32  2 in _selection2
+00078a10: 2069 6620 5f61 746f 6d32 5b27 6368 6169   if _atom2['chai
+00078a20: 6e5f 6964 275d 203d 3d20 6368 6169 6e5f  n_id'] == chain_
+00078a30: 6964 2061 6e64 205f 6174 6f6d 325b 2773  id and _atom2['s
+00078a40: 6571 5f69 6427 5d20 3d3d 2073 6571 5f69  eq_id'] == seq_i
+00078a50: 6429 3a0a 2020 2020 2020 2020 2020 2020  d):.            
+00078a60: 2020 2020 2020 2020 2020 2020 5f61 746f              _ato
+00078a70: 6d53 656c 6563 7469 6f6e 2e61 7070 656e  mSelection.appen
+00078a80: 6428 5f61 746f 6d29 0a0a 2020 2020 2020  d(_atom)..      
+00078a90: 2020 656c 6966 2068 6173 4175 7468 5365    elif hasAuthSe
+00078aa0: 7149 6431 2061 6e64 206e 6f74 2068 6173  qId1 and not has
+00078ab0: 4175 7468 5365 7149 6432 3a0a 2020 2020  AuthSeqId2:.    
+00078ac0: 2020 2020 2020 2020 5f5f 7365 6c65 6374          __select
+00078ad0: 696f 6e31 203d 2063 6f70 792e 6465 6570  ion1 = copy.deep
+00078ae0: 636f 7079 285f 7365 6c65 6374 696f 6e31  copy(_selection1
+00078af0: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
+00078b00: 7220 5f61 746f 6d20 696e 205f 5f73 656c  r _atom in __sel
+00078b10: 6563 7469 6f6e 313a 0a20 2020 2020 2020  ection1:.       
+00078b20: 2020 2020 2020 2020 2069 6620 2761 7574           if 'aut
+00078b30: 685f 6174 6f6d 5f69 6427 2069 6e20 5f61  h_atom_id' in _a
+00078b40: 746f 6d3a 0a20 2020 2020 2020 2020 2020  tom:.           
+00078b50: 2020 2020 2020 2020 205f 6174 6f6d 2e70           _atom.p
+00078b60: 6f70 2827 6175 7468 5f61 746f 6d5f 6964  op('auth_atom_id
+00078b70: 2729 0a20 2020 2020 2020 2020 2020 2066  ').            f
+00078b80: 6f72 2069 6478 2c20 5f61 746f 6d20 696e  or idx, _atom in
+00078b90: 2065 6e75 6d65 7261 7465 285f 5f73 656c   enumerate(__sel
+00078ba0: 6563 7469 6f6e 3129 3a0a 2020 2020 2020  ection1):.      
+00078bb0: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
+00078bc0: 6e73 7461 6e63 6528 5f61 746f 6d2c 2073  nstance(_atom, s
+00078bd0: 7472 2920 616e 6420 5f61 746f 6d20 3d3d  tr) and _atom ==
+00078be0: 2027 2a27 3a0a 2020 2020 2020 2020 2020   '*':.          
+00078bf0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00078c00: 205f 7365 6c65 6374 696f 6e32 0a20 2020   _selection2.   
+00078c10: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00078c20: 5f61 746f 6d20 696e 205f 7365 6c65 6374  _atom in _select
+00078c30: 696f 6e32 3a0a 2020 2020 2020 2020 2020  ion2:.          
+00078c40: 2020 2020 2020 2020 2020 5f61 746f 6d53            _atomS
+00078c50: 656c 6563 7469 6f6e 2e61 7070 656e 6428  election.append(
+00078c60: 5f73 656c 6563 7469 6f6e 315b 6964 785d  _selection1[idx]
+00078c70: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00078c80: 2020 656c 6966 2027 6879 6472 6f67 656e    elif 'hydrogen
+00078c90: 5f6e 6f74 5f69 6e73 7461 6e74 6961 7465  _not_instantiate
+00078ca0: 6427 2069 6e20 5f61 746f 6d20 616e 6420  d' in _atom and 
+00078cb0: 5f61 746f 6d5b 2768 7964 726f 6765 6e5f  _atom['hydrogen_
+00078cc0: 6e6f 745f 696e 7374 616e 7469 6174 6564  not_instantiated
+00078cd0: 275d 3a0a 2020 2020 2020 2020 2020 2020  ']:.            
+00078ce0: 2020 2020 2020 2020 6368 6169 6e5f 6964          chain_id
+00078cf0: 203d 205f 6174 6f6d 5b27 6368 6169 6e5f   = _atom['chain_
+00078d00: 6964 275d 0a20 2020 2020 2020 2020 2020  id'].           
+00078d10: 2020 2020 2020 2020 2073 6571 5f69 6420           seq_id 
+00078d20: 3d20 5f61 746f 6d5b 2773 6571 5f69 6427  = _atom['seq_id'
+00078d30: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00078d40: 2020 2020 2020 6966 2061 6e79 285f 6174        if any(_at
+00078d50: 6f6d 3220 666f 7220 5f61 746f 6d32 2069  om2 for _atom2 i
+00078d60: 6e20 5f73 656c 6563 7469 6f6e 3220 6966  n _selection2 if
+00078d70: 205f 6174 6f6d 325b 2763 6861 696e 5f69   _atom2['chain_i
+00078d80: 6427 5d20 3d3d 2063 6861 696e 5f69 6420  d'] == chain_id 
+00078d90: 616e 6420 5f61 746f 6d32 5b27 7365 715f  and _atom2['seq_
+00078da0: 6964 275d 203d 3d20 7365 715f 6964 293a  id'] == seq_id):
+00078db0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00078dc0: 2020 2020 2020 2020 205f 6174 6f6d 5365           _atomSe
+00078dd0: 6c65 6374 696f 6e2e 6170 7065 6e64 285f  lection.append(_
+00078de0: 7365 6c65 6374 696f 6e31 5b69 6478 5d29  selection1[idx])
+00078df0: 0a0a 2020 2020 2020 2020 656c 6966 206e  ..        elif n
+00078e00: 6f74 2068 6173 4175 7468 5365 7149 6431  ot hasAuthSeqId1
+00078e10: 2061 6e64 2068 6173 4175 7468 5365 7149   and hasAuthSeqI
+00078e20: 6432 3a0a 2020 2020 2020 2020 2020 2020  d2:.            
+00078e30: 5f5f 7365 6c65 6374 696f 6e32 203d 2063  __selection2 = c
+00078e40: 6f70 792e 6465 6570 636f 7079 285f 7365  opy.deepcopy(_se
+00078e50: 6c65 6374 696f 6e32 290a 2020 2020 2020  lection2).      
+00078e60: 2020 2020 2020 666f 7220 6964 782c 205f        for idx, _
+00078e70: 6174 6f6d 2069 6e20 656e 756d 6572 6174  atom in enumerat
+00078e80: 6528 5f5f 7365 6c65 6374 696f 6e32 293a  e(__selection2):
+00078e90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00078ea0: 2069 6620 2761 7574 685f 6174 6f6d 5f69   if 'auth_atom_i
+00078eb0: 6427 2069 6e20 5f61 746f 6d3a 0a20 2020  d' in _atom:.   
 00078ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00078ed0: 205f 6174 6f6d 5365 6c65 6374 696f 6e2e   _atomSelection.
-00078ee0: 6170 7065 6e64 285f 7365 6c65 6374 696f  append(_selectio
-00078ef0: 6e32 5b69 6478 5d29 0a0a 2020 2020 2020  n2[idx])..      
-00078f00: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00078f10: 2020 2020 5f5f 7365 6c65 6374 696f 6e31      __selection1
-00078f20: 203d 2063 6f70 792e 6465 6570 636f 7079   = copy.deepcopy
-00078f30: 285f 7365 6c65 6374 696f 6e31 290a 2020  (_selection1).  
-00078f40: 2020 2020 2020 2020 2020 666f 7220 5f61            for _a
-00078f50: 746f 6d20 696e 205f 5f73 656c 6563 7469  tom in __selecti
-00078f60: 6f6e 313a 0a20 2020 2020 2020 2020 2020  on1:.           
-00078f70: 2020 2020 2069 6620 2761 7574 685f 6174       if 'auth_at
-00078f80: 6f6d 5f69 6427 2069 6e20 5f61 746f 6d3a  om_id' in _atom:
-00078f90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00078fa0: 2020 2020 205f 6174 6f6d 2e70 6f70 2827       _atom.pop('
-00078fb0: 6175 7468 5f61 746f 6d5f 6964 2729 0a20  auth_atom_id'). 
-00078fc0: 2020 2020 2020 2020 2020 205f 5f73 656c             __sel
-00078fd0: 6563 7469 6f6e 3220 3d20 636f 7079 2e64  ection2 = copy.d
-00078fe0: 6565 7063 6f70 7928 5f73 656c 6563 7469  eepcopy(_selecti
-00078ff0: 6f6e 3229 0a20 2020 2020 2020 2020 2020  on2).           
-00079000: 2066 6f72 205f 6174 6f6d 2069 6e20 5f5f   for _atom in __
-00079010: 7365 6c65 6374 696f 6e32 3a0a 2020 2020  selection2:.    
-00079020: 2020 2020 2020 2020 2020 2020 6966 2027              if '
-00079030: 6175 7468 5f61 746f 6d5f 6964 2720 696e  auth_atom_id' in
-00079040: 205f 6174 6f6d 3a0a 2020 2020 2020 2020   _atom:.        
-00079050: 2020 2020 2020 2020 2020 2020 5f61 746f              _ato
-00079060: 6d2e 706f 7028 2761 7574 685f 6174 6f6d  m.pop('auth_atom
-00079070: 5f69 6427 290a 2020 2020 2020 2020 2020  _id').          
-00079080: 2020 666f 7220 6964 782c 205f 6174 6f6d    for idx, _atom
-00079090: 2069 6e20 656e 756d 6572 6174 6528 5f5f   in enumerate(__
-000790a0: 7365 6c65 6374 696f 6e31 293a 0a20 2020  selection1):.   
-000790b0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000790c0: 6973 696e 7374 616e 6365 285f 6174 6f6d  isinstance(_atom
-000790d0: 2c20 7374 7229 2061 6e64 205f 6174 6f6d  , str) and _atom
-000790e0: 203d 3d20 272a 273a 0a20 2020 2020 2020   == '*':.       
-000790f0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-00079100: 7572 6e20 5f73 656c 6563 7469 6f6e 320a  urn _selection2.
-00079110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079120: 6966 205f 6174 6f6d 2069 6e20 5f5f 7365  if _atom in __se
-00079130: 6c65 6374 696f 6e32 3a0a 2020 2020 2020  lection2:.      
-00079140: 2020 2020 2020 2020 2020 2020 2020 5f61                _a
-00079150: 746f 6d53 656c 6563 7469 6f6e 2e61 7070  tomSelection.app
-00079160: 656e 6428 5f73 656c 6563 7469 6f6e 315b  end(_selection1[
-00079170: 6964 785d 290a 2020 2020 2020 2020 2020  idx]).          
-00079180: 2020 2020 2020 656c 6966 2027 6879 6472        elif 'hydr
-00079190: 6f67 656e 5f6e 6f74 5f69 6e73 7461 6e74  ogen_not_instant
-000791a0: 6961 7465 6427 2069 6e20 5f61 746f 6d20  iated' in _atom 
-000791b0: 616e 6420 5f61 746f 6d5b 2768 7964 726f  and _atom['hydro
-000791c0: 6765 6e5f 6e6f 745f 696e 7374 616e 7469  gen_not_instanti
-000791d0: 6174 6564 275d 3a0a 2020 2020 2020 2020  ated']:.        
-000791e0: 2020 2020 2020 2020 2020 2020 6368 6169              chai
-000791f0: 6e5f 6964 203d 205f 6174 6f6d 5b27 6368  n_id = _atom['ch
-00079200: 6169 6e5f 6964 275d 0a20 2020 2020 2020  ain_id'].       
-00079210: 2020 2020 2020 2020 2020 2020 2073 6571               seq
-00079220: 5f69 6420 3d20 5f61 746f 6d5b 2773 6571  _id = _atom['seq
-00079230: 5f69 6427 5d0a 2020 2020 2020 2020 2020  _id'].          
-00079240: 2020 2020 2020 2020 2020 6966 2061 6e79            if any
-00079250: 285f 6174 6f6d 3220 666f 7220 5f61 746f  (_atom2 for _ato
-00079260: 6d32 2069 6e20 5f5f 7365 6c65 6374 696f  m2 in __selectio
-00079270: 6e32 2069 6620 5f61 746f 6d32 5b27 6368  n2 if _atom2['ch
-00079280: 6169 6e5f 6964 275d 203d 3d20 6368 6169  ain_id'] == chai
-00079290: 6e5f 6964 2061 6e64 205f 6174 6f6d 325b  n_id and _atom2[
-000792a0: 2773 6571 5f69 6427 5d20 3d3d 2073 6571  'seq_id'] == seq
-000792b0: 5f69 6429 3a0a 2020 2020 2020 2020 2020  _id):.          
-000792c0: 2020 2020 2020 2020 2020 2020 2020 5f61                _a
-000792d0: 746f 6d53 656c 6563 7469 6f6e 2e61 7070  tomSelection.app
-000792e0: 656e 6428 5f73 656c 6563 7469 6f6e 315b  end(_selection1[
-000792f0: 6964 785d 290a 0a20 2020 2020 2020 2072  idx])..        r
-00079300: 6574 7572 6e20 5f61 746f 6d53 656c 6563  eturn _atomSelec
-00079310: 7469 6f6e 0a0a 2020 2020 2320 456e 7465  tion..    # Ente
-00079320: 7220 6120 7061 7273 6520 7472 6565 2070  r a parse tree p
-00079330: 726f 6475 6365 6420 6279 2058 706c 6f72  roduced by Xplor
-00079340: 4d52 5061 7273 6572 2366 6163 746f 722e  MRParser#factor.
-00079350: 0a20 2020 2064 6566 2065 6e74 6572 4661  .    def enterFa
-00079360: 6374 6f72 2873 656c 662c 2063 7478 3a20  ctor(self, ctx: 
-00079370: 5870 6c6f 724d 5250 6172 7365 722e 4661  XplorMRParser.Fa
-00079380: 6374 6f72 436f 6e74 6578 7429 3a0a 2020  ctorContext):.  
-00079390: 2020 2020 2020 6966 2073 656c 662e 5f5f        if self.__
-000793a0: 7365 6c5f 6578 7072 5f64 6562 7567 3a0a  sel_expr_debug:.
-000793b0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-000793c0: 7428 2220 2022 202a 2073 656c 662e 6465  t("  " * self.de
-000793d0: 7074 6820 2b20 6622 656e 7465 725f 6661  pth + f"enter_fa
-000793e0: 6374 6f72 2c20 636f 6e63 6174 656e 6174  ctor, concatenat
-000793f0: 696f 6e3a 207b 626f 6f6c 2863 7478 2e66  ion: {bool(ctx.f
-00079400: 6163 746f 7228 2929 7d22 290a 0a20 2020  actor())}")..   
-00079410: 2020 2020 2069 6620 6374 782e 506f 696e       if ctx.Poin
-00079420: 7428 293a 0a20 2020 2020 2020 2020 2020  t():.           
-00079430: 2073 656c 662e 696e 5665 6374 6f72 3344   self.inVector3D
-00079440: 203d 2054 7275 650a 2020 2020 2020 2020   = True.        
-00079450: 2020 2020 7365 6c66 2e69 6e56 6563 746f      self.inVecto
-00079460: 7233 445f 636f 6c75 6d6e 5365 6c20 3d20  r3D_columnSel = 
-00079470: 2d31 0a20 2020 2020 2020 2020 2020 2073  -1.            s
-00079480: 656c 662e 696e 5665 6374 6f72 3344 5f74  elf.inVector3D_t
-00079490: 6169 6c20 3d20 4e6f 6e65 0a20 2020 2020  ail = None.     
-000794a0: 2020 2020 2020 2073 656c 662e 696e 5665         self.inVe
-000794b0: 6374 6f72 3344 5f68 6561 6420 3d20 4e6f  ctor3D_head = No
-000794c0: 6e65 0a20 2020 2020 2020 2020 2020 2073  ne.            s
-000794d0: 656c 662e 7665 6374 6f72 3344 203d 204e  elf.vector3D = N
-000794e0: 6f6e 650a 0a20 2020 2020 2020 2073 656c  one..        sel
-000794f0: 662e 6465 7074 6820 2b3d 2031 0a0a 2020  f.depth += 1..  
-00079500: 2020 2320 4578 6974 2061 2070 6172 7365    # Exit a parse
-00079510: 2074 7265 6520 7072 6f64 7563 6564 2062   tree produced b
-00079520: 7920 5870 6c6f 724d 5250 6172 7365 7223  y XplorMRParser#
-00079530: 6661 6374 6f72 2e0a 2020 2020 6465 6620  factor..    def 
-00079540: 6578 6974 4661 6374 6f72 2873 656c 662c  exitFactor(self,
-00079550: 2063 7478 3a20 5870 6c6f 724d 5250 6172   ctx: XplorMRPar
-00079560: 7365 722e 4661 6374 6f72 436f 6e74 6578  ser.FactorContex
-00079570: 7429 3a0a 2020 2020 2020 2020 7365 6c66  t):.        self
-00079580: 2e64 6570 7468 202d 3d20 310a 2020 2020  .depth -= 1.    
-00079590: 2020 2020 6966 2073 656c 662e 5f5f 7365      if self.__se
-000795a0: 6c5f 6578 7072 5f64 6562 7567 3a0a 2020  l_expr_debug:.  
-000795b0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-000795c0: 2220 2022 202a 2073 656c 662e 6465 7074  "  " * self.dept
-000795d0: 6820 2b20 2265 7869 745f 6661 6374 6f72  h + "exit_factor
-000795e0: 2229 0a0a 2020 2020 2020 2020 6465 6620  ")..        def 
-000795f0: 7365 745f 7374 6f72 6528 6e75 6d29 3a0a  set_store(num):.
-00079600: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00079610: 656c 662e 5f5f 7365 6c5f 6578 7072 5f64  elf.__sel_expr_d
-00079620: 6562 7567 3a0a 2020 2020 2020 2020 2020  ebug:.          
-00079630: 2020 2020 2020 7072 696e 7428 2220 2022        print("  "
-00079640: 202a 2073 656c 662e 6465 7074 6820 2b20   * self.depth + 
-00079650: 6622 2d2d 3e20 7374 6f72 657b 6e75 6d7d  f"--> store{num}
-00079660: 2229 0a20 2020 2020 2020 2020 2020 2069  ").            i
-00079670: 6620 6c65 6e28 7365 6c66 2e73 746f 7265  f len(self.store
-00079680: 5365 745b 6e75 6d5d 2920 3d3d 2030 3a0a  Set[num]) == 0:.
-00079690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000796a0: 7365 6c66 2e66 6163 746f 725b 2761 746f  self.factor['ato
-000796b0: 6d5f 6964 275d 203d 205b 4e6f 6e65 5d0a  m_id'] = [None].
-000796c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000796d0: 7365 6c66 2e5f 5f66 2e61 7070 656e 6428  self.__f.append(
-000796e0: 6622 5b55 6e73 7570 706f 7274 6564 2064  f"[Unsupported d
-000796f0: 6174 615d 207b 7365 6c66 2e5f 5f67 6574  ata] {self.__get
-00079700: 4375 7272 656e 7452 6573 7472 6169 6e74  CurrentRestraint
-00079710: 2829 7d22 0a20 2020 2020 2020 2020 2020  ()}".           
-00079720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079730: 2020 2020 2066 2254 6865 2027 7374 6f72       f"The 'stor
-00079740: 657b 6e75 6d7d 2720 636c 6175 7365 2068  e{num}' clause h
-00079750: 6173 206e 6f20 6566 6665 6374 2022 0a20  as no effect ". 
-00079760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079770: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00079780: 6265 6361 7573 6520 7468 6520 696e 7465  because the inte
-00079790: 726e 616c 2076 6563 746f 7220 7374 6174  rnal vector stat
-000797a0: 656d 656e 7420 6973 206e 6f74 2073 6574  ement is not set
-000797b0: 2e22 290a 2020 2020 2020 2020 2020 2020  .").            
-000797c0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000797d0: 2020 2020 2020 7365 6c66 2e66 6163 746f        self.facto
-000797e0: 7220 3d20 636f 7079 2e63 6f70 7928 7365  r = copy.copy(se
-000797f0: 6c66 2e73 746f 7265 5365 745b 6e75 6d5d  lf.storeSet[num]
-00079800: 290a 0a20 2020 2020 2020 2074 7279 3a0a  )..        try:.
-00079810: 0a20 2020 2020 2020 2020 2020 2023 2063  .            # c
-00079820: 6f6e 6361 7465 6e61 7469 6f6e 0a20 2020  oncatenation.   
-00079830: 2020 2020 2020 2020 2069 6620 6374 782e           if ctx.
-00079840: 6661 6374 6f72 2829 2061 6e64 2073 656c  factor() and sel
-00079850: 662e 7374 6163 6b53 656c 6563 7469 6f6e  f.stackSelection
-00079860: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-00079870: 2020 2069 6620 7365 6c66 2e5f 5f63 6f6e     if self.__con
-00079880: 5f75 6e69 6f6e 5f65 7870 7220 616e 6420  _union_expr and 
-00079890: 6e6f 7420 7365 6c66 2e5f 5f63 7572 5f75  not self.__cur_u
-000798a0: 6e69 6f6e 5f65 7870 7220 616e 6420 6374  nion_expr and ct
-000798b0: 782e 4e6f 745f 6f70 2829 3a0a 2020 2020  x.Not_op():.    
-000798c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000798d0: 6966 206c 656e 2873 656c 662e 7374 6163  if len(self.stac
-000798e0: 6b46 6163 746f 7273 2920 3e20 303a 0a20  kFactors) > 0:. 
-000798f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079900: 2020 2020 2020 2073 656c 662e 7374 6163         self.stac
-00079910: 6b46 6163 746f 7273 2e70 6f70 2829 0a20  kFactors.pop(). 
-00079920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079930: 2020 2020 2020 2073 656c 662e 6661 6374         self.fact
-00079940: 6f72 5b27 6174 6f6d 5f73 656c 6563 7469  or['atom_selecti
-00079950: 6f6e 275d 203d 2073 656c 662e 7374 6163  on'] = self.stac
-00079960: 6b53 656c 6563 7469 6f6e 735b 2d31 5d0a  kSelections[-1].
-00079970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079980: 2020 2020 2020 2020 7365 6c66 2e73 7461          self.sta
-00079990: 636b 5365 6c65 6374 696f 6e73 2e61 7070  ckSelections.app
-000799a0: 656e 6428 2761 6e64 2729 2020 2320 696e  end('and')  # in
-000799b0: 7465 7273 6563 7469 6f6e 0a0a 2020 2020  tersection..    
-000799c0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-000799d0: 206e 6f74 2073 656c 662e 5f5f 746f 705f   not self.__top_
-000799e0: 756e 696f 6e5f 6578 7072 3a0a 2020 2020  union_expr:.    
-000799f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079a00: 6966 206c 656e 2873 656c 662e 7374 6163  if len(self.stac
-00079a10: 6b46 6163 746f 7273 2920 3e20 303a 0a20  kFactors) > 0:. 
-00079a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079a30: 2020 2020 2020 2073 656c 662e 7374 6163         self.stac
-00079a40: 6b46 6163 746f 7273 2e70 6f70 2829 0a20  kFactors.pop(). 
-00079a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079a60: 2020 2020 2020 2073 656c 662e 6661 6374         self.fact
-00079a70: 6f72 203d 207b 2761 746f 6d5f 7365 6c65  or = {'atom_sele
-00079a80: 6374 696f 6e27 3a20 7365 6c66 2e73 7461  ction': self.sta
-00079a90: 636b 5365 6c65 6374 696f 6e73 2e70 6f70  ckSelections.pop
-00079aa0: 2829 7d0a 0a20 2020 2020 2020 2020 2020  ()}..           
-00079ab0: 2069 6620 6374 782e 416c 6c28 2920 6f72   if ctx.All() or
-00079ac0: 2063 7478 2e4b 6e6f 776e 2829 3a0a 2020   ctx.Known():.  
-00079ad0: 2020 2020 2020 2020 2020 2020 2020 636c                cl
-00079ae0: 6175 7365 4e61 6d65 203d 2027 616c 6c27  auseName = 'all'
-00079af0: 2069 6620 6374 782e 416c 6c28 2920 656c   if ctx.All() el
-00079b00: 7365 2027 6b6e 6f77 6e27 0a20 2020 2020  se 'known'.     
-00079b10: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00079b20: 6c66 2e5f 5f73 656c 5f65 7870 725f 6465  lf.__sel_expr_de
-00079b30: 6275 673a 0a20 2020 2020 2020 2020 2020  bug:.           
-00079b40: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
-00079b50: 2020 2220 2a20 7365 6c66 2e64 6570 7468    " * self.depth
-00079b60: 202b 2066 222d 2d3e 207b 636c 6175 7365   + f"--> {clause
-00079b70: 4e61 6d65 7d22 290a 2020 2020 2020 2020  Name}").        
-00079b80: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
-00079b90: 656c 662e 5f5f 6861 7343 6f6f 7264 3a0a  elf.__hasCoord:.
-00079ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079bb0: 2020 2020 7265 7475 726e 0a20 2020 2020      return.     
-00079bc0: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
-00079bd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00079be0: 2020 2020 2061 746f 6d53 656c 6563 7469       atomSelecti
-00079bf0: 6f6e 203d 5c0a 2020 2020 2020 2020 2020  on =\.          
-00079c00: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00079c10: 6c66 2e5f 5f63 522e 6765 7444 6963 744c  lf.__cR.getDictL
-00079c20: 6973 7457 6974 6846 696c 7465 7228 2761  istWithFilter('a
-00079c30: 746f 6d5f 7369 7465 272c 0a20 2020 2020  tom_site',.     
-00079c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078ed0: 205f 6174 6f6d 2e70 6f70 2827 6175 7468   _atom.pop('auth
+00078ee0: 5f61 746f 6d5f 6964 2729 0a20 2020 2020  _atom_id').     
+00078ef0: 2020 2020 2020 2066 6f72 2069 6478 2c20         for idx, 
+00078f00: 5f61 746f 6d20 696e 2065 6e75 6d65 7261  _atom in enumera
+00078f10: 7465 285f 5f73 656c 6563 7469 6f6e 3229  te(__selection2)
+00078f20: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00078f30: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00078f40: 5f61 746f 6d2c 2073 7472 2920 616e 6420  _atom, str) and 
+00078f50: 5f61 746f 6d20 3d3d 2027 2a27 3a0a 2020  _atom == '*':.  
+00078f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078f70: 2020 7265 7475 726e 205f 7365 6c65 6374    return _select
+00078f80: 696f 6e31 0a20 2020 2020 2020 2020 2020  ion1.           
+00078f90: 2020 2020 2069 6620 5f61 746f 6d20 696e       if _atom in
+00078fa0: 205f 7365 6c65 6374 696f 6e31 3a0a 2020   _selection1:.  
+00078fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00078fc0: 2020 5f61 746f 6d53 656c 6563 7469 6f6e    _atomSelection
+00078fd0: 2e61 7070 656e 6428 5f73 656c 6563 7469  .append(_selecti
+00078fe0: 6f6e 325b 6964 785d 290a 2020 2020 2020  on2[idx]).      
+00078ff0: 2020 2020 2020 2020 2020 656c 6966 2027            elif '
+00079000: 6879 6472 6f67 656e 5f6e 6f74 5f69 6e73  hydrogen_not_ins
+00079010: 7461 6e74 6961 7465 6427 2069 6e20 5f61  tantiated' in _a
+00079020: 746f 6d20 616e 6420 5f61 746f 6d5b 2768  tom and _atom['h
+00079030: 7964 726f 6765 6e5f 6e6f 745f 696e 7374  ydrogen_not_inst
+00079040: 616e 7469 6174 6564 275d 3a0a 2020 2020  antiated']:.    
+00079050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079060: 6368 6169 6e5f 6964 203d 205f 6174 6f6d  chain_id = _atom
+00079070: 5b27 6368 6169 6e5f 6964 275d 0a20 2020  ['chain_id'].   
+00079080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079090: 2073 6571 5f69 6420 3d20 5f61 746f 6d5b   seq_id = _atom[
+000790a0: 2773 6571 5f69 6427 5d0a 2020 2020 2020  'seq_id'].      
+000790b0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000790c0: 2061 6e79 285f 6174 6f6d 3120 666f 7220   any(_atom1 for 
+000790d0: 5f61 746f 6d31 2069 6e20 5f73 656c 6563  _atom1 in _selec
+000790e0: 7469 6f6e 3120 6966 205f 6174 6f6d 315b  tion1 if _atom1[
+000790f0: 2763 6861 696e 5f69 6427 5d20 3d3d 2063  'chain_id'] == c
+00079100: 6861 696e 5f69 6420 616e 6420 5f61 746f  hain_id and _ato
+00079110: 6d31 5b27 7365 715f 6964 275d 203d 3d20  m1['seq_id'] == 
+00079120: 7365 715f 6964 293a 0a20 2020 2020 2020  seq_id):.       
+00079130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079140: 205f 6174 6f6d 5365 6c65 6374 696f 6e2e   _atomSelection.
+00079150: 6170 7065 6e64 285f 7365 6c65 6374 696f  append(_selectio
+00079160: 6e32 5b69 6478 5d29 0a0a 2020 2020 2020  n2[idx])..      
+00079170: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00079180: 2020 2020 5f5f 7365 6c65 6374 696f 6e31      __selection1
+00079190: 203d 2063 6f70 792e 6465 6570 636f 7079   = copy.deepcopy
+000791a0: 285f 7365 6c65 6374 696f 6e31 290a 2020  (_selection1).  
+000791b0: 2020 2020 2020 2020 2020 666f 7220 5f61            for _a
+000791c0: 746f 6d20 696e 205f 5f73 656c 6563 7469  tom in __selecti
+000791d0: 6f6e 313a 0a20 2020 2020 2020 2020 2020  on1:.           
+000791e0: 2020 2020 2069 6620 2761 7574 685f 6174       if 'auth_at
+000791f0: 6f6d 5f69 6427 2069 6e20 5f61 746f 6d3a  om_id' in _atom:
+00079200: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00079210: 2020 2020 205f 6174 6f6d 2e70 6f70 2827       _atom.pop('
+00079220: 6175 7468 5f61 746f 6d5f 6964 2729 0a20  auth_atom_id'). 
+00079230: 2020 2020 2020 2020 2020 205f 5f73 656c             __sel
+00079240: 6563 7469 6f6e 3220 3d20 636f 7079 2e64  ection2 = copy.d
+00079250: 6565 7063 6f70 7928 5f73 656c 6563 7469  eepcopy(_selecti
+00079260: 6f6e 3229 0a20 2020 2020 2020 2020 2020  on2).           
+00079270: 2066 6f72 205f 6174 6f6d 2069 6e20 5f5f   for _atom in __
+00079280: 7365 6c65 6374 696f 6e32 3a0a 2020 2020  selection2:.    
+00079290: 2020 2020 2020 2020 2020 2020 6966 2027              if '
+000792a0: 6175 7468 5f61 746f 6d5f 6964 2720 696e  auth_atom_id' in
+000792b0: 205f 6174 6f6d 3a0a 2020 2020 2020 2020   _atom:.        
+000792c0: 2020 2020 2020 2020 2020 2020 5f61 746f              _ato
+000792d0: 6d2e 706f 7028 2761 7574 685f 6174 6f6d  m.pop('auth_atom
+000792e0: 5f69 6427 290a 2020 2020 2020 2020 2020  _id').          
+000792f0: 2020 666f 7220 6964 782c 205f 6174 6f6d    for idx, _atom
+00079300: 2069 6e20 656e 756d 6572 6174 6528 5f5f   in enumerate(__
+00079310: 7365 6c65 6374 696f 6e31 293a 0a20 2020  selection1):.   
+00079320: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00079330: 6973 696e 7374 616e 6365 285f 6174 6f6d  isinstance(_atom
+00079340: 2c20 7374 7229 2061 6e64 205f 6174 6f6d  , str) and _atom
+00079350: 203d 3d20 272a 273a 0a20 2020 2020 2020   == '*':.       
+00079360: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00079370: 7572 6e20 5f73 656c 6563 7469 6f6e 320a  urn _selection2.
+00079380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079390: 6966 205f 6174 6f6d 2069 6e20 5f5f 7365  if _atom in __se
+000793a0: 6c65 6374 696f 6e32 3a0a 2020 2020 2020  lection2:.      
+000793b0: 2020 2020 2020 2020 2020 2020 2020 5f61                _a
+000793c0: 746f 6d53 656c 6563 7469 6f6e 2e61 7070  tomSelection.app
+000793d0: 656e 6428 5f73 656c 6563 7469 6f6e 315b  end(_selection1[
+000793e0: 6964 785d 290a 2020 2020 2020 2020 2020  idx]).          
+000793f0: 2020 2020 2020 656c 6966 2027 6879 6472        elif 'hydr
+00079400: 6f67 656e 5f6e 6f74 5f69 6e73 7461 6e74  ogen_not_instant
+00079410: 6961 7465 6427 2069 6e20 5f61 746f 6d20  iated' in _atom 
+00079420: 616e 6420 5f61 746f 6d5b 2768 7964 726f  and _atom['hydro
+00079430: 6765 6e5f 6e6f 745f 696e 7374 616e 7469  gen_not_instanti
+00079440: 6174 6564 275d 3a0a 2020 2020 2020 2020  ated']:.        
+00079450: 2020 2020 2020 2020 2020 2020 6368 6169              chai
+00079460: 6e5f 6964 203d 205f 6174 6f6d 5b27 6368  n_id = _atom['ch
+00079470: 6169 6e5f 6964 275d 0a20 2020 2020 2020  ain_id'].       
+00079480: 2020 2020 2020 2020 2020 2020 2073 6571               seq
+00079490: 5f69 6420 3d20 5f61 746f 6d5b 2773 6571  _id = _atom['seq
+000794a0: 5f69 6427 5d0a 2020 2020 2020 2020 2020  _id'].          
+000794b0: 2020 2020 2020 2020 2020 6966 2061 6e79            if any
+000794c0: 285f 6174 6f6d 3220 666f 7220 5f61 746f  (_atom2 for _ato
+000794d0: 6d32 2069 6e20 5f5f 7365 6c65 6374 696f  m2 in __selectio
+000794e0: 6e32 2069 6620 5f61 746f 6d32 5b27 6368  n2 if _atom2['ch
+000794f0: 6169 6e5f 6964 275d 203d 3d20 6368 6169  ain_id'] == chai
+00079500: 6e5f 6964 2061 6e64 205f 6174 6f6d 325b  n_id and _atom2[
+00079510: 2773 6571 5f69 6427 5d20 3d3d 2073 6571  'seq_id'] == seq
+00079520: 5f69 6429 3a0a 2020 2020 2020 2020 2020  _id):.          
+00079530: 2020 2020 2020 2020 2020 2020 2020 5f61                _a
+00079540: 746f 6d53 656c 6563 7469 6f6e 2e61 7070  tomSelection.app
+00079550: 656e 6428 5f73 656c 6563 7469 6f6e 315b  end(_selection1[
+00079560: 6964 785d 290a 0a20 2020 2020 2020 2072  idx])..        r
+00079570: 6574 7572 6e20 5f61 746f 6d53 656c 6563  eturn _atomSelec
+00079580: 7469 6f6e 0a0a 2020 2020 2320 456e 7465  tion..    # Ente
+00079590: 7220 6120 7061 7273 6520 7472 6565 2070  r a parse tree p
+000795a0: 726f 6475 6365 6420 6279 2058 706c 6f72  roduced by Xplor
+000795b0: 4d52 5061 7273 6572 2366 6163 746f 722e  MRParser#factor.
+000795c0: 0a20 2020 2064 6566 2065 6e74 6572 4661  .    def enterFa
+000795d0: 6374 6f72 2873 656c 662c 2063 7478 3a20  ctor(self, ctx: 
+000795e0: 5870 6c6f 724d 5250 6172 7365 722e 4661  XplorMRParser.Fa
+000795f0: 6374 6f72 436f 6e74 6578 7429 3a0a 2020  ctorContext):.  
+00079600: 2020 2020 2020 6966 2073 656c 662e 5f5f        if self.__
+00079610: 7365 6c5f 6578 7072 5f64 6562 7567 3a0a  sel_expr_debug:.
+00079620: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00079630: 7428 2220 2022 202a 2073 656c 662e 6465  t("  " * self.de
+00079640: 7074 6820 2b20 6622 656e 7465 725f 6661  pth + f"enter_fa
+00079650: 6374 6f72 2c20 636f 6e63 6174 656e 6174  ctor, concatenat
+00079660: 696f 6e3a 207b 626f 6f6c 2863 7478 2e66  ion: {bool(ctx.f
+00079670: 6163 746f 7228 2929 7d22 290a 0a20 2020  actor())}")..   
+00079680: 2020 2020 2069 6620 6374 782e 506f 696e       if ctx.Poin
+00079690: 7428 293a 0a20 2020 2020 2020 2020 2020  t():.           
+000796a0: 2073 656c 662e 696e 5665 6374 6f72 3344   self.inVector3D
+000796b0: 203d 2054 7275 650a 2020 2020 2020 2020   = True.        
+000796c0: 2020 2020 7365 6c66 2e69 6e56 6563 746f      self.inVecto
+000796d0: 7233 445f 636f 6c75 6d6e 5365 6c20 3d20  r3D_columnSel = 
+000796e0: 2d31 0a20 2020 2020 2020 2020 2020 2073  -1.            s
+000796f0: 656c 662e 696e 5665 6374 6f72 3344 5f74  elf.inVector3D_t
+00079700: 6169 6c20 3d20 4e6f 6e65 0a20 2020 2020  ail = None.     
+00079710: 2020 2020 2020 2073 656c 662e 696e 5665         self.inVe
+00079720: 6374 6f72 3344 5f68 6561 6420 3d20 4e6f  ctor3D_head = No
+00079730: 6e65 0a20 2020 2020 2020 2020 2020 2073  ne.            s
+00079740: 656c 662e 7665 6374 6f72 3344 203d 204e  elf.vector3D = N
+00079750: 6f6e 650a 0a20 2020 2020 2020 2073 656c  one..        sel
+00079760: 662e 6465 7074 6820 2b3d 2031 0a0a 2020  f.depth += 1..  
+00079770: 2020 2320 4578 6974 2061 2070 6172 7365    # Exit a parse
+00079780: 2074 7265 6520 7072 6f64 7563 6564 2062   tree produced b
+00079790: 7920 5870 6c6f 724d 5250 6172 7365 7223  y XplorMRParser#
+000797a0: 6661 6374 6f72 2e0a 2020 2020 6465 6620  factor..    def 
+000797b0: 6578 6974 4661 6374 6f72 2873 656c 662c  exitFactor(self,
+000797c0: 2063 7478 3a20 5870 6c6f 724d 5250 6172   ctx: XplorMRPar
+000797d0: 7365 722e 4661 6374 6f72 436f 6e74 6578  ser.FactorContex
+000797e0: 7429 3a0a 2020 2020 2020 2020 7365 6c66  t):.        self
+000797f0: 2e64 6570 7468 202d 3d20 310a 2020 2020  .depth -= 1.    
+00079800: 2020 2020 6966 2073 656c 662e 5f5f 7365      if self.__se
+00079810: 6c5f 6578 7072 5f64 6562 7567 3a0a 2020  l_expr_debug:.  
+00079820: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00079830: 2220 2022 202a 2073 656c 662e 6465 7074  "  " * self.dept
+00079840: 6820 2b20 2265 7869 745f 6661 6374 6f72  h + "exit_factor
+00079850: 2229 0a0a 2020 2020 2020 2020 6465 6620  ")..        def 
+00079860: 7365 745f 7374 6f72 6528 6e75 6d29 3a0a  set_store(num):.
+00079870: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00079880: 656c 662e 5f5f 7365 6c5f 6578 7072 5f64  elf.__sel_expr_d
+00079890: 6562 7567 3a0a 2020 2020 2020 2020 2020  ebug:.          
+000798a0: 2020 2020 2020 7072 696e 7428 2220 2022        print("  "
+000798b0: 202a 2073 656c 662e 6465 7074 6820 2b20   * self.depth + 
+000798c0: 6622 2d2d 3e20 7374 6f72 657b 6e75 6d7d  f"--> store{num}
+000798d0: 2229 0a20 2020 2020 2020 2020 2020 2069  ").            i
+000798e0: 6620 6c65 6e28 7365 6c66 2e73 746f 7265  f len(self.store
+000798f0: 5365 745b 6e75 6d5d 2920 3d3d 2030 3a0a  Set[num]) == 0:.
+00079900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079910: 7365 6c66 2e66 6163 746f 725b 2761 746f  self.factor['ato
+00079920: 6d5f 6964 275d 203d 205b 4e6f 6e65 5d0a  m_id'] = [None].
+00079930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079940: 7365 6c66 2e5f 5f66 2e61 7070 656e 6428  self.__f.append(
+00079950: 6622 5b55 6e73 7570 706f 7274 6564 2064  f"[Unsupported d
+00079960: 6174 615d 207b 7365 6c66 2e5f 5f67 6574  ata] {self.__get
+00079970: 4375 7272 656e 7452 6573 7472 6169 6e74  CurrentRestraint
+00079980: 2829 7d22 0a20 2020 2020 2020 2020 2020  ()}".           
+00079990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000799a0: 2020 2020 2066 2254 6865 2027 7374 6f72       f"The 'stor
+000799b0: 657b 6e75 6d7d 2720 636c 6175 7365 2068  e{num}' clause h
+000799c0: 6173 206e 6f20 6566 6665 6374 2022 0a20  as no effect ". 
+000799d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000799e0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000799f0: 6265 6361 7573 6520 7468 6520 696e 7465  because the inte
+00079a00: 726e 616c 2076 6563 746f 7220 7374 6174  rnal vector stat
+00079a10: 656d 656e 7420 6973 206e 6f74 2073 6574  ement is not set
+00079a20: 2e22 290a 2020 2020 2020 2020 2020 2020  .").            
+00079a30: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00079a40: 2020 2020 2020 7365 6c66 2e66 6163 746f        self.facto
+00079a50: 7220 3d20 636f 7079 2e63 6f70 7928 7365  r = copy.copy(se
+00079a60: 6c66 2e73 746f 7265 5365 745b 6e75 6d5d  lf.storeSet[num]
+00079a70: 290a 0a20 2020 2020 2020 2074 7279 3a0a  )..        try:.
+00079a80: 0a20 2020 2020 2020 2020 2020 2023 2063  .            # c
+00079a90: 6f6e 6361 7465 6e61 7469 6f6e 0a20 2020  oncatenation.   
+00079aa0: 2020 2020 2020 2020 2069 6620 6374 782e           if ctx.
+00079ab0: 6661 6374 6f72 2829 2061 6e64 2073 656c  factor() and sel
+00079ac0: 662e 7374 6163 6b53 656c 6563 7469 6f6e  f.stackSelection
+00079ad0: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+00079ae0: 2020 2069 6620 7365 6c66 2e5f 5f63 6f6e     if self.__con
+00079af0: 5f75 6e69 6f6e 5f65 7870 7220 616e 6420  _union_expr and 
+00079b00: 6e6f 7420 7365 6c66 2e5f 5f63 7572 5f75  not self.__cur_u
+00079b10: 6e69 6f6e 5f65 7870 7220 616e 6420 6374  nion_expr and ct
+00079b20: 782e 4e6f 745f 6f70 2829 3a0a 2020 2020  x.Not_op():.    
+00079b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079b40: 6966 206c 656e 2873 656c 662e 7374 6163  if len(self.stac
+00079b50: 6b46 6163 746f 7273 2920 3e20 303a 0a20  kFactors) > 0:. 
+00079b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079b70: 2020 2020 2020 2073 656c 662e 7374 6163         self.stac
+00079b80: 6b46 6163 746f 7273 2e70 6f70 2829 0a20  kFactors.pop(). 
+00079b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079ba0: 2020 2020 2020 2073 656c 662e 6661 6374         self.fact
+00079bb0: 6f72 5b27 6174 6f6d 5f73 656c 6563 7469  or['atom_selecti
+00079bc0: 6f6e 275d 203d 2073 656c 662e 7374 6163  on'] = self.stac
+00079bd0: 6b53 656c 6563 7469 6f6e 735b 2d31 5d0a  kSelections[-1].
+00079be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079bf0: 2020 2020 2020 2020 7365 6c66 2e73 7461          self.sta
+00079c00: 636b 5365 6c65 6374 696f 6e73 2e61 7070  ckSelections.app
+00079c10: 656e 6428 2761 6e64 2729 2020 2320 696e  end('and')  # in
+00079c20: 7465 7273 6563 7469 6f6e 0a0a 2020 2020  tersection..    
+00079c30: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00079c40: 206e 6f74 2073 656c 662e 5f5f 746f 705f   not self.__top_
+00079c50: 756e 696f 6e5f 6578 7072 3a0a 2020 2020  union_expr:.    
 00079c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079c70: 2020 2041 5554 485f 4154 4f4d 5f44 4154     AUTH_ATOM_DAT
-00079c80: 415f 4954 454d 532c 0a20 2020 2020 2020  A_ITEMS,.       
+00079c70: 6966 206c 656e 2873 656c 662e 7374 6163  if len(self.stac
+00079c80: 6b46 6163 746f 7273 2920 3e20 303a 0a20  kFactors) > 0:. 
 00079c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079cc0: 205b 7b27 6e61 6d65 273a 2073 656c 662e   [{'name': self.
-00079cd0: 5f5f 6d6f 6465 6c4e 756d 4e61 6d65 2c20  __modelNumName, 
-00079ce0: 2774 7970 6527 3a20 2769 6e74 272c 0a20  'type': 'int',. 
-00079cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079d20: 2020 2020 2020 2020 2027 7661 6c75 6527           'value'
-00079d30: 3a20 7365 6c66 2e5f 5f72 6570 7265 7365  : self.__represe
-00079d40: 6e74 6174 6976 654d 6f64 656c 4964 7d2c  ntativeModelId},
-00079d50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00079d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079d80: 2020 2020 2020 2020 2020 7b27 6e61 6d65            {'name
-00079d90: 273a 2027 6c61 6265 6c5f 616c 745f 6964  ': 'label_alt_id
-00079da0: 272c 2027 7479 7065 273a 2027 656e 756d  ', 'type': 'enum
-00079db0: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-00079dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079de0: 2020 2020 2020 2020 2020 2020 2027 656e               'en
-00079df0: 756d 273a 2028 2741 2729 7d0a 2020 2020  um': ('A')}.    
-00079e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079ca0: 2020 2020 2020 2073 656c 662e 7374 6163         self.stac
+00079cb0: 6b46 6163 746f 7273 2e70 6f70 2829 0a20  kFactors.pop(). 
+00079cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079cd0: 2020 2020 2020 2073 656c 662e 6661 6374         self.fact
+00079ce0: 6f72 203d 207b 2761 746f 6d5f 7365 6c65  or = {'atom_sele
+00079cf0: 6374 696f 6e27 3a20 7365 6c66 2e73 7461  ction': self.sta
+00079d00: 636b 5365 6c65 6374 696f 6e73 2e70 6f70  ckSelections.pop
+00079d10: 2829 7d0a 0a20 2020 2020 2020 2020 2020  ()}..           
+00079d20: 2069 6620 6374 782e 416c 6c28 2920 6f72   if ctx.All() or
+00079d30: 2063 7478 2e4b 6e6f 776e 2829 3a0a 2020   ctx.Known():.  
+00079d40: 2020 2020 2020 2020 2020 2020 2020 636c                cl
+00079d50: 6175 7365 4e61 6d65 203d 2027 616c 6c27  auseName = 'all'
+00079d60: 2069 6620 6374 782e 416c 6c28 2920 656c   if ctx.All() el
+00079d70: 7365 2027 6b6e 6f77 6e27 0a20 2020 2020  se 'known'.     
+00079d80: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00079d90: 6c66 2e5f 5f73 656c 5f65 7870 725f 6465  lf.__sel_expr_de
+00079da0: 6275 673a 0a20 2020 2020 2020 2020 2020  bug:.           
+00079db0: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
+00079dc0: 2020 2220 2a20 7365 6c66 2e64 6570 7468    " * self.depth
+00079dd0: 202b 2066 222d 2d3e 207b 636c 6175 7365   + f"--> {clause
+00079de0: 4e61 6d65 7d22 290a 2020 2020 2020 2020  Name}").        
+00079df0: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
+00079e00: 656c 662e 5f5f 6861 7343 6f6f 7264 3a0a  elf.__hasCoord:.
 00079e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079e30: 2020 2020 205d 290a 0a20 2020 2020 2020       ])..       
-00079e40: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00079e50: 662e 696e 7465 7273 6563 7469 6f6e 4661  f.intersectionFa
-00079e60: 6374 6f72 5f65 7870 7265 7373 696f 6e73  ctor_expressions
-00079e70: 2861 746f 6d53 656c 6563 7469 6f6e 290a  (atomSelection).
-00079e80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00079e90: 2020 2020 2069 6620 6c65 6e28 7365 6c66       if len(self
-00079ea0: 2e66 6163 746f 725b 2761 746f 6d5f 7365  .factor['atom_se
-00079eb0: 6c65 6374 696f 6e27 5d29 203d 3d20 303a  lection']) == 0:
-00079ec0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00079ed0: 2020 2020 2020 2020 2073 656c 662e 6661           self.fa
-00079ee0: 6374 6f72 5b27 6174 6f6d 5f69 6427 5d20  ctor['atom_id'] 
-00079ef0: 3d20 5b4e 6f6e 655d 0a20 2020 2020 2020  = [None].       
+00079e20: 2020 2020 7265 7475 726e 0a20 2020 2020      return.     
+00079e30: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
+00079e40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00079e50: 2020 2020 2061 746f 6d53 656c 6563 7469       atomSelecti
+00079e60: 6f6e 203d 5c0a 2020 2020 2020 2020 2020  on =\.          
+00079e70: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00079e80: 6c66 2e5f 5f63 522e 6765 7444 6963 744c  lf.__cR.getDictL
+00079e90: 6973 7457 6974 6846 696c 7465 7228 2761  istWithFilter('a
+00079ea0: 746f 6d5f 7369 7465 272c 0a20 2020 2020  tom_site',.     
+00079eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079ee0: 2020 2041 5554 485f 4154 4f4d 5f44 4154     AUTH_ATOM_DAT
+00079ef0: 415f 4954 454d 532c 0a20 2020 2020 2020  A_ITEMS,.       
 00079f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079f10: 2073 656c 662e 5f5f 662e 6170 7065 6e64   self.__f.append
-00079f20: 2866 225b 496e 7375 6666 6963 6965 6e74  (f"[Insufficient
-00079f30: 2061 746f 6d20 7365 6c65 6374 696f 6e5d   atom selection]
-00079f40: 207b 7365 6c66 2e5f 5f67 6574 4375 7272   {self.__getCurr
-00079f50: 656e 7452 6573 7472 6169 6e74 2829 7d22  entRestraint()}"
-00079f60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00079f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079f30: 205b 7b27 6e61 6d65 273a 2073 656c 662e   [{'name': self.
+00079f40: 5f5f 6d6f 6465 6c4e 756d 4e61 6d65 2c20  __modelNumName, 
+00079f50: 2774 7970 6527 3a20 2769 6e74 272c 0a20  'type': 'int',. 
+00079f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00079f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00079f80: 2020 2020 2020 2020 2066 2254 6865 207b           f"The {
-00079f90: 636c 6175 7365 4e61 6d65 2172 7d20 636c  clauseName!r} cl
-00079fa0: 6175 7365 2068 6173 206e 6f20 6566 6665  ause has no effe
-00079fb0: 6374 2e22 290a 0a20 2020 2020 2020 2020  ct.")..         
-00079fc0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00079fd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00079fe0: 2020 2020 2020 2020 2069 6620 2763 6861           if 'cha
-00079ff0: 696e 5f69 6427 2069 6e20 7365 6c66 2e66  in_id' in self.f
-0007a000: 6163 746f 723a 0a20 2020 2020 2020 2020  actor:.         
-0007a010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007a020: 2020 2064 656c 2073 656c 662e 6661 6374     del self.fact
-0007a030: 6f72 5b27 6368 6169 6e5f 6964 275d 0a20  or['chain_id']. 
+00079f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079f90: 2020 2020 2020 2020 2027 7661 6c75 6527           'value'
+00079fa0: 3a20 7365 6c66 2e5f 5f72 6570 7265 7365  : self.__represe
+00079fb0: 6e74 6174 6976 654d 6f64 656c 4964 7d2c  ntativeModelId},
+00079fc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00079fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00079ff0: 2020 2020 2020 2020 2020 7b27 6e61 6d65            {'name
+0007a000: 273a 2027 6c61 6265 6c5f 616c 745f 6964  ': 'label_alt_id
+0007a010: 272c 2027 7479 7065 273a 2027 656e 756d  ', 'type': 'enum
+0007a020: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+0007a030: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007a040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007a050: 2020 2020 2020 2069 6620 2763 6f6d 705f         if 'comp_
-0007a060: 6964 2720 696e 2073 656c 662e 6661 6374  id' in self.fact
-0007a070: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
+0007a050: 2020 2020 2020 2020 2020 2020 2027 656e               'en
+0007a060: 756d 273a 2028 2741 2729 7d0a 2020 2020  um': ('A')}.    
+0007a070: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007a080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007a090: 6465 6c20 7365 6c66 2e66 6163 746f 725b  del self.factor[
-0007a0a0: 2763 6f6d 705f 6964 275d 0a20 2020 2020  'comp_id'].     
-0007a0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007a0c0: 2020 2069 6620 2773 6571 5f69 6427 2069     if 'seq_id' i
-0007a0d0: 6e20 7365 6c66 2e66 6163 746f 723a 0a20  n self.factor:. 
-0007a0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007a0f0: 2020 2020 2020 2020 2020 2064 656c 2073             del s
-0007a100: 656c 662e 6661 6374 6f72 5b27 7365 715f  elf.factor['seq_
-0007a110: 6964 275d 0a20 2020 2020 2020 2020 2020  id'].           
-0007a120: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0007a130: 2774 7970 655f 7379 6d62 6f6c 2720 696e  'type_symbol' in
-0007a140: 2073 656c 662e 6661 6374 6f72 3a0a 2020   self.factor:.  
-0007a150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007a160: 2020 2020 2020 2020 2020 6465 6c20 7365            del se
-0007a170: 6c66 2e66 6163 746f 725b 2774 7970 655f  lf.factor['type_
-0007a180: 7379 6d62 6f6c 275d 0a20 2020 2020 2020  symbol'].       
-0007a190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007a1a0: 2069 6620 2761 746f 6d5f 6964 2720 696e   if 'atom_id' in
-0007a1b0: 2073 656c 662e 6661 6374 6f72 3a0a 2020   self.factor:.  
-0007a1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007a1d0: 2020 2020 2020 2020 2020 6465 6c20 7365            del se
-0007a1e0: 6c66 2e66 6163 746f 725b 2761 746f 6d5f  lf.factor['atom_
-0007a1f0: 6964 275d 0a20 2020 2020 2020 2020 2020  id'].           
-0007a200: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0007a210: 2763 6f6d 705f 6964 7327 2069 6e20 7365  'comp_ids' in se
-0007a220: 6c66 2e66 6163 746f 723a 0a20 2020 2020  lf.factor:.     
-0007a230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007a240: 2020 2020 2020 2064 656c 2073 656c 662e         del self.
-0007a250: 6661 6374 6f72 5b27 636f 6d70 5f69 6473  factor['comp_ids
-0007a260: 275d 0a20 2020 2020 2020 2020 2020 2020  '].             
-0007a270: 2020 2020 2020 2020 2020 2069 6620 2773             if 's
-0007a280: 6571 5f69 6473 2720 696e 2073 656c 662e  eq_ids' in self.
-0007a290: 6661 6374 6f72 3a0a 2020 2020 2020 2020  factor:.        
-0007a2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007a2b0: 2020 2020 6465 6c20 7365 6c66 2e66 6163      del self.fac
-0007a2c0: 746f 725b 2773 6571 5f69 6473 275d 0a20  tor['seq_ids']. 
-0007a2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007a2e0: 2020 2020 2020 2069 6620 2774 7970 655f         if 'type_
-0007a2f0: 7379 6d62 6f6c 7327 2069 6e20 7365 6c66  symbols' in self
-0007a300: 2e66 6163 746f 723a 0a20 2020 2020 2020  .factor:.       
-0007a310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007a320: 2020 2020 2064 656c 2073 656c 662e 6661       del self.fa
-0007a330: 6374 6f72 5b27 7479 7065 5f73 796d 626f  ctor['type_symbo
-0007a340: 6c73 275d 0a20 2020 2020 2020 2020 2020  ls'].           
-0007a350: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0007a360: 2761 746f 6d5f 6964 7327 2069 6e20 7365  'atom_ids' in se
-0007a370: 6c66 2e66 6163 746f 723a 0a20 2020 2020  lf.factor:.     
-0007a380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007a390: 2020 2020 2020 2064 656c 2073 656c 662e         del self.
-0007a3a0: 6661 6374 6f72 5b27 6174 6f6d 5f69 6473  factor['atom_ids
-0007a3b0: 275d 0a20 2020 2020 2020 2020 2020 2020  '].             
-0007a3c0: 2020 2020 2020 2020 2020 2069 6620 2761             if 'a
-0007a3d0: 6c74 5f63 6861 696e 5f69 6427 2069 6e20  lt_chain_id' in 
-0007a3e0: 7365 6c66 2e66 6163 746f 723a 0a20 2020  self.factor:.   
-0007a3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007a400: 2020 2020 2020 2020 2064 656c 2073 656c           del sel
-0007a410: 662e 6661 6374 6f72 5b27 616c 745f 6368  f.factor['alt_ch
-0007a420: 6169 6e5f 6964 275d 0a20 2020 2020 2020  ain_id'].       
+0007a090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007a0a0: 2020 2020 205d 290a 0a20 2020 2020 2020       ])..       
+0007a0b0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0007a0c0: 662e 696e 7465 7273 6563 7469 6f6e 4661  f.intersectionFa
+0007a0d0: 6374 6f72 5f65 7870 7265 7373 696f 6e73  ctor_expressions
+0007a0e0: 2861 746f 6d53 656c 6563 7469 6f6e 290a  (atomSelection).
+0007a0f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0007a100: 2020 2020 2069 6620 6c65 6e28 7365 6c66       if len(self
+0007a110: 2e66 6163 746f 725b 2761 746f 6d5f 7365  .factor['atom_se
+0007a120: 6c65 6374 696f 6e27 5d29 203d 3d20 303a  lection']) == 0:
+0007a130: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0007a140: 2020 2020 2020 2020 2073 656c 662e 6661           self.fa
+0007a150: 6374 6f72 5b27 6174 6f6d 5f69 6427 5d20  ctor['atom_id'] 
+0007a160: 3d20 5b4e 6f6e 655d 0a20 2020 2020 2020  = [None].       
+0007a170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007a180: 2073 656c 662e 5f5f 662e 6170 7065 6e64   self.__f.append
+0007a190: 2866 225b 496e 7375 6666 6963 6965 6e74  (f"[Insufficient
+0007a1a0: 2061 746f 6d20 7365 6c65 6374 696f 6e5d   atom selection]
+0007a1b0: 207b 7365 6c66 2e5f 5f67 6574 4375 7272   {self.__getCurr
+0007a1c0: 656e 7452 6573 7472 6169 6e74 2829 7d22  entRestraint()}"
+0007a1d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0007a1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007a1f0: 2020 2020 2020 2020 2066 2254 6865 207b           f"The {
+0007a200: 636c 6175 7365 4e61 6d65 2172 7d20 636c  clauseName!r} cl
+0007a210: 6175 7365 2068 6173 206e 6f20 6566 6665  ause has no effe
+0007a220: 6374 2e22 290a 0a20 2020 2020 2020 2020  ct.")..         
+0007a230: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0007a240: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0007a250: 2020 2020 2020 2020 2069 6620 2763 6861           if 'cha
+0007a260: 696e 5f69 6427 2069 6e20 7365 6c66 2e66  in_id' in self.f
+0007a270: 6163 746f 723a 0a20 2020 2020 2020 2020  actor:.         
+0007a280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007a290: 2020 2064 656c 2073 656c 662e 6661 6374     del self.fact
+0007a2a0: 6f72 5b27 6368 6169 6e5f 6964 275d 0a20  or['chain_id']. 
+0007a2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007a2c0: 2020 2020 2020 2069 6620 2763 6f6d 705f         if 'comp_
+0007a2d0: 6964 2720 696e 2073 656c 662e 6661 6374  id' in self.fact
+0007a2e0: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
+0007a2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007a300: 6465 6c20 7365 6c66 2e66 6163 746f 725b  del self.factor[
+0007a310: 2763 6f6d 705f 6964 275d 0a20 2020 2020  'comp_id'].     
+0007a320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007a330: 2020 2069 6620 2773 6571 5f69 6427 2069     if 'seq_id' i
+0007a340: 6e20 7365 6c66 2e66 6163 746f 723a 0a20  n self.factor:. 
+0007a350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007a360: 2020 2020 2020 2020 2020 2064 656c 2073             del s
+0007a370: 656c 662e 6661 6374 6f72 5b27 7365 715f  elf.factor['seq_
+0007a380: 6964 275d 0a20 2020 2020 2020 2020 2020  id'].           
+0007a390: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0007a3a0: 2774 7970 655f 7379 6d62 6f6c 2720 696e  'type_symbol' in
+0007a3b0: 2073 656c 662e 6661 6374 6f72 3a0a 2020   self.factor:.  
+0007a3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007a3d0: 2020 2020 2020 2020 2020 6465 6c20 7365            del se
+0007a3e0: 6c66 2e66 6163 746f 725b 2774 7970 655f  lf.factor['type_
+0007a3f0: 7379 6d62 6f6c 275d 0a20 2020 2020 2020  symbol'].       
+0007a400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007a410: 2069 6620 2761 746f 6d5f 6964 2720 696e   if 'atom_id' in
+0007a420: 2073 656c 662e 6661 6374 6f72 3a0a 2020   self.factor:.  
 0007a430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007a440: 2069 6620 2761 6c74 5f61 746f 6d5f 6964   if 'alt_atom_id
-0007a450: 2720 696e 2073 656c 662e 6661 6374 6f72  ' in self.factor
-0007a460: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0007a470: 2020 2020 2020 2020 2020 2020 2020 6465                de
-0007a480: 6c20 7365 6c66 2e66 6163 746f 725b 2761  l self.factor['a
-0007a490: 6c74 5f61 746f 6d5f 6964 275d 0a0a 2020  lt_atom_id']..  
-0007a4a0: 2020 2020 2020 2020 2020 2020 2020 6578                ex
-0007a4b0: 6365 7074 2045 7863 6570 7469 6f6e 2061  cept Exception a
-0007a4c0: 7320 653a 0a20 2020 2020 2020 2020 2020  s e:.           
-0007a4d0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-0007a4e0: 2e5f 5f76 6572 626f 7365 3a0a 2020 2020  .__verbose:.    
-0007a4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007a500: 2020 2020 7365 6c66 2e5f 5f6c 6668 2e77      self.__lfh.w
-0007a510: 7269 7465 2866 222b 5870 6c6f 724d 5250  rite(f"+XplorMRP
-0007a520: 6172 7365 724c 6973 7465 6e65 722e 6578  arserListener.ex
-0007a530: 6974 4661 6374 6f72 2829 202b 2b20 4572  itFactor() ++ Er
-0007a540: 726f 7220 202d 207b 7374 7228 6529 7d22  ror  - {str(e)}"
-0007a550: 290a 0a20 2020 2020 2020 2020 2020 2065  )..            e
-0007a560: 6c69 6620 6374 782e 4172 6f75 6e64 2829  lif ctx.Around()
-0007a570: 206f 7220 6374 782e 5361 726f 756e 6428   or ctx.Saround(
-0007a580: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0007a590: 2020 2063 6c61 7573 654e 616d 6520 3d20     clauseName = 
-0007a5a0: 2761 726f 756e 6427 2069 6620 6374 782e  'around' if ctx.
-0007a5b0: 4172 6f75 6e64 2829 2065 6c73 6520 2773  Around() else 's
-0007a5c0: 6172 6f75 6e64 270a 2020 2020 2020 2020  around'.        
-0007a5d0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0007a5e0: 5f5f 7365 6c5f 6578 7072 5f64 6562 7567  __sel_expr_debug
-0007a5f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0007a600: 2020 2020 2020 7072 696e 7428 2220 2022        print("  "
-0007a610: 202a 2073 656c 662e 6465 7074 6820 2b20   * self.depth + 
-0007a620: 6622 2d2d 3e20 7b63 6c61 7573 654e 616d  f"--> {clauseNam
-0007a630: 657d 2229 0a20 2020 2020 2020 2020 2020  e}").           
-0007a640: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
-0007a650: 2e5f 5f68 6173 436f 6f72 643a 0a20 2020  .__hasCoord:.   
+0007a440: 2020 2020 2020 2020 2020 6465 6c20 7365            del se
+0007a450: 6c66 2e66 6163 746f 725b 2761 746f 6d5f  lf.factor['atom_
+0007a460: 6964 275d 0a20 2020 2020 2020 2020 2020  id'].           
+0007a470: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0007a480: 2763 6f6d 705f 6964 7327 2069 6e20 7365  'comp_ids' in se
+0007a490: 6c66 2e66 6163 746f 723a 0a20 2020 2020  lf.factor:.     
+0007a4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007a4b0: 2020 2020 2020 2064 656c 2073 656c 662e         del self.
+0007a4c0: 6661 6374 6f72 5b27 636f 6d70 5f69 6473  factor['comp_ids
+0007a4d0: 275d 0a20 2020 2020 2020 2020 2020 2020  '].             
+0007a4e0: 2020 2020 2020 2020 2020 2069 6620 2773             if 's
+0007a4f0: 6571 5f69 6473 2720 696e 2073 656c 662e  eq_ids' in self.
+0007a500: 6661 6374 6f72 3a0a 2020 2020 2020 2020  factor:.        
+0007a510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007a520: 2020 2020 6465 6c20 7365 6c66 2e66 6163      del self.fac
+0007a530: 746f 725b 2773 6571 5f69 6473 275d 0a20  tor['seq_ids']. 
+0007a540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007a550: 2020 2020 2020 2069 6620 2774 7970 655f         if 'type_
+0007a560: 7379 6d62 6f6c 7327 2069 6e20 7365 6c66  symbols' in self
+0007a570: 2e66 6163 746f 723a 0a20 2020 2020 2020  .factor:.       
+0007a580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007a590: 2020 2020 2064 656c 2073 656c 662e 6661       del self.fa
+0007a5a0: 6374 6f72 5b27 7479 7065 5f73 796d 626f  ctor['type_symbo
+0007a5b0: 6c73 275d 0a20 2020 2020 2020 2020 2020  ls'].           
+0007a5c0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0007a5d0: 2761 746f 6d5f 6964 7327 2069 6e20 7365  'atom_ids' in se
+0007a5e0: 6c66 2e66 6163 746f 723a 0a20 2020 2020  lf.factor:.     
+0007a5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007a600: 2020 2020 2020 2064 656c 2073 656c 662e         del self.
+0007a610: 6661 6374 6f72 5b27 6174 6f6d 5f69 6473  factor['atom_ids
+0007a620: 275d 0a20 2020 2020 2020 2020 2020 2020  '].             
+0007a630: 2020 2020 2020 2020 2020 2069 6620 2761             if 'a
+0007a640: 6c74 5f63 6861 696e 5f69 6427 2069 6e20  lt_chain_id' in 
+0007a650: 7365 6c66 2e66 6163 746f 723a 0a20 2020  self.factor:.   
 0007a660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007a670: 2072 6574 7572 6e0a 2020 2020 2020 2020   return.        
-0007a680: 2020 2020 2020 2020 6966 206c 656e 2873          if len(s
-0007a690: 656c 662e 6e75 6d62 6572 4653 656c 6563  elf.numberFSelec
-0007a6a0: 7469 6f6e 2920 3d3d 2030 206f 7220 4e6f  tion) == 0 or No
-0007a6b0: 6e65 2069 6e20 7365 6c66 2e6e 756d 6265  ne in self.numbe
-0007a6c0: 7246 5365 6c65 6374 696f 6e3a 0a20 2020  rFSelection:.   
-0007a6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007a6e0: 2072 6574 7572 6e0a 2020 2020 2020 2020   return.        
-0007a6f0: 2020 2020 2020 2020 6172 6f75 6e64 203d          around =
-0007a700: 2073 656c 662e 6e75 6d62 6572 4653 656c   self.numberFSel
-0007a710: 6563 7469 6f6e 5b30 5d0a 2020 2020 2020  ection[0].      
-0007a720: 2020 2020 2020 2020 2020 5f61 746f 6d53            _atomS
-0007a730: 656c 6563 7469 6f6e 203d 205b 5d0a 0a20  election = [].. 
-0007a740: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0007a750: 656c 662e 636f 6e73 756d 6546 6163 746f  elf.consumeFacto
-0007a760: 725f 6578 7072 6573 7369 6f6e 7328 6622  r_expressions(f"
-0007a770: 6174 6f6d 2073 656c 6563 7469 6f6e 2065  atom selection e
-0007a780: 7870 7265 7373 696f 6e20 6265 666f 7265  xpression before
-0007a790: 2074 6865 207b 636c 6175 7365 4e61 6d65   the {clauseName
-0007a7a0: 2172 7d20 636c 6175 7365 2229 0a0a 2020  !r} clause")..  
-0007a7b0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0007a7c0: 2027 6174 6f6d 5f73 656c 6563 7469 6f6e   'atom_selection
-0007a7d0: 2720 696e 2073 656c 662e 6661 6374 6f72  ' in self.factor
-0007a7e0: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
-0007a7f0: 2020 2020 2020 2066 6f72 205f 6174 6f6d         for _atom
-0007a800: 2069 6e20 7365 6c66 2e66 6163 746f 725b   in self.factor[
-0007a810: 2761 746f 6d5f 7365 6c65 6374 696f 6e27  'atom_selection'
-0007a820: 5d3a 0a0a 2020 2020 2020 2020 2020 2020  ]:..            
-0007a830: 2020 2020 2020 2020 2020 2020 7472 793a              try:
-0007a840: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0007a850: 2020 2020 2020 2020 2020 2020 2020 5f6f                _o
-0007a860: 7269 6769 6e20 3d5c 0a20 2020 2020 2020  rigin =\.       
-0007a870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007a880: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
-0007a890: 6352 2e67 6574 4469 6374 4c69 7374 5769  cR.getDictListWi
-0007a8a0: 7468 4669 6c74 6572 2827 6174 6f6d 5f73  thFilter('atom_s
-0007a8b0: 6974 6527 2c0a 2020 2020 2020 2020 2020  ite',.          
-0007a8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007a670: 2020 2020 2020 2020 2064 656c 2073 656c           del sel
+0007a680: 662e 6661 6374 6f72 5b27 616c 745f 6368  f.factor['alt_ch
+0007a690: 6169 6e5f 6964 275d 0a20 2020 2020 2020  ain_id'].       
+0007a6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007a6b0: 2069 6620 2761 6c74 5f61 746f 6d5f 6964   if 'alt_atom_id
+0007a6c0: 2720 696e 2073 656c 662e 6661 6374 6f72  ' in self.factor
+0007a6d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0007a6e0: 2020 2020 2020 2020 2020 2020 2020 6465                de
+0007a6f0: 6c20 7365 6c66 2e66 6163 746f 725b 2761  l self.factor['a
+0007a700: 6c74 5f61 746f 6d5f 6964 275d 0a0a 2020  lt_atom_id']..  
+0007a710: 2020 2020 2020 2020 2020 2020 2020 6578                ex
+0007a720: 6365 7074 2045 7863 6570 7469 6f6e 2061  cept Exception a
+0007a730: 7320 653a 0a20 2020 2020 2020 2020 2020  s e:.           
+0007a740: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+0007a750: 2e5f 5f76 6572 626f 7365 3a0a 2020 2020  .__verbose:.    
+0007a760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007a770: 2020 2020 7365 6c66 2e5f 5f6c 6668 2e77      self.__lfh.w
+0007a780: 7269 7465 2866 222b 5870 6c6f 724d 5250  rite(f"+XplorMRP
+0007a790: 6172 7365 724c 6973 7465 6e65 722e 6578  arserListener.ex
+0007a7a0: 6974 4661 6374 6f72 2829 202b 2b20 4572  itFactor() ++ Er
+0007a7b0: 726f 7220 202d 207b 7374 7228 6529 7d22  ror  - {str(e)}"
+0007a7c0: 290a 0a20 2020 2020 2020 2020 2020 2065  )..            e
+0007a7d0: 6c69 6620 6374 782e 4172 6f75 6e64 2829  lif ctx.Around()
+0007a7e0: 206f 7220 6374 782e 5361 726f 756e 6428   or ctx.Saround(
+0007a7f0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0007a800: 2020 2063 6c61 7573 654e 616d 6520 3d20     clauseName = 
+0007a810: 2761 726f 756e 6427 2069 6620 6374 782e  'around' if ctx.
+0007a820: 4172 6f75 6e64 2829 2065 6c73 6520 2773  Around() else 's
+0007a830: 6172 6f75 6e64 270a 2020 2020 2020 2020  around'.        
+0007a840: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0007a850: 5f5f 7365 6c5f 6578 7072 5f64 6562 7567  __sel_expr_debug
+0007a860: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0007a870: 2020 2020 2020 7072 696e 7428 2220 2022        print("  "
+0007a880: 202a 2073 656c 662e 6465 7074 6820 2b20   * self.depth + 
+0007a890: 6622 2d2d 3e20 7b63 6c61 7573 654e 616d  f"--> {clauseNam
+0007a8a0: 657d 2229 0a20 2020 2020 2020 2020 2020  e}").           
+0007a8b0: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
+0007a8c0: 2e5f 5f68 6173 436f 6f72 643a 0a20 2020  .__hasCoord:.   
 0007a8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007a8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007a8f0: 2020 2020 2020 4341 5254 4e5f 4441 5441        CARTN_DATA
-0007a900: 5f49 5445 4d53 2c0a 2020 2020 2020 2020  _ITEMS,.        
-0007a910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007a920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007a930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007a940: 2020 2020 2020 2020 5b7b 276e 616d 6527          [{'name'
-0007a950: 3a20 7365 6c66 2e5f 5f61 7574 6841 7379  : self.__authAsy
-0007a960: 6d49 642c 2027 7479 7065 273a 2027 7374  mId, 'type': 'st
-0007a970: 7227 2c20 2776 616c 7565 273a 205f 6174  r', 'value': _at
-0007a980: 6f6d 5b27 6368 6169 6e5f 6964 275d 7d2c  om['chain_id']},
-0007a990: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0007a9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007a9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007a9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007a9d0: 2020 7b27 6e61 6d65 273a 2073 656c 662e    {'name': self.
-0007a9e0: 5f5f 6175 7468 5365 7149 642c 2027 7479  __authSeqId, 'ty
-0007a9f0: 7065 273a 2027 696e 7427 2c20 2776 616c  pe': 'int', 'val
-0007aa00: 7565 273a 205f 6174 6f6d 5b27 7365 715f  ue': _atom['seq_
-0007aa10: 6964 275d 7d2c 0a20 2020 2020 2020 2020  id']},.         
-0007aa20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007aa30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007aa40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007aa50: 2020 2020 2020 2020 7b27 6e61 6d65 273a          {'name':
-0007aa60: 2073 656c 662e 5f5f 6175 7468 4174 6f6d   self.__authAtom
-0007aa70: 4964 2c20 2774 7970 6527 3a20 2773 7472  Id, 'type': 'str
-0007aa80: 272c 2027 7661 6c75 6527 3a20 5f61 746f  ', 'value': _ato
-0007aa90: 6d5b 2761 746f 6d5f 6964 275d 7d2c 0a20  m['atom_id']},. 
-0007aaa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007aab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007aac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007aad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007aae0: 7b27 6e61 6d65 273a 2073 656c 662e 5f5f  {'name': self.__
-0007aaf0: 6d6f 6465 6c4e 756d 4e61 6d65 2c20 2774  modelNumName, 't
-0007ab00: 7970 6527 3a20 2769 6e74 272c 0a20 2020  ype': 'int',.   
-0007ab10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ab20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007a8e0: 2072 6574 7572 6e0a 2020 2020 2020 2020   return.        
+0007a8f0: 2020 2020 2020 2020 6966 206c 656e 2873          if len(s
+0007a900: 656c 662e 6e75 6d62 6572 4653 656c 6563  elf.numberFSelec
+0007a910: 7469 6f6e 2920 3d3d 2030 206f 7220 4e6f  tion) == 0 or No
+0007a920: 6e65 2069 6e20 7365 6c66 2e6e 756d 6265  ne in self.numbe
+0007a930: 7246 5365 6c65 6374 696f 6e3a 0a20 2020  rFSelection:.   
+0007a940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007a950: 2072 6574 7572 6e0a 2020 2020 2020 2020   return.        
+0007a960: 2020 2020 2020 2020 6172 6f75 6e64 203d          around =
+0007a970: 2073 656c 662e 6e75 6d62 6572 4653 656c   self.numberFSel
+0007a980: 6563 7469 6f6e 5b30 5d0a 2020 2020 2020  ection[0].      
+0007a990: 2020 2020 2020 2020 2020 5f61 746f 6d53            _atomS
+0007a9a0: 656c 6563 7469 6f6e 203d 205b 5d0a 0a20  election = [].. 
+0007a9b0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0007a9c0: 656c 662e 636f 6e73 756d 6546 6163 746f  elf.consumeFacto
+0007a9d0: 725f 6578 7072 6573 7369 6f6e 7328 6622  r_expressions(f"
+0007a9e0: 6174 6f6d 2073 656c 6563 7469 6f6e 2065  atom selection e
+0007a9f0: 7870 7265 7373 696f 6e20 6265 666f 7265  xpression before
+0007aa00: 2074 6865 207b 636c 6175 7365 4e61 6d65   the {clauseName
+0007aa10: 2172 7d20 636c 6175 7365 2229 0a0a 2020  !r} clause")..  
+0007aa20: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0007aa30: 2027 6174 6f6d 5f73 656c 6563 7469 6f6e   'atom_selection
+0007aa40: 2720 696e 2073 656c 662e 6661 6374 6f72  ' in self.factor
+0007aa50: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
+0007aa60: 2020 2020 2020 2066 6f72 205f 6174 6f6d         for _atom
+0007aa70: 2069 6e20 7365 6c66 2e66 6163 746f 725b   in self.factor[
+0007aa80: 2761 746f 6d5f 7365 6c65 6374 696f 6e27  'atom_selection'
+0007aa90: 5d3a 0a0a 2020 2020 2020 2020 2020 2020  ]:..            
+0007aaa0: 2020 2020 2020 2020 2020 2020 7472 793a              try:
+0007aab0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0007aac0: 2020 2020 2020 2020 2020 2020 2020 5f6f                _o
+0007aad0: 7269 6769 6e20 3d5c 0a20 2020 2020 2020  rigin =\.       
+0007aae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007aaf0: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
+0007ab00: 6352 2e67 6574 4469 6374 4c69 7374 5769  cR.getDictListWi
+0007ab10: 7468 4669 6c74 6572 2827 6174 6f6d 5f73  thFilter('atom_s
+0007ab20: 6974 6527 2c0a 2020 2020 2020 2020 2020  ite',.          
 0007ab30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ab40: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0007ab50: 7661 6c75 6527 3a20 7365 6c66 2e5f 5f72  value': self.__r
-0007ab60: 6570 7265 7365 6e74 6174 6976 654d 6f64  epresentativeMod
-0007ab70: 656c 4964 7d2c 0a20 2020 2020 2020 2020  elId},.         
+0007ab40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ab50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ab60: 2020 2020 2020 4341 5254 4e5f 4441 5441        CARTN_DATA
+0007ab70: 5f49 5445 4d53 2c0a 2020 2020 2020 2020  _ITEMS,.        
 0007ab80: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007ab90: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007aba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007abb0: 2020 2020 2020 2020 7b27 6e61 6d65 273a          {'name':
-0007abc0: 2027 6c61 6265 6c5f 616c 745f 6964 272c   'label_alt_id',
-0007abd0: 2027 7479 7065 273a 2027 656e 756d 272c   'type': 'enum',
-0007abe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0007abf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ac00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007abb0: 2020 2020 2020 2020 5b7b 276e 616d 6527          [{'name'
+0007abc0: 3a20 7365 6c66 2e5f 5f61 7574 6841 7379  : self.__authAsy
+0007abd0: 6d49 642c 2027 7479 7065 273a 2027 7374  mId, 'type': 'st
+0007abe0: 7227 2c20 2776 616c 7565 273a 205f 6174  r', 'value': _at
+0007abf0: 6f6d 5b27 6368 6169 6e5f 6964 275d 7d2c  om['chain_id']},
+0007ac00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 0007ac10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ac20: 2020 2027 656e 756d 273a 2028 2741 2729     'enum': ('A')
-0007ac30: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
-0007ac40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ac50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ac60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ac70: 2020 205d 290a 0a20 2020 2020 2020 2020     ])..         
-0007ac80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ac90: 2020 2069 6620 6c65 6e28 5f6f 7269 6769     if len(_origi
-0007aca0: 6e29 2021 3d20 313a 0a20 2020 2020 2020  n) != 1:.       
+0007ac20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ac30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ac40: 2020 7b27 6e61 6d65 273a 2073 656c 662e    {'name': self.
+0007ac50: 5f5f 6175 7468 5365 7149 642c 2027 7479  __authSeqId, 'ty
+0007ac60: 7065 273a 2027 696e 7427 2c20 2776 616c  pe': 'int', 'val
+0007ac70: 7565 273a 205f 6174 6f6d 5b27 7365 715f  ue': _atom['seq_
+0007ac80: 6964 275d 7d2c 0a20 2020 2020 2020 2020  id']},.         
+0007ac90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007aca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007acb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007acc0: 2020 2020 2020 2020 2063 6f6e 7469 6e75           continu
-0007acd0: 650a 0a20 2020 2020 2020 2020 2020 2020  e..             
-0007ace0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-0007acf0: 7269 6769 6e20 3d20 746f 4e70 4172 7261  rigin = toNpArra
-0007ad00: 7928 5f6f 7269 6769 6e5b 305d 290a 0a20  y(_origin[0]).. 
+0007acc0: 2020 2020 2020 2020 7b27 6e61 6d65 273a          {'name':
+0007acd0: 2073 656c 662e 5f5f 6175 7468 4174 6f6d   self.__authAtom
+0007ace0: 4964 2c20 2774 7970 6527 3a20 2773 7472  Id, 'type': 'str
+0007acf0: 272c 2027 7661 6c75 6527 3a20 5f61 746f  ', 'value': _ato
+0007ad00: 6d5b 2761 746f 6d5f 6964 275d 7d2c 0a20  m['atom_id']},. 
 0007ad10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ad20: 2020 2020 2020 2020 2020 205f 6e65 6967             _neig
-0007ad30: 6862 6f72 203d 5c0a 2020 2020 2020 2020  hbor =\.        
+0007ad20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ad30: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007ad40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ad50: 2020 2020 2020 2020 7365 6c66 2e5f 5f63          self.__c
-0007ad60: 522e 6765 7444 6963 744c 6973 7457 6974  R.getDictListWit
-0007ad70: 6846 696c 7465 7228 2761 746f 6d5f 7369  hFilter('atom_si
-0007ad80: 7465 272c 0a20 2020 2020 2020 2020 2020  te',.           
+0007ad50: 7b27 6e61 6d65 273a 2073 656c 662e 5f5f  {'name': self.__
+0007ad60: 6d6f 6465 6c4e 756d 4e61 6d65 2c20 2774  modelNumName, 't
+0007ad70: 7970 6527 3a20 2769 6e74 272c 0a20 2020  ype': 'int',.   
+0007ad80: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007ad90: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007ada0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007adb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007adc0: 2020 2020 2041 5554 485f 4154 4f4d 5f43       AUTH_ATOM_C
-0007add0: 4152 544e 5f44 4154 415f 4954 454d 532c  ARTN_DATA_ITEMS,
-0007ade0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0007adb0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0007adc0: 7661 6c75 6527 3a20 7365 6c66 2e5f 5f72  value': self.__r
+0007add0: 6570 7265 7365 6e74 6174 6976 654d 6f64  epresentativeMod
+0007ade0: 656c 4964 7d2c 0a20 2020 2020 2020 2020  elId},.         
 0007adf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007ae00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007ae10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ae20: 205b 7b27 6e61 6d65 273a 2027 4361 7274   [{'name': 'Cart
-0007ae30: 6e5f 7827 2c20 2774 7970 6527 3a20 2772  n_x', 'type': 'r
-0007ae40: 616e 6765 2d66 6c6f 6174 272c 0a20 2020  ange-float',.   
-0007ae50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ae20: 2020 2020 2020 2020 7b27 6e61 6d65 273a          {'name':
+0007ae30: 2027 6c61 6265 6c5f 616c 745f 6964 272c   'label_alt_id',
+0007ae40: 2027 7479 7065 273a 2027 656e 756d 272c   'type': 'enum',
+0007ae50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 0007ae60: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007ae70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ae80: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0007ae90: 7261 6e67 6527 3a20 7b27 6d69 6e5f 6578  range': {'min_ex
-0007aea0: 636c 7573 6976 6527 3a20 286f 7269 6769  clusive': (origi
-0007aeb0: 6e5b 305d 202d 2061 726f 756e 6429 2c0a  n[0] - around),.
+0007ae80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ae90: 2020 2027 656e 756d 273a 2028 2741 2729     'enum': ('A')
+0007aea0: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
+0007aeb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007aec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007aed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007aee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007aee0: 2020 205d 290a 0a20 2020 2020 2020 2020     ])..         
 0007aef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007af00: 2020 2020 2020 2020 2020 2020 276d 6178              'max
-0007af10: 5f65 7863 6c75 7369 7665 273a 2028 6f72  _exclusive': (or
-0007af20: 6967 696e 5b30 5d20 2b20 6172 6f75 6e64  igin[0] + around
-0007af30: 297d 7d2c 0a20 2020 2020 2020 2020 2020  )}},.           
-0007af40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007af50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007af60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007af70: 2020 2020 2020 7b27 6e61 6d65 273a 2027        {'name': '
-0007af80: 4361 7274 6e5f 7927 2c20 2774 7970 6527  Cartn_y', 'type'
-0007af90: 3a20 2772 616e 6765 2d66 6c6f 6174 272c  : 'range-float',
-0007afa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0007af00: 2020 2069 6620 6c65 6e28 5f6f 7269 6769     if len(_origi
+0007af10: 6e29 2021 3d20 313a 0a20 2020 2020 2020  n) != 1:.       
+0007af20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007af30: 2020 2020 2020 2020 2063 6f6e 7469 6e75           continu
+0007af40: 650a 0a20 2020 2020 2020 2020 2020 2020  e..             
+0007af50: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+0007af60: 7269 6769 6e20 3d20 746f 4e70 4172 7261  rigin = toNpArra
+0007af70: 7928 5f6f 7269 6769 6e5b 305d 290a 0a20  y(_origin[0]).. 
+0007af80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007af90: 2020 2020 2020 2020 2020 205f 6e65 6967             _neig
+0007afa0: 6862 6f72 203d 5c0a 2020 2020 2020 2020  hbor =\.        
 0007afb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007afc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007afd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007afe0: 2020 2027 7261 6e67 6527 3a20 7b27 6d69     'range': {'mi
-0007aff0: 6e5f 6578 636c 7573 6976 6527 3a20 286f  n_exclusive': (o
-0007b000: 7269 6769 6e5b 315d 202d 2061 726f 756e  rigin[1] - aroun
-0007b010: 6429 2c0a 2020 2020 2020 2020 2020 2020  d),.            
+0007afc0: 2020 2020 2020 2020 7365 6c66 2e5f 5f63          self.__c
+0007afd0: 522e 6765 7444 6963 744c 6973 7457 6974  R.getDictListWit
+0007afe0: 6846 696c 7465 7228 2761 746f 6d5f 7369  hFilter('atom_si
+0007aff0: 7465 272c 0a20 2020 2020 2020 2020 2020  te',.           
+0007b000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b010: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007b020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b060: 276d 6178 5f65 7863 6c75 7369 7665 273a  'max_exclusive':
-0007b070: 2028 6f72 6967 696e 5b31 5d20 2b20 6172   (origin[1] + ar
-0007b080: 6f75 6e64 297d 7d2c 0a20 2020 2020 2020  ound)}},.       
-0007b090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b0c0: 2020 2020 2020 2020 2020 7b27 6e61 6d65            {'name
-0007b0d0: 273a 2027 4361 7274 6e5f 7a27 2c20 2774  ': 'Cartn_z', 't
-0007b0e0: 7970 6527 3a20 2772 616e 6765 2d66 6c6f  ype': 'range-flo
-0007b0f0: 6174 272c 0a20 2020 2020 2020 2020 2020  at',.           
-0007b100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b130: 2020 2020 2020 2027 7261 6e67 6527 3a20         'range': 
-0007b140: 7b27 6d69 6e5f 6578 636c 7573 6976 6527  {'min_exclusive'
-0007b150: 3a20 286f 7269 6769 6e5b 325d 202d 2061  : (origin[2] - a
-0007b160: 726f 756e 6429 2c0a 2020 2020 2020 2020  round),.        
-0007b170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b1b0: 2020 2020 276d 6178 5f65 7863 6c75 7369      'max_exclusi
-0007b1c0: 7665 273a 2028 6f72 6967 696e 5b32 5d20  ve': (origin[2] 
-0007b1d0: 2b20 6172 6f75 6e64 297d 7d2c 0a20 2020  + around)}},.   
-0007b1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b210: 2020 2020 2020 2020 2020 2020 2020 7b27                {'
-0007b220: 6e61 6d65 273a 2073 656c 662e 5f5f 6d6f  name': self.__mo
-0007b230: 6465 6c4e 756d 4e61 6d65 2c20 2774 7970  delNumName, 'typ
-0007b240: 6527 3a20 2769 6e74 272c 0a20 2020 2020  e': 'int',.     
-0007b250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b280: 2020 2020 2020 2020 2020 2020 2027 7661               'va
-0007b290: 6c75 6527 3a20 7365 6c66 2e5f 5f72 6570  lue': self.__rep
-0007b2a0: 7265 7365 6e74 6174 6976 654d 6f64 656c  resentativeModel
-0007b2b0: 4964 7d2c 0a20 2020 2020 2020 2020 2020  Id},.           
+0007b030: 2020 2020 2041 5554 485f 4154 4f4d 5f43       AUTH_ATOM_C
+0007b040: 4152 544e 5f44 4154 415f 4954 454d 532c  ARTN_DATA_ITEMS,
+0007b050: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0007b060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b090: 205b 7b27 6e61 6d65 273a 2027 4361 7274   [{'name': 'Cart
+0007b0a0: 6e5f 7827 2c20 2774 7970 6527 3a20 2772  n_x', 'type': 'r
+0007b0b0: 616e 6765 2d66 6c6f 6174 272c 0a20 2020  ange-float',.   
+0007b0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b0f0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0007b100: 7261 6e67 6527 3a20 7b27 6d69 6e5f 6578  range': {'min_ex
+0007b110: 636c 7573 6976 6527 3a20 286f 7269 6769  clusive': (origi
+0007b120: 6e5b 305d 202d 2061 726f 756e 6429 2c0a  n[0] - around),.
+0007b130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b170: 2020 2020 2020 2020 2020 2020 276d 6178              'max
+0007b180: 5f65 7863 6c75 7369 7665 273a 2028 6f72  _exclusive': (or
+0007b190: 6967 696e 5b30 5d20 2b20 6172 6f75 6e64  igin[0] + around
+0007b1a0: 297d 7d2c 0a20 2020 2020 2020 2020 2020  )}},.           
+0007b1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b1e0: 2020 2020 2020 7b27 6e61 6d65 273a 2027        {'name': '
+0007b1f0: 4361 7274 6e5f 7927 2c20 2774 7970 6527  Cartn_y', 'type'
+0007b200: 3a20 2772 616e 6765 2d66 6c6f 6174 272c  : 'range-float',
+0007b210: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0007b220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b250: 2020 2027 7261 6e67 6527 3a20 7b27 6d69     'range': {'mi
+0007b260: 6e5f 6578 636c 7573 6976 6527 3a20 286f  n_exclusive': (o
+0007b270: 7269 6769 6e5b 315d 202d 2061 726f 756e  rigin[1] - aroun
+0007b280: 6429 2c0a 2020 2020 2020 2020 2020 2020  d),.            
+0007b290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007b2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b2f0: 2020 2020 2020 7b27 6e61 6d65 273a 2027        {'name': '
-0007b300: 6c61 6265 6c5f 616c 745f 6964 272c 2027  label_alt_id', '
-0007b310: 7479 7065 273a 2027 656e 756d 272c 0a20  type': 'enum',. 
+0007b2d0: 276d 6178 5f65 7863 6c75 7369 7665 273a  'max_exclusive':
+0007b2e0: 2028 6f72 6967 696e 5b31 5d20 2b20 6172   (origin[1] + ar
+0007b2f0: 6f75 6e64 297d 7d2c 0a20 2020 2020 2020  ound)}},.       
+0007b300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b310: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007b320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b360: 2027 656e 756d 273a 2028 2741 2729 7d0a   'enum': ('A')}.
+0007b330: 2020 2020 2020 2020 2020 7b27 6e61 6d65            {'name
+0007b340: 273a 2027 4361 7274 6e5f 7a27 2c20 2774  ': 'Cartn_z', 't
+0007b350: 7970 6527 3a20 2772 616e 6765 2d66 6c6f  ype': 'range-flo
+0007b360: 6174 272c 0a20 2020 2020 2020 2020 2020  at',.           
 0007b370: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007b380: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007b390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b3b0: 205d 290a 0a20 2020 2020 2020 2020 2020   ])..           
-0007b3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b3d0: 2069 6620 6c65 6e28 5f6e 6569 6768 626f   if len(_neighbo
-0007b3e0: 7229 203d 3d20 303a 0a20 2020 2020 2020  r) == 0:.       
+0007b3a0: 2020 2020 2020 2027 7261 6e67 6527 3a20         'range': 
+0007b3b0: 7b27 6d69 6e5f 6578 636c 7573 6976 6527  {'min_exclusive'
+0007b3c0: 3a20 286f 7269 6769 6e5b 325d 202d 2061  : (origin[2] - a
+0007b3d0: 726f 756e 6429 2c0a 2020 2020 2020 2020  round),.        
+0007b3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007b3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b400: 2020 2020 2020 2020 2063 6f6e 7469 6e75           continu
-0007b410: 650a 0a20 2020 2020 2020 2020 2020 2020  e..             
-0007b420: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0007b430: 6569 6768 626f 7220 3d20 5b61 746f 6d20  eighbor = [atom 
-0007b440: 666f 7220 6174 6f6d 2069 6e20 5f6e 6569  for atom in _nei
-0007b450: 6768 626f 7220 6966 206e 756d 7079 2e6c  ghbor if numpy.l
-0007b460: 696e 616c 672e 6e6f 726d 2874 6f4e 7041  inalg.norm(toNpA
-0007b470: 7272 6179 2861 746f 6d29 202d 206f 7269  rray(atom) - ori
-0007b480: 6769 6e29 203c 2061 726f 756e 645d 0a0a  gin) < around]..
-0007b490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b4a0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0007b4b0: 6174 6f6d 2069 6e20 6e65 6967 6862 6f72  atom in neighbor
-0007b4c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0007b400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b420: 2020 2020 276d 6178 5f65 7863 6c75 7369      'max_exclusi
+0007b430: 7665 273a 2028 6f72 6967 696e 5b32 5d20  ve': (origin[2] 
+0007b440: 2b20 6172 6f75 6e64 297d 7d2c 0a20 2020  + around)}},.   
+0007b450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b480: 2020 2020 2020 2020 2020 2020 2020 7b27                {'
+0007b490: 6e61 6d65 273a 2073 656c 662e 5f5f 6d6f  name': self.__mo
+0007b4a0: 6465 6c4e 756d 4e61 6d65 2c20 2774 7970  delNumName, 'typ
+0007b4b0: 6527 3a20 2769 6e74 272c 0a20 2020 2020  e': 'int',.     
+0007b4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007b4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b4e0: 2020 6465 6c20 6174 6f6d 5b27 7827 5d0a    del atom['x'].
-0007b4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b510: 6465 6c20 6174 6f6d 5b27 7927 5d0a 2020  del atom['y'].  
-0007b520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b530: 2020 2020 2020 2020 2020 2020 2020 6465                de
-0007b540: 6c20 6174 6f6d 5b27 7a27 5d0a 2020 2020  l atom['z'].    
+0007b4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b4f0: 2020 2020 2020 2020 2020 2020 2027 7661               'va
+0007b500: 6c75 6527 3a20 7365 6c66 2e5f 5f72 6570  lue': self.__rep
+0007b510: 7265 7365 6e74 6174 6976 654d 6f64 656c  resentativeModel
+0007b520: 4964 7d2c 0a20 2020 2020 2020 2020 2020  Id},.           
+0007b530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b540: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007b550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b560: 2020 2020 2020 2020 2020 2020 5f61 746f              _ato
-0007b570: 6d53 656c 6563 7469 6f6e 2e61 7070 656e  mSelection.appen
-0007b580: 6428 6174 6f6d 290a 0a20 2020 2020 2020  d(atom)..       
+0007b560: 2020 2020 2020 7b27 6e61 6d65 273a 2027        {'name': '
+0007b570: 6c61 6265 6c5f 616c 745f 6964 272c 2027  label_alt_id', '
+0007b580: 7479 7065 273a 2027 656e 756d 272c 0a20  type': 'enum',. 
 0007b590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b5a0: 2065 7863 6570 7420 4578 6365 7074 696f   except Exceptio
-0007b5b0: 6e20 6173 2065 3a0a 2020 2020 2020 2020  n as e:.        
+0007b5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007b5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b5d0: 2020 2020 6966 2073 656c 662e 5f5f 7665      if self.__ve
-0007b5e0: 7262 6f73 653a 0a20 2020 2020 2020 2020  rbose:.         
+0007b5d0: 2027 656e 756d 273a 2028 2741 2729 7d0a   'enum': ('A')}.
+0007b5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007b5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b600: 2020 2020 2020 2073 656c 662e 5f5f 6c66         self.__lf
-0007b610: 682e 7772 6974 6528 6622 2b58 706c 6f72  h.write(f"+Xplor
-0007b620: 4d52 5061 7273 6572 4c69 7374 656e 6572  MRParserListener
-0007b630: 2e65 7869 7446 6163 746f 7228 2920 2b2b  .exitFactor() ++
-0007b640: 2045 7272 6f72 2020 2d20 7b73 7472 2865   Error  - {str(e
-0007b650: 297d 2229 0a0a 2020 2020 2020 2020 2020  )}")..          
-0007b660: 2020 2020 2020 2020 2020 6966 2063 7478            if ctx
-0007b670: 2e53 6172 6f75 6e64 2829 3a0a 2020 2020  .Saround():.    
-0007b680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b690: 2020 2020 6964 656e 7469 7479 203d 206e      identity = n
-0007b6a0: 756d 7079 2e69 6465 6e74 6974 7928 332c  umpy.identity(3,
-0007b6b0: 2064 7479 7065 3d66 6c6f 6174 290a 2020   dtype=float).  
-0007b6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b6d0: 2020 2020 2020 7a65 726f 203d 206e 756d        zero = num
-0007b6e0: 7079 2e7a 6572 6f73 2833 2c20 6474 7970  py.zeros(3, dtyp
-0007b6f0: 653d 666c 6f61 7429 0a0a 2020 2020 2020  e=float)..      
+0007b600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b620: 205d 290a 0a20 2020 2020 2020 2020 2020   ])..           
+0007b630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b640: 2069 6620 6c65 6e28 5f6e 6569 6768 626f   if len(_neighbo
+0007b650: 7229 203d 3d20 303a 0a20 2020 2020 2020  r) == 0:.       
+0007b660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b670: 2020 2020 2020 2020 2063 6f6e 7469 6e75           continu
+0007b680: 650a 0a20 2020 2020 2020 2020 2020 2020  e..             
+0007b690: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0007b6a0: 6569 6768 626f 7220 3d20 5b61 746f 6d20  eighbor = [atom 
+0007b6b0: 666f 7220 6174 6f6d 2069 6e20 5f6e 6569  for atom in _nei
+0007b6c0: 6768 626f 7220 6966 206e 756d 7079 2e6c  ghbor if numpy.l
+0007b6d0: 696e 616c 672e 6e6f 726d 2874 6f4e 7041  inalg.norm(toNpA
+0007b6e0: 7272 6179 2861 746f 6d29 202d 206f 7269  rray(atom) - ori
+0007b6f0: 6769 6e29 203c 2061 726f 756e 645d 0a0a  gin) < around]..
 0007b700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b710: 2020 6f70 6572 5f6c 6973 7420 3d20 7365    oper_list = se
-0007b720: 6c66 2e5f 5f63 522e 6765 7444 6963 744c  lf.__cR.getDictL
-0007b730: 6973 7428 2770 6462 785f 7374 7275 6374  ist('pdbx_struct
-0007b740: 5f6f 7065 725f 6c69 7374 2729 0a20 2020  _oper_list').   
-0007b750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b760: 2020 2020 2069 6620 6c65 6e28 6f70 6572       if len(oper
-0007b770: 5f6c 6973 7429 203e 2030 3a0a 2020 2020  _list) > 0:.    
-0007b780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b790: 2020 2020 2020 2020 666f 7220 6f70 6572          for oper
-0007b7a0: 2069 6e20 6f70 6572 5f6c 6973 743a 0a20   in oper_list:. 
-0007b7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b7c0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0007b7d0: 6174 7269 7820 3d20 6e75 6d70 792e 6172  atrix = numpy.ar
-0007b7e0: 7261 7928 5b5b 666c 6f61 7428 6f70 6572  ray([[float(oper
-0007b7f0: 5b27 6d61 7472 6978 5b31 5d5b 315d 275d  ['matrix[1][1]']
-0007b800: 292c 2066 6c6f 6174 286f 7065 725b 276d  ), float(oper['m
-0007b810: 6174 7269 785b 315d 5b32 5d27 5d29 2c20  atrix[1][2]']), 
-0007b820: 666c 6f61 7428 6f70 6572 5b27 6d61 7472  float(oper['matr
-0007b830: 6978 5b31 5d5b 335d 275d 295d 2c0a 2020  ix[1][3]'])],.  
-0007b840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b710: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0007b720: 6174 6f6d 2069 6e20 6e65 6967 6862 6f72  atom in neighbor
+0007b730: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0007b740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b750: 2020 6465 6c20 6174 6f6d 5b27 7827 5d0a    del atom['x'].
+0007b760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b780: 6465 6c20 6174 6f6d 5b27 7927 5d0a 2020  del atom['y'].  
+0007b790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b7a0: 2020 2020 2020 2020 2020 2020 2020 6465                de
+0007b7b0: 6c20 6174 6f6d 5b27 7a27 5d0a 2020 2020  l atom['z'].    
+0007b7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b7d0: 2020 2020 2020 2020 2020 2020 5f61 746f              _ato
+0007b7e0: 6d53 656c 6563 7469 6f6e 2e61 7070 656e  mSelection.appen
+0007b7f0: 6428 6174 6f6d 290a 0a20 2020 2020 2020  d(atom)..       
+0007b800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b810: 2065 7863 6570 7420 4578 6365 7074 696f   except Exceptio
+0007b820: 6e20 6173 2065 3a0a 2020 2020 2020 2020  n as e:.        
+0007b830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b840: 2020 2020 6966 2073 656c 662e 5f5f 7665      if self.__ve
+0007b850: 7262 6f73 653a 0a20 2020 2020 2020 2020  rbose:.         
 0007b860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b870: 2020 205b 666c 6f61 7428 6f70 6572 5b27     [float(oper['
-0007b880: 6d61 7472 6978 5b32 5d5b 315d 275d 292c  matrix[2][1]']),
-0007b890: 2066 6c6f 6174 286f 7065 725b 276d 6174   float(oper['mat
-0007b8a0: 7269 785b 325d 5b32 5d27 5d29 2c20 666c  rix[2][2]']), fl
-0007b8b0: 6f61 7428 6f70 6572 5b27 6d61 7472 6978  oat(oper['matrix
-0007b8c0: 5b32 5d5b 335d 275d 295d 2c0a 2020 2020  [2][3]'])],.    
-0007b8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b870: 2020 2020 2020 2073 656c 662e 5f5f 6c66         self.__lf
+0007b880: 682e 7772 6974 6528 6622 2b58 706c 6f72  h.write(f"+Xplor
+0007b890: 4d52 5061 7273 6572 4c69 7374 656e 6572  MRParserListener
+0007b8a0: 2e65 7869 7446 6163 746f 7228 2920 2b2b  .exitFactor() ++
+0007b8b0: 2045 7272 6f72 2020 2d20 7b73 7472 2865   Error  - {str(e
+0007b8c0: 297d 2229 0a0a 2020 2020 2020 2020 2020  )}")..          
+0007b8d0: 2020 2020 2020 2020 2020 6966 2063 7478            if ctx
+0007b8e0: 2e53 6172 6f75 6e64 2829 3a0a 2020 2020  .Saround():.    
 0007b8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b900: 205b 666c 6f61 7428 6f70 6572 5b27 6d61   [float(oper['ma
-0007b910: 7472 6978 5b33 5d5b 315d 275d 292c 2066  trix[3][1]']), f
-0007b920: 6c6f 6174 286f 7065 725b 276d 6174 7269  loat(oper['matri
-0007b930: 785b 335d 5b32 5d27 5d29 2c20 666c 6f61  x[3][2]']), floa
-0007b940: 7428 6f70 6572 5b27 6d61 7472 6978 5b33  t(oper['matrix[3
-0007b950: 5d5b 335d 275d 295d 5d2c 2064 7479 7065  ][3]'])]], dtype
-0007b960: 3d66 6c6f 6174 290a 2020 2020 2020 2020  =float).        
+0007b900: 2020 2020 6964 656e 7469 7479 203d 206e      identity = n
+0007b910: 756d 7079 2e69 6465 6e74 6974 7928 332c  umpy.identity(3,
+0007b920: 2064 7479 7065 3d66 6c6f 6174 290a 2020   dtype=float).  
+0007b930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b940: 2020 2020 2020 7a65 726f 203d 206e 756d        zero = num
+0007b950: 7079 2e7a 6572 6f73 2833 2c20 6474 7970  py.zeros(3, dtyp
+0007b960: 653d 666c 6f61 7429 0a0a 2020 2020 2020  e=float)..      
 0007b970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007b980: 2020 2020 2020 2020 7665 6374 6f72 203d          vector =
-0007b990: 206e 756d 7079 2e61 7272 6179 285b 666c   numpy.array([fl
-0007b9a0: 6f61 7428 6f70 6572 5b27 7665 6374 6f72  oat(oper['vector
-0007b9b0: 5b31 5d27 5d29 2c20 666c 6f61 7428 6f70  [1]']), float(op
-0007b9c0: 6572 5b27 7665 6374 6f72 5b32 5d27 5d29  er['vector[2]'])
-0007b9d0: 2c20 666c 6f61 7428 6f70 6572 5b27 7665  , float(oper['ve
-0007b9e0: 6374 6f72 5b33 5d27 5d29 5d2c 2064 7479  ctor[3]'])], dty
-0007b9f0: 7065 3d66 6c6f 6174 290a 0a20 2020 2020  pe=float)..     
-0007ba00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ba10: 2020 2020 2020 2020 2020 2069 6620 6e75             if nu
-0007ba20: 6d70 792e 6172 7261 795f 6571 7561 6c28  mpy.array_equal(
-0007ba30: 6d61 7472 6978 2c20 6964 656e 7469 7479  matrix, identity
-0007ba40: 2920 616e 6420 6e75 6d70 792e 6172 7261  ) and numpy.arra
-0007ba50: 795f 6571 7561 6c28 7665 6374 6f72 2c20  y_equal(vector, 
-0007ba60: 7a65 726f 293a 0a20 2020 2020 2020 2020  zero):.         
-0007ba70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ba80: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
-0007ba90: 6e75 650a 0a20 2020 2020 2020 2020 2020  nue..           
-0007baa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bab0: 2020 2020 2069 6e76 5f6d 6174 7269 7820       inv_matrix 
-0007bac0: 3d20 6e75 6d70 792e 6c69 6e61 6c67 2e69  = numpy.linalg.i
-0007bad0: 6e76 286d 6174 7269 7829 0a0a 2020 2020  nv(matrix)..    
-0007bae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007baf0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0007bb00: 5f61 746f 6d20 696e 2073 656c 662e 6661  _atom in self.fa
-0007bb10: 6374 6f72 5b27 6174 6f6d 5f73 656c 6563  ctor['atom_selec
-0007bb20: 7469 6f6e 275d 3a0a 0a20 2020 2020 2020  tion']:..       
-0007bb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bb40: 2020 2020 2020 2020 2020 2020 2074 7279               try
-0007bb50: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
+0007b980: 2020 6f70 6572 5f6c 6973 7420 3d20 7365    oper_list = se
+0007b990: 6c66 2e5f 5f63 522e 6765 7444 6963 744c  lf.__cR.getDictL
+0007b9a0: 6973 7428 2770 6462 785f 7374 7275 6374  ist('pdbx_struct
+0007b9b0: 5f6f 7065 725f 6c69 7374 2729 0a20 2020  _oper_list').   
+0007b9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007b9d0: 2020 2020 2069 6620 6c65 6e28 6f70 6572       if len(oper
+0007b9e0: 5f6c 6973 7429 203e 2030 3a0a 2020 2020  _list) > 0:.    
+0007b9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ba00: 2020 2020 2020 2020 666f 7220 6f70 6572          for oper
+0007ba10: 2069 6e20 6f70 6572 5f6c 6973 743a 0a20   in oper_list:. 
+0007ba20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ba30: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0007ba40: 6174 7269 7820 3d20 6e75 6d70 792e 6172  atrix = numpy.ar
+0007ba50: 7261 7928 5b5b 666c 6f61 7428 6f70 6572  ray([[float(oper
+0007ba60: 5b27 6d61 7472 6978 5b31 5d5b 315d 275d  ['matrix[1][1]']
+0007ba70: 292c 2066 6c6f 6174 286f 7065 725b 276d  ), float(oper['m
+0007ba80: 6174 7269 785b 315d 5b32 5d27 5d29 2c20  atrix[1][2]']), 
+0007ba90: 666c 6f61 7428 6f70 6572 5b27 6d61 7472  float(oper['matr
+0007baa0: 6978 5b31 5d5b 335d 275d 295d 2c0a 2020  ix[1][3]'])],.  
+0007bab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007bac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007bad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007bae0: 2020 205b 666c 6f61 7428 6f70 6572 5b27     [float(oper['
+0007baf0: 6d61 7472 6978 5b32 5d5b 315d 275d 292c  matrix[2][1]']),
+0007bb00: 2066 6c6f 6174 286f 7065 725b 276d 6174   float(oper['mat
+0007bb10: 7269 785b 325d 5b32 5d27 5d29 2c20 666c  rix[2][2]']), fl
+0007bb20: 6f61 7428 6f70 6572 5b27 6d61 7472 6978  oat(oper['matrix
+0007bb30: 5b32 5d5b 335d 275d 295d 2c0a 2020 2020  [2][3]'])],.    
+0007bb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007bb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007bb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bb70: 2020 2020 2020 2020 2020 205f 6f72 6967             _orig
-0007bb80: 696e 203d 5c0a 2020 2020 2020 2020 2020  in =\.          
-0007bb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bbb0: 2020 7365 6c66 2e5f 5f63 522e 6765 7444    self.__cR.getD
-0007bbc0: 6963 744c 6973 7457 6974 6846 696c 7465  ictListWithFilte
-0007bbd0: 7228 2761 746f 6d5f 7369 7465 272c 0a20  r('atom_site',. 
+0007bb70: 205b 666c 6f61 7428 6f70 6572 5b27 6d61   [float(oper['ma
+0007bb80: 7472 6978 5b33 5d5b 315d 275d 292c 2066  trix[3][1]']), f
+0007bb90: 6c6f 6174 286f 7065 725b 276d 6174 7269  loat(oper['matri
+0007bba0: 785b 335d 5b32 5d27 5d29 2c20 666c 6f61  x[3][2]']), floa
+0007bbb0: 7428 6f70 6572 5b27 6d61 7472 6978 5b33  t(oper['matrix[3
+0007bbc0: 5d5b 335d 275d 295d 5d2c 2064 7479 7065  ][3]'])]], dtype
+0007bbd0: 3d66 6c6f 6174 290a 2020 2020 2020 2020  =float).        
 0007bbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bc20: 2020 2020 2020 2020 2020 2043 4152 544e             CARTN
-0007bc30: 5f44 4154 415f 4954 454d 532c 0a20 2020  _DATA_ITEMS,.   
-0007bc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bc60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007bbf0: 2020 2020 2020 2020 7665 6374 6f72 203d          vector =
+0007bc00: 206e 756d 7079 2e61 7272 6179 285b 666c   numpy.array([fl
+0007bc10: 6f61 7428 6f70 6572 5b27 7665 6374 6f72  oat(oper['vector
+0007bc20: 5b31 5d27 5d29 2c20 666c 6f61 7428 6f70  [1]']), float(op
+0007bc30: 6572 5b27 7665 6374 6f72 5b32 5d27 5d29  er['vector[2]'])
+0007bc40: 2c20 666c 6f61 7428 6f70 6572 5b27 7665  , float(oper['ve
+0007bc50: 6374 6f72 5b33 5d27 5d29 5d2c 2064 7479  ctor[3]'])], dty
+0007bc60: 7065 3d66 6c6f 6174 290a 0a20 2020 2020  pe=float)..     
 0007bc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bc80: 2020 2020 2020 2020 205b 7b27 6e61 6d65           [{'name
-0007bc90: 273a 2073 656c 662e 5f5f 6175 7468 4173  ': self.__authAs
-0007bca0: 796d 4964 2c20 2774 7970 6527 3a20 2773  ymId, 'type': 's
-0007bcb0: 7472 272c 2027 7661 6c75 6527 3a20 5f61  tr', 'value': _a
-0007bcc0: 746f 6d5b 2763 6861 696e 5f69 6427 5d7d  tom['chain_id']}
-0007bcd0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0007bc80: 2020 2020 2020 2020 2020 2069 6620 6e75             if nu
+0007bc90: 6d70 792e 6172 7261 795f 6571 7561 6c28  mpy.array_equal(
+0007bca0: 6d61 7472 6978 2c20 6964 656e 7469 7479  matrix, identity
+0007bcb0: 2920 616e 6420 6e75 6d70 792e 6172 7261  ) and numpy.arra
+0007bcc0: 795f 6571 7561 6c28 7665 6374 6f72 2c20  y_equal(vector, 
+0007bcd0: 7a65 726f 293a 0a20 2020 2020 2020 2020  zero):.         
 0007bce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bd10: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-0007bd20: 276e 616d 6527 3a20 7365 6c66 2e5f 5f61  'name': self.__a
-0007bd30: 7574 6853 6571 4964 2c20 2774 7970 6527  uthSeqId, 'type'
-0007bd40: 3a20 2769 6e74 272c 2027 7661 6c75 6527  : 'int', 'value'
-0007bd50: 3a20 5f61 746f 6d5b 2773 6571 5f69 6427  : _atom['seq_id'
-0007bd60: 5d7d 2c0a 2020 2020 2020 2020 2020 2020  ]},.            
-0007bd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007bcf0: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
+0007bd00: 6e75 650a 0a20 2020 2020 2020 2020 2020  nue..           
+0007bd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007bd20: 2020 2020 2069 6e76 5f6d 6174 7269 7820       inv_matrix 
+0007bd30: 3d20 6e75 6d70 792e 6c69 6e61 6c67 2e69  = numpy.linalg.i
+0007bd40: 6e76 286d 6174 7269 7829 0a0a 2020 2020  nv(matrix)..    
+0007bd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007bd60: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0007bd70: 5f61 746f 6d20 696e 2073 656c 662e 6661  _atom in self.fa
+0007bd80: 6374 6f72 5b27 6174 6f6d 5f73 656c 6563  ctor['atom_selec
+0007bd90: 7469 6f6e 275d 3a0a 0a20 2020 2020 2020  tion']:..       
 0007bda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bdb0: 207b 276e 616d 6527 3a20 7365 6c66 2e5f   {'name': self._
-0007bdc0: 5f61 7574 6841 746f 6d49 642c 2027 7479  _authAtomId, 'ty
-0007bdd0: 7065 273a 2027 7374 7227 2c20 2776 616c  pe': 'str', 'val
-0007bde0: 7565 273a 205f 6174 6f6d 5b27 6174 6f6d  ue': _atom['atom
-0007bdf0: 5f69 6427 5d7d 2c0a 2020 2020 2020 2020  _id']},.        
+0007bdb0: 2020 2020 2020 2020 2020 2020 2074 7279               try
+0007bdc0: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
+0007bdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007bde0: 2020 2020 2020 2020 2020 205f 6f72 6967             _orig
+0007bdf0: 696e 203d 5c0a 2020 2020 2020 2020 2020  in =\.          
 0007be00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007be10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007be20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007be30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007be40: 2020 2020 207b 276e 616d 6527 3a20 7365       {'name': se
-0007be50: 6c66 2e5f 5f6d 6f64 656c 4e75 6d4e 616d  lf.__modelNumNam
-0007be60: 652c 2027 7479 7065 273a 2027 696e 7427  e, 'type': 'int'
-0007be70: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0007be20: 2020 7365 6c66 2e5f 5f63 522e 6765 7444    self.__cR.getD
+0007be30: 6963 744c 6973 7457 6974 6846 696c 7465  ictListWithFilte
+0007be40: 7228 2761 746f 6d5f 7369 7465 272c 0a20  r('atom_site',. 
+0007be50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007be60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007be70: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007be80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007be90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007be90: 2020 2020 2020 2020 2020 2043 4152 544e             CARTN
+0007bea0: 5f44 4154 415f 4954 454d 532c 0a20 2020  _DATA_ITEMS,.   
 0007beb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bec0: 2776 616c 7565 273a 2073 656c 662e 5f5f  'value': self.__
-0007bed0: 7265 7072 6573 656e 7461 7469 7665 4d6f  representativeMo
-0007bee0: 6465 6c49 647d 2c0a 2020 2020 2020 2020  delId},.        
-0007bef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bf00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bf10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bf20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bf30: 2020 2020 207b 276e 616d 6527 3a20 276c       {'name': 'l
-0007bf40: 6162 656c 5f61 6c74 5f69 6427 2c20 2774  abel_alt_id', 't
-0007bf50: 7970 6527 3a20 2765 6e75 6d27 2c0a 2020  ype': 'enum',.  
+0007bec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007bed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007bee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007bef0: 2020 2020 2020 2020 205b 7b27 6e61 6d65           [{'name
+0007bf00: 273a 2073 656c 662e 5f5f 6175 7468 4173  ': self.__authAs
+0007bf10: 796d 4964 2c20 2774 7970 6527 3a20 2773  ymId, 'type': 's
+0007bf20: 7472 272c 2027 7661 6c75 6527 3a20 5f61  tr', 'value': _a
+0007bf30: 746f 6d5b 2763 6861 696e 5f69 6427 5d7d  tom['chain_id']}
+0007bf40: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0007bf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007bf60: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007bf70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bf80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bf90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bfa0: 2020 2020 2020 2020 2020 2020 2765 6e75              'enu
-0007bfb0: 6d27 3a20 2827 4127 297d 0a20 2020 2020  m': ('A')}.     
-0007bfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007bfd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007bf80: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+0007bf90: 276e 616d 6527 3a20 7365 6c66 2e5f 5f61  'name': self.__a
+0007bfa0: 7574 6853 6571 4964 2c20 2774 7970 6527  uthSeqId, 'type'
+0007bfb0: 3a20 2769 6e74 272c 2027 7661 6c75 6527  : 'int', 'value'
+0007bfc0: 3a20 5f61 746f 6d5b 2773 6571 5f69 6427  : _atom['seq_id'
+0007bfd0: 5d7d 2c0a 2020 2020 2020 2020 2020 2020  ]},.            
 0007bfe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007bff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c000: 2020 2020 2020 2020 5d29 0a0a 2020 2020          ])..    
+0007c000: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c030: 2020 2020 6966 206c 656e 285f 6f72 6967      if len(_orig
-0007c040: 696e 2920 213d 2031 3a0a 2020 2020 2020  in) != 1:.      
-0007c050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c070: 2020 2020 2020 636f 6e74 696e 7565 0a0a        continue..
+0007c020: 207b 276e 616d 6527 3a20 7365 6c66 2e5f   {'name': self._
+0007c030: 5f61 7574 6841 746f 6d49 642c 2027 7479  _authAtomId, 'ty
+0007c040: 7065 273a 2027 7374 7227 2c20 2776 616c  pe': 'str', 'val
+0007c050: 7565 273a 205f 6174 6f6d 5b27 6174 6f6d  ue': _atom['atom
+0007c060: 5f69 6427 5d7d 2c0a 2020 2020 2020 2020  _id']},.        
+0007c070: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c080: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c0a0: 2020 2020 2020 2020 6f72 6967 696e 203d          origin =
-0007c0b0: 206e 756d 7079 2e64 6f74 2869 6e76 5f6d   numpy.dot(inv_m
-0007c0c0: 6174 7269 782c 206e 756d 7079 2e73 7562  atrix, numpy.sub
-0007c0d0: 7472 6163 7428 746f 4e70 4172 7261 7928  tract(toNpArray(
-0007c0e0: 5f6f 7269 6769 6e5b 305d 292c 2076 6563  _origin[0]), vec
-0007c0f0: 746f 7229 290a 0a20 2020 2020 2020 2020  tor))..         
+0007c0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c0b0: 2020 2020 207b 276e 616d 6527 3a20 7365       {'name': se
+0007c0c0: 6c66 2e5f 5f6d 6f64 656c 4e75 6d4e 616d  lf.__modelNumNam
+0007c0d0: 652c 2027 7479 7065 273a 2027 696e 7427  e, 'type': 'int'
+0007c0e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0007c0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c110: 2020 2020 2020 2020 2020 2020 2020 205f                 _
-0007c120: 6e65 6967 6862 6f72 203d 5c0a 2020 2020  neighbor =\.    
-0007c130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c150: 2020 2020 2020 2020 7365 6c66 2e5f 5f63          self.__c
-0007c160: 522e 6765 7444 6963 744c 6973 7457 6974  R.getDictListWit
-0007c170: 6846 696c 7465 7228 2761 746f 6d5f 7369  hFilter('atom_si
-0007c180: 7465 272c 0a20 2020 2020 2020 2020 2020  te',.           
+0007c110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c130: 2776 616c 7565 273a 2073 656c 662e 5f5f  'value': self.__
+0007c140: 7265 7072 6573 656e 7461 7469 7665 4d6f  representativeMo
+0007c150: 6465 6c49 647d 2c0a 2020 2020 2020 2020  delId},.        
+0007c160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c180: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c1d0: 2041 5554 485f 4154 4f4d 5f43 4152 544e   AUTH_ATOM_CARTN
-0007c1e0: 5f44 4154 415f 4954 454d 532c 0a20 2020  _DATA_ITEMS,.   
+0007c1a0: 2020 2020 207b 276e 616d 6527 3a20 276c       {'name': 'l
+0007c1b0: 6162 656c 5f61 6c74 5f69 6427 2c20 2774  abel_alt_id', 't
+0007c1c0: 7970 6527 3a20 2765 6e75 6d27 2c0a 2020  ype': 'enum',.  
+0007c1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c230: 2020 2020 2020 2020 205b 7b27 6e61 6d65           [{'name
-0007c240: 273a 2027 4361 7274 6e5f 7827 2c20 2774  ': 'Cartn_x', 't
-0007c250: 7970 6527 3a20 2772 616e 6765 2d66 6c6f  ype': 'range-flo
-0007c260: 6174 272c 0a20 2020 2020 2020 2020 2020  at',.           
-0007c270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c210: 2020 2020 2020 2020 2020 2020 2765 6e75              'enu
+0007c220: 6d27 3a20 2827 4127 297d 0a20 2020 2020  m': ('A')}.     
+0007c230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c270: 2020 2020 2020 2020 5d29 0a0a 2020 2020          ])..    
 0007c280: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c2b0: 2020 2027 7261 6e67 6527 3a20 7b27 6d69     'range': {'mi
-0007c2c0: 6e5f 6578 636c 7573 6976 6527 3a20 286f  n_exclusive': (o
-0007c2d0: 7269 6769 6e5b 305d 202d 2061 726f 756e  rigin[0] - aroun
-0007c2e0: 6429 2c0a 2020 2020 2020 2020 2020 2020  d),.            
+0007c2a0: 2020 2020 6966 206c 656e 285f 6f72 6967      if len(_orig
+0007c2b0: 696e 2920 213d 2031 3a0a 2020 2020 2020  in) != 1:.      
+0007c2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c2e0: 2020 2020 2020 636f 6e74 696e 7565 0a0a        continue..
 0007c2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c330: 2020 2020 2020 2020 2020 2020 276d 6178              'max
-0007c340: 5f65 7863 6c75 7369 7665 273a 2028 6f72  _exclusive': (or
-0007c350: 6967 696e 5b30 5d20 2b20 6172 6f75 6e64  igin[0] + around
-0007c360: 297d 7d2c 0a20 2020 2020 2020 2020 2020  )}},.           
+0007c310: 2020 2020 2020 2020 6f72 6967 696e 203d          origin =
+0007c320: 206e 756d 7079 2e64 6f74 2869 6e76 5f6d   numpy.dot(inv_m
+0007c330: 6174 7269 782c 206e 756d 7079 2e73 7562  atrix, numpy.sub
+0007c340: 7472 6163 7428 746f 4e70 4172 7261 7928  tract(toNpArray(
+0007c350: 5f6f 7269 6769 6e5b 305d 292c 2076 6563  _origin[0]), vec
+0007c360: 746f 7229 290a 0a20 2020 2020 2020 2020  tor))..         
 0007c370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c380: 2020 2020 2020 2020 2020 2020 2020 205f                 _
+0007c390: 6e65 6967 6862 6f72 203d 5c0a 2020 2020  neighbor =\.    
 0007c3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c3b0: 2020 7b27 6e61 6d65 273a 2027 4361 7274    {'name': 'Cart
-0007c3c0: 6e5f 7927 2c20 2774 7970 6527 3a20 2772  n_y', 'type': 'r
-0007c3d0: 616e 6765 2d66 6c6f 6174 272c 0a20 2020  ange-float',.   
-0007c3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c3c0: 2020 2020 2020 2020 7365 6c66 2e5f 5f63          self.__c
+0007c3d0: 522e 6765 7444 6963 744c 6973 7457 6974  R.getDictListWit
+0007c3e0: 6846 696c 7465 7228 2761 746f 6d5f 7369  hFilter('atom_si
+0007c3f0: 7465 272c 0a20 2020 2020 2020 2020 2020  te',.           
 0007c400: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c420: 2020 2020 2020 2020 2020 2027 7261 6e67             'rang
-0007c430: 6527 3a20 7b27 6d69 6e5f 6578 636c 7573  e': {'min_exclus
-0007c440: 6976 6527 3a20 286f 7269 6769 6e5b 315d  ive': (origin[1]
-0007c450: 202d 2061 726f 756e 6429 2c0a 2020 2020   - around),.    
+0007c420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c440: 2041 5554 485f 4154 4f4d 5f43 4152 544e   AUTH_ATOM_CARTN
+0007c450: 5f44 4154 415f 4954 454d 532c 0a20 2020  _DATA_ITEMS,.   
 0007c460: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c470: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c480: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c4b0: 2020 2020 276d 6178 5f65 7863 6c75 7369      'max_exclusi
-0007c4c0: 7665 273a 2028 6f72 6967 696e 5b31 5d20  ve': (origin[1] 
-0007c4d0: 2b20 6172 6f75 6e64 297d 7d2c 0a20 2020  + around)}},.   
+0007c4a0: 2020 2020 2020 2020 205b 7b27 6e61 6d65           [{'name
+0007c4b0: 273a 2027 4361 7274 6e5f 7827 2c20 2774  ': 'Cartn_x', 't
+0007c4c0: 7970 6527 3a20 2772 616e 6765 2d66 6c6f  ype': 'range-flo
+0007c4d0: 6174 272c 0a20 2020 2020 2020 2020 2020  at',.           
 0007c4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c500: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c520: 2020 2020 2020 2020 2020 7b27 6e61 6d65            {'name
-0007c530: 273a 2027 4361 7274 6e5f 7a27 2c20 2774  ': 'Cartn_z', 't
-0007c540: 7970 6527 3a20 2772 616e 6765 2d66 6c6f  ype': 'range-flo
-0007c550: 6174 272c 0a20 2020 2020 2020 2020 2020  at',.           
+0007c520: 2020 2027 7261 6e67 6527 3a20 7b27 6d69     'range': {'mi
+0007c530: 6e5f 6578 636c 7573 6976 6527 3a20 286f  n_exclusive': (o
+0007c540: 7269 6769 6e5b 305d 202d 2061 726f 756e  rigin[0] - aroun
+0007c550: 6429 2c0a 2020 2020 2020 2020 2020 2020  d),.            
 0007c560: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c570: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c580: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c5a0: 2020 2027 7261 6e67 6527 3a20 7b27 6d69     'range': {'mi
-0007c5b0: 6e5f 6578 636c 7573 6976 6527 3a20 286f  n_exclusive': (o
-0007c5c0: 7269 6769 6e5b 325d 202d 2061 726f 756e  rigin[2] - aroun
-0007c5d0: 6429 2c0a 2020 2020 2020 2020 2020 2020  d),.            
+0007c5a0: 2020 2020 2020 2020 2020 2020 276d 6178              'max
+0007c5b0: 5f65 7863 6c75 7369 7665 273a 2028 6f72  _exclusive': (or
+0007c5c0: 6967 696e 5b30 5d20 2b20 6172 6f75 6e64  igin[0] + around
+0007c5d0: 297d 7d2c 0a20 2020 2020 2020 2020 2020  )}},.           
 0007c5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c600: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c620: 2020 2020 2020 2020 2020 2020 276d 6178              'max
-0007c630: 5f65 7863 6c75 7369 7665 273a 2028 6f72  _exclusive': (or
-0007c640: 6967 696e 5b32 5d20 2b20 6172 6f75 6e64  igin[2] + around
-0007c650: 297d 7d2c 0a20 2020 2020 2020 2020 2020  )}},.           
+0007c620: 2020 7b27 6e61 6d65 273a 2027 4361 7274    {'name': 'Cart
+0007c630: 6e5f 7927 2c20 2774 7970 6527 3a20 2772  n_y', 'type': 'r
+0007c640: 616e 6765 2d66 6c6f 6174 272c 0a20 2020  ange-float',.   
+0007c650: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c660: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c670: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c6a0: 2020 7b27 6e61 6d65 273a 2073 656c 662e    {'name': self.
-0007c6b0: 5f5f 6d6f 6465 6c4e 756d 4e61 6d65 2c20  __modelNumName, 
-0007c6c0: 2774 7970 6527 3a20 2769 6e74 272c 0a20  'type': 'int',. 
+0007c690: 2020 2020 2020 2020 2020 2027 7261 6e67             'rang
+0007c6a0: 6527 3a20 7b27 6d69 6e5f 6578 636c 7573  e': {'min_exclus
+0007c6b0: 6976 6527 3a20 286f 7269 6769 6e5b 315d  ive': (origin[1]
+0007c6c0: 202d 2061 726f 756e 6429 2c0a 2020 2020   - around),.    
 0007c6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c710: 2020 2020 2020 2020 2020 2020 2027 7661               'va
-0007c720: 6c75 6527 3a20 7365 6c66 2e5f 5f72 6570  lue': self.__rep
-0007c730: 7265 7365 6e74 6174 6976 654d 6f64 656c  resentativeModel
-0007c740: 4964 7d2c 0a20 2020 2020 2020 2020 2020  Id},.           
+0007c710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c720: 2020 2020 276d 6178 5f65 7863 6c75 7369      'max_exclusi
+0007c730: 7665 273a 2028 6f72 6967 696e 5b31 5d20  ve': (origin[1] 
+0007c740: 2b20 6172 6f75 6e64 297d 7d2c 0a20 2020  + around)}},.   
 0007c750: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c760: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c770: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c790: 2020 7b27 6e61 6d65 273a 2027 6c61 6265    {'name': 'labe
-0007c7a0: 6c5f 616c 745f 6964 272c 2027 7479 7065  l_alt_id', 'type
-0007c7b0: 273a 2027 656e 756d 272c 0a20 2020 2020  ': 'enum',.     
-0007c7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c790: 2020 2020 2020 2020 2020 7b27 6e61 6d65            {'name
+0007c7a0: 273a 2027 4361 7274 6e5f 7a27 2c20 2774  ': 'Cartn_z', 't
+0007c7b0: 7970 6527 3a20 2772 616e 6765 2d66 6c6f  ype': 'range-flo
+0007c7c0: 6174 272c 0a20 2020 2020 2020 2020 2020  at',.           
 0007c7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c800: 2020 2020 2020 2020 2027 656e 756d 273a           'enum':
-0007c810: 2028 2741 2729 7d0a 2020 2020 2020 2020   ('A')}.        
-0007c820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c810: 2020 2027 7261 6e67 6527 3a20 7b27 6d69     'range': {'mi
+0007c820: 6e5f 6578 636c 7573 6976 6527 3a20 286f  n_exclusive': (o
+0007c830: 7269 6769 6e5b 325d 202d 2061 726f 756e  rigin[2] - aroun
+0007c840: 6429 2c0a 2020 2020 2020 2020 2020 2020  d),.            
 0007c850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c860: 2020 2020 205d 290a 0a20 2020 2020 2020       ])..       
+0007c860: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c870: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c890: 2069 6620 6c65 6e28 5f6e 6569 6768 626f   if len(_neighbo
-0007c8a0: 7229 203d 3d20 303a 0a20 2020 2020 2020  r) == 0:.       
-0007c8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c8d0: 2020 2020 2063 6f6e 7469 6e75 650a 0a20       continue.. 
+0007c890: 2020 2020 2020 2020 2020 2020 276d 6178              'max
+0007c8a0: 5f65 7863 6c75 7369 7665 273a 2028 6f72  _exclusive': (or
+0007c8b0: 6967 696e 5b32 5d20 2b20 6172 6f75 6e64  igin[2] + around
+0007c8c0: 297d 7d2c 0a20 2020 2020 2020 2020 2020  )}},.           
+0007c8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c900: 2020 2020 2020 206e 6569 6768 626f 7220         neighbor 
-0007c910: 3d20 5b61 746f 6d20 666f 7220 6174 6f6d  = [atom for atom
-0007c920: 2069 6e20 5f6e 6569 6768 626f 7220 6966   in _neighbor if
-0007c930: 206e 756d 7079 2e6c 696e 616c 672e 6e6f   numpy.linalg.no
-0007c940: 726d 2874 6f4e 7041 7272 6179 2861 746f  rm(toNpArray(ato
-0007c950: 6d29 202d 206f 7269 6769 6e29 203c 2061  m) - origin) < a
-0007c960: 726f 756e 645d 0a0a 2020 2020 2020 2020  round]..        
+0007c900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c910: 2020 7b27 6e61 6d65 273a 2073 656c 662e    {'name': self.
+0007c920: 5f5f 6d6f 6465 6c4e 756d 4e61 6d65 2c20  __modelNumName, 
+0007c930: 2774 7970 6527 3a20 2769 6e74 272c 0a20  'type': 'int',. 
+0007c940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c960: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c990: 666f 7220 6174 6f6d 2069 6e20 6e65 6967  for atom in neig
-0007c9a0: 6862 6f72 3a0a 2020 2020 2020 2020 2020  hbor:.          
-0007c9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007c980: 2020 2020 2020 2020 2020 2020 2027 7661               'va
+0007c990: 6c75 6527 3a20 7365 6c66 2e5f 5f72 6570  lue': self.__rep
+0007c9a0: 7265 7365 6e74 6174 6976 654d 6f64 656c  resentativeModel
+0007c9b0: 4964 7d2c 0a20 2020 2020 2020 2020 2020  Id},.           
 0007c9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007c9d0: 2020 6465 6c20 6174 6f6d 5b27 7827 5d0a    del atom['x'].
+0007c9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007c9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ca00: 2020 2020 2020 2020 2020 2020 6465 6c20              del 
-0007ca10: 6174 6f6d 5b27 7927 5d0a 2020 2020 2020  atom['y'].      
-0007ca20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ca00: 2020 7b27 6e61 6d65 273a 2027 6c61 6265    {'name': 'labe
+0007ca10: 6c5f 616c 745f 6964 272c 2027 7479 7065  l_alt_id', 'type
+0007ca20: 273a 2027 656e 756d 272c 0a20 2020 2020  ': 'enum',.     
 0007ca30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ca40: 2020 2020 2020 6465 6c20 6174 6f6d 5b27        del atom['
-0007ca50: 7a27 5d0a 2020 2020 2020 2020 2020 2020  z'].            
+0007ca40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ca50: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007ca60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ca70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ca80: 5f61 746f 6d53 656c 6563 7469 6f6e 2e61  _atomSelection.a
-0007ca90: 7070 656e 6428 6174 6f6d 290a 0a20 2020  ppend(atom)..   
+0007ca70: 2020 2020 2020 2020 2027 656e 756d 273a           'enum':
+0007ca80: 2028 2741 2729 7d0a 2020 2020 2020 2020   ('A')}.        
+0007ca90: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007caa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007cab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007cac0: 2065 7863 6570 7420 4578 6365 7074 696f   except Exceptio
-0007cad0: 6e20 6173 2065 3a0a 2020 2020 2020 2020  n as e:.        
+0007cac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007cad0: 2020 2020 205d 290a 0a20 2020 2020 2020       ])..       
 0007cae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007caf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007cb00: 6966 2073 656c 662e 5f5f 7665 7262 6f73  if self.__verbos
-0007cb10: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0007cb00: 2069 6620 6c65 6e28 5f6e 6569 6768 626f   if len(_neighbo
+0007cb10: 7229 203d 3d20 303a 0a20 2020 2020 2020  r) == 0:.       
 0007cb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007cb30: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0007cb40: 656c 662e 5f5f 6c66 682e 7772 6974 6528  elf.__lfh.write(
-0007cb50: 6622 2b58 706c 6f72 4d52 5061 7273 6572  f"+XplorMRParser
-0007cb60: 4c69 7374 656e 6572 2e65 7869 7446 6163  Listener.exitFac
-0007cb70: 746f 7228 2920 2b2b 2045 7272 6f72 2020  tor() ++ Error  
-0007cb80: 2d20 7b73 7472 2865 297d 2229 0a0a 2020  - {str(e)}")..  
-0007cb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007cba0: 2020 6966 206c 656e 2873 656c 662e 6661    if len(self.fa
-0007cbb0: 6374 6f72 5b27 6174 6f6d 5f73 656c 6563  ctor['atom_selec
-0007cbc0: 7469 6f6e 275d 2920 3e20 303a 0a20 2020  tion']) > 0:.   
-0007cbd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007cbe0: 2020 2020 2073 656c 662e 6661 6374 6f72       self.factor
-0007cbf0: 5b27 6174 6f6d 5f73 656c 6563 7469 6f6e  ['atom_selection
-0007cc00: 275d 203d 205b 6469 6374 2873 2920 666f  '] = [dict(s) fo
-0007cc10: 7220 7320 696e 2073 6574 2866 726f 7a65  r s in set(froze
-0007cc20: 6e73 6574 2861 746f 6d2e 6974 656d 7328  nset(atom.items(
-0007cc30: 2929 2066 6f72 2061 746f 6d20 696e 205f  )) for atom in _
-0007cc40: 6174 6f6d 5365 6c65 6374 696f 6e29 5d0a  atomSelection)].
-0007cc50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0007cc60: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
-0007cc70: 7365 6c66 2e66 6163 746f 725b 2761 746f  self.factor['ato
-0007cc80: 6d5f 7365 6c65 6374 696f 6e27 5d29 203d  m_selection']) =
-0007cc90: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
+0007cb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007cb40: 2020 2020 2063 6f6e 7469 6e75 650a 0a20       continue.. 
+0007cb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007cb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007cb70: 2020 2020 2020 206e 6569 6768 626f 7220         neighbor 
+0007cb80: 3d20 5b61 746f 6d20 666f 7220 6174 6f6d  = [atom for atom
+0007cb90: 2069 6e20 5f6e 6569 6768 626f 7220 6966   in _neighbor if
+0007cba0: 206e 756d 7079 2e6c 696e 616c 672e 6e6f   numpy.linalg.no
+0007cbb0: 726d 2874 6f4e 7041 7272 6179 2861 746f  rm(toNpArray(ato
+0007cbc0: 6d29 202d 206f 7269 6769 6e29 203c 2061  m) - origin) < a
+0007cbd0: 726f 756e 645d 0a0a 2020 2020 2020 2020  round]..        
+0007cbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007cbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007cc00: 666f 7220 6174 6f6d 2069 6e20 6e65 6967  for atom in neig
+0007cc10: 6862 6f72 3a0a 2020 2020 2020 2020 2020  hbor:.          
+0007cc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007cc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007cc40: 2020 6465 6c20 6174 6f6d 5b27 7827 5d0a    del atom['x'].
+0007cc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007cc60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007cc70: 2020 2020 2020 2020 2020 2020 6465 6c20              del 
+0007cc80: 6174 6f6d 5b27 7927 5d0a 2020 2020 2020  atom['y'].      
+0007cc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007cca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ccb0: 2073 656c 662e 6661 6374 6f72 5b27 6174   self.factor['at
-0007ccc0: 6f6d 5f69 6427 5d20 3d20 5b4e 6f6e 655d  om_id'] = [None]
-0007ccd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0007cce0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0007ccf0: 662e 5f5f 662e 6170 7065 6e64 2866 225b  f.__f.append(f"[
-0007cd00: 496e 7375 6666 6963 6965 6e74 2061 746f  Insufficient ato
-0007cd10: 6d20 7365 6c65 6374 696f 6e5d 207b 7365  m selection] {se
-0007cd20: 6c66 2e5f 5f67 6574 4375 7272 656e 7452  lf.__getCurrentR
-0007cd30: 6573 7472 6169 6e74 2829 7d22 0a20 2020  estraint()}".   
-0007cd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ccb0: 2020 2020 2020 6465 6c20 6174 6f6d 5b27        del atom['
+0007ccc0: 7a27 5d0a 2020 2020 2020 2020 2020 2020  z'].            
+0007ccd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007cce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ccf0: 5f61 746f 6d53 656c 6563 7469 6f6e 2e61  _atomSelection.a
+0007cd00: 7070 656e 6428 6174 6f6d 290a 0a20 2020  ppend(atom)..   
+0007cd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007cd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007cd30: 2065 7863 6570 7420 4578 6365 7074 696f   except Exceptio
+0007cd40: 6e20 6173 2065 3a0a 2020 2020 2020 2020  n as e:.        
 0007cd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007cd60: 2020 2020 2020 2020 2066 2254 6865 207b           f"The {
-0007cd70: 636c 6175 7365 4e61 6d65 2172 7d20 636c  clauseName!r} cl
-0007cd80: 6175 7365 2068 6173 206e 6f20 6566 6665  ause has no effe
-0007cd90: 6374 2e22 290a 0a20 2020 2020 2020 2020  ct.")..         
-0007cda0: 2020 2065 6c69 6620 6374 782e 4174 6f6d     elif ctx.Atom
-0007cdb0: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-0007cdc0: 2020 2020 6966 2073 656c 662e 5f5f 7365      if self.__se
-0007cdd0: 6c5f 6578 7072 5f64 6562 7567 3a0a 2020  l_expr_debug:.  
-0007cde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007cdf0: 2020 7072 696e 7428 2220 2022 202a 2073    print("  " * s
-0007ce00: 656c 662e 6465 7074 6820 2b20 222d 2d3e  elf.depth + "-->
-0007ce10: 2061 746f 6d22 290a 2020 2020 2020 2020   atom").        
-0007ce20: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
-0007ce30: 656c 662e 5f5f 6861 7350 6f6c 7953 6571  elf.__hasPolySeq
-0007ce40: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0007ce50: 2020 2020 2020 7265 7475 726e 0a20 2020        return.   
-0007ce60: 2020 2020 2020 2020 2020 2020 2073 696d               sim
-0007ce70: 706c 654e 616d 6549 6e64 6578 203d 2073  pleNameIndex = s
-0007ce80: 696d 706c 654e 616d 6573 496e 6465 7820  impleNamesIndex 
-0007ce90: 3d20 3020 2023 2074 6865 7365 2069 6e64  = 0  # these ind
-0007cea0: 6963 6573 2061 7265 206e 6563 6573 7361  ices are necessa
-0007ceb0: 7279 2074 6f20 6465 616c 2077 6974 6820  ry to deal with 
-0007cec0: 6d69 7869 6e67 2063 6173 6520 6f66 2027  mixing case of '
-0007ced0: 5369 6d70 6c65 5f6e 616d 6527 2061 6e64  Simple_name' and
-0007cee0: 2027 5369 6d70 6c65 5f6e 616d 6573 270a   'Simple_names'.
-0007cef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007cf00: 6966 2063 7478 2e53 696d 706c 655f 6e61  if ctx.Simple_na
-0007cf10: 6d65 2830 293a 0a20 2020 2020 2020 2020  me(0):.         
-0007cf20: 2020 2020 2020 2020 2020 2063 6861 696e             chain
-0007cf30: 4964 203d 2073 7472 2863 7478 2e53 696d  Id = str(ctx.Sim
-0007cf40: 706c 655f 6e61 6d65 2830 2929 0a20 2020  ple_name(0)).   
-0007cf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007cf60: 2073 656c 662e 6661 6374 6f72 5b27 6368   self.factor['ch
-0007cf70: 6169 6e5f 6964 275d 203d 205b 7073 5b27  ain_id'] = [ps['
-0007cf80: 6175 7468 5f63 6861 696e 5f69 6427 5d20  auth_chain_id'] 
-0007cf90: 666f 7220 7073 2069 6e20 7365 6c66 2e5f  for ps in self._
-0007cfa0: 5f70 6f6c 7953 6571 0a20 2020 2020 2020  _polySeq.       
+0007cd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007cd70: 6966 2073 656c 662e 5f5f 7665 7262 6f73  if self.__verbos
+0007cd80: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0007cd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007cda0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0007cdb0: 656c 662e 5f5f 6c66 682e 7772 6974 6528  elf.__lfh.write(
+0007cdc0: 6622 2b58 706c 6f72 4d52 5061 7273 6572  f"+XplorMRParser
+0007cdd0: 4c69 7374 656e 6572 2e65 7869 7446 6163  Listener.exitFac
+0007cde0: 746f 7228 2920 2b2b 2045 7272 6f72 2020  tor() ++ Error  
+0007cdf0: 2d20 7b73 7472 2865 297d 2229 0a0a 2020  - {str(e)}")..  
+0007ce00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ce10: 2020 6966 206c 656e 2873 656c 662e 6661    if len(self.fa
+0007ce20: 6374 6f72 5b27 6174 6f6d 5f73 656c 6563  ctor['atom_selec
+0007ce30: 7469 6f6e 275d 2920 3e20 303a 0a20 2020  tion']) > 0:.   
+0007ce40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ce50: 2020 2020 2073 656c 662e 6661 6374 6f72       self.factor
+0007ce60: 5b27 6174 6f6d 5f73 656c 6563 7469 6f6e  ['atom_selection
+0007ce70: 275d 203d 205b 6469 6374 2873 2920 666f  '] = [dict(s) fo
+0007ce80: 7220 7320 696e 2073 6574 2866 726f 7a65  r s in set(froze
+0007ce90: 6e73 6574 2861 746f 6d2e 6974 656d 7328  nset(atom.items(
+0007cea0: 2929 2066 6f72 2061 746f 6d20 696e 205f  )) for atom in _
+0007ceb0: 6174 6f6d 5365 6c65 6374 696f 6e29 5d0a  atomSelection)].
+0007cec0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0007ced0: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
+0007cee0: 7365 6c66 2e66 6163 746f 725b 2761 746f  self.factor['ato
+0007cef0: 6d5f 7365 6c65 6374 696f 6e27 5d29 203d  m_selection']) =
+0007cf00: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
+0007cf10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007cf20: 2073 656c 662e 6661 6374 6f72 5b27 6174   self.factor['at
+0007cf30: 6f6d 5f69 6427 5d20 3d20 5b4e 6f6e 655d  om_id'] = [None]
+0007cf40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0007cf50: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0007cf60: 662e 5f5f 662e 6170 7065 6e64 2866 225b  f.__f.append(f"[
+0007cf70: 496e 7375 6666 6963 6965 6e74 2061 746f  Insufficient ato
+0007cf80: 6d20 7365 6c65 6374 696f 6e5d 207b 7365  m selection] {se
+0007cf90: 6c66 2e5f 5f67 6574 4375 7272 656e 7452  lf.__getCurrentR
+0007cfa0: 6573 7472 6169 6e74 2829 7d22 0a20 2020  estraint()}".   
 0007cfb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007cfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007cfd0: 2020 2020 2020 2020 6966 2070 735b 2761          if ps['a
-0007cfe0: 7574 685f 6368 6169 6e5f 6964 275d 203d  uth_chain_id'] =
-0007cff0: 3d20 7365 6c66 2e67 6574 5265 616c 4368  = self.getRealCh
-0007d000: 6169 6e49 6428 6368 6169 6e49 6429 5d0a  ainId(chainId)].
-0007d010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007d020: 2020 2020 6966 2073 656c 662e 5f5f 6861      if self.__ha
-0007d030: 734e 6f6e 506f 6c79 5365 713a 0a20 2020  sNonPolySeq:.   
-0007d040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007d050: 2020 2020 2066 6f72 206e 7020 696e 2073       for np in s
-0007d060: 656c 662e 5f5f 6e6f 6e50 6f6c 7953 6571  elf.__nonPolySeq
-0007d070: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0007d080: 2020 2020 2020 2020 2020 2020 2020 5f63                _c
-0007d090: 6861 696e 4964 203d 206e 705b 2761 7574  hainId = np['aut
-0007d0a0: 685f 6368 6169 6e5f 6964 275d 0a20 2020  h_chain_id'].   
-0007d0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007d0c0: 2020 2020 2020 2020 2069 6620 5f63 6861           if _cha
-0007d0d0: 696e 4964 203d 3d20 7365 6c66 2e67 6574  inId == self.get
-0007d0e0: 5265 616c 4368 6169 6e49 6428 6368 6169  RealChainId(chai
-0007d0f0: 6e49 6429 2061 6e64 205f 6368 6169 6e49  nId) and _chainI
-0007d100: 6420 6e6f 7420 696e 2073 656c 662e 6661  d not in self.fa
-0007d110: 6374 6f72 5b27 6368 6169 6e5f 6964 275d  ctor['chain_id']
-0007d120: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0007d130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007d140: 2020 7365 6c66 2e66 6163 746f 725b 2763    self.factor['c
-0007d150: 6861 696e 5f69 6427 5d2e 6170 7065 6e64  hain_id'].append
-0007d160: 285f 6368 6169 6e49 6429 0a20 2020 2020  (_chainId).     
-0007d170: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0007d180: 6620 6c65 6e28 7365 6c66 2e66 6163 746f  f len(self.facto
-0007d190: 725b 2763 6861 696e 5f69 6427 5d29 203e  r['chain_id']) >
-0007d1a0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-0007d1b0: 2020 2020 2020 2020 2020 2020 7369 6d70              simp
-0007d1c0: 6c65 4e61 6d65 496e 6465 7820 2b3d 2031  leNameIndex += 1
-0007d1d0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0007d1e0: 2020 6966 2073 696d 706c 654e 616d 6549    if simpleNameI
-0007d1f0: 6e64 6578 203d 3d20 3020 616e 6420 6374  ndex == 0 and ct
-0007d200: 782e 5369 6d70 6c65 5f6e 616d 6573 2830  x.Simple_names(0
-0007d210: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0007d220: 2020 2020 2020 2063 6861 696e 4964 203d         chainId =
-0007d230: 2073 7472 2863 7478 2e53 696d 706c 655f   str(ctx.Simple_
-0007d240: 6e61 6d65 7328 3029 290a 2020 2020 2020  names(0)).      
-0007d250: 2020 2020 2020 2020 2020 2020 2020 5f63                _c
-0007d260: 6861 696e 4964 203d 2074 6f52 6567 4578  hainId = toRegEx
-0007d270: 2863 6861 696e 4964 290a 2020 2020 2020  (chainId).      
-0007d280: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0007d290: 6c66 2e66 6163 746f 725b 2763 6861 696e  lf.factor['chain
-0007d2a0: 5f69 6427 5d20 3d20 5b70 735b 2761 7574  _id'] = [ps['aut
-0007d2b0: 685f 6368 6169 6e5f 6964 275d 2066 6f72  h_chain_id'] for
-0007d2c0: 2070 7320 696e 2073 656c 662e 5f5f 706f   ps in self.__po
-0007d2d0: 6c79 5365 710a 2020 2020 2020 2020 2020  lySeq.          
-0007d2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007d2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007d300: 2020 2020 2069 6620 7265 2e6d 6174 6368       if re.match
-0007d310: 285f 6368 6169 6e49 642c 2070 735b 2761  (_chainId, ps['a
-0007d320: 7574 685f 6368 6169 6e5f 6964 275d 295d  uth_chain_id'])]
-0007d330: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0007d340: 2020 2020 2069 6620 7365 6c66 2e5f 5f68       if self.__h
-0007d350: 6173 4e6f 6e50 6f6c 7953 6571 3a0a 2020  asNonPolySeq:.  
-0007d360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007d370: 2020 2020 2020 666f 7220 6e70 2069 6e20        for np in 
-0007d380: 7365 6c66 2e5f 5f6e 6f6e 506f 6c79 5365  self.__nonPolySe
-0007d390: 713a 0a20 2020 2020 2020 2020 2020 2020  q:.             
-0007d3a0: 2020 2020 2020 2020 2020 2020 2020 205f                 _
-0007d3b0: 5f63 6861 696e 4964 203d 206e 705b 2761  _chainId = np['a
-0007d3c0: 7574 685f 6368 6169 6e5f 6964 275d 0a20  uth_chain_id']. 
-0007d3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007d3e0: 2020 2020 2020 2020 2020 2069 6620 7265             if re
-0007d3f0: 2e6d 6174 6368 285f 6368 6169 6e49 642c  .match(_chainId,
-0007d400: 205f 5f63 6861 696e 4964 2920 616e 6420   __chainId) and 
-0007d410: 5f5f 6368 6169 6e49 6420 6e6f 7420 696e  __chainId not in
-0007d420: 2073 656c 662e 6661 6374 6f72 5b27 6368   self.factor['ch
-0007d430: 6169 6e5f 6964 275d 3a0a 2020 2020 2020  ain_id']:.      
-0007d440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007d450: 2020 2020 2020 2020 2020 7365 6c66 2e66            self.f
-0007d460: 6163 746f 725b 2763 6861 696e 5f69 6427  actor['chain_id'
-0007d470: 5d2e 6170 7065 6e64 285f 5f63 6861 696e  ].append(__chain
-0007d480: 4964 290a 2020 2020 2020 2020 2020 2020  Id).            
-0007d490: 2020 2020 2020 2020 7369 6d70 6c65 4e61          simpleNa
-0007d4a0: 6d65 7349 6e64 6578 202b 3d20 310a 0a20  mesIndex += 1.. 
-0007d4b0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0007d4c0: 6620 6c65 6e28 7365 6c66 2e66 6163 746f  f len(self.facto
-0007d4d0: 725b 2763 6861 696e 5f69 6427 5d29 203d  r['chain_id']) =
-0007d4e0: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
-0007d4f0: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
-0007d500: 7365 6c66 2e5f 5f70 6f6c 7953 6571 2920  self.__polySeq) 
-0007d510: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
-0007d520: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0007d530: 6c66 2e66 6163 746f 725b 2763 6861 696e  lf.factor['chain
-0007d540: 5f69 6427 5d20 3d20 7365 6c66 2e5f 5f70  _id'] = self.__p
-0007d550: 6f6c 7953 6571 5b30 5d5b 2763 6861 696e  olySeq[0]['chain
-0007d560: 5f69 6427 5d0a 2020 2020 2020 2020 2020  _id'].          
-0007d570: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0007d580: 6c66 2e66 6163 746f 725b 2761 7574 685f  lf.factor['auth_
-0007d590: 6368 6169 6e5f 6964 275d 203d 2063 6861  chain_id'] = cha
-0007d5a0: 696e 4964 0a20 2020 2020 2020 2020 2020  inId.           
-0007d5b0: 2020 2020 2020 2020 2065 6c69 6620 7365           elif se
-0007d5c0: 6c66 2e5f 5f72 6561 736f 6e73 2069 7320  lf.__reasons is 
-0007d5d0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-0007d5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007d5f0: 2020 7365 6c66 2e66 6163 746f 725b 2761    self.factor['a
-0007d600: 746f 6d5f 6964 275d 203d 205b 4e6f 6e65  tom_id'] = [None
-0007d610: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0007d620: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-0007d630: 5f66 2e61 7070 656e 6428 6622 5b49 6e76  _f.append(f"[Inv
-0007d640: 616c 6964 2064 6174 615d 207b 7365 6c66  alid data] {self
-0007d650: 2e5f 5f67 6574 4375 7272 656e 7452 6573  .__getCurrentRes
-0007d660: 7472 6169 6e74 2829 7d22 0a20 2020 2020  traint()}".     
-0007d670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007d680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007d690: 2020 2022 436f 756c 646e 2774 2073 7065     "Couldn't spe
-0007d6a0: 6369 6679 2073 6567 6d65 6e74 206e 616d  cify segment nam
-0007d6b0: 6520 220a 2020 2020 2020 2020 2020 2020  e ".            
-0007d6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007d6d0: 2020 2020 2020 2020 2020 2020 6622 277b              f"'{
-0007d6e0: 6368 6169 6e49 647d 2720 7468 6520 636f  chainId}' the co
-0007d6f0: 6f72 6469 6e61 7465 732e 2229 2020 2320  ordinates.")  # 
-0007d700: 646f 206e 6f74 2075 7365 2027 6368 6169  do not use 'chai
-0007d710: 6e49 6421 7227 2065 7870 7265 7373 696f  nId!r' expressio
-0007d720: 6e2c 2027 2527 2063 6f64 6520 7468 726f  n, '%' code thro
-0007d730: 7773 2056 616c 7565 4572 726f 720a 2020  ws ValueError.  
-0007d740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007d750: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0007d760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007d770: 6966 2027 7365 676d 656e 745f 6964 5f6d  if 'segment_id_m
-0007d780: 6973 6d61 7463 6827 206e 6f74 2069 6e20  ismatch' not in 
-0007d790: 7365 6c66 2e72 6561 736f 6e73 466f 7252  self.reasonsForR
-0007d7a0: 6550 6172 7369 6e67 3a0a 2020 2020 2020  eParsing:.      
-0007d7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007d7c0: 2020 2020 2020 7365 6c66 2e72 6561 736f        self.reaso
-0007d7d0: 6e73 466f 7252 6550 6172 7369 6e67 5b27  nsForReParsing['
-0007d7e0: 7365 676d 656e 745f 6964 5f6d 6973 6d61  segment_id_misma
-0007d7f0: 7463 6827 5d20 3d20 7b7d 0a20 2020 2020  tch'] = {}.     
-0007d800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007d810: 2020 2020 2020 2073 656c 662e 7265 6173         self.reas
-0007d820: 6f6e 7346 6f72 5265 5061 7273 696e 675b  onsForReParsing[
-0007d830: 2773 6567 6d65 6e74 5f69 645f 6d61 7463  'segment_id_matc
-0007d840: 685f 7374 6174 7327 5d20 3d20 7b7d 0a20  h_stats'] = {}. 
+0007cfd0: 2020 2020 2020 2020 2066 2254 6865 207b           f"The {
+0007cfe0: 636c 6175 7365 4e61 6d65 2172 7d20 636c  clauseName!r} cl
+0007cff0: 6175 7365 2068 6173 206e 6f20 6566 6665  ause has no effe
+0007d000: 6374 2e22 290a 0a20 2020 2020 2020 2020  ct.")..         
+0007d010: 2020 2065 6c69 6620 6374 782e 4174 6f6d     elif ctx.Atom
+0007d020: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+0007d030: 2020 2020 6966 2073 656c 662e 5f5f 7365      if self.__se
+0007d040: 6c5f 6578 7072 5f64 6562 7567 3a0a 2020  l_expr_debug:.  
+0007d050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007d060: 2020 7072 696e 7428 2220 2022 202a 2073    print("  " * s
+0007d070: 656c 662e 6465 7074 6820 2b20 222d 2d3e  elf.depth + "-->
+0007d080: 2061 746f 6d22 290a 2020 2020 2020 2020   atom").        
+0007d090: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
+0007d0a0: 656c 662e 5f5f 6861 7350 6f6c 7953 6571  elf.__hasPolySeq
+0007d0b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0007d0c0: 2020 2020 2020 7265 7475 726e 0a20 2020        return.   
+0007d0d0: 2020 2020 2020 2020 2020 2020 2073 696d               sim
+0007d0e0: 706c 654e 616d 6549 6e64 6578 203d 2073  pleNameIndex = s
+0007d0f0: 696d 706c 654e 616d 6573 496e 6465 7820  impleNamesIndex 
+0007d100: 3d20 3020 2023 2074 6865 7365 2069 6e64  = 0  # these ind
+0007d110: 6963 6573 2061 7265 206e 6563 6573 7361  ices are necessa
+0007d120: 7279 2074 6f20 6465 616c 2077 6974 6820  ry to deal with 
+0007d130: 6d69 7869 6e67 2063 6173 6520 6f66 2027  mixing case of '
+0007d140: 5369 6d70 6c65 5f6e 616d 6527 2061 6e64  Simple_name' and
+0007d150: 2027 5369 6d70 6c65 5f6e 616d 6573 270a   'Simple_names'.
+0007d160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007d170: 6966 2063 7478 2e53 696d 706c 655f 6e61  if ctx.Simple_na
+0007d180: 6d65 2830 293a 0a20 2020 2020 2020 2020  me(0):.         
+0007d190: 2020 2020 2020 2020 2020 2063 6861 696e             chain
+0007d1a0: 4964 203d 2073 7472 2863 7478 2e53 696d  Id = str(ctx.Sim
+0007d1b0: 706c 655f 6e61 6d65 2830 2929 0a20 2020  ple_name(0)).   
+0007d1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007d1d0: 2073 656c 662e 6661 6374 6f72 5b27 6368   self.factor['ch
+0007d1e0: 6169 6e5f 6964 275d 203d 205b 7073 5b27  ain_id'] = [ps['
+0007d1f0: 6175 7468 5f63 6861 696e 5f69 6427 5d20  auth_chain_id'] 
+0007d200: 666f 7220 7073 2069 6e20 7365 6c66 2e5f  for ps in self._
+0007d210: 5f70 6f6c 7953 6571 0a20 2020 2020 2020  _polySeq.       
+0007d220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007d230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007d240: 2020 2020 2020 2020 6966 2070 735b 2761          if ps['a
+0007d250: 7574 685f 6368 6169 6e5f 6964 275d 203d  uth_chain_id'] =
+0007d260: 3d20 7365 6c66 2e67 6574 5265 616c 4368  = self.getRealCh
+0007d270: 6169 6e49 6428 6368 6169 6e49 6429 5d0a  ainId(chainId)].
+0007d280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007d290: 2020 2020 6966 2073 656c 662e 5f5f 6861      if self.__ha
+0007d2a0: 734e 6f6e 506f 6c79 5365 713a 0a20 2020  sNonPolySeq:.   
+0007d2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007d2c0: 2020 2020 2066 6f72 206e 7020 696e 2073       for np in s
+0007d2d0: 656c 662e 5f5f 6e6f 6e50 6f6c 7953 6571  elf.__nonPolySeq
+0007d2e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0007d2f0: 2020 2020 2020 2020 2020 2020 2020 5f63                _c
+0007d300: 6861 696e 4964 203d 206e 705b 2761 7574  hainId = np['aut
+0007d310: 685f 6368 6169 6e5f 6964 275d 0a20 2020  h_chain_id'].   
+0007d320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007d330: 2020 2020 2020 2020 2069 6620 5f63 6861           if _cha
+0007d340: 696e 4964 203d 3d20 7365 6c66 2e67 6574  inId == self.get
+0007d350: 5265 616c 4368 6169 6e49 6428 6368 6169  RealChainId(chai
+0007d360: 6e49 6429 2061 6e64 205f 6368 6169 6e49  nId) and _chainI
+0007d370: 6420 6e6f 7420 696e 2073 656c 662e 6661  d not in self.fa
+0007d380: 6374 6f72 5b27 6368 6169 6e5f 6964 275d  ctor['chain_id']
+0007d390: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0007d3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007d3b0: 2020 7365 6c66 2e66 6163 746f 725b 2763    self.factor['c
+0007d3c0: 6861 696e 5f69 6427 5d2e 6170 7065 6e64  hain_id'].append
+0007d3d0: 285f 6368 6169 6e49 6429 0a20 2020 2020  (_chainId).     
+0007d3e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0007d3f0: 6620 6c65 6e28 7365 6c66 2e66 6163 746f  f len(self.facto
+0007d400: 725b 2763 6861 696e 5f69 6427 5d29 203e  r['chain_id']) >
+0007d410: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+0007d420: 2020 2020 2020 2020 2020 2020 7369 6d70              simp
+0007d430: 6c65 4e61 6d65 496e 6465 7820 2b3d 2031  leNameIndex += 1
+0007d440: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0007d450: 2020 6966 2073 696d 706c 654e 616d 6549    if simpleNameI
+0007d460: 6e64 6578 203d 3d20 3020 616e 6420 6374  ndex == 0 and ct
+0007d470: 782e 5369 6d70 6c65 5f6e 616d 6573 2830  x.Simple_names(0
+0007d480: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0007d490: 2020 2020 2020 2063 6861 696e 4964 203d         chainId =
+0007d4a0: 2073 7472 2863 7478 2e53 696d 706c 655f   str(ctx.Simple_
+0007d4b0: 6e61 6d65 7328 3029 290a 2020 2020 2020  names(0)).      
+0007d4c0: 2020 2020 2020 2020 2020 2020 2020 5f63                _c
+0007d4d0: 6861 696e 4964 203d 2074 6f52 6567 4578  hainId = toRegEx
+0007d4e0: 2863 6861 696e 4964 290a 2020 2020 2020  (chainId).      
+0007d4f0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0007d500: 6c66 2e66 6163 746f 725b 2763 6861 696e  lf.factor['chain
+0007d510: 5f69 6427 5d20 3d20 5b70 735b 2761 7574  _id'] = [ps['aut
+0007d520: 685f 6368 6169 6e5f 6964 275d 2066 6f72  h_chain_id'] for
+0007d530: 2070 7320 696e 2073 656c 662e 5f5f 706f   ps in self.__po
+0007d540: 6c79 5365 710a 2020 2020 2020 2020 2020  lySeq.          
+0007d550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007d560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007d570: 2020 2020 2069 6620 7265 2e6d 6174 6368       if re.match
+0007d580: 285f 6368 6169 6e49 642c 2070 735b 2761  (_chainId, ps['a
+0007d590: 7574 685f 6368 6169 6e5f 6964 275d 295d  uth_chain_id'])]
+0007d5a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0007d5b0: 2020 2020 2069 6620 7365 6c66 2e5f 5f68       if self.__h
+0007d5c0: 6173 4e6f 6e50 6f6c 7953 6571 3a0a 2020  asNonPolySeq:.  
+0007d5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007d5e0: 2020 2020 2020 666f 7220 6e70 2069 6e20        for np in 
+0007d5f0: 7365 6c66 2e5f 5f6e 6f6e 506f 6c79 5365  self.__nonPolySe
+0007d600: 713a 0a20 2020 2020 2020 2020 2020 2020  q:.             
+0007d610: 2020 2020 2020 2020 2020 2020 2020 205f                 _
+0007d620: 5f63 6861 696e 4964 203d 206e 705b 2761  _chainId = np['a
+0007d630: 7574 685f 6368 6169 6e5f 6964 275d 0a20  uth_chain_id']. 
+0007d640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007d650: 2020 2020 2020 2020 2020 2069 6620 7265             if re
+0007d660: 2e6d 6174 6368 285f 6368 6169 6e49 642c  .match(_chainId,
+0007d670: 205f 5f63 6861 696e 4964 2920 616e 6420   __chainId) and 
+0007d680: 5f5f 6368 6169 6e49 6420 6e6f 7420 696e  __chainId not in
+0007d690: 2073 656c 662e 6661 6374 6f72 5b27 6368   self.factor['ch
+0007d6a0: 6169 6e5f 6964 275d 3a0a 2020 2020 2020  ain_id']:.      
+0007d6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007d6c0: 2020 2020 2020 2020 2020 7365 6c66 2e66            self.f
+0007d6d0: 6163 746f 725b 2763 6861 696e 5f69 6427  actor['chain_id'
+0007d6e0: 5d2e 6170 7065 6e64 285f 5f63 6861 696e  ].append(__chain
+0007d6f0: 4964 290a 2020 2020 2020 2020 2020 2020  Id).            
+0007d700: 2020 2020 2020 2020 7369 6d70 6c65 4e61          simpleNa
+0007d710: 6d65 7349 6e64 6578 202b 3d20 310a 0a20  mesIndex += 1.. 
+0007d720: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0007d730: 6620 6c65 6e28 7365 6c66 2e66 6163 746f  f len(self.facto
+0007d740: 725b 2763 6861 696e 5f69 6427 5d29 203d  r['chain_id']) =
+0007d750: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
+0007d760: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
+0007d770: 7365 6c66 2e5f 5f70 6f6c 7953 6571 2920  self.__polySeq) 
+0007d780: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
+0007d790: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0007d7a0: 6c66 2e66 6163 746f 725b 2763 6861 696e  lf.factor['chain
+0007d7b0: 5f69 6427 5d20 3d20 7365 6c66 2e5f 5f70  _id'] = self.__p
+0007d7c0: 6f6c 7953 6571 5b30 5d5b 2763 6861 696e  olySeq[0]['chain
+0007d7d0: 5f69 6427 5d0a 2020 2020 2020 2020 2020  _id'].          
+0007d7e0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0007d7f0: 6c66 2e66 6163 746f 725b 2761 7574 685f  lf.factor['auth_
+0007d800: 6368 6169 6e5f 6964 275d 203d 2063 6861  chain_id'] = cha
+0007d810: 696e 4964 0a20 2020 2020 2020 2020 2020  inId.           
+0007d820: 2020 2020 2020 2020 2065 6c69 6620 7365           elif se
+0007d830: 6c66 2e5f 5f72 6561 736f 6e73 2069 7320  lf.__reasons is 
+0007d840: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
 0007d850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007d860: 2020 2020 2020 2069 6620 6368 6169 6e49         if chainI
-0007d870: 6420 6e6f 7420 696e 2073 656c 662e 7265  d not in self.re
-0007d880: 6173 6f6e 7346 6f72 5265 5061 7273 696e  asonsForReParsin
-0007d890: 675b 2773 6567 6d65 6e74 5f69 645f 6d69  g['segment_id_mi
-0007d8a0: 736d 6174 6368 275d 3a0a 2020 2020 2020  smatch']:.      
-0007d8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007d8c0: 2020 2020 2020 7365 6c66 2e72 6561 736f        self.reaso
-0007d8d0: 6e73 466f 7252 6550 6172 7369 6e67 5b27  nsForReParsing['
-0007d8e0: 7365 676d 656e 745f 6964 5f6d 6973 6d61  segment_id_misma
-0007d8f0: 7463 6827 5d5b 6368 6169 6e49 645d 203d  tch'][chainId] =
-0007d900: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
-0007d910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007d920: 2020 7365 6c66 2e72 6561 736f 6e73 466f    self.reasonsFo
-0007d930: 7252 6550 6172 7369 6e67 5b27 7365 676d  rReParsing['segm
-0007d940: 656e 745f 6964 5f6d 6174 6368 5f73 7461  ent_id_match_sta
-0007d950: 7473 275d 5b63 6861 696e 4964 5d20 3d20  ts'][chainId] = 
-0007d960: 7b7d 0a20 2020 2020 2020 2020 2020 2020  {}.             
-0007d970: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0007d980: 6661 6374 6f72 5b27 616c 745f 6368 6169  factor['alt_chai
-0007d990: 6e5f 6964 275d 203d 2063 6861 696e 4964  n_id'] = chainId
-0007d9a0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0007d9b0: 2020 6966 2063 7478 2e49 6e74 6567 6572    if ctx.Integer
-0007d9c0: 2830 293a 0a20 2020 2020 2020 2020 2020  (0):.           
-0007d9d0: 2020 2020 2020 2020 2073 656c 662e 6661           self.fa
-0007d9e0: 6374 6f72 5b27 7365 715f 6964 275d 203d  ctor['seq_id'] =
-0007d9f0: 205b 696e 7428 7374 7228 6374 782e 496e   [int(str(ctx.In
-0007da00: 7465 6765 7228 3029 2929 5d0a 0a20 2020  teger(0)))]..   
-0007da10: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0007da20: 6374 782e 496e 7465 6765 7273 2829 3a0a  ctx.Integers():.
-0007da30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007da40: 2020 2020 7365 7149 6420 3d20 7374 7228      seqId = str(
-0007da50: 6374 782e 496e 7465 6765 7273 2829 290a  ctx.Integers()).
-0007da60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007da70: 2020 2020 5f73 6571 4964 203d 2074 6f52      _seqId = toR
-0007da80: 6567 4578 2873 6571 4964 290a 2020 2020  egEx(seqId).    
-0007da90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007daa0: 5f73 6571 4964 5365 6c65 6374 203d 2073  _seqIdSelect = s
-0007dab0: 6574 2829 0a20 2020 2020 2020 2020 2020  et().           
-0007dac0: 2020 2020 2020 2020 2066 6f72 2063 6861           for cha
-0007dad0: 696e 4964 2069 6e20 7365 6c66 2e66 6163  inId in self.fac
-0007dae0: 746f 725b 2763 6861 696e 5f69 6427 5d3a  tor['chain_id']:
-0007daf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0007db00: 2020 2020 2020 2020 2070 7320 3d20 6e65           ps = ne
-0007db10: 7874 2828 7073 2066 6f72 2070 7320 696e  xt((ps for ps in
-0007db20: 2073 656c 662e 5f5f 706f 6c79 5365 7120   self.__polySeq 
-0007db30: 6966 2070 735b 2761 7574 685f 6368 6169  if ps['auth_chai
-0007db40: 6e5f 6964 275d 203d 3d20 6368 6169 6e49  n_id'] == chainI
-0007db50: 6429 2c20 4e6f 6e65 290a 2020 2020 2020  d), None).      
-0007db60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007db70: 2020 6966 2070 7320 6973 206e 6f74 204e    if ps is not N
-0007db80: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0007db90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007dba0: 2066 6f75 6e64 203d 2046 616c 7365 0a20   found = False. 
-0007dbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007dbc0: 2020 2020 2020 2020 2020 2066 6f72 2072             for r
-0007dbd0: 6561 6c53 6571 4964 2069 6e20 7073 5b27  ealSeqId in ps['
-0007dbe0: 6175 7468 5f73 6571 5f69 6427 5d3a 0a20  auth_seq_id']:. 
-0007dbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007dc00: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0007dc10: 6561 6c53 6571 4964 203d 2073 656c 662e  ealSeqId = self.
-0007dc20: 6765 7452 6561 6c53 6571 4964 2870 732c  getRealSeqId(ps,
-0007dc30: 2072 6561 6c53 6571 4964 290a 2020 2020   realSeqId).    
-0007dc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007dc50: 2020 2020 2020 2020 2020 2020 6966 2072              if r
-0007dc60: 652e 6d61 7463 6828 5f73 6571 4964 2c20  e.match(_seqId, 
-0007dc70: 7374 7228 7265 616c 5365 7149 6429 293a  str(realSeqId)):
-0007dc80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0007dc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007dca0: 2020 2020 205f 7365 7149 6453 656c 6563       _seqIdSelec
-0007dcb0: 742e 6164 6428 7265 616c 5365 7149 6429  t.add(realSeqId)
-0007dcc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0007d860: 2020 7365 6c66 2e66 6163 746f 725b 2761    self.factor['a
+0007d870: 746f 6d5f 6964 275d 203d 205b 4e6f 6e65  tom_id'] = [None
+0007d880: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0007d890: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+0007d8a0: 5f66 2e61 7070 656e 6428 6622 5b49 6e76  _f.append(f"[Inv
+0007d8b0: 616c 6964 2064 6174 615d 207b 7365 6c66  alid data] {self
+0007d8c0: 2e5f 5f67 6574 4375 7272 656e 7452 6573  .__getCurrentRes
+0007d8d0: 7472 6169 6e74 2829 7d22 0a20 2020 2020  traint()}".     
+0007d8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007d8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007d900: 2020 2022 436f 756c 646e 2774 2073 7065     "Couldn't spe
+0007d910: 6369 6679 2073 6567 6d65 6e74 206e 616d  cify segment nam
+0007d920: 6520 220a 2020 2020 2020 2020 2020 2020  e ".            
+0007d930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007d940: 2020 2020 2020 2020 2020 2020 6622 277b              f"'{
+0007d950: 6368 6169 6e49 647d 2720 7468 6520 636f  chainId}' the co
+0007d960: 6f72 6469 6e61 7465 732e 2229 2020 2320  ordinates.")  # 
+0007d970: 646f 206e 6f74 2075 7365 2027 6368 6169  do not use 'chai
+0007d980: 6e49 6421 7227 2065 7870 7265 7373 696f  nId!r' expressio
+0007d990: 6e2c 2027 2527 2063 6f64 6520 7468 726f  n, '%' code thro
+0007d9a0: 7773 2056 616c 7565 4572 726f 720a 2020  ws ValueError.  
+0007d9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007d9c0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0007d9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007d9e0: 6966 2027 7365 676d 656e 745f 6964 5f6d  if 'segment_id_m
+0007d9f0: 6973 6d61 7463 6827 206e 6f74 2069 6e20  ismatch' not in 
+0007da00: 7365 6c66 2e72 6561 736f 6e73 466f 7252  self.reasonsForR
+0007da10: 6550 6172 7369 6e67 3a0a 2020 2020 2020  eParsing:.      
+0007da20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007da30: 2020 2020 2020 7365 6c66 2e72 6561 736f        self.reaso
+0007da40: 6e73 466f 7252 6550 6172 7369 6e67 5b27  nsForReParsing['
+0007da50: 7365 676d 656e 745f 6964 5f6d 6973 6d61  segment_id_misma
+0007da60: 7463 6827 5d20 3d20 7b7d 0a20 2020 2020  tch'] = {}.     
+0007da70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007da80: 2020 2020 2020 2073 656c 662e 7265 6173         self.reas
+0007da90: 6f6e 7346 6f72 5265 5061 7273 696e 675b  onsForReParsing[
+0007daa0: 2773 6567 6d65 6e74 5f69 645f 6d61 7463  'segment_id_matc
+0007dab0: 685f 7374 6174 7327 5d20 3d20 7b7d 0a20  h_stats'] = {}. 
+0007dac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007dad0: 2020 2020 2020 2069 6620 6368 6169 6e49         if chainI
+0007dae0: 6420 6e6f 7420 696e 2073 656c 662e 7265  d not in self.re
+0007daf0: 6173 6f6e 7346 6f72 5265 5061 7273 696e  asonsForReParsin
+0007db00: 675b 2773 6567 6d65 6e74 5f69 645f 6d69  g['segment_id_mi
+0007db10: 736d 6174 6368 275d 3a0a 2020 2020 2020  smatch']:.      
+0007db20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007db30: 2020 2020 2020 7365 6c66 2e72 6561 736f        self.reaso
+0007db40: 6e73 466f 7252 6550 6172 7369 6e67 5b27  nsForReParsing['
+0007db50: 7365 676d 656e 745f 6964 5f6d 6973 6d61  segment_id_misma
+0007db60: 7463 6827 5d5b 6368 6169 6e49 645d 203d  tch'][chainId] =
+0007db70: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
+0007db80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007db90: 2020 7365 6c66 2e72 6561 736f 6e73 466f    self.reasonsFo
+0007dba0: 7252 6550 6172 7369 6e67 5b27 7365 676d  rReParsing['segm
+0007dbb0: 656e 745f 6964 5f6d 6174 6368 5f73 7461  ent_id_match_sta
+0007dbc0: 7473 275d 5b63 6861 696e 4964 5d20 3d20  ts'][chainId] = 
+0007dbd0: 7b7d 0a20 2020 2020 2020 2020 2020 2020  {}.             
+0007dbe0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0007dbf0: 6661 6374 6f72 5b27 616c 745f 6368 6169  factor['alt_chai
+0007dc00: 6e5f 6964 275d 203d 2063 6861 696e 4964  n_id'] = chainId
+0007dc10: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0007dc20: 2020 6966 2063 7478 2e49 6e74 6567 6572    if ctx.Integer
+0007dc30: 2830 293a 0a20 2020 2020 2020 2020 2020  (0):.           
+0007dc40: 2020 2020 2020 2020 2073 656c 662e 6661           self.fa
+0007dc50: 6374 6f72 5b27 7365 715f 6964 275d 203d  ctor['seq_id'] =
+0007dc60: 205b 696e 7428 7374 7228 6374 782e 496e   [int(str(ctx.In
+0007dc70: 7465 6765 7228 3029 2929 5d0a 0a20 2020  teger(0)))]..   
+0007dc80: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0007dc90: 6374 782e 496e 7465 6765 7273 2829 3a0a  ctx.Integers():.
+0007dca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007dcb0: 2020 2020 7365 7149 6420 3d20 7374 7228      seqId = str(
+0007dcc0: 6374 782e 496e 7465 6765 7273 2829 290a  ctx.Integers()).
 0007dcd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007dce0: 2020 2020 2066 6f75 6e64 203d 2054 7275       found = Tru
-0007dcf0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-0007dd00: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0007dd10: 206e 6f74 2066 6f75 6e64 3a0a 2020 2020   not found:.    
-0007dd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007dd30: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0007dd40: 7265 616c 5365 7149 6420 696e 2070 735b  realSeqId in ps[
-0007dd50: 2761 7574 685f 7365 715f 6964 275d 3a0a  'auth_seq_id']:.
-0007dd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007dd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007dd80: 2020 2020 7265 616c 5365 7149 6420 3d20      realSeqId = 
-0007dd90: 7365 6c66 2e67 6574 5265 616c 5365 7149  self.getRealSeqI
-0007dda0: 6428 7073 2c20 7265 616c 5365 7149 6429  d(ps, realSeqId)
-0007ddb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0007ddc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ddd0: 2020 2020 2073 6571 4b65 7920 3d20 2863       seqKey = (c
-0007dde0: 6861 696e 4964 2c20 7265 616c 5365 7149  hainId, realSeqI
-0007ddf0: 6429 0a20 2020 2020 2020 2020 2020 2020  d).             
+0007dce0: 2020 2020 5f73 6571 4964 203d 2074 6f52      _seqId = toR
+0007dcf0: 6567 4578 2873 6571 4964 290a 2020 2020  egEx(seqId).    
+0007dd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007dd10: 5f73 6571 4964 5365 6c65 6374 203d 2073  _seqIdSelect = s
+0007dd20: 6574 2829 0a20 2020 2020 2020 2020 2020  et().           
+0007dd30: 2020 2020 2020 2020 2066 6f72 2063 6861           for cha
+0007dd40: 696e 4964 2069 6e20 7365 6c66 2e66 6163  inId in self.fac
+0007dd50: 746f 725b 2763 6861 696e 5f69 6427 5d3a  tor['chain_id']:
+0007dd60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0007dd70: 2020 2020 2020 2020 2070 7320 3d20 6e65           ps = ne
+0007dd80: 7874 2828 7073 2066 6f72 2070 7320 696e  xt((ps for ps in
+0007dd90: 2073 656c 662e 5f5f 706f 6c79 5365 7120   self.__polySeq 
+0007dda0: 6966 2070 735b 2761 7574 685f 6368 6169  if ps['auth_chai
+0007ddb0: 6e5f 6964 275d 203d 3d20 6368 6169 6e49  n_id'] == chainI
+0007ddc0: 6429 2c20 4e6f 6e65 290a 2020 2020 2020  d), None).      
+0007ddd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007dde0: 2020 6966 2070 7320 6973 206e 6f74 204e    if ps is not N
+0007ddf0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
 0007de00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007de10: 2020 2020 2020 2069 6620 7365 714b 6579         if seqKey
-0007de20: 2069 6e20 7365 6c66 2e5f 5f61 7574 6854   in self.__authT
-0007de30: 6f4c 6162 656c 5365 713a 0a20 2020 2020  oLabelSeq:.     
-0007de40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007de50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007de60: 2020 205f 2c20 7265 616c 5365 7149 6420     _, realSeqId 
-0007de70: 3d20 7365 6c66 2e5f 5f61 7574 6854 6f4c  = self.__authToL
-0007de80: 6162 656c 5365 715b 7365 714b 6579 5d0a  abelSeq[seqKey].
-0007de90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007dea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007deb0: 2020 2020 2020 2020 6966 2072 652e 6d61          if re.ma
-0007dec0: 7463 6828 5f73 6571 4964 2c20 7374 7228  tch(_seqId, str(
-0007ded0: 7265 616c 5365 7149 6429 293a 0a20 2020  realSeqId)):.   
-0007dee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007def0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007df00: 2020 2020 2020 2020 205f 7365 7149 6453           _seqIdS
-0007df10: 656c 6563 742e 6164 6428 7265 616c 5365  elect.add(realSe
-0007df20: 7149 6429 0a20 2020 2020 2020 2020 2020  qId).           
-0007df30: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-0007df40: 2e5f 5f68 6173 4e6f 6e50 6f6c 7953 6571  .__hasNonPolySeq
-0007df50: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0007df60: 2020 2020 2020 2020 2020 666f 7220 6368            for ch
-0007df70: 6169 6e49 6420 696e 2073 656c 662e 6661  ainId in self.fa
-0007df80: 6374 6f72 5b27 6368 6169 6e5f 6964 275d  ctor['chain_id']
-0007df90: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0007dfa0: 2020 2020 2020 2020 2020 2020 2020 6e70                np
-0007dfb0: 4c69 7374 203d 205b 6e70 2066 6f72 206e  List = [np for n
-0007dfc0: 7020 696e 2073 656c 662e 5f5f 6e6f 6e50  p in self.__nonP
-0007dfd0: 6f6c 7953 6571 2069 6620 6e70 5b27 6175  olySeq if np['au
-0007dfe0: 7468 5f63 6861 696e 5f69 6427 5d20 3d3d  th_chain_id'] ==
-0007dff0: 2063 6861 696e 4964 5d0a 2020 2020 2020   chainId].      
-0007e000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e010: 2020 2020 2020 666f 7220 6e70 2069 6e20        for np in 
-0007e020: 6e70 4c69 7374 3a0a 2020 2020 2020 2020  npList:.        
+0007de10: 2066 6f75 6e64 203d 2046 616c 7365 0a20   found = False. 
+0007de20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007de30: 2020 2020 2020 2020 2020 2066 6f72 2072             for r
+0007de40: 6561 6c53 6571 4964 2069 6e20 7073 5b27  ealSeqId in ps['
+0007de50: 6175 7468 5f73 6571 5f69 6427 5d3a 0a20  auth_seq_id']:. 
+0007de60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007de70: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0007de80: 6561 6c53 6571 4964 203d 2073 656c 662e  ealSeqId = self.
+0007de90: 6765 7452 6561 6c53 6571 4964 2870 732c  getRealSeqId(ps,
+0007dea0: 2072 6561 6c53 6571 4964 290a 2020 2020   realSeqId).    
+0007deb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007dec0: 2020 2020 2020 2020 2020 2020 6966 2072              if r
+0007ded0: 652e 6d61 7463 6828 5f73 6571 4964 2c20  e.match(_seqId, 
+0007dee0: 7374 7228 7265 616c 5365 7149 6429 293a  str(realSeqId)):
+0007def0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0007df00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007df10: 2020 2020 205f 7365 7149 6453 656c 6563       _seqIdSelec
+0007df20: 742e 6164 6428 7265 616c 5365 7149 6429  t.add(realSeqId)
+0007df30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0007df40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007df50: 2020 2020 2066 6f75 6e64 203d 2054 7275       found = Tru
+0007df60: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+0007df70: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0007df80: 206e 6f74 2066 6f75 6e64 3a0a 2020 2020   not found:.    
+0007df90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007dfa0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0007dfb0: 7265 616c 5365 7149 6420 696e 2070 735b  realSeqId in ps[
+0007dfc0: 2761 7574 685f 7365 715f 6964 275d 3a0a  'auth_seq_id']:.
+0007dfd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007dfe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007dff0: 2020 2020 7265 616c 5365 7149 6420 3d20      realSeqId = 
+0007e000: 7365 6c66 2e67 6574 5265 616c 5365 7149  self.getRealSeqI
+0007e010: 6428 7073 2c20 7265 616c 5365 7149 6429  d(ps, realSeqId)
+0007e020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 0007e030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e040: 2020 2020 2020 2020 666f 756e 6420 3d20          found = 
-0007e050: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
-0007e060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e070: 2020 2020 2020 666f 7220 7265 616c 5365        for realSe
-0007e080: 7149 6420 696e 206e 705b 2761 7574 685f  qId in np['auth_
-0007e090: 7365 715f 6964 275d 3a0a 2020 2020 2020  seq_id']:.      
-0007e0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e0b0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0007e0c0: 616c 5365 7149 6420 3d20 7365 6c66 2e67  alSeqId = self.g
-0007e0d0: 6574 5265 616c 5365 7149 6428 6e70 2c20  etRealSeqId(np, 
-0007e0e0: 7265 616c 5365 7149 642c 2046 616c 7365  realSeqId, False
-0007e0f0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0007e040: 2020 2020 2073 6571 4b65 7920 3d20 2863       seqKey = (c
+0007e050: 6861 696e 4964 2c20 7265 616c 5365 7149  hainId, realSeqI
+0007e060: 6429 0a20 2020 2020 2020 2020 2020 2020  d).             
+0007e070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e080: 2020 2020 2020 2069 6620 7365 714b 6579         if seqKey
+0007e090: 2069 6e20 7365 6c66 2e5f 5f61 7574 6854   in self.__authT
+0007e0a0: 6f4c 6162 656c 5365 713a 0a20 2020 2020  oLabelSeq:.     
+0007e0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e0d0: 2020 205f 2c20 7265 616c 5365 7149 6420     _, realSeqId 
+0007e0e0: 3d20 7365 6c66 2e5f 5f61 7574 6854 6f4c  = self.__authToL
+0007e0f0: 6162 656c 5365 715b 7365 714b 6579 5d0a  abelSeq[seqKey].
 0007e100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e110: 2020 2020 2020 6966 2072 652e 6d61 7463        if re.matc
-0007e120: 6828 5f73 6571 4964 2c20 7374 7228 7265  h(_seqId, str(re
-0007e130: 616c 5365 7149 6429 293a 0a20 2020 2020  alSeqId)):.     
-0007e140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e120: 2020 2020 2020 2020 6966 2072 652e 6d61          if re.ma
+0007e130: 7463 6828 5f73 6571 4964 2c20 7374 7228  tch(_seqId, str(
+0007e140: 7265 616c 5365 7149 6429 293a 0a20 2020  realSeqId)):.   
 0007e150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e160: 2020 205f 7365 7149 6453 656c 6563 742e     _seqIdSelect.
-0007e170: 6164 6428 7265 616c 5365 7149 6429 0a20  add(realSeqId). 
-0007e180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e1a0: 2020 2020 2020 2066 6f75 6e64 203d 2054         found = T
-0007e1b0: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
-0007e1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e1d0: 2020 2020 6966 206e 6f74 2066 6f75 6e64      if not found
-0007e1e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0007e1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e200: 2020 2020 2020 666f 7220 7265 616c 5365        for realSe
-0007e210: 7149 6420 696e 206e 705b 2761 7574 685f  qId in np['auth_
-0007e220: 7365 715f 6964 275d 3a0a 2020 2020 2020  seq_id']:.      
-0007e230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e250: 2020 7265 616c 5365 7149 6420 3d20 7365    realSeqId = se
-0007e260: 6c66 2e67 6574 5265 616c 5365 7149 6428  lf.getRealSeqId(
-0007e270: 6e70 2c20 7265 616c 5365 7149 642c 2046  np, realSeqId, F
-0007e280: 616c 7365 290a 2020 2020 2020 2020 2020  alse).          
-0007e290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e2a0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0007e2b0: 714b 6579 203d 2028 6368 6169 6e49 642c  qKey = (chainId,
-0007e2c0: 2072 6561 6c53 6571 4964 290a 2020 2020   realSeqId).    
+0007e160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e170: 2020 2020 2020 2020 205f 7365 7149 6453           _seqIdS
+0007e180: 656c 6563 742e 6164 6428 7265 616c 5365  elect.add(realSe
+0007e190: 7149 6429 0a20 2020 2020 2020 2020 2020  qId).           
+0007e1a0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+0007e1b0: 2e5f 5f68 6173 4e6f 6e50 6f6c 7953 6571  .__hasNonPolySeq
+0007e1c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0007e1d0: 2020 2020 2020 2020 2020 666f 7220 6368            for ch
+0007e1e0: 6169 6e49 6420 696e 2073 656c 662e 6661  ainId in self.fa
+0007e1f0: 6374 6f72 5b27 6368 6169 6e5f 6964 275d  ctor['chain_id']
+0007e200: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0007e210: 2020 2020 2020 2020 2020 2020 2020 6e70                np
+0007e220: 4c69 7374 203d 205b 6e70 2066 6f72 206e  List = [np for n
+0007e230: 7020 696e 2073 656c 662e 5f5f 6e6f 6e50  p in self.__nonP
+0007e240: 6f6c 7953 6571 2069 6620 6e70 5b27 6175  olySeq if np['au
+0007e250: 7468 5f63 6861 696e 5f69 6427 5d20 3d3d  th_chain_id'] ==
+0007e260: 2063 6861 696e 4964 5d0a 2020 2020 2020   chainId].      
+0007e270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e280: 2020 2020 2020 666f 7220 6e70 2069 6e20        for np in 
+0007e290: 6e70 4c69 7374 3a0a 2020 2020 2020 2020  npList:.        
+0007e2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e2b0: 2020 2020 2020 2020 666f 756e 6420 3d20          found = 
+0007e2c0: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
 0007e2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e2f0: 2020 2020 6966 2073 6571 4b65 7920 696e      if seqKey in
-0007e300: 2073 656c 662e 5f5f 6175 7468 546f 4c61   self.__authToLa
-0007e310: 6265 6c53 6571 3a0a 2020 2020 2020 2020  belSeq:.        
-0007e320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e340: 2020 2020 5f2c 2072 6561 6c53 6571 4964      _, realSeqId
-0007e350: 203d 2073 656c 662e 5f5f 6175 7468 546f   = self.__authTo
-0007e360: 4c61 6265 6c53 6571 5b73 6571 4b65 795d  LabelSeq[seqKey]
-0007e370: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0007e380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e390: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0007e3a0: 7265 2e6d 6174 6368 285f 7365 7149 642c  re.match(_seqId,
-0007e3b0: 2073 7472 2872 6561 6c53 6571 4964 2929   str(realSeqId))
-0007e3c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0007e3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e3f0: 2020 5f73 6571 4964 5365 6c65 6374 2e61    _seqIdSelect.a
-0007e400: 6464 2872 6561 6c53 6571 4964 290a 2020  dd(realSeqId).  
-0007e410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e420: 2020 7365 6c66 2e66 6163 746f 725b 2773    self.factor['s
-0007e430: 6571 5f69 6427 5d20 3d20 6c69 7374 285f  eq_id'] = list(_
-0007e440: 7365 7149 6453 656c 6563 7429 0a0a 2020  seqIdSelect)..  
-0007e450: 2020 2020 2020 2020 2020 2020 2020 5f61                _a
-0007e460: 746f 6d49 6453 656c 6563 7420 3d20 7365  tomIdSelect = se
-0007e470: 7428 290a 2020 2020 2020 2020 2020 2020  t().            
-0007e480: 2020 2020 6966 2063 7478 2e53 696d 706c      if ctx.Simpl
-0007e490: 655f 6e61 6d65 2873 696d 706c 654e 616d  e_name(simpleNam
-0007e4a0: 6549 6e64 6578 293a 0a20 2020 2020 2020  eIndex):.       
-0007e4b0: 2020 2020 2020 2020 2020 2020 2061 746f               ato
-0007e4c0: 6d49 6420 3d20 7374 7228 6374 782e 5369  mId = str(ctx.Si
-0007e4d0: 6d70 6c65 5f6e 616d 6528 7369 6d70 6c65  mple_name(simple
-0007e4e0: 4e61 6d65 496e 6465 7829 290a 2020 2020  NameIndex)).    
-0007e4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e500: 666f 7220 6368 6169 6e49 6420 696e 2073  for chainId in s
-0007e510: 656c 662e 6661 6374 6f72 5b27 6368 6169  elf.factor['chai
-0007e520: 6e5f 6964 275d 3a0a 2020 2020 2020 2020  n_id']:.        
-0007e530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e540: 7073 203d 206e 6578 7428 2870 7320 666f  ps = next((ps fo
-0007e550: 7220 7073 2069 6e20 7365 6c66 2e5f 5f70  r ps in self.__p
-0007e560: 6f6c 7953 6571 2069 6620 7073 5b27 6175  olySeq if ps['au
-0007e570: 7468 5f63 6861 696e 5f69 6427 5d20 3d3d  th_chain_id'] ==
-0007e580: 2063 6861 696e 4964 292c 204e 6f6e 6529   chainId), None)
-0007e590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0007e5a0: 2020 2020 2020 2020 2069 6620 7073 2069           if ps i
-0007e5b0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-0007e5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e5d0: 2020 2020 636f 6e74 696e 7565 0a20 2020      continue.   
-0007e5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e5f0: 2020 2020 2066 6f72 2073 6571 4964 2069       for seqId i
-0007e600: 6e20 7365 6c66 2e66 6163 746f 725b 2773  n self.factor['s
-0007e610: 6571 5f69 6427 5d3a 0a20 2020 2020 2020  eq_id']:.       
-0007e620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e630: 2020 2020 2069 6620 7365 7149 6420 696e       if seqId in
-0007e640: 2070 735b 2761 7574 685f 7365 715f 6964   ps['auth_seq_id
-0007e650: 275d 3a0a 2020 2020 2020 2020 2020 2020  ']:.            
-0007e660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e670: 2020 2020 7365 7149 6420 3d20 7365 6c66      seqId = self
-0007e680: 2e67 6574 5265 616c 5365 7149 6428 7073  .getRealSeqId(ps
-0007e690: 2c20 7365 7149 6429 0a20 2020 2020 2020  , seqId).       
-0007e6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e6b0: 2020 2020 2020 2020 2063 6f6d 7049 6420           compId 
-0007e6c0: 3d20 7073 5b27 636f 6d70 5f69 6427 5d5b  = ps['comp_id'][
-0007e6d0: 7073 5b27 6175 7468 5f73 6571 5f69 6427  ps['auth_seq_id'
-0007e6e0: 5d2e 696e 6465 7828 7365 7149 6429 5d0a  ].index(seqId)].
-0007e6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e710: 6966 2073 656c 662e 5f5f 6363 552e 7570  if self.__ccU.up
-0007e720: 6461 7465 4368 656d 436f 6d70 4469 6374  dateChemCompDict
-0007e730: 2863 6f6d 7049 6429 3a0a 2020 2020 2020  (compId):.      
-0007e740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e750: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0007e760: 2061 6e79 2863 6361 2066 6f72 2063 6361   any(cca for cca
-0007e770: 2069 6e20 7365 6c66 2e5f 5f63 6355 2e6c   in self.__ccU.l
-0007e780: 6173 7441 746f 6d4c 6973 7420 6966 2063  astAtomList if c
-0007e790: 6361 5b73 656c 662e 5f5f 6363 552e 6363  ca[self.__ccU.cc
-0007e7a0: 6141 746f 6d49 645d 203d 3d20 6174 6f6d  aAtomId] == atom
-0007e7b0: 4964 293a 0a20 2020 2020 2020 2020 2020  Id):.           
-0007e7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e7d0: 2020 2020 2020 2020 2020 2020 205f 6174               _at
-0007e7e0: 6f6d 4964 5365 6c65 6374 2e61 6464 2861  omIdSelect.add(a
-0007e7f0: 746f 6d49 6429 0a20 2020 2020 2020 2020  tomId).         
-0007e800: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-0007e810: 6c66 2e5f 5f68 6173 4e6f 6e50 6f6c 7953  lf.__hasNonPolyS
-0007e820: 6571 3a0a 2020 2020 2020 2020 2020 2020  eq:.            
-0007e830: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0007e840: 6368 6169 6e49 6420 696e 2073 656c 662e  chainId in self.
-0007e850: 6661 6374 6f72 5b27 6368 6169 6e5f 6964  factor['chain_id
-0007e860: 275d 3a0a 2020 2020 2020 2020 2020 2020  ']:.            
-0007e870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e880: 6e70 4c69 7374 203d 205b 6e70 2066 6f72  npList = [np for
-0007e890: 206e 7020 696e 2073 656c 662e 5f5f 6e6f   np in self.__no
-0007e8a0: 6e50 6f6c 7953 6571 2069 6620 6e70 5b27  nPolySeq if np['
-0007e8b0: 6175 7468 5f63 6861 696e 5f69 6427 5d20  auth_chain_id'] 
-0007e8c0: 3d3d 2063 6861 696e 4964 5d0a 2020 2020  == chainId].    
+0007e2e0: 2020 2020 2020 666f 7220 7265 616c 5365        for realSe
+0007e2f0: 7149 6420 696e 206e 705b 2761 7574 685f  qId in np['auth_
+0007e300: 7365 715f 6964 275d 3a0a 2020 2020 2020  seq_id']:.      
+0007e310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e320: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0007e330: 616c 5365 7149 6420 3d20 7365 6c66 2e67  alSeqId = self.g
+0007e340: 6574 5265 616c 5365 7149 6428 6e70 2c20  etRealSeqId(np, 
+0007e350: 7265 616c 5365 7149 642c 2046 616c 7365  realSeqId, False
+0007e360: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0007e370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e380: 2020 2020 2020 6966 2072 652e 6d61 7463        if re.matc
+0007e390: 6828 5f73 6571 4964 2c20 7374 7228 7265  h(_seqId, str(re
+0007e3a0: 616c 5365 7149 6429 293a 0a20 2020 2020  alSeqId)):.     
+0007e3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e3d0: 2020 205f 7365 7149 6453 656c 6563 742e     _seqIdSelect.
+0007e3e0: 6164 6428 7265 616c 5365 7149 6429 0a20  add(realSeqId). 
+0007e3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e410: 2020 2020 2020 2066 6f75 6e64 203d 2054         found = T
+0007e420: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
+0007e430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e440: 2020 2020 6966 206e 6f74 2066 6f75 6e64      if not found
+0007e450: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0007e460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e470: 2020 2020 2020 666f 7220 7265 616c 5365        for realSe
+0007e480: 7149 6420 696e 206e 705b 2761 7574 685f  qId in np['auth_
+0007e490: 7365 715f 6964 275d 3a0a 2020 2020 2020  seq_id']:.      
+0007e4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e4c0: 2020 7265 616c 5365 7149 6420 3d20 7365    realSeqId = se
+0007e4d0: 6c66 2e67 6574 5265 616c 5365 7149 6428  lf.getRealSeqId(
+0007e4e0: 6e70 2c20 7265 616c 5365 7149 642c 2046  np, realSeqId, F
+0007e4f0: 616c 7365 290a 2020 2020 2020 2020 2020  alse).          
+0007e500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e510: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0007e520: 714b 6579 203d 2028 6368 6169 6e49 642c  qKey = (chainId,
+0007e530: 2072 6561 6c53 6571 4964 290a 2020 2020   realSeqId).    
+0007e540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e560: 2020 2020 6966 2073 6571 4b65 7920 696e      if seqKey in
+0007e570: 2073 656c 662e 5f5f 6175 7468 546f 4c61   self.__authToLa
+0007e580: 6265 6c53 6571 3a0a 2020 2020 2020 2020  belSeq:.        
+0007e590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e5b0: 2020 2020 5f2c 2072 6561 6c53 6571 4964      _, realSeqId
+0007e5c0: 203d 2073 656c 662e 5f5f 6175 7468 546f   = self.__authTo
+0007e5d0: 4c61 6265 6c53 6571 5b73 6571 4b65 795d  LabelSeq[seqKey]
+0007e5e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0007e5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e600: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0007e610: 7265 2e6d 6174 6368 285f 7365 7149 642c  re.match(_seqId,
+0007e620: 2073 7472 2872 6561 6c53 6571 4964 2929   str(realSeqId))
+0007e630: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0007e640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e660: 2020 5f73 6571 4964 5365 6c65 6374 2e61    _seqIdSelect.a
+0007e670: 6464 2872 6561 6c53 6571 4964 290a 2020  dd(realSeqId).  
+0007e680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e690: 2020 7365 6c66 2e66 6163 746f 725b 2773    self.factor['s
+0007e6a0: 6571 5f69 6427 5d20 3d20 6c69 7374 285f  eq_id'] = list(_
+0007e6b0: 7365 7149 6453 656c 6563 7429 0a0a 2020  seqIdSelect)..  
+0007e6c0: 2020 2020 2020 2020 2020 2020 2020 5f61                _a
+0007e6d0: 746f 6d49 6453 656c 6563 7420 3d20 7365  tomIdSelect = se
+0007e6e0: 7428 290a 2020 2020 2020 2020 2020 2020  t().            
+0007e6f0: 2020 2020 6966 2063 7478 2e53 696d 706c      if ctx.Simpl
+0007e700: 655f 6e61 6d65 2873 696d 706c 654e 616d  e_name(simpleNam
+0007e710: 6549 6e64 6578 293a 0a20 2020 2020 2020  eIndex):.       
+0007e720: 2020 2020 2020 2020 2020 2020 2061 746f               ato
+0007e730: 6d49 6420 3d20 7374 7228 6374 782e 5369  mId = str(ctx.Si
+0007e740: 6d70 6c65 5f6e 616d 6528 7369 6d70 6c65  mple_name(simple
+0007e750: 4e61 6d65 496e 6465 7829 290a 2020 2020  NameIndex)).    
+0007e760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e770: 666f 7220 6368 6169 6e49 6420 696e 2073  for chainId in s
+0007e780: 656c 662e 6661 6374 6f72 5b27 6368 6169  elf.factor['chai
+0007e790: 6e5f 6964 275d 3a0a 2020 2020 2020 2020  n_id']:.        
+0007e7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e7b0: 7073 203d 206e 6578 7428 2870 7320 666f  ps = next((ps fo
+0007e7c0: 7220 7073 2069 6e20 7365 6c66 2e5f 5f70  r ps in self.__p
+0007e7d0: 6f6c 7953 6571 2069 6620 7073 5b27 6175  olySeq if ps['au
+0007e7e0: 7468 5f63 6861 696e 5f69 6427 5d20 3d3d  th_chain_id'] ==
+0007e7f0: 2063 6861 696e 4964 292c 204e 6f6e 6529   chainId), None)
+0007e800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0007e810: 2020 2020 2020 2020 2069 6620 7073 2069           if ps i
+0007e820: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+0007e830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e840: 2020 2020 636f 6e74 696e 7565 0a20 2020      continue.   
+0007e850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e860: 2020 2020 2066 6f72 2073 6571 4964 2069       for seqId i
+0007e870: 6e20 7365 6c66 2e66 6163 746f 725b 2773  n self.factor['s
+0007e880: 6571 5f69 6427 5d3a 0a20 2020 2020 2020  eq_id']:.       
+0007e890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e8a0: 2020 2020 2069 6620 7365 7149 6420 696e       if seqId in
+0007e8b0: 2070 735b 2761 7574 685f 7365 715f 6964   ps['auth_seq_id
+0007e8c0: 275d 3a0a 2020 2020 2020 2020 2020 2020  ']:.            
 0007e8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e8e0: 2020 2020 2020 2020 666f 7220 6e70 2069          for np i
-0007e8f0: 6e20 6e70 4c69 7374 3a0a 2020 2020 2020  n npList:.      
-0007e900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e910: 2020 2020 2020 2020 2020 666f 7220 7365            for se
-0007e920: 7149 6420 696e 2073 656c 662e 6661 6374  qId in self.fact
-0007e930: 6f72 5b27 7365 715f 6964 275d 3a0a 2020  or['seq_id']:.  
-0007e940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e960: 2020 6966 2073 6571 4964 2069 6e20 6e70    if seqId in np
-0007e970: 5b27 6175 7468 5f73 6571 5f69 6427 5d3a  ['auth_seq_id']:
-0007e980: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0007e990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e9a0: 2020 2020 2020 2020 2073 6571 4964 203d           seqId =
-0007e9b0: 2073 656c 662e 6765 7452 6561 6c53 6571   self.getRealSeq
-0007e9c0: 4964 286e 702c 2073 6571 4964 2c20 4661  Id(np, seqId, Fa
-0007e9d0: 6c73 6529 0a20 2020 2020 2020 2020 2020  lse).           
-0007e9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007e9f0: 2020 2020 2020 2020 2020 2020 2063 6f6d               com
-0007ea00: 7049 6420 3d20 6e70 5b27 636f 6d70 5f69  pId = np['comp_i
-0007ea10: 6427 5d5b 6e70 5b27 6175 7468 5f73 6571  d'][np['auth_seq
-0007ea20: 5f69 6427 5d2e 696e 6465 7828 7365 7149  _id'].index(seqI
-0007ea30: 6429 5d0a 2020 2020 2020 2020 2020 2020  d)].            
-0007ea40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ea50: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0007ea60: 656c 662e 5f5f 6363 552e 7570 6461 7465  elf.__ccU.update
-0007ea70: 4368 656d 436f 6d70 4469 6374 2863 6f6d  ChemCompDict(com
-0007ea80: 7049 6429 3a0a 2020 2020 2020 2020 2020  pId):.          
-0007ea90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007eaa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007eab0: 2020 6966 2061 6e79 2863 6361 2066 6f72    if any(cca for
-0007eac0: 2063 6361 2069 6e20 7365 6c66 2e5f 5f63   cca in self.__c
-0007ead0: 6355 2e6c 6173 7441 746f 6d4c 6973 7420  cU.lastAtomList 
-0007eae0: 6966 2063 6361 5b73 656c 662e 5f5f 6363  if cca[self.__cc
-0007eaf0: 552e 6363 6141 746f 6d49 645d 203d 3d20  U.ccaAtomId] == 
-0007eb00: 6174 6f6d 4964 293a 0a20 2020 2020 2020  atomId):.       
-0007eb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007eb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007eb30: 2020 2020 2020 2020 205f 6174 6f6d 4964           _atomId
-0007eb40: 5365 6c65 6374 2e61 6464 2861 746f 6d49  Select.add(atomI
-0007eb50: 6429 0a0a 2020 2020 2020 2020 2020 2020  d)..            
-0007eb60: 2020 2020 656c 6966 2063 7478 2e53 696d      elif ctx.Sim
-0007eb70: 706c 655f 6e61 6d65 7328 7369 6d70 6c65  ple_names(simple
-0007eb80: 4e61 6d65 7349 6e64 6578 293a 0a20 2020  NamesIndex):.   
-0007eb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007eba0: 2061 746f 6d49 6420 3d20 7472 616e 736c   atomId = transl
-0007ebb0: 6174 6554 6f53 7464 4174 6f6d 4e61 6d65  ateToStdAtomName
-0007ebc0: 2873 7472 2863 7478 2e53 696d 706c 655f  (str(ctx.Simple_
-0007ebd0: 6e61 6d65 7328 7369 6d70 6c65 4e61 6d65  names(simpleName
-0007ebe0: 7349 6e64 6578 2929 2c0a 2020 2020 2020  sIndex)),.      
-0007ebf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e8e0: 2020 2020 7365 7149 6420 3d20 7365 6c66      seqId = self
+0007e8f0: 2e67 6574 5265 616c 5365 7149 6428 7073  .getRealSeqId(ps
+0007e900: 2c20 7365 7149 6429 0a20 2020 2020 2020  , seqId).       
+0007e910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e920: 2020 2020 2020 2020 2063 6f6d 7049 6420           compId 
+0007e930: 3d20 7073 5b27 636f 6d70 5f69 6427 5d5b  = ps['comp_id'][
+0007e940: 7073 5b27 6175 7468 5f73 6571 5f69 6427  ps['auth_seq_id'
+0007e950: 5d2e 696e 6465 7828 7365 7149 6429 5d0a  ].index(seqId)].
+0007e960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e980: 6966 2073 656c 662e 5f5f 6363 552e 7570  if self.__ccU.up
+0007e990: 6461 7465 4368 656d 436f 6d70 4469 6374  dateChemCompDict
+0007e9a0: 2863 6f6d 7049 6429 3a0a 2020 2020 2020  (compId):.      
+0007e9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007e9c0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0007e9d0: 2061 6e79 2863 6361 2066 6f72 2063 6361   any(cca for cca
+0007e9e0: 2069 6e20 7365 6c66 2e5f 5f63 6355 2e6c   in self.__ccU.l
+0007e9f0: 6173 7441 746f 6d4c 6973 7420 6966 2063  astAtomList if c
+0007ea00: 6361 5b73 656c 662e 5f5f 6363 552e 6363  ca[self.__ccU.cc
+0007ea10: 6141 746f 6d49 645d 203d 3d20 6174 6f6d  aAtomId] == atom
+0007ea20: 4964 293a 0a20 2020 2020 2020 2020 2020  Id):.           
+0007ea30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ea40: 2020 2020 2020 2020 2020 2020 205f 6174               _at
+0007ea50: 6f6d 4964 5365 6c65 6374 2e61 6464 2861  omIdSelect.add(a
+0007ea60: 746f 6d49 6429 0a20 2020 2020 2020 2020  tomId).         
+0007ea70: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+0007ea80: 6c66 2e5f 5f68 6173 4e6f 6e50 6f6c 7953  lf.__hasNonPolyS
+0007ea90: 6571 3a0a 2020 2020 2020 2020 2020 2020  eq:.            
+0007eaa0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0007eab0: 6368 6169 6e49 6420 696e 2073 656c 662e  chainId in self.
+0007eac0: 6661 6374 6f72 5b27 6368 6169 6e5f 6964  factor['chain_id
+0007ead0: 275d 3a0a 2020 2020 2020 2020 2020 2020  ']:.            
+0007eae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007eaf0: 6e70 4c69 7374 203d 205b 6e70 2066 6f72  npList = [np for
+0007eb00: 206e 7020 696e 2073 656c 662e 5f5f 6e6f   np in self.__no
+0007eb10: 6e50 6f6c 7953 6571 2069 6620 6e70 5b27  nPolySeq if np['
+0007eb20: 6175 7468 5f63 6861 696e 5f69 6427 5d20  auth_chain_id'] 
+0007eb30: 3d3d 2063 6861 696e 4964 5d0a 2020 2020  == chainId].    
+0007eb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007eb50: 2020 2020 2020 2020 666f 7220 6e70 2069          for np i
+0007eb60: 6e20 6e70 4c69 7374 3a0a 2020 2020 2020  n npList:.      
+0007eb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007eb80: 2020 2020 2020 2020 2020 666f 7220 7365            for se
+0007eb90: 7149 6420 696e 2073 656c 662e 6661 6374  qId in self.fact
+0007eba0: 6f72 5b27 7365 715f 6964 275d 3a0a 2020  or['seq_id']:.  
+0007ebb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ebc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ebd0: 2020 6966 2073 6571 4964 2069 6e20 6e70    if seqId in np
+0007ebe0: 5b27 6175 7468 5f73 6571 5f69 6427 5d3a  ['auth_seq_id']:
+0007ebf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 0007ec00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ec10: 2020 2020 2020 2020 2020 2020 2020 4e6f                No
-0007ec20: 6e65 2069 6620 2763 6f6d 705f 6964 2720  ne if 'comp_id' 
-0007ec30: 6e6f 7420 696e 2073 656c 662e 6661 6374  not in self.fact
-0007ec40: 6f72 2065 6c73 6520 7365 6c66 2e66 6163  or else self.fac
-0007ec50: 746f 725b 2763 6f6d 705f 6964 275d 5b30  tor['comp_id'][0
-0007ec60: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-0007ec70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ec80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ec90: 2020 2020 2020 2063 6355 3d73 656c 662e         ccU=self.
-0007eca0: 5f5f 6363 5529 0a20 2020 2020 2020 2020  __ccU).         
-0007ecb0: 2020 2020 2020 2020 2020 205f 6174 6f6d             _atom
-0007ecc0: 4964 203d 2074 6f52 6567 4578 2861 746f  Id = toRegEx(ato
-0007ecd0: 6d49 6429 0a20 2020 2020 2020 2020 2020  mId).           
-0007ece0: 2020 2020 2020 2020 2066 6f72 2063 6861           for cha
-0007ecf0: 696e 4964 2069 6e20 7365 6c66 2e66 6163  inId in self.fac
-0007ed00: 746f 725b 2763 6861 696e 5f69 6427 5d3a  tor['chain_id']:
-0007ed10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0007ed20: 2020 2020 2020 2020 2070 7320 3d20 6e65           ps = ne
-0007ed30: 7874 2828 7073 2066 6f72 2070 7320 696e  xt((ps for ps in
-0007ed40: 2073 656c 662e 5f5f 706f 6c79 5365 7120   self.__polySeq 
-0007ed50: 6966 2070 735b 2761 7574 685f 6368 6169  if ps['auth_chai
-0007ed60: 6e5f 6964 275d 203d 3d20 6368 6169 6e49  n_id'] == chainI
-0007ed70: 6429 2c20 4e6f 6e65 290a 2020 2020 2020  d), None).      
+0007ec10: 2020 2020 2020 2020 2073 6571 4964 203d           seqId =
+0007ec20: 2073 656c 662e 6765 7452 6561 6c53 6571   self.getRealSeq
+0007ec30: 4964 286e 702c 2073 6571 4964 2c20 4661  Id(np, seqId, Fa
+0007ec40: 6c73 6529 0a20 2020 2020 2020 2020 2020  lse).           
+0007ec50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ec60: 2020 2020 2020 2020 2020 2020 2063 6f6d               com
+0007ec70: 7049 6420 3d20 6e70 5b27 636f 6d70 5f69  pId = np['comp_i
+0007ec80: 6427 5d5b 6e70 5b27 6175 7468 5f73 6571  d'][np['auth_seq
+0007ec90: 5f69 6427 5d2e 696e 6465 7828 7365 7149  _id'].index(seqI
+0007eca0: 6429 5d0a 2020 2020 2020 2020 2020 2020  d)].            
+0007ecb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ecc0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0007ecd0: 656c 662e 5f5f 6363 552e 7570 6461 7465  elf.__ccU.update
+0007ece0: 4368 656d 436f 6d70 4469 6374 2863 6f6d  ChemCompDict(com
+0007ecf0: 7049 6429 3a0a 2020 2020 2020 2020 2020  pId):.          
+0007ed00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ed10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ed20: 2020 6966 2061 6e79 2863 6361 2066 6f72    if any(cca for
+0007ed30: 2063 6361 2069 6e20 7365 6c66 2e5f 5f63   cca in self.__c
+0007ed40: 6355 2e6c 6173 7441 746f 6d4c 6973 7420  cU.lastAtomList 
+0007ed50: 6966 2063 6361 5b73 656c 662e 5f5f 6363  if cca[self.__cc
+0007ed60: 552e 6363 6141 746f 6d49 645d 203d 3d20  U.ccaAtomId] == 
+0007ed70: 6174 6f6d 4964 293a 0a20 2020 2020 2020  atomId):.       
 0007ed80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ed90: 2020 6966 2070 7320 6973 204e 6f6e 653a    if ps is None:
-0007eda0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0007edb0: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
-0007edc0: 7469 6e75 650a 2020 2020 2020 2020 2020  tinue.          
-0007edd0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-0007ede0: 7220 7365 7149 6420 696e 2073 656c 662e  r seqId in self.
-0007edf0: 6661 6374 6f72 5b27 7365 715f 6964 275d  factor['seq_id']
-0007ee00: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0007ee10: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0007ee20: 2073 6571 4964 2069 6e20 7073 5b27 6175   seqId in ps['au
-0007ee30: 7468 5f73 6571 5f69 6427 5d3a 0a20 2020  th_seq_id']:.   
-0007ee40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ee50: 2020 2020 2020 2020 2020 2020 2073 6571               seq
-0007ee60: 4964 203d 2073 656c 662e 6765 7452 6561  Id = self.getRea
-0007ee70: 6c53 6571 4964 2870 732c 2073 6571 4964  lSeqId(ps, seqId
-0007ee80: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0007ee90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007eea0: 2020 636f 6d70 4964 203d 2070 735b 2763    compId = ps['c
-0007eeb0: 6f6d 705f 6964 275d 5b70 735b 2761 7574  omp_id'][ps['aut
-0007eec0: 685f 7365 715f 6964 275d 2e69 6e64 6578  h_seq_id'].index
-0007eed0: 2873 6571 4964 295d 0a20 2020 2020 2020  (seqId)].       
+0007ed90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007eda0: 2020 2020 2020 2020 205f 6174 6f6d 4964           _atomId
+0007edb0: 5365 6c65 6374 2e61 6464 2861 746f 6d49  Select.add(atomI
+0007edc0: 6429 0a0a 2020 2020 2020 2020 2020 2020  d)..            
+0007edd0: 2020 2020 656c 6966 2063 7478 2e53 696d      elif ctx.Sim
+0007ede0: 706c 655f 6e61 6d65 7328 7369 6d70 6c65  ple_names(simple
+0007edf0: 4e61 6d65 7349 6e64 6578 293a 0a20 2020  NamesIndex):.   
+0007ee00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ee10: 2061 746f 6d49 6420 3d20 7472 616e 736c   atomId = transl
+0007ee20: 6174 6554 6f53 7464 4174 6f6d 4e61 6d65  ateToStdAtomName
+0007ee30: 2873 7472 2863 7478 2e53 696d 706c 655f  (str(ctx.Simple_
+0007ee40: 6e61 6d65 7328 7369 6d70 6c65 4e61 6d65  names(simpleName
+0007ee50: 7349 6e64 6578 2929 2c0a 2020 2020 2020  sIndex)),.      
+0007ee60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ee70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ee80: 2020 2020 2020 2020 2020 2020 2020 4e6f                No
+0007ee90: 6e65 2069 6620 2763 6f6d 705f 6964 2720  ne if 'comp_id' 
+0007eea0: 6e6f 7420 696e 2073 656c 662e 6661 6374  not in self.fact
+0007eeb0: 6f72 2065 6c73 6520 7365 6c66 2e66 6163  or else self.fac
+0007eec0: 746f 725b 2763 6f6d 705f 6964 275d 5b30  tor['comp_id'][0
+0007eed0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
 0007eee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007eef0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-0007ef00: 2e5f 5f63 6355 2e75 7064 6174 6543 6865  .__ccU.updateChe
-0007ef10: 6d43 6f6d 7044 6963 7428 636f 6d70 4964  mCompDict(compId
-0007ef20: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0007ef30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ef40: 2020 2020 2020 2066 6f72 2063 6361 2069         for cca i
-0007ef50: 6e20 7365 6c66 2e5f 5f63 6355 2e6c 6173  n self.__ccU.las
-0007ef60: 7441 746f 6d4c 6973 743a 0a20 2020 2020  tAtomList:.     
-0007ef70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ef80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ef90: 2020 2069 6620 6363 615b 7365 6c66 2e5f     if cca[self._
-0007efa0: 5f63 6355 2e63 6361 4c65 6176 696e 6741  _ccU.ccaLeavingA
-0007efb0: 746f 6d46 6c61 675d 2021 3d20 2759 273a  tomFlag] != 'Y':
-0007efc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0007efd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007efe0: 2020 2020 2020 2020 2020 2020 2072 6561               rea
-0007eff0: 6c41 746f 6d49 6420 3d20 6363 615b 7365  lAtomId = cca[se
-0007f000: 6c66 2e5f 5f63 6355 2e63 6361 4174 6f6d  lf.__ccU.ccaAtom
-0007f010: 4964 5d0a 2020 2020 2020 2020 2020 2020  Id].            
-0007f020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f040: 6966 2072 652e 6d61 7463 6828 5f61 746f  if re.match(_ato
-0007f050: 6d49 642c 2072 6561 6c41 746f 6d49 6429  mId, realAtomId)
-0007f060: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0007f070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f090: 2020 5f61 746f 6d49 6453 656c 6563 742e    _atomIdSelect.
-0007f0a0: 6164 6428 7265 616c 4174 6f6d 4964 290a  add(realAtomId).
+0007eef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007ef00: 2020 2020 2020 2063 6355 3d73 656c 662e         ccU=self.
+0007ef10: 5f5f 6363 5529 0a20 2020 2020 2020 2020  __ccU).         
+0007ef20: 2020 2020 2020 2020 2020 205f 6174 6f6d             _atom
+0007ef30: 4964 203d 2074 6f52 6567 4578 2861 746f  Id = toRegEx(ato
+0007ef40: 6d49 6429 0a20 2020 2020 2020 2020 2020  mId).           
+0007ef50: 2020 2020 2020 2020 2066 6f72 2063 6861           for cha
+0007ef60: 696e 4964 2069 6e20 7365 6c66 2e66 6163  inId in self.fac
+0007ef70: 746f 725b 2763 6861 696e 5f69 6427 5d3a  tor['chain_id']:
+0007ef80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0007ef90: 2020 2020 2020 2020 2070 7320 3d20 6e65           ps = ne
+0007efa0: 7874 2828 7073 2066 6f72 2070 7320 696e  xt((ps for ps in
+0007efb0: 2073 656c 662e 5f5f 706f 6c79 5365 7120   self.__polySeq 
+0007efc0: 6966 2070 735b 2761 7574 685f 6368 6169  if ps['auth_chai
+0007efd0: 6e5f 6964 275d 203d 3d20 6368 6169 6e49  n_id'] == chainI
+0007efe0: 6429 2c20 4e6f 6e65 290a 2020 2020 2020  d), None).      
+0007eff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f000: 2020 6966 2070 7320 6973 204e 6f6e 653a    if ps is None:
+0007f010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0007f020: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
+0007f030: 7469 6e75 650a 2020 2020 2020 2020 2020  tinue.          
+0007f040: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0007f050: 7220 7365 7149 6420 696e 2073 656c 662e  r seqId in self.
+0007f060: 6661 6374 6f72 5b27 7365 715f 6964 275d  factor['seq_id']
+0007f070: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0007f080: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0007f090: 2073 6571 4964 2069 6e20 7073 5b27 6175   seqId in ps['au
+0007f0a0: 7468 5f73 6571 5f69 6427 5d3a 0a20 2020  th_seq_id']:.   
 0007f0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f0c0: 2020 2020 6966 2073 656c 662e 5f5f 6861      if self.__ha
-0007f0d0: 734e 6f6e 506f 6c79 5365 713a 0a20 2020  sNonPolySeq:.   
-0007f0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f0f0: 2020 2020 2066 6f72 2063 6861 696e 4964       for chainId
-0007f100: 2069 6e20 7365 6c66 2e66 6163 746f 725b   in self.factor[
-0007f110: 2763 6861 696e 5f69 6427 5d3a 0a20 2020  'chain_id']:.   
-0007f120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f130: 2020 2020 2020 2020 206e 704c 6973 7420           npList 
-0007f140: 3d20 5b6e 7020 666f 7220 6e70 2069 6e20  = [np for np in 
-0007f150: 7365 6c66 2e5f 5f6e 6f6e 506f 6c79 5365  self.__nonPolySe
-0007f160: 7120 6966 206e 705b 2761 7574 685f 6368  q if np['auth_ch
-0007f170: 6169 6e5f 6964 275d 203d 3d20 6368 6169  ain_id'] == chai
-0007f180: 6e49 645d 0a20 2020 2020 2020 2020 2020  nId].           
-0007f190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f1a0: 2066 6f72 206e 7020 696e 206e 704c 6973   for np in npLis
-0007f1b0: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
-0007f1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f1d0: 2020 2066 6f72 2073 6571 4964 2069 6e20     for seqId in 
-0007f1e0: 7365 6c66 2e66 6163 746f 725b 2773 6571  self.factor['seq
-0007f1f0: 5f69 6427 5d3a 0a20 2020 2020 2020 2020  _id']:.         
-0007f200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f210: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-0007f220: 7149 6420 696e 206e 705b 2761 7574 685f  qId in np['auth_
-0007f230: 7365 715f 6964 275d 3a0a 2020 2020 2020  seq_id']:.      
+0007f0c0: 2020 2020 2020 2020 2020 2020 2073 6571               seq
+0007f0d0: 4964 203d 2073 656c 662e 6765 7452 6561  Id = self.getRea
+0007f0e0: 6c53 6571 4964 2870 732c 2073 6571 4964  lSeqId(ps, seqId
+0007f0f0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0007f100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f110: 2020 636f 6d70 4964 203d 2070 735b 2763    compId = ps['c
+0007f120: 6f6d 705f 6964 275d 5b70 735b 2761 7574  omp_id'][ps['aut
+0007f130: 685f 7365 715f 6964 275d 2e69 6e64 6578  h_seq_id'].index
+0007f140: 2873 6571 4964 295d 0a20 2020 2020 2020  (seqId)].       
+0007f150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f160: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+0007f170: 2e5f 5f63 6355 2e75 7064 6174 6543 6865  .__ccU.updateChe
+0007f180: 6d43 6f6d 7044 6963 7428 636f 6d70 4964  mCompDict(compId
+0007f190: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0007f1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f1b0: 2020 2020 2020 2066 6f72 2063 6361 2069         for cca i
+0007f1c0: 6e20 7365 6c66 2e5f 5f63 6355 2e6c 6173  n self.__ccU.las
+0007f1d0: 7441 746f 6d4c 6973 743a 0a20 2020 2020  tAtomList:.     
+0007f1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f200: 2020 2069 6620 6363 615b 7365 6c66 2e5f     if cca[self._
+0007f210: 5f63 6355 2e63 6361 4c65 6176 696e 6741  _ccU.ccaLeavingA
+0007f220: 746f 6d46 6c61 675d 2021 3d20 2759 273a  tomFlag] != 'Y':
+0007f230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 0007f240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f260: 2020 7365 7149 6420 3d20 7365 6c66 2e67    seqId = self.g
-0007f270: 6574 5265 616c 5365 7149 6428 6e70 2c20  etRealSeqId(np, 
-0007f280: 7365 7149 642c 2046 616c 7365 290a 2020  seqId, False).  
+0007f250: 2020 2020 2020 2020 2020 2020 2072 6561               rea
+0007f260: 6c41 746f 6d49 6420 3d20 6363 615b 7365  lAtomId = cca[se
+0007f270: 6c66 2e5f 5f63 6355 2e63 6361 4174 6f6d  lf.__ccU.ccaAtom
+0007f280: 4964 5d0a 2020 2020 2020 2020 2020 2020  Id].            
 0007f290: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007f2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f2b0: 2020 2020 2020 636f 6d70 4964 203d 206e        compId = n
-0007f2c0: 705b 2763 6f6d 705f 6964 275d 5b6e 705b  p['comp_id'][np[
-0007f2d0: 2761 7574 685f 7365 715f 6964 275d 2e69  'auth_seq_id'].i
-0007f2e0: 6e64 6578 2873 6571 4964 295d 0a20 2020  ndex(seqId)].   
+0007f2b0: 6966 2072 652e 6d61 7463 6828 5f61 746f  if re.match(_ato
+0007f2c0: 6d49 642c 2072 6561 6c41 746f 6d49 6429  mId, realAtomId)
+0007f2d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0007f2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007f2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f310: 2020 2020 2069 6620 7365 6c66 2e5f 5f63       if self.__c
-0007f320: 6355 2e75 7064 6174 6543 6865 6d43 6f6d  cU.updateChemCom
-0007f330: 7044 6963 7428 636f 6d70 4964 293a 0a20  pDict(compId):. 
-0007f340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f300: 2020 5f61 746f 6d49 6453 656c 6563 742e    _atomIdSelect.
+0007f310: 6164 6428 7265 616c 4174 6f6d 4964 290a  add(realAtomId).
+0007f320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f330: 2020 2020 6966 2073 656c 662e 5f5f 6861      if self.__ha
+0007f340: 734e 6f6e 506f 6c79 5365 713a 0a20 2020  sNonPolySeq:.   
 0007f350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f360: 2020 2020 2020 2020 2020 2066 6f72 2063             for c
-0007f370: 6361 2069 6e20 7365 6c66 2e5f 5f63 6355  ca in self.__ccU
-0007f380: 2e6c 6173 7441 746f 6d4c 6973 743a 0a20  .lastAtomList:. 
+0007f360: 2020 2020 2066 6f72 2063 6861 696e 4964       for chainId
+0007f370: 2069 6e20 7365 6c66 2e66 6163 746f 725b   in self.factor[
+0007f380: 2763 6861 696e 5f69 6427 5d3a 0a20 2020  'chain_id']:.   
 0007f390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f3b0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0007f3c0: 6620 6363 615b 7365 6c66 2e5f 5f63 6355  f cca[self.__ccU
-0007f3d0: 2e63 6361 4c65 6176 696e 6741 746f 6d46  .ccaLeavingAtomF
-0007f3e0: 6c61 675d 2021 3d20 2759 273a 0a20 2020  lag] != 'Y':.   
-0007f3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f3a0: 2020 2020 2020 2020 206e 704c 6973 7420           npList 
+0007f3b0: 3d20 5b6e 7020 666f 7220 6e70 2069 6e20  = [np for np in 
+0007f3c0: 7365 6c66 2e5f 5f6e 6f6e 506f 6c79 5365  self.__nonPolySe
+0007f3d0: 7120 6966 206e 705b 2761 7574 685f 6368  q if np['auth_ch
+0007f3e0: 6169 6e5f 6964 275d 203d 3d20 6368 6169  ain_id'] == chai
+0007f3f0: 6e49 645d 0a20 2020 2020 2020 2020 2020  nId].           
 0007f400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f420: 2072 6561 6c41 746f 6d49 6420 3d20 6363   realAtomId = cc
-0007f430: 615b 7365 6c66 2e5f 5f63 6355 2e63 6361  a[self.__ccU.cca
-0007f440: 4174 6f6d 4964 5d0a 2020 2020 2020 2020  AtomId].        
-0007f450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f470: 2020 2020 2020 2020 2020 2020 6966 2072              if r
-0007f480: 652e 6d61 7463 6828 5f61 746f 6d49 642c  e.match(_atomId,
-0007f490: 2072 6561 6c41 746f 6d49 6429 3a0a 2020   realAtomId):.  
-0007f4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f410: 2066 6f72 206e 7020 696e 206e 704c 6973   for np in npLis
+0007f420: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
+0007f430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f440: 2020 2066 6f72 2073 6571 4964 2069 6e20     for seqId in 
+0007f450: 7365 6c66 2e66 6163 746f 725b 2773 6571  self.factor['seq
+0007f460: 5f69 6427 5d3a 0a20 2020 2020 2020 2020  _id']:.         
+0007f470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f480: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+0007f490: 7149 6420 696e 206e 705b 2761 7574 685f  qId in np['auth_
+0007f4a0: 7365 715f 6964 275d 3a0a 2020 2020 2020  seq_id']:.      
 0007f4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0007f4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f4d0: 2020 2020 2020 5f61 746f 6d49 6453 656c        _atomIdSel
-0007f4e0: 6563 742e 6164 6428 7265 616c 4174 6f6d  ect.add(realAtom
-0007f4f0: 4964 290a 0a20 2020 2020 2020 2020 2020  Id)..           
-0007f500: 2020 2020 2073 656c 662e 6661 6374 6f72       self.factor
-0007f510: 5b27 6174 6f6d 5f69 6427 5d20 3d20 6c69  ['atom_id'] = li
-0007f520: 7374 285f 6174 6f6d 4964 5365 6c65 6374  st(_atomIdSelect
-0007f530: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-0007f540: 2020 2073 656c 662e 636f 6e73 756d 6546     self.consumeF
-0007f550: 6163 746f 725f 6578 7072 6573 7369 6f6e  actor_expression
-0007f560: 7328 2227 6174 6f6d 2720 636c 6175 7365  s("'atom' clause
-0007f570: 222c 2046 616c 7365 290a 0a20 2020 2020  ", False)..     
-0007f580: 2020 2020 2020 2065 6c69 6620 6374 782e         elif ctx.
-0007f590: 4174 7472 6962 7574 6528 293a 0a20 2020  Attribute():.   
-0007f5a0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0007f5b0: 7365 6c66 2e5f 5f73 656c 5f65 7870 725f  self.__sel_expr_
-0007f5c0: 6465 6275 673a 0a20 2020 2020 2020 2020  debug:.         
-0007f5d0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0007f5e0: 2822 2020 2220 2a20 7365 6c66 2e64 6570  ("  " * self.dep
-0007f5f0: 7468 202b 2022 2d2d 3e20 6174 7472 6962  th + "--> attrib
-0007f600: 7574 6522 290a 2020 2020 2020 2020 2020  ute").          
-0007f610: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
-0007f620: 662e 5f5f 6861 7343 6f6f 7264 3a0a 2020  f.__hasCoord:.  
-0007f630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f640: 2020 7265 7475 726e 0a20 2020 2020 2020    return.       
-0007f650: 2020 2020 2020 2020 2061 6273 6f6c 7574           absolut
-0007f660: 6520 3d20 626f 6f6c 2863 7478 2e41 6273  e = bool(ctx.Abs
-0007f670: 2829 290a 2020 2020 2020 2020 2020 2020  ()).            
-0007f680: 2020 2020 5f61 7474 725f 7072 6f70 203d      _attr_prop =
-0007f690: 2073 7472 2863 7478 2e41 7474 725f 7072   str(ctx.Attr_pr
-0007f6a0: 6f70 6572 7469 6573 2829 290a 2020 2020  operties()).    
-0007f6b0: 2020 2020 2020 2020 2020 2020 6174 7472              attr
-0007f6c0: 5f70 726f 7020 3d20 5f61 7474 725f 7072  _prop = _attr_pr
-0007f6d0: 6f70 2e6c 6f77 6572 2829 0a20 2020 2020  op.lower().     
-0007f6e0: 2020 2020 2020 2020 2020 206f 7043 6f64             opCod
-0007f6f0: 6520 3d20 7374 7228 6374 782e 436f 6d70  e = str(ctx.Comp
-0007f700: 6172 6973 6f6e 5f6f 7073 2829 290a 2020  arison_ops()).  
-0007f710: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0007f720: 206c 656e 2873 656c 662e 6e75 6d62 6572   len(self.number
-0007f730: 4653 656c 6563 7469 6f6e 2920 3d3d 2030  FSelection) == 0
-0007f740: 206f 7220 4e6f 6e65 2069 6e20 7365 6c66   or None in self
-0007f750: 2e6e 756d 6265 7246 5365 6c65 6374 696f  .numberFSelectio
-0007f760: 6e3a 0a20 2020 2020 2020 2020 2020 2020  n:.             
-0007f770: 2020 2020 2020 2072 6574 7572 6e0a 2020         return.  
-0007f780: 2020 2020 2020 2020 2020 2020 2020 6174                at
-0007f790: 7472 5f76 616c 7565 203d 2073 656c 662e  tr_value = self.
-0007f7a0: 6e75 6d62 6572 4653 656c 6563 7469 6f6e  numberFSelection
-0007f7b0: 5b30 5d0a 0a20 2020 2020 2020 2020 2020  [0]..           
-0007f7c0: 2020 2020 2076 616c 6964 5072 6f70 203d       validProp =
-0007f7d0: 2054 7275 650a 0a20 2020 2020 2020 2020   True..         
-0007f7e0: 2020 2020 2020 2069 6620 6174 7472 5f70         if attr_p
-0007f7f0: 726f 7020 3d3d 2027 6227 3a0a 2020 2020  rop == 'b':.    
-0007f800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f810: 7661 6c75 6554 7970 6520 3d20 7b27 6e61  valueType = {'na
-0007f820: 6d65 273a 2027 425f 6973 6f5f 6f72 5f65  me': 'B_iso_or_e
-0007f830: 7175 6976 277d 0a20 2020 2020 2020 2020  quiv'}.         
-0007f840: 2020 2020 2020 2020 2020 2069 6620 6f70             if op
-0007f850: 436f 6465 203d 3d20 273d 273a 0a20 2020  Code == '=':.   
-0007f860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f870: 2020 2020 2076 616c 7565 5479 7065 5b27       valueType['
-0007f880: 7479 7065 275d 203d 2027 666c 6f61 7427  type'] = 'float'
-0007f890: 2069 6620 6e6f 7420 6162 736f 6c75 7465   if not absolute
-0007f8a0: 2065 6c73 6520 2761 6273 2d66 6c6f 6174   else 'abs-float
-0007f8b0: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
-0007f8c0: 2020 2020 2020 2020 2020 7661 6c75 6554            valueT
-0007f8d0: 7970 655b 2776 616c 7565 275d 203d 2061  ype['value'] = a
-0007f8e0: 7474 725f 7661 6c75 650a 2020 2020 2020  ttr_value.      
-0007f8f0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-0007f900: 6966 206f 7043 6f64 6520 3d3d 2027 3c27  if opCode == '<'
-0007f910: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0007f920: 2020 2020 2020 2020 2020 7661 6c75 6554            valueT
-0007f930: 7970 655b 2774 7970 6527 5d20 3d20 2772  ype['type'] = 'r
-0007f940: 616e 6765 2d66 6c6f 6174 2720 6966 206e  ange-float' if n
-0007f950: 6f74 2061 6273 6f6c 7574 6520 656c 7365  ot absolute else
-0007f960: 2027 7261 6e67 652d 6162 732d 666c 6f61   'range-abs-floa
-0007f970: 7427 0a20 2020 2020 2020 2020 2020 2020  t'.             
-0007f980: 2020 2020 2020 2020 2020 2076 616c 7565             value
-0007f990: 5479 7065 5b27 7261 6e67 6527 5d20 3d20  Type['range'] = 
-0007f9a0: 7b27 6d61 785f 6578 636c 7573 6976 6527  {'max_exclusive'
-0007f9b0: 3a20 6174 7472 5f76 616c 7565 7d0a 2020  : attr_value}.  
-0007f9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007f9d0: 2020 656c 6966 206f 7043 6f64 6520 3d3d    elif opCode ==
-0007f9e0: 2027 3e27 3a0a 2020 2020 2020 2020 2020   '>':.          
-0007f9f0: 2020 2020 2020 2020 2020 2020 2020 7661                va
-0007fa00: 6c75 6554 7970 655b 2774 7970 6527 5d20  lueType['type'] 
-0007fa10: 3d20 2772 616e 6765 2d66 6c6f 6174 2720  = 'range-float' 
-0007fa20: 6966 206e 6f74 2061 6273 6f6c 7574 6520  if not absolute 
-0007fa30: 656c 7365 2027 7261 6e67 652d 6162 732d  else 'range-abs-
-0007fa40: 666c 6f61 7427 0a20 2020 2020 2020 2020  float'.         
-0007fa50: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-0007fa60: 616c 7565 5479 7065 5b27 7261 6e67 6527  alueType['range'
-0007fa70: 5d20 3d20 7b27 6d69 6e5f 6578 636c 7573  ] = {'min_exclus
-0007fa80: 6976 6527 3a20 6174 7472 5f76 616c 7565  ive': attr_value
-0007fa90: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
-0007faa0: 2020 2020 2020 656c 6966 206f 7043 6f64        elif opCod
-0007fab0: 6520 3d3d 2027 3c3d 273a 0a20 2020 2020  e == '<=':.     
-0007fac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007fad0: 2020 2076 616c 7565 5479 7065 5b27 7479     valueType['ty
-0007fae0: 7065 275d 203d 2027 7261 6e67 652d 666c  pe'] = 'range-fl
-0007faf0: 6f61 7427 2069 6620 6e6f 7420 6162 736f  oat' if not abso
-0007fb00: 6c75 7465 2065 6c73 6520 2772 616e 6765  lute else 'range
-0007fb10: 2d61 6273 2d66 6c6f 6174 270a 2020 2020  -abs-float'.    
-0007fb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007fb30: 2020 2020 7661 6c75 6554 7970 655b 2772      valueType['r
-0007fb40: 616e 6765 275d 203d 207b 276d 6178 5f69  ange'] = {'max_i
-0007fb50: 6e63 6c75 7369 7665 273a 2061 7474 725f  nclusive': attr_
-0007fb60: 7661 6c75 657d 0a20 2020 2020 2020 2020  value}.         
-0007fb70: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-0007fb80: 6f70 436f 6465 203d 3d20 273e 3d27 3a0a  opCode == '>=':.
-0007fb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007fba0: 2020 2020 2020 2020 7661 6c75 6554 7970          valueTyp
-0007fbb0: 655b 2774 7970 6527 5d20 3d20 2772 616e  e['type'] = 'ran
-0007fbc0: 6765 2d66 6c6f 6174 2720 6966 206e 6f74  ge-float' if not
-0007fbd0: 2061 6273 6f6c 7574 6520 656c 7365 2027   absolute else '
-0007fbe0: 7261 6e67 652d 6162 732d 666c 6f61 7427  range-abs-float'
-0007fbf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0007fc00: 2020 2020 2020 2020 2076 616c 7565 5479           valueTy
-0007fc10: 7065 5b27 7261 6e67 6527 5d20 3d20 7b27  pe['range'] = {'
-0007fc20: 6d69 6e5f 696e 636c 7573 6976 6527 3a20  min_inclusive': 
-0007fc30: 6174 7472 5f76 616c 7565 7d0a 2020 2020  attr_value}.    
-0007fc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007fc50: 656c 6966 206f 7043 6f64 6520 3d3d 2027  elif opCode == '
-0007fc60: 2327 3a0a 2020 2020 2020 2020 2020 2020  #':.            
-0007fc70: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
-0007fc80: 6554 7970 655b 2774 7970 6527 5d20 3d20  eType['type'] = 
-0007fc90: 2772 616e 6765 2d66 6c6f 6174 2720 6966  'range-float' if
-0007fca0: 206e 6f74 2061 6273 6f6c 7574 6520 656c   not absolute el
-0007fcb0: 7365 2027 7261 6e67 652d 6162 732d 666c  se 'range-abs-fl
-0007fcc0: 6f61 7427 0a20 2020 2020 2020 2020 2020  oat'.           
-0007fcd0: 2020 2020 2020 2020 2020 2020 2076 616c               val
-0007fce0: 7565 5479 7065 5b27 7261 6e67 6527 5d20  ueType['range'] 
-0007fcf0: 3d20 7b27 6e6f 745f 6571 7561 6c5f 746f  = {'not_equal_to
-0007fd00: 273a 2061 7474 725f 7661 6c75 657d 0a20  ': attr_value}. 
-0007fd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007fd20: 2020 2061 746f 6d53 656c 6563 7469 6f6e     atomSelection
-0007fd30: 203d 5c0a 2020 2020 2020 2020 2020 2020   =\.            
-0007fd40: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0007fd50: 2e5f 5f63 522e 6765 7444 6963 744c 6973  .__cR.getDictLis
-0007fd60: 7457 6974 6846 696c 7465 7228 2761 746f  tWithFilter('ato
-0007fd70: 6d5f 7369 7465 272c 0a20 2020 2020 2020  m_site',.       
-0007fd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f4d0: 2020 7365 7149 6420 3d20 7365 6c66 2e67    seqId = self.g
+0007f4e0: 6574 5265 616c 5365 7149 6428 6e70 2c20  etRealSeqId(np, 
+0007f4f0: 7365 7149 642c 2046 616c 7365 290a 2020  seqId, False).  
+0007f500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f520: 2020 2020 2020 636f 6d70 4964 203d 206e        compId = n
+0007f530: 705b 2763 6f6d 705f 6964 275d 5b6e 705b  p['comp_id'][np[
+0007f540: 2761 7574 685f 7365 715f 6964 275d 2e69  'auth_seq_id'].i
+0007f550: 6e64 6578 2873 6571 4964 295d 0a20 2020  ndex(seqId)].   
+0007f560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f580: 2020 2020 2069 6620 7365 6c66 2e5f 5f63       if self.__c
+0007f590: 6355 2e75 7064 6174 6543 6865 6d43 6f6d  cU.updateChemCom
+0007f5a0: 7044 6963 7428 636f 6d70 4964 293a 0a20  pDict(compId):. 
+0007f5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f5d0: 2020 2020 2020 2020 2020 2066 6f72 2063             for c
+0007f5e0: 6361 2069 6e20 7365 6c66 2e5f 5f63 6355  ca in self.__ccU
+0007f5f0: 2e6c 6173 7441 746f 6d4c 6973 743a 0a20  .lastAtomList:. 
+0007f600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f620: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0007f630: 6620 6363 615b 7365 6c66 2e5f 5f63 6355  f cca[self.__ccU
+0007f640: 2e63 6361 4c65 6176 696e 6741 746f 6d46  .ccaLeavingAtomF
+0007f650: 6c61 675d 2021 3d20 2759 273a 0a20 2020  lag] != 'Y':.   
+0007f660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f690: 2072 6561 6c41 746f 6d49 6420 3d20 6363   realAtomId = cc
+0007f6a0: 615b 7365 6c66 2e5f 5f63 6355 2e63 6361  a[self.__ccU.cca
+0007f6b0: 4174 6f6d 4964 5d0a 2020 2020 2020 2020  AtomId].        
+0007f6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f6e0: 2020 2020 2020 2020 2020 2020 6966 2072              if r
+0007f6f0: 652e 6d61 7463 6828 5f61 746f 6d49 642c  e.match(_atomId,
+0007f700: 2072 6561 6c41 746f 6d49 6429 3a0a 2020   realAtomId):.  
+0007f710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f740: 2020 2020 2020 5f61 746f 6d49 6453 656c        _atomIdSel
+0007f750: 6563 742e 6164 6428 7265 616c 4174 6f6d  ect.add(realAtom
+0007f760: 4964 290a 0a20 2020 2020 2020 2020 2020  Id)..           
+0007f770: 2020 2020 2073 656c 662e 6661 6374 6f72       self.factor
+0007f780: 5b27 6174 6f6d 5f69 6427 5d20 3d20 6c69  ['atom_id'] = li
+0007f790: 7374 285f 6174 6f6d 4964 5365 6c65 6374  st(_atomIdSelect
+0007f7a0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+0007f7b0: 2020 2073 656c 662e 636f 6e73 756d 6546     self.consumeF
+0007f7c0: 6163 746f 725f 6578 7072 6573 7369 6f6e  actor_expression
+0007f7d0: 7328 2227 6174 6f6d 2720 636c 6175 7365  s("'atom' clause
+0007f7e0: 222c 2046 616c 7365 290a 0a20 2020 2020  ", False)..     
+0007f7f0: 2020 2020 2020 2065 6c69 6620 6374 782e         elif ctx.
+0007f800: 4174 7472 6962 7574 6528 293a 0a20 2020  Attribute():.   
+0007f810: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0007f820: 7365 6c66 2e5f 5f73 656c 5f65 7870 725f  self.__sel_expr_
+0007f830: 6465 6275 673a 0a20 2020 2020 2020 2020  debug:.         
+0007f840: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0007f850: 2822 2020 2220 2a20 7365 6c66 2e64 6570  ("  " * self.dep
+0007f860: 7468 202b 2022 2d2d 3e20 6174 7472 6962  th + "--> attrib
+0007f870: 7574 6522 290a 2020 2020 2020 2020 2020  ute").          
+0007f880: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
+0007f890: 662e 5f5f 6861 7343 6f6f 7264 3a0a 2020  f.__hasCoord:.  
+0007f8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007f8b0: 2020 7265 7475 726e 0a20 2020 2020 2020    return.       
+0007f8c0: 2020 2020 2020 2020 2061 6273 6f6c 7574           absolut
+0007f8d0: 6520 3d20 626f 6f6c 2863 7478 2e41 6273  e = bool(ctx.Abs
+0007f8e0: 2829 290a 2020 2020 2020 2020 2020 2020  ()).            
+0007f8f0: 2020 2020 5f61 7474 725f 7072 6f70 203d      _attr_prop =
+0007f900: 2073 7472 2863 7478 2e41 7474 725f 7072   str(ctx.Attr_pr
+0007f910: 6f70 6572 7469 6573 2829 290a 2020 2020  operties()).    
+0007f920: 2020 2020 2020 2020 2020 2020 6174 7472              attr
+0007f930: 5f70 726f 7020 3d20 5f61 7474 725f 7072  _prop = _attr_pr
+0007f940: 6f70 2e6c 6f77 6572 2829 0a20 2020 2020  op.lower().     
+0007f950: 2020 2020 2020 2020 2020 206f 7043 6f64             opCod
+0007f960: 6520 3d20 7374 7228 6374 782e 436f 6d70  e = str(ctx.Comp
+0007f970: 6172 6973 6f6e 5f6f 7073 2829 290a 2020  arison_ops()).  
+0007f980: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0007f990: 206c 656e 2873 656c 662e 6e75 6d62 6572   len(self.number
+0007f9a0: 4653 656c 6563 7469 6f6e 2920 3d3d 2030  FSelection) == 0
+0007f9b0: 206f 7220 4e6f 6e65 2069 6e20 7365 6c66   or None in self
+0007f9c0: 2e6e 756d 6265 7246 5365 6c65 6374 696f  .numberFSelectio
+0007f9d0: 6e3a 0a20 2020 2020 2020 2020 2020 2020  n:.             
+0007f9e0: 2020 2020 2020 2072 6574 7572 6e0a 2020         return.  
+0007f9f0: 2020 2020 2020 2020 2020 2020 2020 6174                at
+0007fa00: 7472 5f76 616c 7565 203d 2073 656c 662e  tr_value = self.
+0007fa10: 6e75 6d62 6572 4653 656c 6563 7469 6f6e  numberFSelection
+0007fa20: 5b30 5d0a 0a20 2020 2020 2020 2020 2020  [0]..           
+0007fa30: 2020 2020 2076 616c 6964 5072 6f70 203d       validProp =
+0007fa40: 2054 7275 650a 0a20 2020 2020 2020 2020   True..         
+0007fa50: 2020 2020 2020 2069 6620 6174 7472 5f70         if attr_p
+0007fa60: 726f 7020 3d3d 2027 6227 3a0a 2020 2020  rop == 'b':.    
+0007fa70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007fa80: 7661 6c75 6554 7970 6520 3d20 7b27 6e61  valueType = {'na
+0007fa90: 6d65 273a 2027 425f 6973 6f5f 6f72 5f65  me': 'B_iso_or_e
+0007faa0: 7175 6976 277d 0a20 2020 2020 2020 2020  quiv'}.         
+0007fab0: 2020 2020 2020 2020 2020 2069 6620 6f70             if op
+0007fac0: 436f 6465 203d 3d20 273d 273a 0a20 2020  Code == '=':.   
+0007fad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007fae0: 2020 2020 2076 616c 7565 5479 7065 5b27       valueType['
+0007faf0: 7479 7065 275d 203d 2027 666c 6f61 7427  type'] = 'float'
+0007fb00: 2069 6620 6e6f 7420 6162 736f 6c75 7465   if not absolute
+0007fb10: 2065 6c73 6520 2761 6273 2d66 6c6f 6174   else 'abs-float
+0007fb20: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
+0007fb30: 2020 2020 2020 2020 2020 7661 6c75 6554            valueT
+0007fb40: 7970 655b 2776 616c 7565 275d 203d 2061  ype['value'] = a
+0007fb50: 7474 725f 7661 6c75 650a 2020 2020 2020  ttr_value.      
+0007fb60: 2020 2020 2020 2020 2020 2020 2020 656c                el
+0007fb70: 6966 206f 7043 6f64 6520 3d3d 2027 3c27  if opCode == '<'
+0007fb80: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0007fb90: 2020 2020 2020 2020 2020 7661 6c75 6554            valueT
+0007fba0: 7970 655b 2774 7970 6527 5d20 3d20 2772  ype['type'] = 'r
+0007fbb0: 616e 6765 2d66 6c6f 6174 2720 6966 206e  ange-float' if n
+0007fbc0: 6f74 2061 6273 6f6c 7574 6520 656c 7365  ot absolute else
+0007fbd0: 2027 7261 6e67 652d 6162 732d 666c 6f61   'range-abs-floa
+0007fbe0: 7427 0a20 2020 2020 2020 2020 2020 2020  t'.             
+0007fbf0: 2020 2020 2020 2020 2020 2076 616c 7565             value
+0007fc00: 5479 7065 5b27 7261 6e67 6527 5d20 3d20  Type['range'] = 
+0007fc10: 7b27 6d61 785f 6578 636c 7573 6976 6527  {'max_exclusive'
+0007fc20: 3a20 6174 7472 5f76 616c 7565 7d0a 2020  : attr_value}.  
+0007fc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007fc40: 2020 656c 6966 206f 7043 6f64 6520 3d3d    elif opCode ==
+0007fc50: 2027 3e27 3a0a 2020 2020 2020 2020 2020   '>':.          
+0007fc60: 2020 2020 2020 2020 2020 2020 2020 7661                va
+0007fc70: 6c75 6554 7970 655b 2774 7970 6527 5d20  lueType['type'] 
+0007fc80: 3d20 2772 616e 6765 2d66 6c6f 6174 2720  = 'range-float' 
+0007fc90: 6966 206e 6f74 2061 6273 6f6c 7574 6520  if not absolute 
+0007fca0: 656c 7365 2027 7261 6e67 652d 6162 732d  else 'range-abs-
+0007fcb0: 666c 6f61 7427 0a20 2020 2020 2020 2020  float'.         
+0007fcc0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+0007fcd0: 616c 7565 5479 7065 5b27 7261 6e67 6527  alueType['range'
+0007fce0: 5d20 3d20 7b27 6d69 6e5f 6578 636c 7573  ] = {'min_exclus
+0007fcf0: 6976 6527 3a20 6174 7472 5f76 616c 7565  ive': attr_value
+0007fd00: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
+0007fd10: 2020 2020 2020 656c 6966 206f 7043 6f64        elif opCod
+0007fd20: 6520 3d3d 2027 3c3d 273a 0a20 2020 2020  e == '<=':.     
+0007fd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007fd40: 2020 2076 616c 7565 5479 7065 5b27 7479     valueType['ty
+0007fd50: 7065 275d 203d 2027 7261 6e67 652d 666c  pe'] = 'range-fl
+0007fd60: 6f61 7427 2069 6620 6e6f 7420 6162 736f  oat' if not abso
+0007fd70: 6c75 7465 2065 6c73 6520 2772 616e 6765  lute else 'range
+0007fd80: 2d61 6273 2d66 6c6f 6174 270a 2020 2020  -abs-float'.    
 0007fd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007fda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007fdb0: 2041 5554 485f 4154 4f4d 5f44 4154 415f   AUTH_ATOM_DATA_
-0007fdc0: 4954 454d 532c 0a20 2020 2020 2020 2020  ITEMS,.         
-0007fdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007fde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007fdf0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0007fe00: 7661 6c75 6554 7970 652c 0a20 2020 2020  valueType,.     
-0007fe10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007fe20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007fe30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007fe40: 2020 2020 7b27 6e61 6d65 273a 2073 656c      {'name': sel
-0007fe50: 662e 5f5f 6d6f 6465 6c4e 756d 4e61 6d65  f.__modelNumName
-0007fe60: 2c20 2774 7970 6527 3a20 2769 6e74 272c  , 'type': 'int',
-0007fe70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0007fe80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007fe90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007fea0: 2020 2020 2020 2020 2020 2027 7661 6c75             'valu
-0007feb0: 6527 3a20 7365 6c66 2e5f 5f72 6570 7265  e': self.__repre
-0007fec0: 7365 6e74 6174 6976 654d 6f64 656c 4964  sentativeModelId
-0007fed0: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
-0007fee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007fef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ff00: 2020 2020 2020 2020 2020 2020 7b27 6e61              {'na
-0007ff10: 6d65 273a 2027 6c61 6265 6c5f 616c 745f  me': 'label_alt_
-0007ff20: 6964 272c 2027 7479 7065 273a 2027 656e  id', 'type': 'en
-0007ff30: 756d 272c 0a20 2020 2020 2020 2020 2020  um',.           
-0007ff40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ff50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ff60: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0007ff70: 656e 756d 273a 2028 2741 2729 7d0a 2020  enum': ('A')}.  
+0007fda0: 2020 2020 7661 6c75 6554 7970 655b 2772      valueType['r
+0007fdb0: 616e 6765 275d 203d 207b 276d 6178 5f69  ange'] = {'max_i
+0007fdc0: 6e63 6c75 7369 7665 273a 2061 7474 725f  nclusive': attr_
+0007fdd0: 7661 6c75 657d 0a20 2020 2020 2020 2020  value}.         
+0007fde0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+0007fdf0: 6f70 436f 6465 203d 3d20 273e 3d27 3a0a  opCode == '>=':.
+0007fe00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007fe10: 2020 2020 2020 2020 7661 6c75 6554 7970          valueTyp
+0007fe20: 655b 2774 7970 6527 5d20 3d20 2772 616e  e['type'] = 'ran
+0007fe30: 6765 2d66 6c6f 6174 2720 6966 206e 6f74  ge-float' if not
+0007fe40: 2061 6273 6f6c 7574 6520 656c 7365 2027   absolute else '
+0007fe50: 7261 6e67 652d 6162 732d 666c 6f61 7427  range-abs-float'
+0007fe60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0007fe70: 2020 2020 2020 2020 2076 616c 7565 5479           valueTy
+0007fe80: 7065 5b27 7261 6e67 6527 5d20 3d20 7b27  pe['range'] = {'
+0007fe90: 6d69 6e5f 696e 636c 7573 6976 6527 3a20  min_inclusive': 
+0007fea0: 6174 7472 5f76 616c 7565 7d0a 2020 2020  attr_value}.    
+0007feb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0007fec0: 656c 6966 206f 7043 6f64 6520 3d3d 2027  elif opCode == '
+0007fed0: 2327 3a0a 2020 2020 2020 2020 2020 2020  #':.            
+0007fee0: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+0007fef0: 6554 7970 655b 2774 7970 6527 5d20 3d20  eType['type'] = 
+0007ff00: 2772 616e 6765 2d66 6c6f 6174 2720 6966  'range-float' if
+0007ff10: 206e 6f74 2061 6273 6f6c 7574 6520 656c   not absolute el
+0007ff20: 7365 2027 7261 6e67 652d 6162 732d 666c  se 'range-abs-fl
+0007ff30: 6f61 7427 0a20 2020 2020 2020 2020 2020  oat'.           
+0007ff40: 2020 2020 2020 2020 2020 2020 2076 616c               val
+0007ff50: 7565 5479 7065 5b27 7261 6e67 6527 5d20  ueType['range'] 
+0007ff60: 3d20 7b27 6e6f 745f 6571 7561 6c5f 746f  = {'not_equal_to
+0007ff70: 273a 2061 7474 725f 7661 6c75 657d 0a20  ': attr_value}. 
 0007ff80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ff90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ffa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0007ffb0: 2020 2020 2020 205d 290a 0a20 2020 2020         ])..     
-0007ffc0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0007ffd0: 656c 662e 696e 7465 7273 6563 7469 6f6e  elf.intersection
-0007ffe0: 4661 6374 6f72 5f65 7870 7265 7373 696f  Factor_expressio
-0007fff0: 6e73 2861 746f 6d53 656c 6563 7469 6f6e  ns(atomSelection
-00080000: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-00080010: 2020 2065 6c69 6620 6174 7472 5f70 726f     elif attr_pro
-00080020: 702e 7374 6172 7473 7769 7468 2827 6263  p.startswith('bc
-00080030: 6f6d 2729 5c0a 2020 2020 2020 2020 2020  om')\.          
-00080040: 2020 2020 2020 2020 2020 2020 2020 6f72                or
-00080050: 2061 7474 725f 7072 6f70 2e73 7461 7274   attr_prop.start
-00080060: 7377 6974 6828 2771 636f 6d27 295c 0a20  swith('qcom')\. 
-00080070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00080080: 2020 2020 2020 206f 7220 6174 7472 5f70         or attr_p
-00080090: 726f 702e 7374 6172 7473 7769 7468 2827  rop.startswith('
-000800a0: 7863 6f6d 2729 5c0a 2020 2020 2020 2020  xcom')\.        
-000800b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000800c0: 6f72 2061 7474 725f 7072 6f70 2e73 7461  or attr_prop.sta
-000800d0: 7274 7377 6974 6828 2779 636f 6d27 295c  rtswith('ycom')\
+0007ff90: 2020 2061 746f 6d53 656c 6563 7469 6f6e     atomSelection
+0007ffa0: 203d 5c0a 2020 2020 2020 2020 2020 2020   =\.            
+0007ffb0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0007ffc0: 2e5f 5f63 522e 6765 7444 6963 744c 6973  .__cR.getDictLis
+0007ffd0: 7457 6974 6846 696c 7465 7228 2761 746f  tWithFilter('ato
+0007ffe0: 6d5f 7369 7465 272c 0a20 2020 2020 2020  m_site',.       
+0007fff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080020: 2041 5554 485f 4154 4f4d 5f44 4154 415f   AUTH_ATOM_DATA_
+00080030: 4954 454d 532c 0a20 2020 2020 2020 2020  ITEMS,.         
+00080040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080060: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+00080070: 7661 6c75 6554 7970 652c 0a20 2020 2020  valueType,.     
+00080080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000800a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000800b0: 2020 2020 7b27 6e61 6d65 273a 2073 656c      {'name': sel
+000800c0: 662e 5f5f 6d6f 6465 6c4e 756d 4e61 6d65  f.__modelNumName
+000800d0: 2c20 2774 7970 6527 3a20 2769 6e74 272c  , 'type': 'int',
 000800e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000800f0: 2020 2020 2020 2020 206f 7220 6174 7472           or attr
-00080100: 5f70 726f 702e 7374 6172 7473 7769 7468  _prop.startswith
-00080110: 2827 7a63 6f6d 2729 3a20 2023 2042 434f  ('zcom'):  # BCO
-00080120: 4d50 2c20 5143 4f4d 502c 2058 434f 4d50  MP, QCOMP, XCOMP
-00080130: 2c20 5943 4f4d 502c 205a 434f 4d60 0a20  , YCOMP, ZCOM`. 
-00080140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00080150: 2020 2073 656c 662e 6661 6374 6f72 5b27     self.factor['
-00080160: 6174 6f6d 5f69 6427 5d20 3d20 5b4e 6f6e  atom_id'] = [Non
-00080170: 655d 0a20 2020 2020 2020 2020 2020 2020  e].             
-00080180: 2020 2020 2020 2073 656c 662e 5f5f 662e         self.__f.
-00080190: 6170 7065 6e64 2866 225b 556e 7375 7070  append(f"[Unsupp
-000801a0: 6f72 7465 6420 6461 7461 5d20 7b73 656c  orted data] {sel
-000801b0: 662e 5f5f 6765 7443 7572 7265 6e74 5265  f.__getCurrentRe
-000801c0: 7374 7261 696e 7428 297d 220a 2020 2020  straint()}".    
-000801d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000801e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000801f0: 6622 5468 6520 6174 7472 6962 7574 6520  f"The attribute 
-00080200: 7072 6f70 6572 7479 207b 5f61 7474 725f  property {_attr_
-00080210: 7072 6f70 2172 7d20 220a 2020 2020 2020  prop!r} ".      
-00080220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00080230: 2020 2020 2020 2020 2020 2020 2020 2272                "r
-00080240: 6571 7569 7265 7320 6120 636f 6d70 6172  equires a compar
-00080250: 6973 6f6e 2063 6f6f 7264 696e 6174 6520  ison coordinate 
-00080260: 7365 742e 2229 0a20 2020 2020 2020 2020  set.").         
-00080270: 2020 2020 2020 2020 2020 2076 616c 6964             valid
-00080280: 5072 6f70 203d 2046 616c 7365 0a0a 2020  Prop = False..  
-00080290: 2020 2020 2020 2020 2020 2020 2020 656c                el
-000802a0: 6966 2061 7474 725f 7072 6f70 2e73 7461  if attr_prop.sta
-000802b0: 7274 7377 6974 6828 2763 6861 7227 293a  rtswith('char'):
-000802c0: 2020 2320 4341 4852 4745 0a20 2020 2020    # CAHRGE.     
-000802d0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-000802e0: 616c 7565 5479 7065 203d 207b 276e 616d  alueType = {'nam
-000802f0: 6527 3a20 2770 6462 785f 666f 726d 616c  e': 'pdbx_formal
-00080300: 5f63 6861 7267 6527 7d0a 2020 2020 2020  _charge'}.      
-00080310: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00080320: 206f 7043 6f64 6520 3d3d 2027 3d27 3a0a   opCode == '=':.
-00080330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00080340: 2020 2020 2020 2020 7661 6c75 6554 7970          valueTyp
-00080350: 655b 2774 7970 6527 5d20 3d20 2769 6e74  e['type'] = 'int
-00080360: 2720 6966 206e 6f74 2061 6273 6f6c 7574  ' if not absolut
-00080370: 6520 656c 7365 2027 6162 732d 696e 7427  e else 'abs-int'
-00080380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00080390: 2020 2020 2020 2020 2076 616c 7565 5479           valueTy
-000803a0: 7065 5b27 7661 6c75 6527 5d20 3d20 6174  pe['value'] = at
-000803b0: 7472 5f76 616c 7565 0a20 2020 2020 2020  tr_value.       
-000803c0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-000803d0: 6620 6f70 436f 6465 203d 3d20 273c 273a  f opCode == '<':
-000803e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000803f0: 2020 2020 2020 2020 2076 616c 7565 5479           valueTy
-00080400: 7065 5b27 7479 7065 275d 203d 2027 7261  pe['type'] = 'ra
-00080410: 6e67 652d 696e 7427 2069 6620 6e6f 7420  nge-int' if not 
-00080420: 6162 736f 6c75 7465 2065 6c73 6520 2772  absolute else 'r
-00080430: 616e 6765 2d61 6273 2d69 6e74 270a 2020  ange-abs-int'.  
+000800f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080110: 2020 2020 2020 2020 2020 2027 7661 6c75             'valu
+00080120: 6527 3a20 7365 6c66 2e5f 5f72 6570 7265  e': self.__repre
+00080130: 7365 6e74 6174 6976 654d 6f64 656c 4964  sentativeModelId
+00080140: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
+00080150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080170: 2020 2020 2020 2020 2020 2020 7b27 6e61              {'na
+00080180: 6d65 273a 2027 6c61 6265 6c5f 616c 745f  me': 'label_alt_
+00080190: 6964 272c 2027 7479 7065 273a 2027 656e  id', 'type': 'en
+000801a0: 756d 272c 0a20 2020 2020 2020 2020 2020  um',.           
+000801b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000801c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000801d0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+000801e0: 656e 756d 273a 2028 2741 2729 7d0a 2020  enum': ('A')}.  
+000801f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080220: 2020 2020 2020 205d 290a 0a20 2020 2020         ])..     
+00080230: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00080240: 656c 662e 696e 7465 7273 6563 7469 6f6e  elf.intersection
+00080250: 4661 6374 6f72 5f65 7870 7265 7373 696f  Factor_expressio
+00080260: 6e73 2861 746f 6d53 656c 6563 7469 6f6e  ns(atomSelection
+00080270: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+00080280: 2020 2065 6c69 6620 6174 7472 5f70 726f     elif attr_pro
+00080290: 702e 7374 6172 7473 7769 7468 2827 6263  p.startswith('bc
+000802a0: 6f6d 2729 5c0a 2020 2020 2020 2020 2020  om')\.          
+000802b0: 2020 2020 2020 2020 2020 2020 2020 6f72                or
+000802c0: 2061 7474 725f 7072 6f70 2e73 7461 7274   attr_prop.start
+000802d0: 7377 6974 6828 2771 636f 6d27 295c 0a20  swith('qcom')\. 
+000802e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000802f0: 2020 2020 2020 206f 7220 6174 7472 5f70         or attr_p
+00080300: 726f 702e 7374 6172 7473 7769 7468 2827  rop.startswith('
+00080310: 7863 6f6d 2729 5c0a 2020 2020 2020 2020  xcom')\.        
+00080320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080330: 6f72 2061 7474 725f 7072 6f70 2e73 7461  or attr_prop.sta
+00080340: 7274 7377 6974 6828 2779 636f 6d27 295c  rtswith('ycom')\
+00080350: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00080360: 2020 2020 2020 2020 206f 7220 6174 7472           or attr
+00080370: 5f70 726f 702e 7374 6172 7473 7769 7468  _prop.startswith
+00080380: 2827 7a63 6f6d 2729 3a20 2023 2042 434f  ('zcom'):  # BCO
+00080390: 4d50 2c20 5143 4f4d 502c 2058 434f 4d50  MP, QCOMP, XCOMP
+000803a0: 2c20 5943 4f4d 502c 205a 434f 4d60 0a20  , YCOMP, ZCOM`. 
+000803b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000803c0: 2020 2073 656c 662e 6661 6374 6f72 5b27     self.factor['
+000803d0: 6174 6f6d 5f69 6427 5d20 3d20 5b4e 6f6e  atom_id'] = [Non
+000803e0: 655d 0a20 2020 2020 2020 2020 2020 2020  e].             
+000803f0: 2020 2020 2020 2073 656c 662e 5f5f 662e         self.__f.
+00080400: 6170 7065 6e64 2866 225b 556e 7375 7070  append(f"[Unsupp
+00080410: 6f72 7465 6420 6461 7461 5d20 7b73 656c  orted data] {sel
+00080420: 662e 5f5f 6765 7443 7572 7265 6e74 5265  f.__getCurrentRe
+00080430: 7374 7261 696e 7428 297d 220a 2020 2020  straint()}".    
 00080440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00080450: 2020 2020 2020 7661 6c75 6554 7970 655b        valueType[
-00080460: 2772 616e 6765 275d 203d 207b 276d 6178  'range'] = {'max
-00080470: 5f65 7863 6c75 7369 7665 273a 2061 7474  _exclusive': att
-00080480: 725f 7661 6c75 657d 0a20 2020 2020 2020  r_value}.       
-00080490: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-000804a0: 6620 6f70 436f 6465 203d 3d20 273e 273a  f opCode == '>':
-000804b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000804c0: 2020 2020 2020 2020 2076 616c 7565 5479           valueTy
-000804d0: 7065 5b27 7479 7065 275d 203d 2027 7261  pe['type'] = 'ra
-000804e0: 6e67 652d 696e 7427 2069 6620 6e6f 7420  nge-int' if not 
-000804f0: 6162 736f 6c75 7465 2065 6c73 6520 2772  absolute else 'r
-00080500: 616e 6765 2d61 6273 2d69 6e74 270a 2020  ange-abs-int'.  
-00080510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00080520: 2020 2020 2020 7661 6c75 6554 7970 655b        valueType[
-00080530: 2772 616e 6765 275d 203d 207b 276d 696e  'range'] = {'min
-00080540: 5f65 7863 6c75 7369 7665 273a 2061 7474  _exclusive': att
-00080550: 725f 7661 6c75 657d 0a20 2020 2020 2020  r_value}.       
-00080560: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-00080570: 6620 6f70 436f 6465 203d 3d20 273c 3d27  f opCode == '<='
-00080580: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00080590: 2020 2020 2020 2020 2020 7661 6c75 6554            valueT
-000805a0: 7970 655b 2774 7970 6527 5d20 3d20 2772  ype['type'] = 'r
-000805b0: 616e 6765 2d69 6e74 2720 6966 206e 6f74  ange-int' if not
-000805c0: 2061 6273 6f6c 7574 6520 656c 7365 2027   absolute else '
-000805d0: 7261 6e67 652d 6162 732d 696e 7427 0a20  range-abs-int'. 
-000805e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000805f0: 2020 2020 2020 2076 616c 7565 5479 7065         valueType
-00080600: 5b27 7261 6e67 6527 5d20 3d20 7b27 6d61  ['range'] = {'ma
-00080610: 785f 696e 636c 7573 6976 6527 3a20 6174  x_inclusive': at
-00080620: 7472 5f76 616c 7565 7d0a 2020 2020 2020  tr_value}.      
-00080630: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00080640: 6966 206f 7043 6f64 6520 3d3d 2027 3e3d  if opCode == '>=
-00080650: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
-00080660: 2020 2020 2020 2020 2020 2076 616c 7565             value
-00080670: 5479 7065 5b27 7479 7065 275d 203d 2027  Type['type'] = '
-00080680: 7261 6e67 652d 696e 7427 2069 6620 6e6f  range-int' if no
-00080690: 7420 6162 736f 6c75 7465 2065 6c73 6520  t absolute else 
-000806a0: 2772 616e 6765 2d61 6273 2d69 6e74 270a  'range-abs-int'.
+00080450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080460: 6622 5468 6520 6174 7472 6962 7574 6520  f"The attribute 
+00080470: 7072 6f70 6572 7479 207b 5f61 7474 725f  property {_attr_
+00080480: 7072 6f70 2172 7d20 220a 2020 2020 2020  prop!r} ".      
+00080490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000804a0: 2020 2020 2020 2020 2020 2020 2020 2272                "r
+000804b0: 6571 7569 7265 7320 6120 636f 6d70 6172  equires a compar
+000804c0: 6973 6f6e 2063 6f6f 7264 696e 6174 6520  ison coordinate 
+000804d0: 7365 742e 2229 0a20 2020 2020 2020 2020  set.").         
+000804e0: 2020 2020 2020 2020 2020 2076 616c 6964             valid
+000804f0: 5072 6f70 203d 2046 616c 7365 0a0a 2020  Prop = False..  
+00080500: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00080510: 6966 2061 7474 725f 7072 6f70 2e73 7461  if attr_prop.sta
+00080520: 7274 7377 6974 6828 2763 6861 7227 293a  rtswith('char'):
+00080530: 2020 2320 4341 4852 4745 0a20 2020 2020    # CAHRGE.     
+00080540: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00080550: 616c 7565 5479 7065 203d 207b 276e 616d  alueType = {'nam
+00080560: 6527 3a20 2770 6462 785f 666f 726d 616c  e': 'pdbx_formal
+00080570: 5f63 6861 7267 6527 7d0a 2020 2020 2020  _charge'}.      
+00080580: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00080590: 206f 7043 6f64 6520 3d3d 2027 3d27 3a0a   opCode == '=':.
+000805a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000805b0: 2020 2020 2020 2020 7661 6c75 6554 7970          valueTyp
+000805c0: 655b 2774 7970 6527 5d20 3d20 2769 6e74  e['type'] = 'int
+000805d0: 2720 6966 206e 6f74 2061 6273 6f6c 7574  ' if not absolut
+000805e0: 6520 656c 7365 2027 6162 732d 696e 7427  e else 'abs-int'
+000805f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00080600: 2020 2020 2020 2020 2076 616c 7565 5479           valueTy
+00080610: 7065 5b27 7661 6c75 6527 5d20 3d20 6174  pe['value'] = at
+00080620: 7472 5f76 616c 7565 0a20 2020 2020 2020  tr_value.       
+00080630: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+00080640: 6620 6f70 436f 6465 203d 3d20 273c 273a  f opCode == '<':
+00080650: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00080660: 2020 2020 2020 2020 2076 616c 7565 5479           valueTy
+00080670: 7065 5b27 7479 7065 275d 203d 2027 7261  pe['type'] = 'ra
+00080680: 6e67 652d 696e 7427 2069 6620 6e6f 7420  nge-int' if not 
+00080690: 6162 736f 6c75 7465 2065 6c73 6520 2772  absolute else 'r
+000806a0: 616e 6765 2d61 6273 2d69 6e74 270a 2020  ange-abs-int'.  
 000806b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000806c0: 2020 2020 2020 2020 7661 6c75 6554 7970          valueTyp
-000806d0: 655b 2772 616e 6765 275d 203d 207b 276d  e['range'] = {'m
-000806e0: 696e 5f69 6e63 6c75 7369 7665 273a 2061  in_inclusive': a
-000806f0: 7474 725f 7661 6c75 657d 0a20 2020 2020  ttr_value}.     
-00080700: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00080710: 6c69 6620 6f70 436f 6465 203d 3d20 2723  lif opCode == '#
-00080720: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
-00080730: 2020 2020 2020 2020 2020 2076 616c 7565             value
-00080740: 5479 7065 5b27 7479 7065 275d 203d 2027  Type['type'] = '
-00080750: 7261 6e67 652d 696e 7427 2069 6620 6e6f  range-int' if no
-00080760: 7420 6162 736f 6c75 7465 2065 6c73 6520  t absolute else 
-00080770: 2772 616e 6765 2d61 6273 2d69 6e74 270a  'range-abs-int'.
+000806c0: 2020 2020 2020 7661 6c75 6554 7970 655b        valueType[
+000806d0: 2772 616e 6765 275d 203d 207b 276d 6178  'range'] = {'max
+000806e0: 5f65 7863 6c75 7369 7665 273a 2061 7474  _exclusive': att
+000806f0: 725f 7661 6c75 657d 0a20 2020 2020 2020  r_value}.       
+00080700: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+00080710: 6620 6f70 436f 6465 203d 3d20 273e 273a  f opCode == '>':
+00080720: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00080730: 2020 2020 2020 2020 2076 616c 7565 5479           valueTy
+00080740: 7065 5b27 7479 7065 275d 203d 2027 7261  pe['type'] = 'ra
+00080750: 6e67 652d 696e 7427 2069 6620 6e6f 7420  nge-int' if not 
+00080760: 6162 736f 6c75 7465 2065 6c73 6520 2772  absolute else 'r
+00080770: 616e 6765 2d61 6273 2d69 6e74 270a 2020  ange-abs-int'.  
 00080780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00080790: 2020 2020 2020 2020 7661 6c75 6554 7970          valueTyp
-000807a0: 655b 2772 616e 6765 275d 203d 207b 276e  e['range'] = {'n
-000807b0: 6f74 5f65 7175 616c 5f74 6f27 3a20 6174  ot_equal_to': at
-000807c0: 7472 5f76 616c 7565 7d0a 2020 2020 2020  tr_value}.      
-000807d0: 2020 2020 2020 2020 2020 2020 2020 6174                at
-000807e0: 6f6d 5365 6c65 6374 696f 6e20 3d5c 0a20  omSelection =\. 
-000807f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00080800: 2020 2020 2020 2073 656c 662e 5f5f 6352         self.__cR
-00080810: 2e67 6574 4469 6374 4c69 7374 5769 7468  .getDictListWith
-00080820: 4669 6c74 6572 2827 6174 6f6d 5f73 6974  Filter('atom_sit
-00080830: 6527 2c0a 2020 2020 2020 2020 2020 2020  e',.            
-00080840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080790: 2020 2020 2020 7661 6c75 6554 7970 655b        valueType[
+000807a0: 2772 616e 6765 275d 203d 207b 276d 696e  'range'] = {'min
+000807b0: 5f65 7863 6c75 7369 7665 273a 2061 7474  _exclusive': att
+000807c0: 725f 7661 6c75 657d 0a20 2020 2020 2020  r_value}.       
+000807d0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+000807e0: 6620 6f70 436f 6465 203d 3d20 273c 3d27  f opCode == '<='
+000807f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00080800: 2020 2020 2020 2020 2020 7661 6c75 6554            valueT
+00080810: 7970 655b 2774 7970 6527 5d20 3d20 2772  ype['type'] = 'r
+00080820: 616e 6765 2d69 6e74 2720 6966 206e 6f74  ange-int' if not
+00080830: 2061 6273 6f6c 7574 6520 656c 7365 2027   absolute else '
+00080840: 7261 6e67 652d 6162 732d 696e 7427 0a20  range-abs-int'. 
 00080850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00080860: 2020 2020 2020 2020 2020 2020 4155 5448              AUTH
-00080870: 5f41 544f 4d5f 4441 5441 5f49 5445 4d53  _ATOM_DATA_ITEMS
-00080880: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00080890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000808a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000808b0: 2020 2020 2020 2020 2020 5b76 616c 7565            [value
-000808c0: 5479 7065 2c0a 2020 2020 2020 2020 2020  Type,.          
-000808d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000808e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000808f0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-00080900: 276e 616d 6527 3a20 7365 6c66 2e5f 5f6d  'name': self.__m
-00080910: 6f64 656c 4e75 6d4e 616d 652c 2027 7479  odelNumName, 'ty
-00080920: 7065 273a 2027 696e 7427 2c0a 2020 2020  pe': 'int',.    
-00080930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00080940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00080950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00080960: 2020 2020 2020 2776 616c 7565 273a 2073        'value': s
-00080970: 656c 662e 5f5f 7265 7072 6573 656e 7461  elf.__representa
-00080980: 7469 7665 4d6f 6465 6c49 647d 2c0a 2020  tiveModelId},.  
-00080990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000809a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000809b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000809c0: 2020 2020 2020 207b 276e 616d 6527 3a20         {'name': 
-000809d0: 276c 6162 656c 5f61 6c74 5f69 6427 2c20  'label_alt_id', 
-000809e0: 2774 7970 6527 3a20 2765 6e75 6d27 2c0a  'type': 'enum',.
+00080860: 2020 2020 2020 2076 616c 7565 5479 7065         valueType
+00080870: 5b27 7261 6e67 6527 5d20 3d20 7b27 6d61  ['range'] = {'ma
+00080880: 785f 696e 636c 7573 6976 6527 3a20 6174  x_inclusive': at
+00080890: 7472 5f76 616c 7565 7d0a 2020 2020 2020  tr_value}.      
+000808a0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+000808b0: 6966 206f 7043 6f64 6520 3d3d 2027 3e3d  if opCode == '>=
+000808c0: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
+000808d0: 2020 2020 2020 2020 2020 2076 616c 7565             value
+000808e0: 5479 7065 5b27 7479 7065 275d 203d 2027  Type['type'] = '
+000808f0: 7261 6e67 652d 696e 7427 2069 6620 6e6f  range-int' if no
+00080900: 7420 6162 736f 6c75 7465 2065 6c73 6520  t absolute else 
+00080910: 2772 616e 6765 2d61 6273 2d69 6e74 270a  'range-abs-int'.
+00080920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080930: 2020 2020 2020 2020 7661 6c75 6554 7970          valueTyp
+00080940: 655b 2772 616e 6765 275d 203d 207b 276d  e['range'] = {'m
+00080950: 696e 5f69 6e63 6c75 7369 7665 273a 2061  in_inclusive': a
+00080960: 7474 725f 7661 6c75 657d 0a20 2020 2020  ttr_value}.     
+00080970: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00080980: 6c69 6620 6f70 436f 6465 203d 3d20 2723  lif opCode == '#
+00080990: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
+000809a0: 2020 2020 2020 2020 2020 2076 616c 7565             value
+000809b0: 5479 7065 5b27 7479 7065 275d 203d 2027  Type['type'] = '
+000809c0: 7261 6e67 652d 696e 7427 2069 6620 6e6f  range-int' if no
+000809d0: 7420 6162 736f 6c75 7465 2065 6c73 6520  t absolute else 
+000809e0: 2772 616e 6765 2d61 6273 2d69 6e74 270a  'range-abs-int'.
 000809f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00080a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00080a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00080a20: 2020 2020 2020 2020 2020 2765 6e75 6d27            'enum'
-00080a30: 3a20 2827 4127 297d 0a20 2020 2020 2020  : ('A')}.       
-00080a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00080a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080a00: 2020 2020 2020 2020 7661 6c75 6554 7970          valueTyp
+00080a10: 655b 2772 616e 6765 275d 203d 207b 276e  e['range'] = {'n
+00080a20: 6f74 5f65 7175 616c 5f74 6f27 3a20 6174  ot_equal_to': at
+00080a30: 7472 5f76 616c 7565 7d0a 2020 2020 2020  tr_value}.      
+00080a40: 2020 2020 2020 2020 2020 2020 2020 6174                at
+00080a50: 6f6d 5365 6c65 6374 696f 6e20 3d5c 0a20  omSelection =\. 
 00080a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00080a70: 2020 5d29 0a0a 2020 2020 2020 2020 2020    ])..          
-00080a80: 2020 2020 2020 2020 2020 7365 6c66 2e69            self.i
-00080a90: 6e74 6572 7365 6374 696f 6e46 6163 746f  ntersectionFacto
-00080aa0: 725f 6578 7072 6573 7369 6f6e 7328 6174  r_expressions(at
-00080ab0: 6f6d 5365 6c65 6374 696f 6e29 0a0a 2020  omSelection)..  
-00080ac0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00080ad0: 6966 2061 7474 725f 7072 6f70 2069 6e20  if attr_prop in 
-00080ae0: 2827 6478 272c 2027 6479 272c 2027 647a  ('dx', 'dy', 'dz
-00080af0: 272c 2027 6861 726d 2729 3a0a 2020 2020  ', 'harm'):.    
+00080a70: 2020 2020 2020 2073 656c 662e 5f5f 6352         self.__cR
+00080a80: 2e67 6574 4469 6374 4c69 7374 5769 7468  .getDictListWith
+00080a90: 4669 6c74 6572 2827 6174 6f6d 5f73 6974  Filter('atom_sit
+00080aa0: 6527 2c0a 2020 2020 2020 2020 2020 2020  e',.            
+00080ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080ad0: 2020 2020 2020 2020 2020 2020 4155 5448              AUTH
+00080ae0: 5f41 544f 4d5f 4441 5441 5f49 5445 4d53  _ATOM_DATA_ITEMS
+00080af0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
 00080b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00080b10: 7365 6c66 2e66 6163 746f 725b 2761 746f  self.factor['ato
-00080b20: 6d5f 6964 275d 203d 205b 4e6f 6e65 5d0a  m_id'] = [None].
-00080b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00080b40: 2020 2020 7365 6c66 2e5f 5f66 2e61 7070      self.__f.app
-00080b50: 656e 6428 6622 5b55 6e73 7570 706f 7274  end(f"[Unsupport
-00080b60: 6564 2064 6174 615d 207b 7365 6c66 2e5f  ed data] {self._
-00080b70: 5f67 6574 4375 7272 656e 7452 6573 7472  _getCurrentRestr
-00080b80: 6169 6e74 2829 7d22 0a20 2020 2020 2020  aint()}".       
-00080b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00080ba0: 2020 2020 2020 2020 2020 2020 2066 2254               f"T
-00080bb0: 6865 2061 7474 7269 6275 7465 2070 726f  he attribute pro
-00080bc0: 7065 7274 7920 7b5f 6174 7472 5f70 726f  perty {_attr_pro
-00080bd0: 7021 727d 2022 0a20 2020 2020 2020 2020  p!r} ".         
-00080be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00080bf0: 2020 2020 2020 2020 2020 2022 7265 6c61             "rela
-00080c00: 7465 6420 746f 2061 746f 6d69 6320 666f  ted to atomic fo
-00080c10: 7263 6520 6f66 2065 6163 6820 6174 6f6d  rce of each atom
-00080c20: 2069 7320 6e6f 7420 706f 7373 6573 7365   is not possesse
-00080c30: 6420 696e 2074 6865 2073 7461 7469 6320  d in the static 
-00080c40: 636f 6f72 6469 6e61 7465 2066 696c 652e  coordinate file.
-00080c50: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
-00080c60: 2020 2020 2020 2076 616c 6964 5072 6f70         validProp
-00080c70: 203d 2046 616c 7365 0a0a 2020 2020 2020   = False..      
-00080c80: 2020 2020 2020 2020 2020 656c 6966 2061            elif a
-00080c90: 7474 725f 7072 6f70 2e73 7461 7274 7377  ttr_prop.startsw
-00080ca0: 6974 6828 2766 6265 7427 293a 2020 2320  ith('fbet'):  # 
-00080cb0: 4642 4554 410a 2020 2020 2020 2020 2020  FBETA.          
-00080cc0: 2020 2020 2020 2020 2020 7365 6c66 2e66            self.f
-00080cd0: 6163 746f 725b 2761 746f 6d5f 6964 275d  actor['atom_id']
-00080ce0: 203d 205b 4e6f 6e65 5d0a 2020 2020 2020   = [None].      
-00080cf0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00080d00: 6c66 2e5f 5f66 2e61 7070 656e 6428 6622  lf.__f.append(f"
-00080d10: 5b55 6e73 7570 706f 7274 6564 2064 6174  [Unsupported dat
-00080d20: 615d 207b 7365 6c66 2e5f 5f67 6574 4375  a] {self.__getCu
-00080d30: 7272 656e 7452 6573 7472 6169 6e74 2829  rrentRestraint()
-00080d40: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
-00080d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00080d60: 2020 2020 2020 2066 2254 6865 2061 7474         f"The att
-00080d70: 7269 6275 7465 2070 726f 7065 7274 7920  ribute property 
-00080d80: 7b5f 6174 7472 5f70 726f 7021 727d 2022  {_attr_prop!r} "
-00080d90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00080b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080b20: 2020 2020 2020 2020 2020 5b76 616c 7565            [value
+00080b30: 5479 7065 2c0a 2020 2020 2020 2020 2020  Type,.          
+00080b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080b60: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+00080b70: 276e 616d 6527 3a20 7365 6c66 2e5f 5f6d  'name': self.__m
+00080b80: 6f64 656c 4e75 6d4e 616d 652c 2027 7479  odelNumName, 'ty
+00080b90: 7065 273a 2027 696e 7427 2c0a 2020 2020  pe': 'int',.    
+00080ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080bd0: 2020 2020 2020 2776 616c 7565 273a 2073        'value': s
+00080be0: 656c 662e 5f5f 7265 7072 6573 656e 7461  elf.__representa
+00080bf0: 7469 7665 4d6f 6465 6c49 647d 2c0a 2020  tiveModelId},.  
+00080c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080c30: 2020 2020 2020 207b 276e 616d 6527 3a20         {'name': 
+00080c40: 276c 6162 656c 5f61 6c74 5f69 6427 2c20  'label_alt_id', 
+00080c50: 2774 7970 6527 3a20 2765 6e75 6d27 2c0a  'type': 'enum',.
+00080c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080c90: 2020 2020 2020 2020 2020 2765 6e75 6d27            'enum'
+00080ca0: 3a20 2827 4127 297d 0a20 2020 2020 2020  : ('A')}.       
+00080cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080ce0: 2020 5d29 0a0a 2020 2020 2020 2020 2020    ])..          
+00080cf0: 2020 2020 2020 2020 2020 7365 6c66 2e69            self.i
+00080d00: 6e74 6572 7365 6374 696f 6e46 6163 746f  ntersectionFacto
+00080d10: 725f 6578 7072 6573 7369 6f6e 7328 6174  r_expressions(at
+00080d20: 6f6d 5365 6c65 6374 696f 6e29 0a0a 2020  omSelection)..  
+00080d30: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00080d40: 6966 2061 7474 725f 7072 6f70 2069 6e20  if attr_prop in 
+00080d50: 2827 6478 272c 2027 6479 272c 2027 647a  ('dx', 'dy', 'dz
+00080d60: 272c 2027 6861 726d 2729 3a0a 2020 2020  ', 'harm'):.    
+00080d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080d80: 7365 6c66 2e66 6163 746f 725b 2761 746f  self.factor['ato
+00080d90: 6d5f 6964 275d 203d 205b 4e6f 6e65 5d0a  m_id'] = [None].
 00080da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00080db0: 2020 2020 2022 7265 6c61 7465 6420 746f       "related to
-00080dc0: 2074 6865 204c 616e 6765 7669 6e20 6479   the Langevin dy
-00080dd0: 6e61 6d69 6373 2028 6e6f 6e7a 6572 6f20  namics (nonzero 
-00080de0: 6672 6963 7469 6f6e 2063 6f65 6666 6963  friction coeffic
-00080df0: 6965 6e74 2920 6973 206e 6f74 2070 6f73  ient) is not pos
-00080e00: 7365 7373 6564 2069 6e20 7468 6520 7374  sessed in the st
-00080e10: 6174 6963 2063 6f6f 7264 696e 6174 6520  atic coordinate 
-00080e20: 6669 6c65 2e22 290a 2020 2020 2020 2020  file.").        
-00080e30: 2020 2020 2020 2020 2020 2020 7661 6c69              vali
-00080e40: 6450 726f 7020 3d20 4661 6c73 650a 0a20  dProp = False.. 
-00080e50: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00080e60: 6c69 6620 6174 7472 5f70 726f 7020 3d3d  lif attr_prop ==
-00080e70: 2027 6d61 7373 273a 0a20 2020 2020 2020   'mass':.       
-00080e80: 2020 2020 2020 2020 2020 2020 205f 7479               _ty
-00080e90: 7065 5379 6d62 6f6c 5365 6c65 6374 203d  peSymbolSelect =
-00080ea0: 2073 6574 2829 0a20 2020 2020 2020 2020   set().         
-00080eb0: 2020 2020 2020 2020 2020 2061 746f 6d54             atomT
-00080ec0: 7970 6573 203d 2073 656c 662e 5f5f 6352  ypes = self.__cR
-00080ed0: 2e67 6574 4469 6374 4c69 7374 2827 6174  .getDictList('at
-00080ee0: 6f6d 5f74 7970 6527 290a 2020 2020 2020  om_type').      
-00080ef0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00080f00: 206c 656e 2861 746f 6d54 7970 6573 2920   len(atomTypes) 
-00080f10: 3e20 3020 616e 6420 2773 796d 626f 6c27  > 0 and 'symbol'
-00080f20: 2069 6e20 6174 6f6d 5479 7065 735b 305d   in atomTypes[0]
-00080f30: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00080f40: 2020 2020 2020 2020 2020 666f 7220 6174            for at
-00080f50: 6f6d 5479 7065 2069 6e20 6174 6f6d 5479  omType in atomTy
-00080f60: 7065 733a 0a20 2020 2020 2020 2020 2020  pes:.           
-00080f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00080f80: 2074 7970 6553 796d 626f 6c20 3d20 6174   typeSymbol = at
-00080f90: 6f6d 5479 7065 5b27 7379 6d62 6f6c 275d  omType['symbol']
-00080fa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00080fb0: 2020 2020 2020 2020 2020 2020 2061 746f               ato
-00080fc0: 6d69 634e 756d 6265 7220 3d20 696e 745f  micNumber = int_
-00080fd0: 6174 6f6d 2874 7970 6553 796d 626f 6c29  atom(typeSymbol)
-00080fe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00080ff0: 2020 2020 2020 2020 2020 2020 2061 746f               ato
-00081000: 6d69 6357 6569 6768 7420 3d20 454c 454d  micWeight = ELEM
-00081010: 454e 545f 5745 4947 4854 535b 6174 6f6d  ENT_WEIGHTS[atom
-00081020: 6963 4e75 6d62 6572 5d0a 0a20 2020 2020  icNumber]..     
-00081030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081040: 2020 2020 2020 2069 6620 286f 7043 6f64         if (opCod
-00081050: 6520 3d3d 2027 3d27 2061 6e64 2061 746f  e == '=' and ato
-00081060: 6d69 6357 6569 6768 7420 3d3d 2061 7474  micWeight == att
-00081070: 725f 7661 6c75 6529 5c0a 2020 2020 2020  r_value)\.      
-00081080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081090: 2020 2020 2020 2020 206f 7220 286f 7043           or (opC
-000810a0: 6f64 6520 3d3d 2027 3c27 2061 6e64 2061  ode == '<' and a
-000810b0: 746f 6d69 6357 6569 6768 7420 3c20 6174  tomicWeight < at
-000810c0: 7472 5f76 616c 7565 295c 0a20 2020 2020  tr_value)\.     
-000810d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000810e0: 2020 2020 2020 2020 2020 6f72 2028 6f70            or (op
-000810f0: 436f 6465 203d 3d20 273e 2720 616e 6420  Code == '>' and 
-00081100: 6174 6f6d 6963 5765 6967 6874 203e 2061  atomicWeight > a
-00081110: 7474 725f 7661 6c75 6529 5c0a 2020 2020  ttr_value)\.    
-00081120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081130: 2020 2020 2020 2020 2020 206f 7220 286f             or (o
-00081140: 7043 6f64 6520 3d3d 2027 3c3d 2720 616e  pCode == '<=' an
-00081150: 6420 6174 6f6d 6963 5765 6967 6874 203c  d atomicWeight <
-00081160: 3d20 6174 7472 5f76 616c 7565 295c 0a20  = attr_value)\. 
-00081170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081180: 2020 2020 2020 2020 2020 2020 2020 6f72                or
-00081190: 2028 6f70 436f 6465 203d 3d20 273e 3d27   (opCode == '>='
-000811a0: 2061 6e64 2061 746f 6d69 6357 6569 6768   and atomicWeigh
-000811b0: 7420 3e3d 2061 7474 725f 7661 6c75 6529  t >= attr_value)
-000811c0: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
-000811d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000811e0: 206f 7220 286f 7043 6f64 6520 3d3d 2027   or (opCode == '
-000811f0: 2327 2061 6e64 2061 746f 6d69 6357 6569  #' and atomicWei
-00081200: 6768 7420 213d 2061 7474 725f 7661 6c75  ght != attr_valu
-00081210: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
-00081220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081230: 2020 2020 5f74 7970 6553 796d 626f 6c53      _typeSymbolS
-00081240: 656c 6563 742e 6164 6428 7479 7065 5379  elect.add(typeSy
-00081250: 6d62 6f6c 290a 0a20 2020 2020 2020 2020  mbol)..         
-00081260: 2020 2020 2020 2020 2020 2061 746f 6d53             atomS
-00081270: 656c 6563 7469 6f6e 203d 5c0a 2020 2020  election =\.    
-00081280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081290: 2020 2020 7365 6c66 2e5f 5f63 522e 6765      self.__cR.ge
-000812a0: 7444 6963 744c 6973 7457 6974 6846 696c  tDictListWithFil
-000812b0: 7465 7228 2761 746f 6d5f 7369 7465 272c  ter('atom_site',
-000812c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000812d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000812e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000812f0: 2020 2020 2020 2020 2041 5554 485f 4154           AUTH_AT
-00081300: 4f4d 5f44 4154 415f 4954 454d 532c 0a20  OM_DATA_ITEMS,. 
-00081310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081340: 2020 2020 2020 205b 7b27 6e61 6d65 273a         [{'name':
-00081350: 2027 7479 7065 5f73 796d 626f 6c27 2c20   'type_symbol', 
-00081360: 2774 7970 6527 3a20 2765 6e75 6d27 2c0a  'type': 'enum',.
-00081370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080db0: 2020 2020 7365 6c66 2e5f 5f66 2e61 7070      self.__f.app
+00080dc0: 656e 6428 6622 5b55 6e73 7570 706f 7274  end(f"[Unsupport
+00080dd0: 6564 2064 6174 615d 207b 7365 6c66 2e5f  ed data] {self._
+00080de0: 5f67 6574 4375 7272 656e 7452 6573 7472  _getCurrentRestr
+00080df0: 6169 6e74 2829 7d22 0a20 2020 2020 2020  aint()}".       
+00080e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080e10: 2020 2020 2020 2020 2020 2020 2066 2254               f"T
+00080e20: 6865 2061 7474 7269 6275 7465 2070 726f  he attribute pro
+00080e30: 7065 7274 7920 7b5f 6174 7472 5f70 726f  perty {_attr_pro
+00080e40: 7021 727d 2022 0a20 2020 2020 2020 2020  p!r} ".         
+00080e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080e60: 2020 2020 2020 2020 2020 2022 7265 6c61             "rela
+00080e70: 7465 6420 746f 2061 746f 6d69 6320 666f  ted to atomic fo
+00080e80: 7263 6520 6f66 2065 6163 6820 6174 6f6d  rce of each atom
+00080e90: 2069 7320 6e6f 7420 706f 7373 6573 7365   is not possesse
+00080ea0: 6420 696e 2074 6865 2073 7461 7469 6320  d in the static 
+00080eb0: 636f 6f72 6469 6e61 7465 2066 696c 652e  coordinate file.
+00080ec0: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+00080ed0: 2020 2020 2020 2076 616c 6964 5072 6f70         validProp
+00080ee0: 203d 2046 616c 7365 0a0a 2020 2020 2020   = False..      
+00080ef0: 2020 2020 2020 2020 2020 656c 6966 2061            elif a
+00080f00: 7474 725f 7072 6f70 2e73 7461 7274 7377  ttr_prop.startsw
+00080f10: 6974 6828 2766 6265 7427 293a 2020 2320  ith('fbet'):  # 
+00080f20: 4642 4554 410a 2020 2020 2020 2020 2020  FBETA.          
+00080f30: 2020 2020 2020 2020 2020 7365 6c66 2e66            self.f
+00080f40: 6163 746f 725b 2761 746f 6d5f 6964 275d  actor['atom_id']
+00080f50: 203d 205b 4e6f 6e65 5d0a 2020 2020 2020   = [None].      
+00080f60: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00080f70: 6c66 2e5f 5f66 2e61 7070 656e 6428 6622  lf.__f.append(f"
+00080f80: 5b55 6e73 7570 706f 7274 6564 2064 6174  [Unsupported dat
+00080f90: 615d 207b 7365 6c66 2e5f 5f67 6574 4375  a] {self.__getCu
+00080fa0: 7272 656e 7452 6573 7472 6169 6e74 2829  rrentRestraint()
+00080fb0: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
+00080fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00080fd0: 2020 2020 2020 2066 2254 6865 2061 7474         f"The att
+00080fe0: 7269 6275 7465 2070 726f 7065 7274 7920  ribute property 
+00080ff0: 7b5f 6174 7472 5f70 726f 7021 727d 2022  {_attr_prop!r} "
+00081000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00081010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081020: 2020 2020 2022 7265 6c61 7465 6420 746f       "related to
+00081030: 2074 6865 204c 616e 6765 7669 6e20 6479   the Langevin dy
+00081040: 6e61 6d69 6373 2028 6e6f 6e7a 6572 6f20  namics (nonzero 
+00081050: 6672 6963 7469 6f6e 2063 6f65 6666 6963  friction coeffic
+00081060: 6965 6e74 2920 6973 206e 6f74 2070 6f73  ient) is not pos
+00081070: 7365 7373 6564 2069 6e20 7468 6520 7374  sessed in the st
+00081080: 6174 6963 2063 6f6f 7264 696e 6174 6520  atic coordinate 
+00081090: 6669 6c65 2e22 290a 2020 2020 2020 2020  file.").        
+000810a0: 2020 2020 2020 2020 2020 2020 7661 6c69              vali
+000810b0: 6450 726f 7020 3d20 4661 6c73 650a 0a20  dProp = False.. 
+000810c0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000810d0: 6c69 6620 6174 7472 5f70 726f 7020 3d3d  lif attr_prop ==
+000810e0: 2027 6d61 7373 273a 0a20 2020 2020 2020   'mass':.       
+000810f0: 2020 2020 2020 2020 2020 2020 205f 7479               _ty
+00081100: 7065 5379 6d62 6f6c 5365 6c65 6374 203d  peSymbolSelect =
+00081110: 2073 6574 2829 0a20 2020 2020 2020 2020   set().         
+00081120: 2020 2020 2020 2020 2020 2061 746f 6d54             atomT
+00081130: 7970 6573 203d 2073 656c 662e 5f5f 6352  ypes = self.__cR
+00081140: 2e67 6574 4469 6374 4c69 7374 2827 6174  .getDictList('at
+00081150: 6f6d 5f74 7970 6527 290a 2020 2020 2020  om_type').      
+00081160: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00081170: 206c 656e 2861 746f 6d54 7970 6573 2920   len(atomTypes) 
+00081180: 3e20 3020 616e 6420 2773 796d 626f 6c27  > 0 and 'symbol'
+00081190: 2069 6e20 6174 6f6d 5479 7065 735b 305d   in atomTypes[0]
+000811a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000811b0: 2020 2020 2020 2020 2020 666f 7220 6174            for at
+000811c0: 6f6d 5479 7065 2069 6e20 6174 6f6d 5479  omType in atomTy
+000811d0: 7065 733a 0a20 2020 2020 2020 2020 2020  pes:.           
+000811e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000811f0: 2074 7970 6553 796d 626f 6c20 3d20 6174   typeSymbol = at
+00081200: 6f6d 5479 7065 5b27 7379 6d62 6f6c 275d  omType['symbol']
+00081210: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00081220: 2020 2020 2020 2020 2020 2020 2061 746f               ato
+00081230: 6d69 634e 756d 6265 7220 3d20 696e 745f  micNumber = int_
+00081240: 6174 6f6d 2874 7970 6553 796d 626f 6c29  atom(typeSymbol)
+00081250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00081260: 2020 2020 2020 2020 2020 2020 2061 746f               ato
+00081270: 6d69 6357 6569 6768 7420 3d20 454c 454d  micWeight = ELEM
+00081280: 454e 545f 5745 4947 4854 535b 6174 6f6d  ENT_WEIGHTS[atom
+00081290: 6963 4e75 6d62 6572 5d0a 0a20 2020 2020  icNumber]..     
+000812a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000812b0: 2020 2020 2020 2069 6620 286f 7043 6f64         if (opCod
+000812c0: 6520 3d3d 2027 3d27 2061 6e64 2061 746f  e == '=' and ato
+000812d0: 6d69 6357 6569 6768 7420 3d3d 2061 7474  micWeight == att
+000812e0: 725f 7661 6c75 6529 5c0a 2020 2020 2020  r_value)\.      
+000812f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081300: 2020 2020 2020 2020 206f 7220 286f 7043           or (opC
+00081310: 6f64 6520 3d3d 2027 3c27 2061 6e64 2061  ode == '<' and a
+00081320: 746f 6d69 6357 6569 6768 7420 3c20 6174  tomicWeight < at
+00081330: 7472 5f76 616c 7565 295c 0a20 2020 2020  tr_value)\.     
+00081340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081350: 2020 2020 2020 2020 2020 6f72 2028 6f70            or (op
+00081360: 436f 6465 203d 3d20 273e 2720 616e 6420  Code == '>' and 
+00081370: 6174 6f6d 6963 5765 6967 6874 203e 2061  atomicWeight > a
+00081380: 7474 725f 7661 6c75 6529 5c0a 2020 2020  ttr_value)\.    
 00081390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000813a0: 2020 2020 2020 2020 2020 2765 6e75 6d27            'enum'
-000813b0: 3a20 5f74 7970 6553 796d 626f 6c53 656c  : _typeSymbolSel
-000813c0: 6563 747d 2c0a 2020 2020 2020 2020 2020  ect},.          
-000813d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000813a0: 2020 2020 2020 2020 2020 206f 7220 286f             or (o
+000813b0: 7043 6f64 6520 3d3d 2027 3c3d 2720 616e  pCode == '<=' an
+000813c0: 6420 6174 6f6d 6963 5765 6967 6874 203c  d atomicWeight <
+000813d0: 3d20 6174 7472 5f76 616c 7565 295c 0a20  = attr_value)\. 
 000813e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000813f0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-00081400: 276e 616d 6527 3a20 7365 6c66 2e5f 5f6d  'name': self.__m
-00081410: 6f64 656c 4e75 6d4e 616d 652c 2027 7479  odelNumName, 'ty
-00081420: 7065 273a 2027 696e 7427 2c0a 2020 2020  pe': 'int',.    
-00081430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000813f0: 2020 2020 2020 2020 2020 2020 2020 6f72                or
+00081400: 2028 6f70 436f 6465 203d 3d20 273e 3d27   (opCode == '>='
+00081410: 2061 6e64 2061 746f 6d69 6357 6569 6768   and atomicWeigh
+00081420: 7420 3e3d 2061 7474 725f 7661 6c75 6529  t >= attr_value)
+00081430: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
 00081440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081460: 2020 2020 2020 2776 616c 7565 273a 2073        'value': s
-00081470: 656c 662e 5f5f 7265 7072 6573 656e 7461  elf.__representa
-00081480: 7469 7665 4d6f 6465 6c49 647d 2c0a 2020  tiveModelId},.  
+00081450: 206f 7220 286f 7043 6f64 6520 3d3d 2027   or (opCode == '
+00081460: 2327 2061 6e64 2061 746f 6d69 6357 6569  #' and atomicWei
+00081470: 6768 7420 213d 2061 7474 725f 7661 6c75  ght != attr_valu
+00081480: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
 00081490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000814a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000814b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000814c0: 2020 2020 2020 207b 276e 616d 6527 3a20         {'name': 
-000814d0: 276c 6162 656c 5f61 6c74 5f69 6427 2c20  'label_alt_id', 
-000814e0: 2774 7970 6527 3a20 2765 6e75 6d27 2c0a  'type': 'enum',.
+000814a0: 2020 2020 5f74 7970 6553 796d 626f 6c53      _typeSymbolS
+000814b0: 656c 6563 742e 6164 6428 7479 7065 5379  elect.add(typeSy
+000814c0: 6d62 6f6c 290a 0a20 2020 2020 2020 2020  mbol)..         
+000814d0: 2020 2020 2020 2020 2020 2061 746f 6d53             atomS
+000814e0: 656c 6563 7469 6f6e 203d 5c0a 2020 2020  election =\.    
 000814f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081520: 2020 2020 2020 2020 2020 2765 6e75 6d27            'enum'
-00081530: 3a20 2827 4127 297d 0a20 2020 2020 2020  : ('A')}.       
+00081500: 2020 2020 7365 6c66 2e5f 5f63 522e 6765      self.__cR.ge
+00081510: 7444 6963 744c 6973 7457 6974 6846 696c  tDictListWithFil
+00081520: 7465 7228 2761 746f 6d5f 7369 7465 272c  ter('atom_site',
+00081530: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00081540: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00081550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081570: 2020 5d29 0a0a 2020 2020 2020 2020 2020    ])..          
-00081580: 2020 2020 2020 2020 2020 7365 6c66 2e69            self.i
-00081590: 6e74 6572 7365 6374 696f 6e46 6163 746f  ntersectionFacto
-000815a0: 725f 6578 7072 6573 7369 6f6e 7328 6174  r_expressions(at
-000815b0: 6f6d 5365 6c65 6374 696f 6e29 0a0a 2020  omSelection)..  
-000815c0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-000815d0: 6966 2061 7474 725f 7072 6f70 203d 3d20  if attr_prop == 
-000815e0: 2771 273a 0a20 2020 2020 2020 2020 2020  'q':.           
-000815f0: 2020 2020 2020 2020 2076 616c 7565 5479           valueTy
-00081600: 7065 203d 207b 276e 616d 6527 3a20 276f  pe = {'name': 'o
-00081610: 6363 7570 616e 6379 277d 0a20 2020 2020  ccupancy'}.     
-00081620: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00081630: 6620 6f70 436f 6465 203d 3d20 273d 273a  f opCode == '=':
-00081640: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00081650: 2020 2020 2020 2020 2076 616c 7565 5479           valueTy
-00081660: 7065 5b27 7479 7065 275d 203d 2027 666c  pe['type'] = 'fl
-00081670: 6f61 7427 2069 6620 6e6f 7420 6162 736f  oat' if not abso
-00081680: 6c75 7465 2065 6c73 6520 2761 6273 2d66  lute else 'abs-f
-00081690: 6c6f 6174 270a 2020 2020 2020 2020 2020  loat'.          
-000816a0: 2020 2020 2020 2020 2020 2020 2020 7661                va
-000816b0: 6c75 6554 7970 655b 2776 616c 7565 275d  lueType['value']
-000816c0: 203d 2061 7474 725f 7661 6c75 650a 2020   = attr_value.  
-000816d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000816e0: 2020 656c 6966 206f 7043 6f64 6520 3d3d    elif opCode ==
-000816f0: 2027 3c27 3a0a 2020 2020 2020 2020 2020   '<':.          
-00081700: 2020 2020 2020 2020 2020 2020 2020 7661                va
-00081710: 6c75 6554 7970 655b 2774 7970 6527 5d20  lueType['type'] 
-00081720: 3d20 2772 616e 6765 2d66 6c6f 6174 2720  = 'range-float' 
-00081730: 6966 206e 6f74 2061 6273 6f6c 7574 6520  if not absolute 
-00081740: 656c 7365 2027 7261 6e67 652d 6162 732d  else 'range-abs-
-00081750: 666c 6f61 7427 0a20 2020 2020 2020 2020  float'.         
-00081760: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-00081770: 616c 7565 5479 7065 5b27 7261 6e67 6527  alueType['range'
-00081780: 5d20 3d20 7b27 6d61 785f 6578 636c 7573  ] = {'max_exclus
-00081790: 6976 6527 3a20 6174 7472 5f76 616c 7565  ive': attr_value
-000817a0: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
-000817b0: 2020 2020 2020 656c 6966 206f 7043 6f64        elif opCod
-000817c0: 6520 3d3d 2027 3e27 3a0a 2020 2020 2020  e == '>':.      
+00081560: 2020 2020 2020 2020 2041 5554 485f 4154           AUTH_AT
+00081570: 4f4d 5f44 4154 415f 4954 454d 532c 0a20  OM_DATA_ITEMS,. 
+00081580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000815a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000815b0: 2020 2020 2020 205b 7b27 6e61 6d65 273a         [{'name':
+000815c0: 2027 7479 7065 5f73 796d 626f 6c27 2c20   'type_symbol', 
+000815d0: 2774 7970 6527 3a20 2765 6e75 6d27 2c0a  'type': 'enum',.
+000815e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000815f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081610: 2020 2020 2020 2020 2020 2765 6e75 6d27            'enum'
+00081620: 3a20 5f74 7970 6553 796d 626f 6c53 656c  : _typeSymbolSel
+00081630: 6563 747d 2c0a 2020 2020 2020 2020 2020  ect},.          
+00081640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081660: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+00081670: 276e 616d 6527 3a20 7365 6c66 2e5f 5f6d  'name': self.__m
+00081680: 6f64 656c 4e75 6d4e 616d 652c 2027 7479  odelNumName, 'ty
+00081690: 7065 273a 2027 696e 7427 2c0a 2020 2020  pe': 'int',.    
+000816a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000816b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000816c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000816d0: 2020 2020 2020 2776 616c 7565 273a 2073        'value': s
+000816e0: 656c 662e 5f5f 7265 7072 6573 656e 7461  elf.__representa
+000816f0: 7469 7665 4d6f 6465 6c49 647d 2c0a 2020  tiveModelId},.  
+00081700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081730: 2020 2020 2020 207b 276e 616d 6527 3a20         {'name': 
+00081740: 276c 6162 656c 5f61 6c74 5f69 6427 2c20  'label_alt_id', 
+00081750: 2774 7970 6527 3a20 2765 6e75 6d27 2c0a  'type': 'enum',.
+00081760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081790: 2020 2020 2020 2020 2020 2765 6e75 6d27            'enum'
+000817a0: 3a20 2827 4127 297d 0a20 2020 2020 2020  : ('A')}.       
+000817b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000817c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000817d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000817e0: 2020 7661 6c75 6554 7970 655b 2774 7970    valueType['typ
-000817f0: 6527 5d20 3d20 2772 616e 6765 2d66 6c6f  e'] = 'range-flo
-00081800: 6174 2720 6966 206e 6f74 2061 6273 6f6c  at' if not absol
-00081810: 7574 6520 656c 7365 2027 7261 6e67 652d  ute else 'range-
-00081820: 6162 732d 666c 6f61 7427 0a20 2020 2020  abs-float'.     
-00081830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081840: 2020 2076 616c 7565 5479 7065 5b27 7261     valueType['ra
-00081850: 6e67 6527 5d20 3d20 7b27 6d69 6e5f 6578  nge'] = {'min_ex
-00081860: 636c 7573 6976 6527 3a20 6174 7472 5f76  clusive': attr_v
-00081870: 616c 7565 7d0a 2020 2020 2020 2020 2020  alue}.          
-00081880: 2020 2020 2020 2020 2020 656c 6966 206f            elif o
-00081890: 7043 6f64 6520 3d3d 2027 3c3d 273a 0a20  pCode == '<=':. 
-000818a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000818b0: 2020 2020 2020 2076 616c 7565 5479 7065         valueType
-000818c0: 5b27 7479 7065 275d 203d 2027 7261 6e67  ['type'] = 'rang
-000818d0: 652d 666c 6f61 7427 2069 6620 6e6f 7420  e-float' if not 
-000818e0: 6162 736f 6c75 7465 2065 6c73 6520 2772  absolute else 'r
-000818f0: 616e 6765 2d61 6273 2d66 6c6f 6174 270a  ange-abs-float'.
-00081900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081910: 2020 2020 2020 2020 7661 6c75 6554 7970          valueTyp
-00081920: 655b 2772 616e 6765 275d 203d 207b 276d  e['range'] = {'m
-00081930: 6178 5f69 6e63 6c75 7369 7665 273a 2061  ax_inclusive': a
-00081940: 7474 725f 7661 6c75 657d 0a20 2020 2020  ttr_value}.     
-00081950: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00081960: 6c69 6620 6f70 436f 6465 203d 3d20 273e  lif opCode == '>
-00081970: 3d27 3a0a 2020 2020 2020 2020 2020 2020  =':.            
-00081980: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
-00081990: 6554 7970 655b 2774 7970 6527 5d20 3d20  eType['type'] = 
-000819a0: 2772 616e 6765 2d66 6c6f 6174 2720 6966  'range-float' if
-000819b0: 206e 6f74 2061 6273 6f6c 7574 6520 656c   not absolute el
-000819c0: 7365 2027 7261 6e67 652d 6162 732d 666c  se 'range-abs-fl
-000819d0: 6f61 7427 0a20 2020 2020 2020 2020 2020  oat'.           
-000819e0: 2020 2020 2020 2020 2020 2020 2076 616c               val
-000819f0: 7565 5479 7065 5b27 7261 6e67 6527 5d20  ueType['range'] 
-00081a00: 3d20 7b27 6d69 6e5f 696e 636c 7573 6976  = {'min_inclusiv
-00081a10: 6527 3a20 6174 7472 5f76 616c 7565 7d0a  e': attr_value}.
-00081a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081a30: 2020 2020 656c 6966 206f 7043 6f64 6520      elif opCode 
-00081a40: 3d3d 2027 2327 3a0a 2020 2020 2020 2020  == '#':.        
-00081a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081a60: 7661 6c75 6554 7970 655b 2774 7970 6527  valueType['type'
-00081a70: 5d20 3d20 2772 616e 6765 2d66 6c6f 6174  ] = 'range-float
-00081a80: 2720 6966 206e 6f74 2061 6273 6f6c 7574  ' if not absolut
-00081a90: 6520 656c 7365 2027 7261 6e67 652d 6162  e else 'range-ab
-00081aa0: 732d 666c 6f61 7427 0a20 2020 2020 2020  s-float'.       
-00081ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081ac0: 2076 616c 7565 5479 7065 5b27 7261 6e67   valueType['rang
-00081ad0: 6527 5d20 3d20 7b27 6e6f 745f 6571 7561  e'] = {'not_equa
-00081ae0: 6c5f 746f 273a 2061 7474 725f 7661 6c75  l_to': attr_valu
-00081af0: 657d 0a20 2020 2020 2020 2020 2020 2020  e}.             
-00081b00: 2020 2020 2020 2061 746f 6d53 656c 6563         atomSelec
-00081b10: 7469 6f6e 203d 5c0a 2020 2020 2020 2020  tion =\.        
-00081b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081b30: 7365 6c66 2e5f 5f63 522e 6765 7444 6963  self.__cR.getDic
-00081b40: 744c 6973 7457 6974 6846 696c 7465 7228  tListWithFilter(
-00081b50: 2761 746f 6d5f 7369 7465 272c 0a20 2020  'atom_site',.   
-00081b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000817e0: 2020 5d29 0a0a 2020 2020 2020 2020 2020    ])..          
+000817f0: 2020 2020 2020 2020 2020 7365 6c66 2e69            self.i
+00081800: 6e74 6572 7365 6374 696f 6e46 6163 746f  ntersectionFacto
+00081810: 725f 6578 7072 6573 7369 6f6e 7328 6174  r_expressions(at
+00081820: 6f6d 5365 6c65 6374 696f 6e29 0a0a 2020  omSelection)..  
+00081830: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00081840: 6966 2061 7474 725f 7072 6f70 203d 3d20  if attr_prop == 
+00081850: 2771 273a 0a20 2020 2020 2020 2020 2020  'q':.           
+00081860: 2020 2020 2020 2020 2076 616c 7565 5479           valueTy
+00081870: 7065 203d 207b 276e 616d 6527 3a20 276f  pe = {'name': 'o
+00081880: 6363 7570 616e 6379 277d 0a20 2020 2020  ccupancy'}.     
+00081890: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000818a0: 6620 6f70 436f 6465 203d 3d20 273d 273a  f opCode == '=':
+000818b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000818c0: 2020 2020 2020 2020 2076 616c 7565 5479           valueTy
+000818d0: 7065 5b27 7479 7065 275d 203d 2027 666c  pe['type'] = 'fl
+000818e0: 6f61 7427 2069 6620 6e6f 7420 6162 736f  oat' if not abso
+000818f0: 6c75 7465 2065 6c73 6520 2761 6273 2d66  lute else 'abs-f
+00081900: 6c6f 6174 270a 2020 2020 2020 2020 2020  loat'.          
+00081910: 2020 2020 2020 2020 2020 2020 2020 7661                va
+00081920: 6c75 6554 7970 655b 2776 616c 7565 275d  lueType['value']
+00081930: 203d 2061 7474 725f 7661 6c75 650a 2020   = attr_value.  
+00081940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081950: 2020 656c 6966 206f 7043 6f64 6520 3d3d    elif opCode ==
+00081960: 2027 3c27 3a0a 2020 2020 2020 2020 2020   '<':.          
+00081970: 2020 2020 2020 2020 2020 2020 2020 7661                va
+00081980: 6c75 6554 7970 655b 2774 7970 6527 5d20  lueType['type'] 
+00081990: 3d20 2772 616e 6765 2d66 6c6f 6174 2720  = 'range-float' 
+000819a0: 6966 206e 6f74 2061 6273 6f6c 7574 6520  if not absolute 
+000819b0: 656c 7365 2027 7261 6e67 652d 6162 732d  else 'range-abs-
+000819c0: 666c 6f61 7427 0a20 2020 2020 2020 2020  float'.         
+000819d0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+000819e0: 616c 7565 5479 7065 5b27 7261 6e67 6527  alueType['range'
+000819f0: 5d20 3d20 7b27 6d61 785f 6578 636c 7573  ] = {'max_exclus
+00081a00: 6976 6527 3a20 6174 7472 5f76 616c 7565  ive': attr_value
+00081a10: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
+00081a20: 2020 2020 2020 656c 6966 206f 7043 6f64        elif opCod
+00081a30: 6520 3d3d 2027 3e27 3a0a 2020 2020 2020  e == '>':.      
+00081a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081a50: 2020 7661 6c75 6554 7970 655b 2774 7970    valueType['typ
+00081a60: 6527 5d20 3d20 2772 616e 6765 2d66 6c6f  e'] = 'range-flo
+00081a70: 6174 2720 6966 206e 6f74 2061 6273 6f6c  at' if not absol
+00081a80: 7574 6520 656c 7365 2027 7261 6e67 652d  ute else 'range-
+00081a90: 6162 732d 666c 6f61 7427 0a20 2020 2020  abs-float'.     
+00081aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081ab0: 2020 2076 616c 7565 5479 7065 5b27 7261     valueType['ra
+00081ac0: 6e67 6527 5d20 3d20 7b27 6d69 6e5f 6578  nge'] = {'min_ex
+00081ad0: 636c 7573 6976 6527 3a20 6174 7472 5f76  clusive': attr_v
+00081ae0: 616c 7565 7d0a 2020 2020 2020 2020 2020  alue}.          
+00081af0: 2020 2020 2020 2020 2020 656c 6966 206f            elif o
+00081b00: 7043 6f64 6520 3d3d 2027 3c3d 273a 0a20  pCode == '<=':. 
+00081b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081b20: 2020 2020 2020 2076 616c 7565 5479 7065         valueType
+00081b30: 5b27 7479 7065 275d 203d 2027 7261 6e67  ['type'] = 'rang
+00081b40: 652d 666c 6f61 7427 2069 6620 6e6f 7420  e-float' if not 
+00081b50: 6162 736f 6c75 7465 2065 6c73 6520 2772  absolute else 'r
+00081b60: 616e 6765 2d61 6273 2d66 6c6f 6174 270a  ange-abs-float'.
 00081b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081b90: 2020 2020 2041 5554 485f 4154 4f4d 5f44       AUTH_ATOM_D
-00081ba0: 4154 415f 4954 454d 532c 0a20 2020 2020  ATA_ITEMS,.     
-00081bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081be0: 2020 205b 7661 6c75 6554 7970 652c 0a20     [valueType,. 
-00081bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081c20: 2020 2020 2020 2020 7b27 6e61 6d65 273a          {'name':
-00081c30: 2073 656c 662e 5f5f 6d6f 6465 6c4e 756d   self.__modelNum
-00081c40: 4e61 6d65 2c20 2774 7970 6527 3a20 2769  Name, 'type': 'i
-00081c50: 6e74 272c 0a20 2020 2020 2020 2020 2020  nt',.           
-00081c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081c80: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00081c90: 7661 6c75 6527 3a20 7365 6c66 2e5f 5f72  value': self.__r
-00081ca0: 6570 7265 7365 6e74 6174 6976 654d 6f64  epresentativeMod
-00081cb0: 656c 4964 7d2c 0a20 2020 2020 2020 2020  elId},.         
+00081b80: 2020 2020 2020 2020 7661 6c75 6554 7970          valueTyp
+00081b90: 655b 2772 616e 6765 275d 203d 207b 276d  e['range'] = {'m
+00081ba0: 6178 5f69 6e63 6c75 7369 7665 273a 2061  ax_inclusive': a
+00081bb0: 7474 725f 7661 6c75 657d 0a20 2020 2020  ttr_value}.     
+00081bc0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00081bd0: 6c69 6620 6f70 436f 6465 203d 3d20 273e  lif opCode == '>
+00081be0: 3d27 3a0a 2020 2020 2020 2020 2020 2020  =':.            
+00081bf0: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+00081c00: 6554 7970 655b 2774 7970 6527 5d20 3d20  eType['type'] = 
+00081c10: 2772 616e 6765 2d66 6c6f 6174 2720 6966  'range-float' if
+00081c20: 206e 6f74 2061 6273 6f6c 7574 6520 656c   not absolute el
+00081c30: 7365 2027 7261 6e67 652d 6162 732d 666c  se 'range-abs-fl
+00081c40: 6f61 7427 0a20 2020 2020 2020 2020 2020  oat'.           
+00081c50: 2020 2020 2020 2020 2020 2020 2076 616c               val
+00081c60: 7565 5479 7065 5b27 7261 6e67 6527 5d20  ueType['range'] 
+00081c70: 3d20 7b27 6d69 6e5f 696e 636c 7573 6976  = {'min_inclusiv
+00081c80: 6527 3a20 6174 7472 5f76 616c 7565 7d0a  e': attr_value}.
+00081c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081ca0: 2020 2020 656c 6966 206f 7043 6f64 6520      elif opCode 
+00081cb0: 3d3d 2027 2327 3a0a 2020 2020 2020 2020  == '#':.        
 00081cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081cf0: 7b27 6e61 6d65 273a 2027 6c61 6265 6c5f  {'name': 'label_
-00081d00: 616c 745f 6964 272c 2027 7479 7065 273a  alt_id', 'type':
-00081d10: 2027 656e 756d 272c 0a20 2020 2020 2020   'enum',.       
+00081cd0: 7661 6c75 6554 7970 655b 2774 7970 6527  valueType['type'
+00081ce0: 5d20 3d20 2772 616e 6765 2d66 6c6f 6174  ] = 'range-float
+00081cf0: 2720 6966 206e 6f74 2061 6273 6f6c 7574  ' if not absolut
+00081d00: 6520 656c 7365 2027 7261 6e67 652d 6162  e else 'range-ab
+00081d10: 732d 666c 6f61 7427 0a20 2020 2020 2020  s-float'.       
 00081d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081d50: 2020 2027 656e 756d 273a 2028 2741 2729     'enum': ('A')
-00081d60: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
-00081d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081d90: 2020 2020 2020 2020 2020 205d 290a 0a20             ]).. 
-00081da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081db0: 2020 2073 656c 662e 696e 7465 7273 6563     self.intersec
-00081dc0: 7469 6f6e 4661 6374 6f72 5f65 7870 7265  tionFactor_expre
-00081dd0: 7373 696f 6e73 2861 746f 6d53 656c 6563  ssions(atomSelec
-00081de0: 7469 6f6e 290a 0a20 2020 2020 2020 2020  tion)..         
-00081df0: 2020 2020 2020 2065 6c69 6620 6174 7472         elif attr
-00081e00: 5f70 726f 7020 696e 2028 2772 6566 7827  _prop in ('refx'
-00081e10: 2c20 2772 6566 7927 2c20 2772 6566 7a27  , 'refy', 'refz'
-00081e20: 2c20 2772 6d73 6427 293a 0a20 2020 2020  , 'rmsd'):.     
-00081e30: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00081e40: 656c 662e 6661 6374 6f72 5b27 6174 6f6d  elf.factor['atom
-00081e50: 5f69 6427 5d20 3d20 5b4e 6f6e 655d 0a20  _id'] = [None]. 
+00081d30: 2076 616c 7565 5479 7065 5b27 7261 6e67   valueType['rang
+00081d40: 6527 5d20 3d20 7b27 6e6f 745f 6571 7561  e'] = {'not_equa
+00081d50: 6c5f 746f 273a 2061 7474 725f 7661 6c75  l_to': attr_valu
+00081d60: 657d 0a20 2020 2020 2020 2020 2020 2020  e}.             
+00081d70: 2020 2020 2020 2061 746f 6d53 656c 6563         atomSelec
+00081d80: 7469 6f6e 203d 5c0a 2020 2020 2020 2020  tion =\.        
+00081d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081da0: 7365 6c66 2e5f 5f63 522e 6765 7444 6963  self.__cR.getDic
+00081db0: 744c 6973 7457 6974 6846 696c 7465 7228  tListWithFilter(
+00081dc0: 2761 746f 6d5f 7369 7465 272c 0a20 2020  'atom_site',.   
+00081dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081e00: 2020 2020 2041 5554 485f 4154 4f4d 5f44       AUTH_ATOM_D
+00081e10: 4154 415f 4954 454d 532c 0a20 2020 2020  ATA_ITEMS,.     
+00081e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081e50: 2020 205b 7661 6c75 6554 7970 652c 0a20     [valueType,. 
 00081e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081e70: 2020 2073 656c 662e 5f5f 662e 6170 7065     self.__f.appe
-00081e80: 6e64 2866 225b 556e 7375 7070 6f72 7465  nd(f"[Unsupporte
-00081e90: 6420 6461 7461 5d20 7b73 656c 662e 5f5f  d data] {self.__
-00081ea0: 6765 7443 7572 7265 6e74 5265 7374 7261  getCurrentRestra
-00081eb0: 696e 7428 297d 220a 2020 2020 2020 2020  int()}".        
-00081ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081ed0: 2020 2020 2020 2020 2020 2020 6622 5468              f"Th
-00081ee0: 6520 6174 7472 6962 7574 6520 7072 6f70  e attribute prop
-00081ef0: 6572 7479 207b 5f61 7474 725f 7072 6f70  erty {_attr_prop
-00081f00: 2172 7d20 220a 2020 2020 2020 2020 2020  !r} ".          
-00081f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081f20: 2020 2020 2020 2020 2020 2272 6571 7569            "requi
-00081f30: 7265 7320 6120 7265 6665 7265 6e63 6520  res a reference 
-00081f40: 636f 6f72 6469 6e61 7465 2073 6574 2e22  coordinate set."
-00081f50: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00081f60: 2020 2020 2020 7661 6c69 6450 726f 7020        validProp 
-00081f70: 3d20 4661 6c73 650a 0a20 2020 2020 2020  = False..       
-00081f80: 2020 2020 2020 2020 2065 6c69 6620 6174           elif at
-00081f90: 7472 5f70 726f 7020 696e 2028 2776 7827  tr_prop in ('vx'
-00081fa0: 2c20 2776 7927 2c20 2776 7a27 293a 0a20  , 'vy', 'vz'):. 
+00081e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081e90: 2020 2020 2020 2020 7b27 6e61 6d65 273a          {'name':
+00081ea0: 2073 656c 662e 5f5f 6d6f 6465 6c4e 756d   self.__modelNum
+00081eb0: 4e61 6d65 2c20 2774 7970 6527 3a20 2769  Name, 'type': 'i
+00081ec0: 6e74 272c 0a20 2020 2020 2020 2020 2020  nt',.           
+00081ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081ef0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00081f00: 7661 6c75 6527 3a20 7365 6c66 2e5f 5f72  value': self.__r
+00081f10: 6570 7265 7365 6e74 6174 6976 654d 6f64  epresentativeMod
+00081f20: 656c 4964 7d2c 0a20 2020 2020 2020 2020  elId},.         
+00081f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081f60: 7b27 6e61 6d65 273a 2027 6c61 6265 6c5f  {'name': 'label_
+00081f70: 616c 745f 6964 272c 2027 7479 7065 273a  alt_id', 'type':
+00081f80: 2027 656e 756d 272c 0a20 2020 2020 2020   'enum',.       
+00081f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00081fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00081fc0: 2020 2073 656c 662e 6661 6374 6f72 5b27     self.factor['
-00081fd0: 6174 6f6d 5f69 6427 5d20 3d20 5b4e 6f6e  atom_id'] = [Non
-00081fe0: 655d 0a20 2020 2020 2020 2020 2020 2020  e].             
-00081ff0: 2020 2020 2020 2073 656c 662e 5f5f 662e         self.__f.
-00082000: 6170 7065 6e64 2866 225b 556e 7375 7070  append(f"[Unsupp
-00082010: 6f72 7465 6420 6461 7461 5d20 7b73 656c  orted data] {sel
-00082020: 662e 5f5f 6765 7443 7572 7265 6e74 5265  f.__getCurrentRe
-00082030: 7374 7261 696e 7428 297d 220a 2020 2020  straint()}".    
-00082040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082060: 6622 5468 6520 6174 7472 6962 7574 6520  f"The attribute 
-00082070: 7072 6f70 6572 7479 207b 5f61 7474 725f  property {_attr_
-00082080: 7072 6f70 2172 7d20 220a 2020 2020 2020  prop!r} ".      
-00082090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000820a0: 2020 2020 2020 2020 2020 2020 2020 2272                "r
-000820b0: 656c 6174 6564 2074 6f20 6375 7272 656e  elated to curren
-000820c0: 7420 7665 6c6f 6369 7469 6573 206f 6620  t velocities of 
-000820d0: 6561 6368 2061 746f 6d20 6973 206e 6f74  each atom is not
-000820e0: 2070 6f73 7365 7373 6564 2069 6e20 7468   possessed in th
-000820f0: 6520 7374 6174 6963 2063 6f6f 7264 696e  e static coordin
-00082100: 6174 6520 6669 6c65 2e22 290a 2020 2020  ate file.").    
-00082110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082120: 7661 6c69 6450 726f 7020 3d20 4661 6c73  validProp = Fals
-00082130: 650a 0a20 2020 2020 2020 2020 2020 2020  e..             
-00082140: 2020 2065 6c69 6620 6174 7472 5f70 726f     elif attr_pro
-00082150: 7020 696e 2028 2778 272c 2027 7927 2c20  p in ('x', 'y', 
-00082160: 277a 2729 3a0a 2020 2020 2020 2020 2020  'z'):.          
-00082170: 2020 2020 2020 2020 2020 7661 6c75 6554            valueT
-00082180: 7970 6520 3d20 7b27 6e61 6d65 273a 2066  ype = {'name': f
-00082190: 2243 6172 746e 5f7b 6174 7472 5f70 726f  "Cartn_{attr_pro
-000821a0: 707d 227d 0a20 2020 2020 2020 2020 2020  p}"}.           
-000821b0: 2020 2020 2020 2020 2069 6620 6f70 436f           if opCo
-000821c0: 6465 203d 3d20 273d 273a 0a20 2020 2020  de == '=':.     
-000821d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000821e0: 2020 2076 616c 7565 5479 7065 5b27 7479     valueType['ty
-000821f0: 7065 275d 203d 2027 666c 6f61 7427 2069  pe'] = 'float' i
-00082200: 6620 6e6f 7420 6162 736f 6c75 7465 2065  f not absolute e
-00082210: 6c73 6520 2761 6273 2d66 6c6f 6174 270a  lse 'abs-float'.
+00081fc0: 2020 2027 656e 756d 273a 2028 2741 2729     'enum': ('A')
+00081fd0: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
+00081fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00081ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082000: 2020 2020 2020 2020 2020 205d 290a 0a20             ]).. 
+00082010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082020: 2020 2073 656c 662e 696e 7465 7273 6563     self.intersec
+00082030: 7469 6f6e 4661 6374 6f72 5f65 7870 7265  tionFactor_expre
+00082040: 7373 696f 6e73 2861 746f 6d53 656c 6563  ssions(atomSelec
+00082050: 7469 6f6e 290a 0a20 2020 2020 2020 2020  tion)..         
+00082060: 2020 2020 2020 2065 6c69 6620 6174 7472         elif attr
+00082070: 5f70 726f 7020 696e 2028 2772 6566 7827  _prop in ('refx'
+00082080: 2c20 2772 6566 7927 2c20 2772 6566 7a27  , 'refy', 'refz'
+00082090: 2c20 2772 6d73 6427 293a 0a20 2020 2020  , 'rmsd'):.     
+000820a0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000820b0: 656c 662e 6661 6374 6f72 5b27 6174 6f6d  elf.factor['atom
+000820c0: 5f69 6427 5d20 3d20 5b4e 6f6e 655d 0a20  _id'] = [None]. 
+000820d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000820e0: 2020 2073 656c 662e 5f5f 662e 6170 7065     self.__f.appe
+000820f0: 6e64 2866 225b 556e 7375 7070 6f72 7465  nd(f"[Unsupporte
+00082100: 6420 6461 7461 5d20 7b73 656c 662e 5f5f  d data] {self.__
+00082110: 6765 7443 7572 7265 6e74 5265 7374 7261  getCurrentRestra
+00082120: 696e 7428 297d 220a 2020 2020 2020 2020  int()}".        
+00082130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082140: 2020 2020 2020 2020 2020 2020 6622 5468              f"Th
+00082150: 6520 6174 7472 6962 7574 6520 7072 6f70  e attribute prop
+00082160: 6572 7479 207b 5f61 7474 725f 7072 6f70  erty {_attr_prop
+00082170: 2172 7d20 220a 2020 2020 2020 2020 2020  !r} ".          
+00082180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082190: 2020 2020 2020 2020 2020 2272 6571 7569            "requi
+000821a0: 7265 7320 6120 7265 6665 7265 6e63 6520  res a reference 
+000821b0: 636f 6f72 6469 6e61 7465 2073 6574 2e22  coordinate set."
+000821c0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000821d0: 2020 2020 2020 7661 6c69 6450 726f 7020        validProp 
+000821e0: 3d20 4661 6c73 650a 0a20 2020 2020 2020  = False..       
+000821f0: 2020 2020 2020 2020 2065 6c69 6620 6174           elif at
+00082200: 7472 5f70 726f 7020 696e 2028 2776 7827  tr_prop in ('vx'
+00082210: 2c20 2776 7927 2c20 2776 7a27 293a 0a20  , 'vy', 'vz'):. 
 00082220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082230: 2020 2020 2020 2020 7661 6c75 6554 7970          valueTyp
-00082240: 655b 2776 616c 7565 275d 203d 2061 7474  e['value'] = att
-00082250: 725f 7661 6c75 650a 2020 2020 2020 2020  r_value.        
-00082260: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-00082270: 206f 7043 6f64 6520 3d3d 2027 3c27 3a0a   opCode == '<':.
-00082280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082290: 2020 2020 2020 2020 7661 6c75 6554 7970          valueTyp
-000822a0: 655b 2774 7970 6527 5d20 3d20 2772 616e  e['type'] = 'ran
-000822b0: 6765 2d66 6c6f 6174 2720 6966 206e 6f74  ge-float' if not
-000822c0: 2061 6273 6f6c 7574 6520 656c 7365 2027   absolute else '
-000822d0: 7261 6e67 652d 6162 732d 666c 6f61 7427  range-abs-float'
-000822e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000822f0: 2020 2020 2020 2020 2076 616c 7565 5479           valueTy
-00082300: 7065 5b27 7261 6e67 6527 5d20 3d20 7b27  pe['range'] = {'
-00082310: 6d61 785f 6578 636c 7573 6976 6527 3a20  max_exclusive': 
-00082320: 6174 7472 5f76 616c 7565 7d0a 2020 2020  attr_value}.    
-00082330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082340: 656c 6966 206f 7043 6f64 6520 3d3d 2027  elif opCode == '
-00082350: 3e27 3a0a 2020 2020 2020 2020 2020 2020  >':.            
-00082360: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
-00082370: 6554 7970 655b 2774 7970 6527 5d20 3d20  eType['type'] = 
-00082380: 2772 616e 6765 2d66 6c6f 6174 2720 6966  'range-float' if
-00082390: 206e 6f74 2061 6273 6f6c 7574 6520 656c   not absolute el
-000823a0: 7365 2027 7261 6e67 652d 6162 732d 666c  se 'range-abs-fl
-000823b0: 6f61 7427 0a20 2020 2020 2020 2020 2020  oat'.           
-000823c0: 2020 2020 2020 2020 2020 2020 2076 616c               val
-000823d0: 7565 5479 7065 5b27 7261 6e67 6527 5d20  ueType['range'] 
-000823e0: 3d20 7b27 6d69 6e5f 6578 636c 7573 6976  = {'min_exclusiv
-000823f0: 6527 3a20 6174 7472 5f76 616c 7565 7d0a  e': attr_value}.
-00082400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082410: 2020 2020 656c 6966 206f 7043 6f64 6520      elif opCode 
-00082420: 3d3d 2027 3c3d 273a 0a20 2020 2020 2020  == '<=':.       
-00082430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082440: 2076 616c 7565 5479 7065 5b27 7479 7065   valueType['type
-00082450: 275d 203d 2027 7261 6e67 652d 666c 6f61  '] = 'range-floa
-00082460: 7427 2069 6620 6e6f 7420 6162 736f 6c75  t' if not absolu
-00082470: 7465 2065 6c73 6520 2772 616e 6765 2d61  te else 'range-a
-00082480: 6273 2d66 6c6f 6174 270a 2020 2020 2020  bs-float'.      
+00082230: 2020 2073 656c 662e 6661 6374 6f72 5b27     self.factor['
+00082240: 6174 6f6d 5f69 6427 5d20 3d20 5b4e 6f6e  atom_id'] = [Non
+00082250: 655d 0a20 2020 2020 2020 2020 2020 2020  e].             
+00082260: 2020 2020 2020 2073 656c 662e 5f5f 662e         self.__f.
+00082270: 6170 7065 6e64 2866 225b 556e 7375 7070  append(f"[Unsupp
+00082280: 6f72 7465 6420 6461 7461 5d20 7b73 656c  orted data] {sel
+00082290: 662e 5f5f 6765 7443 7572 7265 6e74 5265  f.__getCurrentRe
+000822a0: 7374 7261 696e 7428 297d 220a 2020 2020  straint()}".    
+000822b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000822c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000822d0: 6622 5468 6520 6174 7472 6962 7574 6520  f"The attribute 
+000822e0: 7072 6f70 6572 7479 207b 5f61 7474 725f  property {_attr_
+000822f0: 7072 6f70 2172 7d20 220a 2020 2020 2020  prop!r} ".      
+00082300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082310: 2020 2020 2020 2020 2020 2020 2020 2272                "r
+00082320: 656c 6174 6564 2074 6f20 6375 7272 656e  elated to curren
+00082330: 7420 7665 6c6f 6369 7469 6573 206f 6620  t velocities of 
+00082340: 6561 6368 2061 746f 6d20 6973 206e 6f74  each atom is not
+00082350: 2070 6f73 7365 7373 6564 2069 6e20 7468   possessed in th
+00082360: 6520 7374 6174 6963 2063 6f6f 7264 696e  e static coordin
+00082370: 6174 6520 6669 6c65 2e22 290a 2020 2020  ate file.").    
+00082380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082390: 7661 6c69 6450 726f 7020 3d20 4661 6c73  validProp = Fals
+000823a0: 650a 0a20 2020 2020 2020 2020 2020 2020  e..             
+000823b0: 2020 2065 6c69 6620 6174 7472 5f70 726f     elif attr_pro
+000823c0: 7020 696e 2028 2778 272c 2027 7927 2c20  p in ('x', 'y', 
+000823d0: 277a 2729 3a0a 2020 2020 2020 2020 2020  'z'):.          
+000823e0: 2020 2020 2020 2020 2020 7661 6c75 6554            valueT
+000823f0: 7970 6520 3d20 7b27 6e61 6d65 273a 2066  ype = {'name': f
+00082400: 2243 6172 746e 5f7b 6174 7472 5f70 726f  "Cartn_{attr_pro
+00082410: 707d 227d 0a20 2020 2020 2020 2020 2020  p}"}.           
+00082420: 2020 2020 2020 2020 2069 6620 6f70 436f           if opCo
+00082430: 6465 203d 3d20 273d 273a 0a20 2020 2020  de == '=':.     
+00082440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082450: 2020 2076 616c 7565 5479 7065 5b27 7479     valueType['ty
+00082460: 7065 275d 203d 2027 666c 6f61 7427 2069  pe'] = 'float' i
+00082470: 6620 6e6f 7420 6162 736f 6c75 7465 2065  f not absolute e
+00082480: 6c73 6520 2761 6273 2d66 6c6f 6174 270a  lse 'abs-float'.
 00082490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000824a0: 2020 7661 6c75 6554 7970 655b 2772 616e    valueType['ran
-000824b0: 6765 275d 203d 207b 276d 6178 5f69 6e63  ge'] = {'max_inc
-000824c0: 6c75 7369 7665 273a 2061 7474 725f 7661  lusive': attr_va
-000824d0: 6c75 657d 0a20 2020 2020 2020 2020 2020  lue}.           
-000824e0: 2020 2020 2020 2020 2065 6c69 6620 6f70           elif op
-000824f0: 436f 6465 203d 3d20 273e 3d27 3a0a 2020  Code == '>=':.  
-00082500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082510: 2020 2020 2020 7661 6c75 6554 7970 655b        valueType[
-00082520: 2774 7970 6527 5d20 3d20 2772 616e 6765  'type'] = 'range
-00082530: 2d66 6c6f 6174 2720 6966 206e 6f74 2061  -float' if not a
-00082540: 6273 6f6c 7574 6520 656c 7365 2027 7261  bsolute else 'ra
-00082550: 6e67 652d 6162 732d 666c 6f61 7427 0a20  nge-abs-float'. 
-00082560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082570: 2020 2020 2020 2076 616c 7565 5479 7065         valueType
-00082580: 5b27 7261 6e67 6527 5d20 3d20 7b27 6d69  ['range'] = {'mi
-00082590: 6e5f 696e 636c 7573 6976 6527 3a20 6174  n_inclusive': at
-000825a0: 7472 5f76 616c 7565 7d0a 2020 2020 2020  tr_value}.      
-000825b0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-000825c0: 6966 206f 7043 6f64 6520 3d3d 2027 2327  if opCode == '#'
-000825d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000825e0: 2020 2020 2020 2020 2020 7661 6c75 6554            valueT
-000825f0: 7970 655b 2774 7970 6527 5d20 3d20 2772  ype['type'] = 'r
-00082600: 616e 6765 2d66 6c6f 6174 2720 6966 206e  ange-float' if n
-00082610: 6f74 2061 6273 6f6c 7574 6520 656c 7365  ot absolute else
-00082620: 2027 7261 6e67 652d 6162 732d 666c 6f61   'range-abs-floa
-00082630: 7427 0a20 2020 2020 2020 2020 2020 2020  t'.             
-00082640: 2020 2020 2020 2020 2020 2076 616c 7565             value
-00082650: 5479 7065 5b27 7261 6e67 6527 5d20 3d20  Type['range'] = 
-00082660: 7b27 6e6f 745f 6571 7561 6c5f 746f 273a  {'not_equal_to':
-00082670: 2061 7474 725f 7661 6c75 657d 0a20 2020   attr_value}.   
-00082680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082690: 2061 746f 6d53 656c 6563 7469 6f6e 203d   atomSelection =
-000826a0: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
-000826b0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-000826c0: 5f63 522e 6765 7444 6963 744c 6973 7457  _cR.getDictListW
-000826d0: 6974 6846 696c 7465 7228 2761 746f 6d5f  ithFilter('atom_
-000826e0: 7369 7465 272c 0a20 2020 2020 2020 2020  site',.         
-000826f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000824a0: 2020 2020 2020 2020 7661 6c75 6554 7970          valueTyp
+000824b0: 655b 2776 616c 7565 275d 203d 2061 7474  e['value'] = att
+000824c0: 725f 7661 6c75 650a 2020 2020 2020 2020  r_value.        
+000824d0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+000824e0: 206f 7043 6f64 6520 3d3d 2027 3c27 3a0a   opCode == '<':.
+000824f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082500: 2020 2020 2020 2020 7661 6c75 6554 7970          valueTyp
+00082510: 655b 2774 7970 6527 5d20 3d20 2772 616e  e['type'] = 'ran
+00082520: 6765 2d66 6c6f 6174 2720 6966 206e 6f74  ge-float' if not
+00082530: 2061 6273 6f6c 7574 6520 656c 7365 2027   absolute else '
+00082540: 7261 6e67 652d 6162 732d 666c 6f61 7427  range-abs-float'
+00082550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00082560: 2020 2020 2020 2020 2076 616c 7565 5479           valueTy
+00082570: 7065 5b27 7261 6e67 6527 5d20 3d20 7b27  pe['range'] = {'
+00082580: 6d61 785f 6578 636c 7573 6976 6527 3a20  max_exclusive': 
+00082590: 6174 7472 5f76 616c 7565 7d0a 2020 2020  attr_value}.    
+000825a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000825b0: 656c 6966 206f 7043 6f64 6520 3d3d 2027  elif opCode == '
+000825c0: 3e27 3a0a 2020 2020 2020 2020 2020 2020  >':.            
+000825d0: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+000825e0: 6554 7970 655b 2774 7970 6527 5d20 3d20  eType['type'] = 
+000825f0: 2772 616e 6765 2d66 6c6f 6174 2720 6966  'range-float' if
+00082600: 206e 6f74 2061 6273 6f6c 7574 6520 656c   not absolute el
+00082610: 7365 2027 7261 6e67 652d 6162 732d 666c  se 'range-abs-fl
+00082620: 6f61 7427 0a20 2020 2020 2020 2020 2020  oat'.           
+00082630: 2020 2020 2020 2020 2020 2020 2076 616c               val
+00082640: 7565 5479 7065 5b27 7261 6e67 6527 5d20  ueType['range'] 
+00082650: 3d20 7b27 6d69 6e5f 6578 636c 7573 6976  = {'min_exclusiv
+00082660: 6527 3a20 6174 7472 5f76 616c 7565 7d0a  e': attr_value}.
+00082670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082680: 2020 2020 656c 6966 206f 7043 6f64 6520      elif opCode 
+00082690: 3d3d 2027 3c3d 273a 0a20 2020 2020 2020  == '<=':.       
+000826a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000826b0: 2076 616c 7565 5479 7065 5b27 7479 7065   valueType['type
+000826c0: 275d 203d 2027 7261 6e67 652d 666c 6f61  '] = 'range-floa
+000826d0: 7427 2069 6620 6e6f 7420 6162 736f 6c75  t' if not absolu
+000826e0: 7465 2065 6c73 6520 2772 616e 6765 2d61  te else 'range-a
+000826f0: 6273 2d66 6c6f 6174 270a 2020 2020 2020  bs-float'.      
 00082700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082710: 2020 2020 2020 2020 2020 2020 2020 2041                 A
-00082720: 5554 485f 4154 4f4d 5f44 4154 415f 4954  UTH_ATOM_DATA_IT
-00082730: 454d 532c 0a20 2020 2020 2020 2020 2020  EMS,.           
-00082740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082760: 2020 2020 2020 2020 2020 2020 205b 7661               [va
-00082770: 6c75 6554 7970 652c 0a20 2020 2020 2020  lueType,.       
-00082780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000827a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000827b0: 2020 7b27 6e61 6d65 273a 2073 656c 662e    {'name': self.
-000827c0: 5f5f 6d6f 6465 6c4e 756d 4e61 6d65 2c20  __modelNumName, 
-000827d0: 2774 7970 6527 3a20 2769 6e74 272c 0a20  'type': 'int',. 
-000827e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000827f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082810: 2020 2020 2020 2020 2027 7661 6c75 6527           'value'
-00082820: 3a20 7365 6c66 2e5f 5f72 6570 7265 7365  : self.__represe
-00082830: 6e74 6174 6976 654d 6f64 656c 4964 7d2c  ntativeModelId},
-00082840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00082850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082870: 2020 2020 2020 2020 2020 7b27 6e61 6d65            {'name
-00082880: 273a 2027 6c61 6265 6c5f 616c 745f 6964  ': 'label_alt_id
-00082890: 272c 2027 7479 7065 273a 2027 656e 756d  ', 'type': 'enum
-000828a0: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-000828b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000828c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000828d0: 2020 2020 2020 2020 2020 2020 2027 656e               'en
-000828e0: 756d 273a 2028 2741 2729 7d0a 2020 2020  um': ('A')}.    
+00082710: 2020 7661 6c75 6554 7970 655b 2772 616e    valueType['ran
+00082720: 6765 275d 203d 207b 276d 6178 5f69 6e63  ge'] = {'max_inc
+00082730: 6c75 7369 7665 273a 2061 7474 725f 7661  lusive': attr_va
+00082740: 6c75 657d 0a20 2020 2020 2020 2020 2020  lue}.           
+00082750: 2020 2020 2020 2020 2065 6c69 6620 6f70           elif op
+00082760: 436f 6465 203d 3d20 273e 3d27 3a0a 2020  Code == '>=':.  
+00082770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082780: 2020 2020 2020 7661 6c75 6554 7970 655b        valueType[
+00082790: 2774 7970 6527 5d20 3d20 2772 616e 6765  'type'] = 'range
+000827a0: 2d66 6c6f 6174 2720 6966 206e 6f74 2061  -float' if not a
+000827b0: 6273 6f6c 7574 6520 656c 7365 2027 7261  bsolute else 'ra
+000827c0: 6e67 652d 6162 732d 666c 6f61 7427 0a20  nge-abs-float'. 
+000827d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000827e0: 2020 2020 2020 2076 616c 7565 5479 7065         valueType
+000827f0: 5b27 7261 6e67 6527 5d20 3d20 7b27 6d69  ['range'] = {'mi
+00082800: 6e5f 696e 636c 7573 6976 6527 3a20 6174  n_inclusive': at
+00082810: 7472 5f76 616c 7565 7d0a 2020 2020 2020  tr_value}.      
+00082820: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00082830: 6966 206f 7043 6f64 6520 3d3d 2027 2327  if opCode == '#'
+00082840: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00082850: 2020 2020 2020 2020 2020 7661 6c75 6554            valueT
+00082860: 7970 655b 2774 7970 6527 5d20 3d20 2772  ype['type'] = 'r
+00082870: 616e 6765 2d66 6c6f 6174 2720 6966 206e  ange-float' if n
+00082880: 6f74 2061 6273 6f6c 7574 6520 656c 7365  ot absolute else
+00082890: 2027 7261 6e67 652d 6162 732d 666c 6f61   'range-abs-floa
+000828a0: 7427 0a20 2020 2020 2020 2020 2020 2020  t'.             
+000828b0: 2020 2020 2020 2020 2020 2076 616c 7565             value
+000828c0: 5479 7065 5b27 7261 6e67 6527 5d20 3d20  Type['range'] = 
+000828d0: 7b27 6e6f 745f 6571 7561 6c5f 746f 273a  {'not_equal_to':
+000828e0: 2061 7474 725f 7661 6c75 657d 0a20 2020   attr_value}.   
 000828f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082920: 2020 2020 205d 290a 0a20 2020 2020 2020       ])..       
-00082930: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00082940: 662e 696e 7465 7273 6563 7469 6f6e 4661  f.intersectionFa
-00082950: 6374 6f72 5f65 7870 7265 7373 696f 6e73  ctor_expressions
-00082960: 2861 746f 6d53 656c 6563 7469 6f6e 290a  (atomSelection).
-00082970: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00082980: 2065 6c69 6620 6174 7472 5f70 726f 702e   elif attr_prop.
-00082990: 7374 6172 7473 7769 7468 2827 7374 6f72  startswith('stor
-000829a0: 6527 293a 0a20 2020 2020 2020 2020 2020  e'):.           
-000829b0: 2020 2020 2020 2020 2073 746f 7265 5f69           store_i
-000829c0: 6420 3d20 696e 7428 6174 7472 5f70 726f  d = int(attr_pro
-000829d0: 705b 2d31 5d29 0a20 2020 2020 2020 2020  p[-1]).         
-000829e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000829f0: 6661 6374 6f72 5b27 6174 6f6d 5f69 6427  factor['atom_id'
-00082a00: 5d20 3d20 5b4e 6f6e 655d 0a20 2020 2020  ] = [None].     
-00082a10: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00082a20: 6620 6c65 6e28 7365 6c66 2e73 746f 7265  f len(self.store
-00082a30: 5365 745b 7374 6f72 655f 6964 5d29 203d  Set[store_id]) =
-00082a40: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
-00082a50: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00082a60: 662e 5f5f 662e 6170 7065 6e64 2866 225b  f.__f.append(f"[
-00082a70: 556e 7375 7070 6f72 7465 6420 6461 7461  Unsupported data
-00082a80: 5d20 7b73 656c 662e 5f5f 6765 7443 7572  ] {self.__getCur
-00082a90: 7265 6e74 5265 7374 7261 696e 7428 297d  rentRestraint()}
-00082aa0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00082ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082ac0: 2020 2020 2020 2020 2020 6622 5468 6520            f"The 
-00082ad0: 2773 746f 7265 7b73 746f 7265 5f69 647d  'store{store_id}
-00082ae0: 2720 636c 6175 7365 2068 6173 206e 6f20  ' clause has no 
-00082af0: 6566 6665 6374 2022 0a20 2020 2020 2020  effect ".       
-00082b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082b20: 2022 6265 6361 7573 6520 7468 6520 696e   "because the in
-00082b30: 7465 726e 616c 2076 6563 746f 7220 7374  ternal vector st
-00082b40: 6174 656d 656e 7420 6973 206e 6f74 2073  atement is not s
-00082b50: 6574 2e22 290a 2020 2020 2020 2020 2020  et.").          
-00082b60: 2020 2020 2020 2020 2020 2020 2020 7661                va
-00082b70: 6c69 6450 726f 7020 3d20 4661 6c73 650a  lidProp = False.
-00082b80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00082b90: 2069 6620 7661 6c69 6450 726f 7020 616e   if validProp an
-00082ba0: 6420 2761 746f 6d5f 7365 6c65 6374 696f  d 'atom_selectio
-00082bb0: 6e27 2069 6e20 7365 6c66 2e66 6163 746f  n' in self.facto
-00082bc0: 7220 616e 6420 6c65 6e28 7365 6c66 2e66  r and len(self.f
-00082bd0: 6163 746f 725b 2761 746f 6d5f 7365 6c65  actor['atom_sele
-00082be0: 6374 696f 6e27 5d29 203d 3d20 303a 0a20  ction']) == 0:. 
-00082bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082c00: 2020 2073 656c 662e 6661 6374 6f72 5b27     self.factor['
-00082c10: 6174 6f6d 5f69 6427 5d20 3d20 5b4e 6f6e  atom_id'] = [Non
-00082c20: 655d 0a20 2020 2020 2020 2020 2020 2020  e].             
-00082c30: 2020 2020 2020 205f 6162 736f 6c75 7465         _absolute
-00082c40: 203d 2027 2061 6273 2720 6966 2061 6273   = ' abs' if abs
-00082c50: 6f6c 7574 6520 656c 7365 2027 270a 2020  olute else ''.  
-00082c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082c70: 2020 7365 6c66 2e5f 5f66 2e61 7070 656e    self.__f.appen
-00082c80: 6428 6622 5b49 6e73 7566 6669 6369 656e  d(f"[Insufficien
-00082c90: 7420 6174 6f6d 2073 656c 6563 7469 6f6e  t atom selection
-00082ca0: 5d20 7b73 656c 662e 5f5f 6765 7443 7572  ] {self.__getCur
-00082cb0: 7265 6e74 5265 7374 7261 696e 7428 297d  rentRestraint()}
-00082cc0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00082cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082ce0: 2020 2020 2020 6622 5468 6520 2761 7474        f"The 'att
-00082cf0: 7269 6275 7465 2720 636c 6175 7365 2028  ribute' clause (
-00082d00: 277b 5f61 7474 725f 7072 6f70 7d7b 5f61  '{_attr_prop}{_a
-00082d10: 6273 6f6c 7574 657d 207b 6f70 436f 6465  bsolute} {opCode
-00082d20: 7d20 7b61 7474 725f 7661 6c75 657d 2729  } {attr_value}')
-00082d30: 2068 6173 206e 6f20 6566 6665 6374 2e22   has no effect."
-00082d40: 290a 0a20 2020 2020 2020 2020 2020 2065  )..            e
-00082d50: 6c69 6620 6374 782e 426f 6e64 6564 546f  lif ctx.BondedTo
-00082d60: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-00082d70: 2020 2020 6966 2073 656c 662e 5f5f 7365      if self.__se
-00082d80: 6c5f 6578 7072 5f64 6562 7567 3a0a 2020  l_expr_debug:.  
-00082d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082da0: 2020 7072 696e 7428 2220 2022 202a 2073    print("  " * s
-00082db0: 656c 662e 6465 7074 6820 2b20 222d 2d3e  elf.depth + "-->
-00082dc0: 2062 6f6e 6465 6474 6f22 290a 2020 2020   bondedto").    
-00082dd0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-00082de0: 6f74 2073 656c 662e 5f5f 6861 7343 6f6f  ot self.__hasCoo
-00082df0: 7264 3a0a 2020 2020 2020 2020 2020 2020  rd:.            
-00082e00: 2020 2020 2020 2020 7265 7475 726e 0a20          return. 
-00082e10: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00082e20: 6620 2761 746f 6d5f 7365 6c65 6374 696f  f 'atom_selectio
-00082e30: 6e27 2069 6e20 7365 6c66 2e66 6163 746f  n' in self.facto
-00082e40: 7220 616e 6420 6c65 6e28 7365 6c66 2e66  r and len(self.f
-00082e50: 6163 746f 725b 2761 746f 6d5f 7365 6c65  actor['atom_sele
-00082e60: 6374 696f 6e27 5d29 203e 2030 3a0a 2020  ction']) > 0:.  
-00082e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082e80: 2020 5f61 746f 6d53 656c 6563 7469 6f6e    _atomSelection
-00082e90: 203d 205b 5d0a 0a20 2020 2020 2020 2020   = []..         
-00082ea0: 2020 2020 2020 2020 2020 2066 6f72 205f             for _
-00082eb0: 6174 6f6d 2069 6e20 7365 6c66 2e66 6163  atom in self.fac
-00082ec0: 746f 725b 2761 746f 6d5f 7365 6c65 6374  tor['atom_select
-00082ed0: 696f 6e27 5d3a 0a20 2020 2020 2020 2020  ion']:.         
-00082ee0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00082ef0: 6861 696e 4964 203d 205f 6174 6f6d 5b27  hainId = _atom['
-00082f00: 6368 6169 6e5f 6964 275d 0a20 2020 2020  chain_id'].     
-00082f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082f20: 2020 2063 6f6d 7049 6420 3d20 5f61 746f     compId = _ato
-00082f30: 6d5b 2763 6f6d 705f 6964 275d 0a20 2020  m['comp_id'].   
+00082900: 2061 746f 6d53 656c 6563 7469 6f6e 203d   atomSelection =
+00082910: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
+00082920: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00082930: 5f63 522e 6765 7444 6963 744c 6973 7457  _cR.getDictListW
+00082940: 6974 6846 696c 7465 7228 2761 746f 6d5f  ithFilter('atom_
+00082950: 7369 7465 272c 0a20 2020 2020 2020 2020  site',.         
+00082960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082980: 2020 2020 2020 2020 2020 2020 2020 2041                 A
+00082990: 5554 485f 4154 4f4d 5f44 4154 415f 4954  UTH_ATOM_DATA_IT
+000829a0: 454d 532c 0a20 2020 2020 2020 2020 2020  EMS,.           
+000829b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000829c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000829d0: 2020 2020 2020 2020 2020 2020 205b 7661               [va
+000829e0: 6c75 6554 7970 652c 0a20 2020 2020 2020  lueType,.       
+000829f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082a20: 2020 7b27 6e61 6d65 273a 2073 656c 662e    {'name': self.
+00082a30: 5f5f 6d6f 6465 6c4e 756d 4e61 6d65 2c20  __modelNumName, 
+00082a40: 2774 7970 6527 3a20 2769 6e74 272c 0a20  'type': 'int',. 
+00082a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082a80: 2020 2020 2020 2020 2027 7661 6c75 6527           'value'
+00082a90: 3a20 7365 6c66 2e5f 5f72 6570 7265 7365  : self.__represe
+00082aa0: 6e74 6174 6976 654d 6f64 656c 4964 7d2c  ntativeModelId},
+00082ab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00082ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082ae0: 2020 2020 2020 2020 2020 7b27 6e61 6d65            {'name
+00082af0: 273a 2027 6c61 6265 6c5f 616c 745f 6964  ': 'label_alt_id
+00082b00: 272c 2027 7479 7065 273a 2027 656e 756d  ', 'type': 'enum
+00082b10: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+00082b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082b40: 2020 2020 2020 2020 2020 2020 2027 656e               'en
+00082b50: 756d 273a 2028 2741 2729 7d0a 2020 2020  um': ('A')}.    
+00082b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082b90: 2020 2020 205d 290a 0a20 2020 2020 2020       ])..       
+00082ba0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00082bb0: 662e 696e 7465 7273 6563 7469 6f6e 4661  f.intersectionFa
+00082bc0: 6374 6f72 5f65 7870 7265 7373 696f 6e73  ctor_expressions
+00082bd0: 2861 746f 6d53 656c 6563 7469 6f6e 290a  (atomSelection).
+00082be0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00082bf0: 2065 6c69 6620 6174 7472 5f70 726f 702e   elif attr_prop.
+00082c00: 7374 6172 7473 7769 7468 2827 7374 6f72  startswith('stor
+00082c10: 6527 293a 0a20 2020 2020 2020 2020 2020  e'):.           
+00082c20: 2020 2020 2020 2020 2073 746f 7265 5f69           store_i
+00082c30: 6420 3d20 696e 7428 6174 7472 5f70 726f  d = int(attr_pro
+00082c40: 705b 2d31 5d29 0a20 2020 2020 2020 2020  p[-1]).         
+00082c50: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00082c60: 6661 6374 6f72 5b27 6174 6f6d 5f69 6427  factor['atom_id'
+00082c70: 5d20 3d20 5b4e 6f6e 655d 0a20 2020 2020  ] = [None].     
+00082c80: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00082c90: 6620 6c65 6e28 7365 6c66 2e73 746f 7265  f len(self.store
+00082ca0: 5365 745b 7374 6f72 655f 6964 5d29 203d  Set[store_id]) =
+00082cb0: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
+00082cc0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00082cd0: 662e 5f5f 662e 6170 7065 6e64 2866 225b  f.__f.append(f"[
+00082ce0: 556e 7375 7070 6f72 7465 6420 6461 7461  Unsupported data
+00082cf0: 5d20 7b73 656c 662e 5f5f 6765 7443 7572  ] {self.__getCur
+00082d00: 7265 6e74 5265 7374 7261 696e 7428 297d  rentRestraint()}
+00082d10: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00082d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082d30: 2020 2020 2020 2020 2020 6622 5468 6520            f"The 
+00082d40: 2773 746f 7265 7b73 746f 7265 5f69 647d  'store{store_id}
+00082d50: 2720 636c 6175 7365 2068 6173 206e 6f20  ' clause has no 
+00082d60: 6566 6665 6374 2022 0a20 2020 2020 2020  effect ".       
+00082d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082d90: 2022 6265 6361 7573 6520 7468 6520 696e   "because the in
+00082da0: 7465 726e 616c 2076 6563 746f 7220 7374  ternal vector st
+00082db0: 6174 656d 656e 7420 6973 206e 6f74 2073  atement is not s
+00082dc0: 6574 2e22 290a 2020 2020 2020 2020 2020  et.").          
+00082dd0: 2020 2020 2020 2020 2020 2020 2020 7661                va
+00082de0: 6c69 6450 726f 7020 3d20 4661 6c73 650a  lidProp = False.
+00082df0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00082e00: 2069 6620 7661 6c69 6450 726f 7020 616e   if validProp an
+00082e10: 6420 2761 746f 6d5f 7365 6c65 6374 696f  d 'atom_selectio
+00082e20: 6e27 2069 6e20 7365 6c66 2e66 6163 746f  n' in self.facto
+00082e30: 7220 616e 6420 6c65 6e28 7365 6c66 2e66  r and len(self.f
+00082e40: 6163 746f 725b 2761 746f 6d5f 7365 6c65  actor['atom_sele
+00082e50: 6374 696f 6e27 5d29 203d 3d20 303a 0a20  ction']) == 0:. 
+00082e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082e70: 2020 2073 656c 662e 6661 6374 6f72 5b27     self.factor['
+00082e80: 6174 6f6d 5f69 6427 5d20 3d20 5b4e 6f6e  atom_id'] = [Non
+00082e90: 655d 0a20 2020 2020 2020 2020 2020 2020  e].             
+00082ea0: 2020 2020 2020 205f 6162 736f 6c75 7465         _absolute
+00082eb0: 203d 2027 2061 6273 2720 6966 2061 6273   = ' abs' if abs
+00082ec0: 6f6c 7574 6520 656c 7365 2027 270a 2020  olute else ''.  
+00082ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00082ee0: 2020 7365 6c66 2e5f 5f66 2e61 7070 656e    self.__f.appen
+00082ef0: 6428 6622 5b49 6e73 7566 6669 6369 656e  d(f"[Insufficien
+00082f00: 7420 6174 6f6d 2073 656c 6563 7469 6f6e  t atom selection
+00082f10: 5d20 7b73 656c 662e 5f5f 6765 7443 7572  ] {self.__getCur
+00082f20: 7265 6e74 5265 7374 7261 696e 7428 297d  rentRestraint()}
+00082f30: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
 00082f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082f50: 2020 2020 2073 6571 4964 203d 205f 6174       seqId = _at
-00082f60: 6f6d 5b27 7365 715f 6964 275d 0a20 2020  om['seq_id'].   
-00082f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082f80: 2020 2020 2061 746f 6d49 6420 3d20 5f61       atomId = _a
-00082f90: 746f 6d5b 2761 746f 6d5f 6964 275d 0a0a  tom['atom_id']..
-00082fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00082fb0: 2020 2020 2020 2020 5f2c 2063 6f6f 7264          _, coord
-00082fc0: 4174 6f6d 5369 7465 203d 2073 656c 662e  AtomSite = self.
-00082fd0: 6765 7443 6f6f 7264 4174 6f6d 5369 7465  getCoordAtomSite
-00082fe0: 4f66 2863 6861 696e 4964 2c20 7365 7149  Of(chainId, seqI
-00082ff0: 6429 0a0a 2020 2020 2020 2020 2020 2020  d)..            
-00083000: 2020 2020 2020 2020 2020 2020 2320 696e              # in
-00083010: 7472 610a 2020 2020 2020 2020 2020 2020  tra.            
-00083020: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00083030: 656c 662e 5f5f 6363 552e 7570 6461 7465  elf.__ccU.update
-00083040: 4368 656d 436f 6d70 4469 6374 2863 6f6d  ChemCompDict(com
-00083050: 7049 6429 3a0a 2020 2020 2020 2020 2020  pId):.          
-00083060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083070: 2020 6c65 6176 696e 6741 746f 6d49 6473    leavingAtomIds
-00083080: 203d 205b 6363 615b 7365 6c66 2e5f 5f63   = [cca[self.__c
-00083090: 6355 2e63 6361 4174 6f6d 4964 5d20 666f  cU.ccaAtomId] fo
-000830a0: 7220 6363 6120 696e 2073 656c 662e 5f5f  r cca in self.__
-000830b0: 6363 552e 6c61 7374 4174 6f6d 4c69 7374  ccU.lastAtomList
-000830c0: 2069 6620 6363 615b 7365 6c66 2e5f 5f63   if cca[self.__c
-000830d0: 6355 2e63 6361 4c65 6176 696e 6741 746f  cU.ccaLeavingAto
-000830e0: 6d46 6c61 675d 203d 3d20 2759 275d 0a0a  mFlag] == 'Y']..
-000830f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083100: 2020 2020 2020 2020 2020 2020 5f61 746f              _ato
-00083110: 6d49 6453 656c 6563 7420 3d20 7365 7428  mIdSelect = set(
-00083120: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00083130: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00083140: 7220 6363 6220 696e 2073 656c 662e 5f5f  r ccb in self.__
-00083150: 6363 552e 6c61 7374 426f 6e64 733a 0a20  ccU.lastBonds:. 
-00083160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083170: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00083180: 6620 6363 625b 7365 6c66 2e5f 5f63 6355  f ccb[self.__ccU
-00083190: 2e63 6362 4174 6f6d 4964 315d 203d 3d20  .ccbAtomId1] == 
-000831a0: 6174 6f6d 4964 3a0a 2020 2020 2020 2020  atomId:.        
+00082f50: 2020 2020 2020 6622 5468 6520 2761 7474        f"The 'att
+00082f60: 7269 6275 7465 2720 636c 6175 7365 2028  ribute' clause (
+00082f70: 277b 5f61 7474 725f 7072 6f70 7d7b 5f61  '{_attr_prop}{_a
+00082f80: 6273 6f6c 7574 657d 207b 6f70 436f 6465  bsolute} {opCode
+00082f90: 7d20 7b61 7474 725f 7661 6c75 657d 2729  } {attr_value}')
+00082fa0: 2068 6173 206e 6f20 6566 6665 6374 2e22   has no effect."
+00082fb0: 290a 0a20 2020 2020 2020 2020 2020 2065  )..            e
+00082fc0: 6c69 6620 6374 782e 426f 6e64 6564 546f  lif ctx.BondedTo
+00082fd0: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+00082fe0: 2020 2020 6966 2073 656c 662e 5f5f 7365      if self.__se
+00082ff0: 6c5f 6578 7072 5f64 6562 7567 3a0a 2020  l_expr_debug:.  
+00083000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083010: 2020 7072 696e 7428 2220 2022 202a 2073    print("  " * s
+00083020: 656c 662e 6465 7074 6820 2b20 222d 2d3e  elf.depth + "-->
+00083030: 2062 6f6e 6465 6474 6f22 290a 2020 2020   bondedto").    
+00083040: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00083050: 6f74 2073 656c 662e 5f5f 6861 7343 6f6f  ot self.__hasCoo
+00083060: 7264 3a0a 2020 2020 2020 2020 2020 2020  rd:.            
+00083070: 2020 2020 2020 2020 7265 7475 726e 0a20          return. 
+00083080: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00083090: 6620 2761 746f 6d5f 7365 6c65 6374 696f  f 'atom_selectio
+000830a0: 6e27 2069 6e20 7365 6c66 2e66 6163 746f  n' in self.facto
+000830b0: 7220 616e 6420 6c65 6e28 7365 6c66 2e66  r and len(self.f
+000830c0: 6163 746f 725b 2761 746f 6d5f 7365 6c65  actor['atom_sele
+000830d0: 6374 696f 6e27 5d29 203e 2030 3a0a 2020  ction']) > 0:.  
+000830e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000830f0: 2020 5f61 746f 6d53 656c 6563 7469 6f6e    _atomSelection
+00083100: 203d 205b 5d0a 0a20 2020 2020 2020 2020   = []..         
+00083110: 2020 2020 2020 2020 2020 2066 6f72 205f             for _
+00083120: 6174 6f6d 2069 6e20 7365 6c66 2e66 6163  atom in self.fac
+00083130: 746f 725b 2761 746f 6d5f 7365 6c65 6374  tor['atom_select
+00083140: 696f 6e27 5d3a 0a20 2020 2020 2020 2020  ion']:.         
+00083150: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00083160: 6861 696e 4964 203d 205f 6174 6f6d 5b27  hainId = _atom['
+00083170: 6368 6169 6e5f 6964 275d 0a20 2020 2020  chain_id'].     
+00083180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083190: 2020 2063 6f6d 7049 6420 3d20 5f61 746f     compId = _ato
+000831a0: 6d5b 2763 6f6d 705f 6964 275d 0a20 2020  m['comp_id'].   
 000831b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000831c0: 2020 2020 2020 2020 2020 2020 5f61 746f              _ato
-000831d0: 6d49 6453 656c 6563 742e 6164 6428 6363  mIdSelect.add(cc
-000831e0: 625b 7365 6c66 2e5f 5f63 6355 2e63 6362  b[self.__ccU.ccb
-000831f0: 4174 6f6d 4964 325d 290a 2020 2020 2020  AtomId2]).      
-00083200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083210: 2020 2020 2020 2020 2020 656c 6966 2063            elif c
-00083220: 6362 5b73 656c 662e 5f5f 6363 552e 6363  cb[self.__ccU.cc
-00083230: 6241 746f 6d49 6432 5d20 3d3d 2061 746f  bAtomId2] == ato
-00083240: 6d49 643a 0a20 2020 2020 2020 2020 2020  mId:.           
-00083250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083260: 2020 2020 2020 2020 205f 6174 6f6d 4964           _atomId
-00083270: 5365 6c65 6374 2e61 6464 2863 6362 5b73  Select.add(ccb[s
-00083280: 656c 662e 5f5f 6363 552e 6363 6241 746f  elf.__ccU.ccbAto
-00083290: 6d49 6431 5d29 0a0a 2020 2020 2020 2020  mId1])..        
-000832a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000832b0: 2020 2020 6861 734c 6561 6176 696e 6441      hasLeaavindA
-000832c0: 746f 6d49 6420 3d20 4661 6c73 650a 0a20  tomId = False.. 
+000831c0: 2020 2020 2073 6571 4964 203d 205f 6174       seqId = _at
+000831d0: 6f6d 5b27 7365 715f 6964 275d 0a20 2020  om['seq_id'].   
+000831e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000831f0: 2020 2020 2061 746f 6d49 6420 3d20 5f61       atomId = _a
+00083200: 746f 6d5b 2761 746f 6d5f 6964 275d 0a0a  tom['atom_id']..
+00083210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083220: 2020 2020 2020 2020 5f2c 2063 6f6f 7264          _, coord
+00083230: 4174 6f6d 5369 7465 203d 2073 656c 662e  AtomSite = self.
+00083240: 6765 7443 6f6f 7264 4174 6f6d 5369 7465  getCoordAtomSite
+00083250: 4f66 2863 6861 696e 4964 2c20 7365 7149  Of(chainId, seqI
+00083260: 6429 0a0a 2020 2020 2020 2020 2020 2020  d)..            
+00083270: 2020 2020 2020 2020 2020 2020 2320 696e              # in
+00083280: 7472 610a 2020 2020 2020 2020 2020 2020  tra.            
+00083290: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+000832a0: 656c 662e 5f5f 6363 552e 7570 6461 7465  elf.__ccU.update
+000832b0: 4368 656d 436f 6d70 4469 6374 2863 6f6d  ChemCompDict(com
+000832c0: 7049 6429 3a0a 2020 2020 2020 2020 2020  pId):.          
 000832d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000832e0: 2020 2020 2020 2020 2020 2066 6f72 205f             for _
-000832f0: 6174 6f6d 4964 2069 6e20 5f61 746f 6d49  atomId in _atomI
-00083300: 6453 656c 6563 743a 0a0a 2020 2020 2020  dSelect:..      
-00083310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083320: 2020 2020 2020 2020 2020 6966 205f 6174            if _at
-00083330: 6f6d 4964 2069 6e20 6c65 6176 696e 6741  omId in leavingA
-00083340: 746f 6d49 6473 3a0a 2020 2020 2020 2020  tomIds:.        
-00083350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083360: 2020 2020 2020 2020 2020 2020 6861 734c              hasL
-00083370: 6561 6176 696e 6441 746f 6d49 6420 3d20  eaavindAtomId = 
-00083380: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
-00083390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000833a0: 2020 2020 2020 2020 2063 6f6e 7469 6e75           continu
-000833b0: 650a 0a20 2020 2020 2020 2020 2020 2020  e..             
-000833c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000833d0: 2020 205f 6174 6f6d 203d 204e 6f6e 650a     _atom = None.
-000833e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000833f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083400: 6966 2063 6f6f 7264 4174 6f6d 5369 7465  if coordAtomSite
-00083410: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+000832e0: 2020 6c65 6176 696e 6741 746f 6d49 6473    leavingAtomIds
+000832f0: 203d 205b 6363 615b 7365 6c66 2e5f 5f63   = [cca[self.__c
+00083300: 6355 2e63 6361 4174 6f6d 4964 5d20 666f  cU.ccaAtomId] fo
+00083310: 7220 6363 6120 696e 2073 656c 662e 5f5f  r cca in self.__
+00083320: 6363 552e 6c61 7374 4174 6f6d 4c69 7374  ccU.lastAtomList
+00083330: 2069 6620 6363 615b 7365 6c66 2e5f 5f63   if cca[self.__c
+00083340: 6355 2e63 6361 4c65 6176 696e 6741 746f  cU.ccaLeavingAto
+00083350: 6d46 6c61 675d 203d 3d20 2759 275d 0a0a  mFlag] == 'Y']..
+00083360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083370: 2020 2020 2020 2020 2020 2020 5f61 746f              _ato
+00083380: 6d49 6453 656c 6563 7420 3d20 7365 7428  mIdSelect = set(
+00083390: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000833a0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+000833b0: 7220 6363 6220 696e 2073 656c 662e 5f5f  r ccb in self.__
+000833c0: 6363 552e 6c61 7374 426f 6e64 733a 0a20  ccU.lastBonds:. 
+000833d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000833e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000833f0: 6620 6363 625b 7365 6c66 2e5f 5f63 6355  f ccb[self.__ccU
+00083400: 2e63 6362 4174 6f6d 4964 315d 203d 3d20  .ccbAtomId1] == 
+00083410: 6174 6f6d 4964 3a0a 2020 2020 2020 2020  atomId:.        
 00083420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083440: 2020 6966 205f 6174 6f6d 4964 2069 6e20    if _atomId in 
-00083450: 636f 6f72 6441 746f 6d53 6974 655b 2761  coordAtomSite['a
-00083460: 746f 6d5f 6964 275d 3a0a 2020 2020 2020  tom_id']:.      
+00083430: 2020 2020 2020 2020 2020 2020 5f61 746f              _ato
+00083440: 6d49 6453 656c 6563 742e 6164 6428 6363  mIdSelect.add(cc
+00083450: 625b 7365 6c66 2e5f 5f63 6355 2e63 6362  b[self.__ccU.ccb
+00083460: 4174 6f6d 4964 325d 290a 2020 2020 2020  AtomId2]).      
 00083470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083490: 2020 5f61 746f 6d20 3d20 7b7d 0a20 2020    _atom = {}.   
-000834a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000834b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000834c0: 2020 2020 205f 6174 6f6d 5b27 636f 6d70       _atom['comp
-000834d0: 5f69 6427 5d20 3d20 636f 6f72 6441 746f  _id'] = coordAto
-000834e0: 6d53 6974 655b 2763 6f6d 705f 6964 275d  mSite['comp_id']
-000834f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00083500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083510: 2020 2020 2065 6c69 6620 2761 6c74 5f61       elif 'alt_a
-00083520: 746f 6d5f 6964 2720 696e 2063 6f6f 7264  tom_id' in coord
-00083530: 4174 6f6d 5369 7465 2061 6e64 205f 6174  AtomSite and _at
-00083540: 6f6d 4964 2069 6e20 636f 6f72 6441 746f  omId in coordAto
-00083550: 6d53 6974 655b 2761 6c74 5f61 746f 6d5f  mSite['alt_atom_
-00083560: 6964 275d 3a0a 2020 2020 2020 2020 2020  id']:.          
-00083570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083580: 2020 2020 2020 2020 2020 2020 2020 5f61                _a
-00083590: 746f 6d20 3d20 7b7d 0a20 2020 2020 2020  tom = {}.       
-000835a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000835b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000835c0: 205f 6174 6f6d 5b27 636f 6d70 5f69 6427   _atom['comp_id'
-000835d0: 5d20 3d20 636f 6f72 6441 746f 6d53 6974  ] = coordAtomSit
-000835e0: 655b 2763 6f6d 705f 6964 275d 0a0a 2020  e['comp_id']..  
-000835f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083600: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00083610: 205f 6174 6f6d 2069 7320 6e6f 7420 4e6f   _atom is not No
-00083620: 6e65 2061 6e64 205f 6174 6f6d 5b27 636f  ne and _atom['co
-00083630: 6d70 5f69 6427 5d20 3d3d 2063 6f6d 7049  mp_id'] == compI
-00083640: 643a 0a20 2020 2020 2020 2020 2020 2020  d:.             
+00083480: 2020 2020 2020 2020 2020 656c 6966 2063            elif c
+00083490: 6362 5b73 656c 662e 5f5f 6363 552e 6363  cb[self.__ccU.cc
+000834a0: 6241 746f 6d49 6432 5d20 3d3d 2061 746f  bAtomId2] == ato
+000834b0: 6d49 643a 0a20 2020 2020 2020 2020 2020  mId:.           
+000834c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000834d0: 2020 2020 2020 2020 205f 6174 6f6d 4964           _atomId
+000834e0: 5365 6c65 6374 2e61 6464 2863 6362 5b73  Select.add(ccb[s
+000834f0: 656c 662e 5f5f 6363 552e 6363 6241 746f  elf.__ccU.ccbAto
+00083500: 6d49 6431 5d29 0a0a 2020 2020 2020 2020  mId1])..        
+00083510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083520: 2020 2020 6861 734c 6561 6176 696e 6441      hasLeaavindA
+00083530: 746f 6d49 6420 3d20 4661 6c73 650a 0a20  tomId = False.. 
+00083540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083550: 2020 2020 2020 2020 2020 2066 6f72 205f             for _
+00083560: 6174 6f6d 4964 2069 6e20 5f61 746f 6d49  atomId in _atomI
+00083570: 6453 656c 6563 743a 0a0a 2020 2020 2020  dSelect:..      
+00083580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083590: 2020 2020 2020 2020 2020 6966 205f 6174            if _at
+000835a0: 6f6d 4964 2069 6e20 6c65 6176 696e 6741  omId in leavingA
+000835b0: 746f 6d49 6473 3a0a 2020 2020 2020 2020  tomIds:.        
+000835c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000835d0: 2020 2020 2020 2020 2020 2020 6861 734c              hasL
+000835e0: 6561 6176 696e 6441 746f 6d49 6420 3d20  eaavindAtomId = 
+000835f0: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
+00083600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083610: 2020 2020 2020 2020 2063 6f6e 7469 6e75           continu
+00083620: 650a 0a20 2020 2020 2020 2020 2020 2020  e..             
+00083630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083640: 2020 205f 6174 6f6d 203d 204e 6f6e 650a     _atom = None.
 00083650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083660: 2020 2020 2020 205f 6174 6f6d 5365 6c65         _atomSele
-00083670: 6374 696f 6e2e 6170 7065 6e64 287b 2763  ction.append({'c
-00083680: 6861 696e 5f69 6427 3a20 6368 6169 6e49  hain_id': chainI
-00083690: 642c 2027 7365 715f 6964 273a 2073 6571  d, 'seq_id': seq
-000836a0: 4964 2c20 2763 6f6d 705f 6964 273a 2063  Id, 'comp_id': c
-000836b0: 6f6d 7049 642c 2027 6174 6f6d 5f69 6427  ompId, 'atom_id'
-000836c0: 3a20 5f61 746f 6d49 647d 290a 0a20 2020  : _atomId})..   
-000836d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000836e0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-000836f0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00083700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083710: 2020 2020 2020 2070 7320 3d20 6e65 7874         ps = next
-00083720: 2828 7073 2066 6f72 2070 7320 696e 2073  ((ps for ps in s
-00083730: 656c 662e 5f5f 706f 6c79 5365 7120 6966  elf.__polySeq if
-00083740: 2070 735b 2761 7574 685f 6368 6169 6e5f   ps['auth_chain_
-00083750: 6964 275d 203d 3d20 6368 6169 6e49 6429  id'] == chainId)
-00083760: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
+00083660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083670: 6966 2063 6f6f 7264 4174 6f6d 5369 7465  if coordAtomSite
+00083680: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+00083690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000836a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000836b0: 2020 6966 205f 6174 6f6d 4964 2069 6e20    if _atomId in 
+000836c0: 636f 6f72 6441 746f 6d53 6974 655b 2761  coordAtomSite['a
+000836d0: 746f 6d5f 6964 275d 3a0a 2020 2020 2020  tom_id']:.      
+000836e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000836f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083700: 2020 5f61 746f 6d20 3d20 7b7d 0a20 2020    _atom = {}.   
+00083710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083730: 2020 2020 205f 6174 6f6d 5b27 636f 6d70       _atom['comp
+00083740: 5f69 6427 5d20 3d20 636f 6f72 6441 746f  _id'] = coordAto
+00083750: 6d53 6974 655b 2763 6f6d 705f 6964 275d  mSite['comp_id']
+00083760: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00083770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083780: 2020 2020 2020 2020 2020 2020 6966 2070              if p
-00083790: 7320 6973 206e 6f74 204e 6f6e 6520 616e  s is not None an
-000837a0: 6420 7365 7149 6420 696e 2070 735b 2761  d seqId in ps['a
-000837b0: 7574 685f 7365 715f 6964 275d 2061 6e64  uth_seq_id'] and
-000837c0: 2070 735b 2763 6f6d 705f 6964 275d 5b70   ps['comp_id'][p
-000837d0: 735b 2761 7574 685f 7365 715f 6964 275d  s['auth_seq_id']
-000837e0: 2e69 6e64 6578 2873 6571 4964 295d 203d  .index(seqId)] =
-000837f0: 3d20 636f 6d70 4964 3a0a 2020 2020 2020  = compId:.      
-00083800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083780: 2020 2020 2065 6c69 6620 2761 6c74 5f61       elif 'alt_a
+00083790: 746f 6d5f 6964 2720 696e 2063 6f6f 7264  tom_id' in coord
+000837a0: 4174 6f6d 5369 7465 2061 6e64 205f 6174  AtomSite and _at
+000837b0: 6f6d 4964 2069 6e20 636f 6f72 6441 746f  omId in coordAto
+000837c0: 6d53 6974 655b 2761 6c74 5f61 746f 6d5f  mSite['alt_atom_
+000837d0: 6964 275d 3a0a 2020 2020 2020 2020 2020  id']:.          
+000837e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000837f0: 2020 2020 2020 2020 2020 2020 2020 5f61                _a
+00083800: 746f 6d20 3d20 7b7d 0a20 2020 2020 2020  tom = {}.       
 00083810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083820: 2020 7365 7149 6420 3d20 7365 6c66 2e67    seqId = self.g
-00083830: 6574 5265 616c 5365 7149 6428 7073 2c20  etRealSeqId(ps, 
-00083840: 7365 7149 6429 0a20 2020 2020 2020 2020  seqId).         
-00083850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083860: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00083870: 6620 616e 7928 6363 6120 666f 7220 6363  f any(cca for cc
-00083880: 6120 696e 2073 656c 662e 5f5f 6363 552e  a in self.__ccU.
-00083890: 6c61 7374 4174 6f6d 4c69 7374 2069 6620  lastAtomList if 
-000838a0: 6363 615b 7365 6c66 2e5f 5f63 6355 2e63  cca[self.__ccU.c
-000838b0: 6361 4174 6f6d 4964 5d20 3d3d 205f 6174  caAtomId] == _at
-000838c0: 6f6d 4964 293a 0a20 2020 2020 2020 2020  omId):.         
-000838d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000838e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000838f0: 2020 205f 6174 6f6d 5365 6c65 6374 696f     _atomSelectio
-00083900: 6e2e 6170 7065 6e64 287b 2763 6861 696e  n.append({'chain
-00083910: 5f69 6427 3a20 6368 6169 6e49 642c 2027  _id': chainId, '
-00083920: 7365 715f 6964 273a 2073 6571 4964 2c20  seq_id': seqId, 
-00083930: 2763 6f6d 705f 6964 273a 2063 6f6d 7049  'comp_id': compI
-00083940: 642c 2027 6174 6f6d 5f69 6427 3a20 5f61  d, 'atom_id': _a
-00083950: 746f 6d49 647d 290a 2020 2020 2020 2020  tomId}).        
-00083960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083970: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00083980: 656c 662e 5f5f 6861 734e 6f6e 506f 6c79  elf.__hasNonPoly
-00083990: 5365 713a 0a20 2020 2020 2020 2020 2020  Seq:.           
-000839a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000839b0: 2020 2020 2020 2020 2020 2020 206e 704c               npL
-000839c0: 6973 7420 3d20 5b6e 7020 666f 7220 6e70  ist = [np for np
-000839d0: 2069 6e20 7365 6c66 2e5f 5f6e 6f6e 506f   in self.__nonPo
-000839e0: 6c79 5365 7120 6966 206e 705b 2761 7574  lySeq if np['aut
-000839f0: 685f 6368 6169 6e5f 6964 275d 203d 3d20  h_chain_id'] == 
-00083a00: 6368 6169 6e49 645d 0a20 2020 2020 2020  chainId].       
-00083a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083a30: 2066 6f72 206e 7020 696e 206e 704c 6973   for np in npLis
-00083a40: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
-00083a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083a60: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00083a70: 6620 7365 7149 6420 696e 206e 705b 2761  f seqId in np['a
-00083a80: 7574 685f 7365 715f 6964 275d 2061 6e64  uth_seq_id'] and
-00083a90: 206e 705b 2763 6f6d 705f 6964 275d 5b6e   np['comp_id'][n
-00083aa0: 705b 2761 7574 685f 7365 715f 6964 275d  p['auth_seq_id']
-00083ab0: 2e69 6e64 6578 2873 6571 4964 295d 203d  .index(seqId)] =
-00083ac0: 3d20 636f 6d70 4964 3a0a 2020 2020 2020  = compId:.      
-00083ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083af0: 2020 2020 2020 2020 2020 7365 7149 6420            seqId 
-00083b00: 3d20 7365 6c66 2e67 6574 5265 616c 5365  = self.getRealSe
-00083b10: 7149 6428 6e70 2c20 7365 7149 642c 2046  qId(np, seqId, F
-00083b20: 616c 7365 290a 2020 2020 2020 2020 2020  alse).          
-00083b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083830: 205f 6174 6f6d 5b27 636f 6d70 5f69 6427   _atom['comp_id'
+00083840: 5d20 3d20 636f 6f72 6441 746f 6d53 6974  ] = coordAtomSit
+00083850: 655b 2763 6f6d 705f 6964 275d 0a0a 2020  e['comp_id']..  
+00083860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083870: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00083880: 205f 6174 6f6d 2069 7320 6e6f 7420 4e6f   _atom is not No
+00083890: 6e65 2061 6e64 205f 6174 6f6d 5b27 636f  ne and _atom['co
+000838a0: 6d70 5f69 6427 5d20 3d3d 2063 6f6d 7049  mp_id'] == compI
+000838b0: 643a 0a20 2020 2020 2020 2020 2020 2020  d:.             
+000838c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000838d0: 2020 2020 2020 205f 6174 6f6d 5365 6c65         _atomSele
+000838e0: 6374 696f 6e2e 6170 7065 6e64 287b 2763  ction.append({'c
+000838f0: 6861 696e 5f69 6427 3a20 6368 6169 6e49  hain_id': chainI
+00083900: 642c 2027 7365 715f 6964 273a 2073 6571  d, 'seq_id': seq
+00083910: 4964 2c20 2763 6f6d 705f 6964 273a 2063  Id, 'comp_id': c
+00083920: 6f6d 7049 642c 2027 6174 6f6d 5f69 6427  ompId, 'atom_id'
+00083930: 3a20 5f61 746f 6d49 647d 290a 0a20 2020  : _atomId})..   
+00083940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083950: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00083960: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00083970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083980: 2020 2020 2020 2070 7320 3d20 6e65 7874         ps = next
+00083990: 2828 7073 2066 6f72 2070 7320 696e 2073  ((ps for ps in s
+000839a0: 656c 662e 5f5f 706f 6c79 5365 7120 6966  elf.__polySeq if
+000839b0: 2070 735b 2761 7574 685f 6368 6169 6e5f   ps['auth_chain_
+000839c0: 6964 275d 203d 3d20 6368 6169 6e49 6429  id'] == chainId)
+000839d0: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
+000839e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000839f0: 2020 2020 2020 2020 2020 2020 6966 2070              if p
+00083a00: 7320 6973 206e 6f74 204e 6f6e 6520 616e  s is not None an
+00083a10: 6420 7365 7149 6420 696e 2070 735b 2761  d seqId in ps['a
+00083a20: 7574 685f 7365 715f 6964 275d 2061 6e64  uth_seq_id'] and
+00083a30: 2070 735b 2763 6f6d 705f 6964 275d 5b70   ps['comp_id'][p
+00083a40: 735b 2761 7574 685f 7365 715f 6964 275d  s['auth_seq_id']
+00083a50: 2e69 6e64 6578 2873 6571 4964 295d 203d  .index(seqId)] =
+00083a60: 3d20 636f 6d70 4964 3a0a 2020 2020 2020  = compId:.      
+00083a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083a90: 2020 7365 7149 6420 3d20 7365 6c66 2e67    seqId = self.g
+00083aa0: 6574 5265 616c 5365 7149 6428 7073 2c20  etRealSeqId(ps, 
+00083ab0: 7365 7149 6429 0a20 2020 2020 2020 2020  seqId).         
+00083ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083ad0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00083ae0: 6620 616e 7928 6363 6120 666f 7220 6363  f any(cca for cc
+00083af0: 6120 696e 2073 656c 662e 5f5f 6363 552e  a in self.__ccU.
+00083b00: 6c61 7374 4174 6f6d 4c69 7374 2069 6620  lastAtomList if 
+00083b10: 6363 615b 7365 6c66 2e5f 5f63 6355 2e63  cca[self.__ccU.c
+00083b20: 6361 4174 6f6d 4964 5d20 3d3d 205f 6174  caAtomId] == _at
+00083b30: 6f6d 4964 293a 0a20 2020 2020 2020 2020  omId):.         
 00083b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083b50: 2020 2020 2020 6966 2061 6e79 2863 6361        if any(cca
-00083b60: 2066 6f72 2063 6361 2069 6e20 7365 6c66   for cca in self
-00083b70: 2e5f 5f63 6355 2e6c 6173 7441 746f 6d4c  .__ccU.lastAtomL
-00083b80: 6973 7420 6966 2063 6361 5b73 656c 662e  ist if cca[self.
-00083b90: 5f5f 6363 552e 6363 6141 746f 6d49 645d  __ccU.ccaAtomId]
-00083ba0: 203d 3d20 5f61 746f 6d49 6429 3a0a 2020   == _atomId):.  
-00083bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083b60: 2020 205f 6174 6f6d 5365 6c65 6374 696f     _atomSelectio
+00083b70: 6e2e 6170 7065 6e64 287b 2763 6861 696e  n.append({'chain
+00083b80: 5f69 6427 3a20 6368 6169 6e49 642c 2027  _id': chainId, '
+00083b90: 7365 715f 6964 273a 2073 6571 4964 2c20  seq_id': seqId, 
+00083ba0: 2763 6f6d 705f 6964 273a 2063 6f6d 7049  'comp_id': compI
+00083bb0: 642c 2027 6174 6f6d 5f69 6427 3a20 5f61  d, 'atom_id': _a
+00083bc0: 746f 6d49 647d 290a 2020 2020 2020 2020  tomId}).        
 00083bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083be0: 2020 5f61 746f 6d53 656c 6563 7469 6f6e    _atomSelection
-00083bf0: 2e61 7070 656e 6428 7b27 6368 6169 6e5f  .append({'chain_
-00083c00: 6964 273a 2063 6861 696e 4964 2c20 2773  id': chainId, 's
-00083c10: 6571 5f69 6427 3a20 7365 7149 642c 2027  eq_id': seqId, '
-00083c20: 636f 6d70 5f69 6427 3a20 636f 6d70 4964  comp_id': compId
-00083c30: 2c20 2761 746f 6d5f 6964 273a 205f 6174  , 'atom_id': _at
-00083c40: 6f6d 4964 7d29 0a0a 2020 2020 2020 2020  omId})..        
-00083c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083c60: 2020 2020 2320 7365 7175 656e 7469 616c      # sequential
-00083c70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00083c80: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00083c90: 6861 734c 6561 6176 696e 6441 746f 6d49  hasLeaavindAtomI
-00083ca0: 643a 0a20 2020 2020 2020 2020 2020 2020  d:.             
-00083cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083cc0: 2020 205f 6f72 6967 696e 203d 5c0a 2020     _origin =\.  
-00083cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083cf0: 2020 7365 6c66 2e5f 5f63 522e 6765 7444    self.__cR.getD
-00083d00: 6963 744c 6973 7457 6974 6846 696c 7465  ictListWithFilte
-00083d10: 7228 2761 746f 6d5f 7369 7465 272c 0a20  r('atom_site',. 
-00083d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083be0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00083bf0: 656c 662e 5f5f 6861 734e 6f6e 506f 6c79  elf.__hasNonPoly
+00083c00: 5365 713a 0a20 2020 2020 2020 2020 2020  Seq:.           
+00083c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083c20: 2020 2020 2020 2020 2020 2020 206e 704c               npL
+00083c30: 6973 7420 3d20 5b6e 7020 666f 7220 6e70  ist = [np for np
+00083c40: 2069 6e20 7365 6c66 2e5f 5f6e 6f6e 506f   in self.__nonPo
+00083c50: 6c79 5365 7120 6966 206e 705b 2761 7574  lySeq if np['aut
+00083c60: 685f 6368 6169 6e5f 6964 275d 203d 3d20  h_chain_id'] == 
+00083c70: 6368 6169 6e49 645d 0a20 2020 2020 2020  chainId].       
+00083c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083ca0: 2066 6f72 206e 7020 696e 206e 704c 6973   for np in npLis
+00083cb0: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
+00083cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083cd0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00083ce0: 6620 7365 7149 6420 696e 206e 705b 2761  f seqId in np['a
+00083cf0: 7574 685f 7365 715f 6964 275d 2061 6e64  uth_seq_id'] and
+00083d00: 206e 705b 2763 6f6d 705f 6964 275d 5b6e   np['comp_id'][n
+00083d10: 705b 2761 7574 685f 7365 715f 6964 275d  p['auth_seq_id']
+00083d20: 2e69 6e64 6578 2873 6571 4964 295d 203d  .index(seqId)] =
+00083d30: 3d20 636f 6d70 4964 3a0a 2020 2020 2020  = compId:.      
 00083d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00083d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083d60: 2020 2043 4152 544e 5f44 4154 415f 4954     CARTN_DATA_IT
-00083d70: 454d 532c 0a20 2020 2020 2020 2020 2020  EMS,.           
-00083d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083d60: 2020 2020 2020 2020 2020 7365 7149 6420            seqId 
+00083d70: 3d20 7365 6c66 2e67 6574 5265 616c 5365  = self.getRealSe
+00083d80: 7149 6428 6e70 2c20 7365 7149 642c 2046  qId(np, seqId, F
+00083d90: 616c 7365 290a 2020 2020 2020 2020 2020  alse).          
 00083da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083db0: 2020 2020 2020 2020 205b 7b27 6e61 6d65           [{'name
-00083dc0: 273a 2073 656c 662e 5f5f 6175 7468 4173  ': self.__authAs
-00083dd0: 796d 4964 2c20 2774 7970 6527 3a20 2773  ymId, 'type': 's
-00083de0: 7472 272c 2027 7661 6c75 6527 3a20 6368  tr', 'value': ch
-00083df0: 6169 6e49 647d 2c0a 2020 2020 2020 2020  ainId},.        
-00083e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083dc0: 2020 2020 2020 6966 2061 6e79 2863 6361        if any(cca
+00083dd0: 2066 6f72 2063 6361 2069 6e20 7365 6c66   for cca in self
+00083de0: 2e5f 5f63 6355 2e6c 6173 7441 746f 6d4c  .__ccU.lastAtomL
+00083df0: 6973 7420 6966 2063 6361 5b73 656c 662e  ist if cca[self.
+00083e00: 5f5f 6363 552e 6363 6141 746f 6d49 645d  __ccU.ccaAtomId]
+00083e10: 203d 3d20 5f61 746f 6d49 6429 3a0a 2020   == _atomId):.  
 00083e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083e30: 2020 2020 2020 2020 2020 2020 207b 276e               {'n
-00083e40: 616d 6527 3a20 7365 6c66 2e5f 5f61 7574  ame': self.__aut
-00083e50: 6853 6571 4964 2c20 2774 7970 6527 3a20  hSeqId, 'type': 
-00083e60: 2769 6e74 272c 2027 7661 6c75 6527 3a20  'int', 'value': 
-00083e70: 7365 7149 647d 2c0a 2020 2020 2020 2020  seqId},.        
-00083e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083eb0: 2020 2020 2020 2020 2020 2020 207b 276e               {'n
-00083ec0: 616d 6527 3a20 7365 6c66 2e5f 5f61 7574  ame': self.__aut
-00083ed0: 6841 746f 6d49 642c 2027 7479 7065 273a  hAtomId, 'type':
-00083ee0: 2027 7374 7227 2c20 2776 616c 7565 273a   'str', 'value':
-00083ef0: 2061 746f 6d49 647d 2c0a 2020 2020 2020   atomId},.      
-00083f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083e50: 2020 5f61 746f 6d53 656c 6563 7469 6f6e    _atomSelection
+00083e60: 2e61 7070 656e 6428 7b27 6368 6169 6e5f  .append({'chain_
+00083e70: 6964 273a 2063 6861 696e 4964 2c20 2773  id': chainId, 's
+00083e80: 6571 5f69 6427 3a20 7365 7149 642c 2027  eq_id': seqId, '
+00083e90: 636f 6d70 5f69 6427 3a20 636f 6d70 4964  comp_id': compId
+00083ea0: 2c20 2761 746f 6d5f 6964 273a 205f 6174  , 'atom_id': _at
+00083eb0: 6f6d 4964 7d29 0a0a 2020 2020 2020 2020  omId})..        
+00083ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083ed0: 2020 2020 2320 7365 7175 656e 7469 616c      # sequential
+00083ee0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00083ef0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00083f00: 6861 734c 6561 6176 696e 6441 746f 6d49  hasLeaavindAtomI
+00083f10: 643a 0a20 2020 2020 2020 2020 2020 2020  d:.             
 00083f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083f30: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-00083f40: 276e 616d 6527 3a20 7365 6c66 2e5f 5f6d  'name': self.__m
-00083f50: 6f64 656c 4e75 6d4e 616d 652c 2027 7479  odelNumName, 'ty
-00083f60: 7065 273a 2027 696e 7427 2c0a 2020 2020  pe': 'int',.    
-00083f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083f30: 2020 205f 6f72 6967 696e 203d 5c0a 2020     _origin =\.  
+00083f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083f60: 2020 7365 6c66 2e5f 5f63 522e 6765 7444    self.__cR.getD
+00083f70: 6963 744c 6973 7457 6974 6846 696c 7465  ictListWithFilte
+00083f80: 7228 2761 746f 6d5f 7369 7465 272c 0a20  r('atom_site',. 
 00083f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00083fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00083fb0: 2020 2776 616c 7565 273a 2073 656c 662e    'value': self.
-00083fc0: 5f5f 7265 7072 6573 656e 7461 7469 7665  __representative
-00083fd0: 4d6f 6465 6c49 647d 2c0a 2020 2020 2020  ModelId},.      
-00083fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00083fd0: 2020 2043 4152 544e 5f44 4154 415f 4954     CARTN_DATA_IT
+00083fe0: 454d 532c 0a20 2020 2020 2020 2020 2020  EMS,.           
 00083ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00084000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084010: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-00084020: 276e 616d 6527 3a20 276c 6162 656c 5f61  'name': 'label_a
-00084030: 6c74 5f69 6427 2c20 2774 7970 6527 3a20  lt_id', 'type': 
-00084040: 2765 6e75 6d27 2c0a 2020 2020 2020 2020  'enum',.        
-00084050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084020: 2020 2020 2020 2020 205b 7b27 6e61 6d65           [{'name
+00084030: 273a 2073 656c 662e 5f5f 6175 7468 4173  ': self.__authAs
+00084040: 796d 4964 2c20 2774 7970 6527 3a20 2773  ymId, 'type': 's
+00084050: 7472 272c 2027 7661 6c75 6527 3a20 6368  tr', 'value': ch
+00084060: 6169 6e49 647d 2c0a 2020 2020 2020 2020  ainId},.        
 00084070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084080: 2020 2020 2020 2020 2020 2020 2020 2765                'e
-00084090: 6e75 6d27 3a20 2827 4127 297d 0a20 2020  num': ('A')}.   
-000840a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000840b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000840c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000840d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000840e0: 2020 5d29 0a0a 2020 2020 2020 2020 2020    ])..          
+00084080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000840a0: 2020 2020 2020 2020 2020 2020 207b 276e               {'n
+000840b0: 616d 6527 3a20 7365 6c66 2e5f 5f61 7574  ame': self.__aut
+000840c0: 6853 6571 4964 2c20 2774 7970 6527 3a20  hSeqId, 'type': 
+000840d0: 2769 6e74 272c 2027 7661 6c75 6527 3a20  'int', 'value': 
+000840e0: 7365 7149 647d 2c0a 2020 2020 2020 2020  seqId},.        
 000840f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084100: 2020 2020 2020 6966 206c 656e 285f 6f72        if len(_or
-00084110: 6967 696e 2920 3d3d 2031 3a0a 2020 2020  igin) == 1:.    
-00084120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084140: 6f72 6967 696e 203d 2074 6f4e 7041 7272  origin = toNpArr
-00084150: 6179 285f 6f72 6967 696e 5b30 5d29 0a0a  ay(_origin[0])..
-00084160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084120: 2020 2020 2020 2020 2020 2020 207b 276e               {'n
+00084130: 616d 6527 3a20 7365 6c66 2e5f 5f61 7574  ame': self.__aut
+00084140: 6841 746f 6d49 642c 2027 7479 7065 273a  hAtomId, 'type':
+00084150: 2027 7374 7227 2c20 2776 616c 7565 273a   'str', 'value':
+00084160: 2061 746f 6d49 647d 2c0a 2020 2020 2020   atomId},.      
 00084170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084180: 2020 2020 7073 203d 206e 6578 7428 2870      ps = next((p
-00084190: 7320 666f 7220 7073 2069 6e20 7365 6c66  s for ps in self
-000841a0: 2e5f 5f70 6f6c 7953 6571 2069 6620 7073  .__polySeq if ps
-000841b0: 5b27 6175 7468 5f63 6861 696e 5f69 6427  ['auth_chain_id'
-000841c0: 5d20 3d3d 2063 6861 696e 4964 292c 204e  ] == chainId), N
-000841d0: 6f6e 6529 0a20 2020 2020 2020 2020 2020  one).           
+00084180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000841a0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+000841b0: 276e 616d 6527 3a20 7365 6c66 2e5f 5f6d  'name': self.__m
+000841c0: 6f64 656c 4e75 6d4e 616d 652c 2027 7479  odelNumName, 'ty
+000841d0: 7065 273a 2027 696e 7427 2c0a 2020 2020  pe': 'int',.    
 000841e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000841f0: 2020 2020 2020 2020 2069 6620 7073 2069           if ps i
-00084200: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+000841f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084200: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00084210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084230: 2020 2020 666f 7220 5f73 6571 4964 2069      for _seqId i
-00084240: 6e20 5b73 6571 4964 202d 2031 2c20 7365  n [seqId - 1, se
-00084250: 7149 6420 2b20 315d 3a0a 2020 2020 2020  qId + 1]:.      
+00084220: 2020 2776 616c 7565 273a 2073 656c 662e    'value': self.
+00084230: 5f5f 7265 7072 6573 656e 7461 7469 7665  __representative
+00084240: 4d6f 6465 6c49 647d 2c0a 2020 2020 2020  ModelId},.      
+00084250: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00084260: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00084270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084280: 2020 2020 2020 6966 205f 7365 7149 6420        if _seqId 
-00084290: 696e 2070 735b 2761 7574 685f 7365 715f  in ps['auth_seq_
-000842a0: 6964 275d 3a0a 2020 2020 2020 2020 2020  id']:.          
-000842b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084280: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+00084290: 276e 616d 6527 3a20 276c 6162 656c 5f61  'name': 'label_a
+000842a0: 6c74 5f69 6427 2c20 2774 7970 6527 3a20  lt_id', 'type': 
+000842b0: 2765 6e75 6d27 2c0a 2020 2020 2020 2020  'enum',.        
 000842c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000842d0: 2020 2020 2020 5f73 6571 4964 203d 2073        _seqId = s
-000842e0: 656c 662e 6765 7452 6561 6c53 6571 4964  elf.getRealSeqId
-000842f0: 2870 732c 205f 7365 7149 6429 0a20 2020  (ps, _seqId).   
-00084300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000842d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000842e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000842f0: 2020 2020 2020 2020 2020 2020 2020 2765                'e
+00084300: 6e75 6d27 3a20 2827 4127 297d 0a20 2020  num': ('A')}.   
 00084310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084320: 2020 2020 2020 2020 2020 2020 205f 636f               _co
-00084330: 6d70 4964 203d 2070 735b 2763 6f6d 705f  mpId = ps['comp_
-00084340: 6964 275d 5b70 735b 2761 7574 685f 7365  id'][ps['auth_se
-00084350: 715f 6964 275d 2e69 6e64 6578 285f 7365  q_id'].index(_se
-00084360: 7149 6429 5d0a 2020 2020 2020 2020 2020  qId)].          
-00084370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084390: 2020 2020 2020 6966 2073 656c 662e 5f5f        if self.__
-000843a0: 6363 552e 7570 6461 7465 4368 656d 436f  ccU.updateChemCo
-000843b0: 6d70 4469 6374 285f 636f 6d70 4964 293a  mpDict(_compId):
-000843c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00084320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084350: 2020 5d29 0a0a 2020 2020 2020 2020 2020    ])..          
+00084360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084370: 2020 2020 2020 6966 206c 656e 285f 6f72        if len(_or
+00084380: 6967 696e 2920 3d3d 2031 3a0a 2020 2020  igin) == 1:.    
+00084390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000843a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000843b0: 6f72 6967 696e 203d 2074 6f4e 7041 7272  origin = toNpArr
+000843c0: 6179 285f 6f72 6967 696e 5b30 5d29 0a0a  ay(_origin[0])..
 000843d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000843e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000843f0: 2020 2020 206c 6561 7669 6e67 4174 6f6d       leavingAtom
-00084400: 4964 7320 3d20 5b63 6361 5b73 656c 662e  Ids = [cca[self.
-00084410: 5f5f 6363 552e 6363 6141 746f 6d49 645d  __ccU.ccaAtomId]
-00084420: 2066 6f72 2063 6361 2069 6e20 7365 6c66   for cca in self
-00084430: 2e5f 5f63 6355 2e6c 6173 7441 746f 6d4c  .__ccU.lastAtomL
-00084440: 6973 7420 6966 2063 6361 5b73 656c 662e  ist if cca[self.
-00084450: 5f5f 6363 552e 6363 614c 6561 7669 6e67  __ccU.ccaLeaving
-00084460: 4174 6f6d 466c 6167 5d20 3d3d 2027 5927  AtomFlag] == 'Y'
-00084470: 5d0a 0a20 2020 2020 2020 2020 2020 2020  ]..             
+000843f0: 2020 2020 7073 203d 206e 6578 7428 2870      ps = next((p
+00084400: 7320 666f 7220 7073 2069 6e20 7365 6c66  s for ps in self
+00084410: 2e5f 5f70 6f6c 7953 6571 2069 6620 7073  .__polySeq if ps
+00084420: 5b27 6175 7468 5f63 6861 696e 5f69 6427  ['auth_chain_id'
+00084430: 5d20 3d3d 2063 6861 696e 4964 292c 204e  ] == chainId), N
+00084440: 6f6e 6529 0a20 2020 2020 2020 2020 2020  one).           
+00084450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084460: 2020 2020 2020 2020 2069 6620 7073 2069           if ps i
+00084470: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
 00084480: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00084490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000844a0: 2020 2020 2020 205f 6174 6f6d 4964 5365         _atomIdSe
-000844b0: 6c65 6374 203d 2073 6574 2829 0a20 2020  lect = set().   
-000844c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000844a0: 2020 2020 666f 7220 5f73 6571 4964 2069      for _seqId i
+000844b0: 6e20 5b73 6571 4964 202d 2031 2c20 7365  n [seqId - 1, se
+000844c0: 7149 6420 2b20 315d 3a0a 2020 2020 2020  qId + 1]:.      
 000844d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000844e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000844f0: 2066 6f72 2063 6362 2069 6e20 7365 6c66   for ccb in self
-00084500: 2e5f 5f63 6355 2e6c 6173 7442 6f6e 6473  .__ccU.lastBonds
-00084510: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000844f0: 2020 2020 2020 6966 205f 7365 7149 6420        if _seqId 
+00084500: 696e 2070 735b 2761 7574 685f 7365 715f  in ps['auth_seq_
+00084510: 6964 275d 3a0a 2020 2020 2020 2020 2020  id']:.          
 00084520: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00084530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084540: 2020 2020 2020 2020 2020 6966 2063 6362            if ccb
-00084550: 5b73 656c 662e 5f5f 6363 552e 6363 6241  [self.__ccU.ccbA
-00084560: 746f 6d49 6431 5d20 696e 206c 6561 7669  tomId1] in leavi
-00084570: 6e67 4174 6f6d 4964 733a 0a20 2020 2020  ngAtomIds:.     
+00084540: 2020 2020 2020 5f73 6571 4964 203d 2073        _seqId = s
+00084550: 656c 662e 6765 7452 6561 6c53 6571 4964  elf.getRealSeqId
+00084560: 2870 732c 205f 7365 7149 6429 0a20 2020  (ps, _seqId).   
+00084570: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00084580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000845a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000845b0: 2020 2020 2020 205f 6174 6f6d 4964 203d         _atomId =
-000845c0: 2063 6362 5b73 656c 662e 5f5f 6363 552e   ccb[self.__ccU.
-000845d0: 6363 6241 746f 6d49 6432 5d0a 2020 2020  ccbAtomId2].    
+00084590: 2020 2020 2020 2020 2020 2020 205f 636f               _co
+000845a0: 6d70 4964 203d 2070 735b 2763 6f6d 705f  mpId = ps['comp_
+000845b0: 6964 275d 5b70 735b 2761 7574 685f 7365  id'][ps['auth_se
+000845c0: 715f 6964 275d 2e69 6e64 6578 285f 7365  q_id'].index(_se
+000845d0: 7149 6429 5d0a 2020 2020 2020 2020 2020  qId)].          
 000845e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000845f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084610: 2020 2020 2020 2020 6966 205f 6174 6f6d          if _atom
-00084620: 4964 206e 6f74 2069 6e20 6c65 6176 696e  Id not in leavin
-00084630: 6741 746f 6d49 6473 3a0a 2020 2020 2020  gAtomIds:.      
+00084600: 2020 2020 2020 6966 2073 656c 662e 5f5f        if self.__
+00084610: 6363 552e 7570 6461 7465 4368 656d 436f  ccU.updateChemCo
+00084620: 6d70 4469 6374 285f 636f 6d70 4964 293a  mpDict(_compId):
+00084630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00084640: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00084650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084670: 2020 2020 2020 2020 2020 5f61 746f 6d49            _atomI
-00084680: 6453 656c 6563 742e 6164 6428 5f61 746f  dSelect.add(_ato
-00084690: 6d49 6429 0a20 2020 2020 2020 2020 2020  mId).           
-000846a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000846b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000846c0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000846d0: 6363 625b 7365 6c66 2e5f 5f63 6355 2e63  ccb[self.__ccU.c
-000846e0: 6362 4174 6f6d 4964 325d 2069 6e20 6c65  cbAtomId2] in le
-000846f0: 6176 696e 6741 746f 6d49 6473 3a0a 2020  avingAtomIds:.  
+00084660: 2020 2020 206c 6561 7669 6e67 4174 6f6d       leavingAtom
+00084670: 4964 7320 3d20 5b63 6361 5b73 656c 662e  Ids = [cca[self.
+00084680: 5f5f 6363 552e 6363 6141 746f 6d49 645d  __ccU.ccaAtomId]
+00084690: 2066 6f72 2063 6361 2069 6e20 7365 6c66   for cca in self
+000846a0: 2e5f 5f63 6355 2e6c 6173 7441 746f 6d4c  .__ccU.lastAtomL
+000846b0: 6973 7420 6966 2063 6361 5b73 656c 662e  ist if cca[self.
+000846c0: 5f5f 6363 552e 6363 614c 6561 7669 6e67  __ccU.ccaLeaving
+000846d0: 4174 6f6d 466c 6167 5d20 3d3d 2027 5927  AtomFlag] == 'Y'
+000846e0: 5d0a 0a20 2020 2020 2020 2020 2020 2020  ]..             
+000846f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00084700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084730: 2020 2020 2020 2020 2020 5f61 746f 6d49            _atomI
-00084740: 6420 3d20 6363 625b 7365 6c66 2e5f 5f63  d = ccb[self.__c
-00084750: 6355 2e63 6362 4174 6f6d 4964 315d 0a20  cU.ccbAtomId1]. 
-00084760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084790: 2020 2020 2020 2020 2020 2069 6620 5f61             if _a
-000847a0: 746f 6d49 6420 6e6f 7420 696e 206c 6561  tomId not in lea
-000847b0: 7669 6e67 4174 6f6d 4964 733a 0a20 2020  vingAtomIds:.   
-000847c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000847d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000847e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000847f0: 2020 2020 2020 2020 2020 2020 205f 6174               _at
-00084800: 6f6d 4964 5365 6c65 6374 2e61 6464 285f  omIdSelect.add(_
-00084810: 6174 6f6d 4964 290a 0a20 2020 2020 2020  atomId)..       
-00084820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084840: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00084850: 205f 6174 6f6d 4964 2069 6e20 5f61 746f   _atomId in _ato
-00084860: 6d49 6453 656c 6563 743a 0a20 2020 2020  mIdSelect:.     
+00084710: 2020 2020 2020 205f 6174 6f6d 4964 5365         _atomIdSe
+00084720: 6c65 6374 203d 2073 6574 2829 0a20 2020  lect = set().   
+00084730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084760: 2066 6f72 2063 6362 2069 6e20 7365 6c66   for ccb in self
+00084770: 2e5f 5f63 6355 2e6c 6173 7442 6f6e 6473  .__ccU.lastBonds
+00084780: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00084790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000847a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000847b0: 2020 2020 2020 2020 2020 6966 2063 6362            if ccb
+000847c0: 5b73 656c 662e 5f5f 6363 552e 6363 6241  [self.__ccU.ccbA
+000847d0: 746f 6d49 6431 5d20 696e 206c 6561 7669  tomId1] in leavi
+000847e0: 6e67 4174 6f6d 4964 733a 0a20 2020 2020  ngAtomIds:.     
+000847f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084820: 2020 2020 2020 205f 6174 6f6d 4964 203d         _atomId =
+00084830: 2063 6362 5b73 656c 662e 5f5f 6363 552e   ccb[self.__ccU.
+00084840: 6363 6241 746f 6d49 6432 5d0a 2020 2020  ccbAtomId2].    
+00084850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084860: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00084870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000848a0: 2020 205f 6e65 6967 6862 6f72 203d 5c0a     _neighbor =\.
+00084880: 2020 2020 2020 2020 6966 205f 6174 6f6d          if _atom
+00084890: 4964 206e 6f74 2069 6e20 6c65 6176 696e  Id not in leavin
+000848a0: 6741 746f 6d49 6473 3a0a 2020 2020 2020  gAtomIds:.      
 000848b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000848c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000848d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000848e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000848f0: 2e5f 5f63 522e 6765 7444 6963 744c 6973  .__cR.getDictLis
-00084900: 7457 6974 6846 696c 7465 7228 2761 746f  tWithFilter('ato
-00084910: 6d5f 7369 7465 272c 0a20 2020 2020 2020  m_site',.       
+000848e0: 2020 2020 2020 2020 2020 5f61 746f 6d49            _atomI
+000848f0: 6453 656c 6563 742e 6164 6428 5f61 746f  dSelect.add(_ato
+00084900: 6d49 6429 0a20 2020 2020 2020 2020 2020  mId).           
+00084910: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00084920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084970: 2020 2020 2043 4152 544e 5f44 4154 415f       CARTN_DATA_
-00084980: 4954 454d 532c 0a20 2020 2020 2020 2020  ITEMS,.         
+00084930: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00084940: 6363 625b 7365 6c66 2e5f 5f63 6355 2e63  ccb[self.__ccU.c
+00084950: 6362 4174 6f6d 4964 325d 2069 6e20 6c65  cbAtomId2] in le
+00084960: 6176 696e 6741 746f 6d49 6473 3a0a 2020  avingAtomIds:.  
+00084970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084980: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00084990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000849a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000849b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000849c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000849a0: 2020 2020 2020 2020 2020 5f61 746f 6d49            _atomI
+000849b0: 6420 3d20 6363 625b 7365 6c66 2e5f 5f63  d = ccb[self.__c
+000849c0: 6355 2e63 6362 4174 6f6d 4964 315d 0a20  cU.ccbAtomId1]. 
 000849d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000849e0: 2020 205b 7b27 6e61 6d65 273a 2073 656c     [{'name': sel
-000849f0: 662e 5f5f 6175 7468 4173 796d 4964 2c20  f.__authAsymId, 
-00084a00: 2774 7970 6527 3a20 2773 7472 272c 2027  'type': 'str', '
-00084a10: 7661 6c75 6527 3a20 6368 6169 6e49 647d  value': chainId}
-00084a20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000849e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000849f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084a00: 2020 2020 2020 2020 2020 2069 6620 5f61             if _a
+00084a10: 746f 6d49 6420 6e6f 7420 696e 206c 6561  tomId not in lea
+00084a20: 7669 6e67 4174 6f6d 4964 733a 0a20 2020  vingAtomIds:.   
 00084a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00084a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00084a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084a70: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-00084a80: 276e 616d 6527 3a20 7365 6c66 2e5f 5f61  'name': self.__a
-00084a90: 7574 6853 6571 4964 2c20 2774 7970 6527  uthSeqId, 'type'
-00084aa0: 3a20 2769 6e74 272c 2027 7661 6c75 6527  : 'int', 'value'
-00084ab0: 3a20 5f73 6571 4964 7d2c 0a20 2020 2020  : _seqId},.     
-00084ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084a60: 2020 2020 2020 2020 2020 2020 205f 6174               _at
+00084a70: 6f6d 4964 5365 6c65 6374 2e61 6464 285f  omIdSelect.add(_
+00084a80: 6174 6f6d 4964 290a 0a20 2020 2020 2020  atomId)..       
+00084a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084ab0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00084ac0: 205f 6174 6f6d 4964 2069 6e20 5f61 746f   _atomId in _ato
+00084ad0: 6d49 6453 656c 6563 743a 0a20 2020 2020  mIdSelect:.     
 00084ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00084af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00084b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084b10: 2020 2020 2020 2020 7b27 6e61 6d65 273a          {'name':
-00084b20: 2073 656c 662e 5f5f 6175 7468 4174 6f6d   self.__authAtom
-00084b30: 4964 2c20 2774 7970 6527 3a20 2773 7472  Id, 'type': 'str
-00084b40: 272c 2027 7661 6c75 6527 3a20 5f61 746f  ', 'value': _ato
-00084b50: 6d49 647d 2c0a 2020 2020 2020 2020 2020  mId},.          
-00084b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084b10: 2020 205f 6e65 6967 6862 6f72 203d 5c0a     _neighbor =\.
+00084b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084b50: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00084b60: 2e5f 5f63 522e 6765 7444 6963 744c 6973  .__cR.getDictLis
+00084b70: 7457 6974 6846 696c 7465 7228 2761 746f  tWithFilter('ato
+00084b80: 6d5f 7369 7465 272c 0a20 2020 2020 2020  m_site',.       
 00084b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00084ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084bb0: 2020 207b 276e 616d 6527 3a20 7365 6c66     {'name': self
-00084bc0: 2e5f 5f6d 6f64 656c 4e75 6d4e 616d 652c  .__modelNumName,
-00084bd0: 2027 7479 7065 273a 2027 696e 7427 2c0a   'type': 'int',.
-00084be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084be0: 2020 2020 2043 4152 544e 5f44 4154 415f       CARTN_DATA_
+00084bf0: 4954 454d 532c 0a20 2020 2020 2020 2020  ITEMS,.         
 00084c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00084c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00084c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084c30: 2020 2020 2020 2020 2020 2020 2020 2776                'v
-00084c40: 616c 7565 273a 2073 656c 662e 5f5f 7265  alue': self.__re
-00084c50: 7072 6573 656e 7461 7469 7665 4d6f 6465  presentativeMode
-00084c60: 6c49 647d 2c0a 2020 2020 2020 2020 2020  lId},.          
-00084c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084c50: 2020 205b 7b27 6e61 6d65 273a 2073 656c     [{'name': sel
+00084c60: 662e 5f5f 6175 7468 4173 796d 4964 2c20  f.__authAsymId, 
+00084c70: 2774 7970 6527 3a20 2773 7472 272c 2027  'type': 'str', '
+00084c80: 7661 6c75 6527 3a20 6368 6169 6e49 647d  value': chainId}
+00084c90: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
 00084ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00084cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084cc0: 2020 207b 276e 616d 6527 3a20 276c 6162     {'name': 'lab
-00084cd0: 656c 5f61 6c74 5f69 6427 2c20 2774 7970  el_alt_id', 'typ
-00084ce0: 6527 3a20 2765 6e75 6d27 2c0a 2020 2020  e': 'enum',.    
-00084cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084ce0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+00084cf0: 276e 616d 6527 3a20 7365 6c66 2e5f 5f61  'name': self.__a
+00084d00: 7574 6853 6571 4964 2c20 2774 7970 6527  uthSeqId, 'type'
+00084d10: 3a20 2769 6e74 272c 2027 7661 6c75 6527  : 'int', 'value'
+00084d20: 3a20 5f73 6571 4964 7d2c 0a20 2020 2020  : _seqId},.     
 00084d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084d40: 2020 2020 2020 2020 2020 2765 6e75 6d27            'enum'
-00084d50: 3a20 2827 4127 297d 0a20 2020 2020 2020  : ('A')}.       
+00084d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00084d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00084d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084db0: 2020 2020 2020 5d29 0a0a 2020 2020 2020        ])..      
-00084dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084d80: 2020 2020 2020 2020 7b27 6e61 6d65 273a          {'name':
+00084d90: 2073 656c 662e 5f5f 6175 7468 4174 6f6d   self.__authAtom
+00084da0: 4964 2c20 2774 7970 6527 3a20 2773 7472  Id, 'type': 'str
+00084db0: 272c 2027 7661 6c75 6527 3a20 5f61 746f  ', 'value': _ato
+00084dc0: 6d49 647d 2c0a 2020 2020 2020 2020 2020  mId},.          
 00084dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00084de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084df0: 2020 6966 206c 656e 285f 6e65 6967 6862    if len(_neighb
-00084e00: 6f72 2920 213d 2031 3a0a 2020 2020 2020  or) != 1:.      
+00084df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00084e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084e40: 2020 2020 2020 636f 6e74 696e 7565 0a0a        continue..
+00084e20: 2020 207b 276e 616d 6527 3a20 7365 6c66     {'name': self
+00084e30: 2e5f 5f6d 6f64 656c 4e75 6d4e 616d 652c  .__modelNumName,
+00084e40: 2027 7479 7065 273a 2027 696e 7427 2c0a   'type': 'int',.
 00084e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00084e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00084e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084e80: 2020 2020 2020 2020 6966 206e 756d 7079          if numpy
-00084e90: 2e6c 696e 616c 672e 6e6f 726d 2874 6f4e  .linalg.norm(toN
-00084ea0: 7041 7272 6179 285f 6e65 6967 6862 6f72  pArray(_neighbor
-00084eb0: 5b30 5d29 202d 206f 7269 6769 6e29 203c  [0]) - origin) <
-00084ec0: 2032 2e35 3a0a 2020 2020 2020 2020 2020   2.5:.          
-00084ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084ea0: 2020 2020 2020 2020 2020 2020 2020 2776                'v
+00084eb0: 616c 7565 273a 2073 656c 662e 5f5f 7265  alue': self.__re
+00084ec0: 7072 6573 656e 7461 7469 7665 4d6f 6465  presentativeMode
+00084ed0: 6c49 647d 2c0a 2020 2020 2020 2020 2020  lId},.          
 00084ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00084ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084f00: 2020 5f61 746f 6d53 656c 6563 7469 6f6e    _atomSelection
-00084f10: 2e61 7070 656e 6428 7b27 6368 6169 6e5f  .append({'chain_
-00084f20: 6964 273a 2063 6861 696e 4964 2c20 2773  id': chainId, 's
-00084f30: 6571 5f69 6427 3a20 5f73 6571 4964 2c20  eq_id': _seqId, 
-00084f40: 2763 6f6d 705f 6964 273a 205f 636f 6d70  'comp_id': _comp
-00084f50: 4964 2c20 2761 746f 6d5f 6964 273a 205f  Id, 'atom_id': _
-00084f60: 6174 6f6d 4964 7d29 0a0a 2020 2020 2020  atomId})..      
+00084f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084f30: 2020 207b 276e 616d 6527 3a20 276c 6162     {'name': 'lab
+00084f40: 656c 5f61 6c74 5f69 6427 2c20 2774 7970  el_alt_id', 'typ
+00084f50: 6527 3a20 2765 6e75 6d27 2c0a 2020 2020  e': 'enum',.    
+00084f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00084f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084f80: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00084f90: 2073 656c 662e 5f5f 6861 734e 6f6e 506f   self.__hasNonPo
-00084fa0: 6c79 5365 713a 0a20 2020 2020 2020 2020  lySeq:.         
-00084fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00084fc0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00084fd0: 704c 6973 7420 3d20 5b6e 7020 666f 7220  pList = [np for 
-00084fe0: 6e70 2069 6e20 7365 6c66 2e5f 5f6e 6f6e  np in self.__non
-00084ff0: 506f 6c79 5365 7120 6966 206e 705b 2761  PolySeq if np['a
-00085000: 7574 685f 6368 6169 6e5f 6964 275d 203d  uth_chain_id'] =
-00085010: 3d20 6368 6169 6e49 645d 0a20 2020 2020  = chainId].     
-00085020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084fb0: 2020 2020 2020 2020 2020 2765 6e75 6d27            'enum'
+00084fc0: 3a20 2827 4127 297d 0a20 2020 2020 2020  : ('A')}.       
+00084fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00084ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085020: 2020 2020 2020 5d29 0a0a 2020 2020 2020        ])..      
 00085030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085040: 2020 2066 6f72 206e 7020 696e 206e 704c     for np in npL
-00085050: 6973 743a 0a20 2020 2020 2020 2020 2020  ist:.           
-00085060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085080: 2066 6f72 205f 7365 7149 6420 696e 205b   for _seqId in [
-00085090: 7365 7149 6420 2d20 312c 2073 6571 4964  seqId - 1, seqId
-000850a0: 202b 2031 5d3a 0a20 2020 2020 2020 2020   + 1]:.         
-000850b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085060: 2020 6966 206c 656e 285f 6e65 6967 6862    if len(_neighb
+00085070: 6f72 2920 213d 2031 3a0a 2020 2020 2020  or) != 1:.      
+00085080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000850a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000850b0: 2020 2020 2020 636f 6e74 696e 7565 0a0a        continue..
 000850c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000850d0: 2020 2020 2020 2069 6620 5f73 6571 4964         if _seqId
-000850e0: 2069 6e20 6e70 5b27 6175 7468 5f73 6571   in np['auth_seq
-000850f0: 5f69 6427 5d3a 0a20 2020 2020 2020 2020  _id']:.         
-00085100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085120: 2020 2020 2020 2020 2020 205f 7365 7149             _seqI
-00085130: 6420 3d20 7365 6c66 2e67 6574 5265 616c  d = self.getReal
-00085140: 5365 7149 6428 6e70 2c20 5f73 6571 4964  SeqId(np, _seqId
-00085150: 2c20 4661 6c73 6529 0a20 2020 2020 2020  , False).       
+000850d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000850e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000850f0: 2020 2020 2020 2020 6966 206e 756d 7079          if numpy
+00085100: 2e6c 696e 616c 672e 6e6f 726d 2874 6f4e  .linalg.norm(toN
+00085110: 7041 7272 6179 285f 6e65 6967 6862 6f72  pArray(_neighbor
+00085120: 5b30 5d29 202d 206f 7269 6769 6e29 203c  [0]) - origin) <
+00085130: 2032 2e35 3a0a 2020 2020 2020 2020 2020   2.5:.          
+00085140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085150: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085180: 2020 2020 2020 2020 2020 2020 205f 636f               _co
-00085190: 6d70 4964 203d 206e 705b 2763 6f6d 705f  mpId = np['comp_
-000851a0: 6964 275d 5b6e 705b 2761 7574 685f 7365  id'][np['auth_se
-000851b0: 715f 6964 275d 2e69 6e64 6578 285f 7365  q_id'].index(_se
-000851c0: 7149 6429 5d0a 2020 2020 2020 2020 2020  qId)].          
-000851d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085170: 2020 5f61 746f 6d53 656c 6563 7469 6f6e    _atomSelection
+00085180: 2e61 7070 656e 6428 7b27 6368 6169 6e5f  .append({'chain_
+00085190: 6964 273a 2063 6861 696e 4964 2c20 2773  id': chainId, 's
+000851a0: 6571 5f69 6427 3a20 5f73 6571 4964 2c20  eq_id': _seqId, 
+000851b0: 2763 6f6d 705f 6964 273a 205f 636f 6d70  'comp_id': _comp
+000851c0: 4964 2c20 2761 746f 6d5f 6964 273a 205f  Id, 'atom_id': _
+000851d0: 6174 6f6d 4964 7d29 0a0a 2020 2020 2020  atomId})..      
 000851e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000851f0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00085200: 662e 5f5f 6363 552e 7570 6461 7465 4368  f.__ccU.updateCh
-00085210: 656d 436f 6d70 4469 6374 285f 636f 6d70  emCompDict(_comp
-00085220: 4964 293a 0a20 2020 2020 2020 2020 2020  Id):.           
-00085230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085250: 2020 2020 2020 2020 2020 2020 206c 6561               lea
-00085260: 7669 6e67 4174 6f6d 4964 7320 3d20 5b63  vingAtomIds = [c
-00085270: 6361 5b73 656c 662e 5f5f 6363 552e 6363  ca[self.__ccU.cc
-00085280: 6141 746f 6d49 645d 2066 6f72 2063 6361  aAtomId] for cca
-00085290: 2069 6e20 7365 6c66 2e5f 5f63 6355 2e6c   in self.__ccU.l
-000852a0: 6173 7441 746f 6d4c 6973 7420 6966 2063  astAtomList if c
-000852b0: 6361 5b73 656c 662e 5f5f 6363 552e 6363  ca[self.__ccU.cc
-000852c0: 614c 6561 7669 6e67 4174 6f6d 466c 6167  aLeavingAtomFlag
-000852d0: 5d20 3d3d 2027 5927 5d0a 0a20 2020 2020  ] == 'Y']..     
+000851f0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00085200: 2073 656c 662e 5f5f 6861 734e 6f6e 506f   self.__hasNonPo
+00085210: 6c79 5365 713a 0a20 2020 2020 2020 2020  lySeq:.         
+00085220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085230: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00085240: 704c 6973 7420 3d20 5b6e 7020 666f 7220  pList = [np for 
+00085250: 6e70 2069 6e20 7365 6c66 2e5f 5f6e 6f6e  np in self.__non
+00085260: 506f 6c79 5365 7120 6966 206e 705b 2761  PolySeq if np['a
+00085270: 7574 685f 6368 6169 6e5f 6964 275d 203d  uth_chain_id'] =
+00085280: 3d20 6368 6169 6e49 645d 0a20 2020 2020  = chainId].     
+00085290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000852a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000852b0: 2020 2066 6f72 206e 7020 696e 206e 704c     for np in npL
+000852c0: 6973 743a 0a20 2020 2020 2020 2020 2020  ist:.           
+000852d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000852e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000852f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085310: 2020 205f 6174 6f6d 4964 5365 6c65 6374     _atomIdSelect
-00085320: 203d 2073 6574 2829 0a20 2020 2020 2020   = set().       
+000852f0: 2066 6f72 205f 7365 7149 6420 696e 205b   for _seqId in [
+00085300: 7365 7149 6420 2d20 312c 2073 6571 4964  seqId - 1, seqId
+00085310: 202b 2031 5d3a 0a20 2020 2020 2020 2020   + 1]:.         
+00085320: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085360: 2066 6f72 2063 6362 2069 6e20 7365 6c66   for ccb in self
-00085370: 2e5f 5f63 6355 2e6c 6173 7442 6f6e 6473  .__ccU.lastBonds
-00085380: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00085390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000853a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000853b0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000853c0: 2063 6362 5b73 656c 662e 5f5f 6363 552e   ccb[self.__ccU.
-000853d0: 6363 6241 746f 6d49 6431 5d20 696e 206c  ccbAtomId1] in l
-000853e0: 6561 7669 6e67 4174 6f6d 4964 733a 0a20  eavingAtomIds:. 
-000853f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085420: 2020 2020 2020 2020 2020 2020 2020 205f                 _
-00085430: 6174 6f6d 4964 203d 2063 6362 5b73 656c  atomId = ccb[sel
-00085440: 662e 5f5f 6363 552e 6363 6241 746f 6d49  f.__ccU.ccbAtomI
-00085450: 6432 5d0a 2020 2020 2020 2020 2020 2020  d2].            
-00085460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085490: 2020 2020 6966 205f 6174 6f6d 4964 206e      if _atomId n
-000854a0: 6f74 2069 6e20 6c65 6176 696e 6741 746f  ot in leavingAto
-000854b0: 6d49 6473 3a0a 2020 2020 2020 2020 2020  mIds:.          
-000854c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000854d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000854e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000854f0: 2020 2020 2020 2020 2020 5f61 746f 6d49            _atomI
-00085500: 6453 656c 6563 742e 6164 6428 5f61 746f  dSelect.add(_ato
-00085510: 6d49 6429 0a20 2020 2020 2020 2020 2020  mId).           
-00085520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085550: 2069 6620 6363 625b 7365 6c66 2e5f 5f63   if ccb[self.__c
-00085560: 6355 2e63 6362 4174 6f6d 4964 325d 2069  cU.ccbAtomId2] i
-00085570: 6e20 6c65 6176 696e 6741 746f 6d49 6473  n leavingAtomIds
-00085580: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00085590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085340: 2020 2020 2020 2069 6620 5f73 6571 4964         if _seqId
+00085350: 2069 6e20 6e70 5b27 6175 7468 5f73 6571   in np['auth_seq
+00085360: 5f69 6427 5d3a 0a20 2020 2020 2020 2020  _id']:.         
+00085370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085390: 2020 2020 2020 2020 2020 205f 7365 7149             _seqI
+000853a0: 6420 3d20 7365 6c66 2e67 6574 5265 616c  d = self.getReal
+000853b0: 5365 7149 6428 6e70 2c20 5f73 6571 4964  SeqId(np, _seqId
+000853c0: 2c20 4661 6c73 6529 0a20 2020 2020 2020  , False).       
+000853d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000853e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000853f0: 2020 2020 2020 2020 2020 2020 205f 636f               _co
+00085400: 6d70 4964 203d 206e 705b 2763 6f6d 705f  mpId = np['comp_
+00085410: 6964 275d 5b6e 705b 2761 7574 685f 7365  id'][np['auth_se
+00085420: 715f 6964 275d 2e69 6e64 6578 285f 7365  q_id'].index(_se
+00085430: 7149 6429 5d0a 2020 2020 2020 2020 2020  qId)].          
+00085440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085460: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00085470: 662e 5f5f 6363 552e 7570 6461 7465 4368  f.__ccU.updateCh
+00085480: 656d 436f 6d70 4469 6374 285f 636f 6d70  emCompDict(_comp
+00085490: 4964 293a 0a20 2020 2020 2020 2020 2020  Id):.           
+000854a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000854b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000854c0: 2020 2020 2020 2020 2020 2020 206c 6561               lea
+000854d0: 7669 6e67 4174 6f6d 4964 7320 3d20 5b63  vingAtomIds = [c
+000854e0: 6361 5b73 656c 662e 5f5f 6363 552e 6363  ca[self.__ccU.cc
+000854f0: 6141 746f 6d49 645d 2066 6f72 2063 6361  aAtomId] for cca
+00085500: 2069 6e20 7365 6c66 2e5f 5f63 6355 2e6c   in self.__ccU.l
+00085510: 6173 7441 746f 6d4c 6973 7420 6966 2063  astAtomList if c
+00085520: 6361 5b73 656c 662e 5f5f 6363 552e 6363  ca[self.__ccU.cc
+00085530: 614c 6561 7669 6e67 4174 6f6d 466c 6167  aLeavingAtomFlag
+00085540: 5d20 3d3d 2027 5927 5d0a 0a20 2020 2020  ] == 'Y']..     
+00085550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085580: 2020 205f 6174 6f6d 4964 5365 6c65 6374     _atomIdSelect
+00085590: 203d 2073 6574 2829 0a20 2020 2020 2020   = set().       
 000855a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000855b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000855c0: 2020 5f61 746f 6d49 6420 3d20 6363 625b    _atomId = ccb[
-000855d0: 7365 6c66 2e5f 5f63 6355 2e63 6362 4174  self.__ccU.ccbAt
-000855e0: 6f6d 4964 315d 0a20 2020 2020 2020 2020  omId1].         
-000855f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000855c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000855d0: 2066 6f72 2063 6362 2069 6e20 7365 6c66   for ccb in self
+000855e0: 2e5f 5f63 6355 2e6c 6173 7442 6f6e 6473  .__ccU.lastBonds
+000855f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
 00085600: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085620: 2020 2020 2020 2069 6620 5f61 746f 6d49         if _atomI
-00085630: 6420 6e6f 7420 696e 206c 6561 7669 6e67  d not in leaving
-00085640: 4174 6f6d 4964 733a 0a20 2020 2020 2020  AtomIds:.       
-00085650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085620: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00085630: 2063 6362 5b73 656c 662e 5f5f 6363 552e   ccb[self.__ccU.
+00085640: 6363 6241 746f 6d49 6431 5d20 696e 206c  ccbAtomId1] in l
+00085650: 6561 7669 6e67 4174 6f6d 4964 733a 0a20  eavingAtomIds:. 
 00085660: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085680: 2020 2020 2020 2020 2020 2020 205f 6174               _at
-00085690: 6f6d 4964 5365 6c65 6374 2e61 6464 285f  omIdSelect.add(_
-000856a0: 6174 6f6d 4964 290a 0a20 2020 2020 2020  atomId)..       
-000856b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000856c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085690: 2020 2020 2020 2020 2020 2020 2020 205f                 _
+000856a0: 6174 6f6d 4964 203d 2063 6362 5b73 656c  atomId = ccb[sel
+000856b0: 662e 5f5f 6363 552e 6363 6241 746f 6d49  f.__ccU.ccbAtomI
+000856c0: 6432 5d0a 2020 2020 2020 2020 2020 2020  d2].            
 000856d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000856e0: 2066 6f72 205f 6174 6f6d 4964 2069 6e20   for _atomId in 
-000856f0: 5f61 746f 6d49 6453 656c 6563 743a 0a20  _atomIdSelect:. 
-00085700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085730: 2020 2020 2020 2020 2020 205f 6e65 6967             _neig
-00085740: 6862 6f72 203d 5c0a 2020 2020 2020 2020  hbor =\.        
+000856e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000856f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085700: 2020 2020 6966 205f 6174 6f6d 4964 206e      if _atomId n
+00085710: 6f74 2069 6e20 6c65 6176 696e 6741 746f  ot in leavingAto
+00085720: 6d49 6473 3a0a 2020 2020 2020 2020 2020  mIds:.          
+00085730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085740: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085780: 2020 2020 2020 2020 7365 6c66 2e5f 5f63          self.__c
-00085790: 522e 6765 7444 6963 744c 6973 7457 6974  R.getDictListWit
-000857a0: 6846 696c 7465 7228 2761 746f 6d5f 7369  hFilter('atom_si
-000857b0: 7465 272c 0a20 2020 2020 2020 2020 2020  te',.           
-000857c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000857d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000857e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000857f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085760: 2020 2020 2020 2020 2020 5f61 746f 6d49            _atomI
+00085770: 6453 656c 6563 742e 6164 6428 5f61 746f  dSelect.add(_ato
+00085780: 6d49 6429 0a20 2020 2020 2020 2020 2020  mId).           
+00085790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000857a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000857b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000857c0: 2069 6620 6363 625b 7365 6c66 2e5f 5f63   if ccb[self.__c
+000857d0: 6355 2e63 6362 4174 6f6d 4964 325d 2069  cU.ccbAtomId2] i
+000857e0: 6e20 6c65 6176 696e 6741 746f 6d49 6473  n leavingAtomIds
+000857f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
 00085800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085810: 2020 2020 2043 4152 544e 5f44 4154 415f       CARTN_DATA_
-00085820: 4954 454d 532c 0a20 2020 2020 2020 2020  ITEMS,.         
-00085830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085830: 2020 5f61 746f 6d49 6420 3d20 6363 625b    _atomId = ccb[
+00085840: 7365 6c66 2e5f 5f63 6355 2e63 6362 4174  self.__ccU.ccbAt
+00085850: 6f6d 4964 315d 0a20 2020 2020 2020 2020  omId1].         
 00085860: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085880: 2020 2020 2020 205b 7b27 6e61 6d65 273a         [{'name':
-00085890: 2073 656c 662e 5f5f 6175 7468 4173 796d   self.__authAsym
-000858a0: 4964 2c20 2774 7970 6527 3a20 2773 7472  Id, 'type': 'str
-000858b0: 272c 2027 7661 6c75 6527 3a20 6368 6169  ', 'value': chai
-000858c0: 6e49 647d 2c0a 2020 2020 2020 2020 2020  nId},.          
+00085880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085890: 2020 2020 2020 2069 6620 5f61 746f 6d49         if _atomI
+000858a0: 6420 6e6f 7420 696e 206c 6561 7669 6e67  d not in leaving
+000858b0: 4174 6f6d 4964 733a 0a20 2020 2020 2020  AtomIds:.       
+000858c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000858d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000858e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000858f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085920: 2020 2020 2020 207b 276e 616d 6527 3a20         {'name': 
-00085930: 7365 6c66 2e5f 5f61 7574 6853 6571 4964  self.__authSeqId
-00085940: 2c20 2774 7970 6527 3a20 2769 6e74 272c  , 'type': 'int',
-00085950: 2027 7661 6c75 6527 3a20 5f73 6571 4964   'value': _seqId
-00085960: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
+000858f0: 2020 2020 2020 2020 2020 2020 205f 6174               _at
+00085900: 6f6d 4964 5365 6c65 6374 2e61 6464 285f  omIdSelect.add(_
+00085910: 6174 6f6d 4964 290a 0a20 2020 2020 2020  atomId)..       
+00085920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085950: 2066 6f72 205f 6174 6f6d 4964 2069 6e20   for _atomId in 
+00085960: 5f61 746f 6d49 6453 656c 6563 743a 0a20  _atomIdSelect:. 
 00085970: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085980: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000859a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000859b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000859c0: 2020 2020 7b27 6e61 6d65 273a 2073 656c      {'name': sel
-000859d0: 662e 5f5f 6175 7468 4174 6f6d 4964 2c20  f.__authAtomId, 
-000859e0: 2774 7970 6527 3a20 2773 7472 272c 2027  'type': 'str', '
-000859f0: 7661 6c75 6527 3a20 5f61 746f 6d49 647d  value': _atomId}
-00085a00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00085a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000859a0: 2020 2020 2020 2020 2020 205f 6e65 6967             _neig
+000859b0: 6862 6f72 203d 5c0a 2020 2020 2020 2020  hbor =\.        
+000859c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000859d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000859e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000859f0: 2020 2020 2020 2020 7365 6c66 2e5f 5f63          self.__c
+00085a00: 522e 6765 7444 6963 744c 6973 7457 6974  R.getDictListWit
+00085a10: 6846 696c 7465 7228 2761 746f 6d5f 7369  hFilter('atom_si
+00085a20: 7465 272c 0a20 2020 2020 2020 2020 2020  te',.           
 00085a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085a60: 2020 207b 276e 616d 6527 3a20 7365 6c66     {'name': self
-00085a70: 2e5f 5f6d 6f64 656c 4e75 6d4e 616d 652c  .__modelNumName,
-00085a80: 2027 7479 7065 273a 2027 696e 7427 2c0a   'type': 'int',.
-00085a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085a80: 2020 2020 2043 4152 544e 5f44 4154 415f       CARTN_DATA_
+00085a90: 4954 454d 532c 0a20 2020 2020 2020 2020  ITEMS,.         
 00085aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085af0: 2020 2776 616c 7565 273a 2073 656c 662e    'value': self.
-00085b00: 5f5f 7265 7072 6573 656e 7461 7469 7665  __representative
-00085b10: 4d6f 6465 6c49 647d 2c0a 2020 2020 2020  ModelId},.      
-00085b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085af0: 2020 2020 2020 205b 7b27 6e61 6d65 273a         [{'name':
+00085b00: 2073 656c 662e 5f5f 6175 7468 4173 796d   self.__authAsym
+00085b10: 4964 2c20 2774 7970 6527 3a20 2773 7472  Id, 'type': 'str
+00085b20: 272c 2027 7661 6c75 6527 3a20 6368 6169  ', 'value': chai
+00085b30: 6e49 647d 2c0a 2020 2020 2020 2020 2020  nId},.          
 00085b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085b70: 2020 2020 2020 2020 2020 207b 276e 616d             {'nam
-00085b80: 6527 3a20 276c 6162 656c 5f61 6c74 5f69  e': 'label_alt_i
-00085b90: 6427 2c20 2774 7970 6527 3a20 2765 6e75  d', 'type': 'enu
-00085ba0: 6d27 2c0a 2020 2020 2020 2020 2020 2020  m',.            
-00085bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085b90: 2020 2020 2020 207b 276e 616d 6527 3a20         {'name': 
+00085ba0: 7365 6c66 2e5f 5f61 7574 6853 6571 4964  self.__authSeqId
+00085bb0: 2c20 2774 7970 6527 3a20 2769 6e74 272c  , 'type': 'int',
+00085bc0: 2027 7661 6c75 6527 3a20 5f73 6571 4964   'value': _seqId
+00085bd0: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
 00085be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085c00: 2020 2020 2020 2765 6e75 6d27 3a20 2827        'enum': ('
-00085c10: 4127 297d 0a20 2020 2020 2020 2020 2020  A')}.           
+00085c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085c70: 2020 2020 2020 5d29 0a0a 2020 2020 2020        ])..      
+00085c30: 2020 2020 7b27 6e61 6d65 273a 2073 656c      {'name': sel
+00085c40: 662e 5f5f 6175 7468 4174 6f6d 4964 2c20  f.__authAtomId, 
+00085c50: 2774 7970 6527 3a20 2773 7472 272c 2027  'type': 'str', '
+00085c60: 7661 6c75 6527 3a20 5f61 746f 6d49 647d  value': _atomId}
+00085c70: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
 00085c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085cb0: 2020 2020 2020 6966 206c 656e 285f 6e65        if len(_ne
-00085cc0: 6967 6862 6f72 2920 213d 2031 3a0a 2020  ighbor) != 1:.  
-00085cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085d00: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00085d10: 6e74 696e 7565 0a0a 2020 2020 2020 2020  ntinue..        
+00085cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085cd0: 2020 207b 276e 616d 6527 3a20 7365 6c66     {'name': self
+00085ce0: 2e5f 5f6d 6f64 656c 4e75 6d4e 616d 652c  .__modelNumName,
+00085cf0: 2027 7479 7065 273a 2027 696e 7427 2c0a   'type': 'int',.
+00085d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085d50: 2020 2020 6966 206e 756d 7079 2e6c 696e      if numpy.lin
-00085d60: 616c 672e 6e6f 726d 2874 6f4e 7041 7272  alg.norm(toNpArr
-00085d70: 6179 285f 6e65 6967 6862 6f72 5b30 5d29  ay(_neighbor[0])
-00085d80: 202d 206f 7269 6769 6e29 203c 2032 2e35   - origin) < 2.5
-00085d90: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00085d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085d60: 2020 2776 616c 7565 273a 2073 656c 662e    'value': self.
+00085d70: 5f5f 7265 7072 6573 656e 7461 7469 7665  __representative
+00085d80: 4d6f 6465 6c49 647d 2c0a 2020 2020 2020  ModelId},.      
+00085d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085dd0: 2020 5f61 746f 6d53 656c 6563 7469 6f6e    _atomSelection
-00085de0: 2e61 7070 656e 6428 7b27 6368 6169 6e5f  .append({'chain_
-00085df0: 6964 273a 2063 6861 696e 4964 2c20 2773  id': chainId, 's
-00085e00: 6571 5f69 6427 3a20 5f73 6571 4964 2c20  eq_id': _seqId, 
-00085e10: 2763 6f6d 705f 6964 273a 205f 636f 6d70  'comp_id': _comp
-00085e20: 4964 2c20 2761 746f 6d5f 6964 273a 205f  Id, 'atom_id': _
-00085e30: 6174 6f6d 4964 7d29 0a0a 2020 2020 2020  atomId})..      
+00085dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085de0: 2020 2020 2020 2020 2020 207b 276e 616d             {'nam
+00085df0: 6527 3a20 276c 6162 656c 5f61 6c74 5f69  e': 'label_alt_i
+00085e00: 6427 2c20 2774 7970 6527 3a20 2765 6e75  d', 'type': 'enu
+00085e10: 6d27 2c0a 2020 2020 2020 2020 2020 2020  m',.            
+00085e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085e50: 2020 2320 7374 7275 6374 5f63 6f6e 6e20    # struct_conn 
-00085e60: 6361 7465 676f 7279 0a20 2020 2020 2020  category.       
-00085e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085e80: 205f 6174 6f6d 203d 2073 656c 662e 5f5f   _atom = self.__
-00085e90: 6352 2e67 6574 4469 6374 4c69 7374 5769  cR.getDictListWi
-00085ea0: 7468 4669 6c74 6572 2827 7374 7275 6374  thFilter('struct
-00085eb0: 5f63 6f6e 6e27 2c0a 2020 2020 2020 2020  _conn',.        
+00085e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085e70: 2020 2020 2020 2765 6e75 6d27 3a20 2827        'enum': ('
+00085e80: 4127 297d 0a20 2020 2020 2020 2020 2020  A')}.           
+00085e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085ef0: 2020 2020 2020 2020 5054 4e52 315f 4155          PTNR1_AU
-00085f00: 5448 5f41 544f 4d5f 4441 5441 5f49 5445  TH_ATOM_DATA_ITE
-00085f10: 4d53 2c0a 2020 2020 2020 2020 2020 2020  MS,.            
-00085f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085ee0: 2020 2020 2020 5d29 0a0a 2020 2020 2020        ])..      
+00085ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085f20: 2020 2020 2020 6966 206c 656e 285f 6e65        if len(_ne
+00085f30: 6967 6862 6f72 2920 213d 2031 3a0a 2020  ighbor) != 1:.  
 00085f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085f50: 2020 2020 5b7b 276e 616d 6527 3a20 2770      [{'name': 'p
-00085f60: 746e 7232 5f61 7574 685f 6173 796d 5f69  tnr2_auth_asym_i
-00085f70: 6427 2c20 2774 7970 6527 3a20 2773 7472  d', 'type': 'str
-00085f80: 272c 2027 7661 6c75 6527 3a20 6368 6169  ', 'value': chai
-00085f90: 6e49 647d 2c0a 2020 2020 2020 2020 2020  nId},.          
+00085f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00085f70: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00085f80: 6e74 696e 7565 0a0a 2020 2020 2020 2020  ntinue..        
+00085f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00085fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00085fd0: 2020 2020 2020 207b 276e 616d 6527 3a20         {'name': 
-00085fe0: 2770 746e 7232 5f61 7574 685f 7365 715f  'ptnr2_auth_seq_
-00085ff0: 6964 272c 2027 7479 7065 273a 2027 696e  id', 'type': 'in
-00086000: 7427 2c20 2776 616c 7565 273a 2073 6571  t', 'value': seq
-00086010: 4964 7d2c 0a20 2020 2020 2020 2020 2020  Id},.           
+00085fc0: 2020 2020 6966 206e 756d 7079 2e6c 696e      if numpy.lin
+00085fd0: 616c 672e 6e6f 726d 2874 6f4e 7041 7272  alg.norm(toNpArr
+00085fe0: 6179 285f 6e65 6967 6862 6f72 5b30 5d29  ay(_neighbor[0])
+00085ff0: 202d 206f 7269 6769 6e29 203c 2032 2e35   - origin) < 2.5
+00086000: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00086010: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00086020: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00086030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086050: 2020 2020 2020 7b27 6e61 6d65 273a 2027        {'name': '
-00086060: 7074 6e72 325f 6c61 6265 6c5f 6174 6f6d  ptnr2_label_atom
-00086070: 5f69 6427 2c20 2774 7970 6527 3a20 2773  _id', 'type': 's
-00086080: 7472 272c 2027 7661 6c75 6527 3a20 6174  tr', 'value': at
-00086090: 6f6d 4964 7d2c 0a20 2020 2020 2020 2020  omId},.         
-000860a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086040: 2020 5f61 746f 6d53 656c 6563 7469 6f6e    _atomSelection
+00086050: 2e61 7070 656e 6428 7b27 6368 6169 6e5f  .append({'chain_
+00086060: 6964 273a 2063 6861 696e 4964 2c20 2773  id': chainId, 's
+00086070: 6571 5f69 6427 3a20 5f73 6571 4964 2c20  eq_id': _seqId, 
+00086080: 2763 6f6d 705f 6964 273a 205f 636f 6d70  'comp_id': _comp
+00086090: 4964 2c20 2761 746f 6d5f 6964 273a 205f  Id, 'atom_id': _
+000860a0: 6174 6f6d 4964 7d29 0a0a 2020 2020 2020  atomId})..      
 000860b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000860c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000860d0: 2020 2020 2020 2020 7b27 6e61 6d65 273a          {'name':
-000860e0: 2073 656c 662e 5f5f 6d6f 6465 6c4e 756d   self.__modelNum
-000860f0: 4e61 6d65 2c20 2774 7970 6527 3a20 2769  Name, 'type': 'i
-00086100: 6e74 272c 0a20 2020 2020 2020 2020 2020  nt',.           
-00086110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000860c0: 2020 2320 7374 7275 6374 5f63 6f6e 6e20    # struct_conn 
+000860d0: 6361 7465 676f 7279 0a20 2020 2020 2020  category.       
+000860e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000860f0: 205f 6174 6f6d 203d 2073 656c 662e 5f5f   _atom = self.__
+00086100: 6352 2e67 6574 4469 6374 4c69 7374 5769  cR.getDictListWi
+00086110: 7468 4669 6c74 6572 2827 7374 7275 6374  thFilter('struct
+00086120: 5f63 6f6e 6e27 2c0a 2020 2020 2020 2020  _conn',.        
 00086130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086140: 2020 2020 2020 2027 7661 6c75 6527 3a20         'value': 
-00086150: 7365 6c66 2e5f 5f72 6570 7265 7365 6e74  self.__represent
-00086160: 6174 6976 654d 6f64 656c 4964 7d0a 2020  ativeModelId}.  
-00086170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086160: 2020 2020 2020 2020 5054 4e52 315f 4155          PTNR1_AU
+00086170: 5448 5f41 544f 4d5f 4441 5441 5f49 5445  TH_ATOM_DATA_ITE
+00086180: 4d53 2c0a 2020 2020 2020 2020 2020 2020  MS,.            
 00086190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000861a0: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-000861b0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-000861c0: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-000861d0: 6e28 5f61 746f 6d29 203d 3d20 313a 0a20  n(_atom) == 1:. 
-000861e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000861f0: 2020 2020 2020 2020 2020 205f 6174 6f6d             _atom
-00086200: 5365 6c65 6374 696f 6e2e 6170 7065 6e64  Selection.append
-00086210: 285f 6174 6f6d 5b30 5d29 0a0a 2020 2020  (_atom[0])..    
+000861a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000861b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000861c0: 2020 2020 5b7b 276e 616d 6527 3a20 2770      [{'name': 'p
+000861d0: 746e 7232 5f61 7574 685f 6173 796d 5f69  tnr2_auth_asym_i
+000861e0: 6427 2c20 2774 7970 6527 3a20 2773 7472  d', 'type': 'str
+000861f0: 272c 2027 7661 6c75 6527 3a20 6368 6169  ', 'value': chai
+00086200: 6e49 647d 2c0a 2020 2020 2020 2020 2020  nId},.          
+00086210: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00086220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086230: 2020 2020 5f61 746f 6d20 3d20 7365 6c66      _atom = self
-00086240: 2e5f 5f63 522e 6765 7444 6963 744c 6973  .__cR.getDictLis
-00086250: 7457 6974 6846 696c 7465 7228 2773 7472  tWithFilter('str
-00086260: 7563 745f 636f 6e6e 272c 0a20 2020 2020  uct_conn',.     
-00086270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086240: 2020 2020 2020 207b 276e 616d 6527 3a20         {'name': 
+00086250: 2770 746e 7232 5f61 7574 685f 7365 715f  'ptnr2_auth_seq_
+00086260: 6964 272c 2027 7479 7065 273a 2027 696e  id', 'type': 'in
+00086270: 7427 2c20 2776 616c 7565 273a 2073 6571  t', 'value': seq
+00086280: 4964 7d2c 0a20 2020 2020 2020 2020 2020  Id},.           
 00086290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000862a0: 2020 2020 2020 2020 2020 2050 544e 5232             PTNR2
-000862b0: 5f41 5554 485f 4154 4f4d 5f44 4154 415f  _AUTH_ATOM_DATA_
-000862c0: 4954 454d 532c 0a20 2020 2020 2020 2020  ITEMS,.         
-000862d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000862e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000862f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086300: 2020 2020 2020 205b 7b27 6e61 6d65 273a         [{'name':
-00086310: 2027 7074 6e72 315f 6175 7468 5f61 7379   'ptnr1_auth_asy
-00086320: 6d5f 6964 272c 2027 7479 7065 273a 2027  m_id', 'type': '
-00086330: 7374 7227 2c20 2776 616c 7565 273a 2063  str', 'value': c
-00086340: 6861 696e 4964 7d2c 0a20 2020 2020 2020  hainId},.       
-00086350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086380: 2020 2020 2020 2020 2020 7b27 6e61 6d65            {'name
-00086390: 273a 2027 7074 6e72 315f 6175 7468 5f73  ': 'ptnr1_auth_s
-000863a0: 6571 5f69 6427 2c20 2774 7970 6527 3a20  eq_id', 'type': 
-000863b0: 2769 6e74 272c 2027 7661 6c75 6527 3a20  'int', 'value': 
-000863c0: 7365 7149 647d 2c0a 2020 2020 2020 2020  seqId},.        
-000863d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000862a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000862b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000862c0: 2020 2020 2020 7b27 6e61 6d65 273a 2027        {'name': '
+000862d0: 7074 6e72 325f 6c61 6265 6c5f 6174 6f6d  ptnr2_label_atom
+000862e0: 5f69 6427 2c20 2774 7970 6527 3a20 2773  _id', 'type': 's
+000862f0: 7472 272c 2027 7661 6c75 6527 3a20 6174  tr', 'value': at
+00086300: 6f6d 4964 7d2c 0a20 2020 2020 2020 2020  omId},.         
+00086310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086340: 2020 2020 2020 2020 7b27 6e61 6d65 273a          {'name':
+00086350: 2073 656c 662e 5f5f 6d6f 6465 6c4e 756d   self.__modelNum
+00086360: 4e61 6d65 2c20 2774 7970 6527 3a20 2769  Name, 'type': 'i
+00086370: 6e74 272c 0a20 2020 2020 2020 2020 2020  nt',.           
+00086380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000863a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000863b0: 2020 2020 2020 2027 7661 6c75 6527 3a20         'value': 
+000863c0: 7365 6c66 2e5f 5f72 6570 7265 7365 6e74  self.__represent
+000863d0: 6174 6976 654d 6f64 656c 4964 7d0a 2020  ativeModelId}.  
 000863e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000863f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086400: 2020 2020 2020 2020 207b 276e 616d 6527           {'name'
-00086410: 3a20 2770 746e 7231 5f6c 6162 656c 5f61  : 'ptnr1_label_a
-00086420: 746f 6d5f 6964 272c 2027 7479 7065 273a  tom_id', 'type':
-00086430: 2027 7374 7227 2c20 2776 616c 7565 273a   'str', 'value':
-00086440: 2061 746f 6d49 647d 2c0a 2020 2020 2020   atomId},.      
+00086400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086410: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
+00086420: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+00086430: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+00086440: 6e28 5f61 746f 6d29 203d 3d20 313a 0a20  n(_atom) == 1:. 
 00086450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086480: 2020 2020 2020 2020 2020 207b 276e 616d             {'nam
-00086490: 6527 3a20 7365 6c66 2e5f 5f6d 6f64 656c  e': self.__model
-000864a0: 4e75 6d4e 616d 652c 2027 7479 7065 273a  NumName, 'type':
-000864b0: 2027 696e 7427 2c0a 2020 2020 2020 2020   'int',.        
-000864c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000864d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086460: 2020 2020 2020 2020 2020 205f 6174 6f6d             _atom
+00086470: 5365 6c65 6374 696f 6e2e 6170 7065 6e64  Selection.append
+00086480: 285f 6174 6f6d 5b30 5d29 0a0a 2020 2020  (_atom[0])..    
+00086490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000864a0: 2020 2020 5f61 746f 6d20 3d20 7365 6c66      _atom = self
+000864b0: 2e5f 5f63 522e 6765 7444 6963 744c 6973  .__cR.getDictLis
+000864c0: 7457 6974 6846 696c 7465 7228 2773 7472  tWithFilter('str
+000864d0: 7563 745f 636f 6e6e 272c 0a20 2020 2020  uct_conn',.     
 000864e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000864f0: 2020 2020 2020 2020 2020 2776 616c 7565            'value
-00086500: 273a 2073 656c 662e 5f5f 7265 7072 6573  ': self.__repres
-00086510: 656e 7461 7469 7665 4d6f 6465 6c49 647d  entativeModelId}
-00086520: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00086530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000864f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086510: 2020 2020 2020 2020 2020 2050 544e 5232             PTNR2
+00086520: 5f41 5554 485f 4154 4f4d 5f44 4154 415f  _AUTH_ATOM_DATA_
+00086530: 4954 454d 532c 0a20 2020 2020 2020 2020  ITEMS,.         
 00086540: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00086550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086560: 2020 5d29 0a0a 2020 2020 2020 2020 2020    ])..          
-00086570: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00086580: 206c 656e 285f 6174 6f6d 2920 3d3d 2031   len(_atom) == 1
-00086590: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000865a0: 2020 2020 2020 2020 2020 2020 2020 5f61                _a
-000865b0: 746f 6d53 656c 6563 7469 6f6e 2e61 7070  tomSelection.app
-000865c0: 656e 6428 5f61 746f 6d5b 305d 290a 0a20  end(_atom[0]).. 
+00086560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086570: 2020 2020 2020 205b 7b27 6e61 6d65 273a         [{'name':
+00086580: 2027 7074 6e72 315f 6175 7468 5f61 7379   'ptnr1_auth_asy
+00086590: 6d5f 6964 272c 2027 7479 7065 273a 2027  m_id', 'type': '
+000865a0: 7374 7227 2c20 2776 616c 7565 273a 2063  str', 'value': c
+000865b0: 6861 696e 4964 7d2c 0a20 2020 2020 2020  hainId},.       
+000865c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000865d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000865e0: 2020 2073 656c 662e 6661 6374 6f72 5b27     self.factor['
-000865f0: 6174 6f6d 5f73 656c 6563 7469 6f6e 275d  atom_selection']
-00086600: 203d 205b 6469 6374 2873 2920 666f 7220   = [dict(s) for 
-00086610: 7320 696e 2073 6574 2866 726f 7a65 6e73  s in set(frozens
-00086620: 6574 2861 746f 6d2e 6974 656d 7328 2929  et(atom.items())
-00086630: 2066 6f72 2061 746f 6d20 696e 205f 6174   for atom in _at
-00086640: 6f6d 5365 6c65 6374 696f 6e29 5d0a 0a20  omSelection)].. 
+000865e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000865f0: 2020 2020 2020 2020 2020 7b27 6e61 6d65            {'name
+00086600: 273a 2027 7074 6e72 315f 6175 7468 5f73  ': 'ptnr1_auth_s
+00086610: 6571 5f69 6427 2c20 2774 7970 6527 3a20  eq_id', 'type': 
+00086620: 2769 6e74 272c 2027 7661 6c75 6527 3a20  'int', 'value': 
+00086630: 7365 7149 647d 2c0a 2020 2020 2020 2020  seqId},.        
+00086640: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00086650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086660: 2020 2069 6620 6c65 6e28 7365 6c66 2e66     if len(self.f
-00086670: 6163 746f 725b 2761 746f 6d5f 7365 6c65  actor['atom_sele
-00086680: 6374 696f 6e27 5d29 203d 3d20 303a 0a20  ction']) == 0:. 
-00086690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000866a0: 2020 2020 2020 2073 656c 662e 6661 6374         self.fact
-000866b0: 6f72 5b27 6174 6f6d 5f69 6427 5d20 3d20  or['atom_id'] = 
-000866c0: 5b4e 6f6e 655d 0a20 2020 2020 2020 2020  [None].         
-000866d0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000866e0: 656c 662e 5f5f 662e 6170 7065 6e64 2866  elf.__f.append(f
-000866f0: 225b 496e 7375 6666 6963 6965 6e74 2061  "[Insufficient a
-00086700: 746f 6d20 7365 6c65 6374 696f 6e5d 207b  tom selection] {
-00086710: 7365 6c66 2e5f 5f67 6574 4375 7272 656e  self.__getCurren
-00086720: 7452 6573 7472 6169 6e74 2829 7d22 0a20  tRestraint()}". 
+00086660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086670: 2020 2020 2020 2020 207b 276e 616d 6527           {'name'
+00086680: 3a20 2770 746e 7231 5f6c 6162 656c 5f61  : 'ptnr1_label_a
+00086690: 746f 6d5f 6964 272c 2027 7479 7065 273a  tom_id', 'type':
+000866a0: 2027 7374 7227 2c20 2776 616c 7565 273a   'str', 'value':
+000866b0: 2061 746f 6d49 647d 2c0a 2020 2020 2020   atomId},.      
+000866c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000866d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000866e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000866f0: 2020 2020 2020 2020 2020 207b 276e 616d             {'nam
+00086700: 6527 3a20 7365 6c66 2e5f 5f6d 6f64 656c  e': self.__model
+00086710: 4e75 6d4e 616d 652c 2027 7479 7065 273a  NumName, 'type':
+00086720: 2027 696e 7427 2c0a 2020 2020 2020 2020   'int',.        
 00086730: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00086740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086750: 2020 2020 2020 2022 5468 6520 2762 6f6e         "The 'bon
-00086760: 6465 6474 6f27 2063 6c61 7573 6520 6861  dedto' clause ha
-00086770: 7320 6e6f 2065 6666 6563 742e 2229 0a0a  s no effect.")..
-00086780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086790: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000867a0: 2020 2020 2020 2020 2020 7365 6c66 2e66            self.f
-000867b0: 6163 746f 725b 2761 746f 6d5f 6964 275d  actor['atom_id']
-000867c0: 203d 205b 4e6f 6e65 5d0a 2020 2020 2020   = [None].      
-000867d0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000867e0: 6c66 2e5f 5f66 2e61 7070 656e 6428 6622  lf.__f.append(f"
-000867f0: 5b49 6e73 7566 6669 6369 656e 7420 6174  [Insufficient at
-00086800: 6f6d 2073 656c 6563 7469 6f6e 5d20 7b73  om selection] {s
-00086810: 656c 662e 5f5f 6765 7443 7572 7265 6e74  elf.__getCurrent
-00086820: 5265 7374 7261 696e 7428 297d 220a 2020  Restraint()}".  
-00086830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086760: 2020 2020 2020 2020 2020 2776 616c 7565            'value
+00086770: 273a 2073 656c 662e 5f5f 7265 7072 6573  ': self.__repres
+00086780: 656e 7461 7469 7665 4d6f 6465 6c49 647d  entativeModelId}
+00086790: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000867a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000867b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000867c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000867d0: 2020 5d29 0a0a 2020 2020 2020 2020 2020    ])..          
+000867e0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000867f0: 206c 656e 285f 6174 6f6d 2920 3d3d 2031   len(_atom) == 1
+00086800: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00086810: 2020 2020 2020 2020 2020 2020 2020 5f61                _a
+00086820: 746f 6d53 656c 6563 7469 6f6e 2e61 7070  tomSelection.app
+00086830: 656e 6428 5f61 746f 6d5b 305d 290a 0a20  end(_atom[0]).. 
 00086840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086850: 2020 2254 6865 2027 626f 6e64 6564 746f    "The 'bondedto
-00086860: 2720 636c 6175 7365 2068 6173 206e 6f20  ' clause has no 
-00086870: 6566 6665 6374 2062 6563 6175 7365 206e  effect because n
-00086880: 6f20 6174 6f6d 2069 7320 7365 6c65 6374  o atom is select
-00086890: 6564 2e22 290a 0a20 2020 2020 2020 2020  ed.")..         
-000868a0: 2020 2065 6c69 6620 6374 782e 4279 4772     elif ctx.ByGr
-000868b0: 6f75 7028 293a 0a20 2020 2020 2020 2020  oup():.         
-000868c0: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
-000868d0: 5f73 656c 5f65 7870 725f 6465 6275 673a  _sel_expr_debug:
-000868e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000868f0: 2020 2020 2070 7269 6e74 2822 2020 2220       print("  " 
-00086900: 2a20 7365 6c66 2e64 6570 7468 202b 2022  * self.depth + "
-00086910: 2d2d 3e20 6279 6772 6f75 7022 290a 2020  --> bygroup").  
-00086920: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00086930: 206e 6f74 2073 656c 662e 5f5f 6861 7343   not self.__hasC
-00086940: 6f6f 7264 3a0a 2020 2020 2020 2020 2020  oord:.          
-00086950: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00086960: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00086970: 2069 6620 2761 746f 6d5f 7365 6c65 6374   if 'atom_select
-00086980: 696f 6e27 2069 6e20 7365 6c66 2e66 6163  ion' in self.fac
-00086990: 746f 7220 616e 6420 6c65 6e28 7365 6c66  tor and len(self
-000869a0: 2e66 6163 746f 725b 2761 746f 6d5f 7365  .factor['atom_se
-000869b0: 6c65 6374 696f 6e27 5d29 203e 2030 3a0a  lection']) > 0:.
-000869c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000869d0: 2020 2020 5f61 746f 6d53 656c 6563 7469      _atomSelecti
-000869e0: 6f6e 203d 205b 5d0a 0a20 2020 2020 2020  on = []..       
-000869f0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00086a00: 205f 6174 6f6d 2069 6e20 7365 6c66 2e66   _atom in self.f
-00086a10: 6163 746f 725b 2761 746f 6d5f 7365 6c65  actor['atom_sele
-00086a20: 6374 696f 6e27 5d3a 0a20 2020 2020 2020  ction']:.       
-00086a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086a40: 2063 6861 696e 4964 203d 205f 6174 6f6d   chainId = _atom
-00086a50: 5b27 6368 6169 6e5f 6964 275d 0a20 2020  ['chain_id'].   
-00086a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086a70: 2020 2020 2063 6f6d 7049 6420 3d20 5f61       compId = _a
-00086a80: 746f 6d5b 2763 6f6d 705f 6964 275d 0a20  tom['comp_id']. 
-00086a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086aa0: 2020 2020 2020 2073 6571 4964 203d 205f         seqId = _
-00086ab0: 6174 6f6d 5b27 7365 715f 6964 275d 0a20  atom['seq_id']. 
-00086ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086ad0: 2020 2020 2020 2061 746f 6d49 6420 3d20         atomId = 
-00086ae0: 5f61 746f 6d5b 2761 746f 6d5f 6964 275d  _atom['atom_id']
-00086af0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00086b00: 2020 2020 2020 2020 2020 5f61 746f 6d53            _atomS
-00086b10: 656c 6563 7469 6f6e 2e61 7070 656e 6428  election.append(
-00086b20: 5f61 746f 6d29 2020 2320 7365 6c66 2061  _atom)  # self a
-00086b30: 746f 6d0a 0a20 2020 2020 2020 2020 2020  tom..           
-00086b40: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00086b50: 7365 6c66 2e5f 5f63 6355 2e75 7064 6174  self.__ccU.updat
-00086b60: 6543 6865 6d43 6f6d 7044 6963 7428 636f  eChemCompDict(co
-00086b70: 6d70 4964 293a 0a20 2020 2020 2020 2020  mpId):.         
-00086b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086b90: 2020 205f 626f 6e64 6564 4174 6f6d 4964     _bondedAtomId
-00086ba0: 5365 6c65 6374 203d 2073 6574 2829 0a20  Select = set(). 
-00086bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086bc0: 2020 2020 2020 2020 2020 2066 6f72 2063             for c
-00086bd0: 6362 2069 6e20 7365 6c66 2e5f 5f63 6355  cb in self.__ccU
-00086be0: 2e6c 6173 7442 6f6e 6473 3a0a 2020 2020  .lastBonds:.    
-00086bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086c00: 2020 2020 2020 2020 2020 2020 6966 2063              if c
-00086c10: 6362 5b73 656c 662e 5f5f 6363 552e 6363  cb[self.__ccU.cc
-00086c20: 6241 746f 6d49 6431 5d20 3d3d 2061 746f  bAtomId1] == ato
-00086c30: 6d49 643a 0a20 2020 2020 2020 2020 2020  mId:.           
-00086c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086c50: 2020 2020 2020 2020 205f 626f 6e64 6564           _bonded
-00086c60: 4174 6f6d 4964 5365 6c65 6374 2e61 6464  AtomIdSelect.add
-00086c70: 2863 6362 5b73 656c 662e 5f5f 6363 552e  (ccb[self.__ccU.
-00086c80: 6363 6241 746f 6d49 6432 5d29 0a20 2020  ccbAtomId2]).   
-00086c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086ca0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-00086cb0: 6620 6363 625b 7365 6c66 2e5f 5f63 6355  f ccb[self.__ccU
-00086cc0: 2e63 6362 4174 6f6d 4964 325d 203d 3d20  .ccbAtomId2] == 
-00086cd0: 6174 6f6d 4964 3a0a 2020 2020 2020 2020  atomId:.        
-00086ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086cf0: 2020 2020 2020 2020 2020 2020 5f62 6f6e              _bon
-00086d00: 6465 6441 746f 6d49 6453 656c 6563 742e  dedAtomIdSelect.
-00086d10: 6164 6428 6363 625b 7365 6c66 2e5f 5f63  add(ccb[self.__c
-00086d20: 6355 2e63 6362 4174 6f6d 4964 315d 290a  cU.ccbAtomId1]).
-00086d30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00086d40: 2020 2020 2020 2020 2020 2020 205f 6e6f               _no
-00086d50: 6e42 6f6e 6465 6441 746f 6d49 6453 656c  nBondedAtomIdSel
-00086d60: 6563 7420 3d20 7365 7428 290a 2020 2020  ect = set().    
-00086d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086d80: 2020 2020 2020 2020 666f 7220 5f61 746f          for _ato
-00086d90: 6d49 6420 696e 205f 626f 6e64 6564 4174  mId in _bondedAt
-00086da0: 6f6d 4964 5365 6c65 6374 3a0a 2020 2020  omIdSelect:.    
-00086db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086dc0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00086dd0: 6363 6220 696e 2073 656c 662e 5f5f 6363  ccb in self.__cc
-00086de0: 552e 6c61 7374 426f 6e64 733a 0a20 2020  U.lastBonds:.   
+00086850: 2020 2073 656c 662e 6661 6374 6f72 5b27     self.factor['
+00086860: 6174 6f6d 5f73 656c 6563 7469 6f6e 275d  atom_selection']
+00086870: 203d 205b 6469 6374 2873 2920 666f 7220   = [dict(s) for 
+00086880: 7320 696e 2073 6574 2866 726f 7a65 6e73  s in set(frozens
+00086890: 6574 2861 746f 6d2e 6974 656d 7328 2929  et(atom.items())
+000868a0: 2066 6f72 2061 746f 6d20 696e 205f 6174   for atom in _at
+000868b0: 6f6d 5365 6c65 6374 696f 6e29 5d0a 0a20  omSelection)].. 
+000868c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000868d0: 2020 2069 6620 6c65 6e28 7365 6c66 2e66     if len(self.f
+000868e0: 6163 746f 725b 2761 746f 6d5f 7365 6c65  actor['atom_sele
+000868f0: 6374 696f 6e27 5d29 203d 3d20 303a 0a20  ction']) == 0:. 
+00086900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086910: 2020 2020 2020 2073 656c 662e 6661 6374         self.fact
+00086920: 6f72 5b27 6174 6f6d 5f69 6427 5d20 3d20  or['atom_id'] = 
+00086930: 5b4e 6f6e 655d 0a20 2020 2020 2020 2020  [None].         
+00086940: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00086950: 656c 662e 5f5f 662e 6170 7065 6e64 2866  elf.__f.append(f
+00086960: 225b 496e 7375 6666 6963 6965 6e74 2061  "[Insufficient a
+00086970: 746f 6d20 7365 6c65 6374 696f 6e5d 207b  tom selection] {
+00086980: 7365 6c66 2e5f 5f67 6574 4375 7272 656e  self.__getCurren
+00086990: 7452 6573 7472 6169 6e74 2829 7d22 0a20  tRestraint()}". 
+000869a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000869b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000869c0: 2020 2020 2020 2022 5468 6520 2762 6f6e         "The 'bon
+000869d0: 6465 6474 6f27 2063 6c61 7573 6520 6861  dedto' clause ha
+000869e0: 7320 6e6f 2065 6666 6563 742e 2229 0a0a  s no effect.")..
+000869f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086a00: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00086a10: 2020 2020 2020 2020 2020 7365 6c66 2e66            self.f
+00086a20: 6163 746f 725b 2761 746f 6d5f 6964 275d  actor['atom_id']
+00086a30: 203d 205b 4e6f 6e65 5d0a 2020 2020 2020   = [None].      
+00086a40: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00086a50: 6c66 2e5f 5f66 2e61 7070 656e 6428 6622  lf.__f.append(f"
+00086a60: 5b49 6e73 7566 6669 6369 656e 7420 6174  [Insufficient at
+00086a70: 6f6d 2073 656c 6563 7469 6f6e 5d20 7b73  om selection] {s
+00086a80: 656c 662e 5f5f 6765 7443 7572 7265 6e74  elf.__getCurrent
+00086a90: 5265 7374 7261 696e 7428 297d 220a 2020  Restraint()}".  
+00086aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086ac0: 2020 2254 6865 2027 626f 6e64 6564 746f    "The 'bondedto
+00086ad0: 2720 636c 6175 7365 2068 6173 206e 6f20  ' clause has no 
+00086ae0: 6566 6665 6374 2062 6563 6175 7365 206e  effect because n
+00086af0: 6f20 6174 6f6d 2069 7320 7365 6c65 6374  o atom is select
+00086b00: 6564 2e22 290a 0a20 2020 2020 2020 2020  ed.")..         
+00086b10: 2020 2065 6c69 6620 6374 782e 4279 4772     elif ctx.ByGr
+00086b20: 6f75 7028 293a 0a20 2020 2020 2020 2020  oup():.         
+00086b30: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
+00086b40: 5f73 656c 5f65 7870 725f 6465 6275 673a  _sel_expr_debug:
+00086b50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00086b60: 2020 2020 2070 7269 6e74 2822 2020 2220       print("  " 
+00086b70: 2a20 7365 6c66 2e64 6570 7468 202b 2022  * self.depth + "
+00086b80: 2d2d 3e20 6279 6772 6f75 7022 290a 2020  --> bygroup").  
+00086b90: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00086ba0: 206e 6f74 2073 656c 662e 5f5f 6861 7343   not self.__hasC
+00086bb0: 6f6f 7264 3a0a 2020 2020 2020 2020 2020  oord:.          
+00086bc0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00086bd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00086be0: 2069 6620 2761 746f 6d5f 7365 6c65 6374   if 'atom_select
+00086bf0: 696f 6e27 2069 6e20 7365 6c66 2e66 6163  ion' in self.fac
+00086c00: 746f 7220 616e 6420 6c65 6e28 7365 6c66  tor and len(self
+00086c10: 2e66 6163 746f 725b 2761 746f 6d5f 7365  .factor['atom_se
+00086c20: 6c65 6374 696f 6e27 5d29 203e 2030 3a0a  lection']) > 0:.
+00086c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086c40: 2020 2020 5f61 746f 6d53 656c 6563 7469      _atomSelecti
+00086c50: 6f6e 203d 205b 5d0a 0a20 2020 2020 2020  on = []..       
+00086c60: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00086c70: 205f 6174 6f6d 2069 6e20 7365 6c66 2e66   _atom in self.f
+00086c80: 6163 746f 725b 2761 746f 6d5f 7365 6c65  actor['atom_sele
+00086c90: 6374 696f 6e27 5d3a 0a20 2020 2020 2020  ction']:.       
+00086ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086cb0: 2063 6861 696e 4964 203d 205f 6174 6f6d   chainId = _atom
+00086cc0: 5b27 6368 6169 6e5f 6964 275d 0a20 2020  ['chain_id'].   
+00086cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086ce0: 2020 2020 2063 6f6d 7049 6420 3d20 5f61       compId = _a
+00086cf0: 746f 6d5b 2763 6f6d 705f 6964 275d 0a20  tom['comp_id']. 
+00086d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086d10: 2020 2020 2020 2073 6571 4964 203d 205f         seqId = _
+00086d20: 6174 6f6d 5b27 7365 715f 6964 275d 0a20  atom['seq_id']. 
+00086d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086d40: 2020 2020 2020 2061 746f 6d49 6420 3d20         atomId = 
+00086d50: 5f61 746f 6d5b 2761 746f 6d5f 6964 275d  _atom['atom_id']
+00086d60: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00086d70: 2020 2020 2020 2020 2020 5f61 746f 6d53            _atomS
+00086d80: 656c 6563 7469 6f6e 2e61 7070 656e 6428  election.append(
+00086d90: 5f61 746f 6d29 2020 2320 7365 6c66 2061  _atom)  # self a
+00086da0: 746f 6d0a 0a20 2020 2020 2020 2020 2020  tom..           
+00086db0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00086dc0: 7365 6c66 2e5f 5f63 6355 2e75 7064 6174  self.__ccU.updat
+00086dd0: 6543 6865 6d43 6f6d 7044 6963 7428 636f  eChemCompDict(co
+00086de0: 6d70 4964 293a 0a20 2020 2020 2020 2020  mpId):.         
 00086df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086e10: 2069 6620 6363 625b 7365 6c66 2e5f 5f63   if ccb[self.__c
-00086e20: 6355 2e63 6362 4174 6f6d 4964 315d 203d  cU.ccbAtomId1] =
-00086e30: 3d20 5f61 746f 6d49 643a 0a20 2020 2020  = _atomId:.     
-00086e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086e60: 2020 205f 6e6f 6e42 6f6e 6465 6441 746f     _nonBondedAto
-00086e70: 6d49 6453 656c 6563 742e 6164 6428 6363  mIdSelect.add(cc
-00086e80: 625b 7365 6c66 2e5f 5f63 6355 2e63 6362  b[self.__ccU.ccb
-00086e90: 4174 6f6d 4964 325d 290a 2020 2020 2020  AtomId2]).      
-00086ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086eb0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00086ec0: 6966 2063 6362 5b73 656c 662e 5f5f 6363  if ccb[self.__cc
-00086ed0: 552e 6363 6241 746f 6d49 6432 5d20 3d3d  U.ccbAtomId2] ==
-00086ee0: 205f 6174 6f6d 4964 3a0a 2020 2020 2020   _atomId:.      
-00086ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086e00: 2020 205f 626f 6e64 6564 4174 6f6d 4964     _bondedAtomId
+00086e10: 5365 6c65 6374 203d 2073 6574 2829 0a20  Select = set(). 
+00086e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086e30: 2020 2020 2020 2020 2020 2066 6f72 2063             for c
+00086e40: 6362 2069 6e20 7365 6c66 2e5f 5f63 6355  cb in self.__ccU
+00086e50: 2e6c 6173 7442 6f6e 6473 3a0a 2020 2020  .lastBonds:.    
+00086e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086e70: 2020 2020 2020 2020 2020 2020 6966 2063              if c
+00086e80: 6362 5b73 656c 662e 5f5f 6363 552e 6363  cb[self.__ccU.cc
+00086e90: 6241 746f 6d49 6431 5d20 3d3d 2061 746f  bAtomId1] == ato
+00086ea0: 6d49 643a 0a20 2020 2020 2020 2020 2020  mId:.           
+00086eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086ec0: 2020 2020 2020 2020 205f 626f 6e64 6564           _bonded
+00086ed0: 4174 6f6d 4964 5365 6c65 6374 2e61 6464  AtomIdSelect.add
+00086ee0: 2863 6362 5b73 656c 662e 5f5f 6363 552e  (ccb[self.__ccU.
+00086ef0: 6363 6241 746f 6d49 6432 5d29 0a20 2020  ccbAtomId2]).   
 00086f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086f10: 2020 5f6e 6f6e 426f 6e64 6564 4174 6f6d    _nonBondedAtom
-00086f20: 4964 5365 6c65 6374 2e61 6464 2863 6362  IdSelect.add(ccb
-00086f30: 5b73 656c 662e 5f5f 6363 552e 6363 6241  [self.__ccU.ccbA
-00086f40: 746f 6d49 6431 5d29 0a0a 2020 2020 2020  tomId1])..      
+00086f10: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+00086f20: 6620 6363 625b 7365 6c66 2e5f 5f63 6355  f ccb[self.__ccU
+00086f30: 2e63 6362 4174 6f6d 4964 325d 203d 3d20  .ccbAtomId2] == 
+00086f40: 6174 6f6d 4964 3a0a 2020 2020 2020 2020  atomId:.        
 00086f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086f60: 2020 2020 2020 6966 2061 746f 6d49 6420        if atomId 
-00086f70: 696e 205f 6e6f 6e42 6f6e 6465 6441 746f  in _nonBondedAto
-00086f80: 6d49 6453 656c 6563 743a 0a20 2020 2020  mIdSelect:.     
-00086f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00086fa0: 2020 2020 2020 2020 2020 205f 6e6f 6e42             _nonB
-00086fb0: 6f6e 6465 6441 746f 6d49 6453 656c 6563  ondedAtomIdSelec
-00086fc0: 742e 7265 6d6f 7665 2861 746f 6d49 6429  t.remove(atomId)
-00086fd0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00086fe0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00086ff0: 7220 5f61 746f 6d49 6420 696e 205f 626f  r _atomId in _bo
-00087000: 6e64 6564 4174 6f6d 4964 5365 6c65 6374  ndedAtomIdSelect
-00087010: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00086f60: 2020 2020 2020 2020 2020 2020 5f62 6f6e              _bon
+00086f70: 6465 6441 746f 6d49 6453 656c 6563 742e  dedAtomIdSelect.
+00086f80: 6164 6428 6363 625b 7365 6c66 2e5f 5f63  add(ccb[self.__c
+00086f90: 6355 2e63 6362 4174 6f6d 4964 315d 290a  cU.ccbAtomId1]).
+00086fa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00086fb0: 2020 2020 2020 2020 2020 2020 205f 6e6f               _no
+00086fc0: 6e42 6f6e 6465 6441 746f 6d49 6453 656c  nBondedAtomIdSel
+00086fd0: 6563 7420 3d20 7365 7428 290a 2020 2020  ect = set().    
+00086fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00086ff0: 2020 2020 2020 2020 666f 7220 5f61 746f          for _ato
+00087000: 6d49 6420 696e 205f 626f 6e64 6564 4174  mId in _bondedAt
+00087010: 6f6d 4964 5365 6c65 6374 3a0a 2020 2020  omIdSelect:.    
 00087020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087030: 2020 6966 205f 6174 6f6d 4964 2069 6e20    if _atomId in 
-00087040: 5f6e 6f6e 426f 6e64 6564 4174 6f6d 4964  _nonBondedAtomId
-00087050: 5365 6c65 6374 3a0a 2020 2020 2020 2020  Select:.        
+00087030: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00087040: 6363 6220 696e 2073 656c 662e 5f5f 6363  ccb in self.__cc
+00087050: 552e 6c61 7374 426f 6e64 733a 0a20 2020  U.lastBonds:.   
 00087060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087070: 2020 2020 2020 2020 2020 2020 5f6e 6f6e              _non
-00087080: 426f 6e64 6564 4174 6f6d 4964 5365 6c65  BondedAtomIdSele
-00087090: 6374 2e72 656d 6f76 6528 5f61 746f 6d49  ct.remove(_atomI
-000870a0: 6429 0a0a 2020 2020 2020 2020 2020 2020  d)..            
+00087070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087080: 2069 6620 6363 625b 7365 6c66 2e5f 5f63   if ccb[self.__c
+00087090: 6355 2e63 6362 4174 6f6d 4964 315d 203d  cU.ccbAtomId1] =
+000870a0: 3d20 5f61 746f 6d49 643a 0a20 2020 2020  = _atomId:.     
 000870b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000870c0: 6966 206c 656e 285f 6e6f 6e42 6f6e 6465  if len(_nonBonde
-000870d0: 6441 746f 6d49 6453 656c 6563 7429 203e  dAtomIdSelect) >
-000870e0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-000870f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087100: 2020 2020 5f6f 7269 6769 6e20 3d5c 0a20      _origin =\. 
+000870c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000870d0: 2020 205f 6e6f 6e42 6f6e 6465 6441 746f     _nonBondedAto
+000870e0: 6d49 6453 656c 6563 742e 6164 6428 6363  mIdSelect.add(cc
+000870f0: 625b 7365 6c66 2e5f 5f63 6355 2e63 6362  b[self.__ccU.ccb
+00087100: 4174 6f6d 4964 325d 290a 2020 2020 2020  AtomId2]).      
 00087110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087130: 2020 2073 656c 662e 5f5f 6352 2e67 6574     self.__cR.get
-00087140: 4469 6374 4c69 7374 5769 7468 4669 6c74  DictListWithFilt
-00087150: 6572 2827 6174 6f6d 5f73 6974 6527 2c0a  er('atom_site',.
+00087120: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00087130: 6966 2063 6362 5b73 656c 662e 5f5f 6363  if ccb[self.__cc
+00087140: 552e 6363 6241 746f 6d49 6432 5d20 3d3d  U.ccbAtomId2] ==
+00087150: 205f 6174 6f6d 4964 3a0a 2020 2020 2020   _atomId:.      
 00087160: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00087170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000871a0: 2020 2020 4341 5254 4e5f 4441 5441 5f49      CARTN_DATA_I
-000871b0: 5445 4d53 2c0a 2020 2020 2020 2020 2020  TEMS,.          
+00087180: 2020 5f6e 6f6e 426f 6e64 6564 4174 6f6d    _nonBondedAtom
+00087190: 4964 5365 6c65 6374 2e61 6464 2863 6362  IdSelect.add(ccb
+000871a0: 5b73 656c 662e 5f5f 6363 552e 6363 6241  [self.__ccU.ccbA
+000871b0: 746f 6d49 6431 5d29 0a0a 2020 2020 2020  tomId1])..      
 000871c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000871d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000871e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000871f0: 2020 2020 2020 2020 2020 5b7b 276e 616d            [{'nam
-00087200: 6527 3a20 7365 6c66 2e5f 5f61 7574 6841  e': self.__authA
-00087210: 7379 6d49 642c 2027 7479 7065 273a 2027  symId, 'type': '
-00087220: 7374 7227 2c20 2776 616c 7565 273a 2063  str', 'value': c
-00087230: 6861 696e 4964 7d2c 0a20 2020 2020 2020  hainId},.       
-00087240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087270: 2020 2020 2020 2020 2020 2020 2020 7b27                {'
-00087280: 6e61 6d65 273a 2073 656c 662e 5f5f 6175  name': self.__au
-00087290: 7468 5365 7149 642c 2027 7479 7065 273a  thSeqId, 'type':
-000872a0: 2027 696e 7427 2c20 2776 616c 7565 273a   'int', 'value':
-000872b0: 2073 6571 4964 7d2c 0a20 2020 2020 2020   seqId},.       
-000872c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000871d0: 2020 2020 2020 6966 2061 746f 6d49 6420        if atomId 
+000871e0: 696e 205f 6e6f 6e42 6f6e 6465 6441 746f  in _nonBondedAto
+000871f0: 6d49 6453 656c 6563 743a 0a20 2020 2020  mIdSelect:.     
+00087200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087210: 2020 2020 2020 2020 2020 205f 6e6f 6e42             _nonB
+00087220: 6f6e 6465 6441 746f 6d49 6453 656c 6563  ondedAtomIdSelec
+00087230: 742e 7265 6d6f 7665 2861 746f 6d49 6429  t.remove(atomId)
+00087240: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00087250: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00087260: 7220 5f61 746f 6d49 6420 696e 205f 626f  r _atomId in _bo
+00087270: 6e64 6564 4174 6f6d 4964 5365 6c65 6374  ndedAtomIdSelect
+00087280: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00087290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000872a0: 2020 6966 205f 6174 6f6d 4964 2069 6e20    if _atomId in 
+000872b0: 5f6e 6f6e 426f 6e64 6564 4174 6f6d 4964  _nonBondedAtomId
+000872c0: 5365 6c65 6374 3a0a 2020 2020 2020 2020  Select:.        
 000872d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000872e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000872f0: 2020 2020 2020 2020 2020 2020 2020 7b27                {'
-00087300: 6e61 6d65 273a 2073 656c 662e 5f5f 6175  name': self.__au
-00087310: 7468 4174 6f6d 4964 2c20 2774 7970 6527  thAtomId, 'type'
-00087320: 3a20 2773 7472 272c 2027 7661 6c75 6527  : 'str', 'value'
-00087330: 3a20 6174 6f6d 4964 7d2c 0a20 2020 2020  : atomId},.     
-00087340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000872e0: 2020 2020 2020 2020 2020 2020 5f6e 6f6e              _non
+000872f0: 426f 6e64 6564 4174 6f6d 4964 5365 6c65  BondedAtomIdSele
+00087300: 6374 2e72 656d 6f76 6528 5f61 746f 6d49  ct.remove(_atomI
+00087310: 6429 0a0a 2020 2020 2020 2020 2020 2020  d)..            
+00087320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087330: 6966 206c 656e 285f 6e6f 6e42 6f6e 6465  if len(_nonBonde
+00087340: 6441 746f 6d49 6453 656c 6563 7429 203e  dAtomIdSelect) >
+00087350: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
 00087360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087380: 7b27 6e61 6d65 273a 2073 656c 662e 5f5f  {'name': self.__
-00087390: 6d6f 6465 6c4e 756d 4e61 6d65 2c20 2774  modelNumName, 't
-000873a0: 7970 6527 3a20 2769 6e74 272c 0a20 2020  ype': 'int',.   
-000873b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000873c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087370: 2020 2020 5f6f 7269 6769 6e20 3d5c 0a20      _origin =\. 
+00087380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000873a0: 2020 2073 656c 662e 5f5f 6352 2e67 6574     self.__cR.get
+000873b0: 4469 6374 4c69 7374 5769 7468 4669 6c74  DictListWithFilt
+000873c0: 6572 2827 6174 6f6d 5f73 6974 6527 2c0a  er('atom_site',.
 000873d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000873e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000873f0: 2020 2027 7661 6c75 6527 3a20 7365 6c66     'value': self
-00087400: 2e5f 5f72 6570 7265 7365 6e74 6174 6976  .__representativ
-00087410: 654d 6f64 656c 4964 7d2c 0a20 2020 2020  eModelId},.     
-00087420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000873f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087410: 2020 2020 4341 5254 4e5f 4441 5441 5f49      CARTN_DATA_I
+00087420: 5445 4d53 2c0a 2020 2020 2020 2020 2020  TEMS,.          
 00087430: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00087440: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00087450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087460: 7b27 6e61 6d65 273a 2027 6c61 6265 6c5f  {'name': 'label_
-00087470: 616c 745f 6964 272c 2027 7479 7065 273a  alt_id', 'type':
-00087480: 2027 656e 756d 272c 0a20 2020 2020 2020   'enum',.       
-00087490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000874a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087460: 2020 2020 2020 2020 2020 5b7b 276e 616d            [{'nam
+00087470: 6527 3a20 7365 6c66 2e5f 5f61 7574 6841  e': self.__authA
+00087480: 7379 6d49 642c 2027 7479 7065 273a 2027  symId, 'type': '
+00087490: 7374 7227 2c20 2776 616c 7565 273a 2063  str', 'value': c
+000874a0: 6861 696e 4964 7d2c 0a20 2020 2020 2020  hainId},.       
 000874b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000874c0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-000874d0: 656e 756d 273a 2028 2741 2729 7d0a 2020  enum': ('A')}.  
-000874e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000874f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087520: 2020 205d 290a 0a20 2020 2020 2020 2020     ])..         
+000874c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000874d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000874e0: 2020 2020 2020 2020 2020 2020 2020 7b27                {'
+000874f0: 6e61 6d65 273a 2073 656c 662e 5f5f 6175  name': self.__au
+00087500: 7468 5365 7149 642c 2027 7479 7065 273a  thSeqId, 'type':
+00087510: 2027 696e 7427 2c20 2776 616c 7565 273a   'int', 'value':
+00087520: 2073 6571 4964 7d2c 0a20 2020 2020 2020   seqId},.       
 00087530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087540: 2020 2020 2020 2069 6620 6c65 6e28 5f6f         if len(_o
-00087550: 7269 6769 6e29 203d 3d20 313a 0a20 2020  rigin) == 1:.   
-00087560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087580: 206f 7269 6769 6e20 3d20 746f 4e70 4172   origin = toNpAr
-00087590: 7261 7928 5f6f 7269 6769 6e5b 305d 290a  ray(_origin[0]).
-000875a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00087540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087560: 2020 2020 2020 2020 2020 2020 2020 7b27                {'
+00087570: 6e61 6d65 273a 2073 656c 662e 5f5f 6175  name': self.__au
+00087580: 7468 4174 6f6d 4964 2c20 2774 7970 6527  thAtomId, 'type'
+00087590: 3a20 2773 7472 272c 2027 7661 6c75 6527  : 'str', 'value'
+000875a0: 3a20 6174 6f6d 4964 7d2c 0a20 2020 2020  : atomId},.     
 000875b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000875c0: 2020 2020 2066 6f72 205f 6174 6f6d 4964       for _atomId
-000875d0: 2069 6e20 5f6e 6f6e 426f 6e64 6564 4174   in _nonBondedAt
-000875e0: 6f6d 4964 5365 6c65 6374 3a0a 2020 2020  omIdSelect:.    
-000875f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087610: 2020 2020 5f6e 6569 6768 626f 7220 3d5c      _neighbor =\
-00087620: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000875c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000875d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000875e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000875f0: 7b27 6e61 6d65 273a 2073 656c 662e 5f5f  {'name': self.__
+00087600: 6d6f 6465 6c4e 756d 4e61 6d65 2c20 2774  modelNumName, 't
+00087610: 7970 6527 3a20 2769 6e74 272c 0a20 2020  ype': 'int',.   
+00087620: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00087630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087640: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00087650: 662e 5f5f 6352 2e67 6574 4469 6374 4c69  f.__cR.getDictLi
-00087660: 7374 5769 7468 4669 6c74 6572 2827 6174  stWithFilter('at
-00087670: 6f6d 5f73 6974 6527 2c0a 2020 2020 2020  om_site',.      
-00087680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087660: 2020 2027 7661 6c75 6527 3a20 7365 6c66     'value': self
+00087670: 2e5f 5f72 6570 7265 7365 6e74 6174 6976  .__representativ
+00087680: 654d 6f64 656c 4964 7d2c 0a20 2020 2020  eModelId},.     
 00087690: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000876a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000876b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000876c0: 2020 2020 2020 4341 5254 4e5f 4441 5441        CARTN_DATA
-000876d0: 5f49 5445 4d53 2c0a 2020 2020 2020 2020  _ITEMS,.        
-000876e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000876f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000876c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000876d0: 7b27 6e61 6d65 273a 2027 6c61 6265 6c5f  {'name': 'label_
+000876e0: 616c 745f 6964 272c 2027 7479 7065 273a  alt_id', 'type':
+000876f0: 2027 656e 756d 272c 0a20 2020 2020 2020   'enum',.       
 00087700: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00087710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087720: 2020 2020 5b7b 276e 616d 6527 3a20 7365      [{'name': se
-00087730: 6c66 2e5f 5f61 7574 6841 7379 6d49 642c  lf.__authAsymId,
-00087740: 2027 7479 7065 273a 2027 7374 7227 2c20   'type': 'str', 
-00087750: 2776 616c 7565 273a 2063 6861 696e 4964  'value': chainId
-00087760: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
+00087720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087730: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00087740: 656e 756d 273a 2028 2741 2729 7d0a 2020  enum': ('A')}.  
+00087750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087760: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00087770: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00087780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087790: 2020 205d 290a 0a20 2020 2020 2020 2020     ])..         
 000877a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000877b0: 7b27 6e61 6d65 273a 2073 656c 662e 5f5f  {'name': self.__
-000877c0: 6175 7468 5365 7149 642c 2027 7479 7065  authSeqId, 'type
-000877d0: 273a 2027 696e 7427 2c20 2776 616c 7565  ': 'int', 'value
-000877e0: 273a 2073 6571 4964 7d2c 0a20 2020 2020  ': seqId},.     
-000877f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000877b0: 2020 2020 2020 2069 6620 6c65 6e28 5f6f         if len(_o
+000877c0: 7269 6769 6e29 203d 3d20 313a 0a20 2020  rigin) == 1:.   
+000877d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000877e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000877f0: 206f 7269 6769 6e20 3d20 746f 4e70 4172   origin = toNpAr
+00087800: 7261 7928 5f6f 7269 6769 6e5b 305d 290a  ray(_origin[0]).
+00087810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00087820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087830: 2020 2020 2020 2020 7b27 6e61 6d65 273a          {'name':
-00087840: 2073 656c 662e 5f5f 6175 7468 4174 6f6d   self.__authAtom
-00087850: 4964 2c20 2774 7970 6527 3a20 2773 7472  Id, 'type': 'str
-00087860: 272c 2027 7661 6c75 6527 3a20 5f61 746f  ', 'value': _ato
-00087870: 6d49 647d 2c0a 2020 2020 2020 2020 2020  mId},.          
-00087880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087830: 2020 2020 2066 6f72 205f 6174 6f6d 4964       for _atomId
+00087840: 2069 6e20 5f6e 6f6e 426f 6e64 6564 4174   in _nonBondedAt
+00087850: 6f6d 4964 5365 6c65 6374 3a0a 2020 2020  omIdSelect:.    
+00087860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087880: 2020 2020 5f6e 6569 6768 626f 7220 3d5c      _neighbor =\
+00087890: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 000878a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000878b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000878c0: 2020 207b 276e 616d 6527 3a20 7365 6c66     {'name': self
-000878d0: 2e5f 5f6d 6f64 656c 4e75 6d4e 616d 652c  .__modelNumName,
-000878e0: 2027 7479 7065 273a 2027 696e 7427 2c0a   'type': 'int',.
+000878b0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000878c0: 662e 5f5f 6352 2e67 6574 4469 6374 4c69  f.__cR.getDictLi
+000878d0: 7374 5769 7468 4669 6c74 6572 2827 6174  stWithFilter('at
+000878e0: 6f6d 5f73 6974 6527 2c0a 2020 2020 2020  om_site',.      
 000878f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00087900: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00087910: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00087920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087930: 2020 2020 2020 2020 2020 2020 2020 2776                'v
-00087940: 616c 7565 273a 2073 656c 662e 5f5f 7265  alue': self.__re
-00087950: 7072 6573 656e 7461 7469 7665 4d6f 6465  presentativeMode
-00087960: 6c49 647d 2c0a 2020 2020 2020 2020 2020  lId},.          
+00087930: 2020 2020 2020 4341 5254 4e5f 4441 5441        CARTN_DATA
+00087940: 5f49 5445 4d53 2c0a 2020 2020 2020 2020  _ITEMS,.        
+00087950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087960: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00087970: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00087980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000879a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000879b0: 2020 207b 276e 616d 6527 3a20 276c 6162     {'name': 'lab
-000879c0: 656c 5f61 6c74 5f69 6427 2c20 2774 7970  el_alt_id', 'typ
-000879d0: 6527 3a20 2765 6e75 6d27 2c0a 2020 2020  e': 'enum',.    
+00087990: 2020 2020 5b7b 276e 616d 6527 3a20 7365      [{'name': se
+000879a0: 6c66 2e5f 5f61 7574 6841 7379 6d49 642c  lf.__authAsymId,
+000879b0: 2027 7479 7065 273a 2027 7374 7227 2c20   'type': 'str', 
+000879c0: 2776 616c 7565 273a 2063 6861 696e 4964  'value': chainId
+000879d0: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
 000879e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000879f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00087a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00087a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087a20: 2020 2020 2020 2020 2020 2765 6e75 6d27            'enum'
-00087a30: 3a20 2827 4127 297d 0a20 2020 2020 2020  : ('A')}.       
-00087a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087a20: 7b27 6e61 6d65 273a 2073 656c 662e 5f5f  {'name': self.__
+00087a30: 6175 7468 5365 7149 642c 2027 7479 7065  authSeqId, 'type
+00087a40: 273a 2027 696e 7427 2c20 2776 616c 7565  ': 'int', 'value
+00087a50: 273a 2073 6571 4964 7d2c 0a20 2020 2020  ': seqId},.     
 00087a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00087a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087a80: 2020 2020 2020 5d29 0a0a 2020 2020 2020        ])..      
+00087a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00087a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087ab0: 2020 6966 206c 656e 285f 6e65 6967 6862    if len(_neighb
-00087ac0: 6f72 2920 213d 2031 3a0a 2020 2020 2020  or) != 1:.      
-00087ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087af0: 2020 2020 2020 636f 6e74 696e 7565 0a0a        continue..
+00087aa0: 2020 2020 2020 2020 7b27 6e61 6d65 273a          {'name':
+00087ab0: 2073 656c 662e 5f5f 6175 7468 4174 6f6d   self.__authAtom
+00087ac0: 4964 2c20 2774 7970 6527 3a20 2773 7472  Id, 'type': 'str
+00087ad0: 272c 2027 7661 6c75 6527 3a20 5f61 746f  ', 'value': _ato
+00087ae0: 6d49 647d 2c0a 2020 2020 2020 2020 2020  mId},.          
+00087af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00087b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00087b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087b20: 2020 2020 2020 2020 6966 206e 756d 7079          if numpy
-00087b30: 2e6c 696e 616c 672e 6e6f 726d 2874 6f4e  .linalg.norm(toN
-00087b40: 7041 7272 6179 285f 6e65 6967 6862 6f72  pArray(_neighbor
-00087b50: 5b30 5d29 202d 206f 7269 6769 6e29 203c  [0]) - origin) <
-00087b60: 2032 2e30 3a0a 2020 2020 2020 2020 2020   2.0:.          
+00087b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087b30: 2020 207b 276e 616d 6527 3a20 7365 6c66     {'name': self
+00087b40: 2e5f 5f6d 6f64 656c 4e75 6d4e 616d 652c  .__modelNumName,
+00087b50: 2027 7479 7065 273a 2027 696e 7427 2c0a   'type': 'int',.
+00087b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00087b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00087b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087b90: 2020 5f61 746f 6d53 656c 6563 7469 6f6e    _atomSelection
-00087ba0: 2e61 7070 656e 6428 7b27 6368 6169 6e5f  .append({'chain_
-00087bb0: 6964 273a 2063 6861 696e 4964 2c20 2773  id': chainId, 's
-00087bc0: 6571 5f69 6427 3a20 7365 7149 642c 2027  eq_id': seqId, '
-00087bd0: 636f 6d70 5f69 6427 3a20 636f 6d70 4964  comp_id': compId
-00087be0: 2c20 2761 746f 6d5f 6964 273a 205f 6174  , 'atom_id': _at
-00087bf0: 6f6d 4964 7d29 0a0a 2020 2020 2020 2020  omId})..        
+00087b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087ba0: 2020 2020 2020 2020 2020 2020 2020 2776                'v
+00087bb0: 616c 7565 273a 2073 656c 662e 5f5f 7265  alue': self.__re
+00087bc0: 7072 6573 656e 7461 7469 7665 4d6f 6465  presentativeMode
+00087bd0: 6c49 647d 2c0a 2020 2020 2020 2020 2020  lId},.          
+00087be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00087c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087c10: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00087c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087c40: 2020 6363 6120 3d20 6e65 7874 2828 6363    cca = next((cc
-00087c50: 6120 666f 7220 6363 6120 696e 2073 656c  a for cca in sel
-00087c60: 662e 5f5f 6363 552e 6c61 7374 4174 6f6d  f.__ccU.lastAtom
-00087c70: 4c69 7374 2069 6620 6363 615b 7365 6c66  List if cca[self
-00087c80: 2e5f 5f63 6355 2e63 6361 4174 6f6d 4964  .__ccU.ccaAtomId
-00087c90: 5d20 3d3d 2061 746f 6d49 6429 2c20 4e6f  ] == atomId), No
-00087ca0: 6e65 290a 2020 2020 2020 2020 2020 2020  ne).            
+00087c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087c20: 2020 207b 276e 616d 6527 3a20 276c 6162     {'name': 'lab
+00087c30: 656c 5f61 6c74 5f69 6427 2c20 2774 7970  el_alt_id', 'typ
+00087c40: 6527 3a20 2765 6e75 6d27 2c0a 2020 2020  e': 'enum',.    
+00087c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087c90: 2020 2020 2020 2020 2020 2765 6e75 6d27            'enum'
+00087ca0: 3a20 2827 4127 297d 0a20 2020 2020 2020  : ('A')}.       
 00087cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087cc0: 2020 2020 2020 2020 6966 2063 6361 2069          if cca i
-00087cd0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+00087cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00087ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087d00: 2020 2020 5f6f 7269 6769 6e20 3d20 7b27      _origin = {'
-00087d10: 7827 3a20 666c 6f61 7428 6363 615b 7365  x': float(cca[se
-00087d20: 6c66 2e5f 5f63 6355 2e63 6361 4361 7274  lf.__ccU.ccaCart
-00087d30: 6e58 5d29 2c20 2779 273a 2066 6c6f 6174  nX]), 'y': float
-00087d40: 2863 6361 5b73 656c 662e 5f5f 6363 552e  (cca[self.__ccU.
-00087d50: 6363 6143 6172 746e 595d 292c 2027 7a27  ccaCartnY]), 'z'
-00087d60: 3a20 666c 6f61 7428 6363 615b 7365 6c66  : float(cca[self
-00087d70: 2e5f 5f63 6355 2e63 6361 4361 7274 6e5a  .__ccU.ccaCartnZ
-00087d80: 5d29 7d0a 2020 2020 2020 2020 2020 2020  ])}.            
-00087d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087da0: 2020 2020 2020 2020 2020 2020 6f72 6967              orig
-00087db0: 696e 203d 2074 6f4e 7041 7272 6179 285f  in = toNpArray(_
-00087dc0: 6f72 6967 696e 290a 0a20 2020 2020 2020  origin)..       
-00087dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087cf0: 2020 2020 2020 5d29 0a0a 2020 2020 2020        ])..      
+00087d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087d20: 2020 6966 206c 656e 285f 6e65 6967 6862    if len(_neighb
+00087d30: 6f72 2920 213d 2031 3a0a 2020 2020 2020  or) != 1:.      
+00087d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087d60: 2020 2020 2020 636f 6e74 696e 7565 0a0a        continue..
+00087d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087d90: 2020 2020 2020 2020 6966 206e 756d 7079          if numpy
+00087da0: 2e6c 696e 616c 672e 6e6f 726d 2874 6f4e  .linalg.norm(toN
+00087db0: 7041 7272 6179 285f 6e65 6967 6862 6f72  pArray(_neighbor
+00087dc0: 5b30 5d29 202d 206f 7269 6769 6e29 203c  [0]) - origin) <
+00087dd0: 2032 2e30 3a0a 2020 2020 2020 2020 2020   2.0:.          
 00087de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087df0: 2066 6f72 205f 6174 6f6d 4964 2069 6e20   for _atomId in 
-00087e00: 5f6e 6f6e 426f 6e64 6564 4174 6f6d 4964  _nonBondedAtomId
-00087e10: 5365 6c65 6374 3a0a 2020 2020 2020 2020  Select:.        
-00087e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087e40: 2020 2020 5f63 6361 203d 206e 6578 7428      _cca = next(
-00087e50: 285f 6363 6120 666f 7220 5f63 6361 2069  (_cca for _cca i
-00087e60: 6e20 7365 6c66 2e5f 5f63 6355 2e6c 6173  n self.__ccU.las
-00087e70: 7441 746f 6d4c 6973 7420 6966 205f 6363  tAtomList if _cc
-00087e80: 615b 7365 6c66 2e5f 5f63 6355 2e63 6361  a[self.__ccU.cca
-00087e90: 4174 6f6d 4964 5d20 3d3d 205f 6174 6f6d  AtomId] == _atom
-00087ea0: 4964 292c 204e 6f6e 6529 0a20 2020 2020  Id), None).     
-00087eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087ed0: 2020 2020 2020 2069 6620 5f63 6361 2069         if _cca i
-00087ee0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-00087ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087f10: 2020 2020 2020 2020 2020 2020 5f6e 6569              _nei
-00087f20: 6768 626f 7220 3d20 7b27 7827 3a20 666c  ghbor = {'x': fl
-00087f30: 6f61 7428 5f63 6361 5b73 656c 662e 5f5f  oat(_cca[self.__
-00087f40: 6363 552e 6363 6143 6172 746e 585d 292c  ccU.ccaCartnX]),
-00087f50: 2027 7927 3a20 666c 6f61 7428 5f63 6361   'y': float(_cca
-00087f60: 5b73 656c 662e 5f5f 6363 552e 6363 6143  [self.__ccU.ccaC
-00087f70: 6172 746e 595d 292c 2027 7a27 3a20 666c  artnY]), 'z': fl
-00087f80: 6f61 7428 5f63 6361 5b73 656c 662e 5f5f  oat(_cca[self.__
-00087f90: 6363 552e 6363 6143 6172 746e 5a5d 297d  ccU.ccaCartnZ])}
-00087fa0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00087fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00087fd0: 2020 6966 206e 756d 7079 2e6c 696e 616c    if numpy.linal
-00087fe0: 672e 6e6f 726d 2874 6f4e 7041 7272 6179  g.norm(toNpArray
-00087ff0: 285f 6e65 6967 6862 6f72 2920 2d20 6f72  (_neighbor) - or
-00088000: 6967 696e 2920 3c20 322e 303a 0a20 2020  igin) < 2.0:.   
-00088010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088040: 205f 6174 6f6d 5365 6c65 6374 696f 6e2e   _atomSelection.
-00088050: 6170 7065 6e64 287b 2763 6861 696e 5f69  append({'chain_i
-00088060: 6427 3a20 6368 6169 6e49 642c 2027 7365  d': chainId, 'se
-00088070: 715f 6964 273a 2073 6571 4964 2c20 2763  q_id': seqId, 'c
-00088080: 6f6d 705f 6964 273a 2063 6f6d 7049 642c  omp_id': compId,
-00088090: 2027 6174 6f6d 5f69 6427 3a20 5f61 746f   'atom_id': _ato
-000880a0: 6d49 647d 290a 0a20 2020 2020 2020 2020  mId})..         
-000880b0: 2020 2020 2020 2020 2020 2061 746f 6d53             atomS
-000880c0: 656c 6563 7469 6f6e 203d 205b 6469 6374  election = [dict
-000880d0: 2873 2920 666f 7220 7320 696e 2073 6574  (s) for s in set
-000880e0: 2866 726f 7a65 6e73 6574 2861 746f 6d2e  (frozenset(atom.
-000880f0: 6974 656d 7328 2929 2066 6f72 2061 746f  items()) for ato
-00088100: 6d20 696e 205f 6174 6f6d 5365 6c65 6374  m in _atomSelect
-00088110: 696f 6e29 5d0a 0a20 2020 2020 2020 2020  ion)]..         
-00088120: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-00088130: 6e28 6174 6f6d 5365 6c65 6374 696f 6e29  n(atomSelection)
-00088140: 203c 3d20 6c65 6e28 7365 6c66 2e66 6163   <= len(self.fac
-00088150: 746f 725b 2761 746f 6d5f 7365 6c65 6374  tor['atom_select
-00088160: 696f 6e27 5d29 3a0a 2020 2020 2020 2020  ion']):.        
+00087df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087e00: 2020 5f61 746f 6d53 656c 6563 7469 6f6e    _atomSelection
+00087e10: 2e61 7070 656e 6428 7b27 6368 6169 6e5f  .append({'chain_
+00087e20: 6964 273a 2063 6861 696e 4964 2c20 2773  id': chainId, 's
+00087e30: 6571 5f69 6427 3a20 7365 7149 642c 2027  eq_id': seqId, '
+00087e40: 636f 6d70 5f69 6427 3a20 636f 6d70 4964  comp_id': compId
+00087e50: 2c20 2761 746f 6d5f 6964 273a 205f 6174  , 'atom_id': _at
+00087e60: 6f6d 4964 7d29 0a0a 2020 2020 2020 2020  omId})..        
+00087e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087e80: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00087e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087eb0: 2020 6363 6120 3d20 6e65 7874 2828 6363    cca = next((cc
+00087ec0: 6120 666f 7220 6363 6120 696e 2073 656c  a for cca in sel
+00087ed0: 662e 5f5f 6363 552e 6c61 7374 4174 6f6d  f.__ccU.lastAtom
+00087ee0: 4c69 7374 2069 6620 6363 615b 7365 6c66  List if cca[self
+00087ef0: 2e5f 5f63 6355 2e63 6361 4174 6f6d 4964  .__ccU.ccaAtomId
+00087f00: 5d20 3d3d 2061 746f 6d49 6429 2c20 4e6f  ] == atomId), No
+00087f10: 6e65 290a 2020 2020 2020 2020 2020 2020  ne).            
+00087f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087f30: 2020 2020 2020 2020 6966 2063 6361 2069          if cca i
+00087f40: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+00087f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00087f70: 2020 2020 5f6f 7269 6769 6e20 3d20 7b27      _origin = {'
+00087f80: 7827 3a20 666c 6f61 7428 6363 615b 7365  x': float(cca[se
+00087f90: 6c66 2e5f 5f63 6355 2e63 6361 4361 7274  lf.__ccU.ccaCart
+00087fa0: 6e58 5d29 2c20 2779 273a 2066 6c6f 6174  nX]), 'y': float
+00087fb0: 2863 6361 5b73 656c 662e 5f5f 6363 552e  (cca[self.__ccU.
+00087fc0: 6363 6143 6172 746e 595d 292c 2027 7a27  ccaCartnY]), 'z'
+00087fd0: 3a20 666c 6f61 7428 6363 615b 7365 6c66  : float(cca[self
+00087fe0: 2e5f 5f63 6355 2e63 6361 4361 7274 6e5a  .__ccU.ccaCartnZ
+00087ff0: 5d29 7d0a 2020 2020 2020 2020 2020 2020  ])}.            
+00088000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088010: 2020 2020 2020 2020 2020 2020 6f72 6967              orig
+00088020: 696e 203d 2074 6f4e 7041 7272 6179 285f  in = toNpArray(_
+00088030: 6f72 6967 696e 290a 0a20 2020 2020 2020  origin)..       
+00088040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088060: 2066 6f72 205f 6174 6f6d 4964 2069 6e20   for _atomId in 
+00088070: 5f6e 6f6e 426f 6e64 6564 4174 6f6d 4964  _nonBondedAtomId
+00088080: 5365 6c65 6374 3a0a 2020 2020 2020 2020  Select:.        
+00088090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000880a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000880b0: 2020 2020 5f63 6361 203d 206e 6578 7428      _cca = next(
+000880c0: 285f 6363 6120 666f 7220 5f63 6361 2069  (_cca for _cca i
+000880d0: 6e20 7365 6c66 2e5f 5f63 6355 2e6c 6173  n self.__ccU.las
+000880e0: 7441 746f 6d4c 6973 7420 6966 205f 6363  tAtomList if _cc
+000880f0: 615b 7365 6c66 2e5f 5f63 6355 2e63 6361  a[self.__ccU.cca
+00088100: 4174 6f6d 4964 5d20 3d3d 205f 6174 6f6d  AtomId] == _atom
+00088110: 4964 292c 204e 6f6e 6529 0a20 2020 2020  Id), None).     
+00088120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088140: 2020 2020 2020 2069 6620 5f63 6361 2069         if _cca i
+00088150: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+00088160: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00088170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088180: 7365 6c66 2e66 6163 746f 725b 2761 746f  self.factor['ato
-00088190: 6d5f 6964 275d 203d 205b 4e6f 6e65 5d0a  m_id'] = [None].
-000881a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000881b0: 2020 2020 2020 2020 7365 6c66 2e5f 5f66          self.__f
-000881c0: 2e61 7070 656e 6428 6622 5b49 6e73 7566  .append(f"[Insuf
-000881d0: 6669 6369 656e 7420 6174 6f6d 2073 656c  ficient atom sel
-000881e0: 6563 7469 6f6e 5d20 7b73 656c 662e 5f5f  ection] {self.__
-000881f0: 6765 7443 7572 7265 6e74 5265 7374 7261  getCurrentRestra
-00088200: 696e 7428 297d 220a 2020 2020 2020 2020  int()}".        
-00088210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088180: 2020 2020 2020 2020 2020 2020 5f6e 6569              _nei
+00088190: 6768 626f 7220 3d20 7b27 7827 3a20 666c  ghbor = {'x': fl
+000881a0: 6f61 7428 5f63 6361 5b73 656c 662e 5f5f  oat(_cca[self.__
+000881b0: 6363 552e 6363 6143 6172 746e 585d 292c  ccU.ccaCartnX]),
+000881c0: 2027 7927 3a20 666c 6f61 7428 5f63 6361   'y': float(_cca
+000881d0: 5b73 656c 662e 5f5f 6363 552e 6363 6143  [self.__ccU.ccaC
+000881e0: 6172 746e 595d 292c 2027 7a27 3a20 666c  artnY]), 'z': fl
+000881f0: 6f61 7428 5f63 6361 5b73 656c 662e 5f5f  oat(_cca[self.__
+00088200: 6363 552e 6363 6143 6172 746e 5a5d 297d  ccU.ccaCartnZ])}
+00088210: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
 00088220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088230: 2254 6865 2027 6279 6772 6f75 7027 2063  "The 'bygroup' c
-00088240: 6c61 7573 6520 6861 7320 6e6f 2065 6666  lause has no eff
-00088250: 6563 742e 2229 0a0a 2020 2020 2020 2020  ect.")..        
-00088260: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00088270: 2e66 6163 746f 725b 2761 746f 6d5f 7365  .factor['atom_se
-00088280: 6c65 6374 696f 6e27 5d20 3d20 6174 6f6d  lection'] = atom
-00088290: 5365 6c65 6374 696f 6e0a 0a20 2020 2020  Selection..     
-000882a0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-000882b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000882c0: 2020 2020 2073 656c 662e 6661 6374 6f72       self.factor
-000882d0: 5b27 6174 6f6d 5f69 6427 5d20 3d20 5b4e  ['atom_id'] = [N
-000882e0: 6f6e 655d 0a20 2020 2020 2020 2020 2020  one].           
-000882f0: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
-00088300: 662e 6170 7065 6e64 2866 225b 496e 7375  f.append(f"[Insu
-00088310: 6666 6963 6965 6e74 2061 746f 6d20 7365  fficient atom se
-00088320: 6c65 6374 696f 6e5d 207b 7365 6c66 2e5f  lection] {self._
-00088330: 5f67 6574 4375 7272 656e 7452 6573 7472  _getCurrentRestr
-00088340: 6169 6e74 2829 7d22 0a20 2020 2020 2020  aint()}".       
-00088350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088360: 2020 2020 2020 2020 2020 2020 2022 5468               "Th
-00088370: 6520 2762 7967 726f 7570 2720 636c 6175  e 'bygroup' clau
-00088380: 7365 2068 6173 206e 6f20 6566 6665 6374  se has no effect
-00088390: 2062 6563 6175 7365 206e 6f20 6174 6f6d   because no atom
-000883a0: 2069 7320 7365 6c65 6374 6564 2e22 290a   is selected.").
-000883b0: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-000883c0: 6620 6374 782e 4279 5265 7328 293a 0a20  f ctx.ByRes():. 
-000883d0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000883e0: 6620 7365 6c66 2e5f 5f73 656c 5f65 7870  f self.__sel_exp
-000883f0: 725f 6465 6275 673a 0a20 2020 2020 2020  r_debug:.       
-00088400: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-00088410: 6e74 2822 2020 2220 2a20 7365 6c66 2e64  nt("  " * self.d
-00088420: 6570 7468 202b 2022 2d2d 3e20 6279 7265  epth + "--> byre
-00088430: 7322 290a 2020 2020 2020 2020 2020 2020  s").            
-00088440: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
-00088450: 5f5f 6861 7343 6f6f 7264 3a0a 2020 2020  __hasCoord:.    
-00088460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088470: 7265 7475 726e 0a20 2020 2020 2020 2020  return.         
-00088480: 2020 2020 2020 2069 6620 2761 746f 6d5f         if 'atom_
-00088490: 7365 6c65 6374 696f 6e27 2069 6e20 7365  selection' in se
-000884a0: 6c66 2e66 6163 746f 7220 616e 6420 6c65  lf.factor and le
-000884b0: 6e28 7365 6c66 2e66 6163 746f 725b 2761  n(self.factor['a
-000884c0: 746f 6d5f 7365 6c65 6374 696f 6e27 5d29  tom_selection'])
-000884d0: 203e 2030 3a0a 2020 2020 2020 2020 2020   > 0:.          
-000884e0: 2020 2020 2020 2020 2020 5f61 746f 6d53            _atomS
-000884f0: 656c 6563 7469 6f6e 203d 205b 5d0a 0a20  election = [].. 
-00088500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088510: 2020 205f 7365 7175 656e 6365 5365 6c65     _sequenceSele
-00088520: 6374 203d 2073 6574 2829 0a0a 2020 2020  ct = set()..    
-00088530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088540: 666f 7220 5f61 746f 6d20 696e 2073 656c  for _atom in sel
-00088550: 662e 6661 6374 6f72 5b27 6174 6f6d 5f73  f.factor['atom_s
-00088560: 656c 6563 7469 6f6e 275d 3a0a 2020 2020  election']:.    
-00088570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088580: 2020 2020 6368 6169 6e49 6420 3d20 5f61      chainId = _a
-00088590: 746f 6d5b 2763 6861 696e 5f69 6427 5d0a  tom['chain_id'].
-000885a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000885b0: 2020 2020 2020 2020 7365 7149 6420 3d20          seqId = 
-000885c0: 5f61 746f 6d5b 2773 6571 5f69 6427 5d0a  _atom['seq_id'].
-000885d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000885e0: 2020 2020 2020 2020 205f 7365 7175 656e           _sequen
-000885f0: 6365 5365 6c65 6374 2e61 6464 2828 6368  ceSelect.add((ch
-00088600: 6169 6e49 642c 2073 6571 4964 2929 0a0a  ainId, seqId))..
-00088610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088620: 2020 2020 666f 7220 2863 6861 696e 4964      for (chainId
-00088630: 2c20 7365 7149 6429 2069 6e20 5f73 6571  , seqId) in _seq
-00088640: 7565 6e63 6553 656c 6563 743a 0a20 2020  uenceSelect:.   
-00088650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088660: 2020 2020 205f 6174 6f6d 203d 206e 6578       _atom = nex
-00088670: 7428 5f61 746f 6d20 666f 7220 5f61 746f  t(_atom for _ato
-00088680: 6d20 696e 2073 656c 662e 6661 6374 6f72  m in self.factor
-00088690: 5b27 6174 6f6d 5f73 656c 6563 7469 6f6e  ['atom_selection
-000886a0: 275d 2069 6620 5f61 746f 6d5b 2763 6861  '] if _atom['cha
-000886b0: 696e 5f69 6427 5d20 3d3d 2063 6861 696e  in_id'] == chain
-000886c0: 4964 2061 6e64 205f 6174 6f6d 5b27 7365  Id and _atom['se
-000886d0: 715f 6964 275d 203d 3d20 7365 7149 6429  q_id'] == seqId)
-000886e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000886f0: 2020 2020 2020 2020 2063 6f6d 7049 6420           compId 
-00088700: 3d20 5f61 746f 6d5b 2763 6f6d 705f 6964  = _atom['comp_id
-00088710: 275d 0a0a 2020 2020 2020 2020 2020 2020  ']..            
-00088720: 2020 2020 2020 2020 2020 2020 5f61 746f              _ato
-00088730: 6d42 7952 6573 203d 5c0a 2020 2020 2020  mByRes =\.      
-00088740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088750: 2020 2020 2020 7365 6c66 2e5f 5f63 522e        self.__cR.
-00088760: 6765 7444 6963 744c 6973 7457 6974 6846  getDictListWithF
-00088770: 696c 7465 7228 2761 746f 6d5f 7369 7465  ilter('atom_site
-00088780: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-00088790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088240: 2020 6966 206e 756d 7079 2e6c 696e 616c    if numpy.linal
+00088250: 672e 6e6f 726d 2874 6f4e 7041 7272 6179  g.norm(toNpArray
+00088260: 285f 6e65 6967 6862 6f72 2920 2d20 6f72  (_neighbor) - or
+00088270: 6967 696e 2920 3c20 322e 303a 0a20 2020  igin) < 2.0:.   
+00088280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000882a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000882b0: 205f 6174 6f6d 5365 6c65 6374 696f 6e2e   _atomSelection.
+000882c0: 6170 7065 6e64 287b 2763 6861 696e 5f69  append({'chain_i
+000882d0: 6427 3a20 6368 6169 6e49 642c 2027 7365  d': chainId, 'se
+000882e0: 715f 6964 273a 2073 6571 4964 2c20 2763  q_id': seqId, 'c
+000882f0: 6f6d 705f 6964 273a 2063 6f6d 7049 642c  omp_id': compId,
+00088300: 2027 6174 6f6d 5f69 6427 3a20 5f61 746f   'atom_id': _ato
+00088310: 6d49 647d 290a 0a20 2020 2020 2020 2020  mId})..         
+00088320: 2020 2020 2020 2020 2020 2061 746f 6d53             atomS
+00088330: 656c 6563 7469 6f6e 203d 205b 6469 6374  election = [dict
+00088340: 2873 2920 666f 7220 7320 696e 2073 6574  (s) for s in set
+00088350: 2866 726f 7a65 6e73 6574 2861 746f 6d2e  (frozenset(atom.
+00088360: 6974 656d 7328 2929 2066 6f72 2061 746f  items()) for ato
+00088370: 6d20 696e 205f 6174 6f6d 5365 6c65 6374  m in _atomSelect
+00088380: 696f 6e29 5d0a 0a20 2020 2020 2020 2020  ion)]..         
+00088390: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+000883a0: 6e28 6174 6f6d 5365 6c65 6374 696f 6e29  n(atomSelection)
+000883b0: 203c 3d20 6c65 6e28 7365 6c66 2e66 6163   <= len(self.fac
+000883c0: 746f 725b 2761 746f 6d5f 7365 6c65 6374  tor['atom_select
+000883d0: 696f 6e27 5d29 3a0a 2020 2020 2020 2020  ion']):.        
+000883e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000883f0: 7365 6c66 2e66 6163 746f 725b 2761 746f  self.factor['ato
+00088400: 6d5f 6964 275d 203d 205b 4e6f 6e65 5d0a  m_id'] = [None].
+00088410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088420: 2020 2020 2020 2020 7365 6c66 2e5f 5f66          self.__f
+00088430: 2e61 7070 656e 6428 6622 5b49 6e73 7566  .append(f"[Insuf
+00088440: 6669 6369 656e 7420 6174 6f6d 2073 656c  ficient atom sel
+00088450: 6563 7469 6f6e 5d20 7b73 656c 662e 5f5f  ection] {self.__
+00088460: 6765 7443 7572 7265 6e74 5265 7374 7261  getCurrentRestra
+00088470: 696e 7428 297d 220a 2020 2020 2020 2020  int()}".        
+00088480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000884a0: 2254 6865 2027 6279 6772 6f75 7027 2063  "The 'bygroup' c
+000884b0: 6c61 7573 6520 6861 7320 6e6f 2065 6666  lause has no eff
+000884c0: 6563 742e 2229 0a0a 2020 2020 2020 2020  ect.")..        
+000884d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000884e0: 2e66 6163 746f 725b 2761 746f 6d5f 7365  .factor['atom_se
+000884f0: 6c65 6374 696f 6e27 5d20 3d20 6174 6f6d  lection'] = atom
+00088500: 5365 6c65 6374 696f 6e0a 0a20 2020 2020  Selection..     
+00088510: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00088520: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00088530: 2020 2020 2073 656c 662e 6661 6374 6f72       self.factor
+00088540: 5b27 6174 6f6d 5f69 6427 5d20 3d20 5b4e  ['atom_id'] = [N
+00088550: 6f6e 655d 0a20 2020 2020 2020 2020 2020  one].           
+00088560: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
+00088570: 662e 6170 7065 6e64 2866 225b 496e 7375  f.append(f"[Insu
+00088580: 6666 6963 6965 6e74 2061 746f 6d20 7365  fficient atom se
+00088590: 6c65 6374 696f 6e5d 207b 7365 6c66 2e5f  lection] {self._
+000885a0: 5f67 6574 4375 7272 656e 7452 6573 7472  _getCurrentRestr
+000885b0: 6169 6e74 2829 7d22 0a20 2020 2020 2020  aint()}".       
+000885c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000885d0: 2020 2020 2020 2020 2020 2020 2022 5468               "Th
+000885e0: 6520 2762 7967 726f 7570 2720 636c 6175  e 'bygroup' clau
+000885f0: 7365 2068 6173 206e 6f20 6566 6665 6374  se has no effect
+00088600: 2062 6563 6175 7365 206e 6f20 6174 6f6d   because no atom
+00088610: 2069 7320 7365 6c65 6374 6564 2e22 290a   is selected.").
+00088620: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+00088630: 6620 6374 782e 4279 5265 7328 293a 0a20  f ctx.ByRes():. 
+00088640: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00088650: 6620 7365 6c66 2e5f 5f73 656c 5f65 7870  f self.__sel_exp
+00088660: 725f 6465 6275 673a 0a20 2020 2020 2020  r_debug:.       
+00088670: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+00088680: 6e74 2822 2020 2220 2a20 7365 6c66 2e64  nt("  " * self.d
+00088690: 6570 7468 202b 2022 2d2d 3e20 6279 7265  epth + "--> byre
+000886a0: 7322 290a 2020 2020 2020 2020 2020 2020  s").            
+000886b0: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
+000886c0: 5f5f 6861 7343 6f6f 7264 3a0a 2020 2020  __hasCoord:.    
+000886d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000886e0: 7265 7475 726e 0a20 2020 2020 2020 2020  return.         
+000886f0: 2020 2020 2020 2069 6620 2761 746f 6d5f         if 'atom_
+00088700: 7365 6c65 6374 696f 6e27 2069 6e20 7365  selection' in se
+00088710: 6c66 2e66 6163 746f 7220 616e 6420 6c65  lf.factor and le
+00088720: 6e28 7365 6c66 2e66 6163 746f 725b 2761  n(self.factor['a
+00088730: 746f 6d5f 7365 6c65 6374 696f 6e27 5d29  tom_selection'])
+00088740: 203e 2030 3a0a 2020 2020 2020 2020 2020   > 0:.          
+00088750: 2020 2020 2020 2020 2020 5f61 746f 6d53            _atomS
+00088760: 656c 6563 7469 6f6e 203d 205b 5d0a 0a20  election = [].. 
+00088770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088780: 2020 205f 7365 7175 656e 6365 5365 6c65     _sequenceSele
+00088790: 6374 203d 2073 6574 2829 0a0a 2020 2020  ct = set()..    
 000887a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000887b0: 2020 2020 2020 2020 2020 2020 2020 2041                 A
-000887c0: 544f 4d5f 4e41 4d45 5f44 4154 415f 4954  TOM_NAME_DATA_IT
-000887d0: 454d 532c 0a20 2020 2020 2020 2020 2020  EMS,.           
+000887b0: 666f 7220 5f61 746f 6d20 696e 2073 656c  for _atom in sel
+000887c0: 662e 6661 6374 6f72 5b27 6174 6f6d 5f73  f.factor['atom_s
+000887d0: 656c 6563 7469 6f6e 275d 3a0a 2020 2020  election']:.    
 000887e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000887f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088810: 205b 7b27 6e61 6d65 273a 2073 656c 662e   [{'name': self.
-00088820: 5f5f 6175 7468 4173 796d 4964 2c20 2774  __authAsymId, 't
-00088830: 7970 6527 3a20 2773 7472 272c 2027 7661  ype': 'str', 'va
-00088840: 6c75 6527 3a20 6368 6169 6e49 647d 2c0a  lue': chainId},.
-00088850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088880: 2020 2020 2020 2020 2020 2020 207b 276e               {'n
-00088890: 616d 6527 3a20 7365 6c66 2e5f 5f61 7574  ame': self.__aut
-000888a0: 6853 6571 4964 2c20 2774 7970 6527 3a20  hSeqId, 'type': 
-000888b0: 2769 6e74 272c 2027 7661 6c75 6527 3a20  'int', 'value': 
-000888c0: 7365 7149 647d 2c0a 2020 2020 2020 2020  seqId},.        
-000888d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000888e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000888f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088900: 2020 2020 207b 276e 616d 6527 3a20 7365       {'name': se
-00088910: 6c66 2e5f 5f6d 6f64 656c 4e75 6d4e 616d  lf.__modelNumNam
-00088920: 652c 2027 7479 7065 273a 2027 696e 7427  e, 'type': 'int'
-00088930: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00088940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088970: 2776 616c 7565 273a 2073 656c 662e 5f5f  'value': self.__
-00088980: 7265 7072 6573 656e 7461 7469 7665 4d6f  representativeMo
-00088990: 6465 6c49 647d 2c0a 2020 2020 2020 2020  delId},.        
-000889a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000887f0: 2020 2020 6368 6169 6e49 6420 3d20 5f61      chainId = _a
+00088800: 746f 6d5b 2763 6861 696e 5f69 6427 5d0a  tom['chain_id'].
+00088810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088820: 2020 2020 2020 2020 7365 7149 6420 3d20          seqId = 
+00088830: 5f61 746f 6d5b 2773 6571 5f69 6427 5d0a  _atom['seq_id'].
+00088840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00088850: 2020 2020 2020 2020 205f 7365 7175 656e           _sequen
+00088860: 6365 5365 6c65 6374 2e61 6464 2828 6368  ceSelect.add((ch
+00088870: 6169 6e49 642c 2073 6571 4964 2929 0a0a  ainId, seqId))..
+00088880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088890: 2020 2020 666f 7220 2863 6861 696e 4964      for (chainId
+000888a0: 2c20 7365 7149 6429 2069 6e20 5f73 6571  , seqId) in _seq
+000888b0: 7565 6e63 6553 656c 6563 743a 0a20 2020  uenceSelect:.   
+000888c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000888d0: 2020 2020 205f 6174 6f6d 203d 206e 6578       _atom = nex
+000888e0: 7428 5f61 746f 6d20 666f 7220 5f61 746f  t(_atom for _ato
+000888f0: 6d20 696e 2073 656c 662e 6661 6374 6f72  m in self.factor
+00088900: 5b27 6174 6f6d 5f73 656c 6563 7469 6f6e  ['atom_selection
+00088910: 275d 2069 6620 5f61 746f 6d5b 2763 6861  '] if _atom['cha
+00088920: 696e 5f69 6427 5d20 3d3d 2063 6861 696e  in_id'] == chain
+00088930: 4964 2061 6e64 205f 6174 6f6d 5b27 7365  Id and _atom['se
+00088940: 715f 6964 275d 203d 3d20 7365 7149 6429  q_id'] == seqId)
+00088950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00088960: 2020 2020 2020 2020 2063 6f6d 7049 6420           compId 
+00088970: 3d20 5f61 746f 6d5b 2763 6f6d 705f 6964  = _atom['comp_id
+00088980: 275d 0a0a 2020 2020 2020 2020 2020 2020  ']..            
+00088990: 2020 2020 2020 2020 2020 2020 5f61 746f              _ato
+000889a0: 6d42 7952 6573 203d 5c0a 2020 2020 2020  mByRes =\.      
 000889b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000889c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000889d0: 2020 2020 207b 276e 616d 6527 3a20 276c       {'name': 'l
-000889e0: 6162 656c 5f61 6c74 5f69 6427 2c20 2774  abel_alt_id', 't
-000889f0: 7970 6527 3a20 2765 6e75 6d27 2c0a 2020  ype': 'enum',.  
+000889c0: 2020 2020 2020 7365 6c66 2e5f 5f63 522e        self.__cR.
+000889d0: 6765 7444 6963 744c 6973 7457 6974 6846  getDictListWithF
+000889e0: 696c 7465 7228 2761 746f 6d5f 7369 7465  ilter('atom_site
+000889f0: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
 00088a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00088a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088a30: 2020 2020 2020 2020 2020 2020 2765 6e75              'enu
-00088a40: 6d27 3a20 2827 4127 297d 0a20 2020 2020  m': ('A')}.     
+00088a20: 2020 2020 2020 2020 2020 2020 2020 2041                 A
+00088a30: 544f 4d5f 4e41 4d45 5f44 4154 415f 4954  TOM_NAME_DATA_IT
+00088a40: 454d 532c 0a20 2020 2020 2020 2020 2020  EMS,.           
 00088a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00088a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00088a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088a80: 2020 2020 2020 2020 5d29 0a0a 2020 2020          ])..    
-00088a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088aa0: 2020 2020 6966 206c 656e 285f 6174 6f6d      if len(_atom
-00088ab0: 4279 5265 7329 203e 2030 2061 6e64 205f  ByRes) > 0 and _
-00088ac0: 6174 6f6d 4279 5265 735b 305d 5b27 636f  atomByRes[0]['co
-00088ad0: 6d70 5f69 6427 5d20 3d3d 2063 6f6d 7049  mp_id'] == compI
-00088ae0: 643a 0a20 2020 2020 2020 2020 2020 2020  d:.             
-00088af0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00088b00: 6f72 205f 6174 6f6d 2069 6e20 5f61 746f  or _atom in _ato
-00088b10: 6d42 7952 6573 3a0a 2020 2020 2020 2020  mByRes:.        
-00088b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088b30: 2020 2020 2020 2020 5f61 746f 6d53 656c          _atomSel
-00088b40: 6563 7469 6f6e 2e61 7070 656e 6428 7b27  ection.append({'
-00088b50: 6368 6169 6e5f 6964 273a 2063 6861 696e  chain_id': chain
-00088b60: 4964 2c20 2773 6571 5f69 6427 3a20 7365  Id, 'seq_id': se
-00088b70: 7149 642c 2027 636f 6d70 5f69 6427 3a20  qId, 'comp_id': 
-00088b80: 5f61 746f 6d5b 2763 6f6d 705f 6964 275d  _atom['comp_id']
-00088b90: 2c20 2761 746f 6d5f 6964 273a 205f 6174  , 'atom_id': _at
-00088ba0: 6f6d 5b27 6174 6f6d 5f69 6427 5d7d 290a  om['atom_id']}).
-00088bb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00088bc0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00088a80: 205b 7b27 6e61 6d65 273a 2073 656c 662e   [{'name': self.
+00088a90: 5f5f 6175 7468 4173 796d 4964 2c20 2774  __authAsymId, 't
+00088aa0: 7970 6527 3a20 2773 7472 272c 2027 7661  ype': 'str', 'va
+00088ab0: 6c75 6527 3a20 6368 6169 6e49 647d 2c0a  lue': chainId},.
+00088ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088af0: 2020 2020 2020 2020 2020 2020 207b 276e               {'n
+00088b00: 616d 6527 3a20 7365 6c66 2e5f 5f61 7574  ame': self.__aut
+00088b10: 6853 6571 4964 2c20 2774 7970 6527 3a20  hSeqId, 'type': 
+00088b20: 2769 6e74 272c 2027 7661 6c75 6527 3a20  'int', 'value': 
+00088b30: 7365 7149 647d 2c0a 2020 2020 2020 2020  seqId},.        
+00088b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088b70: 2020 2020 207b 276e 616d 6527 3a20 7365       {'name': se
+00088b80: 6c66 2e5f 5f6d 6f64 656c 4e75 6d4e 616d  lf.__modelNumNam
+00088b90: 652c 2027 7479 7065 273a 2027 696e 7427  e, 'type': 'int'
+00088ba0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00088bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00088bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088be0: 2020 2020 2020 2020 2020 2070 7320 3d20             ps = 
-00088bf0: 6e65 7874 2828 7073 2066 6f72 2070 7320  next((ps for ps 
-00088c00: 696e 2073 656c 662e 5f5f 706f 6c79 5365  in self.__polySe
-00088c10: 7120 6966 2070 735b 2761 7574 685f 6368  q if ps['auth_ch
-00088c20: 6169 6e5f 6964 275d 203d 3d20 6368 6169  ain_id'] == chai
-00088c30: 6e49 6429 2c20 4e6f 6e65 290a 2020 2020  nId), None).    
-00088c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088c50: 2020 2020 2020 2020 6966 2070 7320 6973          if ps is
-00088c60: 206e 6f74 204e 6f6e 6520 616e 6420 7365   not None and se
-00088c70: 7149 6420 696e 2070 735b 2761 7574 685f  qId in ps['auth_
-00088c80: 7365 715f 6964 275d 2061 6e64 2070 735b  seq_id'] and ps[
-00088c90: 2763 6f6d 705f 6964 275d 5b70 735b 2761  'comp_id'][ps['a
-00088ca0: 7574 685f 7365 715f 6964 275d 2e69 6e64  uth_seq_id'].ind
-00088cb0: 6578 2873 6571 4964 295d 203d 3d20 636f  ex(seqId)] == co
-00088cc0: 6d70 4964 3a0a 2020 2020 2020 2020 2020  mpId:.          
+00088be0: 2776 616c 7565 273a 2073 656c 662e 5f5f  'value': self.__
+00088bf0: 7265 7072 6573 656e 7461 7469 7665 4d6f  representativeMo
+00088c00: 6465 6c49 647d 2c0a 2020 2020 2020 2020  delId},.        
+00088c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088c40: 2020 2020 207b 276e 616d 6527 3a20 276c       {'name': 'l
+00088c50: 6162 656c 5f61 6c74 5f69 6427 2c20 2774  abel_alt_id', 't
+00088c60: 7970 6527 3a20 2765 6e75 6d27 2c0a 2020  ype': 'enum',.  
+00088c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088ca0: 2020 2020 2020 2020 2020 2020 2765 6e75              'enu
+00088cb0: 6d27 3a20 2827 4127 297d 0a20 2020 2020  m': ('A')}.     
+00088cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00088cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088ce0: 2020 2020 2020 7365 7149 6420 3d20 7365        seqId = se
-00088cf0: 6c66 2e67 6574 5265 616c 5365 7149 6428  lf.getRealSeqId(
-00088d00: 7073 2c20 7365 7149 6429 0a20 2020 2020  ps, seqId).     
-00088d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088d20: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00088d30: 6c66 2e5f 5f63 6355 2e75 7064 6174 6543  lf.__ccU.updateC
-00088d40: 6865 6d43 6f6d 7044 6963 7428 636f 6d70  hemCompDict(comp
-00088d50: 4964 293a 0a20 2020 2020 2020 2020 2020  Id):.           
-00088d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088d70: 2020 2020 2020 2020 2061 746f 6d49 6473           atomIds
-00088d80: 203d 205b 6363 615b 7365 6c66 2e5f 5f63   = [cca[self.__c
-00088d90: 6355 2e63 6361 4174 6f6d 4964 5d20 666f  cU.ccaAtomId] fo
-00088da0: 7220 6363 6120 696e 2073 656c 662e 5f5f  r cca in self.__
-00088db0: 6363 552e 6c61 7374 4174 6f6d 4c69 7374  ccU.lastAtomList
-00088dc0: 2069 6620 6363 615b 7365 6c66 2e5f 5f63   if cca[self.__c
-00088dd0: 6355 2e63 6361 4c65 6176 696e 6741 746f  cU.ccaLeavingAto
-00088de0: 6d46 6c61 675d 2021 3d20 2759 275d 0a20  mFlag] != 'Y']. 
-00088df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088e10: 2020 2066 6f72 2061 746f 6d49 6420 696e     for atomId in
-00088e20: 2061 746f 6d49 6473 3a0a 2020 2020 2020   atomIds:.      
-00088e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088cf0: 2020 2020 2020 2020 5d29 0a0a 2020 2020          ])..    
+00088d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088d10: 2020 2020 6966 206c 656e 285f 6174 6f6d      if len(_atom
+00088d20: 4279 5265 7329 203e 2030 2061 6e64 205f  ByRes) > 0 and _
+00088d30: 6174 6f6d 4279 5265 735b 305d 5b27 636f  atomByRes[0]['co
+00088d40: 6d70 5f69 6427 5d20 3d3d 2063 6f6d 7049  mp_id'] == compI
+00088d50: 643a 0a20 2020 2020 2020 2020 2020 2020  d:.             
+00088d60: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00088d70: 6f72 205f 6174 6f6d 2069 6e20 5f61 746f  or _atom in _ato
+00088d80: 6d42 7952 6573 3a0a 2020 2020 2020 2020  mByRes:.        
+00088d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088da0: 2020 2020 2020 2020 5f61 746f 6d53 656c          _atomSel
+00088db0: 6563 7469 6f6e 2e61 7070 656e 6428 7b27  ection.append({'
+00088dc0: 6368 6169 6e5f 6964 273a 2063 6861 696e  chain_id': chain
+00088dd0: 4964 2c20 2773 6571 5f69 6427 3a20 7365  Id, 'seq_id': se
+00088de0: 7149 642c 2027 636f 6d70 5f69 6427 3a20  qId, 'comp_id': 
+00088df0: 5f61 746f 6d5b 2763 6f6d 705f 6964 275d  _atom['comp_id']
+00088e00: 2c20 2761 746f 6d5f 6964 273a 205f 6174  , 'atom_id': _at
+00088e10: 6f6d 5b27 6174 6f6d 5f69 6427 5d7d 290a  om['atom_id']}).
+00088e20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00088e30: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
 00088e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088e50: 2020 5f61 746f 6d53 656c 6563 7469 6f6e    _atomSelection
-00088e60: 2e61 7070 656e 6428 7b27 6368 6169 6e5f  .append({'chain_
-00088e70: 6964 273a 2063 6861 696e 4964 2c20 2773  id': chainId, 's
-00088e80: 6571 5f69 6427 3a20 7365 7149 642c 2027  eq_id': seqId, '
-00088e90: 636f 6d70 5f69 6427 3a20 636f 6d70 4964  comp_id': compId
-00088ea0: 2c20 2761 746f 6d5f 6964 273a 2061 746f  , 'atom_id': ato
-00088eb0: 6d49 647d 290a 2020 2020 2020 2020 2020  mId}).          
-00088ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088ed0: 2020 6966 2073 656c 662e 5f5f 6861 734e    if self.__hasN
-00088ee0: 6f6e 506f 6c79 5365 713a 0a20 2020 2020  onPolySeq:.     
-00088ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088f00: 2020 2020 2020 2020 2020 206e 704c 6973             npLis
-00088f10: 7420 3d20 5b6e 7020 666f 7220 6e70 2069  t = [np for np i
-00088f20: 6e20 7365 6c66 2e5f 5f6e 6f6e 506f 6c79  n self.__nonPoly
-00088f30: 5365 7120 6966 206e 705b 2761 7574 685f  Seq if np['auth_
-00088f40: 6368 6169 6e5f 6964 275d 203d 3d20 6368  chain_id'] == ch
-00088f50: 6169 6e49 645d 0a20 2020 2020 2020 2020  ainId].         
-00088f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088f70: 2020 2020 2020 2066 6f72 206e 7020 696e         for np in
-00088f80: 206e 704c 6973 743a 0a20 2020 2020 2020   npList:.       
-00088f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00088fa0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00088fb0: 7365 7149 6420 696e 206e 705b 2761 7574  seqId in np['aut
-00088fc0: 685f 7365 715f 6964 275d 2061 6e64 206e  h_seq_id'] and n
-00088fd0: 705b 2763 6f6d 705f 6964 275d 5b6e 705b  p['comp_id'][np[
-00088fe0: 2761 7574 685f 7365 715f 6964 275d 2e69  'auth_seq_id'].i
-00088ff0: 6e64 6578 2873 6571 4964 295d 203d 3d20  ndex(seqId)] == 
-00089000: 636f 6d70 4964 3a0a 2020 2020 2020 2020  compId:.        
-00089010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00089020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00089030: 7365 7149 6420 3d20 7365 6c66 2e67 6574  seqId = self.get
-00089040: 5265 616c 5365 7149 6428 6e70 2c20 7365  RealSeqId(np, se
-00089050: 7149 642c 2046 616c 7365 290a 2020 2020  qId, False).    
+00088e50: 2020 2020 2020 2020 2020 2070 7320 3d20             ps = 
+00088e60: 6e65 7874 2828 7073 2066 6f72 2070 7320  next((ps for ps 
+00088e70: 696e 2073 656c 662e 5f5f 706f 6c79 5365  in self.__polySe
+00088e80: 7120 6966 2070 735b 2761 7574 685f 6368  q if ps['auth_ch
+00088e90: 6169 6e5f 6964 275d 203d 3d20 6368 6169  ain_id'] == chai
+00088ea0: 6e49 6429 2c20 4e6f 6e65 290a 2020 2020  nId), None).    
+00088eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088ec0: 2020 2020 2020 2020 6966 2070 7320 6973          if ps is
+00088ed0: 206e 6f74 204e 6f6e 6520 616e 6420 7365   not None and se
+00088ee0: 7149 6420 696e 2070 735b 2761 7574 685f  qId in ps['auth_
+00088ef0: 7365 715f 6964 275d 2061 6e64 2070 735b  seq_id'] and ps[
+00088f00: 2763 6f6d 705f 6964 275d 5b70 735b 2761  'comp_id'][ps['a
+00088f10: 7574 685f 7365 715f 6964 275d 2e69 6e64  uth_seq_id'].ind
+00088f20: 6578 2873 6571 4964 295d 203d 3d20 636f  ex(seqId)] == co
+00088f30: 6d70 4964 3a0a 2020 2020 2020 2020 2020  mpId:.          
+00088f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088f50: 2020 2020 2020 7365 7149 6420 3d20 7365        seqId = se
+00088f60: 6c66 2e67 6574 5265 616c 5365 7149 6428  lf.getRealSeqId(
+00088f70: 7073 2c20 7365 7149 6429 0a20 2020 2020  ps, seqId).     
+00088f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088f90: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00088fa0: 6c66 2e5f 5f63 6355 2e75 7064 6174 6543  lf.__ccU.updateC
+00088fb0: 6865 6d43 6f6d 7044 6963 7428 636f 6d70  hemCompDict(comp
+00088fc0: 4964 293a 0a20 2020 2020 2020 2020 2020  Id):.           
+00088fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00088fe0: 2020 2020 2020 2020 2061 746f 6d49 6473           atomIds
+00088ff0: 203d 205b 6363 615b 7365 6c66 2e5f 5f63   = [cca[self.__c
+00089000: 6355 2e63 6361 4174 6f6d 4964 5d20 666f  cU.ccaAtomId] fo
+00089010: 7220 6363 6120 696e 2073 656c 662e 5f5f  r cca in self.__
+00089020: 6363 552e 6c61 7374 4174 6f6d 4c69 7374  ccU.lastAtomList
+00089030: 2069 6620 6363 615b 7365 6c66 2e5f 5f63   if cca[self.__c
+00089040: 6355 2e63 6361 4c65 6176 696e 6741 746f  cU.ccaLeavingAto
+00089050: 6d46 6c61 675d 2021 3d20 2759 275d 0a20  mFlag] != 'Y']. 
 00089060: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00089070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00089080: 2020 2020 6966 2073 656c 662e 5f5f 6363      if self.__cc
-00089090: 552e 7570 6461 7465 4368 656d 436f 6d70  U.updateChemComp
-000890a0: 4469 6374 2863 6f6d 7049 6429 3a0a 2020  Dict(compId):.  
+00089080: 2020 2066 6f72 2061 746f 6d49 6420 696e     for atomId in
+00089090: 2061 746f 6d49 6473 3a0a 2020 2020 2020   atomIds:.      
+000890a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000890b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000890c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000890d0: 2020 2020 2020 2020 2020 6174 6f6d 4964            atomId
-000890e0: 7320 3d20 5b63 6361 5b73 656c 662e 5f5f  s = [cca[self.__
-000890f0: 6363 552e 6363 6141 746f 6d49 645d 2066  ccU.ccaAtomId] f
-00089100: 6f72 2063 6361 2069 6e20 7365 6c66 2e5f  or cca in self._
-00089110: 5f63 6355 2e6c 6173 7441 746f 6d4c 6973  _ccU.lastAtomLis
-00089120: 7420 6966 2063 6361 5b73 656c 662e 5f5f  t if cca[self.__
-00089130: 6363 552e 6363 614c 6561 7669 6e67 4174  ccU.ccaLeavingAt
-00089140: 6f6d 466c 6167 5d20 213d 2027 5927 5d0a  omFlag] != 'Y'].
-00089150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000890c0: 2020 5f61 746f 6d53 656c 6563 7469 6f6e    _atomSelection
+000890d0: 2e61 7070 656e 6428 7b27 6368 6169 6e5f  .append({'chain_
+000890e0: 6964 273a 2063 6861 696e 4964 2c20 2773  id': chainId, 's
+000890f0: 6571 5f69 6427 3a20 7365 7149 642c 2027  eq_id': seqId, '
+00089100: 636f 6d70 5f69 6427 3a20 636f 6d70 4964  comp_id': compId
+00089110: 2c20 2761 746f 6d5f 6964 273a 2061 746f  , 'atom_id': ato
+00089120: 6d49 647d 290a 2020 2020 2020 2020 2020  mId}).          
+00089130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00089140: 2020 6966 2073 656c 662e 5f5f 6861 734e    if self.__hasN
+00089150: 6f6e 506f 6c79 5365 713a 0a20 2020 2020  onPolySeq:.     
 00089160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00089170: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00089180: 6174 6f6d 4964 2069 6e20 6174 6f6d 4964  atomId in atomId
-00089190: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-000891a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000891b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000891c0: 2020 205f 6174 6f6d 5365 6c65 6374 696f     _atomSelectio
-000891d0: 6e2e 6170 7065 6e64 287b 2763 6861 696e  n.append({'chain
-000891e0: 5f69 6427 3a20 6368 6169 6e49 642c 2027  _id': chainId, '
-000891f0: 7365 715f 6964 273a 2073 6571 4964 2c20  seq_id': seqId, 
-00089200: 2763 6f6d 705f 6964 273a 2063 6f6d 7049  'comp_id': compI
-00089210: 642c 2027 6174 6f6d 5f69 6427 3a20 6174  d, 'atom_id': at
-00089220: 6f6d 4964 7d29 0a0a 2020 2020 2020 2020  omId})..        
-00089230: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00089240: 2e66 6163 746f 725b 2761 746f 6d5f 7365  .factor['atom_se
-00089250: 6c65 6374 696f 6e27 5d20 3d20 5b64 6963  lection'] = [dic
-00089260: 7428 7329 2066 6f72 2073 2069 6e20 7365  t(s) for s in se
-00089270: 7428 6672 6f7a 656e 7365 7428 6174 6f6d  t(frozenset(atom
-00089280: 2e69 7465 6d73 2829 2920 666f 7220 6174  .items()) for at
-00089290: 6f6d 2069 6e20 5f61 746f 6d53 656c 6563  om in _atomSelec
-000892a0: 7469 6f6e 295d 0a0a 2020 2020 2020 2020  tion)]..        
-000892b0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-000892c0: 656e 2873 656c 662e 6661 6374 6f72 5b27  en(self.factor['
-000892d0: 6174 6f6d 5f73 656c 6563 7469 6f6e 275d  atom_selection']
-000892e0: 2920 3d3d 2030 3a0a 2020 2020 2020 2020  ) == 0:.        
-000892f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00089300: 7365 6c66 2e66 6163 746f 725b 2761 746f  self.factor['ato
-00089310: 6d5f 6964 275d 203d 205b 4e6f 6e65 5d0a  m_id'] = [None].
+00089170: 2020 2020 2020 2020 2020 206e 704c 6973             npLis
+00089180: 7420 3d20 5b6e 7020 666f 7220 6e70 2069  t = [np for np i
+00089190: 6e20 7365 6c66 2e5f 5f6e 6f6e 506f 6c79  n self.__nonPoly
+000891a0: 5365 7120 6966 206e 705b 2761 7574 685f  Seq if np['auth_
+000891b0: 6368 6169 6e5f 6964 275d 203d 3d20 6368  chain_id'] == ch
+000891c0: 6169 6e49 645d 0a20 2020 2020 2020 2020  ainId].         
+000891d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000891e0: 2020 2020 2020 2066 6f72 206e 7020 696e         for np in
+000891f0: 206e 704c 6973 743a 0a20 2020 2020 2020   npList:.       
+00089200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00089210: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00089220: 7365 7149 6420 696e 206e 705b 2761 7574  seqId in np['aut
+00089230: 685f 7365 715f 6964 275d 2061 6e64 206e  h_seq_id'] and n
+00089240: 705b 2763 6f6d 705f 6964 275d 5b6e 705b  p['comp_id'][np[
+00089250: 2761 7574 685f 7365 715f 6964 275d 2e69  'auth_seq_id'].i
+00089260: 6e64 6578 2873 6571 4964 295d 203d 3d20  ndex(seqId)] == 
+00089270: 636f 6d70 4964 3a0a 2020 2020 2020 2020  compId:.        
+00089280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00089290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000892a0: 7365 7149 6420 3d20 7365 6c66 2e67 6574  seqId = self.get
+000892b0: 5265 616c 5365 7149 6428 6e70 2c20 7365  RealSeqId(np, se
+000892c0: 7149 642c 2046 616c 7365 290a 2020 2020  qId, False).    
+000892d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000892e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000892f0: 2020 2020 6966 2073 656c 662e 5f5f 6363      if self.__cc
+00089300: 552e 7570 6461 7465 4368 656d 436f 6d70  U.updateChemComp
+00089310: 4469 6374 2863 6f6d 7049 6429 3a0a 2020  Dict(compId):.  
 00089320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00089330: 2020 2020 2020 2020 7365 6c66 2e5f 5f66          self.__f
-00089340: 2e61 7070 656e 6428 6622 5b49 6e73 7566  .append(f"[Insuf
-00089350: 6669 6369 656e 7420 6174 6f6d 2073 656c  ficient atom sel
-00089360: 6563 7469 6f6e 5d20 7b73 656c 662e 5f5f  ection] {self.__
-00089370: 6765 7443 7572 7265 6e74 5265 7374 7261  getCurrentRestra
-00089380: 696e 7428 297d 220a 2020 2020 2020 2020  int()}".        
-00089390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000893a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000893b0: 2254 6865 2027 6279 7265 7327 2063 6c61  "The 'byres' cla
-000893c0: 7573 6520 6861 7320 6e6f 2065 6666 6563  use has no effec
-000893d0: 742e 2229 0a0a 2020 2020 2020 2020 2020  t.")..          
-000893e0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-000893f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00089400: 7365 6c66 2e66 6163 746f 725b 2761 746f  self.factor['ato
-00089410: 6d5f 6964 275d 203d 205b 4e6f 6e65 5d0a  m_id'] = [None].
+00089330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00089340: 2020 2020 2020 2020 2020 6174 6f6d 4964            atomId
+00089350: 7320 3d20 5b63 6361 5b73 656c 662e 5f5f  s = [cca[self.__
+00089360: 6363 552e 6363 6141 746f 6d49 645d 2066  ccU.ccaAtomId] f
+00089370: 6f72 2063 6361 2069 6e20 7365 6c66 2e5f  or cca in self._
+00089380: 5f63 6355 2e6c 6173 7441 746f 6d4c 6973  _ccU.lastAtomLis
+00089390: 7420 6966 2063 6361 5b73 656c 662e 5f5f  t if cca[self.__
+000893a0: 6363 552e 6363 614c 6561 7669 6e67 4174  ccU.ccaLeavingAt
+000893b0: 6f6d 466c 6167 5d20 213d 2027 5927 5d0a  omFlag] != 'Y'].
+000893c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000893d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000893e0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+000893f0: 6174 6f6d 4964 2069 6e20 6174 6f6d 4964  atomId in atomId
+00089400: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+00089410: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00089420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00089430: 2020 2020 7365 6c66 2e5f 5f66 2e61 7070      self.__f.app
-00089440: 656e 6428 6622 5b49 6e73 7566 6669 6369  end(f"[Insuffici
-00089450: 656e 7420 6174 6f6d 2073 656c 6563 7469  ent atom selecti
-00089460: 6f6e 5d20 7b73 656c 662e 5f5f 6765 7443  on] {self.__getC
-00089470: 7572 7265 6e74 5265 7374 7261 696e 7428  urrentRestraint(
-00089480: 297d 220a 2020 2020 2020 2020 2020 2020  )}".            
-00089490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000894a0: 2020 2020 2020 2020 2254 6865 2027 6279          "The 'by
-000894b0: 7265 7327 2063 6c61 7573 6520 6861 7320  res' clause has 
-000894c0: 6e6f 2065 6666 6563 7420 6265 6361 7573  no effect becaus
-000894d0: 6520 6e6f 2061 746f 6d20 6973 2073 656c  e no atom is sel
-000894e0: 6563 7465 642e 2229 0a0a 2020 2020 2020  ected.")..      
-000894f0: 2020 2020 2020 656c 6966 2063 7478 2e43        elif ctx.C
-00089500: 6865 6d69 6361 6c28 293a 0a20 2020 2020  hemical():.     
-00089510: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00089520: 6c66 2e5f 5f73 656c 5f65 7870 725f 6465  lf.__sel_expr_de
-00089530: 6275 673a 0a20 2020 2020 2020 2020 2020  bug:.           
-00089540: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
-00089550: 2020 2220 2a20 7365 6c66 2e64 6570 7468    " * self.depth
-00089560: 202b 2022 2d2d 3e20 6368 656d 6963 616c   + "--> chemical
-00089570: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
-00089580: 2020 2069 6620 6374 782e 436f 6c6f 6e28     if ctx.Colon(
-00089590: 293a 2020 2320 7261 6e67 6520 6578 7072  ):  # range expr
-000895a0: 6573 7369 6f6e 0a20 2020 2020 2020 2020  ession.         
-000895b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000895c0: 6661 6374 6f72 5b27 7479 7065 5f73 796d  factor['type_sym
-000895d0: 626f 6c73 275d 203d 205b 7374 7228 6374  bols'] = [str(ct
-000895e0: 782e 5369 6d70 6c65 5f6e 616d 6528 3029  x.Simple_name(0)
-000895f0: 292e 7570 7065 7228 292c 2073 7472 2863  ).upper(), str(c
-00089600: 7478 2e53 696d 706c 655f 6e61 6d65 2831  tx.Simple_name(1
-00089610: 2929 2e75 7070 6572 2829 5d0a 0a20 2020  )).upper()]..   
-00089620: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-00089630: 6620 6374 782e 5369 6d70 6c65 5f6e 616d  f ctx.Simple_nam
-00089640: 6528 3029 3a0a 2020 2020 2020 2020 2020  e(0):.          
-00089650: 2020 2020 2020 2020 2020 7365 6c66 2e66            self.f
-00089660: 6163 746f 725b 2774 7970 655f 7379 6d62  actor['type_symb
-00089670: 6f6c 275d 203d 205b 7374 7228 6374 782e  ol'] = [str(ctx.
-00089680: 5369 6d70 6c65 5f6e 616d 6528 3029 292e  Simple_name(0)).
-00089690: 7570 7065 7228 295d 0a0a 2020 2020 2020  upper()]..      
-000896a0: 2020 2020 2020 2020 2020 656c 6966 2063            elif c
-000896b0: 7478 2e53 696d 706c 655f 6e61 6d65 7328  tx.Simple_names(
-000896c0: 3029 3a0a 2020 2020 2020 2020 2020 2020  0):.            
-000896d0: 2020 2020 2020 2020 7365 6c66 2e66 6163          self.fac
-000896e0: 746f 725b 2774 7970 655f 7379 6d62 6f6c  tor['type_symbol
-000896f0: 7327 5d20 3d20 5b73 7472 2863 7478 2e53  s'] = [str(ctx.S
-00089700: 696d 706c 655f 6e61 6d65 7328 3029 292e  imple_names(0)).
-00089710: 7570 7065 7228 295d 0a0a 2020 2020 2020  upper()]..      
-00089720: 2020 2020 2020 2020 2020 656c 6966 2063            elif c
-00089730: 7478 2e53 796d 626f 6c5f 6e61 6d65 2829  tx.Symbol_name()
-00089740: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00089750: 2020 2020 2020 7379 6d62 6f6c 5f6e 616d        symbol_nam
-00089760: 6520 3d20 7374 7228 6374 782e 5379 6d62  e = str(ctx.Symb
-00089770: 6f6c 5f6e 616d 6528 2929 0a20 2020 2020  ol_name()).     
-00089780: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00089790: 6620 7379 6d62 6f6c 5f6e 616d 6520 696e  f symbol_name in
-000897a0: 2073 656c 662e 6576 616c 7561 7465 3a0a   self.evaluate:.
-000897b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000897c0: 2020 2020 2020 2020 7661 6c20 3d20 7365          val = se
-000897d0: 6c66 2e65 7661 6c75 6174 655b 7379 6d62  lf.evaluate[symb
-000897e0: 6f6c 5f6e 616d 655d 0a20 2020 2020 2020  ol_name].       
-000897f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00089800: 2069 6620 6973 696e 7374 616e 6365 2876   if isinstance(v
-00089810: 616c 2c20 6c69 7374 293a 0a20 2020 2020  al, list):.     
-00089820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00089830: 2020 2020 2020 2073 656c 662e 6661 6374         self.fact
-00089840: 6f72 5b27 7479 7065 5f73 796d 626f 6c27  or['type_symbol'
-00089850: 5d20 3d20 5b76 2e75 7070 6572 2829 2066  ] = [v.upper() f
-00089860: 6f72 2076 2069 6e20 7661 6c5d 0a20 2020  or v in val].   
-00089870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00089880: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00089890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000898a0: 2020 2020 2020 2073 656c 662e 6661 6374         self.fact
-000898b0: 6f72 5b27 7479 7065 5f73 796d 626f 6c27  or['type_symbol'
-000898c0: 5d20 3d20 5b76 616c 2e75 7070 6572 2829  ] = [val.upper()
-000898d0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-000898e0: 2020 2020 2020 656c 6966 2073 796d 626f        elif symbo
-000898f0: 6c5f 6e61 6d65 2069 6e20 7365 6c66 2e65  l_name in self.e
-00089900: 7661 6c75 6174 6546 6f72 3a0a 2020 2020  valuateFor:.    
-00089910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00089920: 2020 2020 7661 6c20 3d20 7365 6c66 2e65      val = self.e
-00089930: 7661 6c75 6174 6546 6f72 5b73 796d 626f  valuateFor[symbo
-00089940: 6c5f 6e61 6d65 5d0a 2020 2020 2020 2020  l_name].        
-00089950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00089960: 6966 2069 7369 6e73 7461 6e63 6528 7661  if isinstance(va
-00089970: 6c2c 206c 6973 7429 3a0a 2020 2020 2020  l, list):.      
-00089980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00089990: 2020 2020 2020 7365 6c66 2e66 6163 746f        self.facto
-000899a0: 725b 2774 7970 655f 7379 6d62 6f6c 275d  r['type_symbol']
-000899b0: 203d 205b 762e 7570 7065 7228 2920 666f   = [v.upper() fo
-000899c0: 7220 7620 696e 2076 616c 5d0a 2020 2020  r v in val].    
-000899d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000899e0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-000899f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00089a00: 2020 2020 2020 7365 6c66 2e66 6163 746f        self.facto
-00089a10: 725b 2774 7970 655f 7379 6d62 6f6c 275d  r['type_symbol']
-00089a20: 203d 205b 7661 6c2e 7570 7065 7228 295d   = [val.upper()]
-00089a30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00089a40: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00089a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00089a60: 2020 2073 656c 662e 5f5f 662e 6170 7065     self.__f.appe
-00089a70: 6e64 2866 225b 556e 7375 7070 6f72 7465  nd(f"[Unsupporte
-00089a80: 6420 6461 7461 5d20 7b73 656c 662e 5f5f  d data] {self.__
-00089a90: 6765 7443 7572 7265 6e74 5265 7374 7261  getCurrentRestra
-00089aa0: 696e 7428 297d 220a 2020 2020 2020 2020  int()}".        
-00089ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00089ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00089ad0: 6622 5468 6520 7379 6d62 6f6c 207b 7379  f"The symbol {sy
-00089ae0: 6d62 6f6c 5f6e 616d 6521 727d 2069 7320  mbol_name!r} is 
-00089af0: 6e6f 7420 6465 6669 6e65 642e 2229 0a0a  not defined.")..
+00089430: 2020 205f 6174 6f6d 5365 6c65 6374 696f     _atomSelectio
+00089440: 6e2e 6170 7065 6e64 287b 2763 6861 696e  n.append({'chain
+00089450: 5f69 6427 3a20 6368 6169 6e49 642c 2027  _id': chainId, '
+00089460: 7365 715f 6964 273a 2073 6571 4964 2c20  seq_id': seqId, 
+00089470: 2763 6f6d 705f 6964 273a 2063 6f6d 7049  'comp_id': compI
+00089480: 642c 2027 6174 6f6d 5f69 6427 3a20 6174  d, 'atom_id': at
+00089490: 6f6d 4964 7d29 0a0a 2020 2020 2020 2020  omId})..        
+000894a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000894b0: 2e66 6163 746f 725b 2761 746f 6d5f 7365  .factor['atom_se
+000894c0: 6c65 6374 696f 6e27 5d20 3d20 5b64 6963  lection'] = [dic
+000894d0: 7428 7329 2066 6f72 2073 2069 6e20 7365  t(s) for s in se
+000894e0: 7428 6672 6f7a 656e 7365 7428 6174 6f6d  t(frozenset(atom
+000894f0: 2e69 7465 6d73 2829 2920 666f 7220 6174  .items()) for at
+00089500: 6f6d 2069 6e20 5f61 746f 6d53 656c 6563  om in _atomSelec
+00089510: 7469 6f6e 295d 0a0a 2020 2020 2020 2020  tion)]..        
+00089520: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+00089530: 656e 2873 656c 662e 6661 6374 6f72 5b27  en(self.factor['
+00089540: 6174 6f6d 5f73 656c 6563 7469 6f6e 275d  atom_selection']
+00089550: 2920 3d3d 2030 3a0a 2020 2020 2020 2020  ) == 0:.        
+00089560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00089570: 7365 6c66 2e66 6163 746f 725b 2761 746f  self.factor['ato
+00089580: 6d5f 6964 275d 203d 205b 4e6f 6e65 5d0a  m_id'] = [None].
+00089590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000895a0: 2020 2020 2020 2020 7365 6c66 2e5f 5f66          self.__f
+000895b0: 2e61 7070 656e 6428 6622 5b49 6e73 7566  .append(f"[Insuf
+000895c0: 6669 6369 656e 7420 6174 6f6d 2073 656c  ficient atom sel
+000895d0: 6563 7469 6f6e 5d20 7b73 656c 662e 5f5f  ection] {self.__
+000895e0: 6765 7443 7572 7265 6e74 5265 7374 7261  getCurrentRestra
+000895f0: 696e 7428 297d 220a 2020 2020 2020 2020  int()}".        
+00089600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00089610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00089620: 2254 6865 2027 6279 7265 7327 2063 6c61  "The 'byres' cla
+00089630: 7573 6520 6861 7320 6e6f 2065 6666 6563  use has no effec
+00089640: 742e 2229 0a0a 2020 2020 2020 2020 2020  t.")..          
+00089650: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00089660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00089670: 7365 6c66 2e66 6163 746f 725b 2761 746f  self.factor['ato
+00089680: 6d5f 6964 275d 203d 205b 4e6f 6e65 5d0a  m_id'] = [None].
+00089690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000896a0: 2020 2020 7365 6c66 2e5f 5f66 2e61 7070      self.__f.app
+000896b0: 656e 6428 6622 5b49 6e73 7566 6669 6369  end(f"[Insuffici
+000896c0: 656e 7420 6174 6f6d 2073 656c 6563 7469  ent atom selecti
+000896d0: 6f6e 5d20 7b73 656c 662e 5f5f 6765 7443  on] {self.__getC
+000896e0: 7572 7265 6e74 5265 7374 7261 696e 7428  urrentRestraint(
+000896f0: 297d 220a 2020 2020 2020 2020 2020 2020  )}".            
+00089700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00089710: 2020 2020 2020 2020 2254 6865 2027 6279          "The 'by
+00089720: 7265 7327 2063 6c61 7573 6520 6861 7320  res' clause has 
+00089730: 6e6f 2065 6666 6563 7420 6265 6361 7573  no effect becaus
+00089740: 6520 6e6f 2061 746f 6d20 6973 2073 656c  e no atom is sel
+00089750: 6563 7465 642e 2229 0a0a 2020 2020 2020  ected.")..      
+00089760: 2020 2020 2020 656c 6966 2063 7478 2e43        elif ctx.C
+00089770: 6865 6d69 6361 6c28 293a 0a20 2020 2020  hemical():.     
+00089780: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00089790: 6c66 2e5f 5f73 656c 5f65 7870 725f 6465  lf.__sel_expr_de
+000897a0: 6275 673a 0a20 2020 2020 2020 2020 2020  bug:.           
+000897b0: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
+000897c0: 2020 2220 2a20 7365 6c66 2e64 6570 7468    " * self.depth
+000897d0: 202b 2022 2d2d 3e20 6368 656d 6963 616c   + "--> chemical
+000897e0: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+000897f0: 2020 2069 6620 6374 782e 436f 6c6f 6e28     if ctx.Colon(
+00089800: 293a 2020 2320 7261 6e67 6520 6578 7072  ):  # range expr
+00089810: 6573 7369 6f6e 0a20 2020 2020 2020 2020  ession.         
+00089820: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00089830: 6661 6374 6f72 5b27 7479 7065 5f73 796d  factor['type_sym
+00089840: 626f 6c73 275d 203d 205b 7374 7228 6374  bols'] = [str(ct
+00089850: 782e 5369 6d70 6c65 5f6e 616d 6528 3029  x.Simple_name(0)
+00089860: 292e 7570 7065 7228 292c 2073 7472 2863  ).upper(), str(c
+00089870: 7478 2e53 696d 706c 655f 6e61 6d65 2831  tx.Simple_name(1
+00089880: 2929 2e75 7070 6572 2829 5d0a 0a20 2020  )).upper()]..   
+00089890: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+000898a0: 6620 6374 782e 5369 6d70 6c65 5f6e 616d  f ctx.Simple_nam
+000898b0: 6528 3029 3a0a 2020 2020 2020 2020 2020  e(0):.          
+000898c0: 2020 2020 2020 2020 2020 7365 6c66 2e66            self.f
+000898d0: 6163 746f 725b 2774 7970 655f 7379 6d62  actor['type_symb
+000898e0: 6f6c 275d 203d 205b 7374 7228 6374 782e  ol'] = [str(ctx.
+000898f0: 5369 6d70 6c65 5f6e 616d 6528 3029 292e  Simple_name(0)).
+00089900: 7570 7065 7228 295d 0a0a 2020 2020 2020  upper()]..      
+00089910: 2020 2020 2020 2020 2020 656c 6966 2063            elif c
+00089920: 7478 2e53 696d 706c 655f 6e61 6d65 7328  tx.Simple_names(
+00089930: 3029 3a0a 2020 2020 2020 2020 2020 2020  0):.            
+00089940: 2020 2020 2020 2020 7365 6c66 2e66 6163          self.fac
+00089950: 746f 725b 2774 7970 655f 7379 6d62 6f6c  tor['type_symbol
+00089960: 7327 5d20 3d20 5b73 7472 2863 7478 2e53  s'] = [str(ctx.S
+00089970: 696d 706c 655f 6e61 6d65 7328 3029 292e  imple_names(0)).
+00089980: 7570 7065 7228 295d 0a0a 2020 2020 2020  upper()]..      
+00089990: 2020 2020 2020 2020 2020 656c 6966 2063            elif c
+000899a0: 7478 2e53 796d 626f 6c5f 6e61 6d65 2829  tx.Symbol_name()
+000899b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000899c0: 2020 2020 2020 7379 6d62 6f6c 5f6e 616d        symbol_nam
+000899d0: 6520 3d20 7374 7228 6374 782e 5379 6d62  e = str(ctx.Symb
+000899e0: 6f6c 5f6e 616d 6528 2929 0a20 2020 2020  ol_name()).     
+000899f0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00089a00: 6620 7379 6d62 6f6c 5f6e 616d 6520 696e  f symbol_name in
+00089a10: 2073 656c 662e 6576 616c 7561 7465 3a0a   self.evaluate:.
+00089a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00089a30: 2020 2020 2020 2020 7661 6c20 3d20 7365          val = se
+00089a40: 6c66 2e65 7661 6c75 6174 655b 7379 6d62  lf.evaluate[symb
+00089a50: 6f6c 5f6e 616d 655d 0a20 2020 2020 2020  ol_name].       
+00089a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00089a70: 2069 6620 6973 696e 7374 616e 6365 2876   if isinstance(v
+00089a80: 616c 2c20 6c69 7374 293a 0a20 2020 2020  al, list):.     
+00089a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00089aa0: 2020 2020 2020 2073 656c 662e 6661 6374         self.fact
+00089ab0: 6f72 5b27 7479 7065 5f73 796d 626f 6c27  or['type_symbol'
+00089ac0: 5d20 3d20 5b76 2e75 7070 6572 2829 2066  ] = [v.upper() f
+00089ad0: 6f72 2076 2069 6e20 7661 6c5d 0a20 2020  or v in val].   
+00089ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00089af0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
 00089b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00089b10: 7365 6c66 2e63 6f6e 7375 6d65 4661 6374  self.consumeFact
-00089b20: 6f72 5f65 7870 7265 7373 696f 6e73 2822  or_expressions("
-00089b30: 2763 6865 6d69 6361 6c27 2063 6c61 7573  'chemical' claus
-00089b40: 6522 2c20 4661 6c73 6529 0a0a 2020 2020  e", False)..    
-00089b50: 2020 2020 2020 2020 656c 6966 2063 7478          elif ctx
-00089b60: 2e48 7964 726f 6765 6e28 293a 0a20 2020  .Hydrogen():.   
-00089b70: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00089b80: 7365 6c66 2e5f 5f73 656c 5f65 7870 725f  self.__sel_expr_
-00089b90: 6465 6275 673a 0a20 2020 2020 2020 2020  debug:.         
-00089ba0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00089bb0: 2822 2020 2220 2a20 7365 6c66 2e64 6570  ("  " * self.dep
-00089bc0: 7468 202b 2022 2d2d 3e20 6879 6472 6f67  th + "--> hydrog
-00089bd0: 656e 2229 0a20 2020 2020 2020 2020 2020  en").           
-00089be0: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
-00089bf0: 2e5f 5f68 6173 436f 6f72 643a 0a20 2020  .__hasCoord:.   
-00089c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00089c10: 2072 6574 7572 6e0a 2020 2020 2020 2020   return.        
-00089c20: 2020 2020 2020 2020 5f74 7970 6553 796d          _typeSym
-00089c30: 626f 6c53 656c 6563 7420 3d20 7365 7428  bolSelect = set(
-00089c40: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00089c50: 2020 6174 6f6d 5479 7065 7320 3d20 7365    atomTypes = se
-00089c60: 6c66 2e5f 5f63 522e 6765 7444 6963 744c  lf.__cR.getDictL
-00089c70: 6973 7428 2761 746f 6d5f 7479 7065 2729  ist('atom_type')
-00089c80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00089c90: 2069 6620 6c65 6e28 6174 6f6d 5479 7065   if len(atomType
-00089ca0: 7329 203e 2030 2061 6e64 2027 7379 6d62  s) > 0 and 'symb
-00089cb0: 6f6c 2720 696e 2061 746f 6d54 7970 6573  ol' in atomTypes
-00089cc0: 5b30 5d3a 0a20 2020 2020 2020 2020 2020  [0]:.           
-00089cd0: 2020 2020 2020 2020 2066 6f72 2061 746f           for ato
-00089ce0: 6d54 7970 6520 696e 2061 746f 6d54 7970  mType in atomTyp
-00089cf0: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-00089d00: 2020 2020 2020 2020 2020 2020 7479 7065              type
-00089d10: 5379 6d62 6f6c 203d 2061 746f 6d54 7970  Symbol = atomTyp
-00089d20: 655b 2773 796d 626f 6c27 5d0a 2020 2020  e['symbol'].    
+00089b10: 2020 2020 2020 2073 656c 662e 6661 6374         self.fact
+00089b20: 6f72 5b27 7479 7065 5f73 796d 626f 6c27  or['type_symbol'
+00089b30: 5d20 3d20 5b76 616c 2e75 7070 6572 2829  ] = [val.upper()
+00089b40: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00089b50: 2020 2020 2020 656c 6966 2073 796d 626f        elif symbo
+00089b60: 6c5f 6e61 6d65 2069 6e20 7365 6c66 2e65  l_name in self.e
+00089b70: 7661 6c75 6174 6546 6f72 3a0a 2020 2020  valuateFor:.    
+00089b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00089b90: 2020 2020 7661 6c20 3d20 7365 6c66 2e65      val = self.e
+00089ba0: 7661 6c75 6174 6546 6f72 5b73 796d 626f  valuateFor[symbo
+00089bb0: 6c5f 6e61 6d65 5d0a 2020 2020 2020 2020  l_name].        
+00089bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00089bd0: 6966 2069 7369 6e73 7461 6e63 6528 7661  if isinstance(va
+00089be0: 6c2c 206c 6973 7429 3a0a 2020 2020 2020  l, list):.      
+00089bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00089c00: 2020 2020 2020 7365 6c66 2e66 6163 746f        self.facto
+00089c10: 725b 2774 7970 655f 7379 6d62 6f6c 275d  r['type_symbol']
+00089c20: 203d 205b 762e 7570 7065 7228 2920 666f   = [v.upper() fo
+00089c30: 7220 7620 696e 2076 616c 5d0a 2020 2020  r v in val].    
+00089c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00089c50: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00089c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00089c70: 2020 2020 2020 7365 6c66 2e66 6163 746f        self.facto
+00089c80: 725b 2774 7970 655f 7379 6d62 6f6c 275d  r['type_symbol']
+00089c90: 203d 205b 7661 6c2e 7570 7065 7228 295d   = [val.upper()]
+00089ca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00089cb0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00089cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00089cd0: 2020 2073 656c 662e 5f5f 662e 6170 7065     self.__f.appe
+00089ce0: 6e64 2866 225b 556e 7375 7070 6f72 7465  nd(f"[Unsupporte
+00089cf0: 6420 6461 7461 5d20 7b73 656c 662e 5f5f  d data] {self.__
+00089d00: 6765 7443 7572 7265 6e74 5265 7374 7261  getCurrentRestra
+00089d10: 696e 7428 297d 220a 2020 2020 2020 2020  int()}".        
+00089d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00089d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00089d40: 2020 2020 6174 6f6d 6963 4e75 6d62 6572      atomicNumber
-00089d50: 203d 2069 6e74 5f61 746f 6d28 7479 7065   = int_atom(type
-00089d60: 5379 6d62 6f6c 290a 2020 2020 2020 2020  Symbol).        
+00089d40: 6622 5468 6520 7379 6d62 6f6c 207b 7379  f"The symbol {sy
+00089d50: 6d62 6f6c 5f6e 616d 6521 727d 2069 7320  mbol_name!r} is 
+00089d60: 6e6f 7420 6465 6669 6e65 642e 2229 0a0a  not defined.")..
 00089d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00089d80: 6174 6f6d 6963 5765 6967 6874 203d 2045  atomicWeight = E
-00089d90: 4c45 4d45 4e54 5f57 4549 4748 5453 5b61  LEMENT_WEIGHTS[a
-00089da0: 746f 6d69 634e 756d 6265 725d 0a20 2020  tomicNumber].   
-00089db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00089dc0: 2020 2020 2069 6620 6174 6f6d 6963 5765       if atomicWe
-00089dd0: 6967 6874 203c 2033 2e35 3a0a 2020 2020  ight < 3.5:.    
-00089de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00089df0: 2020 2020 2020 2020 5f74 7970 6553 796d          _typeSym
-00089e00: 626f 6c53 656c 6563 742e 6164 6428 7479  bolSelect.add(ty
-00089e10: 7065 5379 6d62 6f6c 290a 0a20 2020 2020  peSymbol)..     
-00089e20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00089e30: 6661 6374 6f72 5b27 7479 7065 5f73 796d  factor['type_sym
-00089e40: 626f 6c27 5d20 3d20 6c69 7374 285f 7479  bol'] = list(_ty
-00089e50: 7065 5379 6d62 6f6c 5365 6c65 6374 290a  peSymbolSelect).
-00089e60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00089e70: 2073 656c 662e 636f 6e73 756d 6546 6163   self.consumeFac
-00089e80: 746f 725f 6578 7072 6573 7369 6f6e 7328  tor_expressions(
-00089e90: 2227 6879 6472 6f67 656e 2720 636c 6175  "'hydrogen' clau
-00089ea0: 7365 222c 2046 616c 7365 290a 0a20 2020  se", False)..   
-00089eb0: 2020 2020 2020 2020 2065 6c69 6620 6374           elif ct
-00089ec0: 782e 4964 2829 3a0a 2020 2020 2020 2020  x.Id():.        
-00089ed0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00089ee0: 5f5f 7365 6c5f 6578 7072 5f64 6562 7567  __sel_expr_debug
-00089ef0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00089f00: 2020 2020 2020 7072 696e 7428 2220 2022        print("  "
-00089f10: 202a 2073 656c 662e 6465 7074 6820 2b20   * self.depth + 
-00089f20: 222d 2d3e 2069 6422 290a 2020 2020 2020  "--> id").      
-00089f30: 2020 2020 2020 2020 2020 7365 6c66 2e66            self.f
-00089f40: 6163 746f 725b 2761 746f 6d5f 6964 275d  actor['atom_id']
-00089f50: 203d 205b 4e6f 6e65 5d0a 2020 2020 2020   = [None].      
-00089f60: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00089f70: 5f66 2e61 7070 656e 6428 6622 5b55 6e73  _f.append(f"[Uns
-00089f80: 7570 706f 7274 6564 2064 6174 615d 207b  upported data] {
-00089f90: 7365 6c66 2e5f 5f67 6574 4375 7272 656e  self.__getCurren
-00089fa0: 7452 6573 7472 6169 6e74 2829 7d22 0a20  tRestraint()}". 
-00089fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00089fc0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00089fd0: 5468 6520 2769 6427 2063 6c61 7573 6520  The 'id' clause 
-00089fe0: 6861 7320 6e6f 2065 6666 6563 7420 220a  has no effect ".
-00089ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008a000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008a010: 2262 6563 6175 7365 2074 6865 2069 6e74  "because the int
-0008a020: 6572 6e61 6c20 6174 6f6d 206e 756d 6265  ernal atom numbe
-0008a030: 7220 6973 206e 6f74 2069 6e63 6c75 6465  r is not include
-0008a040: 6420 696e 2074 6865 2063 6f6f 7264 696e  d in the coordin
-0008a050: 6174 6520 6669 6c65 2e22 290a 0a20 2020  ate file.")..   
-0008a060: 2020 2020 2020 2020 2065 6c69 6620 6374           elif ct
-0008a070: 782e 4e61 6d65 2829 3a0a 2020 2020 2020  x.Name():.      
-0008a080: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-0008a090: 662e 5f5f 7365 6c5f 6578 7072 5f64 6562  f.__sel_expr_deb
-0008a0a0: 7567 3a0a 2020 2020 2020 2020 2020 2020  ug:.            
-0008a0b0: 2020 2020 2020 2020 7072 696e 7428 2220          print(" 
-0008a0c0: 2022 202a 2073 656c 662e 6465 7074 6820   " * self.depth 
-0008a0d0: 2b20 222d 2d3e 206e 616d 6522 290a 0a20  + "--> name").. 
-0008a0e0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0008a0f0: 7661 6c5f 6661 6374 6f72 203d 2046 616c  val_factor = Fal
-0008a100: 7365 0a20 2020 2020 2020 2020 2020 2020  se.             
-0008a110: 2020 2069 6620 2761 746f 6d5f 6964 2720     if 'atom_id' 
-0008a120: 696e 2073 656c 662e 6661 6374 6f72 206f  in self.factor o
-0008a130: 7220 2761 746f 6d5f 6964 7327 2069 6e20  r 'atom_ids' in 
-0008a140: 7365 6c66 2e66 6163 746f 723a 0a20 2020  self.factor:.   
-0008a150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008a160: 205f 5f66 6163 746f 7220 3d20 636f 7079   __factor = copy
-0008a170: 2e63 6f70 7928 7365 6c66 2e66 6163 746f  .copy(self.facto
-0008a180: 7229 0a20 2020 2020 2020 2020 2020 2020  r).             
-0008a190: 2020 2020 2020 2073 656c 662e 636f 6e73         self.cons
-0008a1a0: 756d 6546 6163 746f 725f 6578 7072 6573  umeFactor_expres
-0008a1b0: 7369 6f6e 7328 2227 6e61 6d65 2720 636c  sions("'name' cl
-0008a1c0: 6175 7365 222c 2046 616c 7365 290a 2020  ause", False).  
-0008a1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008a1e0: 2020 6576 616c 5f66 6163 746f 7220 3d20    eval_factor = 
-0008a1f0: 5472 7565 0a0a 2020 2020 2020 2020 2020  True..          
-0008a200: 2020 2020 2020 6966 2063 7478 2e43 6f6c        if ctx.Col
-0008a210: 6f6e 2829 3a20 2023 2072 616e 6765 2065  on():  # range e
-0008a220: 7870 7265 7373 696f 6e0a 2020 2020 2020  xpression.      
-0008a230: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0008a240: 2063 7478 2e53 696d 706c 655f 6e61 6d65   ctx.Simple_name
-0008a250: 2830 293a 0a20 2020 2020 2020 2020 2020  (0):.           
-0008a260: 2020 2020 2020 2020 2020 2020 2062 6567               beg
-0008a270: 4174 6f6d 4964 203d 2073 7472 2863 7478  AtomId = str(ctx
-0008a280: 2e53 696d 706c 655f 6e61 6d65 2830 2929  .Simple_name(0))
-0008a290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0008a2a0: 2020 2020 2065 6c69 6620 6374 782e 446f       elif ctx.Do
-0008a2b0: 7562 6c65 5f71 756f 7465 5f73 7472 696e  uble_quote_strin
-0008a2c0: 6728 3029 3a0a 2020 2020 2020 2020 2020  g(0):.          
-0008a2d0: 2020 2020 2020 2020 2020 2020 2020 6265                be
-0008a2e0: 6741 746f 6d49 6420 3d20 7374 7228 6374  gAtomId = str(ct
-0008a2f0: 782e 446f 7562 6c65 5f71 756f 7465 5f73  x.Double_quote_s
-0008a300: 7472 696e 6728 3029 292e 7374 7269 7028  tring(0)).strip(
-0008a310: 2722 2729 2e73 7472 6970 2829 0a20 2020  '"').strip().   
-0008a320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008a330: 2020 2020 2069 6620 6c65 6e28 6265 6741       if len(begA
-0008a340: 746f 6d49 6429 203d 3d20 303a 0a20 2020  tomId) == 0:.   
-0008a350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008a360: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
-0008a370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008a380: 2020 2020 6966 2063 7478 2e53 696d 706c      if ctx.Simpl
-0008a390: 655f 6e61 6d65 2831 293a 0a20 2020 2020  e_name(1):.     
-0008a3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008a3b0: 2020 2065 6e64 4174 6f6d 4964 203d 2073     endAtomId = s
-0008a3c0: 7472 2863 7478 2e53 696d 706c 655f 6e61  tr(ctx.Simple_na
-0008a3d0: 6d65 2831 2929 0a20 2020 2020 2020 2020  me(1)).         
-0008a3e0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-0008a3f0: 6374 782e 446f 7562 6c65 5f71 756f 7465  ctx.Double_quote
-0008a400: 5f73 7472 696e 6728 3129 3a0a 2020 2020  _string(1):.    
-0008a410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008a420: 2020 2020 656e 6441 746f 6d49 6420 3d20      endAtomId = 
-0008a430: 7374 7228 6374 782e 446f 7562 6c65 5f71  str(ctx.Double_q
-0008a440: 756f 7465 5f73 7472 696e 6728 3129 292e  uote_string(1)).
-0008a450: 7374 7269 7028 2722 2729 2e73 7472 6970  strip('"').strip
-0008a460: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
-0008a470: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-0008a480: 6e28 656e 6441 746f 6d49 6429 203d 3d20  n(endAtomId) == 
-0008a490: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-0008a4a0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0008a4b0: 6574 7572 6e0a 2020 2020 2020 2020 2020  eturn.          
-0008a4c0: 2020 2020 2020 2020 2020 7365 6c66 2e66            self.f
-0008a4d0: 6163 746f 725b 2761 746f 6d5f 6964 7327  actor['atom_ids'
-0008a4e0: 5d20 3d20 5b62 6567 4174 6f6d 4964 2c20  ] = [begAtomId, 
-0008a4f0: 656e 6441 746f 6d49 645d 0a0a 2020 2020  endAtomId]..    
-0008a500: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-0008a510: 2063 7478 2e53 696d 706c 655f 6e61 6d65   ctx.Simple_name
-0008a520: 2830 2920 6f72 2063 7478 2e44 6f75 626c  (0) or ctx.Doubl
-0008a530: 655f 7175 6f74 655f 7374 7269 6e67 2830  e_quote_string(0
-0008a540: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0008a550: 2020 2020 2020 2069 6620 6374 782e 5369         if ctx.Si
-0008a560: 6d70 6c65 5f6e 616d 6528 3029 3a0a 2020  mple_name(0):.  
-0008a570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008a580: 2020 2020 2020 7365 6c66 2e66 6163 746f        self.facto
-0008a590: 725b 2761 746f 6d5f 6964 275d 203d 205b  r['atom_id'] = [
-0008a5a0: 7374 7228 6374 782e 5369 6d70 6c65 5f6e  str(ctx.Simple_n
-0008a5b0: 616d 6528 3029 295d 0a20 2020 2020 2020  ame(0))].       
-0008a5c0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-0008a5d0: 6620 6374 782e 446f 7562 6c65 5f71 756f  f ctx.Double_quo
-0008a5e0: 7465 5f73 7472 696e 6728 3029 3a0a 2020  te_string(0):.  
-0008a5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008a600: 2020 2020 2020 7365 6c66 2e66 6163 746f        self.facto
-0008a610: 725b 2761 746f 6d5f 6964 275d 203d 205b  r['atom_id'] = [
-0008a620: 7374 7228 6374 782e 446f 7562 6c65 5f71  str(ctx.Double_q
-0008a630: 756f 7465 5f73 7472 696e 6728 3029 292e  uote_string(0)).
-0008a640: 7374 7269 7028 2722 2729 2e73 7472 6970  strip('"').strip
-0008a650: 2829 5d0a 0a20 2020 2020 2020 2020 2020  ()]..           
-0008a660: 2020 2020 2065 6c69 6620 6374 782e 5369       elif ctx.Si
-0008a670: 6d70 6c65 5f6e 616d 6573 2830 293a 0a20  mple_names(0):. 
+00089d80: 7365 6c66 2e63 6f6e 7375 6d65 4661 6374  self.consumeFact
+00089d90: 6f72 5f65 7870 7265 7373 696f 6e73 2822  or_expressions("
+00089da0: 2763 6865 6d69 6361 6c27 2063 6c61 7573  'chemical' claus
+00089db0: 6522 2c20 4661 6c73 6529 0a0a 2020 2020  e", False)..    
+00089dc0: 2020 2020 2020 2020 656c 6966 2063 7478          elif ctx
+00089dd0: 2e48 7964 726f 6765 6e28 293a 0a20 2020  .Hydrogen():.   
+00089de0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00089df0: 7365 6c66 2e5f 5f73 656c 5f65 7870 725f  self.__sel_expr_
+00089e00: 6465 6275 673a 0a20 2020 2020 2020 2020  debug:.         
+00089e10: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00089e20: 2822 2020 2220 2a20 7365 6c66 2e64 6570  ("  " * self.dep
+00089e30: 7468 202b 2022 2d2d 3e20 6879 6472 6f67  th + "--> hydrog
+00089e40: 656e 2229 0a20 2020 2020 2020 2020 2020  en").           
+00089e50: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
+00089e60: 2e5f 5f68 6173 436f 6f72 643a 0a20 2020  .__hasCoord:.   
+00089e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00089e80: 2072 6574 7572 6e0a 2020 2020 2020 2020   return.        
+00089e90: 2020 2020 2020 2020 5f74 7970 6553 796d          _typeSym
+00089ea0: 626f 6c53 656c 6563 7420 3d20 7365 7428  bolSelect = set(
+00089eb0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00089ec0: 2020 6174 6f6d 5479 7065 7320 3d20 7365    atomTypes = se
+00089ed0: 6c66 2e5f 5f63 522e 6765 7444 6963 744c  lf.__cR.getDictL
+00089ee0: 6973 7428 2761 746f 6d5f 7479 7065 2729  ist('atom_type')
+00089ef0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00089f00: 2069 6620 6c65 6e28 6174 6f6d 5479 7065   if len(atomType
+00089f10: 7329 203e 2030 2061 6e64 2027 7379 6d62  s) > 0 and 'symb
+00089f20: 6f6c 2720 696e 2061 746f 6d54 7970 6573  ol' in atomTypes
+00089f30: 5b30 5d3a 0a20 2020 2020 2020 2020 2020  [0]:.           
+00089f40: 2020 2020 2020 2020 2066 6f72 2061 746f           for ato
+00089f50: 6d54 7970 6520 696e 2061 746f 6d54 7970  mType in atomTyp
+00089f60: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+00089f70: 2020 2020 2020 2020 2020 2020 7479 7065              type
+00089f80: 5379 6d62 6f6c 203d 2061 746f 6d54 7970  Symbol = atomTyp
+00089f90: 655b 2773 796d 626f 6c27 5d0a 2020 2020  e['symbol'].    
+00089fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00089fb0: 2020 2020 6174 6f6d 6963 4e75 6d62 6572      atomicNumber
+00089fc0: 203d 2069 6e74 5f61 746f 6d28 7479 7065   = int_atom(type
+00089fd0: 5379 6d62 6f6c 290a 2020 2020 2020 2020  Symbol).        
+00089fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00089ff0: 6174 6f6d 6963 5765 6967 6874 203d 2045  atomicWeight = E
+0008a000: 4c45 4d45 4e54 5f57 4549 4748 5453 5b61  LEMENT_WEIGHTS[a
+0008a010: 746f 6d69 634e 756d 6265 725d 0a20 2020  tomicNumber].   
+0008a020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008a030: 2020 2020 2069 6620 6174 6f6d 6963 5765       if atomicWe
+0008a040: 6967 6874 203c 2033 2e35 3a0a 2020 2020  ight < 3.5:.    
+0008a050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008a060: 2020 2020 2020 2020 5f74 7970 6553 796d          _typeSym
+0008a070: 626f 6c53 656c 6563 742e 6164 6428 7479  bolSelect.add(ty
+0008a080: 7065 5379 6d62 6f6c 290a 0a20 2020 2020  peSymbol)..     
+0008a090: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0008a0a0: 6661 6374 6f72 5b27 7479 7065 5f73 796d  factor['type_sym
+0008a0b0: 626f 6c27 5d20 3d20 6c69 7374 285f 7479  bol'] = list(_ty
+0008a0c0: 7065 5379 6d62 6f6c 5365 6c65 6374 290a  peSymbolSelect).
+0008a0d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0008a0e0: 2073 656c 662e 636f 6e73 756d 6546 6163   self.consumeFac
+0008a0f0: 746f 725f 6578 7072 6573 7369 6f6e 7328  tor_expressions(
+0008a100: 2227 6879 6472 6f67 656e 2720 636c 6175  "'hydrogen' clau
+0008a110: 7365 222c 2046 616c 7365 290a 0a20 2020  se", False)..   
+0008a120: 2020 2020 2020 2020 2065 6c69 6620 6374           elif ct
+0008a130: 782e 4964 2829 3a0a 2020 2020 2020 2020  x.Id():.        
+0008a140: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0008a150: 5f5f 7365 6c5f 6578 7072 5f64 6562 7567  __sel_expr_debug
+0008a160: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0008a170: 2020 2020 2020 7072 696e 7428 2220 2022        print("  "
+0008a180: 202a 2073 656c 662e 6465 7074 6820 2b20   * self.depth + 
+0008a190: 222d 2d3e 2069 6422 290a 2020 2020 2020  "--> id").      
+0008a1a0: 2020 2020 2020 2020 2020 7365 6c66 2e66            self.f
+0008a1b0: 6163 746f 725b 2761 746f 6d5f 6964 275d  actor['atom_id']
+0008a1c0: 203d 205b 4e6f 6e65 5d0a 2020 2020 2020   = [None].      
+0008a1d0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+0008a1e0: 5f66 2e61 7070 656e 6428 6622 5b55 6e73  _f.append(f"[Uns
+0008a1f0: 7570 706f 7274 6564 2064 6174 615d 207b  upported data] {
+0008a200: 7365 6c66 2e5f 5f67 6574 4375 7272 656e  self.__getCurren
+0008a210: 7452 6573 7472 6169 6e74 2829 7d22 0a20  tRestraint()}". 
+0008a220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008a230: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0008a240: 5468 6520 2769 6427 2063 6c61 7573 6520  The 'id' clause 
+0008a250: 6861 7320 6e6f 2065 6666 6563 7420 220a  has no effect ".
+0008a260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008a270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008a280: 2262 6563 6175 7365 2074 6865 2069 6e74  "because the int
+0008a290: 6572 6e61 6c20 6174 6f6d 206e 756d 6265  ernal atom numbe
+0008a2a0: 7220 6973 206e 6f74 2069 6e63 6c75 6465  r is not include
+0008a2b0: 6420 696e 2074 6865 2063 6f6f 7264 696e  d in the coordin
+0008a2c0: 6174 6520 6669 6c65 2e22 290a 0a20 2020  ate file.")..   
+0008a2d0: 2020 2020 2020 2020 2065 6c69 6620 6374           elif ct
+0008a2e0: 782e 4e61 6d65 2829 3a0a 2020 2020 2020  x.Name():.      
+0008a2f0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+0008a300: 662e 5f5f 7365 6c5f 6578 7072 5f64 6562  f.__sel_expr_deb
+0008a310: 7567 3a0a 2020 2020 2020 2020 2020 2020  ug:.            
+0008a320: 2020 2020 2020 2020 7072 696e 7428 2220          print(" 
+0008a330: 2022 202a 2073 656c 662e 6465 7074 6820   " * self.depth 
+0008a340: 2b20 222d 2d3e 206e 616d 6522 290a 0a20  + "--> name").. 
+0008a350: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0008a360: 7661 6c5f 6661 6374 6f72 203d 2046 616c  val_factor = Fal
+0008a370: 7365 0a20 2020 2020 2020 2020 2020 2020  se.             
+0008a380: 2020 2069 6620 2761 746f 6d5f 6964 2720     if 'atom_id' 
+0008a390: 696e 2073 656c 662e 6661 6374 6f72 206f  in self.factor o
+0008a3a0: 7220 2761 746f 6d5f 6964 7327 2069 6e20  r 'atom_ids' in 
+0008a3b0: 7365 6c66 2e66 6163 746f 723a 0a20 2020  self.factor:.   
+0008a3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008a3d0: 205f 5f66 6163 746f 7220 3d20 636f 7079   __factor = copy
+0008a3e0: 2e63 6f70 7928 7365 6c66 2e66 6163 746f  .copy(self.facto
+0008a3f0: 7229 0a20 2020 2020 2020 2020 2020 2020  r).             
+0008a400: 2020 2020 2020 2073 656c 662e 636f 6e73         self.cons
+0008a410: 756d 6546 6163 746f 725f 6578 7072 6573  umeFactor_expres
+0008a420: 7369 6f6e 7328 2227 6e61 6d65 2720 636c  sions("'name' cl
+0008a430: 6175 7365 222c 2046 616c 7365 290a 2020  ause", False).  
+0008a440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008a450: 2020 6576 616c 5f66 6163 746f 7220 3d20    eval_factor = 
+0008a460: 5472 7565 0a0a 2020 2020 2020 2020 2020  True..          
+0008a470: 2020 2020 2020 6966 2063 7478 2e43 6f6c        if ctx.Col
+0008a480: 6f6e 2829 3a20 2023 2072 616e 6765 2065  on():  # range e
+0008a490: 7870 7265 7373 696f 6e0a 2020 2020 2020  xpression.      
+0008a4a0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0008a4b0: 2063 7478 2e53 696d 706c 655f 6e61 6d65   ctx.Simple_name
+0008a4c0: 2830 293a 0a20 2020 2020 2020 2020 2020  (0):.           
+0008a4d0: 2020 2020 2020 2020 2020 2020 2062 6567               beg
+0008a4e0: 4174 6f6d 4964 203d 2073 7472 2863 7478  AtomId = str(ctx
+0008a4f0: 2e53 696d 706c 655f 6e61 6d65 2830 2929  .Simple_name(0))
+0008a500: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0008a510: 2020 2020 2065 6c69 6620 6374 782e 446f       elif ctx.Do
+0008a520: 7562 6c65 5f71 756f 7465 5f73 7472 696e  uble_quote_strin
+0008a530: 6728 3029 3a0a 2020 2020 2020 2020 2020  g(0):.          
+0008a540: 2020 2020 2020 2020 2020 2020 2020 6265                be
+0008a550: 6741 746f 6d49 6420 3d20 7374 7228 6374  gAtomId = str(ct
+0008a560: 782e 446f 7562 6c65 5f71 756f 7465 5f73  x.Double_quote_s
+0008a570: 7472 696e 6728 3029 292e 7374 7269 7028  tring(0)).strip(
+0008a580: 2722 2729 2e73 7472 6970 2829 0a20 2020  '"').strip().   
+0008a590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008a5a0: 2020 2020 2069 6620 6c65 6e28 6265 6741       if len(begA
+0008a5b0: 746f 6d49 6429 203d 3d20 303a 0a20 2020  tomId) == 0:.   
+0008a5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008a5d0: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
+0008a5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008a5f0: 2020 2020 6966 2063 7478 2e53 696d 706c      if ctx.Simpl
+0008a600: 655f 6e61 6d65 2831 293a 0a20 2020 2020  e_name(1):.     
+0008a610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008a620: 2020 2065 6e64 4174 6f6d 4964 203d 2073     endAtomId = s
+0008a630: 7472 2863 7478 2e53 696d 706c 655f 6e61  tr(ctx.Simple_na
+0008a640: 6d65 2831 2929 0a20 2020 2020 2020 2020  me(1)).         
+0008a650: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+0008a660: 6374 782e 446f 7562 6c65 5f71 756f 7465  ctx.Double_quote
+0008a670: 5f73 7472 696e 6728 3129 3a0a 2020 2020  _string(1):.    
 0008a680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008a690: 2020 2073 656c 662e 6661 6374 6f72 5b27     self.factor['
-0008a6a0: 6174 6f6d 5f69 6473 275d 203d 205b 7374  atom_ids'] = [st
-0008a6b0: 7228 6374 782e 5369 6d70 6c65 5f6e 616d  r(ctx.Simple_nam
-0008a6c0: 6573 2830 2929 5d0a 0a20 2020 2020 2020  es(0))]..       
-0008a6d0: 2020 2020 2020 2020 2065 6c69 6620 6374           elif ct
-0008a6e0: 782e 5379 6d62 6f6c 5f6e 616d 6528 293a  x.Symbol_name():
-0008a6f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0008a700: 2020 2020 2073 796d 626f 6c5f 6e61 6d65       symbol_name
-0008a710: 203d 2073 7472 2863 7478 2e53 796d 626f   = str(ctx.Symbo
-0008a720: 6c5f 6e61 6d65 2829 290a 2020 2020 2020  l_name()).      
-0008a730: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0008a740: 2073 796d 626f 6c5f 6e61 6d65 2069 6e20   symbol_name in 
-0008a750: 7365 6c66 2e65 7661 6c75 6174 653a 0a20  self.evaluate:. 
-0008a760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008a770: 2020 2020 2020 2076 616c 203d 2073 656c         val = sel
-0008a780: 662e 6576 616c 7561 7465 5b73 796d 626f  f.evaluate[symbo
-0008a790: 6c5f 6e61 6d65 5d0a 2020 2020 2020 2020  l_name].        
-0008a7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008a7b0: 6966 2069 7369 6e73 7461 6e63 6528 7661  if isinstance(va
-0008a7c0: 6c2c 206c 6973 7429 3a0a 2020 2020 2020  l, list):.      
-0008a7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008a7e0: 2020 2020 2020 7365 6c66 2e66 6163 746f        self.facto
-0008a7f0: 725b 2761 746f 6d5f 6964 275d 203d 2076  r['atom_id'] = v
-0008a800: 616c 0a20 2020 2020 2020 2020 2020 2020  al.             
-0008a810: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0008a820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0008a830: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0008a840: 662e 6661 6374 6f72 5b27 6174 6f6d 5f69  f.factor['atom_i
-0008a850: 6427 5d20 3d20 5b76 616c 5d0a 2020 2020  d'] = [val].    
+0008a690: 2020 2020 656e 6441 746f 6d49 6420 3d20      endAtomId = 
+0008a6a0: 7374 7228 6374 782e 446f 7562 6c65 5f71  str(ctx.Double_q
+0008a6b0: 756f 7465 5f73 7472 696e 6728 3129 292e  uote_string(1)).
+0008a6c0: 7374 7269 7028 2722 2729 2e73 7472 6970  strip('"').strip
+0008a6d0: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
+0008a6e0: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+0008a6f0: 6e28 656e 6441 746f 6d49 6429 203d 3d20  n(endAtomId) == 
+0008a700: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
+0008a710: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0008a720: 6574 7572 6e0a 2020 2020 2020 2020 2020  eturn.          
+0008a730: 2020 2020 2020 2020 2020 7365 6c66 2e66            self.f
+0008a740: 6163 746f 725b 2761 746f 6d5f 6964 7327  actor['atom_ids'
+0008a750: 5d20 3d20 5b62 6567 4174 6f6d 4964 2c20  ] = [begAtomId, 
+0008a760: 656e 6441 746f 6d49 645d 0a0a 2020 2020  endAtomId]..    
+0008a770: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+0008a780: 2063 7478 2e53 696d 706c 655f 6e61 6d65   ctx.Simple_name
+0008a790: 2830 2920 6f72 2063 7478 2e44 6f75 626c  (0) or ctx.Doubl
+0008a7a0: 655f 7175 6f74 655f 7374 7269 6e67 2830  e_quote_string(0
+0008a7b0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0008a7c0: 2020 2020 2020 2069 6620 6374 782e 5369         if ctx.Si
+0008a7d0: 6d70 6c65 5f6e 616d 6528 3029 3a0a 2020  mple_name(0):.  
+0008a7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008a7f0: 2020 2020 2020 7365 6c66 2e66 6163 746f        self.facto
+0008a800: 725b 2761 746f 6d5f 6964 275d 203d 205b  r['atom_id'] = [
+0008a810: 7374 7228 6374 782e 5369 6d70 6c65 5f6e  str(ctx.Simple_n
+0008a820: 616d 6528 3029 295d 0a20 2020 2020 2020  ame(0))].       
+0008a830: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+0008a840: 6620 6374 782e 446f 7562 6c65 5f71 756f  f ctx.Double_quo
+0008a850: 7465 5f73 7472 696e 6728 3029 3a0a 2020  te_string(0):.  
 0008a860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008a870: 656c 6966 2073 796d 626f 6c5f 6e61 6d65  elif symbol_name
-0008a880: 2069 6e20 7365 6c66 2e65 7661 6c75 6174   in self.evaluat
-0008a890: 6546 6f72 3a0a 2020 2020 2020 2020 2020  eFor:.          
-0008a8a0: 2020 2020 2020 2020 2020 2020 2020 7661                va
-0008a8b0: 6c20 3d20 7365 6c66 2e65 7661 6c75 6174  l = self.evaluat
-0008a8c0: 6546 6f72 5b73 796d 626f 6c5f 6e61 6d65  eFor[symbol_name
-0008a8d0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0008a8e0: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
-0008a8f0: 6e73 7461 6e63 6528 7661 6c2c 206c 6973  nstance(val, lis
-0008a900: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
-0008a910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008a920: 7365 6c66 2e66 6163 746f 725b 2761 746f  self.factor['ato
-0008a930: 6d5f 6964 275d 203d 2076 616c 0a20 2020  m_id'] = val.   
-0008a940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008a950: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0008a960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008a970: 2020 2020 2020 2073 656c 662e 6661 6374         self.fact
-0008a980: 6f72 5b27 6174 6f6d 5f69 6427 5d20 3d20  or['atom_id'] = 
-0008a990: 5b76 616c 5d0a 2020 2020 2020 2020 2020  [val].          
-0008a9a0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0008a9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008a9c0: 2020 2020 2020 2020 7365 6c66 2e5f 5f66          self.__f
-0008a9d0: 2e61 7070 656e 6428 6622 5b55 6e73 7570  .append(f"[Unsup
-0008a9e0: 706f 7274 6564 2064 6174 615d 207b 7365  ported data] {se
-0008a9f0: 6c66 2e5f 5f67 6574 4375 7272 656e 7452  lf.__getCurrentR
-0008aa00: 6573 7472 6169 6e74 2829 7d22 0a20 2020  estraint()}".   
+0008a870: 2020 2020 2020 7365 6c66 2e66 6163 746f        self.facto
+0008a880: 725b 2761 746f 6d5f 6964 275d 203d 205b  r['atom_id'] = [
+0008a890: 7374 7228 6374 782e 446f 7562 6c65 5f71  str(ctx.Double_q
+0008a8a0: 756f 7465 5f73 7472 696e 6728 3029 292e  uote_string(0)).
+0008a8b0: 7374 7269 7028 2722 2729 2e73 7472 6970  strip('"').strip
+0008a8c0: 2829 5d0a 0a20 2020 2020 2020 2020 2020  ()]..           
+0008a8d0: 2020 2020 2065 6c69 6620 6374 782e 5369       elif ctx.Si
+0008a8e0: 6d70 6c65 5f6e 616d 6573 2830 293a 0a20  mple_names(0):. 
+0008a8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008a900: 2020 2073 656c 662e 6661 6374 6f72 5b27     self.factor['
+0008a910: 6174 6f6d 5f69 6473 275d 203d 205b 7374  atom_ids'] = [st
+0008a920: 7228 6374 782e 5369 6d70 6c65 5f6e 616d  r(ctx.Simple_nam
+0008a930: 6573 2830 2929 5d0a 0a20 2020 2020 2020  es(0))]..       
+0008a940: 2020 2020 2020 2020 2065 6c69 6620 6374           elif ct
+0008a950: 782e 5379 6d62 6f6c 5f6e 616d 6528 293a  x.Symbol_name():
+0008a960: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0008a970: 2020 2020 2073 796d 626f 6c5f 6e61 6d65       symbol_name
+0008a980: 203d 2073 7472 2863 7478 2e53 796d 626f   = str(ctx.Symbo
+0008a990: 6c5f 6e61 6d65 2829 290a 2020 2020 2020  l_name()).      
+0008a9a0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0008a9b0: 2073 796d 626f 6c5f 6e61 6d65 2069 6e20   symbol_name in 
+0008a9c0: 7365 6c66 2e65 7661 6c75 6174 653a 0a20  self.evaluate:. 
+0008a9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008a9e0: 2020 2020 2020 2076 616c 203d 2073 656c         val = sel
+0008a9f0: 662e 6576 616c 7561 7465 5b73 796d 626f  f.evaluate[symbo
+0008aa00: 6c5f 6e61 6d65 5d0a 2020 2020 2020 2020  l_name].        
 0008aa10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008aa20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008aa30: 2020 2020 2066 2254 6865 2073 796d 626f       f"The symbo
-0008aa40: 6c20 7b73 796d 626f 6c5f 6e61 6d65 2172  l {symbol_name!r
-0008aa50: 7d20 6973 206e 6f74 2064 6566 696e 6564  } is not defined
-0008aa60: 2e22 290a 0a20 2020 2020 2020 2020 2020  .")..           
-0008aa70: 2020 2020 2069 6620 6576 616c 5f66 6163       if eval_fac
-0008aa80: 746f 7220 616e 6420 2761 746f 6d5f 7365  tor and 'atom_se
-0008aa90: 6c65 6374 696f 6e27 2069 6e20 7365 6c66  lection' in self
-0008aaa0: 2e66 6163 746f 723a 0a20 2020 2020 2020  .factor:.       
-0008aab0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0008aac0: 6c65 6e28 7365 6c66 2e66 6163 746f 725b  len(self.factor[
-0008aad0: 2761 746f 6d5f 7365 6c65 6374 696f 6e27  'atom_selection'
-0008aae0: 5d29 203d 3d20 3020 616e 6420 2761 746f  ]) == 0 and 'ato
-0008aaf0: 6d5f 6964 2720 696e 205f 5f66 6163 746f  m_id' in __facto
-0008ab00: 7220 616e 6420 5f5f 6661 6374 6f72 5b27  r and __factor['
-0008ab10: 6174 6f6d 5f69 6427 5d5b 305d 2069 7320  atom_id'][0] is 
-0008ab20: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-0008ab30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ab40: 2020 5f5f 6174 6f6d 4964 203d 205f 5f66    __atomId = __f
-0008ab50: 6163 746f 725b 2761 746f 6d5f 6964 275d  actor['atom_id']
-0008ab60: 5b30 5d2e 7570 7065 7228 2920 6966 206c  [0].upper() if l
-0008ab70: 656e 285f 5f66 6163 746f 725b 2761 746f  en(__factor['ato
-0008ab80: 6d5f 6964 275d 5b30 5d29 203c 3d20 3220  m_id'][0]) <= 2 
-0008ab90: 656c 7365 205f 5f66 6163 746f 725b 2761  else __factor['a
-0008aba0: 746f 6d5f 6964 275d 5b30 5d5b 3a32 5d2e  tom_id'][0][:2].
-0008abb0: 7570 7065 7228 290a 2020 2020 2020 2020  upper().        
-0008abc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008abd0: 6966 2073 656c 662e 5f5f 7769 7468 5f61  if self.__with_a
-0008abe0: 7869 7320 616e 6420 5f5f 6174 6f6d 4964  xis and __atomId
-0008abf0: 2069 6e20 5850 4c4f 525f 5244 435f 5052   in XPLOR_RDC_PR
-0008ac00: 494e 4349 5041 4c5f 4158 4953 5f4e 414d  INCIPAL_AXIS_NAM
-0008ac10: 4553 3a0a 2020 2020 2020 2020 2020 2020  ES:.            
+0008aa20: 6966 2069 7369 6e73 7461 6e63 6528 7661  if isinstance(va
+0008aa30: 6c2c 206c 6973 7429 3a0a 2020 2020 2020  l, list):.      
+0008aa40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008aa50: 2020 2020 2020 7365 6c66 2e66 6163 746f        self.facto
+0008aa60: 725b 2761 746f 6d5f 6964 275d 203d 2076  r['atom_id'] = v
+0008aa70: 616c 0a20 2020 2020 2020 2020 2020 2020  al.             
+0008aa80: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0008aa90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0008aaa0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0008aab0: 662e 6661 6374 6f72 5b27 6174 6f6d 5f69  f.factor['atom_i
+0008aac0: 6427 5d20 3d20 5b76 616c 5d0a 2020 2020  d'] = [val].    
+0008aad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008aae0: 656c 6966 2073 796d 626f 6c5f 6e61 6d65  elif symbol_name
+0008aaf0: 2069 6e20 7365 6c66 2e65 7661 6c75 6174   in self.evaluat
+0008ab00: 6546 6f72 3a0a 2020 2020 2020 2020 2020  eFor:.          
+0008ab10: 2020 2020 2020 2020 2020 2020 2020 7661                va
+0008ab20: 6c20 3d20 7365 6c66 2e65 7661 6c75 6174  l = self.evaluat
+0008ab30: 6546 6f72 5b73 796d 626f 6c5f 6e61 6d65  eFor[symbol_name
+0008ab40: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0008ab50: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
+0008ab60: 6e73 7461 6e63 6528 7661 6c2c 206c 6973  nstance(val, lis
+0008ab70: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
+0008ab80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008ab90: 7365 6c66 2e66 6163 746f 725b 2761 746f  self.factor['ato
+0008aba0: 6d5f 6964 275d 203d 2076 616c 0a20 2020  m_id'] = val.   
+0008abb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008abc0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0008abd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008abe0: 2020 2020 2020 2073 656c 662e 6661 6374         self.fact
+0008abf0: 6f72 5b27 6174 6f6d 5f69 6427 5d20 3d20  or['atom_id'] = 
+0008ac00: 5b76 616c 5d0a 2020 2020 2020 2020 2020  [val].          
+0008ac10: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
 0008ac20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ac30: 7061 7373 0a20 2020 2020 2020 2020 2020  pass.           
-0008ac40: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-0008ac50: 6620 7365 6c66 2e5f 5f77 6974 685f 7061  f self.__with_pa
-0008ac60: 7261 2061 6e64 2028 2827 636f 6d70 5f69  ra and (('comp_i
-0008ac70: 6427 2069 6e20 5f5f 6661 6374 6f72 2061  d' in __factor a
-0008ac80: 6e64 205f 5f66 6163 746f 725b 2761 746f  nd __factor['ato
-0008ac90: 6d5f 6964 275d 5b30 5d20 3d3d 205f 5f66  m_id'][0] == __f
-0008aca0: 6163 746f 725b 2763 6f6d 705f 6964 275d  actor['comp_id']
-0008acb0: 5b30 5d20 616e 6420 5f5f 6174 6f6d 4964  [0] and __atomId
-0008acc0: 2069 6e20 5041 5241 4d41 474e 4554 4943   in PARAMAGNETIC
-0008acd0: 5f45 4c45 4d45 4e54 5329 0a20 2020 2020  _ELEMENTS).     
-0008ace0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008acf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ad00: 2020 2020 2020 2020 2020 2020 2020 6f72                or
-0008ad10: 205f 5f61 746f 6d49 6420 696e 2046 4552   __atomId in FER
-0008ad20: 524f 4d41 474e 4554 4943 5f45 4c45 4d45  ROMAGNETIC_ELEME
-0008ad30: 4e54 5320 6f72 205f 5f61 746f 6d49 6420  NTS or __atomId 
-0008ad40: 696e 204c 414e 5448 414e 4f49 445f 454c  in LANTHANOID_EL
-0008ad50: 454d 454e 5453 293a 0a20 2020 2020 2020  EMENTS):.       
-0008ad60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ad70: 2020 2020 2070 6173 730a 2020 2020 2020       pass.      
-0008ad80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ad90: 2020 656c 6966 2073 656c 662e 5f5f 6375    elif self.__cu
-0008ada0: 725f 7375 6274 7970 6520 3d3d 2027 706c  r_subtype == 'pl
-0008adb0: 616e 6527 3a0a 2020 2020 2020 2020 2020  ane':.          
-0008adc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008add0: 2020 7061 7373 0a20 2020 2020 2020 2020    pass.         
-0008ade0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0008adf0: 6c69 6620 7365 6c66 2e5f 5f63 7572 5f73  lif self.__cur_s
-0008ae00: 7562 7479 7065 203d 3d20 2764 6973 7427  ubtype == 'dist'
-0008ae10: 2061 6e64 205f 5f61 746f 6d49 6420 696e   and __atomId in
-0008ae20: 2058 504c 4f52 5f4e 4954 524f 5849 4445   XPLOR_NITROXIDE
-0008ae30: 5f4e 414d 4553 3a0a 2020 2020 2020 2020  _NAMES:.        
-0008ae40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ae50: 2020 2020 7061 7373 0a20 2020 2020 2020      pass.       
-0008ae60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ae70: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0008ae80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ae90: 2020 205f 6661 6374 6f72 203d 2063 6f70     _factor = cop
-0008aea0: 792e 636f 7079 2873 656c 662e 6661 6374  y.copy(self.fact
-0008aeb0: 6f72 290a 2020 2020 2020 2020 2020 2020  or).            
-0008aec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008aed0: 6966 2027 6174 6f6d 5f73 656c 6563 7469  if 'atom_selecti
-0008aee0: 6f6e 2720 696e 205f 5f66 6163 746f 723a  on' in __factor:
-0008aef0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0008af00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008af10: 2064 656c 205f 5f66 6163 746f 725b 2761   del __factor['a
-0008af20: 746f 6d5f 7365 6c65 6374 696f 6e27 5d0a  tom_selection'].
-0008af30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008af40: 2020 2020 2020 2020 2020 2020 6465 6c20              del 
-0008af50: 5f66 6163 746f 725b 2761 746f 6d5f 7365  _factor['atom_se
-0008af60: 6c65 6374 696f 6e27 5d0a 2020 2020 2020  lection'].      
-0008af70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008af80: 2020 2020 2020 7365 6c66 2e5f 5f66 2e61        self.__f.a
-0008af90: 7070 656e 6428 6622 5b49 6e73 7566 6669  ppend(f"[Insuffi
-0008afa0: 6369 656e 7420 6174 6f6d 2073 656c 6563  cient atom selec
-0008afb0: 7469 6f6e 5d20 7b73 656c 662e 5f5f 6765  tion] {self.__ge
-0008afc0: 7443 7572 7265 6e74 5265 7374 7261 696e  tCurrentRestrain
-0008afd0: 7428 297d 220a 2020 2020 2020 2020 2020  t()}".          
-0008afe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008ac30: 2020 2020 2020 2020 7365 6c66 2e5f 5f66          self.__f
+0008ac40: 2e61 7070 656e 6428 6622 5b55 6e73 7570  .append(f"[Unsup
+0008ac50: 706f 7274 6564 2064 6174 615d 207b 7365  ported data] {se
+0008ac60: 6c66 2e5f 5f67 6574 4375 7272 656e 7452  lf.__getCurrentR
+0008ac70: 6573 7472 6169 6e74 2829 7d22 0a20 2020  estraint()}".   
+0008ac80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008ac90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008aca0: 2020 2020 2066 2254 6865 2073 796d 626f       f"The symbo
+0008acb0: 6c20 7b73 796d 626f 6c5f 6e61 6d65 2172  l {symbol_name!r
+0008acc0: 7d20 6973 206e 6f74 2064 6566 696e 6564  } is not defined
+0008acd0: 2e22 290a 0a20 2020 2020 2020 2020 2020  .")..           
+0008ace0: 2020 2020 2069 6620 6576 616c 5f66 6163       if eval_fac
+0008acf0: 746f 7220 616e 6420 2761 746f 6d5f 7365  tor and 'atom_se
+0008ad00: 6c65 6374 696f 6e27 2069 6e20 7365 6c66  lection' in self
+0008ad10: 2e66 6163 746f 723a 0a20 2020 2020 2020  .factor:.       
+0008ad20: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0008ad30: 6c65 6e28 7365 6c66 2e66 6163 746f 725b  len(self.factor[
+0008ad40: 2761 746f 6d5f 7365 6c65 6374 696f 6e27  'atom_selection'
+0008ad50: 5d29 203d 3d20 3020 616e 6420 2761 746f  ]) == 0 and 'ato
+0008ad60: 6d5f 6964 2720 696e 205f 5f66 6163 746f  m_id' in __facto
+0008ad70: 7220 616e 6420 5f5f 6661 6374 6f72 5b27  r and __factor['
+0008ad80: 6174 6f6d 5f69 6427 5d5b 305d 2069 7320  atom_id'][0] is 
+0008ad90: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+0008ada0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008adb0: 2020 5f5f 6174 6f6d 4964 203d 205f 5f66    __atomId = __f
+0008adc0: 6163 746f 725b 2761 746f 6d5f 6964 275d  actor['atom_id']
+0008add0: 5b30 5d2e 7570 7065 7228 2920 6966 206c  [0].upper() if l
+0008ade0: 656e 285f 5f66 6163 746f 725b 2761 746f  en(__factor['ato
+0008adf0: 6d5f 6964 275d 5b30 5d29 203c 3d20 3220  m_id'][0]) <= 2 
+0008ae00: 656c 7365 205f 5f66 6163 746f 725b 2761  else __factor['a
+0008ae10: 746f 6d5f 6964 275d 5b30 5d5b 3a32 5d2e  tom_id'][0][:2].
+0008ae20: 7570 7065 7228 290a 2020 2020 2020 2020  upper().        
+0008ae30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008ae40: 6966 2073 656c 662e 5f5f 7769 7468 5f61  if self.__with_a
+0008ae50: 7869 7320 616e 6420 5f5f 6174 6f6d 4964  xis and __atomId
+0008ae60: 2069 6e20 5850 4c4f 525f 5244 435f 5052   in XPLOR_RDC_PR
+0008ae70: 494e 4349 5041 4c5f 4158 4953 5f4e 414d  INCIPAL_AXIS_NAM
+0008ae80: 4553 3a0a 2020 2020 2020 2020 2020 2020  ES:.            
+0008ae90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008aea0: 7061 7373 0a20 2020 2020 2020 2020 2020  pass.           
+0008aeb0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+0008aec0: 6620 7365 6c66 2e5f 5f77 6974 685f 7061  f self.__with_pa
+0008aed0: 7261 2061 6e64 2028 2827 636f 6d70 5f69  ra and (('comp_i
+0008aee0: 6427 2069 6e20 5f5f 6661 6374 6f72 2061  d' in __factor a
+0008aef0: 6e64 205f 5f66 6163 746f 725b 2761 746f  nd __factor['ato
+0008af00: 6d5f 6964 275d 5b30 5d20 3d3d 205f 5f66  m_id'][0] == __f
+0008af10: 6163 746f 725b 2763 6f6d 705f 6964 275d  actor['comp_id']
+0008af20: 5b30 5d20 616e 6420 5f5f 6174 6f6d 4964  [0] and __atomId
+0008af30: 2069 6e20 5041 5241 4d41 474e 4554 4943   in PARAMAGNETIC
+0008af40: 5f45 4c45 4d45 4e54 5329 0a20 2020 2020  _ELEMENTS).     
+0008af50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008af60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008af70: 2020 2020 2020 2020 2020 2020 2020 6f72                or
+0008af80: 205f 5f61 746f 6d49 6420 696e 2046 4552   __atomId in FER
+0008af90: 524f 4d41 474e 4554 4943 5f45 4c45 4d45  ROMAGNETIC_ELEME
+0008afa0: 4e54 5320 6f72 205f 5f61 746f 6d49 6420  NTS or __atomId 
+0008afb0: 696e 204c 414e 5448 414e 4f49 445f 454c  in LANTHANOID_EL
+0008afc0: 454d 454e 5453 293a 0a20 2020 2020 2020  EMENTS):.       
+0008afd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008afe0: 2020 2020 2070 6173 730a 2020 2020 2020       pass.      
 0008aff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b000: 2020 6622 5468 6520 276e 616d 6527 2063    f"The 'name' c
-0008b010: 6c61 7573 6520 6861 7320 6e6f 2065 6666  lause has no eff
-0008b020: 6563 7420 666f 7220 6120 636f 6e6a 756e  ect for a conjun
-0008b030: 6374 696f 6e20 6f66 2066 6163 746f 7220  ction of factor 
-0008b040: 7b5f 5f66 6163 746f 727d 2061 6e64 207b  {__factor} and {
-0008b050: 5f66 6163 746f 727d 2e22 290a 0a20 2020  _factor}.")..   
-0008b060: 2020 2020 2020 2020 2065 6c69 6620 6374           elif ct
-0008b070: 782e 4e6f 745f 6f70 2829 3a0a 2020 2020  x.Not_op():.    
-0008b080: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0008b090: 656c 662e 5f5f 7365 6c5f 6578 7072 5f64  elf.__sel_expr_d
-0008b0a0: 6562 7567 3a0a 2020 2020 2020 2020 2020  ebug:.          
-0008b0b0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0008b0c0: 2220 2022 202a 2073 656c 662e 6465 7074  "  " * self.dept
-0008b0d0: 6820 2b20 222d 2d3e 206e 6f74 2229 0a20  h + "--> not"). 
-0008b0e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0008b0f0: 6620 6e6f 7420 7365 6c66 2e5f 5f68 6173  f not self.__has
-0008b100: 436f 6f72 643a 0a20 2020 2020 2020 2020  Coord:.         
-0008b110: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0008b120: 6e0a 0a20 2020 2020 2020 2020 2020 2020  n..             
-0008b130: 2020 2069 6620 2761 746f 6d5f 7365 6c65     if 'atom_sele
-0008b140: 6374 696f 6e27 2069 6e20 7365 6c66 2e66  ction' in self.f
-0008b150: 6163 746f 7220 616e 6420 2827 6174 6f6d  actor and ('atom
-0008b160: 5f69 6427 2069 6e20 7365 6c66 2e66 6163  _id' in self.fac
-0008b170: 746f 7220 6f72 2027 6174 6f6d 5f69 6473  tor or 'atom_ids
-0008b180: 2720 696e 2073 656c 662e 6661 6374 6f72  ' in self.factor
-0008b190: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0008b1a0: 2020 2020 2020 205f 7265 6641 746f 6d53         _refAtomS
-0008b1b0: 656c 6563 7469 6f6e 203d 2073 656c 662e  election = self.
-0008b1c0: 6661 6374 6f72 5b27 6174 6f6d 5f73 656c  factor['atom_sel
-0008b1d0: 6563 7469 6f6e 275d 0a20 2020 2020 2020  ection'].       
-0008b1e0: 2020 2020 2020 2020 2020 2020 2064 656c               del
-0008b1f0: 2073 656c 662e 6661 6374 6f72 5b27 6174   self.factor['at
-0008b200: 6f6d 5f73 656c 6563 7469 6f6e 275d 0a20  om_selection']. 
-0008b210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b220: 2020 2069 6620 7365 6c66 2e73 7461 636b     if self.stack
-0008b230: 4661 6374 6f72 733a 0a20 2020 2020 2020  Factors:.       
-0008b240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b250: 2073 656c 662e 7374 6163 6b46 6163 746f   self.stackFacto
-0008b260: 7273 2e70 6f70 2829 0a20 2020 2020 2020  rs.pop().       
-0008b270: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0008b280: 662e 6661 6374 6f72 203d 2073 656c 662e  f.factor = self.
-0008b290: 5f5f 636f 6e73 756d 6546 6163 746f 725f  __consumeFactor_
-0008b2a0: 6578 7072 6573 7369 6f6e 7328 7365 6c66  expressions(self
-0008b2b0: 2e66 6163 746f 722c 2063 6966 4368 6563  .factor, cifChec
-0008b2c0: 6b3d 5472 7565 290a 2020 2020 2020 2020  k=True).        
-0008b2d0: 2020 2020 2020 2020 2020 2020 6966 2027              if '
-0008b2e0: 6174 6f6d 5f73 656c 6563 7469 6f6e 2720  atom_selection' 
-0008b2f0: 696e 2073 656c 662e 6661 6374 6f72 3a0a  in self.factor:.
-0008b300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b310: 2020 2020 2020 2020 7365 6c66 2e66 6163          self.fac
-0008b320: 746f 725b 2761 746f 6d5f 7365 6c65 6374  tor['atom_select
-0008b330: 696f 6e27 5d20 3d20 5b61 746f 6d20 666f  ion'] = [atom fo
-0008b340: 7220 6174 6f6d 2069 6e20 5f72 6566 4174  r atom in _refAt
-0008b350: 6f6d 5365 6c65 6374 696f 6e0a 2020 2020  omSelection.    
-0008b360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b390: 2020 2020 2069 6620 6e6f 7420 616e 7928       if not any(
-0008b3a0: 5f61 746f 6d20 666f 7220 5f61 746f 6d20  _atom for _atom 
-0008b3b0: 696e 2073 656c 662e 6661 6374 6f72 5b27  in self.factor['
-0008b3c0: 6174 6f6d 5f73 656c 6563 7469 6f6e 275d  atom_selection']
-0008b3d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0008b3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b410: 2020 2020 2069 6620 5f61 746f 6d5b 2763       if _atom['c
-0008b420: 6861 696e 5f69 6427 5d20 3d3d 2061 746f  hain_id'] == ato
-0008b430: 6d5b 2763 6861 696e 5f69 6427 5d0a 2020  m['chain_id'].  
-0008b440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b480: 2020 616e 6420 5f61 746f 6d5b 2773 6571    and _atom['seq
-0008b490: 5f69 6427 5d20 3d3d 2061 746f 6d5b 2773  _id'] == atom['s
-0008b4a0: 6571 5f69 6427 5d0a 2020 2020 2020 2020  eq_id'].        
+0008b000: 2020 656c 6966 2073 656c 662e 5f5f 6375    elif self.__cu
+0008b010: 725f 7375 6274 7970 6520 3d3d 2027 706c  r_subtype == 'pl
+0008b020: 616e 6527 3a0a 2020 2020 2020 2020 2020  ane':.          
+0008b030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b040: 2020 7061 7373 0a20 2020 2020 2020 2020    pass.         
+0008b050: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0008b060: 6c69 6620 7365 6c66 2e5f 5f63 7572 5f73  lif self.__cur_s
+0008b070: 7562 7479 7065 203d 3d20 2764 6973 7427  ubtype == 'dist'
+0008b080: 2061 6e64 205f 5f61 746f 6d49 6420 696e   and __atomId in
+0008b090: 2058 504c 4f52 5f4e 4954 524f 5849 4445   XPLOR_NITROXIDE
+0008b0a0: 5f4e 414d 4553 3a0a 2020 2020 2020 2020  _NAMES:.        
+0008b0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b0c0: 2020 2020 7061 7373 0a20 2020 2020 2020      pass.       
+0008b0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b0e0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0008b0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b100: 2020 205f 6661 6374 6f72 203d 2063 6f70     _factor = cop
+0008b110: 792e 636f 7079 2873 656c 662e 6661 6374  y.copy(self.fact
+0008b120: 6f72 290a 2020 2020 2020 2020 2020 2020  or).            
+0008b130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b140: 6966 2027 6174 6f6d 5f73 656c 6563 7469  if 'atom_selecti
+0008b150: 6f6e 2720 696e 205f 5f66 6163 746f 723a  on' in __factor:
+0008b160: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0008b170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b180: 2064 656c 205f 5f66 6163 746f 725b 2761   del __factor['a
+0008b190: 746f 6d5f 7365 6c65 6374 696f 6e27 5d0a  tom_selection'].
+0008b1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b1b0: 2020 2020 2020 2020 2020 2020 6465 6c20              del 
+0008b1c0: 5f66 6163 746f 725b 2761 746f 6d5f 7365  _factor['atom_se
+0008b1d0: 6c65 6374 696f 6e27 5d0a 2020 2020 2020  lection'].      
+0008b1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b1f0: 2020 2020 2020 7365 6c66 2e5f 5f66 2e61        self.__f.a
+0008b200: 7070 656e 6428 6622 5b49 6e73 7566 6669  ppend(f"[Insuffi
+0008b210: 6369 656e 7420 6174 6f6d 2073 656c 6563  cient atom selec
+0008b220: 7469 6f6e 5d20 7b73 656c 662e 5f5f 6765  tion] {self.__ge
+0008b230: 7443 7572 7265 6e74 5265 7374 7261 696e  tCurrentRestrain
+0008b240: 7428 297d 220a 2020 2020 2020 2020 2020  t()}".          
+0008b250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b270: 2020 6622 5468 6520 276e 616d 6527 2063    f"The 'name' c
+0008b280: 6c61 7573 6520 6861 7320 6e6f 2065 6666  lause has no eff
+0008b290: 6563 7420 666f 7220 6120 636f 6e6a 756e  ect for a conjun
+0008b2a0: 6374 696f 6e20 6f66 2066 6163 746f 7220  ction of factor 
+0008b2b0: 7b5f 5f66 6163 746f 727d 2061 6e64 207b  {__factor} and {
+0008b2c0: 5f66 6163 746f 727d 2e22 290a 0a20 2020  _factor}.")..   
+0008b2d0: 2020 2020 2020 2020 2065 6c69 6620 6374           elif ct
+0008b2e0: 782e 4e6f 745f 6f70 2829 3a0a 2020 2020  x.Not_op():.    
+0008b2f0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0008b300: 656c 662e 5f5f 7365 6c5f 6578 7072 5f64  elf.__sel_expr_d
+0008b310: 6562 7567 3a0a 2020 2020 2020 2020 2020  ebug:.          
+0008b320: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+0008b330: 2220 2022 202a 2073 656c 662e 6465 7074  "  " * self.dept
+0008b340: 6820 2b20 222d 2d3e 206e 6f74 2229 0a20  h + "--> not"). 
+0008b350: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0008b360: 6620 6e6f 7420 7365 6c66 2e5f 5f68 6173  f not self.__has
+0008b370: 436f 6f72 643a 0a20 2020 2020 2020 2020  Coord:.         
+0008b380: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0008b390: 6e0a 0a20 2020 2020 2020 2020 2020 2020  n..             
+0008b3a0: 2020 2069 6620 2761 746f 6d5f 7365 6c65     if 'atom_sele
+0008b3b0: 6374 696f 6e27 2069 6e20 7365 6c66 2e66  ction' in self.f
+0008b3c0: 6163 746f 7220 616e 6420 2827 6174 6f6d  actor and ('atom
+0008b3d0: 5f69 6427 2069 6e20 7365 6c66 2e66 6163  _id' in self.fac
+0008b3e0: 746f 7220 6f72 2027 6174 6f6d 5f69 6473  tor or 'atom_ids
+0008b3f0: 2720 696e 2073 656c 662e 6661 6374 6f72  ' in self.factor
+0008b400: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0008b410: 2020 2020 2020 205f 7265 6641 746f 6d53         _refAtomS
+0008b420: 656c 6563 7469 6f6e 203d 2073 656c 662e  election = self.
+0008b430: 6661 6374 6f72 5b27 6174 6f6d 5f73 656c  factor['atom_sel
+0008b440: 6563 7469 6f6e 275d 0a20 2020 2020 2020  ection'].       
+0008b450: 2020 2020 2020 2020 2020 2020 2064 656c               del
+0008b460: 2073 656c 662e 6661 6374 6f72 5b27 6174   self.factor['at
+0008b470: 6f6d 5f73 656c 6563 7469 6f6e 275d 0a20  om_selection']. 
+0008b480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b490: 2020 2069 6620 7365 6c66 2e73 7461 636b     if self.stack
+0008b4a0: 4661 6374 6f72 733a 0a20 2020 2020 2020  Factors:.       
 0008b4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b4e0: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-0008b4f0: 5f61 746f 6d5b 2761 746f 6d5f 6964 275d  _atom['atom_id']
-0008b500: 203d 3d20 6174 6f6d 5b27 6174 6f6d 5f69   == atom['atom_i
-0008b510: 6427 5d29 5d0a 2020 2020 2020 2020 2020  d'])].          
-0008b520: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0008b530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b540: 2020 2020 2020 2020 7365 6c66 2e66 6163          self.fac
-0008b550: 746f 725b 2761 746f 6d5f 7365 6c65 6374  tor['atom_select
-0008b560: 696f 6e27 5d20 3d20 5f72 6566 4174 6f6d  ion'] = _refAtom
-0008b570: 5365 6c65 6374 696f 6e0a 2020 2020 2020  Selection.      
-0008b580: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0008b590: 206c 656e 2873 656c 662e 6661 6374 6f72   len(self.factor
-0008b5a0: 5b27 6174 6f6d 5f73 656c 6563 7469 6f6e  ['atom_selection
-0008b5b0: 275d 2920 3d3d 2030 3a0a 2020 2020 2020  ']) == 0:.      
-0008b5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b5d0: 2020 7365 6c66 2e66 6163 746f 725b 2761    self.factor['a
-0008b5e0: 746f 6d5f 6964 275d 203d 205b 4e6f 6e65  tom_id'] = [None
-0008b5f0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0008b600: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-0008b610: 5f66 2e61 7070 656e 6428 6622 5b49 6e73  _f.append(f"[Ins
-0008b620: 7566 6669 6369 656e 7420 6174 6f6d 2073  ufficient atom s
-0008b630: 656c 6563 7469 6f6e 5d20 7b73 656c 662e  election] {self.
-0008b640: 5f5f 6765 7443 7572 7265 6e74 5265 7374  __getCurrentRest
-0008b650: 7261 696e 7428 297d 220a 2020 2020 2020  raint()}".      
+0008b4c0: 2073 656c 662e 7374 6163 6b46 6163 746f   self.stackFacto
+0008b4d0: 7273 2e70 6f70 2829 0a20 2020 2020 2020  rs.pop().       
+0008b4e0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0008b4f0: 662e 6661 6374 6f72 203d 2073 656c 662e  f.factor = self.
+0008b500: 5f5f 636f 6e73 756d 6546 6163 746f 725f  __consumeFactor_
+0008b510: 6578 7072 6573 7369 6f6e 7328 7365 6c66  expressions(self
+0008b520: 2e66 6163 746f 722c 2063 6966 4368 6563  .factor, cifChec
+0008b530: 6b3d 5472 7565 290a 2020 2020 2020 2020  k=True).        
+0008b540: 2020 2020 2020 2020 2020 2020 6966 2027              if '
+0008b550: 6174 6f6d 5f73 656c 6563 7469 6f6e 2720  atom_selection' 
+0008b560: 696e 2073 656c 662e 6661 6374 6f72 3a0a  in self.factor:.
+0008b570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b580: 2020 2020 2020 2020 7365 6c66 2e66 6163          self.fac
+0008b590: 746f 725b 2761 746f 6d5f 7365 6c65 6374  tor['atom_select
+0008b5a0: 696f 6e27 5d20 3d20 5b61 746f 6d20 666f  ion'] = [atom fo
+0008b5b0: 7220 6174 6f6d 2069 6e20 5f72 6566 4174  r atom in _refAt
+0008b5c0: 6f6d 5365 6c65 6374 696f 6e0a 2020 2020  omSelection.    
+0008b5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b600: 2020 2020 2069 6620 6e6f 7420 616e 7928       if not any(
+0008b610: 5f61 746f 6d20 666f 7220 5f61 746f 6d20  _atom for _atom 
+0008b620: 696e 2073 656c 662e 6661 6374 6f72 5b27  in self.factor['
+0008b630: 6174 6f6d 5f73 656c 6563 7469 6f6e 275d  atom_selection']
+0008b640: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0008b650: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008b660: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008b670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b680: 2020 2254 6865 2027 6e6f 7427 2063 6c61    "The 'not' cla
-0008b690: 7573 6520 6861 7320 6e6f 2065 6666 6563  use has no effec
-0008b6a0: 742e 2229 0a0a 2020 2020 2020 2020 2020  t.")..          
-0008b6b0: 2020 2020 2020 656c 6966 2027 6174 6f6d        elif 'atom
-0008b6c0: 5f73 656c 6563 7469 6f6e 2720 6e6f 7420  _selection' not 
-0008b6d0: 696e 2073 656c 662e 6661 6374 6f72 3a0a  in self.factor:.
+0008b680: 2020 2020 2069 6620 5f61 746f 6d5b 2763       if _atom['c
+0008b690: 6861 696e 5f69 6427 5d20 3d3d 2061 746f  hain_id'] == ato
+0008b6a0: 6d5b 2763 6861 696e 5f69 6427 5d0a 2020  m['chain_id'].  
+0008b6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008b6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b6f0: 2020 2020 7365 6c66 2e66 6163 746f 725b      self.factor[
-0008b700: 2761 746f 6d5f 6964 275d 203d 205b 4e6f  'atom_id'] = [No
-0008b710: 6e65 5d0a 2020 2020 2020 2020 2020 2020  ne].            
-0008b720: 2020 2020 2020 2020 7365 6c66 2e5f 5f66          self.__f
-0008b730: 2e61 7070 656e 6428 6622 5b49 6e73 7566  .append(f"[Insuf
-0008b740: 6669 6369 656e 7420 6174 6f6d 2073 656c  ficient atom sel
-0008b750: 6563 7469 6f6e 5d20 7b73 656c 662e 5f5f  ection] {self.__
-0008b760: 6765 7443 7572 7265 6e74 5265 7374 7261  getCurrentRestra
-0008b770: 696e 7428 297d 220a 2020 2020 2020 2020  int()}".        
-0008b780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b790: 2020 2020 2020 2020 2020 2020 2254 6865              "The
-0008b7a0: 2027 6e6f 7427 2063 6c61 7573 6520 6861   'not' clause ha
-0008b7b0: 7320 6e6f 2065 6666 6563 742e 2229 0a0a  s no effect.")..
-0008b7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b7d0: 656c 7365 3a0a 0a20 2020 2020 2020 2020  else:..         
-0008b7e0: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
-0008b7f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0008b800: 2020 2020 2020 2020 205f 6174 6f6d 5365           _atomSe
-0008b810: 6c65 6374 696f 6e20 3d5c 0a20 2020 2020  lection =\.     
-0008b820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b830: 2020 2020 2020 2073 656c 662e 5f5f 6352         self.__cR
-0008b840: 2e67 6574 4469 6374 4c69 7374 5769 7468  .getDictListWith
-0008b850: 4669 6c74 6572 2827 6174 6f6d 5f73 6974  Filter('atom_sit
-0008b860: 6527 2c0a 2020 2020 2020 2020 2020 2020  e',.            
-0008b870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b8a0: 4155 5448 5f41 544f 4d5f 4441 5441 5f49  AUTH_ATOM_DATA_I
-0008b8b0: 5445 4d53 2c0a 2020 2020 2020 2020 2020  TEMS,.          
-0008b8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b6f0: 2020 616e 6420 5f61 746f 6d5b 2773 6571    and _atom['seq
+0008b700: 5f69 6427 5d20 3d3d 2061 746f 6d5b 2773  _id'] == atom['s
+0008b710: 6571 5f69 6427 5d0a 2020 2020 2020 2020  eq_id'].        
+0008b720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b750: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+0008b760: 5f61 746f 6d5b 2761 746f 6d5f 6964 275d  _atom['atom_id']
+0008b770: 203d 3d20 6174 6f6d 5b27 6174 6f6d 5f69   == atom['atom_i
+0008b780: 6427 5d29 5d0a 2020 2020 2020 2020 2020  d'])].          
+0008b790: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+0008b7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b7b0: 2020 2020 2020 2020 7365 6c66 2e66 6163          self.fac
+0008b7c0: 746f 725b 2761 746f 6d5f 7365 6c65 6374  tor['atom_select
+0008b7d0: 696f 6e27 5d20 3d20 5f72 6566 4174 6f6d  ion'] = _refAtom
+0008b7e0: 5365 6c65 6374 696f 6e0a 2020 2020 2020  Selection.      
+0008b7f0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0008b800: 206c 656e 2873 656c 662e 6661 6374 6f72   len(self.factor
+0008b810: 5b27 6174 6f6d 5f73 656c 6563 7469 6f6e  ['atom_selection
+0008b820: 275d 2920 3d3d 2030 3a0a 2020 2020 2020  ']) == 0:.      
+0008b830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b840: 2020 7365 6c66 2e66 6163 746f 725b 2761    self.factor['a
+0008b850: 746f 6d5f 6964 275d 203d 205b 4e6f 6e65  tom_id'] = [None
+0008b860: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0008b870: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+0008b880: 5f66 2e61 7070 656e 6428 6622 5b49 6e73  _f.append(f"[Ins
+0008b890: 7566 6669 6369 656e 7420 6174 6f6d 2073  ufficient atom s
+0008b8a0: 656c 6563 7469 6f6e 5d20 7b73 656c 662e  election] {self.
+0008b8b0: 5f5f 6765 7443 7572 7265 6e74 5265 7374  __getCurrentRest
+0008b8c0: 7261 696e 7428 297d 220a 2020 2020 2020  raint()}".      
 0008b8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008b8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b8f0: 2020 5b7b 276e 616d 6527 3a20 7365 6c66    [{'name': self
-0008b900: 2e5f 5f6d 6f64 656c 4e75 6d4e 616d 652c  .__modelNumName,
-0008b910: 2027 7479 7065 273a 2027 696e 7427 2c0a   'type': 'int',.
-0008b920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b950: 2020 2020 2020 2020 2020 2020 2020 2776                'v
-0008b960: 616c 7565 273a 2073 656c 662e 5f5f 7265  alue': self.__re
-0008b970: 7072 6573 656e 7461 7469 7665 4d6f 6465  presentativeMode
-0008b980: 6c49 647d 2c0a 2020 2020 2020 2020 2020  lId},.          
-0008b990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008b9c0: 2020 207b 276e 616d 6527 3a20 276c 6162     {'name': 'lab
-0008b9d0: 656c 5f61 6c74 5f69 6427 2c20 2774 7970  el_alt_id', 'typ
-0008b9e0: 6527 3a20 2765 6e75 6d27 2c0a 2020 2020  e': 'enum',.    
+0008b8f0: 2020 2254 6865 2027 6e6f 7427 2063 6c61    "The 'not' cla
+0008b900: 7573 6520 6861 7320 6e6f 2065 6666 6563  use has no effec
+0008b910: 742e 2229 0a0a 2020 2020 2020 2020 2020  t.")..          
+0008b920: 2020 2020 2020 656c 6966 2027 6174 6f6d        elif 'atom
+0008b930: 5f73 656c 6563 7469 6f6e 2720 6e6f 7420  _selection' not 
+0008b940: 696e 2073 656c 662e 6661 6374 6f72 3a0a  in self.factor:.
+0008b950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008b960: 2020 2020 7365 6c66 2e66 6163 746f 725b      self.factor[
+0008b970: 2761 746f 6d5f 6964 275d 203d 205b 4e6f  'atom_id'] = [No
+0008b980: 6e65 5d0a 2020 2020 2020 2020 2020 2020  ne].            
+0008b990: 2020 2020 2020 2020 7365 6c66 2e5f 5f66          self.__f
+0008b9a0: 2e61 7070 656e 6428 6622 5b49 6e73 7566  .append(f"[Insuf
+0008b9b0: 6669 6369 656e 7420 6174 6f6d 2073 656c  ficient atom sel
+0008b9c0: 6563 7469 6f6e 5d20 7b73 656c 662e 5f5f  ection] {self.__
+0008b9d0: 6765 7443 7572 7265 6e74 5265 7374 7261  getCurrentRestra
+0008b9e0: 696e 7428 297d 220a 2020 2020 2020 2020  int()}".        
 0008b9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ba00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ba10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ba20: 2020 2020 2020 2020 2020 2765 6e75 6d27            'enum'
-0008ba30: 3a20 2827 4127 297d 0a20 2020 2020 2020  : ('A')}.       
-0008ba40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ba50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ba60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ba70: 2020 2020 2020 5d29 0a0a 2020 2020 2020        ])..      
-0008ba80: 2020 2020 2020 2020 2020 2020 2020 6578                ex
-0008ba90: 6365 7074 2045 7863 6570 7469 6f6e 2061  cept Exception a
-0008baa0: 7320 653a 0a20 2020 2020 2020 2020 2020  s e:.           
-0008bab0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0008bac0: 7365 6c66 2e5f 5f76 6572 626f 7365 3a0a  self.__verbose:.
-0008bad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008bae0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0008baf0: 2e5f 5f6c 6668 2e77 7269 7465 2866 222b  .__lfh.write(f"+
-0008bb00: 5870 6c6f 724d 5250 6172 7365 724c 6973  XplorMRParserLis
-0008bb10: 7465 6e65 722e 6578 6974 4661 6374 6f72  tener.exitFactor
-0008bb20: 2829 202b 2b20 4572 726f 7220 202d 207b  () ++ Error  - {
-0008bb30: 7374 7228 6529 7d22 290a 0a20 2020 2020  str(e)}")..     
-0008bb40: 2020 2020 2020 2020 2020 2020 2020 205f                 _
-0008bb50: 7265 6641 746f 6d53 656c 6563 7469 6f6e  refAtomSelection
-0008bb60: 203d 205b 6174 6f6d 2066 6f72 2061 746f   = [atom for ato
-0008bb70: 6d20 696e 2073 656c 662e 6661 6374 6f72  m in self.factor
-0008bb80: 5b27 6174 6f6d 5f73 656c 6563 7469 6f6e  ['atom_selection
-0008bb90: 275d 2069 6620 6174 6f6d 2069 6e20 5f61  '] if atom in _a
-0008bba0: 746f 6d53 656c 6563 7469 6f6e 5d0a 2020  tomSelection].  
+0008ba00: 2020 2020 2020 2020 2020 2020 2254 6865              "The
+0008ba10: 2027 6e6f 7427 2063 6c61 7573 6520 6861   'not' clause ha
+0008ba20: 7320 6e6f 2065 6666 6563 742e 2229 0a0a  s no effect.")..
+0008ba30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008ba40: 656c 7365 3a0a 0a20 2020 2020 2020 2020  else:..         
+0008ba50: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
+0008ba60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0008ba70: 2020 2020 2020 2020 205f 6174 6f6d 5365           _atomSe
+0008ba80: 6c65 6374 696f 6e20 3d5c 0a20 2020 2020  lection =\.     
+0008ba90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008baa0: 2020 2020 2020 2073 656c 662e 5f5f 6352         self.__cR
+0008bab0: 2e67 6574 4469 6374 4c69 7374 5769 7468  .getDictListWith
+0008bac0: 4669 6c74 6572 2827 6174 6f6d 5f73 6974  Filter('atom_sit
+0008bad0: 6527 2c0a 2020 2020 2020 2020 2020 2020  e',.            
+0008bae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008baf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008bb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008bb10: 4155 5448 5f41 544f 4d5f 4441 5441 5f49  AUTH_ATOM_DATA_I
+0008bb20: 5445 4d53 2c0a 2020 2020 2020 2020 2020  TEMS,.          
+0008bb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008bb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008bb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008bb60: 2020 5b7b 276e 616d 6527 3a20 7365 6c66    [{'name': self
+0008bb70: 2e5f 5f6d 6f64 656c 4e75 6d4e 616d 652c  .__modelNumName,
+0008bb80: 2027 7479 7065 273a 2027 696e 7427 2c0a   'type': 'int',.
+0008bb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008bba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008bbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008bbc0: 2020 7365 6c66 2e66 6163 746f 725b 2761    self.factor['a
-0008bbd0: 746f 6d5f 7365 6c65 6374 696f 6e27 5d20  tom_selection'] 
-0008bbe0: 3d20 5b61 746f 6d20 666f 7220 6174 6f6d  = [atom for atom
-0008bbf0: 2069 6e20 5f61 746f 6d53 656c 6563 7469   in _atomSelecti
-0008bc00: 6f6e 2069 6620 6174 6f6d 206e 6f74 2069  on if atom not i
-0008bc10: 6e20 5f72 6566 4174 6f6d 5365 6c65 6374  n _refAtomSelect
-0008bc20: 696f 6e5d 0a0a 2020 2020 2020 2020 2020  ion]..          
-0008bc30: 2020 2020 2020 2020 2020 6966 206c 656e            if len
-0008bc40: 2873 656c 662e 6661 6374 6f72 5b27 6174  (self.factor['at
-0008bc50: 6f6d 5f73 656c 6563 7469 6f6e 275d 2920  om_selection']) 
-0008bc60: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
-0008bc70: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0008bc80: 6c66 2e66 6163 746f 725b 2761 746f 6d5f  lf.factor['atom_
-0008bc90: 6964 275d 203d 205b 4e6f 6e65 5d0a 2020  id'] = [None].  
-0008bca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008bcb0: 2020 2020 2020 7365 6c66 2e5f 5f66 2e61        self.__f.a
-0008bcc0: 7070 656e 6428 6622 5b49 6e73 7566 6669  ppend(f"[Insuffi
-0008bcd0: 6369 656e 7420 6174 6f6d 2073 656c 6563  cient atom selec
-0008bce0: 7469 6f6e 5d20 7b73 656c 662e 5f5f 6765  tion] {self.__ge
-0008bcf0: 7443 7572 7265 6e74 5265 7374 7261 696e  tCurrentRestrain
-0008bd00: 7428 297d 220a 2020 2020 2020 2020 2020  t()}".          
-0008bd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008bd20: 2020 2020 2020 2020 2020 2020 2020 2254                "T
-0008bd30: 6865 2027 6e6f 7427 2063 6c61 7573 6520  he 'not' clause 
-0008bd40: 6861 7320 6e6f 2065 6666 6563 742e 2229  has no effect.")
-0008bd50: 0a0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-0008bd60: 6966 2063 7478 2e50 6f69 6e74 2829 3a0a  if ctx.Point():.
-0008bd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008bd80: 6966 2073 656c 662e 5f5f 7365 6c5f 6578  if self.__sel_ex
-0008bd90: 7072 5f64 6562 7567 3a0a 2020 2020 2020  pr_debug:.      
-0008bda0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-0008bdb0: 696e 7428 2220 2022 202a 2073 656c 662e  int("  " * self.
-0008bdc0: 6465 7074 6820 2b20 222d 2d3e 2070 6f69  depth + "--> poi
-0008bdd0: 6e74 2229 0a20 2020 2020 2020 2020 2020  nt").           
-0008bde0: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
-0008bdf0: 2e5f 5f68 6173 436f 6f72 643a 0a20 2020  .__hasCoord:.   
-0008be00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008be10: 2072 6574 7572 6e0a 2020 2020 2020 2020   return.        
-0008be20: 2020 2020 2020 2020 6966 2063 7478 2e54          if ctx.T
-0008be30: 6169 6c28 293a 0a0a 2020 2020 2020 2020  ail():..        
-0008be40: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0008be50: 656c 662e 696e 5665 6374 6f72 3344 5f74  elf.inVector3D_t
-0008be60: 6169 6c20 6973 206e 6f74 204e 6f6e 653a  ail is not None:
-0008be70: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0008be80: 2020 2020 2020 2020 2020 7472 793a 0a0a            try:..
-0008be90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008bea0: 2020 2020 2020 2020 2020 2020 5f74 6169              _tai
-0008beb0: 6c20 3d5c 0a20 2020 2020 2020 2020 2020  l =\.           
-0008bec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008bed0: 2020 2020 2073 656c 662e 5f5f 6352 2e67       self.__cR.g
-0008bee0: 6574 4469 6374 4c69 7374 5769 7468 4669  etDictListWithFi
-0008bef0: 6c74 6572 2827 6174 6f6d 5f73 6974 6527  lter('atom_site'
-0008bf00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0008bbc0: 2020 2020 2020 2020 2020 2020 2020 2776                'v
+0008bbd0: 616c 7565 273a 2073 656c 662e 5f5f 7265  alue': self.__re
+0008bbe0: 7072 6573 656e 7461 7469 7665 4d6f 6465  presentativeMode
+0008bbf0: 6c49 647d 2c0a 2020 2020 2020 2020 2020  lId},.          
+0008bc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008bc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008bc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008bc30: 2020 207b 276e 616d 6527 3a20 276c 6162     {'name': 'lab
+0008bc40: 656c 5f61 6c74 5f69 6427 2c20 2774 7970  el_alt_id', 'typ
+0008bc50: 6527 3a20 2765 6e75 6d27 2c0a 2020 2020  e': 'enum',.    
+0008bc60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008bc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008bc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008bc90: 2020 2020 2020 2020 2020 2765 6e75 6d27            'enum'
+0008bca0: 3a20 2827 4127 297d 0a20 2020 2020 2020  : ('A')}.       
+0008bcb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008bcc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008bcd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008bce0: 2020 2020 2020 5d29 0a0a 2020 2020 2020        ])..      
+0008bcf0: 2020 2020 2020 2020 2020 2020 2020 6578                ex
+0008bd00: 6365 7074 2045 7863 6570 7469 6f6e 2061  cept Exception a
+0008bd10: 7320 653a 0a20 2020 2020 2020 2020 2020  s e:.           
+0008bd20: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0008bd30: 7365 6c66 2e5f 5f76 6572 626f 7365 3a0a  self.__verbose:.
+0008bd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008bd50: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0008bd60: 2e5f 5f6c 6668 2e77 7269 7465 2866 222b  .__lfh.write(f"+
+0008bd70: 5870 6c6f 724d 5250 6172 7365 724c 6973  XplorMRParserLis
+0008bd80: 7465 6e65 722e 6578 6974 4661 6374 6f72  tener.exitFactor
+0008bd90: 2829 202b 2b20 4572 726f 7220 202d 207b  () ++ Error  - {
+0008bda0: 7374 7228 6529 7d22 290a 0a20 2020 2020  str(e)}")..     
+0008bdb0: 2020 2020 2020 2020 2020 2020 2020 205f                 _
+0008bdc0: 7265 6641 746f 6d53 656c 6563 7469 6f6e  refAtomSelection
+0008bdd0: 203d 205b 6174 6f6d 2066 6f72 2061 746f   = [atom for ato
+0008bde0: 6d20 696e 2073 656c 662e 6661 6374 6f72  m in self.factor
+0008bdf0: 5b27 6174 6f6d 5f73 656c 6563 7469 6f6e  ['atom_selection
+0008be00: 275d 2069 6620 6174 6f6d 2069 6e20 5f61  '] if atom in _a
+0008be10: 746f 6d53 656c 6563 7469 6f6e 5d0a 2020  tomSelection].  
+0008be20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008be30: 2020 7365 6c66 2e66 6163 746f 725b 2761    self.factor['a
+0008be40: 746f 6d5f 7365 6c65 6374 696f 6e27 5d20  tom_selection'] 
+0008be50: 3d20 5b61 746f 6d20 666f 7220 6174 6f6d  = [atom for atom
+0008be60: 2069 6e20 5f61 746f 6d53 656c 6563 7469   in _atomSelecti
+0008be70: 6f6e 2069 6620 6174 6f6d 206e 6f74 2069  on if atom not i
+0008be80: 6e20 5f72 6566 4174 6f6d 5365 6c65 6374  n _refAtomSelect
+0008be90: 696f 6e5d 0a0a 2020 2020 2020 2020 2020  ion]..          
+0008bea0: 2020 2020 2020 2020 2020 6966 206c 656e            if len
+0008beb0: 2873 656c 662e 6661 6374 6f72 5b27 6174  (self.factor['at
+0008bec0: 6f6d 5f73 656c 6563 7469 6f6e 275d 2920  om_selection']) 
+0008bed0: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
+0008bee0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0008bef0: 6c66 2e66 6163 746f 725b 2761 746f 6d5f  lf.factor['atom_
+0008bf00: 6964 275d 203d 205b 4e6f 6e65 5d0a 2020  id'] = [None].  
 0008bf10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008bf20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008bf30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008bf40: 2020 4341 5254 4e5f 4441 5441 5f49 5445    CARTN_DATA_ITE
-0008bf50: 4d53 2c0a 2020 2020 2020 2020 2020 2020  MS,.            
-0008bf60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008bf70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008bf20: 2020 2020 2020 7365 6c66 2e5f 5f66 2e61        self.__f.a
+0008bf30: 7070 656e 6428 6622 5b49 6e73 7566 6669  ppend(f"[Insuffi
+0008bf40: 6369 656e 7420 6174 6f6d 2073 656c 6563  cient atom selec
+0008bf50: 7469 6f6e 5d20 7b73 656c 662e 5f5f 6765  tion] {self.__ge
+0008bf60: 7443 7572 7265 6e74 5265 7374 7261 696e  tCurrentRestrain
+0008bf70: 7428 297d 220a 2020 2020 2020 2020 2020  t()}".          
 0008bf80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008bf90: 2020 2020 5b7b 276e 616d 6527 3a20 7365      [{'name': se
-0008bfa0: 6c66 2e5f 5f61 7574 6841 7379 6d49 642c  lf.__authAsymId,
-0008bfb0: 2027 7479 7065 273a 2027 7374 7227 2c20   'type': 'str', 
-0008bfc0: 2776 616c 7565 273a 2073 656c 662e 696e  'value': self.in
-0008bfd0: 5665 6374 6f72 3344 5f74 6169 6c5b 2763  Vector3D_tail['c
-0008bfe0: 6861 696e 5f69 6427 5d7d 2c0a 2020 2020  hain_id']},.    
-0008bff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c020: 2020 2020 2020 2020 2020 2020 207b 276e               {'n
-0008c030: 616d 6527 3a20 7365 6c66 2e5f 5f61 7574  ame': self.__aut
-0008c040: 6853 6571 4964 2c20 2774 7970 6527 3a20  hSeqId, 'type': 
-0008c050: 2769 6e74 272c 2027 7661 6c75 6527 3a20  'int', 'value': 
-0008c060: 7365 6c66 2e69 6e56 6563 746f 7233 445f  self.inVector3D_
-0008c070: 7461 696c 5b27 7365 715f 6964 275d 7d2c  tail['seq_id']},
-0008c080: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0008c090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c0c0: 2020 7b27 6e61 6d65 273a 2073 656c 662e    {'name': self.
-0008c0d0: 5f5f 6175 7468 4174 6f6d 4964 2c20 2774  __authAtomId, 't
-0008c0e0: 7970 6527 3a20 2773 7472 272c 2027 7661  ype': 'str', 'va
-0008c0f0: 6c75 6527 3a20 7365 6c66 2e69 6e56 6563  lue': self.inVec
-0008c100: 746f 7233 445f 7461 696c 5b27 6174 6f6d  tor3D_tail['atom
-0008c110: 5f69 6427 5d7d 2c0a 2020 2020 2020 2020  _id']},.        
-0008c120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008bf90: 2020 2020 2020 2020 2020 2020 2020 2254                "T
+0008bfa0: 6865 2027 6e6f 7427 2063 6c61 7573 6520  he 'not' clause 
+0008bfb0: 6861 7320 6e6f 2065 6666 6563 742e 2229  has no effect.")
+0008bfc0: 0a0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+0008bfd0: 6966 2063 7478 2e50 6f69 6e74 2829 3a0a  if ctx.Point():.
+0008bfe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008bff0: 6966 2073 656c 662e 5f5f 7365 6c5f 6578  if self.__sel_ex
+0008c000: 7072 5f64 6562 7567 3a0a 2020 2020 2020  pr_debug:.      
+0008c010: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+0008c020: 696e 7428 2220 2022 202a 2073 656c 662e  int("  " * self.
+0008c030: 6465 7074 6820 2b20 222d 2d3e 2070 6f69  depth + "--> poi
+0008c040: 6e74 2229 0a20 2020 2020 2020 2020 2020  nt").           
+0008c050: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
+0008c060: 2e5f 5f68 6173 436f 6f72 643a 0a20 2020  .__hasCoord:.   
+0008c070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c080: 2072 6574 7572 6e0a 2020 2020 2020 2020   return.        
+0008c090: 2020 2020 2020 2020 6966 2063 7478 2e54          if ctx.T
+0008c0a0: 6169 6c28 293a 0a0a 2020 2020 2020 2020  ail():..        
+0008c0b0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0008c0c0: 656c 662e 696e 5665 6374 6f72 3344 5f74  elf.inVector3D_t
+0008c0d0: 6169 6c20 6973 206e 6f74 204e 6f6e 653a  ail is not None:
+0008c0e0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0008c0f0: 2020 2020 2020 2020 2020 7472 793a 0a0a            try:..
+0008c100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c110: 2020 2020 2020 2020 2020 2020 5f74 6169              _tai
+0008c120: 6c20 3d5c 0a20 2020 2020 2020 2020 2020  l =\.           
 0008c130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c150: 2020 2020 2020 2020 207b 276e 616d 6527           {'name'
-0008c160: 3a20 7365 6c66 2e5f 5f6d 6f64 656c 4e75  : self.__modelNu
-0008c170: 6d4e 616d 652c 2027 7479 7065 273a 2027  mName, 'type': '
-0008c180: 696e 7427 2c0a 2020 2020 2020 2020 2020  int',.          
+0008c140: 2020 2020 2073 656c 662e 5f5f 6352 2e67       self.__cR.g
+0008c150: 6574 4469 6374 4c69 7374 5769 7468 4669  etDictListWithFi
+0008c160: 6c74 6572 2827 6174 6f6d 5f73 6974 6527  lter('atom_site'
+0008c170: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0008c180: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008c190: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008c1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c1c0: 2020 2020 2020 2020 2776 616c 7565 273a          'value':
-0008c1d0: 2073 656c 662e 5f5f 7265 7072 6573 656e   self.__represen
-0008c1e0: 7461 7469 7665 4d6f 6465 6c49 647d 2c0a  tativeModelId},.
+0008c1b0: 2020 4341 5254 4e5f 4441 5441 5f49 5445    CARTN_DATA_ITE
+0008c1c0: 4d53 2c0a 2020 2020 2020 2020 2020 2020  MS,.            
+0008c1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008c1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c230: 207b 276e 616d 6527 3a20 276c 6162 656c   {'name': 'label
-0008c240: 5f61 6c74 5f69 6427 2c20 2774 7970 6527  _alt_id', 'type'
-0008c250: 3a20 2765 6e75 6d27 2c0a 2020 2020 2020  : 'enum',.      
+0008c200: 2020 2020 5b7b 276e 616d 6527 3a20 7365      [{'name': se
+0008c210: 6c66 2e5f 5f61 7574 6841 7379 6d49 642c  lf.__authAsymId,
+0008c220: 2027 7479 7065 273a 2027 7374 7227 2c20   'type': 'str', 
+0008c230: 2776 616c 7565 273a 2073 656c 662e 696e  'value': self.in
+0008c240: 5665 6374 6f72 3344 5f74 6169 6c5b 2763  Vector3D_tail['c
+0008c250: 6861 696e 5f69 6427 5d7d 2c0a 2020 2020  hain_id']},.    
 0008c260: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008c270: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008c280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c290: 2020 2020 2020 2020 2020 2020 2765 6e75              'enu
-0008c2a0: 6d27 3a20 2827 4127 297d 0a20 2020 2020  m': ('A')}.     
-0008c2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c2e0: 2020 2020 2020 2020 2020 2020 5d29 0a0a              ])..
-0008c2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c300: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-0008c310: 656e 285f 7461 696c 2920 3d3d 2031 3a0a  en(_tail) == 1:.
+0008c290: 2020 2020 2020 2020 2020 2020 207b 276e               {'n
+0008c2a0: 616d 6527 3a20 7365 6c66 2e5f 5f61 7574  ame': self.__aut
+0008c2b0: 6853 6571 4964 2c20 2774 7970 6527 3a20  hSeqId, 'type': 
+0008c2c0: 2769 6e74 272c 2027 7661 6c75 6527 3a20  'int', 'value': 
+0008c2d0: 7365 6c66 2e69 6e56 6563 746f 7233 445f  self.inVector3D_
+0008c2e0: 7461 696c 5b27 7365 715f 6964 275d 7d2c  tail['seq_id']},
+0008c2f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0008c300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c310: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008c320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c340: 7461 696c 203d 2074 6f4e 7041 7272 6179  tail = toNpArray
-0008c350: 285f 7461 696c 5b30 5d29 0a0a 2020 2020  (_tail[0])..    
-0008c360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c370: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0008c380: 656c 662e 696e 5665 6374 6f72 3344 5f68  elf.inVector3D_h
-0008c390: 6561 6420 6973 204e 6f6e 653a 0a20 2020  ead is None:.   
+0008c330: 2020 7b27 6e61 6d65 273a 2073 656c 662e    {'name': self.
+0008c340: 5f5f 6175 7468 4174 6f6d 4964 2c20 2774  __authAtomId, 't
+0008c350: 7970 6527 3a20 2773 7472 272c 2027 7661  ype': 'str', 'va
+0008c360: 6c75 6527 3a20 7365 6c66 2e69 6e56 6563  lue': self.inVec
+0008c370: 746f 7233 445f 7461 696c 5b27 6174 6f6d  tor3D_tail['atom
+0008c380: 5f69 6427 5d7d 2c0a 2020 2020 2020 2020  _id']},.        
+0008c390: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008c3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008c3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c3c0: 2073 656c 662e 7665 6374 6f72 3344 203d   self.vector3D =
-0008c3d0: 2074 6169 6c0a 0a20 2020 2020 2020 2020   tail..         
-0008c3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c3f0: 2020 2020 2020 2065 6c73 653a 0a0a 2020         else:..  
+0008c3c0: 2020 2020 2020 2020 207b 276e 616d 6527           {'name'
+0008c3d0: 3a20 7365 6c66 2e5f 5f6d 6f64 656c 4e75  : self.__modelNu
+0008c3e0: 6d4e 616d 652c 2027 7479 7065 273a 2027  mName, 'type': '
+0008c3f0: 696e 7427 2c0a 2020 2020 2020 2020 2020  int',.          
 0008c400: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008c410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c420: 2020 5f68 6561 6420 3d5c 0a20 2020 2020    _head =\.     
-0008c430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c450: 2020 2073 656c 662e 5f5f 6352 2e67 6574     self.__cR.get
-0008c460: 4469 6374 4c69 7374 5769 7468 4669 6c74  DictListWithFilt
-0008c470: 6572 2827 6174 6f6d 5f73 6974 6527 2c0a  er('atom_site',.
+0008c420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c430: 2020 2020 2020 2020 2776 616c 7565 273a          'value':
+0008c440: 2073 656c 662e 5f5f 7265 7072 6573 656e   self.__represen
+0008c450: 7461 7469 7665 4d6f 6465 6c49 647d 2c0a  tativeModelId},.
+0008c460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c470: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008c480: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008c490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c4c0: 2020 2020 2020 2020 4341 5254 4e5f 4441          CARTN_DA
-0008c4d0: 5441 5f49 5445 4d53 2c0a 2020 2020 2020  TA_ITEMS,.      
+0008c4a0: 207b 276e 616d 6527 3a20 276c 6162 656c   {'name': 'label
+0008c4b0: 5f61 6c74 5f69 6427 2c20 2774 7970 6527  _alt_id', 'type'
+0008c4c0: 3a20 2765 6e75 6d27 2c0a 2020 2020 2020  : 'enum',.      
+0008c4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008c4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008c4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c520: 2020 5b7b 276e 616d 6527 3a20 7365 6c66    [{'name': self
-0008c530: 2e5f 5f61 7574 6841 7379 6d49 642c 2027  .__authAsymId, '
-0008c540: 7479 7065 273a 2027 7374 7227 2c20 2776  type': 'str', 'v
-0008c550: 616c 7565 273a 2073 656c 662e 696e 5665  alue': self.inVe
-0008c560: 6374 6f72 3344 5f68 6561 645b 2763 6861  ctor3D_head['cha
-0008c570: 696e 5f69 6427 5d7d 2c0a 2020 2020 2020  in_id']},.      
-0008c580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c500: 2020 2020 2020 2020 2020 2020 2765 6e75              'enu
+0008c510: 6d27 3a20 2827 4127 297d 0a20 2020 2020  m': ('A')}.     
+0008c520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c550: 2020 2020 2020 2020 2020 2020 5d29 0a0a              ])..
+0008c560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c570: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+0008c580: 656e 285f 7461 696c 2920 3d3d 2031 3a0a  en(_tail) == 1:.
 0008c590: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008c5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c5c0: 2020 207b 276e 616d 6527 3a20 7365 6c66     {'name': self
-0008c5d0: 2e5f 5f61 7574 6853 6571 4964 2c20 2774  .__authSeqId, 't
-0008c5e0: 7970 6527 3a20 2769 6e74 272c 2027 7661  ype': 'int', 'va
-0008c5f0: 6c75 6527 3a20 7365 6c66 2e69 6e56 6563  lue': self.inVec
-0008c600: 746f 7233 445f 6865 6164 5b27 7365 715f  tor3D_head['seq_
-0008c610: 6964 275d 7d2c 0a20 2020 2020 2020 2020  id']},.         
+0008c5b0: 7461 696c 203d 2074 6f4e 7041 7272 6179  tail = toNpArray
+0008c5c0: 285f 7461 696c 5b30 5d29 0a0a 2020 2020  (_tail[0])..    
+0008c5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c5e0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0008c5f0: 656c 662e 696e 5665 6374 6f72 3344 5f68  elf.inVector3D_h
+0008c600: 6561 6420 6973 204e 6f6e 653a 0a20 2020  ead is None:.   
+0008c610: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008c620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c630: 2073 656c 662e 7665 6374 6f72 3344 203d   self.vector3D =
+0008c640: 2074 6169 6c0a 0a20 2020 2020 2020 2020   tail..         
 0008c650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c660: 7b27 6e61 6d65 273a 2073 656c 662e 5f5f  {'name': self.__
-0008c670: 6175 7468 4174 6f6d 4964 2c20 2774 7970  authAtomId, 'typ
-0008c680: 6527 3a20 2773 7472 272c 2027 7661 6c75  e': 'str', 'valu
-0008c690: 6527 3a20 7365 6c66 2e69 6e56 6563 746f  e': self.inVecto
-0008c6a0: 7233 445f 6865 6164 5b27 6174 6f6d 5f69  r3D_head['atom_i
-0008c6b0: 6427 5d7d 2c0a 2020 2020 2020 2020 2020  d']},.          
-0008c6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c6f0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-0008c700: 276e 616d 6527 3a20 7365 6c66 2e5f 5f6d  'name': self.__m
-0008c710: 6f64 656c 4e75 6d4e 616d 652c 2027 7479  odelNumName, 'ty
-0008c720: 7065 273a 2027 696e 7427 2c0a 2020 2020  pe': 'int',.    
-0008c730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c660: 2020 2020 2020 2065 6c73 653a 0a0a 2020         else:..  
+0008c670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c690: 2020 5f68 6561 6420 3d5c 0a20 2020 2020    _head =\.     
+0008c6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c6c0: 2020 2073 656c 662e 5f5f 6352 2e67 6574     self.__cR.get
+0008c6d0: 4469 6374 4c69 7374 5769 7468 4669 6c74  DictListWithFilt
+0008c6e0: 6572 2827 6174 6f6d 5f73 6974 6527 2c0a  er('atom_site',.
+0008c6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c730: 2020 2020 2020 2020 4341 5254 4e5f 4441          CARTN_DA
+0008c740: 5441 5f49 5445 4d53 2c0a 2020 2020 2020  TA_ITEMS,.      
 0008c750: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008c760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c770: 2020 2020 2020 2776 616c 7565 273a 2073        'value': s
-0008c780: 656c 662e 5f5f 7265 7072 6573 656e 7461  elf.__representa
-0008c790: 7469 7665 4d6f 6465 6c49 647d 2c0a 2020  tiveModelId},.  
-0008c7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c7e0: 2020 2020 2020 207b 276e 616d 6527 3a20         {'name': 
-0008c7f0: 276c 6162 656c 5f61 6c74 5f69 6427 2c20  'label_alt_id', 
-0008c800: 2774 7970 6527 3a20 2765 6e75 6d27 2c0a  'type': 'enum',.
+0008c770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c790: 2020 5b7b 276e 616d 6527 3a20 7365 6c66    [{'name': self
+0008c7a0: 2e5f 5f61 7574 6841 7379 6d49 642c 2027  .__authAsymId, '
+0008c7b0: 7479 7065 273a 2027 7374 7227 2c20 2776  type': 'str', 'v
+0008c7c0: 616c 7565 273a 2073 656c 662e 696e 5665  alue': self.inVe
+0008c7d0: 6374 6f72 3344 5f68 6561 645b 2763 6861  ctor3D_head['cha
+0008c7e0: 696e 5f69 6427 5d7d 2c0a 2020 2020 2020  in_id']},.      
+0008c7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c800: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008c810: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008c820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c850: 2020 2020 2020 2020 2020 2765 6e75 6d27            'enum'
-0008c860: 3a20 2827 4127 297d 0a20 2020 2020 2020  : ('A')}.       
-0008c870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c830: 2020 207b 276e 616d 6527 3a20 7365 6c66     {'name': self
+0008c840: 2e5f 5f61 7574 6853 6571 4964 2c20 2774  .__authSeqId, 't
+0008c850: 7970 6527 3a20 2769 6e74 272c 2027 7661  ype': 'int', 'va
+0008c860: 6c75 6527 3a20 7365 6c66 2e69 6e56 6563  lue': self.inVec
+0008c870: 746f 7233 445f 6865 6164 5b27 7365 715f  tor3D_head['seq_
+0008c880: 6964 275d 7d2c 0a20 2020 2020 2020 2020  id']},.         
 0008c890: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008c8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c8b0: 2020 5d29 0a0a 2020 2020 2020 2020 2020    ])..          
+0008c8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008c8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c8d0: 2020 2020 2020 2020 2020 6966 206c 656e            if len
-0008c8e0: 285f 6865 6164 2920 3d3d 2031 3a0a 2020  (_head) == 1:.  
-0008c8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c910: 2020 2020 2020 6865 6164 203d 2074 6f4e        head = toN
-0008c920: 7041 7272 6179 285f 6865 6164 5b30 5d29  pArray(_head[0])
-0008c930: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0008c8d0: 7b27 6e61 6d65 273a 2073 656c 662e 5f5f  {'name': self.__
+0008c8e0: 6175 7468 4174 6f6d 4964 2c20 2774 7970  authAtomId, 'typ
+0008c8f0: 6527 3a20 2773 7472 272c 2027 7661 6c75  e': 'str', 'valu
+0008c900: 6527 3a20 7365 6c66 2e69 6e56 6563 746f  e': self.inVecto
+0008c910: 7233 445f 6865 6164 5b27 6174 6f6d 5f69  r3D_head['atom_i
+0008c920: 6427 5d7d 2c0a 2020 2020 2020 2020 2020  d']},.          
+0008c930: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008c940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008c950: 2020 2020 2020 2020 2073 656c 662e 7665           self.ve
-0008c960: 6374 6f72 3344 203d 206e 756d 7079 2e73  ctor3D = numpy.s
-0008c970: 7562 7472 6163 7428 7461 696c 2c20 6865  ubtract(tail, he
-0008c980: 6164 2c20 6474 7970 653d 666c 6f61 7429  ad, dtype=float)
-0008c990: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0008c9a0: 2020 2020 2020 2020 2020 6578 6365 7074            except
-0008c9b0: 2045 7863 6570 7469 6f6e 2061 7320 653a   Exception as e:
-0008c9c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0008c9d0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0008c9e0: 7365 6c66 2e5f 5f76 6572 626f 7365 3a0a  self.__verbose:.
-0008c9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ca00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ca10: 7365 6c66 2e5f 5f6c 6668 2e77 7269 7465  self.__lfh.write
-0008ca20: 2866 222b 5870 6c6f 724d 5250 6172 7365  (f"+XplorMRParse
-0008ca30: 724c 6973 7465 6e65 722e 6578 6974 4661  rListener.exitFa
-0008ca40: 6374 6f72 2829 202b 2b20 4572 726f 7220  ctor() ++ Error 
-0008ca50: 202d 207b 7374 7228 6529 7d22 290a 0a20   - {str(e)}").. 
-0008ca60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ca70: 2020 2073 656c 662e 696e 5665 6374 6f72     self.inVector
-0008ca80: 3344 5f74 6169 6c20 3d20 7365 6c66 2e69  3D_tail = self.i
-0008ca90: 6e56 6563 746f 7233 445f 6865 6164 203d  nVector3D_head =
-0008caa0: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
-0008cab0: 2020 2020 2020 2020 2020 6966 206c 656e            if len
-0008cac0: 2873 656c 662e 6e75 6d62 6572 4653 656c  (self.numberFSel
-0008cad0: 6563 7469 6f6e 2920 3d3d 2030 206f 7220  ection) == 0 or 
-0008cae0: 4e6f 6e65 2069 6e20 7365 6c66 2e6e 756d  None in self.num
-0008caf0: 6265 7246 5365 6c65 6374 696f 6e3a 0a20  berFSelection:. 
+0008c950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c960: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+0008c970: 276e 616d 6527 3a20 7365 6c66 2e5f 5f6d  'name': self.__m
+0008c980: 6f64 656c 4e75 6d4e 616d 652c 2027 7479  odelNumName, 'ty
+0008c990: 7065 273a 2027 696e 7427 2c0a 2020 2020  pe': 'int',.    
+0008c9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008c9e0: 2020 2020 2020 2776 616c 7565 273a 2073        'value': s
+0008c9f0: 656c 662e 5f5f 7265 7072 6573 656e 7461  elf.__representa
+0008ca00: 7469 7665 4d6f 6465 6c49 647d 2c0a 2020  tiveModelId},.  
+0008ca10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008ca20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008ca30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008ca40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008ca50: 2020 2020 2020 207b 276e 616d 6527 3a20         {'name': 
+0008ca60: 276c 6162 656c 5f61 6c74 5f69 6427 2c20  'label_alt_id', 
+0008ca70: 2774 7970 6527 3a20 2765 6e75 6d27 2c0a  'type': 'enum',.
+0008ca80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008ca90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008caa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008cab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008cac0: 2020 2020 2020 2020 2020 2765 6e75 6d27            'enum'
+0008cad0: 3a20 2827 4127 297d 0a20 2020 2020 2020  : ('A')}.       
+0008cae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008caf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008cb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008cb10: 2020 2020 2020 2072 6574 7572 6e0a 2020         return.  
-0008cb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008cb30: 2020 6375 7420 3d20 7365 6c66 2e6e 756d    cut = self.num
-0008cb40: 6265 7246 5365 6c65 6374 696f 6e5b 305d  berFSelection[0]
-0008cb50: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0008cb60: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0008cb70: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-0008cb80: 656e 2873 656c 662e 6e75 6d62 6572 4653  en(self.numberFS
-0008cb90: 656c 6563 7469 6f6e 2920 3d3d 2030 206f  election) == 0 o
-0008cba0: 7220 4e6f 6e65 2069 6e20 7365 6c66 2e6e  r None in self.n
-0008cbb0: 756d 6265 7246 5365 6c65 6374 696f 6e3a  umberFSelection:
-0008cbc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0008cbd0: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
-0008cbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008cbf0: 2020 2020 7365 6c66 2e76 6563 746f 7233      self.vector3
-0008cc00: 4420 3d20 5b73 656c 662e 6e75 6d62 6572  D = [self.number
-0008cc10: 4653 656c 6563 7469 6f6e 5b30 5d2c 2073  FSelection[0], s
-0008cc20: 656c 662e 6e75 6d62 6572 4653 656c 6563  elf.numberFSelec
-0008cc30: 7469 6f6e 5b31 5d2c 2073 656c 662e 6e75  tion[1], self.nu
-0008cc40: 6d62 6572 4653 656c 6563 7469 6f6e 5b32  mberFSelection[2
-0008cc50: 5d5d 0a20 2020 2020 2020 2020 2020 2020  ]].             
-0008cc60: 2020 2020 2020 2063 7574 203d 2073 656c         cut = sel
-0008cc70: 662e 6e75 6d62 6572 4653 656c 6563 7469  f.numberFSelecti
-0008cc80: 6f6e 5b33 5d0a 0a20 2020 2020 2020 2020  on[3]..         
-0008cc90: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
-0008cca0: 6563 746f 7233 4420 6973 204e 6f6e 653a  ector3D is None:
-0008ccb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0008ccc0: 2020 2020 2073 656c 662e 6661 6374 6f72       self.factor
-0008ccd0: 5b27 6174 6f6d 5f69 6427 5d20 3d20 5b4e  ['atom_id'] = [N
-0008cce0: 6f6e 655d 0a20 2020 2020 2020 2020 2020  one].           
-0008ccf0: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
-0008cd00: 662e 6170 7065 6e64 2866 225b 496e 7375  f.append(f"[Insu
-0008cd10: 6666 6963 6965 6e74 2061 746f 6d20 7365  fficient atom se
-0008cd20: 6c65 6374 696f 6e5d 207b 7365 6c66 2e5f  lection] {self._
-0008cd30: 5f67 6574 4375 7272 656e 7452 6573 7472  _getCurrentRestr
-0008cd40: 6169 6e74 2829 7d22 0a20 2020 2020 2020  aint()}".       
-0008cd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008cd60: 2020 2020 2020 2020 2020 2020 2022 5468               "Th
-0008cd70: 6520 2770 6f69 6e74 2720 636c 6175 7365  e 'point' clause
-0008cd80: 2068 6173 206e 6f20 6566 6665 6374 2062   has no effect b
-0008cd90: 6563 6175 7365 206e 6f20 3364 2d76 6563  ecause no 3d-vec
-0008cda0: 746f 7220 6973 2073 7065 6369 6669 6564  tor is specified
-0008cdb0: 2e22 290a 0a20 2020 2020 2020 2020 2020  .")..           
-0008cdc0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0008cdd0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0008cde0: 746f 6d53 656c 6563 7469 6f6e 203d 205b  tomSelection = [
-0008cdf0: 5d0a 0a20 2020 2020 2020 2020 2020 2020  ]..             
-0008ce00: 2020 2020 2020 2074 7279 3a0a 0a20 2020         try:..   
-0008ce10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ce20: 2020 2020 205f 6e65 6967 6862 6f72 203d       _neighbor =
-0008ce30: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
-0008ce40: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0008ce50: 6c66 2e5f 5f63 522e 6765 7444 6963 744c  lf.__cR.getDictL
-0008ce60: 6973 7457 6974 6846 696c 7465 7228 2761  istWithFilter('a
-0008ce70: 746f 6d5f 7369 7465 272c 0a20 2020 2020  tom_site',.     
-0008ce80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ce90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008cea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ceb0: 2020 2020 2020 2041 5554 485f 4154 4f4d         AUTH_ATOM
-0008cec0: 5f43 4152 544e 5f44 4154 415f 4954 454d  _CARTN_DATA_ITEM
-0008ced0: 532c 0a20 2020 2020 2020 2020 2020 2020  S,.             
-0008cee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008cef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008cf00: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0008cf10: 7b27 6e61 6d65 273a 2027 4361 7274 6e5f  {'name': 'Cartn_
-0008cf20: 7827 2c20 2774 7970 6527 3a20 2772 616e  x', 'type': 'ran
-0008cf30: 6765 2d66 6c6f 6174 272c 0a20 2020 2020  ge-float',.     
-0008cf40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008cf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008cf60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008cf70: 2020 2020 2020 2020 2027 7261 6e67 6527           'range'
-0008cf80: 3a20 7b27 6d69 6e5f 6578 636c 7573 6976  : {'min_exclusiv
-0008cf90: 6527 3a20 2873 656c 662e 7665 6374 6f72  e': (self.vector
-0008cfa0: 3344 5b30 5d20 2d20 6375 7429 2c0a 2020  3D[0] - cut),.  
-0008cfb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008cb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008cb20: 2020 5d29 0a0a 2020 2020 2020 2020 2020    ])..          
+0008cb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008cb40: 2020 2020 2020 2020 2020 6966 206c 656e            if len
+0008cb50: 285f 6865 6164 2920 3d3d 2031 3a0a 2020  (_head) == 1:.  
+0008cb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008cb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008cb80: 2020 2020 2020 6865 6164 203d 2074 6f4e        head = toN
+0008cb90: 7041 7272 6179 285f 6865 6164 5b30 5d29  pArray(_head[0])
+0008cba0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0008cbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008cbc0: 2020 2020 2020 2020 2073 656c 662e 7665           self.ve
+0008cbd0: 6374 6f72 3344 203d 206e 756d 7079 2e73  ctor3D = numpy.s
+0008cbe0: 7562 7472 6163 7428 7461 696c 2c20 6865  ubtract(tail, he
+0008cbf0: 6164 2c20 6474 7970 653d 666c 6f61 7429  ad, dtype=float)
+0008cc00: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0008cc10: 2020 2020 2020 2020 2020 6578 6365 7074            except
+0008cc20: 2045 7863 6570 7469 6f6e 2061 7320 653a   Exception as e:
+0008cc30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0008cc40: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0008cc50: 7365 6c66 2e5f 5f76 6572 626f 7365 3a0a  self.__verbose:.
+0008cc60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008cc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008cc80: 7365 6c66 2e5f 5f6c 6668 2e77 7269 7465  self.__lfh.write
+0008cc90: 2866 222b 5870 6c6f 724d 5250 6172 7365  (f"+XplorMRParse
+0008cca0: 724c 6973 7465 6e65 722e 6578 6974 4661  rListener.exitFa
+0008ccb0: 6374 6f72 2829 202b 2b20 4572 726f 7220  ctor() ++ Error 
+0008ccc0: 202d 207b 7374 7228 6529 7d22 290a 0a20   - {str(e)}").. 
+0008ccd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008cce0: 2020 2073 656c 662e 696e 5665 6374 6f72     self.inVector
+0008ccf0: 3344 5f74 6169 6c20 3d20 7365 6c66 2e69  3D_tail = self.i
+0008cd00: 6e56 6563 746f 7233 445f 6865 6164 203d  nVector3D_head =
+0008cd10: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
+0008cd20: 2020 2020 2020 2020 2020 6966 206c 656e            if len
+0008cd30: 2873 656c 662e 6e75 6d62 6572 4653 656c  (self.numberFSel
+0008cd40: 6563 7469 6f6e 2920 3d3d 2030 206f 7220  ection) == 0 or 
+0008cd50: 4e6f 6e65 2069 6e20 7365 6c66 2e6e 756d  None in self.num
+0008cd60: 6265 7246 5365 6c65 6374 696f 6e3a 0a20  berFSelection:. 
+0008cd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008cd80: 2020 2020 2020 2072 6574 7572 6e0a 2020         return.  
+0008cd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008cda0: 2020 6375 7420 3d20 7365 6c66 2e6e 756d    cut = self.num
+0008cdb0: 6265 7246 5365 6c65 6374 696f 6e5b 305d  berFSelection[0]
+0008cdc0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0008cdd0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0008cde0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+0008cdf0: 656e 2873 656c 662e 6e75 6d62 6572 4653  en(self.numberFS
+0008ce00: 656c 6563 7469 6f6e 2920 3d3d 2030 206f  election) == 0 o
+0008ce10: 7220 4e6f 6e65 2069 6e20 7365 6c66 2e6e  r None in self.n
+0008ce20: 756d 6265 7246 5365 6c65 6374 696f 6e3a  umberFSelection:
+0008ce30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0008ce40: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
+0008ce50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008ce60: 2020 2020 7365 6c66 2e76 6563 746f 7233      self.vector3
+0008ce70: 4420 3d20 5b73 656c 662e 6e75 6d62 6572  D = [self.number
+0008ce80: 4653 656c 6563 7469 6f6e 5b30 5d2c 2073  FSelection[0], s
+0008ce90: 656c 662e 6e75 6d62 6572 4653 656c 6563  elf.numberFSelec
+0008cea0: 7469 6f6e 5b31 5d2c 2073 656c 662e 6e75  tion[1], self.nu
+0008ceb0: 6d62 6572 4653 656c 6563 7469 6f6e 5b32  mberFSelection[2
+0008cec0: 5d5d 0a20 2020 2020 2020 2020 2020 2020  ]].             
+0008ced0: 2020 2020 2020 2063 7574 203d 2073 656c         cut = sel
+0008cee0: 662e 6e75 6d62 6572 4653 656c 6563 7469  f.numberFSelecti
+0008cef0: 6f6e 5b33 5d0a 0a20 2020 2020 2020 2020  on[3]..         
+0008cf00: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
+0008cf10: 6563 746f 7233 4420 6973 204e 6f6e 653a  ector3D is None:
+0008cf20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0008cf30: 2020 2020 2073 656c 662e 6661 6374 6f72       self.factor
+0008cf40: 5b27 6174 6f6d 5f69 6427 5d20 3d20 5b4e  ['atom_id'] = [N
+0008cf50: 6f6e 655d 0a20 2020 2020 2020 2020 2020  one].           
+0008cf60: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
+0008cf70: 662e 6170 7065 6e64 2866 225b 496e 7375  f.append(f"[Insu
+0008cf80: 6666 6963 6965 6e74 2061 746f 6d20 7365  fficient atom se
+0008cf90: 6c65 6374 696f 6e5d 207b 7365 6c66 2e5f  lection] {self._
+0008cfa0: 5f67 6574 4375 7272 656e 7452 6573 7472  _getCurrentRestr
+0008cfb0: 6169 6e74 2829 7d22 0a20 2020 2020 2020  aint()}".       
 0008cfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008cfd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008cfe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008cff0: 2020 2020 2020 276d 6178 5f65 7863 6c75        'max_exclu
-0008d000: 7369 7665 273a 2028 7365 6c66 2e76 6563  sive': (self.vec
-0008d010: 746f 7233 445b 305d 202b 2063 7574 297d  tor3D[0] + cut)}
-0008d020: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
-0008d030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d060: 7b27 6e61 6d65 273a 2027 4361 7274 6e5f  {'name': 'Cartn_
-0008d070: 7927 2c20 2774 7970 6527 3a20 2772 616e  y', 'type': 'ran
-0008d080: 6765 2d66 6c6f 6174 272c 0a20 2020 2020  ge-float',.     
-0008d090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d0c0: 2020 2020 2020 2020 2027 7261 6e67 6527           'range'
-0008d0d0: 3a20 7b27 6d69 6e5f 6578 636c 7573 6976  : {'min_exclusiv
-0008d0e0: 6527 3a20 2873 656c 662e 7665 6374 6f72  e': (self.vector
-0008d0f0: 3344 5b31 5d20 2d20 6375 7429 2c0a 2020  3D[1] - cut),.  
+0008cfd0: 2020 2020 2020 2020 2020 2020 2022 5468               "Th
+0008cfe0: 6520 2770 6f69 6e74 2720 636c 6175 7365  e 'point' clause
+0008cff0: 2068 6173 206e 6f20 6566 6665 6374 2062   has no effect b
+0008d000: 6563 6175 7365 206e 6f20 3364 2d76 6563  ecause no 3d-vec
+0008d010: 746f 7220 6973 2073 7065 6369 6669 6564  tor is specified
+0008d020: 2e22 290a 0a20 2020 2020 2020 2020 2020  .")..           
+0008d030: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0008d040: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0008d050: 746f 6d53 656c 6563 7469 6f6e 203d 205b  tomSelection = [
+0008d060: 5d0a 0a20 2020 2020 2020 2020 2020 2020  ]..             
+0008d070: 2020 2020 2020 2074 7279 3a0a 0a20 2020         try:..   
+0008d080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d090: 2020 2020 205f 6e65 6967 6862 6f72 203d       _neighbor =
+0008d0a0: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
+0008d0b0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0008d0c0: 6c66 2e5f 5f63 522e 6765 7444 6963 744c  lf.__cR.getDictL
+0008d0d0: 6973 7457 6974 6846 696c 7465 7228 2761  istWithFilter('a
+0008d0e0: 746f 6d5f 7369 7465 272c 0a20 2020 2020  tom_site',.     
+0008d0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008d100: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008d110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d140: 2020 2020 2020 276d 6178 5f65 7863 6c75        'max_exclu
-0008d150: 7369 7665 273a 2028 7365 6c66 2e76 6563  sive': (self.vec
-0008d160: 746f 7233 445b 315d 202b 2063 7574 297d  tor3D[1] + cut)}
-0008d170: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
-0008d180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d1b0: 7b27 6e61 6d65 273a 2027 4361 7274 6e5f  {'name': 'Cartn_
-0008d1c0: 7a27 2c20 2774 7970 6527 3a20 2772 616e  z', 'type': 'ran
-0008d1d0: 6765 2d66 6c6f 6174 272c 0a20 2020 2020  ge-float',.     
-0008d1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d210: 2020 2020 2020 2020 2027 7261 6e67 6527           'range'
-0008d220: 3a20 7b27 6d69 6e5f 6578 636c 7573 6976  : {'min_exclusiv
-0008d230: 6527 3a20 2873 656c 662e 7665 6374 6f72  e': (self.vector
-0008d240: 3344 5b32 5d20 2d20 6375 7429 2c0a 2020  3D[2] - cut),.  
+0008d120: 2020 2020 2020 2041 5554 485f 4154 4f4d         AUTH_ATOM
+0008d130: 5f43 4152 544e 5f44 4154 415f 4954 454d  _CARTN_DATA_ITEM
+0008d140: 532c 0a20 2020 2020 2020 2020 2020 2020  S,.             
+0008d150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d170: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+0008d180: 7b27 6e61 6d65 273a 2027 4361 7274 6e5f  {'name': 'Cartn_
+0008d190: 7827 2c20 2774 7970 6527 3a20 2772 616e  x', 'type': 'ran
+0008d1a0: 6765 2d66 6c6f 6174 272c 0a20 2020 2020  ge-float',.     
+0008d1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d1e0: 2020 2020 2020 2020 2027 7261 6e67 6527           'range'
+0008d1f0: 3a20 7b27 6d69 6e5f 6578 636c 7573 6976  : {'min_exclusiv
+0008d200: 6527 3a20 2873 656c 662e 7665 6374 6f72  e': (self.vector
+0008d210: 3344 5b30 5d20 2d20 6375 7429 2c0a 2020  3D[0] - cut),.  
+0008d220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d240: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008d250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d290: 2020 2020 2020 276d 6178 5f65 7863 6c75        'max_exclu
-0008d2a0: 7369 7665 273a 2028 7365 6c66 2e76 6563  sive': (self.vec
-0008d2b0: 746f 7233 445b 325d 202b 2063 7574 297d  tor3D[2] + cut)}
-0008d2c0: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
-0008d2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d300: 7b27 6e61 6d65 273a 2073 656c 662e 5f5f  {'name': self.__
-0008d310: 6d6f 6465 6c4e 756d 4e61 6d65 2c20 2774  modelNumName, 't
-0008d320: 7970 6527 3a20 2769 6e74 272c 0a20 2020  ype': 'int',.   
-0008d330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d360: 2020 2020 2020 2020 2020 2027 7661 6c75             'valu
-0008d370: 6527 3a20 7365 6c66 2e5f 5f72 6570 7265  e': self.__repre
-0008d380: 7365 6e74 6174 6976 654d 6f64 656c 4964  sentativeModelId
-0008d390: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
+0008d260: 2020 2020 2020 276d 6178 5f65 7863 6c75        'max_exclu
+0008d270: 7369 7665 273a 2028 7365 6c66 2e76 6563  sive': (self.vec
+0008d280: 746f 7233 445b 305d 202b 2063 7574 297d  tor3D[0] + cut)}
+0008d290: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
+0008d2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d2d0: 7b27 6e61 6d65 273a 2027 4361 7274 6e5f  {'name': 'Cartn_
+0008d2e0: 7927 2c20 2774 7970 6527 3a20 2772 616e  y', 'type': 'ran
+0008d2f0: 6765 2d66 6c6f 6174 272c 0a20 2020 2020  ge-float',.     
+0008d300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d330: 2020 2020 2020 2020 2027 7261 6e67 6527           'range'
+0008d340: 3a20 7b27 6d69 6e5f 6578 636c 7573 6976  : {'min_exclusiv
+0008d350: 6527 3a20 2873 656c 662e 7665 6374 6f72  e': (self.vector
+0008d360: 3344 5b31 5d20 2d20 6375 7429 2c0a 2020  3D[1] - cut),.  
+0008d370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d390: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008d3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d3d0: 7b27 6e61 6d65 273a 2027 6c61 6265 6c5f  {'name': 'label_
-0008d3e0: 616c 745f 6964 272c 2027 7479 7065 273a  alt_id', 'type':
-0008d3f0: 2027 656e 756d 272c 0a20 2020 2020 2020   'enum',.       
+0008d3b0: 2020 2020 2020 276d 6178 5f65 7863 6c75        'max_exclu
+0008d3c0: 7369 7665 273a 2028 7365 6c66 2e76 6563  sive': (self.vec
+0008d3d0: 746f 7233 445b 315d 202b 2063 7574 297d  tor3D[1] + cut)}
+0008d3e0: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
+0008d3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008d400: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008d410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d430: 2020 2020 2020 2027 656e 756d 273a 2028         'enum': (
-0008d440: 2741 2729 7d0a 2020 2020 2020 2020 2020  'A')}.          
+0008d420: 7b27 6e61 6d65 273a 2027 4361 7274 6e5f  {'name': 'Cartn_
+0008d430: 7a27 2c20 2774 7970 6527 3a20 2772 616e  z', 'type': 'ran
+0008d440: 6765 2d66 6c6f 6174 272c 0a20 2020 2020  ge-float',.     
 0008d450: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008d460: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008d470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d480: 2020 205d 290a 0a20 2020 2020 2020 2020     ])..         
-0008d490: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0008d4a0: 6620 6c65 6e28 5f6e 6569 6768 626f 7229  f len(_neighbor)
-0008d4b0: 203e 2030 3a0a 2020 2020 2020 2020 2020   > 0:.          
+0008d480: 2020 2020 2020 2020 2027 7261 6e67 6527           'range'
+0008d490: 3a20 7b27 6d69 6e5f 6578 636c 7573 6976  : {'min_exclusiv
+0008d4a0: 6527 3a20 2873 656c 662e 7665 6374 6f72  e': (self.vector
+0008d4b0: 3344 5b32 5d20 2d20 6375 7429 2c0a 2020  3D[2] - cut),.  
 0008d4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d4d0: 2020 6e65 6967 6862 6f72 203d 205b 6174    neighbor = [at
-0008d4e0: 6f6d 2066 6f72 2061 746f 6d20 696e 205f  om for atom in _
-0008d4f0: 6e65 6967 6862 6f72 2069 6620 6e75 6d70  neighbor if nump
-0008d500: 792e 6c69 6e61 6c67 2e6e 6f72 6d28 746f  y.linalg.norm(to
-0008d510: 4e70 4172 7261 7928 6174 6f6d 2920 2d20  NpArray(atom) - 
-0008d520: 7365 6c66 2e76 6563 746f 7233 4429 203c  self.vector3D) <
-0008d530: 2063 7574 5d0a 0a20 2020 2020 2020 2020   cut]..         
+0008d4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d500: 2020 2020 2020 276d 6178 5f65 7863 6c75        'max_exclu
+0008d510: 7369 7665 273a 2028 7365 6c66 2e76 6563  sive': (self.vec
+0008d520: 746f 7233 445b 325d 202b 2063 7574 297d  tor3D[2] + cut)}
+0008d530: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
 0008d540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d550: 2020 2066 6f72 2061 746f 6d20 696e 206e     for atom in n
-0008d560: 6569 6768 626f 723a 0a20 2020 2020 2020  eighbor:.       
-0008d570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d580: 2020 2020 2020 2020 2064 656c 2061 746f           del ato
-0008d590: 6d5b 2778 275d 0a20 2020 2020 2020 2020  m['x'].         
+0008d550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d570: 7b27 6e61 6d65 273a 2073 656c 662e 5f5f  {'name': self.__
+0008d580: 6d6f 6465 6c4e 756d 4e61 6d65 2c20 2774  modelNumName, 't
+0008d590: 7970 6527 3a20 2769 6e74 272c 0a20 2020  ype': 'int',.   
 0008d5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d5b0: 2020 2020 2020 2064 656c 2061 746f 6d5b         del atom[
-0008d5c0: 2779 275d 0a20 2020 2020 2020 2020 2020  'y'].           
-0008d5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d5e0: 2020 2020 2064 656c 2061 746f 6d5b 277a       del atom['z
-0008d5f0: 275d 0a20 2020 2020 2020 2020 2020 2020  '].             
-0008d600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d610: 2020 2061 746f 6d53 656c 6563 7469 6f6e     atomSelection
-0008d620: 2e61 7070 656e 6428 6174 6f6d 290a 0a20  .append(atom).. 
+0008d5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d5d0: 2020 2020 2020 2020 2020 2027 7661 6c75             'valu
+0008d5e0: 6527 3a20 7365 6c66 2e5f 5f72 6570 7265  e': self.__repre
+0008d5f0: 7365 6e74 6174 6976 654d 6f64 656c 4964  sentativeModelId
+0008d600: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
+0008d610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d620: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008d630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d640: 2020 2065 7863 6570 7420 4578 6365 7074     except Except
-0008d650: 696f 6e20 6173 2065 3a0a 2020 2020 2020  ion as e:.      
-0008d660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d670: 2020 6966 2073 656c 662e 5f5f 7665 7262    if self.__verb
-0008d680: 6f73 653a 0a20 2020 2020 2020 2020 2020  ose:.           
+0008d640: 7b27 6e61 6d65 273a 2027 6c61 6265 6c5f  {'name': 'label_
+0008d650: 616c 745f 6964 272c 2027 7479 7065 273a  alt_id', 'type':
+0008d660: 2027 656e 756d 272c 0a20 2020 2020 2020   'enum',.       
+0008d670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d680: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008d690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d6a0: 2073 656c 662e 5f5f 6c66 682e 7772 6974   self.__lfh.writ
-0008d6b0: 6528 6622 2b58 706c 6f72 4d52 5061 7273  e(f"+XplorMRPars
-0008d6c0: 6572 4c69 7374 656e 6572 2e65 7869 7446  erListener.exitF
-0008d6d0: 6163 746f 7228 2920 2b2b 2045 7272 6f72  actor() ++ Error
-0008d6e0: 2020 2d20 7b73 7472 2865 297d 2229 0a0a    - {str(e)}")..
-0008d6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d700: 2020 2020 7365 6c66 2e66 6163 746f 725b      self.factor[
-0008d710: 2761 746f 6d5f 7365 6c65 6374 696f 6e27  'atom_selection'
-0008d720: 5d20 3d20 6174 6f6d 5365 6c65 6374 696f  ] = atomSelectio
-0008d730: 6e0a 0a20 2020 2020 2020 2020 2020 2020  n..             
-0008d740: 2020 2020 2020 2069 6620 6c65 6e28 7365         if len(se
-0008d750: 6c66 2e66 6163 746f 725b 2761 746f 6d5f  lf.factor['atom_
-0008d760: 7365 6c65 6374 696f 6e27 5d29 203d 3d20  selection']) == 
-0008d770: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-0008d780: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0008d790: 6661 6374 6f72 5b27 6174 6f6d 5f69 6427  factor['atom_id'
-0008d7a0: 5d20 3d20 5b4e 6f6e 655d 0a20 2020 2020  ] = [None].     
+0008d6a0: 2020 2020 2020 2027 656e 756d 273a 2028         'enum': (
+0008d6b0: 2741 2729 7d0a 2020 2020 2020 2020 2020  'A')}.          
+0008d6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d6f0: 2020 205d 290a 0a20 2020 2020 2020 2020     ])..         
+0008d700: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0008d710: 6620 6c65 6e28 5f6e 6569 6768 626f 7229  f len(_neighbor)
+0008d720: 203e 2030 3a0a 2020 2020 2020 2020 2020   > 0:.          
+0008d730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d740: 2020 6e65 6967 6862 6f72 203d 205b 6174    neighbor = [at
+0008d750: 6f6d 2066 6f72 2061 746f 6d20 696e 205f  om for atom in _
+0008d760: 6e65 6967 6862 6f72 2069 6620 6e75 6d70  neighbor if nump
+0008d770: 792e 6c69 6e61 6c67 2e6e 6f72 6d28 746f  y.linalg.norm(to
+0008d780: 4e70 4172 7261 7928 6174 6f6d 2920 2d20  NpArray(atom) - 
+0008d790: 7365 6c66 2e76 6563 746f 7233 4429 203c  self.vector3D) <
+0008d7a0: 2063 7574 5d0a 0a20 2020 2020 2020 2020   cut]..         
 0008d7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d7c0: 2020 2073 656c 662e 5f5f 662e 6170 7065     self.__f.appe
-0008d7d0: 6e64 2866 225b 496e 7375 6666 6963 6965  nd(f"[Insufficie
-0008d7e0: 6e74 2061 746f 6d20 7365 6c65 6374 696f  nt atom selectio
-0008d7f0: 6e5d 207b 7365 6c66 2e5f 5f67 6574 4375  n] {self.__getCu
-0008d800: 7272 656e 7452 6573 7472 6169 6e74 2829  rrentRestraint()
-0008d810: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
-0008d820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d830: 2020 2020 2020 2020 2020 2022 5468 6520             "The 
-0008d840: 2763 7574 2720 636c 6175 7365 2068 6173  'cut' clause has
-0008d850: 206e 6f20 6566 6665 6374 2e22 290a 0a20   no effect.").. 
-0008d860: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0008d870: 656c 662e 696e 5665 6374 6f72 3344 203d  elf.inVector3D =
-0008d880: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
-0008d890: 2020 2020 2020 2073 656c 662e 7665 6374         self.vect
-0008d8a0: 6f72 3344 203d 204e 6f6e 650a 0a20 2020  or3D = None..   
-0008d8b0: 2020 2020 2020 2020 2065 6c69 6620 6374           elif ct
-0008d8c0: 782e 5072 6576 696f 7573 2829 3a0a 2020  x.Previous():.  
-0008d8d0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0008d8e0: 2073 656c 662e 5f5f 7365 6c5f 6578 7072   self.__sel_expr
-0008d8f0: 5f64 6562 7567 3a0a 2020 2020 2020 2020  _debug:.        
-0008d900: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-0008d910: 7428 2220 2022 202a 2073 656c 662e 6465  t("  " * self.de
-0008d920: 7074 6820 2b20 222d 2d3e 2070 7265 7669  pth + "--> previ
-0008d930: 6f75 7322 290a 2020 2020 2020 2020 2020  ous").          
-0008d940: 2020 2020 2020 7365 6c66 2e66 6163 746f        self.facto
-0008d950: 725b 2761 746f 6d5f 6964 275d 203d 205b  r['atom_id'] = [
-0008d960: 4e6f 6e65 5d0a 2020 2020 2020 2020 2020  None].          
-0008d970: 2020 2020 2020 7365 6c66 2e5f 5f66 2e61        self.__f.a
-0008d980: 7070 656e 6428 6622 5b55 6e73 7570 706f  ppend(f"[Unsuppo
-0008d990: 7274 6564 2064 6174 615d 207b 7365 6c66  rted data] {self
-0008d9a0: 2e5f 5f67 6574 4375 7272 656e 7452 6573  .__getCurrentRes
-0008d9b0: 7472 6169 6e74 2829 7d22 0a20 2020 2020  traint()}".     
-0008d9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008d9d0: 2020 2020 2020 2020 2020 2022 5468 6520             "The 
-0008d9e0: 2770 7265 7669 6f75 7327 2063 6c61 7573  'previous' claus
-0008d9f0: 6520 6861 7320 6e6f 2065 6666 6563 7420  e has no effect 
-0008da00: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0008da10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008da20: 2020 2262 6563 6175 7365 2074 6865 2069    "because the i
-0008da30: 6e74 6572 6e61 6c20 6174 6f6d 2073 656c  nternal atom sel
-0008da40: 6563 7469 6f6e 2069 7320 6672 6167 696c  ection is fragil
-0008da50: 6520 696e 2074 6865 2072 6573 7472 6169  e in the restrai
-0008da60: 6e74 2066 696c 652e 2229 0a0a 2020 2020  nt file.")..    
-0008da70: 2020 2020 2020 2020 656c 6966 2063 7478          elif ctx
-0008da80: 2e50 7365 7564 6f28 293a 0a20 2020 2020  .Pseudo():.     
-0008da90: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-0008daa0: 6c66 2e5f 5f73 656c 5f65 7870 725f 6465  lf.__sel_expr_de
-0008dab0: 6275 673a 0a20 2020 2020 2020 2020 2020  bug:.           
-0008dac0: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
-0008dad0: 2020 2220 2a20 7365 6c66 2e64 6570 7468    " * self.depth
-0008dae0: 202b 2022 2d2d 3e20 7073 6575 646f 2229   + "--> pseudo")
-0008daf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0008db00: 2069 6620 6e6f 7420 7365 6c66 2e5f 5f68   if not self.__h
-0008db10: 6173 436f 6f72 643a 0a20 2020 2020 2020  asCoord:.       
-0008db20: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-0008db30: 7572 6e0a 2020 2020 2020 2020 2020 2020  urn.            
-0008db40: 2020 2020 6174 6f6d 5365 6c65 6374 696f      atomSelectio
-0008db50: 6e20 3d20 5b5d 0a0a 2020 2020 2020 2020  n = []..        
-0008db60: 2020 2020 2020 2020 7472 793a 0a0a 2020          try:..  
-0008db70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008db80: 2020 5f61 746f 6d53 656c 6563 7469 6f6e    _atomSelection
-0008db90: 203d 5c0a 2020 2020 2020 2020 2020 2020   =\.            
-0008dba0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0008dbb0: 2e5f 5f63 522e 6765 7444 6963 744c 6973  .__cR.getDictLis
-0008dbc0: 7457 6974 6846 696c 7465 7228 2761 746f  tWithFilter('ato
-0008dbd0: 6d5f 7369 7465 272c 0a20 2020 2020 2020  m_site',.       
-0008dbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008dbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008dc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008dc10: 2041 5554 485f 4154 4f4d 5f44 4154 415f   AUTH_ATOM_DATA_
-0008dc20: 4954 454d 532c 0a20 2020 2020 2020 2020  ITEMS,.         
+0008d7c0: 2020 2066 6f72 2061 746f 6d20 696e 206e     for atom in n
+0008d7d0: 6569 6768 626f 723a 0a20 2020 2020 2020  eighbor:.       
+0008d7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d7f0: 2020 2020 2020 2020 2064 656c 2061 746f           del ato
+0008d800: 6d5b 2778 275d 0a20 2020 2020 2020 2020  m['x'].         
+0008d810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d820: 2020 2020 2020 2064 656c 2061 746f 6d5b         del atom[
+0008d830: 2779 275d 0a20 2020 2020 2020 2020 2020  'y'].           
+0008d840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d850: 2020 2020 2064 656c 2061 746f 6d5b 277a       del atom['z
+0008d860: 275d 0a20 2020 2020 2020 2020 2020 2020  '].             
+0008d870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d880: 2020 2061 746f 6d53 656c 6563 7469 6f6e     atomSelection
+0008d890: 2e61 7070 656e 6428 6174 6f6d 290a 0a20  .append(atom).. 
+0008d8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d8b0: 2020 2065 7863 6570 7420 4578 6365 7074     except Except
+0008d8c0: 696f 6e20 6173 2065 3a0a 2020 2020 2020  ion as e:.      
+0008d8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d8e0: 2020 6966 2073 656c 662e 5f5f 7665 7262    if self.__verb
+0008d8f0: 6f73 653a 0a20 2020 2020 2020 2020 2020  ose:.           
+0008d900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d910: 2073 656c 662e 5f5f 6c66 682e 7772 6974   self.__lfh.writ
+0008d920: 6528 6622 2b58 706c 6f72 4d52 5061 7273  e(f"+XplorMRPars
+0008d930: 6572 4c69 7374 656e 6572 2e65 7869 7446  erListener.exitF
+0008d940: 6163 746f 7228 2920 2b2b 2045 7272 6f72  actor() ++ Error
+0008d950: 2020 2d20 7b73 7472 2865 297d 2229 0a0a    - {str(e)}")..
+0008d960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008d970: 2020 2020 7365 6c66 2e66 6163 746f 725b      self.factor[
+0008d980: 2761 746f 6d5f 7365 6c65 6374 696f 6e27  'atom_selection'
+0008d990: 5d20 3d20 6174 6f6d 5365 6c65 6374 696f  ] = atomSelectio
+0008d9a0: 6e0a 0a20 2020 2020 2020 2020 2020 2020  n..             
+0008d9b0: 2020 2020 2020 2069 6620 6c65 6e28 7365         if len(se
+0008d9c0: 6c66 2e66 6163 746f 725b 2761 746f 6d5f  lf.factor['atom_
+0008d9d0: 7365 6c65 6374 696f 6e27 5d29 203d 3d20  selection']) == 
+0008d9e0: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
+0008d9f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0008da00: 6661 6374 6f72 5b27 6174 6f6d 5f69 6427  factor['atom_id'
+0008da10: 5d20 3d20 5b4e 6f6e 655d 0a20 2020 2020  ] = [None].     
+0008da20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008da30: 2020 2073 656c 662e 5f5f 662e 6170 7065     self.__f.appe
+0008da40: 6e64 2866 225b 496e 7375 6666 6963 6965  nd(f"[Insufficie
+0008da50: 6e74 2061 746f 6d20 7365 6c65 6374 696f  nt atom selectio
+0008da60: 6e5d 207b 7365 6c66 2e5f 5f67 6574 4375  n] {self.__getCu
+0008da70: 7272 656e 7452 6573 7472 6169 6e74 2829  rrentRestraint()
+0008da80: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
+0008da90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008daa0: 2020 2020 2020 2020 2020 2022 5468 6520             "The 
+0008dab0: 2763 7574 2720 636c 6175 7365 2068 6173  'cut' clause has
+0008dac0: 206e 6f20 6566 6665 6374 2e22 290a 0a20   no effect.").. 
+0008dad0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0008dae0: 656c 662e 696e 5665 6374 6f72 3344 203d  elf.inVector3D =
+0008daf0: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
+0008db00: 2020 2020 2020 2073 656c 662e 7665 6374         self.vect
+0008db10: 6f72 3344 203d 204e 6f6e 650a 0a20 2020  or3D = None..   
+0008db20: 2020 2020 2020 2020 2065 6c69 6620 6374           elif ct
+0008db30: 782e 5072 6576 696f 7573 2829 3a0a 2020  x.Previous():.  
+0008db40: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0008db50: 2073 656c 662e 5f5f 7365 6c5f 6578 7072   self.__sel_expr
+0008db60: 5f64 6562 7567 3a0a 2020 2020 2020 2020  _debug:.        
+0008db70: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+0008db80: 7428 2220 2022 202a 2073 656c 662e 6465  t("  " * self.de
+0008db90: 7074 6820 2b20 222d 2d3e 2070 7265 7669  pth + "--> previ
+0008dba0: 6f75 7322 290a 2020 2020 2020 2020 2020  ous").          
+0008dbb0: 2020 2020 2020 7365 6c66 2e66 6163 746f        self.facto
+0008dbc0: 725b 2761 746f 6d5f 6964 275d 203d 205b  r['atom_id'] = [
+0008dbd0: 4e6f 6e65 5d0a 2020 2020 2020 2020 2020  None].          
+0008dbe0: 2020 2020 2020 7365 6c66 2e5f 5f66 2e61        self.__f.a
+0008dbf0: 7070 656e 6428 6622 5b55 6e73 7570 706f  ppend(f"[Unsuppo
+0008dc00: 7274 6564 2064 6174 615d 207b 7365 6c66  rted data] {self
+0008dc10: 2e5f 5f67 6574 4375 7272 656e 7452 6573  .__getCurrentRes
+0008dc20: 7472 6169 6e74 2829 7d22 0a20 2020 2020  traint()}".     
 0008dc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008dc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008dc50: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0008dc60: 7b27 6e61 6d65 273a 2073 656c 662e 5f5f  {'name': self.__
-0008dc70: 6d6f 6465 6c4e 756d 4e61 6d65 2c20 2774  modelNumName, 't
-0008dc80: 7970 6527 3a20 2769 6e74 272c 0a20 2020  ype': 'int',.   
-0008dc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008dca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008dcb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008dcc0: 2020 2020 2020 2027 7661 6c75 6527 3a20         'value': 
-0008dcd0: 7365 6c66 2e5f 5f72 6570 7265 7365 6e74  self.__represent
-0008dce0: 6174 6976 654d 6f64 656c 4964 7d2c 0a20  ativeModelId},. 
-0008dcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008dd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008dd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008dd20: 2020 2020 2020 2020 7b27 6e61 6d65 273a          {'name':
-0008dd30: 2027 6c61 6265 6c5f 616c 745f 6964 272c   'label_alt_id',
-0008dd40: 2027 7479 7065 273a 2027 656e 756d 272c   'type': 'enum',
-0008dd50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0008dd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008dd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008dd80: 2020 2020 2020 2020 2020 2027 656e 756d             'enum
-0008dd90: 273a 2028 2741 2729 7d0a 2020 2020 2020  ': ('A')}.      
-0008dda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ddb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ddc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ddd0: 2020 205d 290a 0a20 2020 2020 2020 2020     ])..         
-0008dde0: 2020 2020 2020 2020 2020 206c 6173 7443             lastC
-0008ddf0: 6f6d 7049 6420 3d20 4e6f 6e65 0a20 2020  ompId = None.   
-0008de00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008de10: 2070 7365 7564 6f41 746f 6d73 203d 204e   pseudoAtoms = N
-0008de20: 6f6e 650a 0a20 2020 2020 2020 2020 2020  one..           
-0008de30: 2020 2020 2020 2020 2066 6f72 205f 6174           for _at
-0008de40: 6f6d 2069 6e20 5f61 746f 6d53 656c 6563  om in _atomSelec
-0008de50: 7469 6f6e 3a0a 2020 2020 2020 2020 2020  tion:.          
-0008de60: 2020 2020 2020 2020 2020 2020 2020 636f                co
-0008de70: 6d70 4964 203d 205f 6174 6f6d 5b27 636f  mpId = _atom['co
-0008de80: 6d70 5f69 6427 5d0a 2020 2020 2020 2020  mp_id'].        
-0008de90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008dea0: 6174 6f6d 4964 203d 205f 6174 6f6d 5b27  atomId = _atom['
-0008deb0: 6174 6f6d 5f69 6427 5d0a 0a20 2020 2020  atom_id']..     
-0008dec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ded0: 2020 2069 6620 636f 6d70 4964 2069 7320     if compId is 
-0008dee0: 6e6f 7420 6c61 7374 436f 6d70 4964 3a0a  not lastCompId:.
-0008def0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008df00: 2020 2020 2020 2020 2020 2020 7073 6575              pseu
-0008df10: 646f 4174 6f6d 7320 3d20 7365 6c66 2e5f  doAtoms = self._
-0008df20: 5f63 7353 7461 742e 6765 7450 7365 7564  _csStat.getPseud
-0008df30: 6f41 746f 6d73 2863 6f6d 7049 6429 0a20  oAtoms(compId). 
-0008df40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008df50: 2020 2020 2020 2020 2020 206c 6173 7443             lastC
-0008df60: 6f6d 7049 6420 3d20 636f 6d70 4964 0a0a  ompId = compId..
+0008dc40: 2020 2020 2020 2020 2020 2022 5468 6520             "The 
+0008dc50: 2770 7265 7669 6f75 7327 2063 6c61 7573  'previous' claus
+0008dc60: 6520 6861 7320 6e6f 2065 6666 6563 7420  e has no effect 
+0008dc70: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0008dc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008dc90: 2020 2262 6563 6175 7365 2074 6865 2069    "because the i
+0008dca0: 6e74 6572 6e61 6c20 6174 6f6d 2073 656c  nternal atom sel
+0008dcb0: 6563 7469 6f6e 2069 7320 6672 6167 696c  ection is fragil
+0008dcc0: 6520 696e 2074 6865 2072 6573 7472 6169  e in the restrai
+0008dcd0: 6e74 2066 696c 652e 2229 0a0a 2020 2020  nt file.")..    
+0008dce0: 2020 2020 2020 2020 656c 6966 2063 7478          elif ctx
+0008dcf0: 2e50 7365 7564 6f28 293a 0a20 2020 2020  .Pseudo():.     
+0008dd00: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+0008dd10: 6c66 2e5f 5f73 656c 5f65 7870 725f 6465  lf.__sel_expr_de
+0008dd20: 6275 673a 0a20 2020 2020 2020 2020 2020  bug:.           
+0008dd30: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
+0008dd40: 2020 2220 2a20 7365 6c66 2e64 6570 7468    " * self.depth
+0008dd50: 202b 2022 2d2d 3e20 7073 6575 646f 2229   + "--> pseudo")
+0008dd60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0008dd70: 2069 6620 6e6f 7420 7365 6c66 2e5f 5f68   if not self.__h
+0008dd80: 6173 436f 6f72 643a 0a20 2020 2020 2020  asCoord:.       
+0008dd90: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+0008dda0: 7572 6e0a 2020 2020 2020 2020 2020 2020  urn.            
+0008ddb0: 2020 2020 6174 6f6d 5365 6c65 6374 696f      atomSelectio
+0008ddc0: 6e20 3d20 5b5d 0a0a 2020 2020 2020 2020  n = []..        
+0008ddd0: 2020 2020 2020 2020 7472 793a 0a0a 2020          try:..  
+0008dde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008ddf0: 2020 5f61 746f 6d53 656c 6563 7469 6f6e    _atomSelection
+0008de00: 203d 5c0a 2020 2020 2020 2020 2020 2020   =\.            
+0008de10: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0008de20: 2e5f 5f63 522e 6765 7444 6963 744c 6973  .__cR.getDictLis
+0008de30: 7457 6974 6846 696c 7465 7228 2761 746f  tWithFilter('ato
+0008de40: 6d5f 7369 7465 272c 0a20 2020 2020 2020  m_site',.       
+0008de50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008de60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008de70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008de80: 2041 5554 485f 4154 4f4d 5f44 4154 415f   AUTH_ATOM_DATA_
+0008de90: 4954 454d 532c 0a20 2020 2020 2020 2020  ITEMS,.         
+0008dea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008deb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008dec0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+0008ded0: 7b27 6e61 6d65 273a 2073 656c 662e 5f5f  {'name': self.__
+0008dee0: 6d6f 6465 6c4e 756d 4e61 6d65 2c20 2774  modelNumName, 't
+0008def0: 7970 6527 3a20 2769 6e74 272c 0a20 2020  ype': 'int',.   
+0008df00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008df10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008df20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008df30: 2020 2020 2020 2027 7661 6c75 6527 3a20         'value': 
+0008df40: 7365 6c66 2e5f 5f72 6570 7265 7365 6e74  self.__represent
+0008df50: 6174 6976 654d 6f64 656c 4964 7d2c 0a20  ativeModelId},. 
+0008df60: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008df70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008df80: 2020 2020 2020 2020 6966 2061 746f 6d49          if atomI
-0008df90: 6420 696e 2070 7365 7564 6f41 746f 6d73  d in pseudoAtoms
-0008dfa0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0008dfb0: 2020 2020 2020 2020 2020 2020 2020 6174                at
-0008dfc0: 6f6d 5365 6c65 6374 696f 6e2e 6170 7065  omSelection.appe
-0008dfd0: 6e64 285f 6174 6f6d 290a 0a20 2020 2020  nd(_atom)..     
-0008dfe0: 2020 2020 2020 2020 2020 2065 7863 6570             excep
-0008dff0: 7420 4578 6365 7074 696f 6e20 6173 2065  t Exception as e
-0008e000: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0008e010: 2020 2020 2020 6966 2073 656c 662e 5f5f        if self.__
-0008e020: 7665 7262 6f73 653a 0a20 2020 2020 2020  verbose:.       
+0008df80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008df90: 2020 2020 2020 2020 7b27 6e61 6d65 273a          {'name':
+0008dfa0: 2027 6c61 6265 6c5f 616c 745f 6964 272c   'label_alt_id',
+0008dfb0: 2027 7479 7065 273a 2027 656e 756d 272c   'type': 'enum',
+0008dfc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0008dfd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008dfe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008dff0: 2020 2020 2020 2020 2020 2027 656e 756d             'enum
+0008e000: 273a 2028 2741 2729 7d0a 2020 2020 2020  ': ('A')}.      
+0008e010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008e020: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008e030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008e040: 2073 656c 662e 5f5f 6c66 682e 7772 6974   self.__lfh.writ
-0008e050: 6528 6622 2b58 706c 6f72 4d52 5061 7273  e(f"+XplorMRPars
-0008e060: 6572 4c69 7374 656e 6572 2e65 7869 7446  erListener.exitF
-0008e070: 6163 746f 7228 2920 2b2b 2045 7272 6f72  actor() ++ Error
-0008e080: 2020 2d20 7b73 7472 2865 297d 2229 0a0a    - {str(e)}")..
-0008e090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008e0a0: 7365 6c66 2e69 6e74 6572 7365 6374 696f  self.intersectio
-0008e0b0: 6e46 6163 746f 725f 6578 7072 6573 7369  nFactor_expressi
-0008e0c0: 6f6e 7328 6174 6f6d 5365 6c65 6374 696f  ons(atomSelectio
-0008e0d0: 6e29 0a0a 2020 2020 2020 2020 2020 2020  n)..            
-0008e0e0: 2020 2020 6966 206c 656e 2873 656c 662e      if len(self.
-0008e0f0: 6661 6374 6f72 5b27 6174 6f6d 5f73 656c  factor['atom_sel
-0008e100: 6563 7469 6f6e 275d 2920 3d3d 2030 3a0a  ection']) == 0:.
-0008e110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008e120: 2020 2020 7365 6c66 2e66 6163 746f 725b      self.factor[
-0008e130: 2761 746f 6d5f 6964 275d 203d 205b 4e6f  'atom_id'] = [No
-0008e140: 6e65 5d0a 2020 2020 2020 2020 2020 2020  ne].            
-0008e150: 2020 2020 2020 2020 7365 6c66 2e5f 5f66          self.__f
-0008e160: 2e61 7070 656e 6428 6622 5b49 6e73 7566  .append(f"[Insuf
-0008e170: 6669 6369 656e 7420 6174 6f6d 2073 656c  ficient atom sel
-0008e180: 6563 7469 6f6e 5d20 7b73 656c 662e 5f5f  ection] {self.__
-0008e190: 6765 7443 7572 7265 6e74 5265 7374 7261  getCurrentRestra
-0008e1a0: 696e 7428 297d 220a 2020 2020 2020 2020  int()}".        
+0008e040: 2020 205d 290a 0a20 2020 2020 2020 2020     ])..         
+0008e050: 2020 2020 2020 2020 2020 206c 6173 7443             lastC
+0008e060: 6f6d 7049 6420 3d20 4e6f 6e65 0a20 2020  ompId = None.   
+0008e070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008e080: 2070 7365 7564 6f41 746f 6d73 203d 204e   pseudoAtoms = N
+0008e090: 6f6e 650a 0a20 2020 2020 2020 2020 2020  one..           
+0008e0a0: 2020 2020 2020 2020 2066 6f72 205f 6174           for _at
+0008e0b0: 6f6d 2069 6e20 5f61 746f 6d53 656c 6563  om in _atomSelec
+0008e0c0: 7469 6f6e 3a0a 2020 2020 2020 2020 2020  tion:.          
+0008e0d0: 2020 2020 2020 2020 2020 2020 2020 636f                co
+0008e0e0: 6d70 4964 203d 205f 6174 6f6d 5b27 636f  mpId = _atom['co
+0008e0f0: 6d70 5f69 6427 5d0a 2020 2020 2020 2020  mp_id'].        
+0008e100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008e110: 6174 6f6d 4964 203d 205f 6174 6f6d 5b27  atomId = _atom['
+0008e120: 6174 6f6d 5f69 6427 5d0a 0a20 2020 2020  atom_id']..     
+0008e130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008e140: 2020 2069 6620 636f 6d70 4964 2069 7320     if compId is 
+0008e150: 6e6f 7420 6c61 7374 436f 6d70 4964 3a0a  not lastCompId:.
+0008e160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008e170: 2020 2020 2020 2020 2020 2020 7073 6575              pseu
+0008e180: 646f 4174 6f6d 7320 3d20 7365 6c66 2e5f  doAtoms = self._
+0008e190: 5f63 7353 7461 742e 6765 7450 7365 7564  _csStat.getPseud
+0008e1a0: 6f41 746f 6d73 2863 6f6d 7049 6429 0a20  oAtoms(compId). 
 0008e1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008e1c0: 2020 2020 2020 2020 2020 2020 2254 6865              "The
-0008e1d0: 2027 7073 6575 646f 2720 636c 6175 7365   'pseudo' clause
-0008e1e0: 2068 6173 206e 6f20 6566 6665 6374 2e22   has no effect."
-0008e1f0: 290a 0a20 2020 2020 2020 2020 2020 2065  )..            e
-0008e200: 6c69 6620 6374 782e 5265 7369 6475 6528  lif ctx.Residue(
-0008e210: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0008e220: 2020 2069 6620 7365 6c66 2e5f 5f73 656c     if self.__sel
-0008e230: 5f65 7870 725f 6465 6275 673a 0a20 2020  _expr_debug:.   
-0008e240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008e250: 2070 7269 6e74 2822 2020 2220 2a20 7365   print("  " * se
-0008e260: 6c66 2e64 6570 7468 202b 2022 2d2d 3e20  lf.depth + "--> 
-0008e270: 7265 7369 6475 6522 290a 0a20 2020 2020  residue")..     
-0008e280: 2020 2020 2020 2020 2020 2065 7661 6c5f             eval_
-0008e290: 6661 6374 6f72 203d 2046 616c 7365 0a20  factor = False. 
-0008e2a0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0008e2b0: 6620 2773 6571 5f69 6427 2069 6e20 7365  f 'seq_id' in se
-0008e2c0: 6c66 2e66 6163 746f 7220 6f72 2027 7365  lf.factor or 'se
-0008e2d0: 715f 6964 7327 2069 6e20 7365 6c66 2e66  q_ids' in self.f
-0008e2e0: 6163 746f 723a 0a20 2020 2020 2020 2020  actor:.         
-0008e2f0: 2020 2020 2020 2020 2020 205f 5f66 6163             __fac
-0008e300: 746f 7220 3d20 636f 7079 2e63 6f70 7928  tor = copy.copy(
-0008e310: 7365 6c66 2e66 6163 746f 7229 0a20 2020  self.factor).   
-0008e320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008e330: 2073 656c 662e 636f 6e73 756d 6546 6163   self.consumeFac
-0008e340: 746f 725f 6578 7072 6573 7369 6f6e 7328  tor_expressions(
-0008e350: 2227 7265 7369 6475 6527 2063 6c61 7573  "'residue' claus
-0008e360: 6522 2c20 4661 6c73 6529 0a20 2020 2020  e", False).     
-0008e370: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0008e380: 7661 6c5f 6661 6374 6f72 203d 2054 7275  val_factor = Tru
-0008e390: 650a 0a20 2020 2020 2020 2020 2020 2020  e..             
-0008e3a0: 2020 2069 6620 6374 782e 436f 6c6f 6e28     if ctx.Colon(
-0008e3b0: 293a 2020 2320 7261 6e67 6520 6578 7072  ):  # range expr
-0008e3c0: 6573 7369 6f6e 0a20 2020 2020 2020 2020  ession.         
-0008e3d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0008e3e0: 6661 6374 6f72 5b27 7365 715f 6964 275d  factor['seq_id']
-0008e3f0: 203d 206c 6973 7428 7261 6e67 6528 696e   = list(range(in
-0008e400: 7428 7374 7228 6374 782e 496e 7465 6765  t(str(ctx.Intege
-0008e410: 7228 3029 2929 2c20 696e 7428 7374 7228  r(0))), int(str(
-0008e420: 6374 782e 496e 7465 6765 7228 3029 2929  ctx.Integer(0)))
-0008e430: 202b 2031 2929 0a0a 2020 2020 2020 2020   + 1))..        
-0008e440: 2020 2020 2020 2020 656c 6966 2063 7478          elif ctx
-0008e450: 2e49 6e74 6567 6572 2830 293a 0a20 2020  .Integer(0):.   
-0008e460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008e470: 2073 656c 662e 6661 6374 6f72 5b27 7365   self.factor['se
-0008e480: 715f 6964 275d 203d 205b 696e 7428 7374  q_id'] = [int(st
-0008e490: 7228 6374 782e 496e 7465 6765 7228 3029  r(ctx.Integer(0)
-0008e4a0: 2929 5d0a 0a20 2020 2020 2020 2020 2020  ))]..           
-0008e4b0: 2020 2020 2065 6c69 6620 6374 782e 496e       elif ctx.In
-0008e4c0: 7465 6765 7273 2829 3a0a 2020 2020 2020  tegers():.      
-0008e4d0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0008e4e0: 6c66 2e66 6163 746f 725b 2773 6571 5f69  lf.factor['seq_i
-0008e4f0: 6473 275d 203d 205b 7374 7228 6374 782e  ds'] = [str(ctx.
-0008e500: 496e 7465 6765 7273 2829 295d 0a0a 2020  Integers())]..  
-0008e510: 2020 2020 2020 2020 2020 2020 2020 656c                el
-0008e520: 6966 2063 7478 2e53 796d 626f 6c5f 6e61  if ctx.Symbol_na
-0008e530: 6d65 2829 3a0a 2020 2020 2020 2020 2020  me():.          
-0008e540: 2020 2020 2020 2020 2020 7379 6d62 6f6c            symbol
-0008e550: 5f6e 616d 6520 3d20 7374 7228 6374 782e  _name = str(ctx.
-0008e560: 5379 6d62 6f6c 5f6e 616d 6528 2929 0a20  Symbol_name()). 
-0008e570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008e580: 2020 2069 6620 7379 6d62 6f6c 5f6e 616d     if symbol_nam
-0008e590: 6520 696e 2073 656c 662e 6576 616c 7561  e in self.evalua
-0008e5a0: 7465 3a0a 2020 2020 2020 2020 2020 2020  te:.            
-0008e5b0: 2020 2020 2020 2020 2020 2020 7661 6c20              val 
-0008e5c0: 3d20 7365 6c66 2e65 7661 6c75 6174 655b  = self.evaluate[
-0008e5d0: 7379 6d62 6f6c 5f6e 616d 655d 0a20 2020  symbol_name].   
-0008e5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008e5f0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-0008e600: 6365 2876 616c 2c20 6c69 7374 293a 0a20  ce(val, list):. 
-0008e610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008e620: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0008e630: 6661 6374 6f72 5b27 7365 715f 6964 275d  factor['seq_id']
-0008e640: 203d 205b 7620 6966 2069 7369 6e73 7461   = [v if isinsta
-0008e650: 6e63 6528 762c 2069 6e74 2920 656c 7365  nce(v, int) else
-0008e660: 2069 6e74 2876 2920 666f 7220 7620 696e   int(v) for v in
-0008e670: 2076 616c 5d0a 2020 2020 2020 2020 2020   val].          
-0008e680: 2020 2020 2020 2020 2020 2020 2020 656c                el
-0008e690: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0008e6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008e6b0: 7365 6c66 2e66 6163 746f 725b 2773 6571  self.factor['seq
-0008e6c0: 5f69 6427 5d20 3d20 5b76 616c 2069 6620  _id'] = [val if 
-0008e6d0: 6973 696e 7374 616e 6365 2876 616c 2c20  isinstance(val, 
-0008e6e0: 696e 7429 2065 6c73 6520 696e 7428 7661  int) else int(va
-0008e6f0: 6c29 5d0a 2020 2020 2020 2020 2020 2020  l)].            
-0008e700: 2020 2020 2020 2020 656c 6966 2073 796d          elif sym
-0008e710: 626f 6c5f 6e61 6d65 2069 6e20 7365 6c66  bol_name in self
-0008e720: 2e65 7661 6c75 6174 6546 6f72 3a0a 2020  .evaluateFor:.  
-0008e730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008e740: 2020 2020 2020 7661 6c20 3d20 7365 6c66        val = self
-0008e750: 2e65 7661 6c75 6174 6546 6f72 5b73 796d  .evaluateFor[sym
-0008e760: 626f 6c5f 6e61 6d65 5d0a 2020 2020 2020  bol_name].      
-0008e770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008e780: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-0008e790: 7661 6c2c 206c 6973 7429 3a0a 2020 2020  val, list):.    
-0008e7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008e7b0: 2020 2020 2020 2020 7365 6c66 2e66 6163          self.fac
-0008e7c0: 746f 725b 2773 6571 5f69 6427 5d20 3d20  tor['seq_id'] = 
-0008e7d0: 5b76 2069 6620 6973 696e 7374 616e 6365  [v if isinstance
-0008e7e0: 2876 2c20 696e 7429 2065 6c73 6520 696e  (v, int) else in
-0008e7f0: 7428 7629 2066 6f72 2076 2069 6e20 7661  t(v) for v in va
-0008e800: 6c5d 0a20 2020 2020 2020 2020 2020 2020  l].             
-0008e810: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0008e820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0008e830: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0008e840: 662e 6661 6374 6f72 5b27 7365 715f 6964  f.factor['seq_id
-0008e850: 275d 203d 205b 7661 6c20 6966 2069 7369  '] = [val if isi
-0008e860: 6e73 7461 6e63 6528 7661 6c2c 2069 6e74  nstance(val, int
-0008e870: 2920 656c 7365 2069 6e74 2876 616c 295d  ) else int(val)]
-0008e880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0008e890: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0008e8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008e8b0: 2020 2073 656c 662e 5f5f 662e 6170 7065     self.__f.appe
-0008e8c0: 6e64 2866 225b 556e 7375 7070 6f72 7465  nd(f"[Unsupporte
-0008e8d0: 6420 6461 7461 5d20 7b73 656c 662e 5f5f  d data] {self.__
-0008e8e0: 6765 7443 7572 7265 6e74 5265 7374 7261  getCurrentRestra
-0008e8f0: 696e 7428 297d 220a 2020 2020 2020 2020  int()}".        
-0008e900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008e1c0: 2020 2020 2020 2020 2020 206c 6173 7443             lastC
+0008e1d0: 6f6d 7049 6420 3d20 636f 6d70 4964 0a0a  ompId = compId..
+0008e1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008e1f0: 2020 2020 2020 2020 6966 2061 746f 6d49          if atomI
+0008e200: 6420 696e 2070 7365 7564 6f41 746f 6d73  d in pseudoAtoms
+0008e210: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0008e220: 2020 2020 2020 2020 2020 2020 2020 6174                at
+0008e230: 6f6d 5365 6c65 6374 696f 6e2e 6170 7065  omSelection.appe
+0008e240: 6e64 285f 6174 6f6d 290a 0a20 2020 2020  nd(_atom)..     
+0008e250: 2020 2020 2020 2020 2020 2065 7863 6570             excep
+0008e260: 7420 4578 6365 7074 696f 6e20 6173 2065  t Exception as e
+0008e270: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0008e280: 2020 2020 2020 6966 2073 656c 662e 5f5f        if self.__
+0008e290: 7665 7262 6f73 653a 0a20 2020 2020 2020  verbose:.       
+0008e2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008e2b0: 2073 656c 662e 5f5f 6c66 682e 7772 6974   self.__lfh.writ
+0008e2c0: 6528 6622 2b58 706c 6f72 4d52 5061 7273  e(f"+XplorMRPars
+0008e2d0: 6572 4c69 7374 656e 6572 2e65 7869 7446  erListener.exitF
+0008e2e0: 6163 746f 7228 2920 2b2b 2045 7272 6f72  actor() ++ Error
+0008e2f0: 2020 2d20 7b73 7472 2865 297d 2229 0a0a    - {str(e)}")..
+0008e300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008e310: 7365 6c66 2e69 6e74 6572 7365 6374 696f  self.intersectio
+0008e320: 6e46 6163 746f 725f 6578 7072 6573 7369  nFactor_expressi
+0008e330: 6f6e 7328 6174 6f6d 5365 6c65 6374 696f  ons(atomSelectio
+0008e340: 6e29 0a0a 2020 2020 2020 2020 2020 2020  n)..            
+0008e350: 2020 2020 6966 206c 656e 2873 656c 662e      if len(self.
+0008e360: 6661 6374 6f72 5b27 6174 6f6d 5f73 656c  factor['atom_sel
+0008e370: 6563 7469 6f6e 275d 2920 3d3d 2030 3a0a  ection']) == 0:.
+0008e380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008e390: 2020 2020 7365 6c66 2e66 6163 746f 725b      self.factor[
+0008e3a0: 2761 746f 6d5f 6964 275d 203d 205b 4e6f  'atom_id'] = [No
+0008e3b0: 6e65 5d0a 2020 2020 2020 2020 2020 2020  ne].            
+0008e3c0: 2020 2020 2020 2020 7365 6c66 2e5f 5f66          self.__f
+0008e3d0: 2e61 7070 656e 6428 6622 5b49 6e73 7566  .append(f"[Insuf
+0008e3e0: 6669 6369 656e 7420 6174 6f6d 2073 656c  ficient atom sel
+0008e3f0: 6563 7469 6f6e 5d20 7b73 656c 662e 5f5f  ection] {self.__
+0008e400: 6765 7443 7572 7265 6e74 5265 7374 7261  getCurrentRestra
+0008e410: 696e 7428 297d 220a 2020 2020 2020 2020  int()}".        
+0008e420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008e430: 2020 2020 2020 2020 2020 2020 2254 6865              "The
+0008e440: 2027 7073 6575 646f 2720 636c 6175 7365   'pseudo' clause
+0008e450: 2068 6173 206e 6f20 6566 6665 6374 2e22   has no effect."
+0008e460: 290a 0a20 2020 2020 2020 2020 2020 2065  )..            e
+0008e470: 6c69 6620 6374 782e 5265 7369 6475 6528  lif ctx.Residue(
+0008e480: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0008e490: 2020 2069 6620 7365 6c66 2e5f 5f73 656c     if self.__sel
+0008e4a0: 5f65 7870 725f 6465 6275 673a 0a20 2020  _expr_debug:.   
+0008e4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008e4c0: 2070 7269 6e74 2822 2020 2220 2a20 7365   print("  " * se
+0008e4d0: 6c66 2e64 6570 7468 202b 2022 2d2d 3e20  lf.depth + "--> 
+0008e4e0: 7265 7369 6475 6522 290a 0a20 2020 2020  residue")..     
+0008e4f0: 2020 2020 2020 2020 2020 2065 7661 6c5f             eval_
+0008e500: 6661 6374 6f72 203d 2046 616c 7365 0a20  factor = False. 
+0008e510: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0008e520: 6620 2773 6571 5f69 6427 2069 6e20 7365  f 'seq_id' in se
+0008e530: 6c66 2e66 6163 746f 7220 6f72 2027 7365  lf.factor or 'se
+0008e540: 715f 6964 7327 2069 6e20 7365 6c66 2e66  q_ids' in self.f
+0008e550: 6163 746f 723a 0a20 2020 2020 2020 2020  actor:.         
+0008e560: 2020 2020 2020 2020 2020 205f 5f66 6163             __fac
+0008e570: 746f 7220 3d20 636f 7079 2e63 6f70 7928  tor = copy.copy(
+0008e580: 7365 6c66 2e66 6163 746f 7229 0a20 2020  self.factor).   
+0008e590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008e5a0: 2073 656c 662e 636f 6e73 756d 6546 6163   self.consumeFac
+0008e5b0: 746f 725f 6578 7072 6573 7369 6f6e 7328  tor_expressions(
+0008e5c0: 2227 7265 7369 6475 6527 2063 6c61 7573  "'residue' claus
+0008e5d0: 6522 2c20 4661 6c73 6529 0a20 2020 2020  e", False).     
+0008e5e0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0008e5f0: 7661 6c5f 6661 6374 6f72 203d 2054 7275  val_factor = Tru
+0008e600: 650a 0a20 2020 2020 2020 2020 2020 2020  e..             
+0008e610: 2020 2069 6620 6374 782e 436f 6c6f 6e28     if ctx.Colon(
+0008e620: 293a 2020 2320 7261 6e67 6520 6578 7072  ):  # range expr
+0008e630: 6573 7369 6f6e 0a20 2020 2020 2020 2020  ession.         
+0008e640: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0008e650: 6661 6374 6f72 5b27 7365 715f 6964 275d  factor['seq_id']
+0008e660: 203d 206c 6973 7428 7261 6e67 6528 696e   = list(range(in
+0008e670: 7428 7374 7228 6374 782e 496e 7465 6765  t(str(ctx.Intege
+0008e680: 7228 3029 2929 2c20 696e 7428 7374 7228  r(0))), int(str(
+0008e690: 6374 782e 496e 7465 6765 7228 3029 2929  ctx.Integer(0)))
+0008e6a0: 202b 2031 2929 0a0a 2020 2020 2020 2020   + 1))..        
+0008e6b0: 2020 2020 2020 2020 656c 6966 2063 7478          elif ctx
+0008e6c0: 2e49 6e74 6567 6572 2830 293a 0a20 2020  .Integer(0):.   
+0008e6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008e6e0: 2073 656c 662e 6661 6374 6f72 5b27 7365   self.factor['se
+0008e6f0: 715f 6964 275d 203d 205b 696e 7428 7374  q_id'] = [int(st
+0008e700: 7228 6374 782e 496e 7465 6765 7228 3029  r(ctx.Integer(0)
+0008e710: 2929 5d0a 0a20 2020 2020 2020 2020 2020  ))]..           
+0008e720: 2020 2020 2065 6c69 6620 6374 782e 496e       elif ctx.In
+0008e730: 7465 6765 7273 2829 3a0a 2020 2020 2020  tegers():.      
+0008e740: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0008e750: 6c66 2e66 6163 746f 725b 2773 6571 5f69  lf.factor['seq_i
+0008e760: 6473 275d 203d 205b 7374 7228 6374 782e  ds'] = [str(ctx.
+0008e770: 496e 7465 6765 7273 2829 295d 0a0a 2020  Integers())]..  
+0008e780: 2020 2020 2020 2020 2020 2020 2020 656c                el
+0008e790: 6966 2063 7478 2e53 796d 626f 6c5f 6e61  if ctx.Symbol_na
+0008e7a0: 6d65 2829 3a0a 2020 2020 2020 2020 2020  me():.          
+0008e7b0: 2020 2020 2020 2020 2020 7379 6d62 6f6c            symbol
+0008e7c0: 5f6e 616d 6520 3d20 7374 7228 6374 782e  _name = str(ctx.
+0008e7d0: 5379 6d62 6f6c 5f6e 616d 6528 2929 0a20  Symbol_name()). 
+0008e7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008e7f0: 2020 2069 6620 7379 6d62 6f6c 5f6e 616d     if symbol_nam
+0008e800: 6520 696e 2073 656c 662e 6576 616c 7561  e in self.evalua
+0008e810: 7465 3a0a 2020 2020 2020 2020 2020 2020  te:.            
+0008e820: 2020 2020 2020 2020 2020 2020 7661 6c20              val 
+0008e830: 3d20 7365 6c66 2e65 7661 6c75 6174 655b  = self.evaluate[
+0008e840: 7379 6d62 6f6c 5f6e 616d 655d 0a20 2020  symbol_name].   
+0008e850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008e860: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+0008e870: 6365 2876 616c 2c20 6c69 7374 293a 0a20  ce(val, list):. 
+0008e880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008e890: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0008e8a0: 6661 6374 6f72 5b27 7365 715f 6964 275d  factor['seq_id']
+0008e8b0: 203d 205b 7620 6966 2069 7369 6e73 7461   = [v if isinsta
+0008e8c0: 6e63 6528 762c 2069 6e74 2920 656c 7365  nce(v, int) else
+0008e8d0: 2069 6e74 2876 2920 666f 7220 7620 696e   int(v) for v in
+0008e8e0: 2076 616c 5d0a 2020 2020 2020 2020 2020   val].          
+0008e8f0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+0008e900: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
 0008e910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008e920: 6622 5468 6520 7379 6d62 6f6c 207b 7379  f"The symbol {sy
-0008e930: 6d62 6f6c 5f6e 616d 6521 727d 2069 7320  mbol_name!r} is 
-0008e940: 6e6f 7420 6465 6669 6e65 642e 2229 0a0a  not defined.")..
-0008e950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008e960: 6966 2065 7661 6c5f 6661 6374 6f72 2061  if eval_factor a
-0008e970: 6e64 2027 6174 6f6d 5f73 656c 6563 7469  nd 'atom_selecti
-0008e980: 6f6e 2720 696e 2073 656c 662e 6661 6374  on' in self.fact
-0008e990: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
-0008e9a0: 2020 2020 2020 2020 6966 206c 656e 2873          if len(s
-0008e9b0: 656c 662e 6661 6374 6f72 5b27 6174 6f6d  elf.factor['atom
-0008e9c0: 5f73 656c 6563 7469 6f6e 275d 2920 3d3d  _selection']) ==
-0008e9d0: 2030 2061 6e64 2027 6174 6f6d 5f69 6427   0 and 'atom_id'
-0008e9e0: 2069 6e20 5f5f 6661 6374 6f72 3a0a 2020   in __factor:.  
-0008e9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ea00: 2020 2020 2020 5f5f 6174 6f6d 4964 203d        __atomId =
-0008ea10: 205f 5f66 6163 746f 725b 2761 746f 6d5f   __factor['atom_
-0008ea20: 6964 275d 5b30 5d2e 7570 7065 7228 2920  id'][0].upper() 
-0008ea30: 6966 206c 656e 285f 5f66 6163 746f 725b  if len(__factor[
-0008ea40: 2761 746f 6d5f 6964 275d 5b30 5d29 203c  'atom_id'][0]) <
-0008ea50: 3d20 3220 656c 7365 205f 5f66 6163 746f  = 2 else __facto
-0008ea60: 725b 2761 746f 6d5f 6964 275d 5b30 5d5b  r['atom_id'][0][
-0008ea70: 3a32 5d2e 7570 7065 7228 290a 2020 2020  :2].upper().    
-0008ea80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ea90: 2020 2020 6966 2073 656c 662e 5f5f 7769      if self.__wi
-0008eaa0: 7468 5f61 7869 7320 616e 6420 5f5f 6174  th_axis and __at
-0008eab0: 6f6d 4964 2069 6e20 5850 4c4f 525f 5244  omId in XPLOR_RD
-0008eac0: 435f 5052 494e 4349 5041 4c5f 4158 4953  C_PRINCIPAL_AXIS
-0008ead0: 5f4e 414d 4553 3a0a 2020 2020 2020 2020  _NAMES:.        
-0008eae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008eaf0: 2020 2020 7061 7373 0a20 2020 2020 2020      pass.       
-0008eb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008eb10: 2065 6c69 6620 7365 6c66 2e5f 5f77 6974   elif self.__wit
-0008eb20: 685f 7061 7261 2061 6e64 2028 2827 636f  h_para and (('co
-0008eb30: 6d70 5f69 6427 2069 6e20 5f5f 6661 6374  mp_id' in __fact
-0008eb40: 6f72 2061 6e64 205f 5f66 6163 746f 725b  or and __factor[
-0008eb50: 2761 746f 6d5f 6964 275d 5b30 5d20 3d3d  'atom_id'][0] ==
-0008eb60: 205f 5f66 6163 746f 725b 2763 6f6d 705f   __factor['comp_
-0008eb70: 6964 275d 5b30 5d20 616e 6420 5f5f 6174  id'][0] and __at
-0008eb80: 6f6d 4964 2069 6e20 5041 5241 4d41 474e  omId in PARAMAGN
-0008eb90: 4554 4943 5f45 4c45 4d45 4e54 5329 0a20  ETIC_ELEMENTS). 
-0008eba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ebb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008e920: 7365 6c66 2e66 6163 746f 725b 2773 6571  self.factor['seq
+0008e930: 5f69 6427 5d20 3d20 5b76 616c 2069 6620  _id'] = [val if 
+0008e940: 6973 696e 7374 616e 6365 2876 616c 2c20  isinstance(val, 
+0008e950: 696e 7429 2065 6c73 6520 696e 7428 7661  int) else int(va
+0008e960: 6c29 5d0a 2020 2020 2020 2020 2020 2020  l)].            
+0008e970: 2020 2020 2020 2020 656c 6966 2073 796d          elif sym
+0008e980: 626f 6c5f 6e61 6d65 2069 6e20 7365 6c66  bol_name in self
+0008e990: 2e65 7661 6c75 6174 6546 6f72 3a0a 2020  .evaluateFor:.  
+0008e9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008e9b0: 2020 2020 2020 7661 6c20 3d20 7365 6c66        val = self
+0008e9c0: 2e65 7661 6c75 6174 6546 6f72 5b73 796d  .evaluateFor[sym
+0008e9d0: 626f 6c5f 6e61 6d65 5d0a 2020 2020 2020  bol_name].      
+0008e9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008e9f0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+0008ea00: 7661 6c2c 206c 6973 7429 3a0a 2020 2020  val, list):.    
+0008ea10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008ea20: 2020 2020 2020 2020 7365 6c66 2e66 6163          self.fac
+0008ea30: 746f 725b 2773 6571 5f69 6427 5d20 3d20  tor['seq_id'] = 
+0008ea40: 5b76 2069 6620 6973 696e 7374 616e 6365  [v if isinstance
+0008ea50: 2876 2c20 696e 7429 2065 6c73 6520 696e  (v, int) else in
+0008ea60: 7428 7629 2066 6f72 2076 2069 6e20 7661  t(v) for v in va
+0008ea70: 6c5d 0a20 2020 2020 2020 2020 2020 2020  l].             
+0008ea80: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0008ea90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0008eaa0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0008eab0: 662e 6661 6374 6f72 5b27 7365 715f 6964  f.factor['seq_id
+0008eac0: 275d 203d 205b 7661 6c20 6966 2069 7369  '] = [val if isi
+0008ead0: 6e73 7461 6e63 6528 7661 6c2c 2069 6e74  nstance(val, int
+0008eae0: 2920 656c 7365 2069 6e74 2876 616c 295d  ) else int(val)]
+0008eaf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0008eb00: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0008eb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008eb20: 2020 2073 656c 662e 5f5f 662e 6170 7065     self.__f.appe
+0008eb30: 6e64 2866 225b 556e 7375 7070 6f72 7465  nd(f"[Unsupporte
+0008eb40: 6420 6461 7461 5d20 7b73 656c 662e 5f5f  d data] {self.__
+0008eb50: 6765 7443 7572 7265 6e74 5265 7374 7261  getCurrentRestra
+0008eb60: 696e 7428 297d 220a 2020 2020 2020 2020  int()}".        
+0008eb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008eb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008eb90: 6622 5468 6520 7379 6d62 6f6c 207b 7379  f"The symbol {sy
+0008eba0: 6d62 6f6c 5f6e 616d 6521 727d 2069 7320  mbol_name!r} is 
+0008ebb0: 6e6f 7420 6465 6669 6e65 642e 2229 0a0a  not defined.")..
 0008ebc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ebd0: 2020 6f72 205f 5f61 746f 6d49 6420 696e    or __atomId in
-0008ebe0: 2046 4552 524f 4d41 474e 4554 4943 5f45   FERROMAGNETIC_E
-0008ebf0: 4c45 4d45 4e54 5320 6f72 205f 5f61 746f  LEMENTS or __ato
-0008ec00: 6d49 6420 696e 204c 414e 5448 414e 4f49  mId in LANTHANOI
-0008ec10: 445f 454c 454d 454e 5453 293a 0a20 2020  D_ELEMENTS):.   
-0008ec20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ec30: 2020 2020 2020 2020 2070 6173 730a 2020           pass.  
-0008ec40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ec50: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
-0008ec60: 5f5f 6375 725f 7375 6274 7970 6520 3d3d  __cur_subtype ==
-0008ec70: 2027 706c 616e 6527 3a0a 2020 2020 2020   'plane':.      
-0008ec80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ec90: 2020 2020 2020 7061 7373 0a20 2020 2020        pass.     
-0008eca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ecb0: 2020 2065 6c69 6620 7365 6c66 2e5f 5f63     elif self.__c
-0008ecc0: 7572 5f73 7562 7479 7065 203d 3d20 2764  ur_subtype == 'd
-0008ecd0: 6973 7427 2061 6e64 205f 5f61 746f 6d49  ist' and __atomI
-0008ece0: 6420 696e 2058 504c 4f52 5f4e 4954 524f  d in XPLOR_NITRO
-0008ecf0: 5849 4445 5f4e 414d 4553 3a0a 2020 2020  XIDE_NAMES:.    
-0008ed00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ed10: 2020 2020 2020 2020 7061 7373 0a20 2020          pass.   
-0008ed20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ed30: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0008ed40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ed50: 2020 2020 2020 205f 6661 6374 6f72 203d         _factor =
-0008ed60: 2063 6f70 792e 636f 7079 2873 656c 662e   copy.copy(self.
-0008ed70: 6661 6374 6f72 290a 2020 2020 2020 2020  factor).        
-0008ed80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ed90: 2020 2020 6966 2027 6174 6f6d 5f73 656c      if 'atom_sel
-0008eda0: 6563 7469 6f6e 2720 696e 205f 5f66 6163  ection' in __fac
-0008edb0: 746f 723a 0a20 2020 2020 2020 2020 2020  tor:.           
-0008edc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008edd0: 2020 2020 2064 656c 205f 5f66 6163 746f       del __facto
-0008ede0: 725b 2761 746f 6d5f 7365 6c65 6374 696f  r['atom_selectio
-0008edf0: 6e27 5d0a 2020 2020 2020 2020 2020 2020  n'].            
-0008ee00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ee10: 6465 6c20 5f66 6163 746f 725b 2761 746f  del _factor['ato
-0008ee20: 6d5f 7365 6c65 6374 696f 6e27 5d0a 2020  m_selection'].  
+0008ebd0: 6966 2065 7661 6c5f 6661 6374 6f72 2061  if eval_factor a
+0008ebe0: 6e64 2027 6174 6f6d 5f73 656c 6563 7469  nd 'atom_selecti
+0008ebf0: 6f6e 2720 696e 2073 656c 662e 6661 6374  on' in self.fact
+0008ec00: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
+0008ec10: 2020 2020 2020 2020 6966 206c 656e 2873          if len(s
+0008ec20: 656c 662e 6661 6374 6f72 5b27 6174 6f6d  elf.factor['atom
+0008ec30: 5f73 656c 6563 7469 6f6e 275d 2920 3d3d  _selection']) ==
+0008ec40: 2030 2061 6e64 2027 6174 6f6d 5f69 6427   0 and 'atom_id'
+0008ec50: 2069 6e20 5f5f 6661 6374 6f72 3a0a 2020   in __factor:.  
+0008ec60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008ec70: 2020 2020 2020 5f5f 6174 6f6d 4964 203d        __atomId =
+0008ec80: 205f 5f66 6163 746f 725b 2761 746f 6d5f   __factor['atom_
+0008ec90: 6964 275d 5b30 5d2e 7570 7065 7228 2920  id'][0].upper() 
+0008eca0: 6966 206c 656e 285f 5f66 6163 746f 725b  if len(__factor[
+0008ecb0: 2761 746f 6d5f 6964 275d 5b30 5d29 203c  'atom_id'][0]) <
+0008ecc0: 3d20 3220 656c 7365 205f 5f66 6163 746f  = 2 else __facto
+0008ecd0: 725b 2761 746f 6d5f 6964 275d 5b30 5d5b  r['atom_id'][0][
+0008ece0: 3a32 5d2e 7570 7065 7228 290a 2020 2020  :2].upper().    
+0008ecf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008ed00: 2020 2020 6966 2073 656c 662e 5f5f 7769      if self.__wi
+0008ed10: 7468 5f61 7869 7320 616e 6420 5f5f 6174  th_axis and __at
+0008ed20: 6f6d 4964 2069 6e20 5850 4c4f 525f 5244  omId in XPLOR_RD
+0008ed30: 435f 5052 494e 4349 5041 4c5f 4158 4953  C_PRINCIPAL_AXIS
+0008ed40: 5f4e 414d 4553 3a0a 2020 2020 2020 2020  _NAMES:.        
+0008ed50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008ed60: 2020 2020 7061 7373 0a20 2020 2020 2020      pass.       
+0008ed70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008ed80: 2065 6c69 6620 7365 6c66 2e5f 5f77 6974   elif self.__wit
+0008ed90: 685f 7061 7261 2061 6e64 2028 2827 636f  h_para and (('co
+0008eda0: 6d70 5f69 6427 2069 6e20 5f5f 6661 6374  mp_id' in __fact
+0008edb0: 6f72 2061 6e64 205f 5f66 6163 746f 725b  or and __factor[
+0008edc0: 2761 746f 6d5f 6964 275d 5b30 5d20 3d3d  'atom_id'][0] ==
+0008edd0: 205f 5f66 6163 746f 725b 2763 6f6d 705f   __factor['comp_
+0008ede0: 6964 275d 5b30 5d20 616e 6420 5f5f 6174  id'][0] and __at
+0008edf0: 6f6d 4964 2069 6e20 5041 5241 4d41 474e  omId in PARAMAGN
+0008ee00: 4554 4943 5f45 4c45 4d45 4e54 5329 0a20  ETIC_ELEMENTS). 
+0008ee10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008ee20: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0008ee30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ee40: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-0008ee50: 5f66 2e61 7070 656e 6428 6622 5b49 6e73  _f.append(f"[Ins
-0008ee60: 7566 6669 6369 656e 7420 6174 6f6d 2073  ufficient atom s
-0008ee70: 656c 6563 7469 6f6e 5d20 7b73 656c 662e  election] {self.
-0008ee80: 5f5f 6765 7443 7572 7265 6e74 5265 7374  __getCurrentRest
-0008ee90: 7261 696e 7428 297d 220a 2020 2020 2020  raint()}".      
-0008eea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008ee40: 2020 6f72 205f 5f61 746f 6d49 6420 696e    or __atomId in
+0008ee50: 2046 4552 524f 4d41 474e 4554 4943 5f45   FERROMAGNETIC_E
+0008ee60: 4c45 4d45 4e54 5320 6f72 205f 5f61 746f  LEMENTS or __ato
+0008ee70: 6d49 6420 696e 204c 414e 5448 414e 4f49  mId in LANTHANOI
+0008ee80: 445f 454c 454d 454e 5453 293a 0a20 2020  D_ELEMENTS):.   
+0008ee90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008eea0: 2020 2020 2020 2020 2070 6173 730a 2020           pass.  
 0008eeb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008eec0: 2020 2020 2020 6622 5468 6520 2772 6573        f"The 'res
-0008eed0: 6964 7565 2720 636c 6175 7365 2068 6173  idue' clause has
-0008eee0: 206e 6f20 6566 6665 6374 2066 6f72 2061   no effect for a
-0008eef0: 2063 6f6e 6a75 6e63 7469 6f6e 206f 6620   conjunction of 
-0008ef00: 6661 6374 6f72 207b 5f5f 6661 6374 6f72  factor {__factor
-0008ef10: 7d20 616e 6420 7b5f 6661 6374 6f72 7d2e  } and {_factor}.
-0008ef20: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
-0008ef30: 656c 6966 2063 7478 2e52 6573 6e61 6d65  elif ctx.Resname
-0008ef40: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-0008ef50: 2020 2020 6966 2073 656c 662e 5f5f 7365      if self.__se
-0008ef60: 6c5f 6578 7072 5f64 6562 7567 3a0a 2020  l_expr_debug:.  
+0008eec0: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
+0008eed0: 5f5f 6375 725f 7375 6274 7970 6520 3d3d  __cur_subtype ==
+0008eee0: 2027 706c 616e 6527 3a0a 2020 2020 2020   'plane':.      
+0008eef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008ef00: 2020 2020 2020 7061 7373 0a20 2020 2020        pass.     
+0008ef10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008ef20: 2020 2065 6c69 6620 7365 6c66 2e5f 5f63     elif self.__c
+0008ef30: 7572 5f73 7562 7479 7065 203d 3d20 2764  ur_subtype == 'd
+0008ef40: 6973 7427 2061 6e64 205f 5f61 746f 6d49  ist' and __atomI
+0008ef50: 6420 696e 2058 504c 4f52 5f4e 4954 524f  d in XPLOR_NITRO
+0008ef60: 5849 4445 5f4e 414d 4553 3a0a 2020 2020  XIDE_NAMES:.    
 0008ef70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ef80: 2020 7072 696e 7428 2220 2022 202a 2073    print("  " * s
-0008ef90: 656c 662e 6465 7074 6820 2b20 222d 2d3e  elf.depth + "-->
-0008efa0: 2072 6573 6e61 6d65 2229 0a0a 2020 2020   resname")..    
-0008efb0: 2020 2020 2020 2020 2020 2020 6576 616c              eval
-0008efc0: 5f66 6163 746f 7220 3d20 4661 6c73 650a  _factor = False.
-0008efd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008efe0: 6966 2027 636f 6d70 5f69 6427 2069 6e20  if 'comp_id' in 
-0008eff0: 7365 6c66 2e66 6163 746f 7220 6f72 2027  self.factor or '
-0008f000: 636f 6d70 5f69 6473 2720 696e 2073 656c  comp_ids' in sel
-0008f010: 662e 6661 6374 6f72 3a0a 2020 2020 2020  f.factor:.      
-0008f020: 2020 2020 2020 2020 2020 2020 2020 5f5f                __
-0008f030: 6661 6374 6f72 203d 2063 6f70 792e 636f  factor = copy.co
-0008f040: 7079 2873 656c 662e 6661 6374 6f72 290a  py(self.factor).
-0008f050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008f060: 2020 2020 7365 6c66 2e63 6f6e 7375 6d65      self.consume
-0008f070: 4661 6374 6f72 5f65 7870 7265 7373 696f  Factor_expressio
-0008f080: 6e73 2822 2772 6573 6e61 6d65 2720 636c  ns("'resname' cl
-0008f090: 6175 7365 222c 2046 616c 7365 290a 2020  ause", False).  
+0008ef80: 2020 2020 2020 2020 7061 7373 0a20 2020          pass.   
+0008ef90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008efa0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0008efb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008efc0: 2020 2020 2020 205f 6661 6374 6f72 203d         _factor =
+0008efd0: 2063 6f70 792e 636f 7079 2873 656c 662e   copy.copy(self.
+0008efe0: 6661 6374 6f72 290a 2020 2020 2020 2020  factor).        
+0008eff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008f000: 2020 2020 6966 2027 6174 6f6d 5f73 656c      if 'atom_sel
+0008f010: 6563 7469 6f6e 2720 696e 205f 5f66 6163  ection' in __fac
+0008f020: 746f 723a 0a20 2020 2020 2020 2020 2020  tor:.           
+0008f030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008f040: 2020 2020 2064 656c 205f 5f66 6163 746f       del __facto
+0008f050: 725b 2761 746f 6d5f 7365 6c65 6374 696f  r['atom_selectio
+0008f060: 6e27 5d0a 2020 2020 2020 2020 2020 2020  n'].            
+0008f070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008f080: 6465 6c20 5f66 6163 746f 725b 2761 746f  del _factor['ato
+0008f090: 6d5f 7365 6c65 6374 696f 6e27 5d0a 2020  m_selection'].  
 0008f0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008f0b0: 2020 6576 616c 5f66 6163 746f 7220 3d20    eval_factor = 
-0008f0c0: 5472 7565 0a0a 2020 2020 2020 2020 2020  True..          
-0008f0d0: 2020 2020 2020 6966 2063 7478 2e43 6f6c        if ctx.Col
-0008f0e0: 6f6e 2829 3a20 2023 2072 616e 6765 2065  on():  # range e
-0008f0f0: 7870 7265 7373 696f 6e0a 2020 2020 2020  xpression.      
-0008f100: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0008f110: 6c66 2e66 6163 746f 725b 2763 6f6d 705f  lf.factor['comp_
-0008f120: 6964 7327 5d20 3d20 5b73 7472 2863 7478  ids'] = [str(ctx
-0008f130: 2e53 696d 706c 655f 6e61 6d65 2830 2929  .Simple_name(0))
-0008f140: 2e75 7070 6572 2829 2c20 7374 7228 6374  .upper(), str(ct
-0008f150: 782e 5369 6d70 6c65 5f6e 616d 6528 3129  x.Simple_name(1)
-0008f160: 292e 7570 7065 7228 295d 0a0a 2020 2020  ).upper()]..    
-0008f170: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-0008f180: 2063 7478 2e53 696d 706c 655f 6e61 6d65   ctx.Simple_name
-0008f190: 2830 293a 0a20 2020 2020 2020 2020 2020  (0):.           
-0008f1a0: 2020 2020 2020 2020 2073 656c 662e 6661           self.fa
-0008f1b0: 6374 6f72 5b27 636f 6d70 5f69 6427 5d20  ctor['comp_id'] 
-0008f1c0: 3d20 5b73 7472 2863 7478 2e53 696d 706c  = [str(ctx.Simpl
-0008f1d0: 655f 6e61 6d65 2830 2929 2e75 7070 6572  e_name(0)).upper
-0008f1e0: 2829 5d0a 0a20 2020 2020 2020 2020 2020  ()]..           
-0008f1f0: 2020 2020 2065 6c69 6620 6374 782e 5369       elif ctx.Si
-0008f200: 6d70 6c65 5f6e 616d 6573 2830 293a 0a20  mple_names(0):. 
-0008f210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008f220: 2020 2073 656c 662e 6661 6374 6f72 5b27     self.factor['
-0008f230: 636f 6d70 5f69 6473 275d 203d 205b 7374  comp_ids'] = [st
-0008f240: 7228 6374 782e 5369 6d70 6c65 5f6e 616d  r(ctx.Simple_nam
-0008f250: 6573 2830 2929 2e75 7070 6572 2829 5d0a  es(0)).upper()].
-0008f260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0008f270: 2065 6c69 6620 6374 782e 5379 6d62 6f6c   elif ctx.Symbol
-0008f280: 5f6e 616d 6528 293a 0a20 2020 2020 2020  _name():.       
-0008f290: 2020 2020 2020 2020 2020 2020 2073 796d               sym
-0008f2a0: 626f 6c5f 6e61 6d65 203d 2073 7472 2863  bol_name = str(c
-0008f2b0: 7478 2e53 796d 626f 6c5f 6e61 6d65 2829  tx.Symbol_name()
-0008f2c0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0008f2d0: 2020 2020 2020 6966 2073 796d 626f 6c5f        if symbol_
-0008f2e0: 6e61 6d65 2069 6e20 7365 6c66 2e65 7661  name in self.eva
-0008f2f0: 6c75 6174 653a 0a20 2020 2020 2020 2020  luate:.         
-0008f300: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-0008f310: 616c 203d 2073 656c 662e 6576 616c 7561  al = self.evalua
-0008f320: 7465 5b73 796d 626f 6c5f 6e61 6d65 5d0a  te[symbol_name].
-0008f330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008f340: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-0008f350: 7461 6e63 6528 7661 6c2c 206c 6973 7429  tance(val, list)
-0008f360: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0008f0b0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+0008f0c0: 5f66 2e61 7070 656e 6428 6622 5b49 6e73  _f.append(f"[Ins
+0008f0d0: 7566 6669 6369 656e 7420 6174 6f6d 2073  ufficient atom s
+0008f0e0: 656c 6563 7469 6f6e 5d20 7b73 656c 662e  election] {self.
+0008f0f0: 5f5f 6765 7443 7572 7265 6e74 5265 7374  __getCurrentRest
+0008f100: 7261 696e 7428 297d 220a 2020 2020 2020  raint()}".      
+0008f110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008f120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008f130: 2020 2020 2020 6622 5468 6520 2772 6573        f"The 'res
+0008f140: 6964 7565 2720 636c 6175 7365 2068 6173  idue' clause has
+0008f150: 206e 6f20 6566 6665 6374 2066 6f72 2061   no effect for a
+0008f160: 2063 6f6e 6a75 6e63 7469 6f6e 206f 6620   conjunction of 
+0008f170: 6661 6374 6f72 207b 5f5f 6661 6374 6f72  factor {__factor
+0008f180: 7d20 616e 6420 7b5f 6661 6374 6f72 7d2e  } and {_factor}.
+0008f190: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
+0008f1a0: 656c 6966 2063 7478 2e52 6573 6e61 6d65  elif ctx.Resname
+0008f1b0: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+0008f1c0: 2020 2020 6966 2073 656c 662e 5f5f 7365      if self.__se
+0008f1d0: 6c5f 6578 7072 5f64 6562 7567 3a0a 2020  l_expr_debug:.  
+0008f1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008f1f0: 2020 7072 696e 7428 2220 2022 202a 2073    print("  " * s
+0008f200: 656c 662e 6465 7074 6820 2b20 222d 2d3e  elf.depth + "-->
+0008f210: 2072 6573 6e61 6d65 2229 0a0a 2020 2020   resname")..    
+0008f220: 2020 2020 2020 2020 2020 2020 6576 616c              eval
+0008f230: 5f66 6163 746f 7220 3d20 4661 6c73 650a  _factor = False.
+0008f240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008f250: 6966 2027 636f 6d70 5f69 6427 2069 6e20  if 'comp_id' in 
+0008f260: 7365 6c66 2e66 6163 746f 7220 6f72 2027  self.factor or '
+0008f270: 636f 6d70 5f69 6473 2720 696e 2073 656c  comp_ids' in sel
+0008f280: 662e 6661 6374 6f72 3a0a 2020 2020 2020  f.factor:.      
+0008f290: 2020 2020 2020 2020 2020 2020 2020 5f5f                __
+0008f2a0: 6661 6374 6f72 203d 2063 6f70 792e 636f  factor = copy.co
+0008f2b0: 7079 2873 656c 662e 6661 6374 6f72 290a  py(self.factor).
+0008f2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008f2d0: 2020 2020 7365 6c66 2e63 6f6e 7375 6d65      self.consume
+0008f2e0: 4661 6374 6f72 5f65 7870 7265 7373 696f  Factor_expressio
+0008f2f0: 6e73 2822 2772 6573 6e61 6d65 2720 636c  ns("'resname' cl
+0008f300: 6175 7365 222c 2046 616c 7365 290a 2020  ause", False).  
+0008f310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008f320: 2020 6576 616c 5f66 6163 746f 7220 3d20    eval_factor = 
+0008f330: 5472 7565 0a0a 2020 2020 2020 2020 2020  True..          
+0008f340: 2020 2020 2020 6966 2063 7478 2e43 6f6c        if ctx.Col
+0008f350: 6f6e 2829 3a20 2023 2072 616e 6765 2065  on():  # range e
+0008f360: 7870 7265 7373 696f 6e0a 2020 2020 2020  xpression.      
 0008f370: 2020 2020 2020 2020 2020 2020 2020 7365                se
 0008f380: 6c66 2e66 6163 746f 725b 2763 6f6d 705f  lf.factor['comp_
-0008f390: 6964 275d 203d 205b 762e 7570 7065 7228  id'] = [v.upper(
-0008f3a0: 2920 666f 7220 7620 696e 2076 616c 5d0a  ) for v in val].
-0008f3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008f3c0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0008f3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008f3e0: 2020 2020 2020 2020 2020 7365 6c66 2e66            self.f
-0008f3f0: 6163 746f 725b 2763 6f6d 705f 6964 275d  actor['comp_id']
-0008f400: 203d 205b 7661 6c2e 7570 7065 7228 295d   = [val.upper()]
-0008f410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0008f420: 2020 2020 2065 6c69 6620 7379 6d62 6f6c       elif symbol
-0008f430: 5f6e 616d 6520 696e 2073 656c 662e 6576  _name in self.ev
-0008f440: 616c 7561 7465 466f 723a 0a20 2020 2020  aluateFor:.     
-0008f450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008f460: 2020 2076 616c 203d 2073 656c 662e 6576     val = self.ev
-0008f470: 616c 7561 7465 466f 725b 7379 6d62 6f6c  aluateFor[symbol
-0008f480: 5f6e 616d 655d 0a20 2020 2020 2020 2020  _name].         
-0008f490: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0008f4a0: 6620 6973 696e 7374 616e 6365 2876 616c  f isinstance(val
-0008f4b0: 2c20 6c69 7374 293a 0a20 2020 2020 2020  , list):.       
-0008f4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008f4d0: 2020 2020 2073 656c 662e 6661 6374 6f72       self.factor
-0008f4e0: 5b27 636f 6d70 5f69 6427 5d20 3d20 5b76  ['comp_id'] = [v
-0008f4f0: 2e75 7070 6572 2829 2066 6f72 2076 2069  .upper() for v i
-0008f500: 6e20 7661 6c5d 0a20 2020 2020 2020 2020  n val].         
-0008f510: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0008f520: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0008f530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008f540: 2073 656c 662e 6661 6374 6f72 5b27 636f   self.factor['co
-0008f550: 6d70 5f69 6427 5d20 3d20 5b76 616c 2e75  mp_id'] = [val.u
-0008f560: 7070 6572 2829 5d0a 2020 2020 2020 2020  pper()].        
-0008f570: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0008f580: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0008f590: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-0008f5a0: 5f66 2e61 7070 656e 6428 6622 5b55 6e73  _f.append(f"[Uns
-0008f5b0: 7570 706f 7274 6564 2064 6174 615d 207b  upported data] {
-0008f5c0: 7365 6c66 2e5f 5f67 6574 4375 7272 656e  self.__getCurren
-0008f5d0: 7452 6573 7472 6169 6e74 2829 7d22 0a20  tRestraint()}". 
-0008f5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008f5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008f600: 2020 2020 2020 2066 2254 6865 2073 796d         f"The sym
-0008f610: 626f 6c20 7b73 796d 626f 6c5f 6e61 6d65  bol {symbol_name
-0008f620: 2172 7d20 6973 206e 6f74 2064 6566 696e  !r} is not defin
-0008f630: 6564 2e22 290a 0a20 2020 2020 2020 2020  ed.")..         
-0008f640: 2020 2020 2020 2069 6620 6576 616c 5f66         if eval_f
-0008f650: 6163 746f 7220 616e 6420 2761 746f 6d5f  actor and 'atom_
-0008f660: 7365 6c65 6374 696f 6e27 2069 6e20 7365  selection' in se
-0008f670: 6c66 2e66 6163 746f 723a 0a20 2020 2020  lf.factor:.     
-0008f680: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0008f690: 6620 6c65 6e28 7365 6c66 2e66 6163 746f  f len(self.facto
-0008f6a0: 725b 2761 746f 6d5f 7365 6c65 6374 696f  r['atom_selectio
-0008f6b0: 6e27 5d29 203d 3d20 3020 616e 6420 2761  n']) == 0 and 'a
-0008f6c0: 746f 6d5f 6964 2720 696e 205f 5f66 6163  tom_id' in __fac
-0008f6d0: 746f 723a 0a20 2020 2020 2020 2020 2020  tor:.           
-0008f6e0: 2020 2020 2020 2020 2020 2020 205f 5f61               __a
-0008f6f0: 746f 6d49 6420 3d20 5f5f 6661 6374 6f72  tomId = __factor
-0008f700: 5b27 6174 6f6d 5f69 6427 5d5b 305d 2e75  ['atom_id'][0].u
-0008f710: 7070 6572 2829 2069 6620 6c65 6e28 5f5f  pper() if len(__
-0008f720: 6661 6374 6f72 5b27 6174 6f6d 5f69 6427  factor['atom_id'
-0008f730: 5d5b 305d 2920 3c3d 2032 2065 6c73 6520  ][0]) <= 2 else 
-0008f740: 5f5f 6661 6374 6f72 5b27 6174 6f6d 5f69  __factor['atom_i
-0008f750: 6427 5d5b 305d 5b3a 325d 2e75 7070 6572  d'][0][:2].upper
-0008f760: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
-0008f770: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-0008f780: 6c66 2e5f 5f77 6974 685f 6178 6973 2061  lf.__with_axis a
-0008f790: 6e64 205f 5f61 746f 6d49 6420 696e 2058  nd __atomId in X
-0008f7a0: 504c 4f52 5f52 4443 5f50 5249 4e43 4950  PLOR_RDC_PRINCIP
-0008f7b0: 414c 5f41 5849 535f 4e41 4d45 533a 0a20  AL_AXIS_NAMES:. 
-0008f7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008f7d0: 2020 2020 2020 2020 2020 2070 6173 730a             pass.
-0008f7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008f7f0: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
-0008f800: 662e 5f5f 7769 7468 5f70 6172 6120 616e  f.__with_para an
-0008f810: 6420 2828 2763 6f6d 705f 6964 2720 696e  d (('comp_id' in
-0008f820: 205f 5f66 6163 746f 7220 616e 6420 5f5f   __factor and __
-0008f830: 6661 6374 6f72 5b27 6174 6f6d 5f69 6427  factor['atom_id'
-0008f840: 5d5b 305d 203d 3d20 5f5f 6661 6374 6f72  ][0] == __factor
-0008f850: 5b27 636f 6d70 5f69 6427 5d5b 305d 2061  ['comp_id'][0] a
-0008f860: 6e64 205f 5f61 746f 6d49 6420 696e 2050  nd __atomId in P
-0008f870: 4152 414d 4147 4e45 5449 435f 454c 454d  ARAMAGNETIC_ELEM
-0008f880: 454e 5453 290a 2020 2020 2020 2020 2020  ENTS).          
-0008f890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008f8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008f8b0: 2020 2020 2020 2020 206f 7220 5f5f 6174           or __at
-0008f8c0: 6f6d 4964 2069 6e20 4645 5252 4f4d 4147  omId in FERROMAG
-0008f8d0: 4e45 5449 435f 454c 454d 454e 5453 206f  NETIC_ELEMENTS o
-0008f8e0: 7220 5f5f 6174 6f6d 4964 2069 6e20 4c41  r __atomId in LA
-0008f8f0: 4e54 4841 4e4f 4944 5f45 4c45 4d45 4e54  NTHANOID_ELEMENT
-0008f900: 5329 3a0a 2020 2020 2020 2020 2020 2020  S):.            
-0008f910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008f920: 7061 7373 0a20 2020 2020 2020 2020 2020  pass.           
-0008f930: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-0008f940: 6620 7365 6c66 2e5f 5f63 7572 5f73 7562  f self.__cur_sub
-0008f950: 7479 7065 203d 3d20 2770 6c61 6e65 273a  type == 'plane':
-0008f960: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0008f970: 2020 2020 2020 2020 2020 2020 2070 6173               pas
-0008f980: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
-0008f990: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
-0008f9a0: 656c 662e 5f5f 6375 725f 7375 6274 7970  elf.__cur_subtyp
-0008f9b0: 6520 3d3d 2027 6469 7374 2720 616e 6420  e == 'dist' and 
-0008f9c0: 5f5f 6174 6f6d 4964 2069 6e20 5850 4c4f  __atomId in XPLO
-0008f9d0: 525f 4e49 5452 4f58 4944 455f 4e41 4d45  R_NITROXIDE_NAME
-0008f9e0: 533a 0a20 2020 2020 2020 2020 2020 2020  S:.             
-0008f9f0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0008fa00: 6173 730a 2020 2020 2020 2020 2020 2020  ass.            
-0008fa10: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0008fa20: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0008fa30: 2020 2020 2020 2020 2020 2020 2020 5f66                _f
-0008fa40: 6163 746f 7220 3d20 636f 7079 2e63 6f70  actor = copy.cop
-0008fa50: 7928 7365 6c66 2e66 6163 746f 7229 0a20  y(self.factor). 
-0008fa60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008fa70: 2020 2020 2020 2020 2020 2069 6620 2761             if 'a
-0008fa80: 746f 6d5f 7365 6c65 6374 696f 6e27 2069  tom_selection' i
-0008fa90: 6e20 5f5f 6661 6374 6f72 3a0a 2020 2020  n __factor:.    
-0008faa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008fab0: 2020 2020 2020 2020 2020 2020 6465 6c20              del 
-0008fac0: 5f5f 6661 6374 6f72 5b27 6174 6f6d 5f73  __factor['atom_s
-0008fad0: 656c 6563 7469 6f6e 275d 0a20 2020 2020  election'].     
-0008fae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008faf0: 2020 2020 2020 2064 656c 205f 6661 6374         del _fact
-0008fb00: 6f72 5b27 6174 6f6d 5f73 656c 6563 7469  or['atom_selecti
-0008fb10: 6f6e 275d 0a20 2020 2020 2020 2020 2020  on'].           
-0008fb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008fb30: 2073 656c 662e 5f5f 662e 6170 7065 6e64   self.__f.append
-0008fb40: 2866 225b 496e 7375 6666 6963 6965 6e74  (f"[Insufficient
-0008fb50: 2061 746f 6d20 7365 6c65 6374 696f 6e5d   atom selection]
-0008fb60: 207b 7365 6c66 2e5f 5f67 6574 4375 7272   {self.__getCurr
-0008fb70: 656e 7452 6573 7472 6169 6e74 2829 7d22  entRestraint()}"
-0008fb80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0008fb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008fba0: 2020 2020 2020 2020 2020 2020 2066 2254               f"T
-0008fbb0: 6865 2027 7265 736e 616d 6527 2063 6c61  he 'resname' cla
-0008fbc0: 7573 6520 6861 7320 6e6f 2065 6666 6563  use has no effec
-0008fbd0: 7420 666f 7220 6120 636f 6e6a 756e 6374  t for a conjunct
-0008fbe0: 696f 6e20 6f66 2066 6163 746f 7220 7b5f  ion of factor {_
-0008fbf0: 5f66 6163 746f 727d 2061 6e64 207b 5f66  _factor} and {_f
-0008fc00: 6163 746f 727d 2e22 290a 0a20 2020 2020  actor}.")..     
-0008fc10: 2020 2020 2020 2065 6c69 6620 6374 782e         elif ctx.
-0008fc20: 5365 6749 6465 6e74 6966 6965 7228 293a  SegIdentifier():
-0008fc30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0008fc40: 2069 6620 7365 6c66 2e5f 5f73 656c 5f65   if self.__sel_e
-0008fc50: 7870 725f 6465 6275 673a 0a20 2020 2020  xpr_debug:.     
+0008f390: 6964 7327 5d20 3d20 5b73 7472 2863 7478  ids'] = [str(ctx
+0008f3a0: 2e53 696d 706c 655f 6e61 6d65 2830 2929  .Simple_name(0))
+0008f3b0: 2e75 7070 6572 2829 2c20 7374 7228 6374  .upper(), str(ct
+0008f3c0: 782e 5369 6d70 6c65 5f6e 616d 6528 3129  x.Simple_name(1)
+0008f3d0: 292e 7570 7065 7228 295d 0a0a 2020 2020  ).upper()]..    
+0008f3e0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+0008f3f0: 2063 7478 2e53 696d 706c 655f 6e61 6d65   ctx.Simple_name
+0008f400: 2830 293a 0a20 2020 2020 2020 2020 2020  (0):.           
+0008f410: 2020 2020 2020 2020 2073 656c 662e 6661           self.fa
+0008f420: 6374 6f72 5b27 636f 6d70 5f69 6427 5d20  ctor['comp_id'] 
+0008f430: 3d20 5b73 7472 2863 7478 2e53 696d 706c  = [str(ctx.Simpl
+0008f440: 655f 6e61 6d65 2830 2929 2e75 7070 6572  e_name(0)).upper
+0008f450: 2829 5d0a 0a20 2020 2020 2020 2020 2020  ()]..           
+0008f460: 2020 2020 2065 6c69 6620 6374 782e 5369       elif ctx.Si
+0008f470: 6d70 6c65 5f6e 616d 6573 2830 293a 0a20  mple_names(0):. 
+0008f480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008f490: 2020 2073 656c 662e 6661 6374 6f72 5b27     self.factor['
+0008f4a0: 636f 6d70 5f69 6473 275d 203d 205b 7374  comp_ids'] = [st
+0008f4b0: 7228 6374 782e 5369 6d70 6c65 5f6e 616d  r(ctx.Simple_nam
+0008f4c0: 6573 2830 2929 2e75 7070 6572 2829 5d0a  es(0)).upper()].
+0008f4d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0008f4e0: 2065 6c69 6620 6374 782e 5379 6d62 6f6c   elif ctx.Symbol
+0008f4f0: 5f6e 616d 6528 293a 0a20 2020 2020 2020  _name():.       
+0008f500: 2020 2020 2020 2020 2020 2020 2073 796d               sym
+0008f510: 626f 6c5f 6e61 6d65 203d 2073 7472 2863  bol_name = str(c
+0008f520: 7478 2e53 796d 626f 6c5f 6e61 6d65 2829  tx.Symbol_name()
+0008f530: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0008f540: 2020 2020 2020 6966 2073 796d 626f 6c5f        if symbol_
+0008f550: 6e61 6d65 2069 6e20 7365 6c66 2e65 7661  name in self.eva
+0008f560: 6c75 6174 653a 0a20 2020 2020 2020 2020  luate:.         
+0008f570: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+0008f580: 616c 203d 2073 656c 662e 6576 616c 7561  al = self.evalua
+0008f590: 7465 5b73 796d 626f 6c5f 6e61 6d65 5d0a  te[symbol_name].
+0008f5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008f5b0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+0008f5c0: 7461 6e63 6528 7661 6c2c 206c 6973 7429  tance(val, list)
+0008f5d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0008f5e0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0008f5f0: 6c66 2e66 6163 746f 725b 2763 6f6d 705f  lf.factor['comp_
+0008f600: 6964 275d 203d 205b 762e 7570 7065 7228  id'] = [v.upper(
+0008f610: 2920 666f 7220 7620 696e 2076 616c 5d0a  ) for v in val].
+0008f620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008f630: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0008f640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008f650: 2020 2020 2020 2020 2020 7365 6c66 2e66            self.f
+0008f660: 6163 746f 725b 2763 6f6d 705f 6964 275d  actor['comp_id']
+0008f670: 203d 205b 7661 6c2e 7570 7065 7228 295d   = [val.upper()]
+0008f680: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0008f690: 2020 2020 2065 6c69 6620 7379 6d62 6f6c       elif symbol
+0008f6a0: 5f6e 616d 6520 696e 2073 656c 662e 6576  _name in self.ev
+0008f6b0: 616c 7561 7465 466f 723a 0a20 2020 2020  aluateFor:.     
+0008f6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008f6d0: 2020 2076 616c 203d 2073 656c 662e 6576     val = self.ev
+0008f6e0: 616c 7561 7465 466f 725b 7379 6d62 6f6c  aluateFor[symbol
+0008f6f0: 5f6e 616d 655d 0a20 2020 2020 2020 2020  _name].         
+0008f700: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0008f710: 6620 6973 696e 7374 616e 6365 2876 616c  f isinstance(val
+0008f720: 2c20 6c69 7374 293a 0a20 2020 2020 2020  , list):.       
+0008f730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008f740: 2020 2020 2073 656c 662e 6661 6374 6f72       self.factor
+0008f750: 5b27 636f 6d70 5f69 6427 5d20 3d20 5b76  ['comp_id'] = [v
+0008f760: 2e75 7070 6572 2829 2066 6f72 2076 2069  .upper() for v i
+0008f770: 6e20 7661 6c5d 0a20 2020 2020 2020 2020  n val].         
+0008f780: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0008f790: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0008f7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008f7b0: 2073 656c 662e 6661 6374 6f72 5b27 636f   self.factor['co
+0008f7c0: 6d70 5f69 6427 5d20 3d20 5b76 616c 2e75  mp_id'] = [val.u
+0008f7d0: 7070 6572 2829 5d0a 2020 2020 2020 2020  pper()].        
+0008f7e0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0008f7f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0008f800: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+0008f810: 5f66 2e61 7070 656e 6428 6622 5b55 6e73  _f.append(f"[Uns
+0008f820: 7570 706f 7274 6564 2064 6174 615d 207b  upported data] {
+0008f830: 7365 6c66 2e5f 5f67 6574 4375 7272 656e  self.__getCurren
+0008f840: 7452 6573 7472 6169 6e74 2829 7d22 0a20  tRestraint()}". 
+0008f850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008f860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008f870: 2020 2020 2020 2066 2254 6865 2073 796d         f"The sym
+0008f880: 626f 6c20 7b73 796d 626f 6c5f 6e61 6d65  bol {symbol_name
+0008f890: 2172 7d20 6973 206e 6f74 2064 6566 696e  !r} is not defin
+0008f8a0: 6564 2e22 290a 0a20 2020 2020 2020 2020  ed.")..         
+0008f8b0: 2020 2020 2020 2069 6620 6576 616c 5f66         if eval_f
+0008f8c0: 6163 746f 7220 616e 6420 2761 746f 6d5f  actor and 'atom_
+0008f8d0: 7365 6c65 6374 696f 6e27 2069 6e20 7365  selection' in se
+0008f8e0: 6c66 2e66 6163 746f 723a 0a20 2020 2020  lf.factor:.     
+0008f8f0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0008f900: 6620 6c65 6e28 7365 6c66 2e66 6163 746f  f len(self.facto
+0008f910: 725b 2761 746f 6d5f 7365 6c65 6374 696f  r['atom_selectio
+0008f920: 6e27 5d29 203d 3d20 3020 616e 6420 2761  n']) == 0 and 'a
+0008f930: 746f 6d5f 6964 2720 696e 205f 5f66 6163  tom_id' in __fac
+0008f940: 746f 723a 0a20 2020 2020 2020 2020 2020  tor:.           
+0008f950: 2020 2020 2020 2020 2020 2020 205f 5f61               __a
+0008f960: 746f 6d49 6420 3d20 5f5f 6661 6374 6f72  tomId = __factor
+0008f970: 5b27 6174 6f6d 5f69 6427 5d5b 305d 2e75  ['atom_id'][0].u
+0008f980: 7070 6572 2829 2069 6620 6c65 6e28 5f5f  pper() if len(__
+0008f990: 6661 6374 6f72 5b27 6174 6f6d 5f69 6427  factor['atom_id'
+0008f9a0: 5d5b 305d 2920 3c3d 2032 2065 6c73 6520  ][0]) <= 2 else 
+0008f9b0: 5f5f 6661 6374 6f72 5b27 6174 6f6d 5f69  __factor['atom_i
+0008f9c0: 6427 5d5b 305d 5b3a 325d 2e75 7070 6572  d'][0][:2].upper
+0008f9d0: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
+0008f9e0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+0008f9f0: 6c66 2e5f 5f77 6974 685f 6178 6973 2061  lf.__with_axis a
+0008fa00: 6e64 205f 5f61 746f 6d49 6420 696e 2058  nd __atomId in X
+0008fa10: 504c 4f52 5f52 4443 5f50 5249 4e43 4950  PLOR_RDC_PRINCIP
+0008fa20: 414c 5f41 5849 535f 4e41 4d45 533a 0a20  AL_AXIS_NAMES:. 
+0008fa30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008fa40: 2020 2020 2020 2020 2020 2070 6173 730a             pass.
+0008fa50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008fa60: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
+0008fa70: 662e 5f5f 7769 7468 5f70 6172 6120 616e  f.__with_para an
+0008fa80: 6420 2828 2763 6f6d 705f 6964 2720 696e  d (('comp_id' in
+0008fa90: 205f 5f66 6163 746f 7220 616e 6420 5f5f   __factor and __
+0008faa0: 6661 6374 6f72 5b27 6174 6f6d 5f69 6427  factor['atom_id'
+0008fab0: 5d5b 305d 203d 3d20 5f5f 6661 6374 6f72  ][0] == __factor
+0008fac0: 5b27 636f 6d70 5f69 6427 5d5b 305d 2061  ['comp_id'][0] a
+0008fad0: 6e64 205f 5f61 746f 6d49 6420 696e 2050  nd __atomId in P
+0008fae0: 4152 414d 4147 4e45 5449 435f 454c 454d  ARAMAGNETIC_ELEM
+0008faf0: 454e 5453 290a 2020 2020 2020 2020 2020  ENTS).          
+0008fb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008fb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008fb20: 2020 2020 2020 2020 206f 7220 5f5f 6174           or __at
+0008fb30: 6f6d 4964 2069 6e20 4645 5252 4f4d 4147  omId in FERROMAG
+0008fb40: 4e45 5449 435f 454c 454d 454e 5453 206f  NETIC_ELEMENTS o
+0008fb50: 7220 5f5f 6174 6f6d 4964 2069 6e20 4c41  r __atomId in LA
+0008fb60: 4e54 4841 4e4f 4944 5f45 4c45 4d45 4e54  NTHANOID_ELEMENT
+0008fb70: 5329 3a0a 2020 2020 2020 2020 2020 2020  S):.            
+0008fb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008fb90: 7061 7373 0a20 2020 2020 2020 2020 2020  pass.           
+0008fba0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+0008fbb0: 6620 7365 6c66 2e5f 5f63 7572 5f73 7562  f self.__cur_sub
+0008fbc0: 7479 7065 203d 3d20 2770 6c61 6e65 273a  type == 'plane':
+0008fbd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0008fbe0: 2020 2020 2020 2020 2020 2020 2070 6173               pas
+0008fbf0: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
+0008fc00: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
+0008fc10: 656c 662e 5f5f 6375 725f 7375 6274 7970  elf.__cur_subtyp
+0008fc20: 6520 3d3d 2027 6469 7374 2720 616e 6420  e == 'dist' and 
+0008fc30: 5f5f 6174 6f6d 4964 2069 6e20 5850 4c4f  __atomId in XPLO
+0008fc40: 525f 4e49 5452 4f58 4944 455f 4e41 4d45  R_NITROXIDE_NAME
+0008fc50: 533a 0a20 2020 2020 2020 2020 2020 2020  S:.             
 0008fc60: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0008fc70: 7269 6e74 2822 2020 2220 2a20 7365 6c66  rint("  " * self
-0008fc80: 2e64 6570 7468 202b 2022 2d2d 3e20 7365  .depth + "--> se
-0008fc90: 6769 6465 6e74 6966 6965 7222 290a 2020  gidentifier").  
-0008fca0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0008fcb0: 206e 6f74 2073 656c 662e 5f5f 6861 7350   not self.__hasP
-0008fcc0: 6f6c 7953 6571 3a0a 2020 2020 2020 2020  olySeq:.        
-0008fcd0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0008fce0: 726e 0a0a 2020 2020 2020 2020 2020 2020  rn..            
-0008fcf0: 2020 2020 6576 616c 5f66 6163 746f 7220      eval_factor 
-0008fd00: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
-0008fd10: 2020 2020 2020 2020 6966 2027 6368 6169          if 'chai
-0008fd20: 6e5f 6964 2720 696e 2073 656c 662e 6661  n_id' in self.fa
-0008fd30: 6374 6f72 3a0a 2020 2020 2020 2020 2020  ctor:.          
-0008fd40: 2020 2020 2020 2020 2020 5f5f 6661 6374            __fact
-0008fd50: 6f72 203d 2063 6f70 792e 636f 7079 2873  or = copy.copy(s
-0008fd60: 656c 662e 6661 6374 6f72 290a 2020 2020  elf.factor).    
-0008fd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008fd80: 7365 6c66 2e63 6f6e 7375 6d65 4661 6374  self.consumeFact
-0008fd90: 6f72 5f65 7870 7265 7373 696f 6e73 2822  or_expressions("
-0008fda0: 2773 6567 6964 656e 7469 6669 6572 2720  'segidentifier' 
-0008fdb0: 636c 6175 7365 222c 2046 616c 7365 290a  clause", False).
-0008fdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008fdd0: 2020 2020 6576 616c 5f66 6163 746f 7220      eval_factor 
-0008fde0: 3d20 5472 7565 0a0a 2020 2020 2020 2020  = True..        
-0008fdf0: 2020 2020 2020 2020 6966 2063 7478 2e43          if ctx.C
-0008fe00: 6f6c 6f6e 2829 3a20 2023 2072 616e 6765  olon():  # range
-0008fe10: 2065 7870 7265 7373 696f 6e0a 2020 2020   expression.    
-0008fe20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008fe30: 6966 2063 7478 2e53 696d 706c 655f 6e61  if ctx.Simple_na
-0008fe40: 6d65 2830 293a 0a20 2020 2020 2020 2020  me(0):.         
-0008fe50: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-0008fe60: 6567 4368 6169 6e49 6420 3d20 7374 7228  egChainId = str(
-0008fe70: 6374 782e 5369 6d70 6c65 5f6e 616d 6528  ctx.Simple_name(
-0008fe80: 3029 290a 2020 2020 2020 2020 2020 2020  0)).            
-0008fe90: 2020 2020 2020 2020 656c 6966 2063 7478          elif ctx
-0008fea0: 2e44 6f75 626c 655f 7175 6f74 655f 7374  .Double_quote_st
-0008feb0: 7269 6e67 2830 293a 0a20 2020 2020 2020  ring(0):.       
-0008fec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008fed0: 2062 6567 4368 6169 6e49 6420 3d20 7374   begChainId = st
-0008fee0: 7228 6374 782e 446f 7562 6c65 5f71 756f  r(ctx.Double_quo
-0008fef0: 7465 5f73 7472 696e 6728 3029 292e 7374  te_string(0)).st
-0008ff00: 7269 7028 2722 2729 2e73 7472 6970 2829  rip('"').strip()
-0008ff10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0008ff20: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
-0008ff30: 6265 6743 6861 696e 4964 2920 3d3d 2030  begChainId) == 0
-0008ff40: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0008ff50: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0008ff60: 7475 726e 0a20 2020 2020 2020 2020 2020  turn.           
-0008ff70: 2020 2020 2020 2020 2069 6620 6374 782e           if ctx.
-0008ff80: 5369 6d70 6c65 5f6e 616d 6528 3129 3a0a  Simple_name(1):.
-0008ff90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ffa0: 2020 2020 2020 2020 656e 6443 6861 696e          endChain
-0008ffb0: 4964 203d 2073 7472 2863 7478 2e53 696d  Id = str(ctx.Sim
-0008ffc0: 706c 655f 6e61 6d65 2831 2929 0a20 2020  ple_name(1)).   
-0008ffd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0008ffe0: 2065 6c69 6620 6374 782e 446f 7562 6c65   elif ctx.Double
-0008fff0: 5f71 756f 7465 5f73 7472 696e 6728 3129  _quote_string(1)
-00090000: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00090010: 2020 2020 2020 2020 2020 656e 6443 6861            endCha
-00090020: 696e 4964 203d 2073 7472 2863 7478 2e44  inId = str(ctx.D
-00090030: 6f75 626c 655f 7175 6f74 655f 7374 7269  ouble_quote_stri
-00090040: 6e67 2831 2929 2e73 7472 6970 2827 2227  ng(1)).strip('"'
-00090050: 292e 7374 7269 7028 290a 2020 2020 2020  ).strip().      
-00090060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090070: 2020 6966 206c 656e 2865 6e64 4368 6169    if len(endChai
-00090080: 6e49 6429 203d 3d20 303a 0a20 2020 2020  nId) == 0:.     
+0008fc70: 6173 730a 2020 2020 2020 2020 2020 2020  ass.            
+0008fc80: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0008fc90: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0008fca0: 2020 2020 2020 2020 2020 2020 2020 5f66                _f
+0008fcb0: 6163 746f 7220 3d20 636f 7079 2e63 6f70  actor = copy.cop
+0008fcc0: 7928 7365 6c66 2e66 6163 746f 7229 0a20  y(self.factor). 
+0008fcd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008fce0: 2020 2020 2020 2020 2020 2069 6620 2761             if 'a
+0008fcf0: 746f 6d5f 7365 6c65 6374 696f 6e27 2069  tom_selection' i
+0008fd00: 6e20 5f5f 6661 6374 6f72 3a0a 2020 2020  n __factor:.    
+0008fd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008fd20: 2020 2020 2020 2020 2020 2020 6465 6c20              del 
+0008fd30: 5f5f 6661 6374 6f72 5b27 6174 6f6d 5f73  __factor['atom_s
+0008fd40: 656c 6563 7469 6f6e 275d 0a20 2020 2020  election'].     
+0008fd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008fd60: 2020 2020 2020 2064 656c 205f 6661 6374         del _fact
+0008fd70: 6f72 5b27 6174 6f6d 5f73 656c 6563 7469  or['atom_selecti
+0008fd80: 6f6e 275d 0a20 2020 2020 2020 2020 2020  on'].           
+0008fd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008fda0: 2073 656c 662e 5f5f 662e 6170 7065 6e64   self.__f.append
+0008fdb0: 2866 225b 496e 7375 6666 6963 6965 6e74  (f"[Insufficient
+0008fdc0: 2061 746f 6d20 7365 6c65 6374 696f 6e5d   atom selection]
+0008fdd0: 207b 7365 6c66 2e5f 5f67 6574 4375 7272   {self.__getCurr
+0008fde0: 656e 7452 6573 7472 6169 6e74 2829 7d22  entRestraint()}"
+0008fdf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0008fe00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008fe10: 2020 2020 2020 2020 2020 2020 2066 2254               f"T
+0008fe20: 6865 2027 7265 736e 616d 6527 2063 6c61  he 'resname' cla
+0008fe30: 7573 6520 6861 7320 6e6f 2065 6666 6563  use has no effec
+0008fe40: 7420 666f 7220 6120 636f 6e6a 756e 6374  t for a conjunct
+0008fe50: 696f 6e20 6f66 2066 6163 746f 7220 7b5f  ion of factor {_
+0008fe60: 5f66 6163 746f 727d 2061 6e64 207b 5f66  _factor} and {_f
+0008fe70: 6163 746f 727d 2e22 290a 0a20 2020 2020  actor}.")..     
+0008fe80: 2020 2020 2020 2065 6c69 6620 6374 782e         elif ctx.
+0008fe90: 5365 6749 6465 6e74 6966 6965 7228 293a  SegIdentifier():
+0008fea0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0008feb0: 2069 6620 7365 6c66 2e5f 5f73 656c 5f65   if self.__sel_e
+0008fec0: 7870 725f 6465 6275 673a 0a20 2020 2020  xpr_debug:.     
+0008fed0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0008fee0: 7269 6e74 2822 2020 2220 2a20 7365 6c66  rint("  " * self
+0008fef0: 2e64 6570 7468 202b 2022 2d2d 3e20 7365  .depth + "--> se
+0008ff00: 6769 6465 6e74 6966 6965 7222 290a 2020  gidentifier").  
+0008ff10: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0008ff20: 206e 6f74 2073 656c 662e 5f5f 6861 7350   not self.__hasP
+0008ff30: 6f6c 7953 6571 3a0a 2020 2020 2020 2020  olySeq:.        
+0008ff40: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0008ff50: 726e 0a0a 2020 2020 2020 2020 2020 2020  rn..            
+0008ff60: 2020 2020 6576 616c 5f66 6163 746f 7220      eval_factor 
+0008ff70: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
+0008ff80: 2020 2020 2020 2020 6966 2027 6368 6169          if 'chai
+0008ff90: 6e5f 6964 2720 696e 2073 656c 662e 6661  n_id' in self.fa
+0008ffa0: 6374 6f72 3a0a 2020 2020 2020 2020 2020  ctor:.          
+0008ffb0: 2020 2020 2020 2020 2020 5f5f 6661 6374            __fact
+0008ffc0: 6f72 203d 2063 6f70 792e 636f 7079 2873  or = copy.copy(s
+0008ffd0: 656c 662e 6661 6374 6f72 290a 2020 2020  elf.factor).    
+0008ffe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0008fff0: 7365 6c66 2e63 6f6e 7375 6d65 4661 6374  self.consumeFact
+00090000: 6f72 5f65 7870 7265 7373 696f 6e73 2822  or_expressions("
+00090010: 2773 6567 6964 656e 7469 6669 6572 2720  'segidentifier' 
+00090020: 636c 6175 7365 222c 2046 616c 7365 290a  clause", False).
+00090030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090040: 2020 2020 6576 616c 5f66 6163 746f 7220      eval_factor 
+00090050: 3d20 5472 7565 0a0a 2020 2020 2020 2020  = True..        
+00090060: 2020 2020 2020 2020 6966 2063 7478 2e43          if ctx.C
+00090070: 6f6c 6f6e 2829 3a20 2023 2072 616e 6765  olon():  # range
+00090080: 2065 7870 7265 7373 696f 6e0a 2020 2020   expression.    
 00090090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000900a0: 2020 2020 2020 2072 6574 7572 6e0a 2020         return.  
-000900b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000900c0: 2020 7365 6c66 2e66 6163 746f 725b 2763    self.factor['c
-000900d0: 6861 696e 5f69 6427 5d20 3d20 5b70 735b  hain_id'] = [ps[
-000900e0: 2761 7574 685f 6368 6169 6e5f 6964 275d  'auth_chain_id']
-000900f0: 2066 6f72 2070 7320 696e 2073 656c 662e   for ps in self.
-00090100: 5f5f 706f 6c79 5365 710a 2020 2020 2020  __polySeq.      
-00090110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090130: 2020 2020 2020 2020 2069 6620 6265 6743           if begC
-00090140: 6861 696e 4964 203c 3d20 7073 5b27 6175  hainId <= ps['au
-00090150: 7468 5f63 6861 696e 5f69 6427 5d20 3c3d  th_chain_id'] <=
-00090160: 2065 6e64 4368 6169 6e49 645d 0a20 2020   endChainId].   
-00090170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090180: 2069 6620 7365 6c66 2e5f 5f68 6173 4e6f   if self.__hasNo
-00090190: 6e50 6f6c 7953 6571 3a0a 2020 2020 2020  nPolySeq:.      
-000901a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000901b0: 2020 666f 7220 6e70 2069 6e20 7365 6c66    for np in self
-000901c0: 2e5f 5f6e 6f6e 506f 6c79 5365 713a 0a20  .__nonPolySeq:. 
-000901d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000901e0: 2020 2020 2020 2020 2020 205f 6368 6169             _chai
-000901f0: 6e49 6420 3d20 6e70 5b27 6175 7468 5f63  nId = np['auth_c
-00090200: 6861 696e 5f69 6427 5d0a 2020 2020 2020  hain_id'].      
-00090210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090220: 2020 2020 2020 6966 2062 6567 4368 6169        if begChai
-00090230: 6e49 6420 3c3d 205f 6368 6169 6e49 6420  nId <= _chainId 
-00090240: 3c3d 2065 6e64 4368 6169 6e49 6420 616e  <= endChainId an
-00090250: 6420 5f63 6861 696e 4964 206e 6f74 2069  d _chainId not i
-00090260: 6e20 7365 6c66 2e66 6163 746f 725b 2763  n self.factor['c
-00090270: 6861 696e 5f69 6427 5d3a 0a20 2020 2020  hain_id']:.     
-00090280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090290: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000902a0: 6661 6374 6f72 5b27 6368 6169 6e5f 6964  factor['chain_id
-000902b0: 275d 2e61 7070 656e 6428 5f63 6861 696e  '].append(_chain
-000902c0: 4964 290a 0a20 2020 2020 2020 2020 2020  Id)..           
-000902d0: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
-000902e0: 7365 6c66 2e66 6163 746f 725b 2763 6861  self.factor['cha
-000902f0: 696e 5f69 6427 5d29 203d 3d20 303a 0a20  in_id']) == 0:. 
+000900a0: 6966 2063 7478 2e53 696d 706c 655f 6e61  if ctx.Simple_na
+000900b0: 6d65 2830 293a 0a20 2020 2020 2020 2020  me(0):.         
+000900c0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+000900d0: 6567 4368 6169 6e49 6420 3d20 7374 7228  egChainId = str(
+000900e0: 6374 782e 5369 6d70 6c65 5f6e 616d 6528  ctx.Simple_name(
+000900f0: 3029 290a 2020 2020 2020 2020 2020 2020  0)).            
+00090100: 2020 2020 2020 2020 656c 6966 2063 7478          elif ctx
+00090110: 2e44 6f75 626c 655f 7175 6f74 655f 7374  .Double_quote_st
+00090120: 7269 6e67 2830 293a 0a20 2020 2020 2020  ring(0):.       
+00090130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090140: 2062 6567 4368 6169 6e49 6420 3d20 7374   begChainId = st
+00090150: 7228 6374 782e 446f 7562 6c65 5f71 756f  r(ctx.Double_quo
+00090160: 7465 5f73 7472 696e 6728 3029 292e 7374  te_string(0)).st
+00090170: 7269 7028 2722 2729 2e73 7472 6970 2829  rip('"').strip()
+00090180: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00090190: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
+000901a0: 6265 6743 6861 696e 4964 2920 3d3d 2030  begChainId) == 0
+000901b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000901c0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+000901d0: 7475 726e 0a20 2020 2020 2020 2020 2020  turn.           
+000901e0: 2020 2020 2020 2020 2069 6620 6374 782e           if ctx.
+000901f0: 5369 6d70 6c65 5f6e 616d 6528 3129 3a0a  Simple_name(1):.
+00090200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090210: 2020 2020 2020 2020 656e 6443 6861 696e          endChain
+00090220: 4964 203d 2073 7472 2863 7478 2e53 696d  Id = str(ctx.Sim
+00090230: 706c 655f 6e61 6d65 2831 2929 0a20 2020  ple_name(1)).   
+00090240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090250: 2065 6c69 6620 6374 782e 446f 7562 6c65   elif ctx.Double
+00090260: 5f71 756f 7465 5f73 7472 696e 6728 3129  _quote_string(1)
+00090270: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00090280: 2020 2020 2020 2020 2020 656e 6443 6861            endCha
+00090290: 696e 4964 203d 2073 7472 2863 7478 2e44  inId = str(ctx.D
+000902a0: 6f75 626c 655f 7175 6f74 655f 7374 7269  ouble_quote_stri
+000902b0: 6e67 2831 2929 2e73 7472 6970 2827 2227  ng(1)).strip('"'
+000902c0: 292e 7374 7269 7028 290a 2020 2020 2020  ).strip().      
+000902d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000902e0: 2020 6966 206c 656e 2865 6e64 4368 6169    if len(endChai
+000902f0: 6e49 6429 203d 3d20 303a 0a20 2020 2020  nId) == 0:.     
 00090300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090310: 2020 2020 2020 2069 6620 6c65 6e28 7365         if len(se
-00090320: 6c66 2e5f 5f70 6f6c 7953 6571 2920 3d3d  lf.__polySeq) ==
-00090330: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-00090340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090350: 7365 6c66 2e66 6163 746f 725b 2763 6861  self.factor['cha
-00090360: 696e 5f69 6427 5d20 3d20 7365 6c66 2e5f  in_id'] = self._
-00090370: 5f70 6f6c 7953 6571 5b30 5d5b 2763 6861  _polySeq[0]['cha
-00090380: 696e 5f69 6427 5d0a 2020 2020 2020 2020  in_id'].        
+00090310: 2020 2020 2020 2072 6574 7572 6e0a 2020         return.  
+00090320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090330: 2020 7365 6c66 2e66 6163 746f 725b 2763    self.factor['c
+00090340: 6861 696e 5f69 6427 5d20 3d20 5b70 735b  hain_id'] = [ps[
+00090350: 2761 7574 685f 6368 6169 6e5f 6964 275d  'auth_chain_id']
+00090360: 2066 6f72 2070 7320 696e 2073 656c 662e   for ps in self.
+00090370: 5f5f 706f 6c79 5365 710a 2020 2020 2020  __polySeq.      
+00090380: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00090390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000903a0: 2020 2020 7365 6c66 2e66 6163 746f 725b      self.factor[
-000903b0: 2761 7574 685f 6368 6169 6e5f 6964 275d  'auth_chain_id']
-000903c0: 203d 205b 6265 6743 6861 696e 4964 2c20   = [begChainId, 
-000903d0: 656e 6443 6861 696e 4964 5d0a 2020 2020  endChainId].    
+000903a0: 2020 2020 2020 2020 2069 6620 6265 6743           if begC
+000903b0: 6861 696e 4964 203c 3d20 7073 5b27 6175  hainId <= ps['au
+000903c0: 7468 5f63 6861 696e 5f69 6427 5d20 3c3d  th_chain_id'] <=
+000903d0: 2065 6e64 4368 6169 6e49 645d 0a20 2020   endChainId].   
 000903e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000903f0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00090400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090410: 2020 2020 2020 7365 6c66 2e66 6163 746f        self.facto
-00090420: 725b 2761 746f 6d5f 6964 275d 203d 205b  r['atom_id'] = [
-00090430: 4e6f 6e65 5d0a 2020 2020 2020 2020 2020  None].          
+000903f0: 2069 6620 7365 6c66 2e5f 5f68 6173 4e6f   if self.__hasNo
+00090400: 6e50 6f6c 7953 6571 3a0a 2020 2020 2020  nPolySeq:.      
+00090410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090420: 2020 666f 7220 6e70 2069 6e20 7365 6c66    for np in self
+00090430: 2e5f 5f6e 6f6e 506f 6c79 5365 713a 0a20  .__nonPolySeq:. 
 00090440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090450: 2020 7365 6c66 2e5f 5f66 2e61 7070 656e    self.__f.appen
-00090460: 6428 6622 5b49 6e76 616c 6964 2064 6174  d(f"[Invalid dat
-00090470: 615d 207b 7365 6c66 2e5f 5f67 6574 4375  a] {self.__getCu
-00090480: 7272 656e 7452 6573 7472 6169 6e74 2829  rrentRestraint()
-00090490: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
-000904a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000904b0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-000904c0: 2243 6f75 6c64 6e27 7420 7370 6563 6966  "Couldn't specif
-000904d0: 7920 7365 676d 656e 7420 6e61 6d65 207b  y segment name {
-000904e0: 6265 6743 6861 696e 4964 3a21 727d 3a7b  begChainId:!r}:{
-000904f0: 656e 6443 6861 696e 4964 3a21 727d 2069  endChainId:!r} i
-00090500: 6e20 7468 6520 636f 6f72 6469 6e61 7465  n the coordinate
-00090510: 732e 2229 0a0a 2020 2020 2020 2020 2020  s.")..          
-00090520: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00090530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090540: 6966 2063 7478 2e53 696d 706c 655f 6e61  if ctx.Simple_na
-00090550: 6d65 2830 2920 6f72 2063 7478 2e44 6f75  me(0) or ctx.Dou
-00090560: 626c 655f 7175 6f74 655f 7374 7269 6e67  ble_quote_string
-00090570: 2830 293a 0a20 2020 2020 2020 2020 2020  (0):.           
-00090580: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00090590: 6374 782e 5369 6d70 6c65 5f6e 616d 6528  ctx.Simple_name(
-000905a0: 3029 3a0a 2020 2020 2020 2020 2020 2020  0):.            
+00090450: 2020 2020 2020 2020 2020 205f 6368 6169             _chai
+00090460: 6e49 6420 3d20 6e70 5b27 6175 7468 5f63  nId = np['auth_c
+00090470: 6861 696e 5f69 6427 5d0a 2020 2020 2020  hain_id'].      
+00090480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090490: 2020 2020 2020 6966 2062 6567 4368 6169        if begChai
+000904a0: 6e49 6420 3c3d 205f 6368 6169 6e49 6420  nId <= _chainId 
+000904b0: 3c3d 2065 6e64 4368 6169 6e49 6420 616e  <= endChainId an
+000904c0: 6420 5f63 6861 696e 4964 206e 6f74 2069  d _chainId not i
+000904d0: 6e20 7365 6c66 2e66 6163 746f 725b 2763  n self.factor['c
+000904e0: 6861 696e 5f69 6427 5d3a 0a20 2020 2020  hain_id']:.     
+000904f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090500: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00090510: 6661 6374 6f72 5b27 6368 6169 6e5f 6964  factor['chain_id
+00090520: 275d 2e61 7070 656e 6428 5f63 6861 696e  '].append(_chain
+00090530: 4964 290a 0a20 2020 2020 2020 2020 2020  Id)..           
+00090540: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
+00090550: 7365 6c66 2e66 6163 746f 725b 2763 6861  self.factor['cha
+00090560: 696e 5f69 6427 5d29 203d 3d20 303a 0a20  in_id']) == 0:. 
+00090570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090580: 2020 2020 2020 2069 6620 6c65 6e28 7365         if len(se
+00090590: 6c66 2e5f 5f70 6f6c 7953 6571 2920 3d3d  lf.__polySeq) ==
+000905a0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
 000905b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000905c0: 6368 6169 6e49 6420 3d20 7374 7228 6374  chainId = str(ct
-000905d0: 782e 5369 6d70 6c65 5f6e 616d 6528 3029  x.Simple_name(0)
-000905e0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000905f0: 2020 2020 2020 2020 2020 656c 6966 2063            elif c
-00090600: 7478 2e44 6f75 626c 655f 7175 6f74 655f  tx.Double_quote_
-00090610: 7374 7269 6e67 2830 293a 0a20 2020 2020  string(0):.     
-00090620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090630: 2020 2020 2020 2063 6861 696e 4964 203d         chainId =
-00090640: 2073 7472 2863 7478 2e44 6f75 626c 655f   str(ctx.Double_
-00090650: 7175 6f74 655f 7374 7269 6e67 2830 2929  quote_string(0))
-00090660: 2e73 7472 6970 2827 2227 292e 7374 7269  .strip('"').stri
-00090670: 7028 290a 2020 2020 2020 2020 2020 2020  p().            
-00090680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090690: 6966 206c 656e 2863 6861 696e 4964 2920  if len(chainId) 
-000906a0: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
+000905c0: 7365 6c66 2e66 6163 746f 725b 2763 6861  self.factor['cha
+000905d0: 696e 5f69 6427 5d20 3d20 7365 6c66 2e5f  in_id'] = self._
+000905e0: 5f70 6f6c 7953 6571 5b30 5d5b 2763 6861  _polySeq[0]['cha
+000905f0: 696e 5f69 6427 5d0a 2020 2020 2020 2020  in_id'].        
+00090600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090610: 2020 2020 7365 6c66 2e66 6163 746f 725b      self.factor[
+00090620: 2761 7574 685f 6368 6169 6e5f 6964 275d  'auth_chain_id']
+00090630: 203d 205b 6265 6743 6861 696e 4964 2c20   = [begChainId, 
+00090640: 656e 6443 6861 696e 4964 5d0a 2020 2020  endChainId].    
+00090650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090660: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00090670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090680: 2020 2020 2020 7365 6c66 2e66 6163 746f        self.facto
+00090690: 725b 2761 746f 6d5f 6964 275d 203d 205b  r['atom_id'] = [
+000906a0: 4e6f 6e65 5d0a 2020 2020 2020 2020 2020  None].          
 000906b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000906c0: 2020 2020 2020 7265 7475 726e 0a20 2020        return.   
-000906d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000906e0: 2020 2020 2073 656c 662e 6661 6374 6f72       self.factor
-000906f0: 5b27 6368 6169 6e5f 6964 275d 203d 205b  ['chain_id'] = [
-00090700: 7073 5b27 6175 7468 5f63 6861 696e 5f69  ps['auth_chain_i
-00090710: 6427 5d20 666f 7220 7073 2069 6e20 7365  d'] for ps in se
-00090720: 6c66 2e5f 5f70 6f6c 7953 6571 0a20 2020  lf.__polySeq.   
-00090730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090760: 6966 2070 735b 2761 7574 685f 6368 6169  if ps['auth_chai
-00090770: 6e5f 6964 275d 203d 3d20 7365 6c66 2e67  n_id'] == self.g
-00090780: 6574 5265 616c 4368 6169 6e49 6428 6368  etRealChainId(ch
-00090790: 6169 6e49 6429 5d0a 2020 2020 2020 2020  ainId)].        
+000906c0: 2020 7365 6c66 2e5f 5f66 2e61 7070 656e    self.__f.appen
+000906d0: 6428 6622 5b49 6e76 616c 6964 2064 6174  d(f"[Invalid dat
+000906e0: 615d 207b 7365 6c66 2e5f 5f67 6574 4375  a] {self.__getCu
+000906f0: 7272 656e 7452 6573 7472 6169 6e74 2829  rrentRestraint()
+00090700: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
+00090710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090720: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00090730: 2243 6f75 6c64 6e27 7420 7370 6563 6966  "Couldn't specif
+00090740: 7920 7365 676d 656e 7420 6e61 6d65 207b  y segment name {
+00090750: 6265 6743 6861 696e 4964 3a21 727d 3a7b  begChainId:!r}:{
+00090760: 656e 6443 6861 696e 4964 3a21 727d 2069  endChainId:!r} i
+00090770: 6e20 7468 6520 636f 6f72 6469 6e61 7465  n the coordinate
+00090780: 732e 2229 0a0a 2020 2020 2020 2020 2020  s.")..          
+00090790: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
 000907a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000907b0: 6966 2073 656c 662e 5f5f 6861 734e 6f6e  if self.__hasNon
-000907c0: 506f 6c79 5365 713a 0a20 2020 2020 2020  PolySeq:.       
-000907d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000907e0: 2020 2020 2066 6f72 206e 7020 696e 2073       for np in s
-000907f0: 656c 662e 5f5f 6e6f 6e50 6f6c 7953 6571  elf.__nonPolySeq
-00090800: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00090810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090820: 2020 5f63 6861 696e 4964 203d 206e 705b    _chainId = np[
-00090830: 2761 7574 685f 6368 6169 6e5f 6964 275d  'auth_chain_id']
-00090840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00090850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090860: 2069 6620 5f63 6861 696e 4964 203d 3d20   if _chainId == 
-00090870: 7365 6c66 2e67 6574 5265 616c 4368 6169  self.getRealChai
-00090880: 6e49 6428 6368 6169 6e49 6429 2061 6e64  nId(chainId) and
-00090890: 205f 6368 6169 6e49 6420 6e6f 7420 696e   _chainId not in
-000908a0: 2073 656c 662e 6661 6374 6f72 5b27 6368   self.factor['ch
-000908b0: 6169 6e5f 6964 275d 3a0a 2020 2020 2020  ain_id']:.      
-000908c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000908d0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000908e0: 6c66 2e66 6163 746f 725b 2763 6861 696e  lf.factor['chain
-000908f0: 5f69 6427 5d2e 6170 7065 6e64 285f 6368  _id'].append(_ch
-00090900: 6169 6e49 6429 0a20 2020 2020 2020 2020  ainId).         
-00090910: 2020 2020 2020 2020 2020 2069 6620 6374             if ct
-00090920: 782e 5369 6d70 6c65 5f6e 616d 6573 2830  x.Simple_names(0
-00090930: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00090940: 2020 2020 2020 2020 2020 2063 6861 696e             chain
-00090950: 4964 203d 2073 7472 2863 7478 2e53 696d  Id = str(ctx.Sim
-00090960: 706c 655f 6e61 6d65 7328 3029 290a 2020  ple_names(0)).  
-00090970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090980: 2020 2020 2020 5f63 6861 696e 4964 203d        _chainId =
-00090990: 2074 6f52 6567 4578 2863 6861 696e 4964   toRegEx(chainId
-000909a0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000909b0: 2020 2020 2020 2020 2020 7365 6c66 2e66            self.f
-000909c0: 6163 746f 725b 2763 6861 696e 5f69 6427  actor['chain_id'
-000909d0: 5d20 3d20 5b70 735b 2761 7574 685f 6368  ] = [ps['auth_ch
-000909e0: 6169 6e5f 6964 275d 2066 6f72 2070 7320  ain_id'] for ps 
-000909f0: 696e 2073 656c 662e 5f5f 706f 6c79 5365  in self.__polySe
-00090a00: 710a 2020 2020 2020 2020 2020 2020 2020  q.              
+000907b0: 6966 2063 7478 2e53 696d 706c 655f 6e61  if ctx.Simple_na
+000907c0: 6d65 2830 2920 6f72 2063 7478 2e44 6f75  me(0) or ctx.Dou
+000907d0: 626c 655f 7175 6f74 655f 7374 7269 6e67  ble_quote_string
+000907e0: 2830 293a 0a20 2020 2020 2020 2020 2020  (0):.           
+000907f0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00090800: 6374 782e 5369 6d70 6c65 5f6e 616d 6528  ctx.Simple_name(
+00090810: 3029 3a0a 2020 2020 2020 2020 2020 2020  0):.            
+00090820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090830: 6368 6169 6e49 6420 3d20 7374 7228 6374  chainId = str(ct
+00090840: 782e 5369 6d70 6c65 5f6e 616d 6528 3029  x.Simple_name(0)
+00090850: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00090860: 2020 2020 2020 2020 2020 656c 6966 2063            elif c
+00090870: 7478 2e44 6f75 626c 655f 7175 6f74 655f  tx.Double_quote_
+00090880: 7374 7269 6e67 2830 293a 0a20 2020 2020  string(0):.     
+00090890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000908a0: 2020 2020 2020 2063 6861 696e 4964 203d         chainId =
+000908b0: 2073 7472 2863 7478 2e44 6f75 626c 655f   str(ctx.Double_
+000908c0: 7175 6f74 655f 7374 7269 6e67 2830 2929  quote_string(0))
+000908d0: 2e73 7472 6970 2827 2227 292e 7374 7269  .strip('"').stri
+000908e0: 7028 290a 2020 2020 2020 2020 2020 2020  p().            
+000908f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090900: 6966 206c 656e 2863 6861 696e 4964 2920  if len(chainId) 
+00090910: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
+00090920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090930: 2020 2020 2020 7265 7475 726e 0a20 2020        return.   
+00090940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090950: 2020 2020 2073 656c 662e 6661 6374 6f72       self.factor
+00090960: 5b27 6368 6169 6e5f 6964 275d 203d 205b  ['chain_id'] = [
+00090970: 7073 5b27 6175 7468 5f63 6861 696e 5f69  ps['auth_chain_i
+00090980: 6427 5d20 666f 7220 7073 2069 6e20 7365  d'] for ps in se
+00090990: 6c66 2e5f 5f70 6f6c 7953 6571 0a20 2020  lf.__polySeq.   
+000909a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000909b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000909c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000909d0: 6966 2070 735b 2761 7574 685f 6368 6169  if ps['auth_chai
+000909e0: 6e5f 6964 275d 203d 3d20 7365 6c66 2e67  n_id'] == self.g
+000909f0: 6574 5265 616c 4368 6169 6e49 6428 6368  etRealChainId(ch
+00090a00: 6169 6e49 6429 5d0a 2020 2020 2020 2020  ainId)].        
 00090a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090a30: 2020 2020 2069 6620 7265 2e6d 6174 6368       if re.match
-00090a40: 285f 6368 6169 6e49 642c 2070 735b 2761  (_chainId, ps['a
-00090a50: 7574 685f 6368 6169 6e5f 6964 275d 295d  uth_chain_id'])]
-00090a60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00090a70: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00090a80: 2e5f 5f68 6173 4e6f 6e50 6f6c 7953 6571  .__hasNonPolySeq
-00090a90: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00090aa0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00090ab0: 7220 6e70 2069 6e20 7365 6c66 2e5f 5f6e  r np in self.__n
-00090ac0: 6f6e 506f 6c79 5365 713a 0a20 2020 2020  onPolySeq:.     
-00090ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090ae0: 2020 2020 2020 2020 2020 205f 5f63 6861             __cha
-00090af0: 696e 4964 203d 206e 705b 2761 7574 685f  inId = np['auth_
-00090b00: 6368 6169 6e5f 6964 275d 0a20 2020 2020  chain_id'].     
-00090b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090b20: 2020 2020 2020 2020 2020 2069 6620 7265             if re
-00090b30: 2e6d 6174 6368 285f 6368 6169 6e49 642c  .match(_chainId,
-00090b40: 205f 5f63 6861 696e 4964 2920 616e 6420   __chainId) and 
-00090b50: 5f5f 6368 6169 6e49 6420 6e6f 7420 696e  __chainId not in
-00090b60: 2073 656c 662e 6661 6374 6f72 5b27 6368   self.factor['ch
-00090b70: 6169 6e5f 6964 275d 3a0a 2020 2020 2020  ain_id']:.      
-00090b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090b90: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00090ba0: 6c66 2e66 6163 746f 725b 2763 6861 696e  lf.factor['chain
-00090bb0: 5f69 6427 5d2e 6170 7065 6e64 285f 5f63  _id'].append(__c
-00090bc0: 6861 696e 4964 290a 2020 2020 2020 2020  hainId).        
-00090bd0: 2020 2020 2020 2020 2020 2020 6966 2063              if c
-00090be0: 7478 2e53 796d 626f 6c5f 6e61 6d65 2829  tx.Symbol_name()
-00090bf0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00090c00: 2020 2020 2020 2020 2020 7379 6d62 6f6c            symbol
-00090c10: 5f6e 616d 6520 3d20 6368 6169 6e49 6420  _name = chainId 
-00090c20: 3d20 7374 7228 6374 782e 5379 6d62 6f6c  = str(ctx.Symbol
-00090c30: 5f6e 616d 6528 2929 0a20 2020 2020 2020  _name()).       
-00090c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090c50: 2069 6620 7379 6d62 6f6c 5f6e 616d 6520   if symbol_name 
-00090c60: 696e 2073 656c 662e 6576 616c 7561 7465  in self.evaluate
-00090c70: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00090c80: 2020 2020 2020 2020 2020 2020 2020 7661                va
-00090c90: 6c20 3d20 7365 6c66 2e65 7661 6c75 6174  l = self.evaluat
-00090ca0: 655b 7379 6d62 6f6c 5f6e 616d 655d 0a20  e[symbol_name]. 
-00090cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090cc0: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-00090cd0: 696e 7374 616e 6365 2876 616c 2c20 6c69  instance(val, li
-00090ce0: 7374 293a 0a20 2020 2020 2020 2020 2020  st):.           
-00090cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090d00: 2020 2020 2073 656c 662e 6661 6374 6f72       self.factor
-00090d10: 5b27 6368 6169 6e5f 6964 275d 203d 2076  ['chain_id'] = v
-00090d20: 616c 0a20 2020 2020 2020 2020 2020 2020  al.             
-00090d30: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00090d40: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00090d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090d60: 2020 2020 2073 656c 662e 6661 6374 6f72       self.factor
-00090d70: 5b27 6368 6169 6e5f 6964 275d 203d 205b  ['chain_id'] = [
-00090d80: 7661 6c5d 0a20 2020 2020 2020 2020 2020  val].           
-00090d90: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-00090da0: 6620 7379 6d62 6f6c 5f6e 616d 6520 696e  f symbol_name in
-00090db0: 2073 656c 662e 6576 616c 7561 7465 466f   self.evaluateFo
-00090dc0: 723a 0a20 2020 2020 2020 2020 2020 2020  r:.             
-00090dd0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-00090de0: 616c 203d 2073 656c 662e 6576 616c 7561  al = self.evalua
-00090df0: 7465 466f 725b 7379 6d62 6f6c 5f6e 616d  teFor[symbol_nam
-00090e00: 655d 0a20 2020 2020 2020 2020 2020 2020  e].             
-00090e10: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00090e20: 6620 6973 696e 7374 616e 6365 2876 616c  f isinstance(val
-00090e30: 2c20 6c69 7374 293a 0a20 2020 2020 2020  , list):.       
-00090e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090e50: 2020 2020 2020 2020 2073 656c 662e 6661           self.fa
-00090e60: 6374 6f72 5b27 6368 6169 6e5f 6964 275d  ctor['chain_id']
-00090e70: 203d 2076 616c 0a20 2020 2020 2020 2020   = val.         
-00090e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090e90: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00090ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090eb0: 2020 2020 2020 2020 2073 656c 662e 6661           self.fa
-00090ec0: 6374 6f72 5b27 6368 6169 6e5f 6964 275d  ctor['chain_id']
-00090ed0: 203d 205b 7661 6c5d 0a20 2020 2020 2020   = [val].       
-00090ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090ef0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00090f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090f10: 2020 2073 656c 662e 5f5f 662e 6170 7065     self.__f.appe
-00090f20: 6e64 2866 225b 556e 7375 7070 6f72 7465  nd(f"[Unsupporte
-00090f30: 6420 6461 7461 5d20 7b73 656c 662e 5f5f  d data] {self.__
-00090f40: 6765 7443 7572 7265 6e74 5265 7374 7261  getCurrentRestra
-00090f50: 696e 7428 297d 220a 2020 2020 2020 2020  int()}".        
+00090a20: 6966 2073 656c 662e 5f5f 6861 734e 6f6e  if self.__hasNon
+00090a30: 506f 6c79 5365 713a 0a20 2020 2020 2020  PolySeq:.       
+00090a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090a50: 2020 2020 2066 6f72 206e 7020 696e 2073       for np in s
+00090a60: 656c 662e 5f5f 6e6f 6e50 6f6c 7953 6571  elf.__nonPolySeq
+00090a70: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00090a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090a90: 2020 5f63 6861 696e 4964 203d 206e 705b    _chainId = np[
+00090aa0: 2761 7574 685f 6368 6169 6e5f 6964 275d  'auth_chain_id']
+00090ab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00090ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090ad0: 2069 6620 5f63 6861 696e 4964 203d 3d20   if _chainId == 
+00090ae0: 7365 6c66 2e67 6574 5265 616c 4368 6169  self.getRealChai
+00090af0: 6e49 6428 6368 6169 6e49 6429 2061 6e64  nId(chainId) and
+00090b00: 205f 6368 6169 6e49 6420 6e6f 7420 696e   _chainId not in
+00090b10: 2073 656c 662e 6661 6374 6f72 5b27 6368   self.factor['ch
+00090b20: 6169 6e5f 6964 275d 3a0a 2020 2020 2020  ain_id']:.      
+00090b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090b40: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00090b50: 6c66 2e66 6163 746f 725b 2763 6861 696e  lf.factor['chain
+00090b60: 5f69 6427 5d2e 6170 7065 6e64 285f 6368  _id'].append(_ch
+00090b70: 6169 6e49 6429 0a20 2020 2020 2020 2020  ainId).         
+00090b80: 2020 2020 2020 2020 2020 2069 6620 6374             if ct
+00090b90: 782e 5369 6d70 6c65 5f6e 616d 6573 2830  x.Simple_names(0
+00090ba0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00090bb0: 2020 2020 2020 2020 2020 2063 6861 696e             chain
+00090bc0: 4964 203d 2073 7472 2863 7478 2e53 696d  Id = str(ctx.Sim
+00090bd0: 706c 655f 6e61 6d65 7328 3029 290a 2020  ple_names(0)).  
+00090be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090bf0: 2020 2020 2020 5f63 6861 696e 4964 203d        _chainId =
+00090c00: 2074 6f52 6567 4578 2863 6861 696e 4964   toRegEx(chainId
+00090c10: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00090c20: 2020 2020 2020 2020 2020 7365 6c66 2e66            self.f
+00090c30: 6163 746f 725b 2763 6861 696e 5f69 6427  actor['chain_id'
+00090c40: 5d20 3d20 5b70 735b 2761 7574 685f 6368  ] = [ps['auth_ch
+00090c50: 6169 6e5f 6964 275d 2066 6f72 2070 7320  ain_id'] for ps 
+00090c60: 696e 2073 656c 662e 5f5f 706f 6c79 5365  in self.__polySe
+00090c70: 710a 2020 2020 2020 2020 2020 2020 2020  q.              
+00090c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090ca0: 2020 2020 2069 6620 7265 2e6d 6174 6368       if re.match
+00090cb0: 285f 6368 6169 6e49 642c 2070 735b 2761  (_chainId, ps['a
+00090cc0: 7574 685f 6368 6169 6e5f 6964 275d 295d  uth_chain_id'])]
+00090cd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00090ce0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00090cf0: 2e5f 5f68 6173 4e6f 6e50 6f6c 7953 6571  .__hasNonPolySeq
+00090d00: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00090d10: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00090d20: 7220 6e70 2069 6e20 7365 6c66 2e5f 5f6e  r np in self.__n
+00090d30: 6f6e 506f 6c79 5365 713a 0a20 2020 2020  onPolySeq:.     
+00090d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090d50: 2020 2020 2020 2020 2020 205f 5f63 6861             __cha
+00090d60: 696e 4964 203d 206e 705b 2761 7574 685f  inId = np['auth_
+00090d70: 6368 6169 6e5f 6964 275d 0a20 2020 2020  chain_id'].     
+00090d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090d90: 2020 2020 2020 2020 2020 2069 6620 7265             if re
+00090da0: 2e6d 6174 6368 285f 6368 6169 6e49 642c  .match(_chainId,
+00090db0: 205f 5f63 6861 696e 4964 2920 616e 6420   __chainId) and 
+00090dc0: 5f5f 6368 6169 6e49 6420 6e6f 7420 696e  __chainId not in
+00090dd0: 2073 656c 662e 6661 6374 6f72 5b27 6368   self.factor['ch
+00090de0: 6169 6e5f 6964 275d 3a0a 2020 2020 2020  ain_id']:.      
+00090df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090e00: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00090e10: 6c66 2e66 6163 746f 725b 2763 6861 696e  lf.factor['chain
+00090e20: 5f69 6427 5d2e 6170 7065 6e64 285f 5f63  _id'].append(__c
+00090e30: 6861 696e 4964 290a 2020 2020 2020 2020  hainId).        
+00090e40: 2020 2020 2020 2020 2020 2020 6966 2063              if c
+00090e50: 7478 2e53 796d 626f 6c5f 6e61 6d65 2829  tx.Symbol_name()
+00090e60: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00090e70: 2020 2020 2020 2020 2020 7379 6d62 6f6c            symbol
+00090e80: 5f6e 616d 6520 3d20 6368 6169 6e49 6420  _name = chainId 
+00090e90: 3d20 7374 7228 6374 782e 5379 6d62 6f6c  = str(ctx.Symbol
+00090ea0: 5f6e 616d 6528 2929 0a20 2020 2020 2020  _name()).       
+00090eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090ec0: 2069 6620 7379 6d62 6f6c 5f6e 616d 6520   if symbol_name 
+00090ed0: 696e 2073 656c 662e 6576 616c 7561 7465  in self.evaluate
+00090ee0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00090ef0: 2020 2020 2020 2020 2020 2020 2020 7661                va
+00090f00: 6c20 3d20 7365 6c66 2e65 7661 6c75 6174  l = self.evaluat
+00090f10: 655b 7379 6d62 6f6c 5f6e 616d 655d 0a20  e[symbol_name]. 
+00090f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090f30: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+00090f40: 696e 7374 616e 6365 2876 616c 2c20 6c69  instance(val, li
+00090f50: 7374 293a 0a20 2020 2020 2020 2020 2020  st):.           
 00090f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00090f80: 2020 2020 6622 5468 6520 7379 6d62 6f6c      f"The symbol
-00090f90: 207b 7379 6d62 6f6c 5f6e 616d 6521 727d   {symbol_name!r}
-00090fa0: 2069 7320 6e6f 7420 6465 6669 6e65 642e   is not defined.
-00090fb0: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
-00090fc0: 2020 2020 2020 2069 6620 6c65 6e28 7365         if len(se
-00090fd0: 6c66 2e66 6163 746f 725b 2763 6861 696e  lf.factor['chain
-00090fe0: 5f69 6427 5d29 203d 3d20 303a 0a20 2020  _id']) == 0:.   
-00090ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091000: 2020 2020 2069 6620 6c65 6e28 7365 6c66       if len(self
-00091010: 2e5f 5f70 6f6c 7953 6571 2920 3d3d 2031  .__polySeq) == 1
-00091020: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00091030: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00091040: 6c66 2e66 6163 746f 725b 2763 6861 696e  lf.factor['chain
-00091050: 5f69 6427 5d20 3d20 7365 6c66 2e5f 5f70  _id'] = self.__p
-00091060: 6f6c 7953 6571 5b30 5d5b 2763 6861 696e  olySeq[0]['chain
-00091070: 5f69 6427 5d0a 2020 2020 2020 2020 2020  _id'].          
-00091080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091090: 2020 7365 6c66 2e66 6163 746f 725b 2761    self.factor['a
-000910a0: 7574 685f 6368 6169 6e5f 6964 275d 203d  uth_chain_id'] =
-000910b0: 2063 6861 696e 4964 0a20 2020 2020 2020   chainId.       
-000910c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000910d0: 2065 6c69 6620 7365 6c66 2e5f 5f72 6561   elif self.__rea
-000910e0: 736f 6e73 2069 7320 6e6f 7420 4e6f 6e65  sons is not None
-000910f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00091100: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00091110: 6c66 2e66 6163 746f 725b 2761 746f 6d5f  lf.factor['atom_
-00091120: 6964 275d 203d 205b 4e6f 6e65 5d0a 2020  id'] = [None].  
-00091130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091140: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00091150: 5f66 2e61 7070 656e 6428 6622 5b49 6e76  _f.append(f"[Inv
-00091160: 616c 6964 2064 6174 615d 207b 7365 6c66  alid data] {self
-00091170: 2e5f 5f67 6574 4375 7272 656e 7452 6573  .__getCurrentRes
-00091180: 7472 6169 6e74 2829 7d22 0a20 2020 2020  traint()}".     
-00091190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000911a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000911b0: 2020 2020 2020 2022 436f 756c 646e 2774         "Couldn't
-000911c0: 2073 7065 6369 6679 2073 6567 6d65 6e74   specify segment
-000911d0: 206e 616d 6520 220a 2020 2020 2020 2020   name ".        
+00090f70: 2020 2020 2073 656c 662e 6661 6374 6f72       self.factor
+00090f80: 5b27 6368 6169 6e5f 6964 275d 203d 2076  ['chain_id'] = v
+00090f90: 616c 0a20 2020 2020 2020 2020 2020 2020  al.             
+00090fa0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00090fb0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00090fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00090fd0: 2020 2020 2073 656c 662e 6661 6374 6f72       self.factor
+00090fe0: 5b27 6368 6169 6e5f 6964 275d 203d 205b  ['chain_id'] = [
+00090ff0: 7661 6c5d 0a20 2020 2020 2020 2020 2020  val].           
+00091000: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+00091010: 6620 7379 6d62 6f6c 5f6e 616d 6520 696e  f symbol_name in
+00091020: 2073 656c 662e 6576 616c 7561 7465 466f   self.evaluateFo
+00091030: 723a 0a20 2020 2020 2020 2020 2020 2020  r:.             
+00091040: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00091050: 616c 203d 2073 656c 662e 6576 616c 7561  al = self.evalua
+00091060: 7465 466f 725b 7379 6d62 6f6c 5f6e 616d  teFor[symbol_nam
+00091070: 655d 0a20 2020 2020 2020 2020 2020 2020  e].             
+00091080: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00091090: 6620 6973 696e 7374 616e 6365 2876 616c  f isinstance(val
+000910a0: 2c20 6c69 7374 293a 0a20 2020 2020 2020  , list):.       
+000910b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000910c0: 2020 2020 2020 2020 2073 656c 662e 6661           self.fa
+000910d0: 6374 6f72 5b27 6368 6169 6e5f 6964 275d  ctor['chain_id']
+000910e0: 203d 2076 616c 0a20 2020 2020 2020 2020   = val.         
+000910f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091100: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00091110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091120: 2020 2020 2020 2020 2073 656c 662e 6661           self.fa
+00091130: 6374 6f72 5b27 6368 6169 6e5f 6964 275d  ctor['chain_id']
+00091140: 203d 205b 7661 6c5d 0a20 2020 2020 2020   = [val].       
+00091150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091160: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00091170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091180: 2020 2073 656c 662e 5f5f 662e 6170 7065     self.__f.appe
+00091190: 6e64 2866 225b 556e 7375 7070 6f72 7465  nd(f"[Unsupporte
+000911a0: 6420 6461 7461 5d20 7b73 656c 662e 5f5f  d data] {self.__
+000911b0: 6765 7443 7572 7265 6e74 5265 7374 7261  getCurrentRestra
+000911c0: 696e 7428 297d 220a 2020 2020 2020 2020  int()}".        
+000911d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000911e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000911f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091200: 2020 2020 6622 277b 6368 6169 6e49 647d      f"'{chainId}
-00091210: 2720 696e 2074 6865 2063 6f6f 7264 696e  ' in the coordin
-00091220: 6174 6573 2e22 2920 2023 2064 6f20 6e6f  ates.")  # do no
-00091230: 7420 7573 6520 2763 6861 696e 4964 2172  t use 'chainId!r
-00091240: 2720 6578 7072 6573 7369 6f6e 2c20 2725  ' expression, '%
-00091250: 2720 636f 6465 2074 6872 6f77 7320 5661  ' code throws Va
-00091260: 6c75 6545 7272 6f72 0a20 2020 2020 2020  lueError.       
-00091270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091280: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00091290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000912a0: 2020 2069 6620 2773 6567 6d65 6e74 5f69     if 'segment_i
-000912b0: 645f 6d69 736d 6174 6368 2720 6e6f 7420  d_mismatch' not 
-000912c0: 696e 2073 656c 662e 7265 6173 6f6e 7346  in self.reasonsF
-000912d0: 6f72 5265 5061 7273 696e 673a 0a20 2020  orReParsing:.   
-000912e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000912f0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00091300: 662e 7265 6173 6f6e 7346 6f72 5265 5061  f.reasonsForRePa
-00091310: 7273 696e 675b 2773 6567 6d65 6e74 5f69  rsing['segment_i
-00091320: 645f 6d69 736d 6174 6368 275d 203d 207b  d_mismatch'] = {
-00091330: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
-00091340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091350: 2020 7365 6c66 2e72 6561 736f 6e73 466f    self.reasonsFo
-00091360: 7252 6550 6172 7369 6e67 5b27 7365 676d  rReParsing['segm
-00091370: 656e 745f 6964 5f6d 6174 6368 5f73 7461  ent_id_match_sta
-00091380: 7473 275d 203d 207b 7d0a 2020 2020 2020  ts'] = {}.      
-00091390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000913a0: 2020 2020 2020 6966 2063 6861 696e 4964        if chainId
-000913b0: 206e 6f74 2069 6e20 7365 6c66 2e72 6561   not in self.rea
-000913c0: 736f 6e73 466f 7252 6550 6172 7369 6e67  sonsForReParsing
-000913d0: 5b27 7365 676d 656e 745f 6964 5f6d 6973  ['segment_id_mis
-000913e0: 6d61 7463 6827 5d3a 0a20 2020 2020 2020  match']:.       
-000913f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091400: 2020 2020 2020 2020 2073 656c 662e 7265           self.re
-00091410: 6173 6f6e 7346 6f72 5265 5061 7273 696e  asonsForReParsin
-00091420: 675b 2773 6567 6d65 6e74 5f69 645f 6d69  g['segment_id_mi
-00091430: 736d 6174 6368 275d 5b63 6861 696e 4964  smatch'][chainId
-00091440: 5d20 3d20 4e6f 6e65 0a20 2020 2020 2020  ] = None.       
+000911f0: 2020 2020 6622 5468 6520 7379 6d62 6f6c      f"The symbol
+00091200: 207b 7379 6d62 6f6c 5f6e 616d 6521 727d   {symbol_name!r}
+00091210: 2069 7320 6e6f 7420 6465 6669 6e65 642e   is not defined.
+00091220: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+00091230: 2020 2020 2020 2069 6620 6c65 6e28 7365         if len(se
+00091240: 6c66 2e66 6163 746f 725b 2763 6861 696e  lf.factor['chain
+00091250: 5f69 6427 5d29 203d 3d20 303a 0a20 2020  _id']) == 0:.   
+00091260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091270: 2020 2020 2069 6620 6c65 6e28 7365 6c66       if len(self
+00091280: 2e5f 5f70 6f6c 7953 6571 2920 3d3d 2031  .__polySeq) == 1
+00091290: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000912a0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000912b0: 6c66 2e66 6163 746f 725b 2763 6861 696e  lf.factor['chain
+000912c0: 5f69 6427 5d20 3d20 7365 6c66 2e5f 5f70  _id'] = self.__p
+000912d0: 6f6c 7953 6571 5b30 5d5b 2763 6861 696e  olySeq[0]['chain
+000912e0: 5f69 6427 5d0a 2020 2020 2020 2020 2020  _id'].          
+000912f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091300: 2020 7365 6c66 2e66 6163 746f 725b 2761    self.factor['a
+00091310: 7574 685f 6368 6169 6e5f 6964 275d 203d  uth_chain_id'] =
+00091320: 2063 6861 696e 4964 0a20 2020 2020 2020   chainId.       
+00091330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091340: 2065 6c69 6620 7365 6c66 2e5f 5f72 6561   elif self.__rea
+00091350: 736f 6e73 2069 7320 6e6f 7420 4e6f 6e65  sons is not None
+00091360: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00091370: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00091380: 6c66 2e66 6163 746f 725b 2761 746f 6d5f  lf.factor['atom_
+00091390: 6964 275d 203d 205b 4e6f 6e65 5d0a 2020  id'] = [None].  
+000913a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000913b0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+000913c0: 5f66 2e61 7070 656e 6428 6622 5b49 6e76  _f.append(f"[Inv
+000913d0: 616c 6964 2064 6174 615d 207b 7365 6c66  alid data] {self
+000913e0: 2e5f 5f67 6574 4375 7272 656e 7452 6573  .__getCurrentRes
+000913f0: 7472 6169 6e74 2829 7d22 0a20 2020 2020  traint()}".     
+00091400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091420: 2020 2020 2020 2022 436f 756c 646e 2774         "Couldn't
+00091430: 2073 7065 6369 6679 2073 6567 6d65 6e74   specify segment
+00091440: 206e 616d 6520 220a 2020 2020 2020 2020   name ".        
 00091450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091460: 2020 2020 2020 2020 2073 656c 662e 7265           self.re
-00091470: 6173 6f6e 7346 6f72 5265 5061 7273 696e  asonsForReParsin
-00091480: 675b 2773 6567 6d65 6e74 5f69 645f 6d61  g['segment_id_ma
-00091490: 7463 685f 7374 6174 7327 5d5b 6368 6169  tch_stats'][chai
-000914a0: 6e49 645d 203d 207b 7d0a 2020 2020 2020  nId] = {}.      
-000914b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000914c0: 2020 2020 2020 7365 6c66 2e66 6163 746f        self.facto
-000914d0: 725b 2761 6c74 5f63 6861 696e 5f69 6427  r['alt_chain_id'
-000914e0: 5d20 3d20 6368 6169 6e49 640a 0a20 2020  ] = chainId..   
-000914f0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00091500: 6576 616c 5f66 6163 746f 7220 616e 6420  eval_factor and 
-00091510: 2761 746f 6d5f 7365 6c65 6374 696f 6e27  'atom_selection'
-00091520: 2069 6e20 7365 6c66 2e66 6163 746f 723a   in self.factor:
-00091530: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00091540: 2020 2020 2069 6620 6c65 6e28 7365 6c66       if len(self
-00091550: 2e66 6163 746f 725b 2761 746f 6d5f 7365  .factor['atom_se
-00091560: 6c65 6374 696f 6e27 5d29 203d 3d20 3020  lection']) == 0 
-00091570: 616e 6420 2761 746f 6d5f 6964 2720 696e  and 'atom_id' in
-00091580: 205f 5f66 6163 746f 723a 0a20 2020 2020   __factor:.     
-00091590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000915a0: 2020 205f 5f61 746f 6d49 6420 3d20 5f5f     __atomId = __
-000915b0: 6661 6374 6f72 5b27 6174 6f6d 5f69 6427  factor['atom_id'
-000915c0: 5d5b 305d 2e75 7070 6572 2829 2069 6620  ][0].upper() if 
-000915d0: 6c65 6e28 5f5f 6661 6374 6f72 5b27 6174  len(__factor['at
-000915e0: 6f6d 5f69 6427 5d5b 305d 2920 3c3d 2032  om_id'][0]) <= 2
-000915f0: 2065 6c73 6520 5f5f 6661 6374 6f72 5b27   else __factor['
-00091600: 6174 6f6d 5f69 6427 5d5b 305d 5b3a 325d  atom_id'][0][:2]
-00091610: 2e75 7070 6572 2829 0a20 2020 2020 2020  .upper().       
-00091620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091630: 2069 6620 7365 6c66 2e5f 5f77 6974 685f   if self.__with_
-00091640: 6178 6973 2061 6e64 205f 5f61 746f 6d49  axis and __atomI
-00091650: 6420 696e 2058 504c 4f52 5f52 4443 5f50  d in XPLOR_RDC_P
-00091660: 5249 4e43 4950 414c 5f41 5849 535f 4e41  RINCIPAL_AXIS_NA
-00091670: 4d45 533a 0a20 2020 2020 2020 2020 2020  MES:.           
-00091680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091690: 2070 6173 730a 2020 2020 2020 2020 2020   pass.          
-000916a0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-000916b0: 6966 2073 656c 662e 5f5f 7769 7468 5f70  if self.__with_p
-000916c0: 6172 6120 616e 6420 2828 2763 6f6d 705f  ara and (('comp_
-000916d0: 6964 2720 696e 205f 5f66 6163 746f 7220  id' in __factor 
-000916e0: 616e 6420 5f5f 6661 6374 6f72 5b27 6174  and __factor['at
-000916f0: 6f6d 5f69 6427 5d5b 305d 203d 3d20 5f5f  om_id'][0] == __
-00091700: 6661 6374 6f72 5b27 636f 6d70 5f69 6427  factor['comp_id'
-00091710: 5d5b 305d 2061 6e64 205f 5f61 746f 6d49  ][0] and __atomI
-00091720: 6420 696e 2050 4152 414d 4147 4e45 5449  d in PARAMAGNETI
-00091730: 435f 454c 454d 454e 5453 290a 2020 2020  C_ELEMENTS).    
-00091740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091760: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00091770: 7220 5f5f 6174 6f6d 4964 2069 6e20 4645  r __atomId in FE
-00091780: 5252 4f4d 4147 4e45 5449 435f 454c 454d  RROMAGNETIC_ELEM
-00091790: 454e 5453 206f 7220 5f5f 6174 6f6d 4964  ENTS or __atomId
-000917a0: 2069 6e20 4c41 4e54 4841 4e4f 4944 5f45   in LANTHANOID_E
-000917b0: 4c45 4d45 4e54 5329 3a0a 2020 2020 2020  LEMENTS):.      
-000917c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000917d0: 2020 2020 2020 7061 7373 0a20 2020 2020        pass.     
-000917e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000917f0: 2020 2065 6c69 6620 7365 6c66 2e5f 5f63     elif self.__c
-00091800: 7572 5f73 7562 7479 7065 203d 3d20 2770  ur_subtype == 'p
-00091810: 6c61 6e65 273a 0a20 2020 2020 2020 2020  lane':.         
-00091820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091830: 2020 2070 6173 730a 2020 2020 2020 2020     pass.        
-00091840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091850: 656c 6966 2073 656c 662e 5f5f 6375 725f  elif self.__cur_
-00091860: 7375 6274 7970 6520 3d3d 2027 6469 7374  subtype == 'dist
-00091870: 2720 616e 6420 5f5f 6174 6f6d 4964 2069  ' and __atomId i
-00091880: 6e20 5850 4c4f 525f 4e49 5452 4f58 4944  n XPLOR_NITROXID
-00091890: 455f 4e41 4d45 533a 0a20 2020 2020 2020  E_NAMES:.       
-000918a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000918b0: 2020 2020 2070 6173 730a 2020 2020 2020       pass.      
-000918c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000918d0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-000918e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000918f0: 2020 2020 5f66 6163 746f 7220 3d20 636f      _factor = co
-00091900: 7079 2e63 6f70 7928 7365 6c66 2e66 6163  py.copy(self.fac
-00091910: 746f 7229 0a20 2020 2020 2020 2020 2020  tor).           
-00091920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091930: 2069 6620 2761 746f 6d5f 7365 6c65 6374   if 'atom_select
-00091940: 696f 6e27 2069 6e20 5f5f 6661 6374 6f72  ion' in __factor
-00091950: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00091960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091970: 2020 6465 6c20 5f5f 6661 6374 6f72 5b27    del __factor['
-00091980: 6174 6f6d 5f73 656c 6563 7469 6f6e 275d  atom_selection']
-00091990: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000919a0: 2020 2020 2020 2020 2020 2020 2064 656c               del
-000919b0: 205f 6661 6374 6f72 5b27 6174 6f6d 5f73   _factor['atom_s
-000919c0: 656c 6563 7469 6f6e 275d 0a20 2020 2020  election'].     
-000919d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000919e0: 2020 2020 2020 2073 656c 662e 5f5f 662e         self.__f.
-000919f0: 6170 7065 6e64 2866 225b 496e 7375 6666  append(f"[Insuff
-00091a00: 6963 6965 6e74 2061 746f 6d20 7365 6c65  icient atom sele
-00091a10: 6374 696f 6e5d 207b 7365 6c66 2e5f 5f67  ction] {self.__g
-00091a20: 6574 4375 7272 656e 7452 6573 7472 6169  etCurrentRestrai
-00091a30: 6e74 2829 7d22 0a20 2020 2020 2020 2020  nt()}".         
-00091a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091470: 2020 2020 6622 277b 6368 6169 6e49 647d      f"'{chainId}
+00091480: 2720 696e 2074 6865 2063 6f6f 7264 696e  ' in the coordin
+00091490: 6174 6573 2e22 2920 2023 2064 6f20 6e6f  ates.")  # do no
+000914a0: 7420 7573 6520 2763 6861 696e 4964 2172  t use 'chainId!r
+000914b0: 2720 6578 7072 6573 7369 6f6e 2c20 2725  ' expression, '%
+000914c0: 2720 636f 6465 2074 6872 6f77 7320 5661  ' code throws Va
+000914d0: 6c75 6545 7272 6f72 0a20 2020 2020 2020  lueError.       
+000914e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000914f0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00091500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091510: 2020 2069 6620 2773 6567 6d65 6e74 5f69     if 'segment_i
+00091520: 645f 6d69 736d 6174 6368 2720 6e6f 7420  d_mismatch' not 
+00091530: 696e 2073 656c 662e 7265 6173 6f6e 7346  in self.reasonsF
+00091540: 6f72 5265 5061 7273 696e 673a 0a20 2020  orReParsing:.   
+00091550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091560: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00091570: 662e 7265 6173 6f6e 7346 6f72 5265 5061  f.reasonsForRePa
+00091580: 7273 696e 675b 2773 6567 6d65 6e74 5f69  rsing['segment_i
+00091590: 645f 6d69 736d 6174 6368 275d 203d 207b  d_mismatch'] = {
+000915a0: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
+000915b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000915c0: 2020 7365 6c66 2e72 6561 736f 6e73 466f    self.reasonsFo
+000915d0: 7252 6550 6172 7369 6e67 5b27 7365 676d  rReParsing['segm
+000915e0: 656e 745f 6964 5f6d 6174 6368 5f73 7461  ent_id_match_sta
+000915f0: 7473 275d 203d 207b 7d0a 2020 2020 2020  ts'] = {}.      
+00091600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091610: 2020 2020 2020 6966 2063 6861 696e 4964        if chainId
+00091620: 206e 6f74 2069 6e20 7365 6c66 2e72 6561   not in self.rea
+00091630: 736f 6e73 466f 7252 6550 6172 7369 6e67  sonsForReParsing
+00091640: 5b27 7365 676d 656e 745f 6964 5f6d 6973  ['segment_id_mis
+00091650: 6d61 7463 6827 5d3a 0a20 2020 2020 2020  match']:.       
+00091660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091670: 2020 2020 2020 2020 2073 656c 662e 7265           self.re
+00091680: 6173 6f6e 7346 6f72 5265 5061 7273 696e  asonsForReParsin
+00091690: 675b 2773 6567 6d65 6e74 5f69 645f 6d69  g['segment_id_mi
+000916a0: 736d 6174 6368 275d 5b63 6861 696e 4964  smatch'][chainId
+000916b0: 5d20 3d20 4e6f 6e65 0a20 2020 2020 2020  ] = None.       
+000916c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000916d0: 2020 2020 2020 2020 2073 656c 662e 7265           self.re
+000916e0: 6173 6f6e 7346 6f72 5265 5061 7273 696e  asonsForReParsin
+000916f0: 675b 2773 6567 6d65 6e74 5f69 645f 6d61  g['segment_id_ma
+00091700: 7463 685f 7374 6174 7327 5d5b 6368 6169  tch_stats'][chai
+00091710: 6e49 645d 203d 207b 7d0a 2020 2020 2020  nId] = {}.      
+00091720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091730: 2020 2020 2020 7365 6c66 2e66 6163 746f        self.facto
+00091740: 725b 2761 6c74 5f63 6861 696e 5f69 6427  r['alt_chain_id'
+00091750: 5d20 3d20 6368 6169 6e49 640a 0a20 2020  ] = chainId..   
+00091760: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00091770: 6576 616c 5f66 6163 746f 7220 616e 6420  eval_factor and 
+00091780: 2761 746f 6d5f 7365 6c65 6374 696f 6e27  'atom_selection'
+00091790: 2069 6e20 7365 6c66 2e66 6163 746f 723a   in self.factor:
+000917a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000917b0: 2020 2020 2069 6620 6c65 6e28 7365 6c66       if len(self
+000917c0: 2e66 6163 746f 725b 2761 746f 6d5f 7365  .factor['atom_se
+000917d0: 6c65 6374 696f 6e27 5d29 203d 3d20 3020  lection']) == 0 
+000917e0: 616e 6420 2761 746f 6d5f 6964 2720 696e  and 'atom_id' in
+000917f0: 205f 5f66 6163 746f 723a 0a20 2020 2020   __factor:.     
+00091800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091810: 2020 205f 5f61 746f 6d49 6420 3d20 5f5f     __atomId = __
+00091820: 6661 6374 6f72 5b27 6174 6f6d 5f69 6427  factor['atom_id'
+00091830: 5d5b 305d 2e75 7070 6572 2829 2069 6620  ][0].upper() if 
+00091840: 6c65 6e28 5f5f 6661 6374 6f72 5b27 6174  len(__factor['at
+00091850: 6f6d 5f69 6427 5d5b 305d 2920 3c3d 2032  om_id'][0]) <= 2
+00091860: 2065 6c73 6520 5f5f 6661 6374 6f72 5b27   else __factor['
+00091870: 6174 6f6d 5f69 6427 5d5b 305d 5b3a 325d  atom_id'][0][:2]
+00091880: 2e75 7070 6572 2829 0a20 2020 2020 2020  .upper().       
+00091890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000918a0: 2069 6620 7365 6c66 2e5f 5f77 6974 685f   if self.__with_
+000918b0: 6178 6973 2061 6e64 205f 5f61 746f 6d49  axis and __atomI
+000918c0: 6420 696e 2058 504c 4f52 5f52 4443 5f50  d in XPLOR_RDC_P
+000918d0: 5249 4e43 4950 414c 5f41 5849 535f 4e41  RINCIPAL_AXIS_NA
+000918e0: 4d45 533a 0a20 2020 2020 2020 2020 2020  MES:.           
+000918f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091900: 2070 6173 730a 2020 2020 2020 2020 2020   pass.          
+00091910: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00091920: 6966 2073 656c 662e 5f5f 7769 7468 5f70  if self.__with_p
+00091930: 6172 6120 616e 6420 2828 2763 6f6d 705f  ara and (('comp_
+00091940: 6964 2720 696e 205f 5f66 6163 746f 7220  id' in __factor 
+00091950: 616e 6420 5f5f 6661 6374 6f72 5b27 6174  and __factor['at
+00091960: 6f6d 5f69 6427 5d5b 305d 203d 3d20 5f5f  om_id'][0] == __
+00091970: 6661 6374 6f72 5b27 636f 6d70 5f69 6427  factor['comp_id'
+00091980: 5d5b 305d 2061 6e64 205f 5f61 746f 6d49  ][0] and __atomI
+00091990: 6420 696e 2050 4152 414d 4147 4e45 5449  d in PARAMAGNETI
+000919a0: 435f 454c 454d 454e 5453 290a 2020 2020  C_ELEMENTS).    
+000919b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000919c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000919d0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+000919e0: 7220 5f5f 6174 6f6d 4964 2069 6e20 4645  r __atomId in FE
+000919f0: 5252 4f4d 4147 4e45 5449 435f 454c 454d  RROMAGNETIC_ELEM
+00091a00: 454e 5453 206f 7220 5f5f 6174 6f6d 4964  ENTS or __atomId
+00091a10: 2069 6e20 4c41 4e54 4841 4e4f 4944 5f45   in LANTHANOID_E
+00091a20: 4c45 4d45 4e54 5329 3a0a 2020 2020 2020  LEMENTS):.      
+00091a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091a40: 2020 2020 2020 7061 7373 0a20 2020 2020        pass.     
 00091a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091a60: 2020 2066 2254 6865 2027 7365 6769 6465     f"The 'segide
-00091a70: 6e74 6966 6965 7227 2063 6c61 7573 6520  ntifier' clause 
-00091a80: 6861 7320 6e6f 2065 6666 6563 7420 666f  has no effect fo
-00091a90: 7220 6120 636f 6e6a 756e 6374 696f 6e20  r a conjunction 
-00091aa0: 6f66 2066 6163 746f 7220 7b5f 5f66 6163  of factor {__fac
-00091ab0: 746f 727d 2061 6e64 207b 5f66 6163 746f  tor} and {_facto
-00091ac0: 727d 2e22 290a 0a20 2020 2020 2020 2020  r}.")..         
-00091ad0: 2020 2065 6c69 6620 6374 782e 5374 6f72     elif ctx.Stor
-00091ae0: 6531 2829 3a0a 2020 2020 2020 2020 2020  e1():.          
-00091af0: 2020 2020 2020 7365 745f 7374 6f72 6528        set_store(
-00091b00: 3129 0a0a 2020 2020 2020 2020 2020 2020  1)..            
-00091b10: 656c 6966 2063 7478 2e53 746f 7265 3228  elif ctx.Store2(
-00091b20: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00091b30: 2020 2073 6574 5f73 746f 7265 2832 290a     set_store(2).
-00091b40: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-00091b50: 6620 6374 782e 5374 6f72 6533 2829 3a0a  f ctx.Store3():.
-00091b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091b70: 7365 745f 7374 6f72 6528 3329 0a0a 2020  set_store(3)..  
-00091b80: 2020 2020 2020 2020 2020 656c 6966 2063            elif c
-00091b90: 7478 2e53 746f 7265 3428 293a 0a20 2020  tx.Store4():.   
-00091ba0: 2020 2020 2020 2020 2020 2020 2073 6574               set
-00091bb0: 5f73 746f 7265 2834 290a 0a20 2020 2020  _store(4)..     
-00091bc0: 2020 2020 2020 2065 6c69 6620 6374 782e         elif ctx.
-00091bd0: 5374 6f72 6535 2829 3a0a 2020 2020 2020  Store5():.      
-00091be0: 2020 2020 2020 2020 2020 7365 745f 7374            set_st
-00091bf0: 6f72 6528 3529 0a0a 2020 2020 2020 2020  ore(5)..        
-00091c00: 2020 2020 656c 6966 2063 7478 2e53 746f      elif ctx.Sto
-00091c10: 7265 3628 293a 0a20 2020 2020 2020 2020  re6():.         
-00091c20: 2020 2020 2020 2073 6574 5f73 746f 7265         set_store
-00091c30: 2836 290a 0a20 2020 2020 2020 2020 2020  (6)..           
-00091c40: 2065 6c69 6620 6374 782e 5374 6f72 6537   elif ctx.Store7
-00091c50: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-00091c60: 2020 2020 7365 745f 7374 6f72 6528 3729      set_store(7)
-00091c70: 0a0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-00091c80: 6966 2063 7478 2e53 746f 7265 3828 293a  if ctx.Store8():
-00091c90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00091ca0: 2073 6574 5f73 746f 7265 2838 290a 0a20   set_store(8).. 
-00091cb0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00091cc0: 6374 782e 5374 6f72 6539 2829 3a0a 2020  ctx.Store9():.  
-00091cd0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00091ce0: 745f 7374 6f72 6528 3929 0a0a 2020 2020  t_store(9)..    
-00091cf0: 2020 2020 2020 2020 656c 6966 2063 7478          elif ctx
-00091d00: 2e54 6167 2829 3a0a 2020 2020 2020 2020  .Tag():.        
-00091d10: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00091d20: 5f5f 7365 6c5f 6578 7072 5f64 6562 7567  __sel_expr_debug
-00091d30: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00091d40: 2020 2020 2020 7072 696e 7428 2220 2022        print("  "
-00091d50: 202a 2073 656c 662e 6465 7074 6820 2b20   * self.depth + 
-00091d60: 222d 2d3e 2074 6167 2229 0a20 2020 2020  "--> tag").     
-00091d70: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
-00091d80: 7420 7365 6c66 2e5f 5f68 6173 436f 6f72  t self.__hasCoor
-00091d90: 643a 0a20 2020 2020 2020 2020 2020 2020  d:.             
-00091da0: 2020 2020 2020 2072 6574 7572 6e0a 2020         return.  
-00091db0: 2020 2020 2020 2020 2020 2020 2020 6174                at
-00091dc0: 6f6d 5365 6c65 6374 696f 6e20 3d20 5b5d  omSelection = []
-00091dd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00091de0: 205f 7365 7175 656e 6365 5365 6c65 6374   _sequenceSelect
-00091df0: 203d 205b 5d0a 0a20 2020 2020 2020 2020   = []..         
-00091e00: 2020 2020 2020 2074 7279 3a0a 0a20 2020         try:..   
-00091e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091e20: 205f 6174 6f6d 5365 6c65 6374 696f 6e20   _atomSelection 
-00091e30: 3d5c 0a20 2020 2020 2020 2020 2020 2020  =\.             
-00091e40: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00091e50: 5f5f 6352 2e67 6574 4469 6374 4c69 7374  __cR.getDictList
-00091e60: 5769 7468 4669 6c74 6572 2827 6174 6f6d  WithFilter('atom
-00091e70: 5f73 6974 6527 2c0a 2020 2020 2020 2020  _site',.        
-00091e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091eb0: 4155 5448 5f41 544f 4d5f 4441 5441 5f49  AUTH_ATOM_DATA_I
-00091ec0: 5445 4d53 2c0a 2020 2020 2020 2020 2020  TEMS,.          
-00091ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091ef0: 2020 2020 2020 2020 2020 2020 2020 5b7b                [{
-00091f00: 276e 616d 6527 3a20 7365 6c66 2e5f 5f6d  'name': self.__m
-00091f10: 6f64 656c 4e75 6d4e 616d 652c 2027 7479  odelNumName, 'ty
-00091f20: 7065 273a 2027 696e 7427 2c0a 2020 2020  pe': 'int',.    
-00091f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091f60: 2020 2020 2020 2776 616c 7565 273a 2073        'value': s
-00091f70: 656c 662e 5f5f 7265 7072 6573 656e 7461  elf.__representa
-00091f80: 7469 7665 4d6f 6465 6c49 647d 2c0a 2020  tiveModelId},.  
-00091f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00091fc0: 2020 2020 2020 207b 276e 616d 6527 3a20         {'name': 
-00091fd0: 276c 6162 656c 5f61 6c74 5f69 6427 2c20  'label_alt_id', 
-00091fe0: 2774 7970 6527 3a20 2765 6e75 6d27 2c0a  'type': 'enum',.
-00091ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00092000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00092010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00092020: 2020 2020 2020 2020 2020 2765 6e75 6d27            'enum'
-00092030: 3a20 2827 4127 297d 0a20 2020 2020 2020  : ('A')}.       
-00092040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00092050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00092060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00092070: 2020 5d29 0a0a 2020 2020 2020 2020 2020    ])..          
-00092080: 2020 2020 2020 2020 2020 666f 7220 5f61            for _a
-00092090: 746f 6d20 696e 205f 6174 6f6d 5365 6c65  tom in _atomSele
-000920a0: 6374 696f 6e3a 0a20 2020 2020 2020 2020  ction:.         
-000920b0: 2020 2020 2020 2020 2020 2020 2020 205f                 _
-000920c0: 7365 7175 656e 6365 203d 2028 5f61 746f  sequence = (_ato
-000920d0: 6d5b 2763 6861 696e 5f69 6427 5d2c 205f  m['chain_id'], _
-000920e0: 6174 6f6d 5b27 7365 715f 6964 275d 290a  atom['seq_id']).
-000920f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00092100: 2020 2020 2020 2020 2069 6620 5f73 6571           if _seq
-00092110: 7565 6e63 6520 696e 205f 7365 7175 656e  uence in _sequen
-00092120: 6365 5365 6c65 6374 3a0a 2020 2020 2020  ceSelect:.      
-00092130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00092140: 2020 2020 2020 636f 6e74 696e 7565 0a0a        continue..
+00091a60: 2020 2065 6c69 6620 7365 6c66 2e5f 5f63     elif self.__c
+00091a70: 7572 5f73 7562 7479 7065 203d 3d20 2770  ur_subtype == 'p
+00091a80: 6c61 6e65 273a 0a20 2020 2020 2020 2020  lane':.         
+00091a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091aa0: 2020 2070 6173 730a 2020 2020 2020 2020     pass.        
+00091ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091ac0: 656c 6966 2073 656c 662e 5f5f 6375 725f  elif self.__cur_
+00091ad0: 7375 6274 7970 6520 3d3d 2027 6469 7374  subtype == 'dist
+00091ae0: 2720 616e 6420 5f5f 6174 6f6d 4964 2069  ' and __atomId i
+00091af0: 6e20 5850 4c4f 525f 4e49 5452 4f58 4944  n XPLOR_NITROXID
+00091b00: 455f 4e41 4d45 533a 0a20 2020 2020 2020  E_NAMES:.       
+00091b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091b20: 2020 2020 2070 6173 730a 2020 2020 2020       pass.      
+00091b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091b40: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00091b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091b60: 2020 2020 5f66 6163 746f 7220 3d20 636f      _factor = co
+00091b70: 7079 2e63 6f70 7928 7365 6c66 2e66 6163  py.copy(self.fac
+00091b80: 746f 7229 0a20 2020 2020 2020 2020 2020  tor).           
+00091b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091ba0: 2069 6620 2761 746f 6d5f 7365 6c65 6374   if 'atom_select
+00091bb0: 696f 6e27 2069 6e20 5f5f 6661 6374 6f72  ion' in __factor
+00091bc0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00091bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091be0: 2020 6465 6c20 5f5f 6661 6374 6f72 5b27    del __factor['
+00091bf0: 6174 6f6d 5f73 656c 6563 7469 6f6e 275d  atom_selection']
+00091c00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00091c10: 2020 2020 2020 2020 2020 2020 2064 656c               del
+00091c20: 205f 6661 6374 6f72 5b27 6174 6f6d 5f73   _factor['atom_s
+00091c30: 656c 6563 7469 6f6e 275d 0a20 2020 2020  election'].     
+00091c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091c50: 2020 2020 2020 2073 656c 662e 5f5f 662e         self.__f.
+00091c60: 6170 7065 6e64 2866 225b 496e 7375 6666  append(f"[Insuff
+00091c70: 6963 6965 6e74 2061 746f 6d20 7365 6c65  icient atom sele
+00091c80: 6374 696f 6e5d 207b 7365 6c66 2e5f 5f67  ction] {self.__g
+00091c90: 6574 4375 7272 656e 7452 6573 7472 6169  etCurrentRestrai
+00091ca0: 6e74 2829 7d22 0a20 2020 2020 2020 2020  nt()}".         
+00091cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091cd0: 2020 2066 2254 6865 2027 7365 6769 6465     f"The 'segide
+00091ce0: 6e74 6966 6965 7227 2063 6c61 7573 6520  ntifier' clause 
+00091cf0: 6861 7320 6e6f 2065 6666 6563 7420 666f  has no effect fo
+00091d00: 7220 6120 636f 6e6a 756e 6374 696f 6e20  r a conjunction 
+00091d10: 6f66 2066 6163 746f 7220 7b5f 5f66 6163  of factor {__fac
+00091d20: 746f 727d 2061 6e64 207b 5f66 6163 746f  tor} and {_facto
+00091d30: 727d 2e22 290a 0a20 2020 2020 2020 2020  r}.")..         
+00091d40: 2020 2065 6c69 6620 6374 782e 5374 6f72     elif ctx.Stor
+00091d50: 6531 2829 3a0a 2020 2020 2020 2020 2020  e1():.          
+00091d60: 2020 2020 2020 7365 745f 7374 6f72 6528        set_store(
+00091d70: 3129 0a0a 2020 2020 2020 2020 2020 2020  1)..            
+00091d80: 656c 6966 2063 7478 2e53 746f 7265 3228  elif ctx.Store2(
+00091d90: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00091da0: 2020 2073 6574 5f73 746f 7265 2832 290a     set_store(2).
+00091db0: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+00091dc0: 6620 6374 782e 5374 6f72 6533 2829 3a0a  f ctx.Store3():.
+00091dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00091de0: 7365 745f 7374 6f72 6528 3329 0a0a 2020  set_store(3)..  
+00091df0: 2020 2020 2020 2020 2020 656c 6966 2063            elif c
+00091e00: 7478 2e53 746f 7265 3428 293a 0a20 2020  tx.Store4():.   
+00091e10: 2020 2020 2020 2020 2020 2020 2073 6574               set
+00091e20: 5f73 746f 7265 2834 290a 0a20 2020 2020  _store(4)..     
+00091e30: 2020 2020 2020 2065 6c69 6620 6374 782e         elif ctx.
+00091e40: 5374 6f72 6535 2829 3a0a 2020 2020 2020  Store5():.      
+00091e50: 2020 2020 2020 2020 2020 7365 745f 7374            set_st
+00091e60: 6f72 6528 3529 0a0a 2020 2020 2020 2020  ore(5)..        
+00091e70: 2020 2020 656c 6966 2063 7478 2e53 746f      elif ctx.Sto
+00091e80: 7265 3628 293a 0a20 2020 2020 2020 2020  re6():.         
+00091e90: 2020 2020 2020 2073 6574 5f73 746f 7265         set_store
+00091ea0: 2836 290a 0a20 2020 2020 2020 2020 2020  (6)..           
+00091eb0: 2065 6c69 6620 6374 782e 5374 6f72 6537   elif ctx.Store7
+00091ec0: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+00091ed0: 2020 2020 7365 745f 7374 6f72 6528 3729      set_store(7)
+00091ee0: 0a0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+00091ef0: 6966 2063 7478 2e53 746f 7265 3828 293a  if ctx.Store8():
+00091f00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00091f10: 2073 6574 5f73 746f 7265 2838 290a 0a20   set_store(8).. 
+00091f20: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00091f30: 6374 782e 5374 6f72 6539 2829 3a0a 2020  ctx.Store9():.  
+00091f40: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00091f50: 745f 7374 6f72 6528 3929 0a0a 2020 2020  t_store(9)..    
+00091f60: 2020 2020 2020 2020 656c 6966 2063 7478          elif ctx
+00091f70: 2e54 6167 2829 3a0a 2020 2020 2020 2020  .Tag():.        
+00091f80: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00091f90: 5f5f 7365 6c5f 6578 7072 5f64 6562 7567  __sel_expr_debug
+00091fa0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00091fb0: 2020 2020 2020 7072 696e 7428 2220 2022        print("  "
+00091fc0: 202a 2073 656c 662e 6465 7074 6820 2b20   * self.depth + 
+00091fd0: 222d 2d3e 2074 6167 2229 0a20 2020 2020  "--> tag").     
+00091fe0: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+00091ff0: 7420 7365 6c66 2e5f 5f68 6173 436f 6f72  t self.__hasCoor
+00092000: 643a 0a20 2020 2020 2020 2020 2020 2020  d:.             
+00092010: 2020 2020 2020 2072 6574 7572 6e0a 2020         return.  
+00092020: 2020 2020 2020 2020 2020 2020 2020 6174                at
+00092030: 6f6d 5365 6c65 6374 696f 6e20 3d20 5b5d  omSelection = []
+00092040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00092050: 205f 7365 7175 656e 6365 5365 6c65 6374   _sequenceSelect
+00092060: 203d 205b 5d0a 0a20 2020 2020 2020 2020   = []..         
+00092070: 2020 2020 2020 2074 7279 3a0a 0a20 2020         try:..   
+00092080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00092090: 205f 6174 6f6d 5365 6c65 6374 696f 6e20   _atomSelection 
+000920a0: 3d5c 0a20 2020 2020 2020 2020 2020 2020  =\.             
+000920b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000920c0: 5f5f 6352 2e67 6574 4469 6374 4c69 7374  __cR.getDictList
+000920d0: 5769 7468 4669 6c74 6572 2827 6174 6f6d  WithFilter('atom
+000920e0: 5f73 6974 6527 2c0a 2020 2020 2020 2020  _site',.        
+000920f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00092100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00092110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00092120: 4155 5448 5f41 544f 4d5f 4441 5441 5f49  AUTH_ATOM_DATA_I
+00092130: 5445 4d53 2c0a 2020 2020 2020 2020 2020  TEMS,.          
+00092140: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00092150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00092160: 2020 2020 2020 2020 6174 6f6d 5365 6c65          atomSele
-00092170: 6374 696f 6e2e 6170 7065 6e64 285f 6174  ction.append(_at
-00092180: 6f6d 290a 2020 2020 2020 2020 2020 2020  om).            
-00092190: 2020 2020 2020 2020 2020 2020 5f73 6571              _seq
-000921a0: 7565 6e63 6553 656c 6563 742e 6170 7065  uenceSelect.appe
-000921b0: 6e64 285f 7365 7175 656e 6365 290a 0a20  nd(_sequence).. 
-000921c0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000921d0: 7863 6570 7420 4578 6365 7074 696f 6e20  xcept Exception 
-000921e0: 6173 2065 3a0a 2020 2020 2020 2020 2020  as e:.          
-000921f0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00092200: 662e 5f5f 7665 7262 6f73 653a 0a20 2020  f.__verbose:.   
+00092160: 2020 2020 2020 2020 2020 2020 2020 5b7b                [{
+00092170: 276e 616d 6527 3a20 7365 6c66 2e5f 5f6d  'name': self.__m
+00092180: 6f64 656c 4e75 6d4e 616d 652c 2027 7479  odelNumName, 'ty
+00092190: 7065 273a 2027 696e 7427 2c0a 2020 2020  pe': 'int',.    
+000921a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000921b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000921c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000921d0: 2020 2020 2020 2776 616c 7565 273a 2073        'value': s
+000921e0: 656c 662e 5f5f 7265 7072 6573 656e 7461  elf.__representa
+000921f0: 7469 7665 4d6f 6465 6c49 647d 2c0a 2020  tiveModelId},.  
+00092200: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00092210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00092220: 2020 2020 2073 656c 662e 5f5f 6c66 682e       self.__lfh.
-00092230: 7772 6974 6528 6622 2b58 706c 6f72 4d52  write(f"+XplorMR
-00092240: 5061 7273 6572 4c69 7374 656e 6572 2e65  ParserListener.e
-00092250: 7869 7446 6163 746f 7228 2920 2b2b 2045  xitFactor() ++ E
-00092260: 7272 6f72 2020 2d20 7b73 7472 2865 297d  rror  - {str(e)}
-00092270: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
-00092280: 2020 2020 7365 6c66 2e69 6e74 6572 7365      self.interse
-00092290: 6374 696f 6e46 6163 746f 725f 6578 7072  ctionFactor_expr
-000922a0: 6573 7369 6f6e 7328 6174 6f6d 5365 6c65  essions(atomSele
-000922b0: 6374 696f 6e29 0a0a 2020 2020 2020 2020  ction)..        
-000922c0: 2020 2020 2020 2020 6966 206c 656e 2873          if len(s
-000922d0: 656c 662e 6661 6374 6f72 5b27 6174 6f6d  elf.factor['atom
-000922e0: 5f73 656c 6563 7469 6f6e 275d 2920 3d3d  _selection']) ==
-000922f0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-00092300: 2020 2020 2020 2020 7365 6c66 2e66 6163          self.fac
-00092310: 746f 725b 2761 746f 6d5f 6964 275d 203d  tor['atom_id'] =
-00092320: 205b 4e6f 6e65 5d0a 2020 2020 2020 2020   [None].        
-00092330: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00092340: 2e5f 5f66 2e61 7070 656e 6428 6622 5b49  .__f.append(f"[I
-00092350: 6e73 7566 6669 6369 656e 7420 6174 6f6d  nsufficient atom
-00092360: 2073 656c 6563 7469 6f6e 5d20 7b73 656c   selection] {sel
-00092370: 662e 5f5f 6765 7443 7572 7265 6e74 5265  f.__getCurrentRe
-00092380: 7374 7261 696e 7428 297d 220a 2020 2020  straint()}".    
-00092390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00092220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00092230: 2020 2020 2020 207b 276e 616d 6527 3a20         {'name': 
+00092240: 276c 6162 656c 5f61 6c74 5f69 6427 2c20  'label_alt_id', 
+00092250: 2774 7970 6527 3a20 2765 6e75 6d27 2c0a  'type': 'enum',.
+00092260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00092270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00092280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00092290: 2020 2020 2020 2020 2020 2765 6e75 6d27            'enum'
+000922a0: 3a20 2827 4127 297d 0a20 2020 2020 2020  : ('A')}.       
+000922b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000922c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000922d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000922e0: 2020 5d29 0a0a 2020 2020 2020 2020 2020    ])..          
+000922f0: 2020 2020 2020 2020 2020 666f 7220 5f61            for _a
+00092300: 746f 6d20 696e 205f 6174 6f6d 5365 6c65  tom in _atomSele
+00092310: 6374 696f 6e3a 0a20 2020 2020 2020 2020  ction:.         
+00092320: 2020 2020 2020 2020 2020 2020 2020 205f                 _
+00092330: 7365 7175 656e 6365 203d 2028 5f61 746f  sequence = (_ato
+00092340: 6d5b 2763 6861 696e 5f69 6427 5d2c 205f  m['chain_id'], _
+00092350: 6174 6f6d 5b27 7365 715f 6964 275d 290a  atom['seq_id']).
+00092360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00092370: 2020 2020 2020 2020 2069 6620 5f73 6571           if _seq
+00092380: 7565 6e63 6520 696e 205f 7365 7175 656e  uence in _sequen
+00092390: 6365 5365 6c65 6374 3a0a 2020 2020 2020  ceSelect:.      
 000923a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000923b0: 2254 6865 2027 7461 6727 2063 6c61 7573  "The 'tag' claus
-000923c0: 6520 6861 7320 6e6f 2065 6666 6563 742e  e has no effect.
-000923d0: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
-000923e0: 656c 6966 2063 7478 2e44 6f6e 6f72 2829  elif ctx.Donor()
-000923f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00092400: 2020 7365 6c66 2e64 6f6e 6f72 5f63 6f6c    self.donor_col
-00092410: 756d 6e53 656c 203d 206c 656e 2873 656c  umnSel = len(sel
-00092420: 662e 6174 6f6d 5365 6c65 6374 696f 6e53  f.atomSelectionS
-00092430: 6574 290a 0a20 2020 2020 2020 2020 2020  et)..           
-00092440: 2065 6c69 6620 6374 782e 4163 6365 7074   elif ctx.Accept
-00092450: 6f72 2829 3a0a 2020 2020 2020 2020 2020  or():.          
-00092460: 2020 2020 2020 7365 6c66 2e61 6363 6570        self.accep
-00092470: 746f 725f 636f 6c75 6d6e 5365 6c20 3d20  tor_columnSel = 
-00092480: 6c65 6e28 7365 6c66 2e61 746f 6d53 656c  len(self.atomSel
-00092490: 6563 7469 6f6e 5365 7429 0a0a 2020 2020  ectionSet)..    
-000924a0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-000924b0: 6465 7074 6820 3e20 3020 616e 6420 7365  depth > 0 and se
-000924c0: 6c66 2e5f 5f63 7572 5f75 6e69 6f6e 5f65  lf.__cur_union_e
-000924d0: 7870 723a 0a20 2020 2020 2020 2020 2020  xpr:.           
-000924e0: 2020 2020 2073 656c 662e 756e 696f 6e46       self.unionF
-000924f0: 6163 746f 7220 3d20 7365 6c66 2e66 6163  actor = self.fac
-00092500: 746f 720a 2020 2020 2020 2020 2020 2020  tor.            
-00092510: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00092520: 2020 2020 2020 7365 6c66 2e73 7461 636b        self.stack
-00092530: 4661 6374 6f72 732e 6170 7065 6e64 2873  Factors.append(s
-00092540: 656c 662e 6661 6374 6f72 290a 0a20 2020  elf.factor)..   
-00092550: 2020 2020 2066 696e 616c 6c79 3a0a 2020       finally:.  
-00092560: 2020 2020 2020 2020 2020 7365 6c66 2e6e            self.n
-00092570: 756d 6265 7246 5365 6c65 6374 696f 6e2e  umberFSelection.
-00092580: 636c 6561 7228 290a 0a20 2020 2023 2045  clear()..    # E
-00092590: 6e74 6572 2061 2070 6172 7365 2074 7265  nter a parse tre
-000925a0: 6520 7072 6f64 7563 6564 2062 7920 5870  e produced by Xp
-000925b0: 6c6f 724d 5250 6172 7365 7223 6e75 6d62  lorMRParser#numb
-000925c0: 6572 2e0a 2020 2020 6465 6620 656e 7465  er..    def ente
-000925d0: 724e 756d 6265 7228 7365 6c66 2c20 6374  rNumber(self, ct
-000925e0: 783a 2058 706c 6f72 4d52 5061 7273 6572  x: XplorMRParser
-000925f0: 2e4e 756d 6265 7243 6f6e 7465 7874 293a  .NumberContext):
-00092600: 2020 2320 7079 6c69 6e74 3a20 6469 7361    # pylint: disa
-00092610: 626c 653d 756e 7573 6564 2d61 7267 756d  ble=unused-argum
-00092620: 656e 740a 2020 2020 2020 2020 7061 7373  ent.        pass
-00092630: 0a0a 2020 2020 2320 4578 6974 2061 2070  ..    # Exit a p
-00092640: 6172 7365 2074 7265 6520 7072 6f64 7563  arse tree produc
-00092650: 6564 2062 7920 5870 6c6f 724d 5250 6172  ed by XplorMRPar
-00092660: 7365 7223 6e75 6d62 6572 2e0a 2020 2020  ser#number..    
-00092670: 6465 6620 6578 6974 4e75 6d62 6572 2873  def exitNumber(s
-00092680: 656c 662c 2063 7478 3a20 5870 6c6f 724d  elf, ctx: XplorM
-00092690: 5250 6172 7365 722e 4e75 6d62 6572 436f  RParser.NumberCo
-000926a0: 6e74 6578 7429 3a0a 2020 2020 2020 2020  ntext):.        
-000926b0: 6966 2063 7478 2e52 6561 6c28 293a 0a20  if ctx.Real():. 
-000926c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000926d0: 6e75 6d62 6572 5365 6c65 6374 696f 6e2e  numberSelection.
-000926e0: 6170 7065 6e64 2866 6c6f 6174 2873 7472  append(float(str
-000926f0: 2863 7478 2e52 6561 6c28 2929 2929 0a0a  (ctx.Real())))..
-00092700: 2020 2020 2020 2020 656c 6966 2063 7478          elif ctx
-00092710: 2e49 6e74 6567 6572 2829 3a0a 2020 2020  .Integer():.    
-00092720: 2020 2020 2020 2020 7365 6c66 2e6e 756d          self.num
-00092730: 6265 7253 656c 6563 7469 6f6e 2e61 7070  berSelection.app
-00092740: 656e 6428 666c 6f61 7428 7374 7228 6374  end(float(str(ct
-00092750: 782e 496e 7465 6765 7228 2929 2929 0a0a  x.Integer())))..
-00092760: 2020 2020 2020 2020 656c 6966 2063 7478          elif ctx
-00092770: 2e53 796d 626f 6c5f 6e61 6d65 2829 3a0a  .Symbol_name():.
-00092780: 2020 2020 2020 2020 2020 2020 7379 6d62              symb
-00092790: 6f6c 5f6e 616d 6520 3d20 7374 7228 6374  ol_name = str(ct
-000927a0: 782e 5379 6d62 6f6c 5f6e 616d 6528 2929  x.Symbol_name())
-000927b0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000927c0: 7379 6d62 6f6c 5f6e 616d 6520 696e 2073  symbol_name in s
-000927d0: 656c 662e 6576 616c 7561 7465 3a0a 2020  elf.evaluate:.  
-000927e0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000927f0: 6c66 2e6e 756d 6265 7253 656c 6563 7469  lf.numberSelecti
-00092800: 6f6e 2e61 7070 656e 6428 666c 6f61 7428  on.append(float(
-00092810: 7365 6c66 2e65 7661 6c75 6174 655b 7379  self.evaluate[sy
-00092820: 6d62 6f6c 5f6e 616d 655d 2929 0a20 2020  mbol_name])).   
-00092830: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00092840: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00092850: 656c 662e 5f5f 662e 6170 7065 6e64 2866  elf.__f.append(f
-00092860: 225b 556e 7375 7070 6f72 7465 6420 6461  "[Unsupported da
-00092870: 7461 5d20 7b73 656c 662e 5f5f 6765 7443  ta] {self.__getC
-00092880: 7572 7265 6e74 5265 7374 7261 696e 7428  urrentRestraint(
-00092890: 297d 220a 2020 2020 2020 2020 2020 2020  )}".            
-000928a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000928b0: 2020 2020 6622 5468 6520 7379 6d62 6f6c      f"The symbol
-000928c0: 207b 7379 6d62 6f6c 5f6e 616d 6521 727d   {symbol_name!r}
-000928d0: 2069 7320 6e6f 7420 6465 6669 6e65 642e   is not defined.
-000928e0: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
-000928f0: 2020 2073 656c 662e 6e75 6d62 6572 5365     self.numberSe
-00092900: 6c65 6374 696f 6e2e 6170 7065 6e64 284e  lection.append(N
-00092910: 6f6e 6529 0a0a 2020 2020 2020 2020 656c  one)..        el
-00092920: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00092930: 7365 6c66 2e6e 756d 6265 7253 656c 6563  self.numberSelec
-00092940: 7469 6f6e 2e61 7070 656e 6428 4e6f 6e65  tion.append(None
-00092950: 290a 0a20 2020 2023 2045 6e74 6572 2061  )..    # Enter a
-00092960: 2070 6172 7365 2074 7265 6520 7072 6f64   parse tree prod
-00092970: 7563 6564 2062 7920 5870 6c6f 724d 5250  uced by XplorMRP
-00092980: 6172 7365 7223 6e75 6d62 6572 5f66 2e0a  arser#number_f..
-00092990: 2020 2020 6465 6620 656e 7465 724e 756d      def enterNum
-000929a0: 6265 725f 6628 7365 6c66 2c20 6374 783a  ber_f(self, ctx:
-000929b0: 2058 706c 6f72 4d52 5061 7273 6572 2e4e   XplorMRParser.N
-000929c0: 756d 6265 725f 6643 6f6e 7465 7874 293a  umber_fContext):
-000929d0: 2020 2320 7079 6c69 6e74 3a20 6469 7361    # pylint: disa
-000929e0: 626c 653d 756e 7573 6564 2d61 7267 756d  ble=unused-argum
-000929f0: 656e 740a 2020 2020 2020 2020 7061 7373  ent.        pass
-00092a00: 0a0a 2020 2020 2320 4578 6974 2061 2070  ..    # Exit a p
-00092a10: 6172 7365 2074 7265 6520 7072 6f64 7563  arse tree produc
-00092a20: 6564 2062 7920 5870 6c6f 724d 5250 6172  ed by XplorMRPar
-00092a30: 7365 7223 6e75 6d62 6572 5f66 2e0a 2020  ser#number_f..  
-00092a40: 2020 6465 6620 6578 6974 4e75 6d62 6572    def exitNumber
-00092a50: 5f66 2873 656c 662c 2063 7478 3a20 5870  _f(self, ctx: Xp
-00092a60: 6c6f 724d 5250 6172 7365 722e 4e75 6d62  lorMRParser.Numb
-00092a70: 6572 5f66 436f 6e74 6578 7429 3a0a 2020  er_fContext):.  
-00092a80: 2020 2020 2020 6966 2063 7478 2e52 6561        if ctx.Rea
-00092a90: 6c28 293a 0a20 2020 2020 2020 2020 2020  l():.           
-00092aa0: 2073 656c 662e 6e75 6d62 6572 4653 656c   self.numberFSel
-00092ab0: 6563 7469 6f6e 2e61 7070 656e 6428 666c  ection.append(fl
-00092ac0: 6f61 7428 7374 7228 6374 782e 5265 616c  oat(str(ctx.Real
-00092ad0: 2829 2929 290a 0a20 2020 2020 2020 2065  ())))..        e
-00092ae0: 6c69 6620 6374 782e 496e 7465 6765 7228  lif ctx.Integer(
-00092af0: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
-00092b00: 656c 662e 6e75 6d62 6572 4653 656c 6563  elf.numberFSelec
-00092b10: 7469 6f6e 2e61 7070 656e 6428 666c 6f61  tion.append(floa
-00092b20: 7428 7374 7228 6374 782e 496e 7465 6765  t(str(ctx.Intege
-00092b30: 7228 2929 2929 0a0a 2020 2020 2020 2020  r())))..        
-00092b40: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00092b50: 2020 7365 6c66 2e6e 756d 6265 7246 5365    self.numberFSe
-00092b60: 6c65 6374 696f 6e2e 6170 7065 6e64 284e  lection.append(N
-00092b70: 6f6e 6529 0a0a 2020 2020 2320 456e 7465  one)..    # Ente
-00092b80: 7220 6120 7061 7273 6520 7472 6565 2070  r a parse tree p
-00092b90: 726f 6475 6365 6420 6279 2058 706c 6f72  roduced by Xplor
-00092ba0: 4d52 5061 7273 6572 236e 756d 6265 725f  MRParser#number_
-00092bb0: 732e 0a20 2020 2064 6566 2065 6e74 6572  s..    def enter
-00092bc0: 4e75 6d62 6572 5f73 2873 656c 662c 2063  Number_s(self, c
-00092bd0: 7478 3a20 5870 6c6f 724d 5250 6172 7365  tx: XplorMRParse
-00092be0: 722e 4e75 6d62 6572 5f73 436f 6e74 6578  r.Number_sContex
-00092bf0: 7429 3a20 2023 2070 796c 696e 743a 2064  t):  # pylint: d
-00092c00: 6973 6162 6c65 3d75 6e75 7365 642d 6172  isable=unused-ar
-00092c10: 6775 6d65 6e74 0a20 2020 2020 2020 2070  gument.        p
-00092c20: 6173 730a 0a20 2020 2023 2045 7869 7420  ass..    # Exit 
-00092c30: 6120 7061 7273 6520 7472 6565 2070 726f  a parse tree pro
-00092c40: 6475 6365 6420 6279 2058 706c 6f72 4d52  duced by XplorMR
-00092c50: 5061 7273 6572 236e 756d 6265 725f 732e  Parser#number_s.
-00092c60: 0a20 2020 2064 6566 2065 7869 744e 756d  .    def exitNum
-00092c70: 6265 725f 7328 7365 6c66 2c20 6374 783a  ber_s(self, ctx:
-00092c80: 2058 706c 6f72 4d52 5061 7273 6572 2e4e   XplorMRParser.N
-00092c90: 756d 6265 725f 7343 6f6e 7465 7874 293a  umber_sContext):
-00092ca0: 2020 2320 7079 6c69 6e74 3a20 6469 7361    # pylint: disa
-00092cb0: 626c 653d 756e 7573 6564 2d61 7267 756d  ble=unused-argum
-00092cc0: 656e 740a 2020 2020 2020 2020 7061 7373  ent.        pass
-00092cd0: 0a0a 2020 2020 6465 6620 6765 744e 756d  ..    def getNum
-00092ce0: 6265 725f 7328 7365 6c66 2c20 6374 783a  ber_s(self, ctx:
-00092cf0: 2058 706c 6f72 4d52 5061 7273 6572 2e4e   XplorMRParser.N
-00092d00: 756d 6265 725f 7343 6f6e 7465 7874 293a  umber_sContext):
-00092d10: 2020 2320 7079 6c69 6e74 3a20 6469 7361    # pylint: disa
-00092d20: 626c 653d 6e6f 2d73 656c 662d 7573 650a  ble=no-self-use.
-00092d30: 2020 2020 2020 2020 6966 2063 7478 2069          if ctx i
-00092d40: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00092d50: 2020 2020 7265 7475 726e 204e 6f6e 650a      return None.
-00092d60: 0a20 2020 2020 2020 2069 6620 6374 782e  .        if ctx.
-00092d70: 5265 616c 2829 3a0a 2020 2020 2020 2020  Real():.        
-00092d80: 2020 2020 7265 7475 726e 2066 6c6f 6174      return float
-00092d90: 2873 7472 2863 7478 2e52 6561 6c28 2929  (str(ctx.Real())
-00092da0: 290a 0a20 2020 2020 2020 2069 6620 6374  )..        if ct
-00092db0: 782e 496e 7465 6765 7228 293a 0a20 2020  x.Integer():.   
-00092dc0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00092dd0: 666c 6f61 7428 7374 7228 6374 782e 496e  float(str(ctx.In
-00092de0: 7465 6765 7228 2929 290a 0a20 2020 2020  teger()))..     
-00092df0: 2020 2069 6620 6374 782e 5379 6d62 6f6c     if ctx.Symbol
-00092e00: 5f6e 616d 6528 293a 0a20 2020 2020 2020  _name():.       
-00092e10: 2020 2020 2072 6574 7572 6e20 7374 7228       return str(
-00092e20: 6374 782e 5379 6d62 6f6c 5f6e 616d 6528  ctx.Symbol_name(
-00092e30: 2929 0a0a 2020 2020 2020 2020 7265 7475  ))..        retu
-00092e40: 726e 204e 6f6e 650a 0a20 2020 2023 2045  rn None..    # E
-00092e50: 6e74 6572 2061 2070 6172 7365 2074 7265  nter a parse tre
-00092e60: 6520 7072 6f64 7563 6564 2062 7920 5870  e produced by Xp
-00092e70: 6c6f 724d 5250 6172 7365 7223 6e75 6d62  lorMRParser#numb
-00092e80: 6572 5f61 2e0a 2020 2020 6465 6620 656e  er_a..    def en
-00092e90: 7465 724e 756d 6265 725f 6128 7365 6c66  terNumber_a(self
-00092ea0: 2c20 6374 783a 2058 706c 6f72 4d52 5061  , ctx: XplorMRPa
-00092eb0: 7273 6572 2e4e 756d 6265 725f 6143 6f6e  rser.Number_aCon
-00092ec0: 7465 7874 293a 2020 2320 7079 6c69 6e74  text):  # pylint
-00092ed0: 3a20 6469 7361 626c 653d 756e 7573 6564  : disable=unused
-00092ee0: 2d61 7267 756d 656e 740a 2020 2020 2020  -argument.      
-00092ef0: 2020 7061 7373 0a0a 2020 2020 2320 4578    pass..    # Ex
-00092f00: 6974 2061 2070 6172 7365 2074 7265 6520  it a parse tree 
-00092f10: 7072 6f64 7563 6564 2062 7920 5870 6c6f  produced by Xplo
-00092f20: 724d 5250 6172 7365 7223 6e75 6d62 6572  rMRParser#number
-00092f30: 5f61 2e0a 2020 2020 6465 6620 6578 6974  _a..    def exit
-00092f40: 4e75 6d62 6572 5f61 2873 656c 662c 2063  Number_a(self, c
-00092f50: 7478 3a20 5870 6c6f 724d 5250 6172 7365  tx: XplorMRParse
-00092f60: 722e 4e75 6d62 6572 5f61 436f 6e74 6578  r.Number_aContex
-00092f70: 7429 3a20 2023 2070 796c 696e 743a 2064  t):  # pylint: d
-00092f80: 6973 6162 6c65 3d75 6e75 7365 642d 6172  isable=unused-ar
-00092f90: 6775 6d65 6e74 0a20 2020 2020 2020 2070  gument.        p
-00092fa0: 6173 730a 0a20 2020 2064 6566 2067 6574  ass..    def get
-00092fb0: 4e75 6d62 6572 5f61 2873 656c 662c 2063  Number_a(self, c
-00092fc0: 7478 3a20 5870 6c6f 724d 5250 6172 7365  tx: XplorMRParse
-00092fd0: 722e 4e75 6d62 6572 5f61 436f 6e74 6578  r.Number_aContex
-00092fe0: 7429 3a20 2023 2070 796c 696e 743a 2064  t):  # pylint: d
-00092ff0: 6973 6162 6c65 3d6e 6f2d 7365 6c66 2d75  isable=no-self-u
-00093000: 7365 0a20 2020 2020 2020 2069 6620 6374  se.        if ct
-00093010: 7820 6973 204e 6f6e 653a 0a20 2020 2020  x is None:.     
-00093020: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
-00093030: 6e65 0a0a 2020 2020 2020 2020 6966 2063  ne..        if c
-00093040: 7478 2e52 6561 6c28 293a 0a20 2020 2020  tx.Real():.     
-00093050: 2020 2020 2020 2072 6574 7572 6e20 666c         return fl
-00093060: 6f61 7428 7374 7228 6374 782e 5265 616c  oat(str(ctx.Real
-00093070: 2829 2929 0a0a 2020 2020 2020 2020 6966  ()))..        if
-00093080: 2063 7478 2e49 6e74 6567 6572 2829 3a0a   ctx.Integer():.
-00093090: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000930a0: 726e 2066 6c6f 6174 2873 7472 2863 7478  rn float(str(ctx
-000930b0: 2e49 6e74 6567 6572 2829 2929 0a0a 2020  .Integer()))..  
-000930c0: 2020 2020 2020 7265 7475 726e 204e 6f6e        return Non
-000930d0: 650a 0a20 2020 2023 2045 6e74 6572 2061  e..    # Enter a
-000930e0: 2070 6172 7365 2074 7265 6520 7072 6f64   parse tree prod
-000930f0: 7563 6564 2062 7920 5870 6c6f 724d 5250  uced by XplorMRP
-00093100: 6172 7365 7223 636c 6173 7369 6669 6361  arser#classifica
-00093110: 7469 6f6e 2e0a 2020 2020 6465 6620 656e  tion..    def en
-00093120: 7465 7243 6c61 7373 6966 6963 6174 696f  terClassificatio
-00093130: 6e28 7365 6c66 2c20 6374 783a 2058 706c  n(self, ctx: Xpl
-00093140: 6f72 4d52 5061 7273 6572 2e43 6c61 7373  orMRParser.Class
-00093150: 6966 6963 6174 696f 6e43 6f6e 7465 7874  ificationContext
-00093160: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
-00093170: 636c 6173 7369 6669 6361 7469 6f6e 203d  classification =
-00093180: 2073 656c 662e 6765 7443 6c61 7373 5f6e   self.getClass_n
-00093190: 616d 6528 6374 782e 636c 6173 735f 6e61  ame(ctx.class_na
-000931a0: 6d65 2829 290a 0a20 2020 2023 2045 7869  me())..    # Exi
-000931b0: 7420 6120 7061 7273 6520 7472 6565 2070  t a parse tree p
-000931c0: 726f 6475 6365 6420 6279 2058 706c 6f72  roduced by Xplor
-000931d0: 4d52 5061 7273 6572 2363 6c61 7373 6966  MRParser#classif
-000931e0: 6963 6174 696f 6e2e 0a20 2020 2064 6566  ication..    def
-000931f0: 2065 7869 7443 6c61 7373 6966 6963 6174   exitClassificat
-00093200: 696f 6e28 7365 6c66 2c20 6374 783a 2058  ion(self, ctx: X
-00093210: 706c 6f72 4d52 5061 7273 6572 2e43 6c61  plorMRParser.Cla
-00093220: 7373 6966 6963 6174 696f 6e43 6f6e 7465  ssificationConte
-00093230: 7874 293a 2020 2320 7079 6c69 6e74 3a20  xt):  # pylint: 
-00093240: 6469 7361 626c 653d 756e 7573 6564 2d61  disable=unused-a
-00093250: 7267 756d 656e 740a 2020 2020 2020 2020  rgument.        
-00093260: 7061 7373 0a0a 2020 2020 2320 456e 7465  pass..    # Ente
-00093270: 7220 6120 7061 7273 6520 7472 6565 2070  r a parse tree p
-00093280: 726f 6475 6365 6420 6279 2058 706c 6f72  roduced by Xplor
-00093290: 4d52 5061 7273 6572 2363 6c61 7373 5f6e  MRParser#class_n
-000932a0: 616d 652e 0a20 2020 2064 6566 2065 6e74  ame..    def ent
-000932b0: 6572 436c 6173 735f 6e61 6d65 2873 656c  erClass_name(sel
-000932c0: 662c 2063 7478 3a20 5870 6c6f 724d 5250  f, ctx: XplorMRP
-000932d0: 6172 7365 722e 436c 6173 735f 6e61 6d65  arser.Class_name
-000932e0: 436f 6e74 6578 7429 3a20 2023 2070 796c  Context):  # pyl
-000932f0: 696e 743a 2064 6973 6162 6c65 3d75 6e75  int: disable=unu
-00093300: 7365 642d 6172 6775 6d65 6e74 0a20 2020  sed-argument.   
-00093310: 2020 2020 2070 6173 730a 0a20 2020 2023       pass..    #
-00093320: 2045 7869 7420 6120 7061 7273 6520 7472   Exit a parse tr
-00093330: 6565 2070 726f 6475 6365 6420 6279 2058  ee produced by X
-00093340: 706c 6f72 4d52 5061 7273 6572 2363 6c61  plorMRParser#cla
-00093350: 7373 5f6e 616d 652e 0a20 2020 2064 6566  ss_name..    def
-00093360: 2065 7869 7443 6c61 7373 5f6e 616d 6528   exitClass_name(
-00093370: 7365 6c66 2c20 6374 783a 2058 706c 6f72  self, ctx: Xplor
-00093380: 4d52 5061 7273 6572 2e43 6c61 7373 5f6e  MRParser.Class_n
-00093390: 616d 6543 6f6e 7465 7874 293a 2020 2320  ameContext):  # 
-000933a0: 7079 6c69 6e74 3a20 6469 7361 626c 653d  pylint: disable=
-000933b0: 756e 7573 6564 2d61 7267 756d 656e 740a  unused-argument.
-000933c0: 2020 2020 2020 2020 7061 7373 0a0a 2020          pass..  
-000933d0: 2020 6465 6620 6765 7443 6c61 7373 5f6e    def getClass_n
-000933e0: 616d 6528 7365 6c66 2c20 6374 783a 2058  ame(self, ctx: X
-000933f0: 706c 6f72 4d52 5061 7273 6572 2e43 6c61  plorMRParser.Cla
-00093400: 7373 5f6e 616d 6543 6f6e 7465 7874 293a  ss_nameContext):
-00093410: 2020 2320 7079 6c69 6e74 3a20 6469 7361    # pylint: disa
-00093420: 626c 653d 6e6f 2d73 656c 662d 7573 650a  ble=no-self-use.
-00093430: 2020 2020 2020 2020 6966 2063 7478 2069          if ctx i
-00093440: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00093450: 2020 2020 7265 7475 726e 204e 6f6e 650a      return None.
-00093460: 0a20 2020 2020 2020 2069 6620 6374 782e  .        if ctx.
-00093470: 5369 6d70 6c65 5f6e 616d 6528 293a 0a20  Simple_name():. 
-00093480: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00093490: 6e20 7374 7228 6374 782e 5369 6d70 6c65  n str(ctx.Simple
-000934a0: 5f6e 616d 6528 2929 0a0a 2020 2020 2020  _name())..      
-000934b0: 2020 6966 2063 7478 2e4e 6f65 2829 3a0a    if ctx.Noe():.
-000934c0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000934d0: 726e 2073 7472 2863 7478 2e4e 6f65 2829  rn str(ctx.Noe()
-000934e0: 290a 0a20 2020 2020 2020 2069 6620 6374  )..        if ct
-000934f0: 782e 5265 7374 7261 696e 7473 2829 3a0a  x.Restraints():.
-00093500: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00093510: 726e 2073 7472 2863 7478 2e52 6573 7472  rn str(ctx.Restr
-00093520: 6169 6e74 7328 2929 0a0a 2020 2020 2020  aints())..      
-00093530: 2020 6966 2063 7478 2e41 6e67 6c65 4462    if ctx.AngleDb
-00093540: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-00093550: 7265 7475 726e 2073 7472 2863 7478 2e41  return str(ctx.A
-00093560: 6e67 6c65 4462 2829 290a 0a20 2020 2020  ngleDb())..     
-00093570: 2020 2069 6620 6374 782e 4842 6f6e 6465     if ctx.HBonde
-00093580: 6428 293a 0a20 2020 2020 2020 2020 2020  d():.           
-00093590: 2072 6574 7572 6e20 7374 7228 6374 782e   return str(ctx.
-000935a0: 4842 6f6e 6465 6428 2929 0a0a 2020 2020  HBonded())..    
-000935b0: 2020 2020 6966 2063 7478 2e44 6968 6564      if ctx.Dihed
-000935c0: 7261 6c28 293a 0a20 2020 2020 2020 2020  ral():.         
-000935d0: 2020 2072 6574 7572 6e20 7374 7228 6374     return str(ct
-000935e0: 782e 4469 6865 6472 616c 2829 290a 0a20  x.Dihedral()).. 
-000935f0: 2020 2020 2020 2069 6620 6374 782e 496d         if ctx.Im
-00093600: 7072 6f70 6572 2829 3a0a 2020 2020 2020  proper():.      
-00093610: 2020 2020 2020 7265 7475 726e 2073 7472        return str
-00093620: 2863 7478 2e49 6d70 726f 7065 7228 2929  (ctx.Improper())
-00093630: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00093640: 204e 6f6e 650a 0a20 2020 2023 2045 6e74   None..    # Ent
-00093650: 6572 2061 2070 6172 7365 2074 7265 6520  er a parse tree 
-00093660: 7072 6f64 7563 6564 2062 7920 5870 6c6f  produced by Xplo
-00093670: 724d 5250 6172 7365 7223 666c 6167 5f73  rMRParser#flag_s
-00093680: 7461 7465 6d65 6e74 2e0a 2020 2020 6465  tatement..    de
-00093690: 6620 656e 7465 7246 6c61 675f 7374 6174  f enterFlag_stat
-000936a0: 656d 656e 7428 7365 6c66 2c20 6374 783a  ement(self, ctx:
-000936b0: 2058 706c 6f72 4d52 5061 7273 6572 2e46   XplorMRParser.F
-000936c0: 6c61 675f 7374 6174 656d 656e 7443 6f6e  lag_statementCon
-000936d0: 7465 7874 293a 2020 2320 7079 6c69 6e74  text):  # pylint
-000936e0: 3a20 6469 7361 626c 653d 756e 7573 6564  : disable=unused
-000936f0: 2d61 7267 756d 656e 740a 2020 2020 2020  -argument.      
-00093700: 2020 7061 7373 0a0a 2020 2020 2320 4578    pass..    # Ex
-00093710: 6974 2061 2070 6172 7365 2074 7265 6520  it a parse tree 
-00093720: 7072 6f64 7563 6564 2062 7920 5870 6c6f  produced by Xplo
-00093730: 724d 5250 6172 7365 7223 666c 6167 5f73  rMRParser#flag_s
-00093740: 7461 7465 6d65 6e74 2e0a 2020 2020 6465  tatement..    de
-00093750: 6620 6578 6974 466c 6167 5f73 7461 7465  f exitFlag_state
-00093760: 6d65 6e74 2873 656c 662c 2063 7478 3a20  ment(self, ctx: 
-00093770: 5870 6c6f 724d 5250 6172 7365 722e 466c  XplorMRParser.Fl
-00093780: 6167 5f73 7461 7465 6d65 6e74 436f 6e74  ag_statementCont
-00093790: 6578 7429 3a20 2023 2070 796c 696e 743a  ext):  # pylint:
-000937a0: 2064 6973 6162 6c65 3d75 6e75 7365 642d   disable=unused-
-000937b0: 6172 6775 6d65 6e74 0a20 2020 2020 2020  argument.       
-000937c0: 2070 6173 730a 0a20 2020 2023 2045 6e74   pass..    # Ent
-000937d0: 6572 2061 2070 6172 7365 2074 7265 6520  er a parse tree 
-000937e0: 7072 6f64 7563 6564 2062 7920 5870 6c6f  produced by Xplo
-000937f0: 724d 5250 6172 7365 7223 7665 6374 6f72  rMRParser#vector
-00093800: 5f73 7461 7465 6d65 6e74 2e0a 2020 2020  _statement..    
-00093810: 6465 6620 656e 7465 7256 6563 746f 725f  def enterVector_
-00093820: 7374 6174 656d 656e 7428 7365 6c66 2c20  statement(self, 
-00093830: 6374 783a 2058 706c 6f72 4d52 5061 7273  ctx: XplorMRPars
-00093840: 6572 2e56 6563 746f 725f 7374 6174 656d  er.Vector_statem
-00093850: 656e 7443 6f6e 7465 7874 293a 2020 2320  entContext):  # 
-00093860: 7079 6c69 6e74 3a20 6469 7361 626c 653d  pylint: disable=
-00093870: 756e 7573 6564 2d61 7267 756d 656e 740a  unused-argument.
-00093880: 2020 2020 2020 2020 7365 6c66 2e5f 5f63          self.__c
-00093890: 7572 5f76 6563 746f 725f 6d6f 6465 203d  ur_vector_mode =
-000938a0: 2027 270a 2020 2020 2020 2020 7365 6c66   ''.        self
-000938b0: 2e5f 5f63 7572 5f76 6563 746f 725f 6174  .__cur_vector_at
-000938c0: 6f6d 5f70 726f 705f 7479 7065 203d 2027  om_prop_type = '
-000938d0: 270a 0a20 2020 2020 2020 2073 656c 662e  '..        self.
-000938e0: 5f5f 6375 725f 7666 6c63 5f6f 705f 636f  __cur_vflc_op_co
-000938f0: 6465 203d 2027 270a 2020 2020 2020 2020  de = ''.        
-00093900: 7365 6c66 2e73 7461 636b 5666 6c63 203d  self.stackVflc =
-00093910: 205b 5d0a 0a20 2020 2020 2020 2073 656c   []..        sel
-00093920: 662e 6174 6f6d 5365 6c65 6374 696f 6e53  f.atomSelectionS
-00093930: 6574 2e63 6c65 6172 2829 0a20 2020 2020  et.clear().     
-00093940: 2020 2073 656c 662e 5f5f 672e 636c 6561     self.__g.clea
-00093950: 7228 290a 0a20 2020 2023 2045 7869 7420  r()..    # Exit 
-00093960: 6120 7061 7273 6520 7472 6565 2070 726f  a parse tree pro
-00093970: 6475 6365 6420 6279 2058 706c 6f72 4d52  duced by XplorMR
-00093980: 5061 7273 6572 2376 6563 746f 725f 7374  Parser#vector_st
-00093990: 6174 656d 656e 742e 0a20 2020 2064 6566  atement..    def
-000939a0: 2065 7869 7456 6563 746f 725f 7374 6174   exitVector_stat
-000939b0: 656d 656e 7428 7365 6c66 2c20 6374 783a  ement(self, ctx:
-000939c0: 2058 706c 6f72 4d52 5061 7273 6572 2e56   XplorMRParser.V
-000939d0: 6563 746f 725f 7374 6174 656d 656e 7443  ector_statementC
-000939e0: 6f6e 7465 7874 293a 2020 2320 7079 6c69  ontext):  # pyli
-000939f0: 6e74 3a20 6469 7361 626c 653d 756e 7573  nt: disable=unus
-00093a00: 6564 2d61 7267 756d 656e 740a 2020 2020  ed-argument.    
-00093a10: 2020 2020 6966 2073 656c 662e 5f5f 6375      if self.__cu
-00093a20: 725f 7665 6374 6f72 5f6d 6f64 6520 3d3d  r_vector_mode ==
-00093a30: 2027 6964 656e 7469 7479 273a 0a20 2020   'identity':.   
-00093a40: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00093a50: 2e5f 5f63 7572 5f76 6563 746f 725f 6174  .__cur_vector_at
-00093a60: 6f6d 5f70 726f 705f 7479 7065 2e73 7461  om_prop_type.sta
-00093a70: 7274 7377 6974 6828 2773 746f 7265 2729  rtswith('store')
-00093a80: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00093a90: 2020 7365 6c66 2e73 746f 7265 5365 745b    self.storeSet[
-00093aa0: 696e 7428 7365 6c66 2e5f 5f63 7572 5f76  int(self.__cur_v
-00093ab0: 6563 746f 725f 6174 6f6d 5f70 726f 705f  ector_atom_prop_
-00093ac0: 7479 7065 5b2d 315d 295d 203d 207b 2761  type[-1])] = {'a
-00093ad0: 746f 6d5f 7365 6c65 6374 696f 6e27 3a20  tom_selection': 
-00093ae0: 636f 7079 2e63 6f70 7928 7365 6c66 2e61  copy.copy(self.a
-00093af0: 746f 6d53 656c 6563 7469 6f6e 5365 745b  tomSelectionSet[
-00093b00: 305d 297d 0a0a 2020 2020 2020 2020 656c  0])}..        el
-00093b10: 6966 2073 656c 662e 5f5f 6375 725f 7665  if self.__cur_ve
-00093b20: 6374 6f72 5f6d 6f64 6520 3d3d 2027 646f  ctor_mode == 'do
-00093b30: 273a 0a20 2020 2020 2020 2020 2020 2069  ':.            i
-00093b40: 6620 6c65 6e28 7365 6c66 2e5f 5f63 7572  f len(self.__cur
-00093b50: 5f76 6563 746f 725f 6174 6f6d 5f70 726f  _vector_atom_pro
-00093b60: 705f 7479 7065 2920 3e20 303a 0a20 2020  p_type) > 0:.   
-00093b70: 2020 2020 2020 2020 2020 2020 2076 6563               vec
-00093b80: 746f 725f 6e61 6d65 203d 2073 656c 662e  tor_name = self.
-00093b90: 5f5f 6375 725f 7665 6374 6f72 5f61 746f  __cur_vector_ato
-00093ba0: 6d5f 7072 6f70 5f74 7970 650a 2020 2020  m_prop_type.    
-00093bb0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-00093bc0: 656e 2876 6563 746f 725f 6e61 6d65 2920  en(vector_name) 
-00093bd0: 3e20 343a 0a20 2020 2020 2020 2020 2020  > 4:.           
-00093be0: 2020 2020 2020 2020 2076 6563 746f 725f           vector_
-00093bf0: 6e61 6d65 203d 2076 6563 746f 725f 6e61  name = vector_na
-00093c00: 6d65 5b3a 345d 0a20 2020 2020 2020 2020  me[:4].         
-00093c10: 2020 2020 2020 2069 6620 7665 6374 6f72         if vector
-00093c20: 5f6e 616d 6520 6e6f 7420 696e 2073 656c  _name not in sel
-00093c30: 662e 7665 6374 6f72 446f 3a0a 2020 2020  f.vectorDo:.    
-00093c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00093c50: 7365 6c66 2e76 6563 746f 7244 6f5b 7665  self.vectorDo[ve
-00093c60: 6374 6f72 5f6e 616d 655d 203d 205b 5d0a  ctor_name] = [].
-00093c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00093c80: 7665 6374 6f72 203d 207b 2761 746f 6d5f  vector = {'atom_
-00093c90: 7365 6c65 6374 696f 6e27 3a20 636f 7079  selection': copy
-00093ca0: 2e63 6f70 7928 7365 6c66 2e61 746f 6d53  .copy(self.atomS
-00093cb0: 656c 6563 7469 6f6e 5365 745b 305d 297d  electionSet[0])}
-00093cc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00093cd0: 2077 6869 6c65 2073 656c 662e 7374 6163   while self.stac
-00093ce0: 6b56 666c 633a 0a20 2020 2020 2020 2020  kVflc:.         
-00093cf0: 2020 2020 2020 2020 2020 2076 6563 746f             vecto
-00093d00: 725b 2776 616c 7565 275d 203d 2073 656c  r['value'] = sel
-00093d10: 662e 7374 6163 6b56 666c 632e 706f 7028  f.stackVflc.pop(
-00093d20: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00093d30: 2020 7365 6c66 2e76 6563 746f 7244 6f5b    self.vectorDo[
-00093d40: 7665 6374 6f72 5f6e 616d 655d 2e61 7070  vector_name].app
-00093d50: 656e 6428 7665 6374 6f72 290a 0a20 2020  end(vector)..   
-00093d60: 2023 2045 6e74 6572 2061 2070 6172 7365   # Enter a parse
-00093d70: 2074 7265 6520 7072 6f64 7563 6564 2062   tree produced b
-00093d80: 7920 5870 6c6f 724d 5250 6172 7365 7223  y XplorMRParser#
-00093d90: 7665 6374 6f72 5f6d 6f64 652e 0a20 2020  vector_mode..   
-00093da0: 2064 6566 2065 6e74 6572 5665 6374 6f72   def enterVector
-00093db0: 5f6d 6f64 6528 7365 6c66 2c20 6374 783a  _mode(self, ctx:
-00093dc0: 2058 706c 6f72 4d52 5061 7273 6572 2e56   XplorMRParser.V
-00093dd0: 6563 746f 725f 6d6f 6465 436f 6e74 6578  ector_modeContex
-00093de0: 7429 3a0a 2020 2020 2020 2020 6966 2063  t):.        if c
-00093df0: 7478 2e49 6465 6e74 6974 795f 4c70 2829  tx.Identity_Lp()
-00093e00: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00093e10: 6c66 2e5f 5f63 7572 5f76 6563 746f 725f  lf.__cur_vector_
-00093e20: 6d6f 6465 203d 2027 6964 656e 7469 7479  mode = 'identity
-00093e30: 270a 0a20 2020 2020 2020 2065 6c69 6620  '..        elif 
-00093e40: 6374 782e 446f 5f4c 7028 293a 0a20 2020  ctx.Do_Lp():.   
-00093e50: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
-00093e60: 6375 725f 7665 6374 6f72 5f6d 6f64 6520  cur_vector_mode 
-00093e70: 3d20 2764 6f27 0a0a 2020 2020 2020 2020  = 'do'..        
-00093e80: 656c 6966 2063 7478 2e53 686f 7728 293a  elif ctx.Show():
-00093e90: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00093ea0: 662e 5f5f 6375 725f 7665 6374 6f72 5f6d  f.__cur_vector_m
-00093eb0: 6f64 6520 3d20 2773 686f 7727 0a0a 2020  ode = 'show'..  
-00093ec0: 2020 2320 4578 6974 2061 2070 6172 7365    # Exit a parse
-00093ed0: 2074 7265 6520 7072 6f64 7563 6564 2062   tree produced b
-00093ee0: 7920 5870 6c6f 724d 5250 6172 7365 7223  y XplorMRParser#
-00093ef0: 7665 6374 6f72 5f6d 6f64 652e 0a20 2020  vector_mode..   
-00093f00: 2064 6566 2065 7869 7456 6563 746f 725f   def exitVector_
-00093f10: 6d6f 6465 2873 656c 662c 2063 7478 3a20  mode(self, ctx: 
-00093f20: 5870 6c6f 724d 5250 6172 7365 722e 5665  XplorMRParser.Ve
-00093f30: 6374 6f72 5f6d 6f64 6543 6f6e 7465 7874  ctor_modeContext
-00093f40: 293a 2020 2320 7079 6c69 6e74 3a20 6469  ):  # pylint: di
-00093f50: 7361 626c 653d 756e 7573 6564 2d61 7267  sable=unused-arg
-00093f60: 756d 656e 740a 2020 2020 2020 2020 7061  ument.        pa
-00093f70: 7373 0a0a 2020 2020 2320 456e 7465 7220  ss..    # Enter 
-00093f80: 6120 7061 7273 6520 7472 6565 2070 726f  a parse tree pro
-00093f90: 6475 6365 6420 6279 2058 706c 6f72 4d52  duced by XplorMR
-00093fa0: 5061 7273 6572 2376 6563 746f 725f 6578  Parser#vector_ex
-00093fb0: 7072 6573 7369 6f6e 2e0a 2020 2020 6465  pression..    de
-00093fc0: 6620 656e 7465 7256 6563 746f 725f 6578  f enterVector_ex
-00093fd0: 7072 6573 7369 6f6e 2873 656c 662c 2063  pression(self, c
-00093fe0: 7478 3a20 5870 6c6f 724d 5250 6172 7365  tx: XplorMRParse
-00093ff0: 722e 5665 6374 6f72 5f65 7870 7265 7373  r.Vector_express
-00094000: 696f 6e43 6f6e 7465 7874 293a 2020 2320  ionContext):  # 
-00094010: 7079 6c69 6e74 3a20 6469 7361 626c 653d  pylint: disable=
-00094020: 756e 7573 6564 2d61 7267 756d 656e 740a  unused-argument.
-00094030: 2020 2020 2020 2020 7061 7373 0a0a 2020          pass..  
-00094040: 2020 2320 4578 6974 2061 2070 6172 7365    # Exit a parse
-00094050: 2074 7265 6520 7072 6f64 7563 6564 2062   tree produced b
-00094060: 7920 5870 6c6f 724d 5250 6172 7365 7223  y XplorMRParser#
-00094070: 7665 6374 6f72 5f65 7870 7265 7373 696f  vector_expressio
-00094080: 6e2e 0a20 2020 2064 6566 2065 7869 7456  n..    def exitV
-00094090: 6563 746f 725f 6578 7072 6573 7369 6f6e  ector_expression
-000940a0: 2873 656c 662c 2063 7478 3a20 5870 6c6f  (self, ctx: Xplo
-000940b0: 724d 5250 6172 7365 722e 5665 6374 6f72  rMRParser.Vector
-000940c0: 5f65 7870 7265 7373 696f 6e43 6f6e 7465  _expressionConte
-000940d0: 7874 293a 0a20 2020 2020 2020 2069 6620  xt):.        if 
-000940e0: 6374 782e 4174 6f6d 5f70 726f 7065 7274  ctx.Atom_propert
-000940f0: 6965 735f 5645 2829 3a0a 2020 2020 2020  ies_VE():.      
-00094100: 2020 2020 2020 7365 6c66 2e5f 5f63 7572        self.__cur
-00094110: 5f76 6563 746f 725f 6174 6f6d 5f70 726f  _vector_atom_pro
-00094120: 705f 7479 7065 203d 2073 7472 2863 7478  p_type = str(ctx
-00094130: 2e41 746f 6d5f 7072 6f70 6572 7469 6573  .Atom_properties
-00094140: 5f56 4528 2929 2e6c 6f77 6572 2829 0a0a  _VE()).lower()..
-00094150: 2020 2020 2320 456e 7465 7220 6120 7061      # Enter a pa
-00094160: 7273 6520 7472 6565 2070 726f 6475 6365  rse tree produce
-00094170: 6420 6279 2058 706c 6f72 4d52 5061 7273  d by XplorMRPars
-00094180: 6572 2376 6563 746f 725f 6f70 6572 6174  er#vector_operat
-00094190: 696f 6e2e 0a20 2020 2064 6566 2065 6e74  ion..    def ent
-000941a0: 6572 5665 6374 6f72 5f6f 7065 7261 7469  erVector_operati
-000941b0: 6f6e 2873 656c 662c 2063 7478 3a20 5870  on(self, ctx: Xp
-000941c0: 6c6f 724d 5250 6172 7365 722e 5665 6374  lorMRParser.Vect
-000941d0: 6f72 5f6f 7065 7261 7469 6f6e 436f 6e74  or_operationCont
-000941e0: 6578 7429 3a20 2023 2070 796c 696e 743a  ext):  # pylint:
-000941f0: 2064 6973 6162 6c65 3d75 6e75 7365 642d   disable=unused-
-00094200: 6172 6775 6d65 6e74 0a20 2020 2020 2020  argument.       
-00094210: 2070 6173 730a 0a20 2020 2023 2045 7869   pass..    # Exi
-00094220: 7420 6120 7061 7273 6520 7472 6565 2070  t a parse tree p
-00094230: 726f 6475 6365 6420 6279 2058 706c 6f72  roduced by Xplor
-00094240: 4d52 5061 7273 6572 2376 6563 746f 725f  MRParser#vector_
-00094250: 6f70 6572 6174 696f 6e2e 0a20 2020 2064  operation..    d
-00094260: 6566 2065 7869 7456 6563 746f 725f 6f70  ef exitVector_op
-00094270: 6572 6174 696f 6e28 7365 6c66 2c20 6374  eration(self, ct
-00094280: 783a 2058 706c 6f72 4d52 5061 7273 6572  x: XplorMRParser
-00094290: 2e56 6563 746f 725f 6f70 6572 6174 696f  .Vector_operatio
-000942a0: 6e43 6f6e 7465 7874 293a 2020 2320 7079  nContext):  # py
-000942b0: 6c69 6e74 3a20 6469 7361 626c 653d 756e  lint: disable=un
-000942c0: 7573 6564 2d61 7267 756d 656e 740a 2020  used-argument.  
-000942d0: 2020 2020 2020 7061 7373 0a0a 2020 2020        pass..    
-000942e0: 2320 456e 7465 7220 6120 7061 7273 6520  # Enter a parse 
-000942f0: 7472 6565 2070 726f 6475 6365 6420 6279  tree produced by
-00094300: 2058 706c 6f72 4d52 5061 7273 6572 2376   XplorMRParser#v
-00094310: 666c 632e 0a20 2020 2064 6566 2065 6e74  flc..    def ent
-00094320: 6572 5666 6c63 2873 656c 662c 2063 7478  erVflc(self, ctx
-00094330: 3a20 5870 6c6f 724d 5250 6172 7365 722e  : XplorMRParser.
-00094340: 5666 6c63 436f 6e74 6578 7429 3a20 2023  VflcContext):  #
-00094350: 2070 796c 696e 743a 2064 6973 6162 6c65   pylint: disable
-00094360: 3d75 6e75 7365 642d 6172 6775 6d65 6e74  =unused-argument
-00094370: 0a20 2020 2020 2020 2070 6173 730a 0a20  .        pass.. 
-00094380: 2020 2023 2045 7869 7420 6120 7061 7273     # Exit a pars
-00094390: 6520 7472 6565 2070 726f 6475 6365 6420  e tree produced 
-000943a0: 6279 2058 706c 6f72 4d52 5061 7273 6572  by XplorMRParser
-000943b0: 2376 666c 632e 0a20 2020 2064 6566 2065  #vflc..    def e
-000943c0: 7869 7456 666c 6328 7365 6c66 2c20 6374  xitVflc(self, ct
-000943d0: 783a 2058 706c 6f72 4d52 5061 7273 6572  x: XplorMRParser
-000943e0: 2e56 666c 6343 6f6e 7465 7874 293a 0a20  .VflcContext):. 
-000943f0: 2020 2020 2020 2069 6620 6374 782e 496e         if ctx.In
-00094400: 7465 6765 725f 5645 2829 3a0a 2020 2020  teger_VE():.    
-00094410: 2020 2020 2020 2020 7365 6c66 2e73 7461          self.sta
-00094420: 636b 5666 6c63 2e61 7070 656e 6428 696e  ckVflc.append(in
-00094430: 7428 7374 7228 6374 782e 496e 7465 6765  t(str(ctx.Intege
-00094440: 725f 5645 2829 2929 290a 2020 2020 2020  r_VE()))).      
-00094450: 2020 656c 6966 2063 7478 2e52 6561 6c5f    elif ctx.Real_
-00094460: 5645 2829 3a0a 2020 2020 2020 2020 2020  VE():.          
-00094470: 2020 7365 6c66 2e73 7461 636b 5666 6c63    self.stackVflc
-00094480: 2e61 7070 656e 6428 666c 6f61 7428 7374  .append(float(st
-00094490: 7228 6374 782e 5265 616c 5f56 4528 2929  r(ctx.Real_VE())
-000944a0: 2929 0a20 2020 2020 2020 2065 6c69 6620  )).        elif 
-000944b0: 6374 782e 5369 6d70 6c65 5f6e 616d 655f  ctx.Simple_name_
-000944c0: 5645 2829 3a0a 2020 2020 2020 2020 2020  VE():.          
-000944d0: 2020 7365 6c66 2e73 7461 636b 5666 6c63    self.stackVflc
-000944e0: 2e61 7070 656e 6428 7374 7228 6374 782e  .append(str(ctx.
-000944f0: 5369 6d70 6c65 5f6e 616d 655f 5645 2829  Simple_name_VE()
-00094500: 2929 0a20 2020 2020 2020 2065 6c69 6620  )).        elif 
-00094510: 6374 782e 446f 7562 6c65 5f71 756f 7465  ctx.Double_quote
-00094520: 5f73 7472 696e 675f 5645 2829 3a0a 2020  _string_VE():.  
-00094530: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
-00094540: 7461 636b 5666 6c63 2e61 7070 656e 6428  tackVflc.append(
-00094550: 7374 7228 6374 782e 446f 7562 6c65 5f71  str(ctx.Double_q
-00094560: 756f 7465 5f73 7472 696e 675f 5645 2829  uote_string_VE()
-00094570: 292e 7374 7269 7028 2722 2729 2e73 7472  ).strip('"').str
-00094580: 6970 2829 290a 2020 2020 2020 2020 656c  ip()).        el
-00094590: 6966 2063 7478 2e53 796d 626f 6c5f 6e61  if ctx.Symbol_na
-000945a0: 6d65 5f56 4528 293a 0a20 2020 2020 2020  me_VE():.       
-000945b0: 2020 2020 2073 796d 626f 6c5f 6e61 6d65       symbol_name
-000945c0: 203d 2073 7472 2863 7478 2e53 796d 626f   = str(ctx.Symbo
-000945d0: 6c5f 6e61 6d65 5f56 4528 2929 0a20 2020  l_name_VE()).   
-000945e0: 2020 2020 2020 2020 2069 6620 7379 6d62           if symb
-000945f0: 6f6c 5f6e 616d 6520 696e 2073 656c 662e  ol_name in self.
-00094600: 6576 616c 7561 7465 3a0a 2020 2020 2020  evaluate:.      
-00094610: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
-00094620: 7461 636b 5666 6c63 2e61 7070 656e 6428  tackVflc.append(
-00094630: 7365 6c66 2e65 7661 6c75 6174 655b 7379  self.evaluate[sy
-00094640: 6d62 6f6c 5f6e 616d 655d 290a 2020 2020  mbol_name]).    
-00094650: 2020 2020 2020 2020 656c 6966 2073 796d          elif sym
-00094660: 626f 6c5f 6e61 6d65 2069 6e20 7365 6c66  bol_name in self
-00094670: 2e65 7661 6c75 6174 6546 6f72 3a0a 2020  .evaluateFor:.  
-00094680: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00094690: 6c66 2e73 7461 636b 5666 6c63 2e61 7070  lf.stackVflc.app
-000946a0: 656e 6428 7365 6c66 2e65 7661 6c75 6174  end(self.evaluat
-000946b0: 6546 6f72 5b73 796d 626f 6c5f 6e61 6d65  eFor[symbol_name
-000946c0: 5d29 0a20 2020 2020 2020 2020 2020 2065  ]).            e
-000946d0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000946e0: 2020 2020 2073 656c 662e 5f5f 662e 6170       self.__f.ap
-000946f0: 7065 6e64 2866 225b 556e 7375 7070 6f72  pend(f"[Unsuppor
-00094700: 7465 6420 6461 7461 5d20 7b73 656c 662e  ted data] {self.
-00094710: 5f5f 6765 7443 7572 7265 6e74 5265 7374  __getCurrentRest
-00094720: 7261 696e 7428 297d 220a 2020 2020 2020  raint()}".      
-00094730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00094740: 2020 2020 2020 2020 2020 6622 5468 6520            f"The 
-00094750: 7379 6d62 6f6c 207b 7379 6d62 6f6c 5f6e  symbol {symbol_n
-00094760: 616d 6521 727d 2069 7320 6e6f 7420 6465  ame!r} is not de
-00094770: 6669 6e65 642e 2229 0a20 2020 2020 2020  fined.").       
-00094780: 2065 6c69 6620 6374 782e 4174 6f6d 5f70   elif ctx.Atom_p
-00094790: 726f 7065 7274 6965 735f 5645 2829 3a0a  roperties_VE():.
-000947a0: 2020 2020 2020 2020 2020 2020 7061 7373              pass
-000947b0: 0a20 2020 2020 2020 2065 6c69 6620 6374  .        elif ct
-000947c0: 782e 7665 6374 6f72 5f66 756e 635f 6361  x.vector_func_ca
-000947d0: 6c6c 2829 3a0a 2020 2020 2020 2020 2020  ll():.          
-000947e0: 2020 7061 7373 0a0a 2020 2020 2320 456e    pass..    # En
-000947f0: 7465 7220 6120 7061 7273 6520 7472 6565  ter a parse tree
-00094800: 2070 726f 6475 6365 6420 6279 2058 706c   produced by Xpl
-00094810: 6f72 4d52 5061 7273 6572 2376 6563 746f  orMRParser#vecto
-00094820: 725f 6675 6e63 5f63 616c 6c2e 0a20 2020  r_func_call..   
-00094830: 2064 6566 2065 6e74 6572 5665 6374 6f72   def enterVector
-00094840: 5f66 756e 635f 6361 6c6c 2873 656c 662c  _func_call(self,
-00094850: 2063 7478 3a20 5870 6c6f 724d 5250 6172   ctx: XplorMRPar
-00094860: 7365 722e 5665 6374 6f72 5f66 756e 635f  ser.Vector_func_
-00094870: 6361 6c6c 436f 6e74 6578 7429 3a20 2023  callContext):  #
-00094880: 2070 796c 696e 743a 2064 6973 6162 6c65   pylint: disable
-00094890: 3d75 6e75 7365 642d 6172 6775 6d65 6e74  =unused-argument
-000948a0: 0a20 2020 2020 2020 2070 6173 730a 0a20  .        pass.. 
-000948b0: 2020 2023 2045 7869 7420 6120 7061 7273     # Exit a pars
-000948c0: 6520 7472 6565 2070 726f 6475 6365 6420  e tree produced 
-000948d0: 6279 2058 706c 6f72 4d52 5061 7273 6572  by XplorMRParser
-000948e0: 2376 6563 746f 725f 6675 6e63 5f63 616c  #vector_func_cal
-000948f0: 6c2e 0a20 2020 2064 6566 2065 7869 7456  l..    def exitV
-00094900: 6563 746f 725f 6675 6e63 5f63 616c 6c28  ector_func_call(
-00094910: 7365 6c66 2c20 6374 783a 2058 706c 6f72  self, ctx: Xplor
-00094920: 4d52 5061 7273 6572 2e56 6563 746f 725f  MRParser.Vector_
-00094930: 6675 6e63 5f63 616c 6c43 6f6e 7465 7874  func_callContext
-00094940: 293a 2020 2320 7079 6c69 6e74 3a20 6469  ):  # pylint: di
-00094950: 7361 626c 653d 756e 7573 6564 2d61 7267  sable=unused-arg
-00094960: 756d 656e 740a 2020 2020 2020 2020 7061  ument.        pa
-00094970: 7373 0a0a 2020 2020 2320 456e 7465 7220  ss..    # Enter 
-00094980: 6120 7061 7273 6520 7472 6565 2070 726f  a parse tree pro
-00094990: 6475 6365 6420 6279 2058 706c 6f72 4d52  duced by XplorMR
-000949a0: 5061 7273 6572 2376 6563 746f 725f 7368  Parser#vector_sh
-000949b0: 6f77 5f70 726f 7065 7274 792e 0a20 2020  ow_property..   
-000949c0: 2064 6566 2065 6e74 6572 5665 6374 6f72   def enterVector
-000949d0: 5f73 686f 775f 7072 6f70 6572 7479 2873  _show_property(s
-000949e0: 656c 662c 2063 7478 3a20 5870 6c6f 724d  elf, ctx: XplorM
-000949f0: 5250 6172 7365 722e 5665 6374 6f72 5f73  RParser.Vector_s
-00094a00: 686f 775f 7072 6f70 6572 7479 436f 6e74  how_propertyCont
-00094a10: 6578 7429 3a20 2023 2070 796c 696e 743a  ext):  # pylint:
-00094a20: 2064 6973 6162 6c65 3d75 6e75 7365 642d   disable=unused-
-00094a30: 6172 6775 6d65 6e74 0a20 2020 2020 2020  argument.       
-00094a40: 2070 6173 730a 0a20 2020 2023 2045 7869   pass..    # Exi
-00094a50: 7420 6120 7061 7273 6520 7472 6565 2070  t a parse tree p
-00094a60: 726f 6475 6365 6420 6279 2058 706c 6f72  roduced by Xplor
-00094a70: 4d52 5061 7273 6572 2376 6563 746f 725f  MRParser#vector_
-00094a80: 7368 6f77 5f70 726f 7065 7274 792e 0a20  show_property.. 
-00094a90: 2020 2064 6566 2065 7869 7456 6563 746f     def exitVecto
-00094aa0: 725f 7368 6f77 5f70 726f 7065 7274 7928  r_show_property(
-00094ab0: 7365 6c66 2c20 6374 783a 2058 706c 6f72  self, ctx: Xplor
-00094ac0: 4d52 5061 7273 6572 2e56 6563 746f 725f  MRParser.Vector_
-00094ad0: 7368 6f77 5f70 726f 7065 7274 7943 6f6e  show_propertyCon
-00094ae0: 7465 7874 293a 2020 2320 7079 6c69 6e74  text):  # pylint
-00094af0: 3a20 6469 7361 626c 653d 756e 7573 6564  : disable=unused
-00094b00: 2d61 7267 756d 656e 740a 2020 2020 2020  -argument.      
-00094b10: 2020 7061 7373 0a0a 2020 2020 2320 456e    pass..    # En
-00094b20: 7465 7220 6120 7061 7273 6520 7472 6565  ter a parse tree
-00094b30: 2070 726f 6475 6365 6420 6279 2058 706c   produced by Xpl
-00094b40: 6f72 4d52 5061 7273 6572 2365 7661 6c75  orMRParser#evalu
-00094b50: 6174 655f 7374 6174 656d 656e 742e 0a20  ate_statement.. 
-00094b60: 2020 2064 6566 2065 6e74 6572 4576 616c     def enterEval
-00094b70: 7561 7465 5f73 7461 7465 6d65 6e74 2873  uate_statement(s
-00094b80: 656c 662c 2063 7478 3a20 5870 6c6f 724d  elf, ctx: XplorM
-00094b90: 5250 6172 7365 722e 4576 616c 7561 7465  RParser.Evaluate
-00094ba0: 5f73 7461 7465 6d65 6e74 436f 6e74 6578  _statementContex
-00094bb0: 7429 3a0a 2020 2020 2020 2020 6966 2063  t):.        if c
-00094bc0: 7478 2e53 796d 626f 6c5f 6e61 6d65 5f56  tx.Symbol_name_V
-00094bd0: 4528 293a 0a20 2020 2020 2020 2020 2020  E():.           
-00094be0: 2073 656c 662e 5f5f 6375 725f 7379 6d62   self.__cur_symb
-00094bf0: 6f6c 5f6e 616d 6520 3d20 7374 7228 6374  ol_name = str(ct
-00094c00: 782e 5379 6d62 6f6c 5f6e 616d 655f 5645  x.Symbol_name_VE
-00094c10: 2829 290a 0a20 2020 2020 2020 2073 656c  ())..        sel
-00094c20: 662e 5f5f 6375 725f 7666 6c63 5f6f 705f  f.__cur_vflc_op_
-00094c30: 636f 6465 203d 2027 270a 2020 2020 2020  code = ''.      
-00094c40: 2020 7365 6c66 2e73 7461 636b 5666 6c63    self.stackVflc
-00094c50: 203d 205b 5d0a 0a20 2020 2023 2045 7869   = []..    # Exi
-00094c60: 7420 6120 7061 7273 6520 7472 6565 2070  t a parse tree p
-00094c70: 726f 6475 6365 6420 6279 2058 706c 6f72  roduced by Xplor
-00094c80: 4d52 5061 7273 6572 2365 7661 6c75 6174  MRParser#evaluat
-00094c90: 655f 7374 6174 656d 656e 742e 0a20 2020  e_statement..   
-00094ca0: 2064 6566 2065 7869 7445 7661 6c75 6174   def exitEvaluat
-00094cb0: 655f 7374 6174 656d 656e 7428 7365 6c66  e_statement(self
-00094cc0: 2c20 6374 783a 2058 706c 6f72 4d52 5061  , ctx: XplorMRPa
-00094cd0: 7273 6572 2e45 7661 6c75 6174 655f 7374  rser.Evaluate_st
-00094ce0: 6174 656d 656e 7443 6f6e 7465 7874 293a  atementContext):
-00094cf0: 2020 2320 7079 6c69 6e74 3a20 6469 7361    # pylint: disa
-00094d00: 626c 653d 756e 7573 6564 2d61 7267 756d  ble=unused-argum
-00094d10: 656e 740a 2020 2020 2020 2020 6966 2073  ent.        if s
-00094d20: 656c 662e 7374 6163 6b56 666c 633a 0a20  elf.stackVflc:. 
-00094d30: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00094d40: 6576 616c 7561 7465 5b73 656c 662e 5f5f  evaluate[self.__
-00094d50: 6375 725f 7379 6d62 6f6c 5f6e 616d 655d  cur_symbol_name]
-00094d60: 203d 2073 656c 662e 7374 6163 6b56 666c   = self.stackVfl
-00094d70: 635b 305d 0a0a 2020 2020 2020 2020 2020  c[0]..          
-00094d80: 2020 6966 2073 656c 662e 5f5f 6375 725f    if self.__cur_
-00094d90: 7666 6c63 5f6f 705f 636f 6465 2069 6e20  vflc_op_code in 
-00094da0: 2827 2b27 2c20 272d 272c 2027 2a27 2c20  ('+', '-', '*', 
-00094db0: 272f 272c 2027 5e27 293a 0a20 2020 2020  '/', '^'):.     
-00094dc0: 2020 2020 2020 2020 2020 2073 203d 2073             s = s
-00094dd0: 656c 662e 7374 6163 6b56 666c 635b 305d  elf.stackVflc[0]
-00094de0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00094df0: 206e 203d 2073 656c 662e 7374 6163 6b56   n = self.stackV
-00094e00: 666c 635b 315d 0a20 2020 2020 2020 2020  flc[1].         
-00094e10: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-00094e20: 616e 6365 2873 2c20 6c69 7374 2920 616e  ance(s, list) an
-00094e30: 6420 6e6f 7420 6973 696e 7374 616e 6365  d not isinstance
-00094e40: 286e 2c20 6c69 7374 293a 0a20 2020 2020  (n, list):.     
-00094e50: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00094e60: 6620 7365 6c66 2e5f 5f63 7572 5f76 666c  f self.__cur_vfl
-00094e70: 635f 6f70 5f63 6f64 6520 3d3d 2027 2b27  c_op_code == '+'
-00094e80: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00094e90: 2020 2020 2020 2020 2020 7365 6c66 2e65            self.e
-00094ea0: 7661 6c75 6174 655b 7365 6c66 2e5f 5f63  valuate[self.__c
-00094eb0: 7572 5f73 796d 626f 6c5f 6e61 6d65 5d20  ur_symbol_name] 
-00094ec0: 3d20 5b5f 7320 2b20 6e20 666f 7220 5f73  = [_s + n for _s
-00094ed0: 2069 6e20 735d 0a20 2020 2020 2020 2020   in s].         
-00094ee0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00094ef0: 7365 6c66 2e5f 5f63 7572 5f76 666c 635f  self.__cur_vflc_
-00094f00: 6f70 5f63 6f64 6520 3d3d 2027 2d27 3a0a  op_code == '-':.
-00094f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00094f20: 2020 2020 2020 2020 7365 6c66 2e65 7661          self.eva
-00094f30: 6c75 6174 655b 7365 6c66 2e5f 5f63 7572  luate[self.__cur
-00094f40: 5f73 796d 626f 6c5f 6e61 6d65 5d20 3d20  _symbol_name] = 
-00094f50: 5b5f 7320 2d20 6e20 666f 7220 5f73 2069  [_s - n for _s i
-00094f60: 6e20 735d 0a20 2020 2020 2020 2020 2020  n s].           
-00094f70: 2020 2020 2020 2020 2065 6c69 6620 7365           elif se
-00094f80: 6c66 2e5f 5f63 7572 5f76 666c 635f 6f70  lf.__cur_vflc_op
-00094f90: 5f63 6f64 6520 3d3d 2027 2a27 3a0a 2020  _code == '*':.  
-00094fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00094fb0: 2020 2020 2020 7365 6c66 2e65 7661 6c75        self.evalu
-00094fc0: 6174 655b 7365 6c66 2e5f 5f63 7572 5f73  ate[self.__cur_s
-00094fd0: 796d 626f 6c5f 6e61 6d65 5d20 3d20 5b5f  ymbol_name] = [_
-00094fe0: 7320 2a20 6e20 666f 7220 5f73 2069 6e20  s * n for _s in 
-00094ff0: 735d 0a20 2020 2020 2020 2020 2020 2020  s].             
-00095000: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
-00095010: 2e5f 5f63 7572 5f76 666c 635f 6f70 5f63  .__cur_vflc_op_c
-00095020: 6f64 6520 3d3d 2027 2f27 3a0a 2020 2020  ode == '/':.    
-00095030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00095040: 2020 2020 7365 6c66 2e65 7661 6c75 6174      self.evaluat
-00095050: 655b 7365 6c66 2e5f 5f63 7572 5f73 796d  e[self.__cur_sym
-00095060: 626f 6c5f 6e61 6d65 5d20 3d20 5b5f 7320  bol_name] = [_s 
-00095070: 2f20 6e20 666f 7220 5f73 2069 6e20 735d  / n for _s in s]
-00095080: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00095090: 2020 2020 2065 6c69 6620 7365 6c66 2e5f       elif self._
-000950a0: 5f63 7572 5f76 666c 635f 6f70 5f63 6f64  _cur_vflc_op_cod
-000950b0: 6520 3d3d 2027 5e27 3a0a 2020 2020 2020  e == '^':.      
-000950c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000950d0: 2020 7365 6c66 2e65 7661 6c75 6174 655b    self.evaluate[
-000950e0: 7365 6c66 2e5f 5f63 7572 5f73 796d 626f  self.__cur_symbo
-000950f0: 6c5f 6e61 6d65 5d20 3d20 5b5f 7320 2a2a  l_name] = [_s **
-00095100: 206e 2066 6f72 205f 7320 696e 2073 5d0a   n for _s in s].
-00095110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00095120: 656c 6966 206e 6f74 2069 7369 6e73 7461  elif not isinsta
-00095130: 6e63 6528 732c 206c 6973 7429 2061 6e64  nce(s, list) and
-00095140: 2069 7369 6e73 7461 6e63 6528 6e2c 206c   isinstance(n, l
-00095150: 6973 7429 3a0a 2020 2020 2020 2020 2020  ist):.          
-00095160: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00095170: 662e 5f5f 6375 725f 7666 6c63 5f6f 705f  f.__cur_vflc_op_
-00095180: 636f 6465 203d 3d20 272b 273a 0a20 2020  code == '+':.   
-00095190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000951a0: 2020 2020 2073 656c 662e 6576 616c 7561       self.evalua
-000951b0: 7465 5b73 656c 662e 5f5f 6375 725f 7379  te[self.__cur_sy
-000951c0: 6d62 6f6c 5f6e 616d 655d 203d 205b 7320  mbol_name] = [s 
-000951d0: 2b20 5f6e 2066 6f72 205f 6e20 696e 206e  + _n for _n in n
-000951e0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-000951f0: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
-00095200: 5f5f 6375 725f 7666 6c63 5f6f 705f 636f  __cur_vflc_op_co
-00095210: 6465 203d 3d20 272d 273a 0a20 2020 2020  de == '-':.     
-00095220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00095230: 2020 2073 656c 662e 6576 616c 7561 7465     self.evaluate
-00095240: 5b73 656c 662e 5f5f 6375 725f 7379 6d62  [self.__cur_symb
-00095250: 6f6c 5f6e 616d 655d 203d 205b 7320 2d20  ol_name] = [s - 
-00095260: 5f6e 2066 6f72 205f 6e20 696e 206e 5d0a  _n for _n in n].
-00095270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00095280: 2020 2020 656c 6966 2073 656c 662e 5f5f      elif self.__
-00095290: 6375 725f 7666 6c63 5f6f 705f 636f 6465  cur_vflc_op_code
-000952a0: 203d 3d20 272a 273a 0a20 2020 2020 2020   == '*':.       
-000952b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000952c0: 2073 656c 662e 6576 616c 7561 7465 5b73   self.evaluate[s
-000952d0: 656c 662e 5f5f 6375 725f 7379 6d62 6f6c  elf.__cur_symbol
-000952e0: 5f6e 616d 655d 203d 205b 7320 2a20 5f6e  _name] = [s * _n
-000952f0: 2066 6f72 205f 6e20 696e 206e 5d0a 2020   for _n in n].  
-00095300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00095310: 2020 656c 6966 2073 656c 662e 5f5f 6375    elif self.__cu
-00095320: 725f 7666 6c63 5f6f 705f 636f 6465 203d  r_vflc_op_code =
-00095330: 3d20 272f 273a 0a20 2020 2020 2020 2020  = '/':.         
-00095340: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00095350: 656c 662e 6576 616c 7561 7465 5b73 656c  elf.evaluate[sel
-00095360: 662e 5f5f 6375 725f 7379 6d62 6f6c 5f6e  f.__cur_symbol_n
-00095370: 616d 655d 203d 205b 7320 2f20 5f6e 2066  ame] = [s / _n f
-00095380: 6f72 205f 6e20 696e 206e 5d0a 2020 2020  or _n in n].    
-00095390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000953a0: 656c 6966 2073 656c 662e 5f5f 6375 725f  elif self.__cur_
-000953b0: 7666 6c63 5f6f 705f 636f 6465 203d 3d20  vflc_op_code == 
-000953c0: 275e 273a 0a20 2020 2020 2020 2020 2020  '^':.           
-000953d0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-000953e0: 662e 6576 616c 7561 7465 5b73 656c 662e  f.evaluate[self.
-000953f0: 5f5f 6375 725f 7379 6d62 6f6c 5f6e 616d  __cur_symbol_nam
-00095400: 655d 203d 205b 7320 2a2a 205f 6e20 666f  e] = [s ** _n fo
-00095410: 7220 5f6e 2069 6e20 6e5d 0a20 2020 2020  r _n in n].     
-00095420: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00095430: 6973 696e 7374 616e 6365 2873 2c20 6c69  isinstance(s, li
-00095440: 7374 2920 616e 6420 6973 696e 7374 616e  st) and isinstan
-00095450: 6365 286e 2c20 6c69 7374 293a 0a20 2020  ce(n, list):.   
-00095460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00095470: 2069 6620 7365 6c66 2e5f 5f63 7572 5f76   if self.__cur_v
-00095480: 666c 635f 6f70 5f63 6f64 6520 3d3d 2027  flc_op_code == '
-00095490: 2b27 3a0a 2020 2020 2020 2020 2020 2020  +':.            
-000954a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000954b0: 2e65 7661 6c75 6174 655b 7365 6c66 2e5f  .evaluate[self._
-000954c0: 5f63 7572 5f73 796d 626f 6c5f 6e61 6d65  _cur_symbol_name
-000954d0: 5d20 3d20 5b5f 7320 2b20 5f6e 2066 6f72  ] = [_s + _n for
-000954e0: 205f 732c 205f 6e20 696e 207a 6970 2873   _s, _n in zip(s
-000954f0: 2c20 6e29 5d0a 2020 2020 2020 2020 2020  , n)].          
-00095500: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
-00095510: 656c 662e 5f5f 6375 725f 7666 6c63 5f6f  elf.__cur_vflc_o
-00095520: 705f 636f 6465 203d 3d20 272d 273a 0a20  p_code == '-':. 
-00095530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00095540: 2020 2020 2020 2073 656c 662e 6576 616c         self.eval
-00095550: 7561 7465 5b73 656c 662e 5f5f 6375 725f  uate[self.__cur_
-00095560: 7379 6d62 6f6c 5f6e 616d 655d 203d 205b  symbol_name] = [
-00095570: 5f73 202d 205f 6e20 666f 7220 5f73 2c20  _s - _n for _s, 
-00095580: 5f6e 2069 6e20 7a69 7028 732c 206e 295d  _n in zip(s, n)]
-00095590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000955a0: 2020 2020 2065 6c69 6620 7365 6c66 2e5f       elif self._
-000955b0: 5f63 7572 5f76 666c 635f 6f70 5f63 6f64  _cur_vflc_op_cod
-000955c0: 6520 3d3d 2027 2a27 3a0a 2020 2020 2020  e == '*':.      
-000955d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000955e0: 2020 7365 6c66 2e65 7661 6c75 6174 655b    self.evaluate[
-000955f0: 7365 6c66 2e5f 5f63 7572 5f73 796d 626f  self.__cur_symbo
-00095600: 6c5f 6e61 6d65 5d20 3d20 5b5f 7320 2a20  l_name] = [_s * 
-00095610: 5f6e 2066 6f72 205f 732c 205f 6e20 696e  _n for _s, _n in
-00095620: 207a 6970 2873 2c20 6e29 5d0a 2020 2020   zip(s, n)].    
-00095630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00095640: 656c 6966 2073 656c 662e 5f5f 6375 725f  elif self.__cur_
-00095650: 7666 6c63 5f6f 705f 636f 6465 203d 3d20  vflc_op_code == 
-00095660: 272f 273a 0a20 2020 2020 2020 2020 2020  '/':.           
-00095670: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00095680: 662e 6576 616c 7561 7465 5b73 656c 662e  f.evaluate[self.
-00095690: 5f5f 6375 725f 7379 6d62 6f6c 5f6e 616d  __cur_symbol_nam
-000956a0: 655d 203d 205b 5f73 202f 205f 6e20 666f  e] = [_s / _n fo
-000956b0: 7220 5f73 2c20 5f6e 2069 6e20 7a69 7028  r _s, _n in zip(
-000956c0: 732c 206e 295d 0a20 2020 2020 2020 2020  s, n)].         
-000956d0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-000956e0: 7365 6c66 2e5f 5f63 7572 5f76 666c 635f  self.__cur_vflc_
-000956f0: 6f70 5f63 6f64 6520 3d3d 2027 5e27 3a0a  op_code == '^':.
-00095700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00095710: 2020 2020 2020 2020 7365 6c66 2e65 7661          self.eva
-00095720: 6c75 6174 655b 7365 6c66 2e5f 5f63 7572  luate[self.__cur
-00095730: 5f73 796d 626f 6c5f 6e61 6d65 5d20 3d20  _symbol_name] = 
-00095740: 5b5f 7320 2a2a 205f 6e20 666f 7220 5f73  [_s ** _n for _s
-00095750: 2c20 5f6e 2069 6e20 7a69 7028 732c 206e  , _n in zip(s, n
-00095760: 295d 0a20 2020 2020 2020 2020 2020 2020  )].             
-00095770: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00095780: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00095790: 7365 6c66 2e5f 5f63 7572 5f76 666c 635f  self.__cur_vflc_
-000957a0: 6f70 5f63 6f64 6520 3d3d 2027 2b27 3a0a  op_code == '+':.
-000957b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000957c0: 2020 2020 2020 2020 7365 6c66 2e65 7661          self.eva
-000957d0: 6c75 6174 655b 7365 6c66 2e5f 5f63 7572  luate[self.__cur
-000957e0: 5f73 796d 626f 6c5f 6e61 6d65 5d20 3d20  _symbol_name] = 
-000957f0: 7320 2b20 6e0a 2020 2020 2020 2020 2020  s + n.          
-00095800: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
-00095810: 656c 662e 5f5f 6375 725f 7666 6c63 5f6f  elf.__cur_vflc_o
-00095820: 705f 636f 6465 203d 3d20 272d 273a 0a20  p_code == '-':. 
-00095830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00095840: 2020 2020 2020 2073 656c 662e 6576 616c         self.eval
-00095850: 7561 7465 5b73 656c 662e 5f5f 6375 725f  uate[self.__cur_
-00095860: 7379 6d62 6f6c 5f6e 616d 655d 203d 2073  symbol_name] = s
-00095870: 202d 206e 0a20 2020 2020 2020 2020 2020   - n.           
-00095880: 2020 2020 2020 2020 2065 6c69 6620 7365           elif se
-00095890: 6c66 2e5f 5f63 7572 5f76 666c 635f 6f70  lf.__cur_vflc_op
-000958a0: 5f63 6f64 6520 3d3d 2027 2a27 3a0a 2020  _code == '*':.  
-000958b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000958c0: 2020 2020 2020 7365 6c66 2e65 7661 6c75        self.evalu
-000958d0: 6174 655b 7365 6c66 2e5f 5f63 7572 5f73  ate[self.__cur_s
-000958e0: 796d 626f 6c5f 6e61 6d65 5d20 3d20 7320  ymbol_name] = s 
-000958f0: 2a20 6e0a 2020 2020 2020 2020 2020 2020  * n.            
-00095900: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
-00095910: 662e 5f5f 6375 725f 7666 6c63 5f6f 705f  f.__cur_vflc_op_
-00095920: 636f 6465 203d 3d20 272f 273a 0a20 2020  code == '/':.   
-00095930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00095940: 2020 2020 2073 656c 662e 6576 616c 7561       self.evalua
-00095950: 7465 5b73 656c 662e 5f5f 6375 725f 7379  te[self.__cur_sy
-00095960: 6d62 6f6c 5f6e 616d 655d 203d 2073 202f  mbol_name] = s /
-00095970: 206e 0a20 2020 2020 2020 2020 2020 2020   n.             
-00095980: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
-00095990: 2e5f 5f63 7572 5f76 666c 635f 6f70 5f63  .__cur_vflc_op_c
-000959a0: 6f64 6520 3d3d 2027 5e27 3a0a 2020 2020  ode == '^':.    
-000959b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000959c0: 2020 2020 7365 6c66 2e65 7661 6c75 6174      self.evaluat
-000959d0: 655b 7365 6c66 2e5f 5f63 7572 5f73 796d  e[self.__cur_sym
-000959e0: 626f 6c5f 6e61 6d65 5d20 3d20 7320 2a2a  bol_name] = s **
-000959f0: 206e 0a0a 2020 2020 2020 2020 7365 6c66   n..        self
-00095a00: 2e73 7461 636b 5666 6c63 2e63 6c65 6172  .stackVflc.clear
-00095a10: 2829 0a0a 2020 2020 2320 456e 7465 7220  ()..    # Enter 
-00095a20: 6120 7061 7273 6520 7472 6565 2070 726f  a parse tree pro
-00095a30: 6475 6365 6420 6279 2058 706c 6f72 4d52  duced by XplorMR
-00095a40: 5061 7273 6572 2365 7661 6c75 6174 655f  Parser#evaluate_
-00095a50: 6f70 6572 6174 696f 6e2e 0a20 2020 2064  operation..    d
-00095a60: 6566 2065 6e74 6572 4576 616c 7561 7465  ef enterEvaluate
-00095a70: 5f6f 7065 7261 7469 6f6e 2873 656c 662c  _operation(self,
-00095a80: 2063 7478 3a20 5870 6c6f 724d 5250 6172   ctx: XplorMRPar
-00095a90: 7365 722e 4576 616c 7561 7465 5f6f 7065  ser.Evaluate_ope
-00095aa0: 7261 7469 6f6e 436f 6e74 6578 7429 3a20  rationContext): 
-00095ab0: 2023 2070 796c 696e 743a 2064 6973 6162   # pylint: disab
-00095ac0: 6c65 3d75 6e75 7365 642d 6172 6775 6d65  le=unused-argume
-00095ad0: 6e74 0a20 2020 2020 2020 2070 6173 730a  nt.        pass.
-00095ae0: 0a20 2020 2023 2045 7869 7420 6120 7061  .    # Exit a pa
-00095af0: 7273 6520 7472 6565 2070 726f 6475 6365  rse tree produce
-00095b00: 6420 6279 2058 706c 6f72 4d52 5061 7273  d by XplorMRPars
-00095b10: 6572 2365 7661 6c75 6174 655f 6f70 6572  er#evaluate_oper
-00095b20: 6174 696f 6e2e 0a20 2020 2064 6566 2065  ation..    def e
-00095b30: 7869 7445 7661 6c75 6174 655f 6f70 6572  xitEvaluate_oper
-00095b40: 6174 696f 6e28 7365 6c66 2c20 6374 783a  ation(self, ctx:
-00095b50: 2058 706c 6f72 4d52 5061 7273 6572 2e45   XplorMRParser.E
-00095b60: 7661 6c75 6174 655f 6f70 6572 6174 696f  valuate_operatio
-00095b70: 6e43 6f6e 7465 7874 293a 0a20 2020 2020  nContext):.     
-00095b80: 2020 2069 6620 6374 782e 4164 645f 6f70     if ctx.Add_op
-00095b90: 5f56 4528 293a 0a20 2020 2020 2020 2020  _VE():.         
-00095ba0: 2020 2073 656c 662e 5f5f 6375 725f 7666     self.__cur_vf
-00095bb0: 6c63 5f6f 705f 636f 6465 203d 2027 2b27  lc_op_code = '+'
-00095bc0: 0a20 2020 2020 2020 2065 6c69 6620 6374  .        elif ct
-00095bd0: 782e 5375 625f 6f70 5f56 4528 293a 0a20  x.Sub_op_VE():. 
-00095be0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00095bf0: 5f5f 6375 725f 7666 6c63 5f6f 705f 636f  __cur_vflc_op_co
-00095c00: 6465 203d 2027 2d27 0a20 2020 2020 2020  de = '-'.       
-00095c10: 2065 6c69 6620 6374 782e 4d75 6c5f 6f70   elif ctx.Mul_op
-00095c20: 5f56 4528 293a 0a20 2020 2020 2020 2020  _VE():.         
-00095c30: 2020 2073 656c 662e 5f5f 6375 725f 7666     self.__cur_vf
-00095c40: 6c63 5f6f 705f 636f 6465 203d 2027 2a27  lc_op_code = '*'
-00095c50: 0a20 2020 2020 2020 2065 6c69 6620 6374  .        elif ct
-00095c60: 782e 4469 765f 6f70 5f56 4528 293a 0a20  x.Div_op_VE():. 
-00095c70: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00095c80: 5f5f 6375 725f 7666 6c63 5f6f 705f 636f  __cur_vflc_op_co
-00095c90: 6465 203d 2027 2f27 0a20 2020 2020 2020  de = '/'.       
-00095ca0: 2065 6c69 6620 6374 782e 4578 705f 6f70   elif ctx.Exp_op
-00095cb0: 5f56 4528 293a 0a20 2020 2020 2020 2020  _VE():.         
-00095cc0: 2020 2073 656c 662e 5f5f 6375 725f 7666     self.__cur_vf
-00095cd0: 6c63 5f6f 705f 636f 6465 203d 2027 5e27  lc_op_code = '^'
-00095ce0: 0a0a 2020 2020 2320 456e 7465 7220 6120  ..    # Enter a 
-00095cf0: 7061 7273 6520 7472 6565 2070 726f 6475  parse tree produ
-00095d00: 6365 6420 6279 2058 706c 6f72 4d52 5061  ced by XplorMRPa
-00095d10: 7273 6572 2370 6174 6368 5f73 7461 7465  rser#patch_state
-00095d20: 6d65 6e74 2e0a 2020 2020 6465 6620 656e  ment..    def en
-00095d30: 7465 7250 6174 6368 5f73 7461 7465 6d65  terPatch_stateme
-00095d40: 6e74 2873 656c 662c 2063 7478 3a20 5870  nt(self, ctx: Xp
-00095d50: 6c6f 724d 5250 6172 7365 722e 5061 7463  lorMRParser.Patc
-00095d60: 685f 7374 6174 656d 656e 7443 6f6e 7465  h_statementConte
-00095d70: 7874 293a 2020 2320 7079 6c69 6e74 3a20  xt):  # pylint: 
-00095d80: 6469 7361 626c 653d 756e 7573 6564 2d61  disable=unused-a
-00095d90: 7267 756d 656e 740a 2020 2020 2020 2020  rgument.        
-00095da0: 7365 6c66 2e67 656f 5265 7374 7261 696e  self.geoRestrain
-00095db0: 7473 202b 3d20 310a 2020 2020 2020 2020  ts += 1.        
-00095dc0: 7365 6c66 2e5f 5f63 7572 5f73 7562 7479  self.__cur_subty
-00095dd0: 7065 203d 2027 6765 6f27 0a0a 2020 2020  pe = 'geo'..    
-00095de0: 2020 2020 7365 6c66 2e61 746f 6d53 656c      self.atomSel
-00095df0: 6563 7469 6f6e 5365 742e 636c 6561 7228  ectionSet.clear(
-00095e00: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
-00095e10: 5f67 2e63 6c65 6172 2829 0a0a 2020 2020  _g.clear()..    
-00095e20: 2320 4578 6974 2061 2070 6172 7365 2074  # Exit a parse t
-00095e30: 7265 6520 7072 6f64 7563 6564 2062 7920  ree produced by 
-00095e40: 5870 6c6f 724d 5250 6172 7365 7223 7061  XplorMRParser#pa
-00095e50: 7463 685f 7374 6174 656d 656e 742e 0a20  tch_statement.. 
-00095e60: 2020 2064 6566 2065 7869 7450 6174 6368     def exitPatch
-00095e70: 5f73 7461 7465 6d65 6e74 2873 656c 662c  _statement(self,
-00095e80: 2063 7478 3a20 5870 6c6f 724d 5250 6172   ctx: XplorMRPar
-00095e90: 7365 722e 5061 7463 685f 7374 6174 656d  ser.Patch_statem
-00095ea0: 656e 7443 6f6e 7465 7874 293a 2020 2320  entContext):  # 
-00095eb0: 7079 6c69 6e74 3a20 6469 7361 626c 653d  pylint: disable=
-00095ec0: 756e 7573 6564 2d61 7267 756d 656e 740a  unused-argument.
-00095ed0: 2020 2020 2020 2020 7061 7373 0a0a 2020          pass..  
-00095ee0: 2020 2320 456e 7465 7220 6120 7061 7273    # Enter a pars
-00095ef0: 6520 7472 6565 2070 726f 6475 6365 6420  e tree produced 
-00095f00: 6279 2058 706c 6f72 4d52 5061 7273 6572  by XplorMRParser
-00095f10: 2370 6172 616d 6574 6572 5f73 6574 7469  #parameter_setti
-00095f20: 6e67 2e0a 2020 2020 6465 6620 656e 7465  ng..    def ente
-00095f30: 7250 6172 616d 6574 6572 5f73 6574 7469  rParameter_setti
-00095f40: 6e67 2873 656c 662c 2063 7478 3a20 5870  ng(self, ctx: Xp
-00095f50: 6c6f 724d 5250 6172 7365 722e 5061 7261  lorMRParser.Para
-00095f60: 6d65 7465 725f 7365 7474 696e 6743 6f6e  meter_settingCon
-00095f70: 7465 7874 293a 2020 2320 7079 6c69 6e74  text):  # pylint
-00095f80: 3a20 6469 7361 626c 653d 756e 7573 6564  : disable=unused
-00095f90: 2d61 7267 756d 656e 740a 2020 2020 2020  -argument.      
-00095fa0: 2020 7061 7373 0a0a 2020 2020 2320 4578    pass..    # Ex
-00095fb0: 6974 2061 2070 6172 7365 2074 7265 6520  it a parse tree 
-00095fc0: 7072 6f64 7563 6564 2062 7920 5870 6c6f  produced by Xplo
-00095fd0: 724d 5250 6172 7365 7223 7061 7261 6d65  rMRParser#parame
-00095fe0: 7465 725f 7365 7474 696e 672e 0a20 2020  ter_setting..   
-00095ff0: 2064 6566 2065 7869 7450 6172 616d 6574   def exitParamet
-00096000: 6572 5f73 6574 7469 6e67 2873 656c 662c  er_setting(self,
-00096010: 2063 7478 3a20 5870 6c6f 724d 5250 6172   ctx: XplorMRPar
-00096020: 7365 722e 5061 7261 6d65 7465 725f 7365  ser.Parameter_se
-00096030: 7474 696e 6743 6f6e 7465 7874 293a 2020  ttingContext):  
-00096040: 2320 7079 6c69 6e74 3a20 6469 7361 626c  # pylint: disabl
-00096050: 653d 756e 7573 6564 2d61 7267 756d 656e  e=unused-argumen
-00096060: 740a 2020 2020 2020 2020 7061 7373 0a0a  t.        pass..
-00096070: 2020 2020 2320 456e 7465 7220 6120 7061      # Enter a pa
-00096080: 7273 6520 7472 6565 2070 726f 6475 6365  rse tree produce
-00096090: 6420 6279 2058 706c 6f72 4d52 5061 7273  d by XplorMRPars
-000960a0: 6572 2370 6172 616d 6574 6572 5f73 7461  er#parameter_sta
-000960b0: 7465 6d65 6e74 2e0a 2020 2020 6465 6620  tement..    def 
-000960c0: 656e 7465 7250 6172 616d 6574 6572 5f73  enterParameter_s
-000960d0: 7461 7465 6d65 6e74 2873 656c 662c 2063  tatement(self, c
-000960e0: 7478 3a20 5870 6c6f 724d 5250 6172 7365  tx: XplorMRParse
-000960f0: 722e 5061 7261 6d65 7465 725f 7374 6174  r.Parameter_stat
-00096100: 656d 656e 7443 6f6e 7465 7874 293a 2020  ementContext):  
-00096110: 2320 7079 6c69 6e74 3a20 6469 7361 626c  # pylint: disabl
-00096120: 653d 756e 7573 6564 2d61 7267 756d 656e  e=unused-argumen
-00096130: 740a 2020 2020 2020 2020 7365 6c66 2e67  t.        self.g
-00096140: 656f 5265 7374 7261 696e 7473 202b 3d20  eoRestraints += 
-00096150: 310a 2020 2020 2020 2020 7365 6c66 2e5f  1.        self._
-00096160: 5f63 7572 5f73 7562 7479 7065 203d 2027  _cur_subtype = '
-00096170: 6765 6f27 0a0a 2020 2020 2320 4578 6974  geo'..    # Exit
-00096180: 2061 2070 6172 7365 2074 7265 6520 7072   a parse tree pr
-00096190: 6f64 7563 6564 2062 7920 5870 6c6f 724d  oduced by XplorM
-000961a0: 5250 6172 7365 7223 7061 7261 6d65 7465  RParser#paramete
-000961b0: 725f 7374 6174 656d 656e 742e 0a20 2020  r_statement..   
-000961c0: 2064 6566 2065 7869 7450 6172 616d 6574   def exitParamet
-000961d0: 6572 5f73 7461 7465 6d65 6e74 2873 656c  er_statement(sel
-000961e0: 662c 2063 7478 3a20 5870 6c6f 724d 5250  f, ctx: XplorMRP
-000961f0: 6172 7365 722e 5061 7261 6d65 7465 725f  arser.Parameter_
-00096200: 7374 6174 656d 656e 7443 6f6e 7465 7874  statementContext
-00096210: 293a 2020 2320 7079 6c69 6e74 3a20 6469  ):  # pylint: di
-00096220: 7361 626c 653d 756e 7573 6564 2d61 7267  sable=unused-arg
-00096230: 756d 656e 740a 2020 2020 2020 2020 7061  ument.        pa
-00096240: 7373 0a0a 2020 2020 2320 456e 7465 7220  ss..    # Enter 
-00096250: 6120 7061 7273 6520 7472 6565 2070 726f  a parse tree pro
-00096260: 6475 6365 6420 6279 2058 706c 6f72 4d52  duced by XplorMR
-00096270: 5061 7273 6572 236e 6f65 5f61 7373 6967  Parser#noe_assig
-00096280: 6e5f 6c6f 6f70 2e0a 2020 2020 6465 6620  n_loop..    def 
-00096290: 656e 7465 724e 6f65 5f61 7373 6967 6e5f  enterNoe_assign_
-000962a0: 6c6f 6f70 2873 656c 662c 2063 7478 3a20  loop(self, ctx: 
-000962b0: 5870 6c6f 724d 5250 6172 7365 722e 4e6f  XplorMRParser.No
-000962c0: 655f 6173 7369 676e 5f6c 6f6f 7043 6f6e  e_assign_loopCon
-000962d0: 7465 7874 293a 0a20 2020 2020 2020 2073  text):.        s
-000962e0: 796d 626f 6c5f 6e61 6d65 203d 204e 6f6e  ymbol_name = Non
-000962f0: 650a 2020 2020 2020 2020 6966 2063 7478  e.        if ctx
-00096300: 2e53 796d 626f 6c5f 6e61 6d65 5f43 4628  .Symbol_name_CF(
-00096310: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
-00096320: 796d 626f 6c5f 6e61 6d65 203d 2073 7472  ymbol_name = str
-00096330: 2863 7478 2e53 796d 626f 6c5f 6e61 6d65  (ctx.Symbol_name
-00096340: 5f43 4628 2929 0a0a 2020 2020 2020 2020  _CF())..        
-00096350: 6966 2063 7478 2e49 6e74 6567 6572 5f43  if ctx.Integer_C
-00096360: 4628 3029 3a0a 2020 2020 2020 2020 2020  F(0):.          
-00096370: 2020 696e 745f 6c69 7374 203d 205b 5d0a    int_list = [].
-00096380: 2020 2020 2020 2020 2020 2020 6964 7820              idx 
-00096390: 3d20 300a 2020 2020 2020 2020 2020 2020  = 0.            
-000963a0: 7768 696c 6520 5472 7565 3a0a 2020 2020  while True:.    
-000963b0: 2020 2020 2020 2020 2020 2020 6966 2063              if c
-000963c0: 7478 2e49 6e74 6567 6572 5f43 4628 6964  tx.Integer_CF(id
-000963d0: 7829 3a0a 2020 2020 2020 2020 2020 2020  x):.            
-000963e0: 2020 2020 2020 2020 696e 745f 6c69 7374          int_list
-000963f0: 2e61 7070 656e 6428 696e 7428 7374 7228  .append(int(str(
-00096400: 6374 782e 496e 7465 6765 725f 4346 2869  ctx.Integer_CF(i
-00096410: 6478 2929 2929 0a20 2020 2020 2020 2020  dx)))).         
-00096420: 2020 2020 2020 2020 2020 2069 6478 202b             idx +
-00096430: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
-00096440: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00096450: 2020 2020 2020 2020 2020 2020 2020 6272                br
-00096460: 6561 6b0a 2020 2020 2020 2020 2020 2020  eak.            
-00096470: 6966 2073 796d 626f 6c5f 6e61 6d65 2069  if symbol_name i
-00096480: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-00096490: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000964a0: 2e65 7661 6c75 6174 6546 6f72 5b73 796d  .evaluateFor[sym
-000964b0: 626f 6c5f 6e61 6d65 5d20 3d20 696e 745f  bol_name] = int_
-000964c0: 6c69 7374 0a0a 2020 2020 2020 2020 6966  list..        if
-000964d0: 2063 7478 2e52 6561 6c5f 4346 2830 293a   ctx.Real_CF(0):
-000964e0: 0a20 2020 2020 2020 2020 2020 2072 6561  .            rea
-000964f0: 6c5f 6c69 7374 203d 205b 5d0a 2020 2020  l_list = [].    
-00096500: 2020 2020 2020 2020 6964 7820 3d20 300a          idx = 0.
-00096510: 2020 2020 2020 2020 2020 2020 7768 696c              whil
-00096520: 6520 5472 7565 3a0a 2020 2020 2020 2020  e True:.        
-00096530: 2020 2020 2020 2020 6966 2063 7478 2e52          if ctx.R
-00096540: 6561 6c5f 4346 2869 6478 293a 0a20 2020  eal_CF(idx):.   
-00096550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00096560: 2072 6561 6c5f 6c69 7374 2e61 7070 656e   real_list.appen
-00096570: 6428 666c 6f61 7428 7374 7228 6374 782e  d(float(str(ctx.
-00096580: 5265 616c 5f43 4628 6964 7829 2929 290a  Real_CF(idx)))).
-00096590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000965a0: 2020 2020 6964 7820 2b3d 2031 0a20 2020      idx += 1.   
-000965b0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-000965c0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000965d0: 2020 2020 2020 2062 7265 616b 0a20 2020         break.   
-000965e0: 2020 2020 2020 2020 2069 6620 7379 6d62           if symb
-000965f0: 6f6c 5f6e 616d 655b 305d 2069 7320 6e6f  ol_name[0] is no
-00096600: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00096610: 2020 2020 2020 2020 7365 6c66 2e65 7661          self.eva
-00096620: 6c75 6174 6546 6f72 5b73 796d 626f 6c5f  luateFor[symbol_
-00096630: 6e61 6d65 5d20 3d20 7265 616c 5f6c 6973  name] = real_lis
-00096640: 740a 0a20 2020 2020 2020 2069 6620 6374  t..        if ct
-00096650: 782e 5369 6d70 6c65 5f6e 616d 655f 4346  x.Simple_name_CF
-00096660: 2830 293a 0a20 2020 2020 2020 2020 2020  (0):.           
-00096670: 2073 7472 5f6c 6973 7420 3d20 5b5d 0a20   str_list = []. 
-00096680: 2020 2020 2020 2020 2020 2069 6478 203d             idx =
-00096690: 2030 0a20 2020 2020 2020 2020 2020 2077   0.            w
-000966a0: 6869 6c65 2054 7275 653a 0a20 2020 2020  hile True:.     
-000966b0: 2020 2020 2020 2020 2020 2069 6620 6374             if ct
-000966c0: 782e 5369 6d70 6c65 5f6e 616d 655f 4346  x.Simple_name_CF
-000966d0: 2869 6478 293a 0a20 2020 2020 2020 2020  (idx):.         
-000966e0: 2020 2020 2020 2020 2020 2073 7472 5f6c             str_l
-000966f0: 6973 742e 6170 7065 6e64 2873 7472 2863  ist.append(str(c
-00096700: 7478 2e53 696d 706c 655f 6e61 6d65 5f43  tx.Simple_name_C
-00096710: 4628 6964 7829 2929 0a20 2020 2020 2020  F(idx))).       
-00096720: 2020 2020 2020 2020 2020 2020 2069 6478               idx
-00096730: 202b 3d20 310a 2020 2020 2020 2020 2020   += 1.          
-00096740: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00096750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00096760: 6272 6561 6b0a 2020 2020 2020 2020 2020  break.          
-00096770: 2020 6966 2073 796d 626f 6c5f 6e61 6d65    if symbol_name
-00096780: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-00096790: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000967a0: 6c66 2e65 7661 6c75 6174 6546 6f72 5b73  lf.evaluateFor[s
-000967b0: 796d 626f 6c5f 6e61 6d65 5d20 3d20 7374  ymbol_name] = st
-000967c0: 725f 6c69 7374 0a0a 2020 2020 2320 4578  r_list..    # Ex
-000967d0: 6974 2061 2070 6172 7365 2074 7265 6520  it a parse tree 
-000967e0: 7072 6f64 7563 6564 2062 7920 5870 6c6f  produced by Xplo
-000967f0: 724d 5250 6172 7365 7223 6e6f 655f 6173  rMRParser#noe_as
-00096800: 7369 676e 5f6c 6f6f 702e 0a20 2020 2064  sign_loop..    d
-00096810: 6566 2065 7869 744e 6f65 5f61 7373 6967  ef exitNoe_assig
-00096820: 6e5f 6c6f 6f70 2873 656c 662c 2063 7478  n_loop(self, ctx
-00096830: 3a20 5870 6c6f 724d 5250 6172 7365 722e  : XplorMRParser.
-00096840: 4e6f 655f 6173 7369 676e 5f6c 6f6f 7043  Noe_assign_loopC
-00096850: 6f6e 7465 7874 293a 0a20 2020 2020 2020  ontext):.       
-00096860: 2069 6620 6374 782e 5379 6d62 6f6c 5f6e   if ctx.Symbol_n
-00096870: 616d 655f 4346 2829 3a0a 2020 2020 2020  ame_CF():.      
-00096880: 2020 2020 2020 7379 6d62 6f6c 5f6e 616d        symbol_nam
-00096890: 6520 3d20 7374 7228 6374 782e 5379 6d62  e = str(ctx.Symb
-000968a0: 6f6c 5f6e 616d 655f 4346 2829 290a 2020  ol_name_CF()).  
-000968b0: 2020 2020 2020 2020 2020 6966 2073 796d            if sym
-000968c0: 626f 6c5f 6e61 6d65 2069 6e20 7365 6c66  bol_name in self
-000968d0: 2e65 7661 6c75 6174 6546 6f72 3a0a 2020  .evaluateFor:.  
-000968e0: 2020 2020 2020 2020 2020 2020 2020 6465                de
-000968f0: 6c20 7365 6c66 2e65 7661 6c75 6174 6546  l self.evaluateF
-00096900: 6f72 5b73 796d 626f 6c5f 6e61 6d65 5d0a  or[symbol_name].
-00096910: 0a20 2020 2023 2045 6e74 6572 2061 2070  .    # Enter a p
-00096920: 6172 7365 2074 7265 6520 7072 6f64 7563  arse tree produc
-00096930: 6564 2062 7920 5870 6c6f 724d 5250 6172  ed by XplorMRPar
-00096940: 7365 7223 6469 6865 6472 616c 5f61 7373  ser#dihedral_ass
-00096950: 6967 6e5f 6c6f 6f70 2e0a 2020 2020 6465  ign_loop..    de
-00096960: 6620 656e 7465 7244 6968 6564 7261 6c5f  f enterDihedral_
-00096970: 6173 7369 676e 5f6c 6f6f 7028 7365 6c66  assign_loop(self
-00096980: 2c20 6374 783a 2058 706c 6f72 4d52 5061  , ctx: XplorMRPa
-00096990: 7273 6572 2e44 6968 6564 7261 6c5f 6173  rser.Dihedral_as
-000969a0: 7369 676e 5f6c 6f6f 7043 6f6e 7465 7874  sign_loopContext
-000969b0: 293a 0a20 2020 2020 2020 2073 796d 626f  ):.        symbo
-000969c0: 6c5f 6e61 6d65 203d 204e 6f6e 650a 2020  l_name = None.  
-000969d0: 2020 2020 2020 6966 2063 7478 2e53 796d        if ctx.Sym
-000969e0: 626f 6c5f 6e61 6d65 5f43 4628 293a 0a20  bol_name_CF():. 
-000969f0: 2020 2020 2020 2020 2020 2073 796d 626f             symbo
-00096a00: 6c5f 6e61 6d65 203d 2073 7472 2863 7478  l_name = str(ctx
-00096a10: 2e53 796d 626f 6c5f 6e61 6d65 5f43 4628  .Symbol_name_CF(
-00096a20: 2929 0a0a 2020 2020 2020 2020 6966 2063  ))..        if c
-00096a30: 7478 2e49 6e74 6567 6572 5f43 4628 3029  tx.Integer_CF(0)
-00096a40: 3a0a 2020 2020 2020 2020 2020 2020 696e  :.            in
-00096a50: 745f 6c69 7374 203d 205b 5d0a 2020 2020  t_list = [].    
-00096a60: 2020 2020 2020 2020 6964 7820 3d20 300a          idx = 0.
-00096a70: 2020 2020 2020 2020 2020 2020 7768 696c              whil
-00096a80: 6520 5472 7565 3a0a 2020 2020 2020 2020  e True:.        
-00096a90: 2020 2020 2020 2020 6966 2063 7478 2e49          if ctx.I
-00096aa0: 6e74 6567 6572 5f43 4628 6964 7829 3a0a  nteger_CF(idx):.
-00096ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00096ac0: 2020 2020 696e 745f 6c69 7374 2e61 7070      int_list.app
-00096ad0: 656e 6428 696e 7428 7374 7228 6374 782e  end(int(str(ctx.
-00096ae0: 496e 7465 6765 725f 4346 2869 6478 2929  Integer_CF(idx))
-00096af0: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
-00096b00: 2020 2020 2020 2069 6478 202b 3d20 310a         idx += 1.
-00096b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00096b20: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00096b30: 2020 2020 2020 2020 2020 6272 6561 6b0a            break.
-00096b40: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00096b50: 796d 626f 6c5f 6e61 6d65 2069 7320 6e6f  ymbol_name is no
-00096b60: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00096b70: 2020 2020 2020 2020 7365 6c66 2e65 7661          self.eva
-00096b80: 6c75 6174 6546 6f72 5b73 796d 626f 6c5f  luateFor[symbol_
-00096b90: 6e61 6d65 5d20 3d20 696e 745f 6c69 7374  name] = int_list
-00096ba0: 0a0a 2020 2020 2020 2020 6966 2063 7478  ..        if ctx
-00096bb0: 2e52 6561 6c5f 4346 2830 293a 0a20 2020  .Real_CF(0):.   
-00096bc0: 2020 2020 2020 2020 2072 6561 6c5f 6c69           real_li
-00096bd0: 7374 203d 205b 5d0a 2020 2020 2020 2020  st = [].        
-00096be0: 2020 2020 6964 7820 3d20 300a 2020 2020      idx = 0.    
-00096bf0: 2020 2020 2020 2020 7768 696c 6520 5472          while Tr
-00096c00: 7565 3a0a 2020 2020 2020 2020 2020 2020  ue:.            
-00096c10: 2020 2020 6966 2063 7478 2e52 6561 6c5f      if ctx.Real_
-00096c20: 4346 2869 6478 293a 0a20 2020 2020 2020  CF(idx):.       
-00096c30: 2020 2020 2020 2020 2020 2020 2072 6561               rea
-00096c40: 6c5f 6c69 7374 2e61 7070 656e 6428 666c  l_list.append(fl
-00096c50: 6f61 7428 7374 7228 6374 782e 5265 616c  oat(str(ctx.Real
-00096c60: 5f43 4628 6964 7829 2929 290a 2020 2020  _CF(idx)))).    
-00096c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00096c80: 6964 7820 2b3d 2031 0a20 2020 2020 2020  idx += 1.       
-00096c90: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00096ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00096cb0: 2020 2062 7265 616b 0a20 2020 2020 2020     break.       
-00096cc0: 2020 2020 2069 6620 7379 6d62 6f6c 5f6e       if symbol_n
-00096cd0: 616d 655b 305d 2069 7320 6e6f 7420 4e6f  ame[0] is not No
-00096ce0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00096cf0: 2020 2020 7365 6c66 2e65 7661 6c75 6174      self.evaluat
-00096d00: 6546 6f72 5b73 796d 626f 6c5f 6e61 6d65  eFor[symbol_name
-00096d10: 5d20 3d20 7265 616c 5f6c 6973 740a 0a20  ] = real_list.. 
-00096d20: 2020 2020 2020 2069 6620 6374 782e 5369         if ctx.Si
-00096d30: 6d70 6c65 5f6e 616d 655f 4346 2830 293a  mple_name_CF(0):
-00096d40: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
-00096d50: 5f6c 6973 7420 3d20 5b5d 0a20 2020 2020  _list = [].     
-00096d60: 2020 2020 2020 2069 6478 203d 2030 0a20         idx = 0. 
-00096d70: 2020 2020 2020 2020 2020 2077 6869 6c65             while
-00096d80: 2054 7275 653a 0a20 2020 2020 2020 2020   True:.         
-00096d90: 2020 2020 2020 2069 6620 6374 782e 5369         if ctx.Si
-00096da0: 6d70 6c65 5f6e 616d 655f 4346 2869 6478  mple_name_CF(idx
-00096db0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00096dc0: 2020 2020 2020 2073 7472 5f6c 6973 742e         str_list.
-00096dd0: 6170 7065 6e64 2873 7472 2863 7478 2e53  append(str(ctx.S
-00096de0: 696d 706c 655f 6e61 6d65 5f43 4628 6964  imple_name_CF(id
-00096df0: 7829 2929 0a20 2020 2020 2020 2020 2020  x))).           
-00096e00: 2020 2020 2020 2020 2069 6478 202b 3d20           idx += 
-00096e10: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
-00096e20: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00096e30: 2020 2020 2020 2020 2020 2020 6272 6561              brea
-00096e40: 6b0a 2020 2020 2020 2020 2020 2020 6966  k.            if
-00096e50: 2073 796d 626f 6c5f 6e61 6d65 2069 7320   symbol_name is 
-00096e60: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-00096e70: 2020 2020 2020 2020 2020 7365 6c66 2e65            self.e
-00096e80: 7661 6c75 6174 6546 6f72 5b73 796d 626f  valuateFor[symbo
-00096e90: 6c5f 6e61 6d65 5d20 3d20 7374 725f 6c69  l_name] = str_li
-00096ea0: 7374 0a0a 2020 2020 2320 4578 6974 2061  st..    # Exit a
-00096eb0: 2070 6172 7365 2074 7265 6520 7072 6f64   parse tree prod
-00096ec0: 7563 6564 2062 7920 5870 6c6f 724d 5250  uced by XplorMRP
-00096ed0: 6172 7365 7223 6469 6865 6472 616c 5f61  arser#dihedral_a
-00096ee0: 7373 6967 6e5f 6c6f 6f70 2e0a 2020 2020  ssign_loop..    
-00096ef0: 6465 6620 6578 6974 4469 6865 6472 616c  def exitDihedral
-00096f00: 5f61 7373 6967 6e5f 6c6f 6f70 2873 656c  _assign_loop(sel
-00096f10: 662c 2063 7478 3a20 5870 6c6f 724d 5250  f, ctx: XplorMRP
-00096f20: 6172 7365 722e 4469 6865 6472 616c 5f61  arser.Dihedral_a
-00096f30: 7373 6967 6e5f 6c6f 6f70 436f 6e74 6578  ssign_loopContex
-00096f40: 7429 3a0a 2020 2020 2020 2020 6966 2063  t):.        if c
-00096f50: 7478 2e53 796d 626f 6c5f 6e61 6d65 5f43  tx.Symbol_name_C
-00096f60: 4628 293a 0a20 2020 2020 2020 2020 2020  F():.           
-00096f70: 2073 796d 626f 6c5f 6e61 6d65 203d 2073   symbol_name = s
-00096f80: 7472 2863 7478 2e53 796d 626f 6c5f 6e61  tr(ctx.Symbol_na
-00096f90: 6d65 5f43 4628 2929 0a20 2020 2020 2020  me_CF()).       
-00096fa0: 2020 2020 2069 6620 7379 6d62 6f6c 5f6e       if symbol_n
-00096fb0: 616d 6520 696e 2073 656c 662e 6576 616c  ame in self.eval
-00096fc0: 7561 7465 466f 723a 0a20 2020 2020 2020  uateFor:.       
-00096fd0: 2020 2020 2020 2020 2064 656c 2073 656c           del sel
-00096fe0: 662e 6576 616c 7561 7465 466f 725b 7379  f.evaluateFor[sy
-00096ff0: 6d62 6f6c 5f6e 616d 655d 0a0a 2020 2020  mbol_name]..    
-00097000: 2320 456e 7465 7220 6120 7061 7273 6520  # Enter a parse 
-00097010: 7472 6565 2070 726f 6475 6365 6420 6279  tree produced by
-00097020: 2058 706c 6f72 4d52 5061 7273 6572 2373   XplorMRParser#s
-00097030: 616e 695f 6173 7369 676e 5f6c 6f6f 702e  ani_assign_loop.
-00097040: 0a20 2020 2064 6566 2065 6e74 6572 5361  .    def enterSa
-00097050: 6e69 5f61 7373 6967 6e5f 6c6f 6f70 2873  ni_assign_loop(s
-00097060: 656c 662c 2063 7478 3a20 5870 6c6f 724d  elf, ctx: XplorM
-00097070: 5250 6172 7365 722e 5361 6e69 5f61 7373  RParser.Sani_ass
-00097080: 6967 6e5f 6c6f 6f70 436f 6e74 6578 7429  ign_loopContext)
-00097090: 3a0a 2020 2020 2020 2020 7379 6d62 6f6c  :.        symbol
-000970a0: 5f6e 616d 6520 3d20 4e6f 6e65 0a20 2020  _name = None.   
-000970b0: 2020 2020 2069 6620 6374 782e 5379 6d62       if ctx.Symb
-000970c0: 6f6c 5f6e 616d 655f 4346 2829 3a0a 2020  ol_name_CF():.  
-000970d0: 2020 2020 2020 2020 2020 7379 6d62 6f6c            symbol
-000970e0: 5f6e 616d 6520 3d20 7374 7228 6374 782e  _name = str(ctx.
-000970f0: 5379 6d62 6f6c 5f6e 616d 655f 4346 2829  Symbol_name_CF()
-00097100: 290a 0a20 2020 2020 2020 2069 6620 6374  )..        if ct
-00097110: 782e 496e 7465 6765 725f 4346 2830 293a  x.Integer_CF(0):
-00097120: 0a20 2020 2020 2020 2020 2020 2069 6e74  .            int
-00097130: 5f6c 6973 7420 3d20 5b5d 0a20 2020 2020  _list = [].     
-00097140: 2020 2020 2020 2069 6478 203d 2030 0a20         idx = 0. 
-00097150: 2020 2020 2020 2020 2020 2077 6869 6c65             while
-00097160: 2054 7275 653a 0a20 2020 2020 2020 2020   True:.         
-00097170: 2020 2020 2020 2069 6620 6374 782e 496e         if ctx.In
-00097180: 7465 6765 725f 4346 2869 6478 293a 0a20  teger_CF(idx):. 
-00097190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000971a0: 2020 2069 6e74 5f6c 6973 742e 6170 7065     int_list.appe
-000971b0: 6e64 2869 6e74 2873 7472 2863 7478 2e49  nd(int(str(ctx.I
-000971c0: 6e74 6567 6572 5f43 4628 6964 7829 2929  nteger_CF(idx)))
-000971d0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000971e0: 2020 2020 2020 6964 7820 2b3d 2031 0a20        idx += 1. 
-000971f0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00097200: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00097210: 2020 2020 2020 2020 2062 7265 616b 0a20           break. 
-00097220: 2020 2020 2020 2020 2020 2069 6620 7379             if sy
-00097230: 6d62 6f6c 5f6e 616d 6520 6973 206e 6f74  mbol_name is not
-00097240: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00097250: 2020 2020 2020 2073 656c 662e 6576 616c         self.eval
-00097260: 7561 7465 466f 725b 7379 6d62 6f6c 5f6e  uateFor[symbol_n
-00097270: 616d 655d 203d 2069 6e74 5f6c 6973 740a  ame] = int_list.
-00097280: 0a20 2020 2020 2020 2069 6620 6374 782e  .        if ctx.
-00097290: 5265 616c 5f43 4628 3029 3a0a 2020 2020  Real_CF(0):.    
-000972a0: 2020 2020 2020 2020 7265 616c 5f6c 6973          real_lis
-000972b0: 7420 3d20 5b5d 0a20 2020 2020 2020 2020  t = [].         
-000972c0: 2020 2069 6478 203d 2030 0a20 2020 2020     idx = 0.     
-000972d0: 2020 2020 2020 2077 6869 6c65 2054 7275         while Tru
-000972e0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000972f0: 2020 2069 6620 6374 782e 5265 616c 5f43     if ctx.Real_C
-00097300: 4628 6964 7829 3a0a 2020 2020 2020 2020  F(idx):.        
-00097310: 2020 2020 2020 2020 2020 2020 7265 616c              real
-00097320: 5f6c 6973 742e 6170 7065 6e64 2866 6c6f  _list.append(flo
-00097330: 6174 2873 7472 2863 7478 2e52 6561 6c5f  at(str(ctx.Real_
-00097340: 4346 2869 6478 2929 2929 0a20 2020 2020  CF(idx)))).     
-00097350: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00097360: 6478 202b 3d20 310a 2020 2020 2020 2020  dx += 1.        
-00097370: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00097380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00097390: 2020 6272 6561 6b0a 2020 2020 2020 2020    break.        
-000973a0: 2020 2020 6966 2073 796d 626f 6c5f 6e61      if symbol_na
-000973b0: 6d65 5b30 5d20 6973 206e 6f74 204e 6f6e  me[0] is not Non
-000973c0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000973d0: 2020 2073 656c 662e 6576 616c 7561 7465     self.evaluate
-000973e0: 466f 725b 7379 6d62 6f6c 5f6e 616d 655d  For[symbol_name]
-000973f0: 203d 2072 6561 6c5f 6c69 7374 0a0a 2020   = real_list..  
-00097400: 2020 2020 2020 6966 2063 7478 2e53 696d        if ctx.Sim
-00097410: 706c 655f 6e61 6d65 5f43 4628 3029 3a0a  ple_name_CF(0):.
-00097420: 2020 2020 2020 2020 2020 2020 7374 725f              str_
-00097430: 6c69 7374 203d 205b 5d0a 2020 2020 2020  list = [].      
-00097440: 2020 2020 2020 6964 7820 3d20 300a 2020        idx = 0.  
-00097450: 2020 2020 2020 2020 2020 7768 696c 6520            while 
-00097460: 5472 7565 3a0a 2020 2020 2020 2020 2020  True:.          
-00097470: 2020 2020 2020 6966 2063 7478 2e53 696d        if ctx.Sim
-00097480: 706c 655f 6e61 6d65 5f43 4628 6964 7829  ple_name_CF(idx)
-00097490: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000974a0: 2020 2020 2020 7374 725f 6c69 7374 2e61        str_list.a
-000974b0: 7070 656e 6428 7374 7228 6374 782e 5369  ppend(str(ctx.Si
-000974c0: 6d70 6c65 5f6e 616d 655f 4346 2869 6478  mple_name_CF(idx
-000974d0: 2929 290a 2020 2020 2020 2020 2020 2020  ))).            
-000974e0: 2020 2020 2020 2020 6964 7820 2b3d 2031          idx += 1
-000974f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00097500: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00097510: 2020 2020 2020 2020 2020 2062 7265 616b             break
-00097520: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00097530: 7379 6d62 6f6c 5f6e 616d 6520 6973 206e  symbol_name is n
-00097540: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-00097550: 2020 2020 2020 2020 2073 656c 662e 6576           self.ev
-00097560: 616c 7561 7465 466f 725b 7379 6d62 6f6c  aluateFor[symbol
-00097570: 5f6e 616d 655d 203d 2073 7472 5f6c 6973  _name] = str_lis
-00097580: 740a 0a20 2020 2023 2045 7869 7420 6120  t..    # Exit a 
-00097590: 7061 7273 6520 7472 6565 2070 726f 6475  parse tree produ
-000975a0: 6365 6420 6279 2058 706c 6f72 4d52 5061  ced by XplorMRPa
-000975b0: 7273 6572 2373 616e 695f 6173 7369 676e  rser#sani_assign
-000975c0: 5f6c 6f6f 702e 0a20 2020 2064 6566 2065  _loop..    def e
-000975d0: 7869 7453 616e 695f 6173 7369 676e 5f6c  xitSani_assign_l
-000975e0: 6f6f 7028 7365 6c66 2c20 6374 783a 2058  oop(self, ctx: X
-000975f0: 706c 6f72 4d52 5061 7273 6572 2e53 616e  plorMRParser.San
-00097600: 695f 6173 7369 676e 5f6c 6f6f 7043 6f6e  i_assign_loopCon
-00097610: 7465 7874 293a 0a20 2020 2020 2020 2069  text):.        i
-00097620: 6620 6374 782e 5379 6d62 6f6c 5f6e 616d  f ctx.Symbol_nam
-00097630: 655f 4346 2829 3a0a 2020 2020 2020 2020  e_CF():.        
-00097640: 2020 2020 7379 6d62 6f6c 5f6e 616d 6520      symbol_name 
-00097650: 3d20 7374 7228 6374 782e 5379 6d62 6f6c  = str(ctx.Symbol
-00097660: 5f6e 616d 655f 4346 2829 290a 2020 2020  _name_CF()).    
-00097670: 2020 2020 2020 2020 6966 2073 796d 626f          if symbo
-00097680: 6c5f 6e61 6d65 2069 6e20 7365 6c66 2e65  l_name in self.e
-00097690: 7661 6c75 6174 6546 6f72 3a0a 2020 2020  valuateFor:.    
-000976a0: 2020 2020 2020 2020 2020 2020 6465 6c20              del 
-000976b0: 7365 6c66 2e65 7661 6c75 6174 6546 6f72  self.evaluateFor
-000976c0: 5b73 796d 626f 6c5f 6e61 6d65 5d0a 0a20  [symbol_name].. 
-000976d0: 2020 2023 2045 6e74 6572 2061 2070 6172     # Enter a par
-000976e0: 7365 2074 7265 6520 7072 6f64 7563 6564  se tree produced
-000976f0: 2062 7920 5870 6c6f 724d 5250 6172 7365   by XplorMRParse
-00097700: 7223 7861 6463 5f61 7373 6967 6e5f 6c6f  r#xadc_assign_lo
-00097710: 6f70 2e0a 2020 2020 6465 6620 656e 7465  op..    def ente
-00097720: 7258 6164 635f 6173 7369 676e 5f6c 6f6f  rXadc_assign_loo
-00097730: 7028 7365 6c66 2c20 6374 783a 2058 706c  p(self, ctx: Xpl
-00097740: 6f72 4d52 5061 7273 6572 2e58 6164 635f  orMRParser.Xadc_
-00097750: 6173 7369 676e 5f6c 6f6f 7043 6f6e 7465  assign_loopConte
-00097760: 7874 293a 0a20 2020 2020 2020 2073 796d  xt):.        sym
-00097770: 626f 6c5f 6e61 6d65 203d 204e 6f6e 650a  bol_name = None.
-00097780: 2020 2020 2020 2020 6966 2063 7478 2e53          if ctx.S
-00097790: 796d 626f 6c5f 6e61 6d65 5f43 4628 293a  ymbol_name_CF():
-000977a0: 0a20 2020 2020 2020 2020 2020 2073 796d  .            sym
-000977b0: 626f 6c5f 6e61 6d65 203d 2073 7472 2863  bol_name = str(c
-000977c0: 7478 2e53 796d 626f 6c5f 6e61 6d65 5f43  tx.Symbol_name_C
-000977d0: 4628 2929 0a0a 2020 2020 2020 2020 6966  F())..        if
-000977e0: 2063 7478 2e49 6e74 6567 6572 5f43 4628   ctx.Integer_CF(
-000977f0: 3029 3a0a 2020 2020 2020 2020 2020 2020  0):.            
-00097800: 696e 745f 6c69 7374 203d 205b 5d0a 2020  int_list = [].  
-00097810: 2020 2020 2020 2020 2020 6964 7820 3d20            idx = 
-00097820: 300a 2020 2020 2020 2020 2020 2020 7768  0.            wh
-00097830: 696c 6520 5472 7565 3a0a 2020 2020 2020  ile True:.      
-00097840: 2020 2020 2020 2020 2020 6966 2063 7478            if ctx
-00097850: 2e49 6e74 6567 6572 5f43 4628 6964 7829  .Integer_CF(idx)
-00097860: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00097870: 2020 2020 2020 696e 745f 6c69 7374 2e61        int_list.a
-00097880: 7070 656e 6428 696e 7428 7374 7228 6374  ppend(int(str(ct
-00097890: 782e 496e 7465 6765 725f 4346 2869 6478  x.Integer_CF(idx
-000978a0: 2929 2929 0a20 2020 2020 2020 2020 2020  )))).           
-000978b0: 2020 2020 2020 2020 2069 6478 202b 3d20           idx += 
-000978c0: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
-000978d0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-000978e0: 2020 2020 2020 2020 2020 2020 6272 6561              brea
-000978f0: 6b0a 2020 2020 2020 2020 2020 2020 6966  k.            if
-00097900: 2073 796d 626f 6c5f 6e61 6d65 2069 7320   symbol_name is 
-00097910: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-00097920: 2020 2020 2020 2020 2020 7365 6c66 2e65            self.e
-00097930: 7661 6c75 6174 6546 6f72 5b73 796d 626f  valuateFor[symbo
-00097940: 6c5f 6e61 6d65 5d20 3d20 696e 745f 6c69  l_name] = int_li
-00097950: 7374 0a0a 2020 2020 2020 2020 6966 2063  st..        if c
-00097960: 7478 2e52 6561 6c5f 4346 2830 293a 0a20  tx.Real_CF(0):. 
-00097970: 2020 2020 2020 2020 2020 2072 6561 6c5f             real_
-00097980: 6c69 7374 203d 205b 5d0a 2020 2020 2020  list = [].      
-00097990: 2020 2020 2020 6964 7820 3d20 300a 2020        idx = 0.  
-000979a0: 2020 2020 2020 2020 2020 7768 696c 6520            while 
-000979b0: 5472 7565 3a0a 2020 2020 2020 2020 2020  True:.          
-000979c0: 2020 2020 2020 6966 2063 7478 2e52 6561        if ctx.Rea
-000979d0: 6c5f 4346 2869 6478 293a 0a20 2020 2020  l_CF(idx):.     
-000979e0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000979f0: 6561 6c5f 6c69 7374 2e61 7070 656e 6428  eal_list.append(
-00097a00: 666c 6f61 7428 7374 7228 6374 782e 5265  float(str(ctx.Re
-00097a10: 616c 5f43 4628 6964 7829 2929 290a 2020  al_CF(idx)))).  
-00097a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00097a30: 2020 6964 7820 2b3d 2031 0a20 2020 2020    idx += 1.     
-00097a40: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00097a50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00097a60: 2020 2020 2062 7265 616b 0a20 2020 2020       break.     
-00097a70: 2020 2020 2020 2069 6620 7379 6d62 6f6c         if symbol
-00097a80: 5f6e 616d 655b 305d 2069 7320 6e6f 7420  _name[0] is not 
-00097a90: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00097aa0: 2020 2020 2020 7365 6c66 2e65 7661 6c75        self.evalu
-00097ab0: 6174 6546 6f72 5b73 796d 626f 6c5f 6e61  ateFor[symbol_na
-00097ac0: 6d65 5d20 3d20 7265 616c 5f6c 6973 740a  me] = real_list.
-00097ad0: 0a20 2020 2020 2020 2069 6620 6374 782e  .        if ctx.
-00097ae0: 5369 6d70 6c65 5f6e 616d 655f 4346 2830  Simple_name_CF(0
-00097af0: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
-00097b00: 7472 5f6c 6973 7420 3d20 5b5d 0a20 2020  tr_list = [].   
-00097b10: 2020 2020 2020 2020 2069 6478 203d 2030           idx = 0
-00097b20: 0a20 2020 2020 2020 2020 2020 2077 6869  .            whi
-00097b30: 6c65 2054 7275 653a 0a20 2020 2020 2020  le True:.       
-00097b40: 2020 2020 2020 2020 2069 6620 6374 782e           if ctx.
-00097b50: 5369 6d70 6c65 5f6e 616d 655f 4346 2869  Simple_name_CF(i
-00097b60: 6478 293a 0a20 2020 2020 2020 2020 2020  dx):.           
-00097b70: 2020 2020 2020 2020 2073 7472 5f6c 6973           str_lis
-00097b80: 742e 6170 7065 6e64 2873 7472 2863 7478  t.append(str(ctx
-00097b90: 2e53 696d 706c 655f 6e61 6d65 5f43 4628  .Simple_name_CF(
-00097ba0: 6964 7829 2929 0a20 2020 2020 2020 2020  idx))).         
-00097bb0: 2020 2020 2020 2020 2020 2069 6478 202b             idx +
-00097bc0: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
-00097bd0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00097be0: 2020 2020 2020 2020 2020 2020 2020 6272                br
-00097bf0: 6561 6b0a 2020 2020 2020 2020 2020 2020  eak.            
-00097c00: 6966 2073 796d 626f 6c5f 6e61 6d65 2069  if symbol_name i
-00097c10: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-00097c20: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00097c30: 2e65 7661 6c75 6174 6546 6f72 5b73 796d  .evaluateFor[sym
-00097c40: 626f 6c5f 6e61 6d65 5d20 3d20 7374 725f  bol_name] = str_
-00097c50: 6c69 7374 0a0a 2020 2020 2320 4578 6974  list..    # Exit
-00097c60: 2061 2070 6172 7365 2074 7265 6520 7072   a parse tree pr
-00097c70: 6f64 7563 6564 2062 7920 5870 6c6f 724d  oduced by XplorM
-00097c80: 5250 6172 7365 7223 7861 6463 5f61 7373  RParser#xadc_ass
-00097c90: 6967 6e5f 6c6f 6f70 2e0a 2020 2020 6465  ign_loop..    de
-00097ca0: 6620 6578 6974 5861 6463 5f61 7373 6967  f exitXadc_assig
-00097cb0: 6e5f 6c6f 6f70 2873 656c 662c 2063 7478  n_loop(self, ctx
-00097cc0: 3a20 5870 6c6f 724d 5250 6172 7365 722e  : XplorMRParser.
-00097cd0: 5861 6463 5f61 7373 6967 6e5f 6c6f 6f70  Xadc_assign_loop
-00097ce0: 436f 6e74 6578 7429 3a0a 2020 2020 2020  Context):.      
-00097cf0: 2020 6966 2063 7478 2e53 796d 626f 6c5f    if ctx.Symbol_
-00097d00: 6e61 6d65 5f43 4628 293a 0a20 2020 2020  name_CF():.     
-00097d10: 2020 2020 2020 2073 796d 626f 6c5f 6e61         symbol_na
-00097d20: 6d65 203d 2073 7472 2863 7478 2e53 796d  me = str(ctx.Sym
-00097d30: 626f 6c5f 6e61 6d65 5f43 4628 2929 0a20  bol_name_CF()). 
-00097d40: 2020 2020 2020 2020 2020 2069 6620 7379             if sy
-00097d50: 6d62 6f6c 5f6e 616d 6520 696e 2073 656c  mbol_name in sel
-00097d60: 662e 6576 616c 7561 7465 466f 723a 0a20  f.evaluateFor:. 
-00097d70: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00097d80: 656c 2073 656c 662e 6576 616c 7561 7465  el self.evaluate
-00097d90: 466f 725b 7379 6d62 6f6c 5f6e 616d 655d  For[symbol_name]
-00097da0: 0a0a 2020 2020 2320 456e 7465 7220 6120  ..    # Enter a 
-00097db0: 7061 7273 6520 7472 6565 2070 726f 6475  parse tree produ
-00097dc0: 6365 6420 6279 2058 706c 6f72 4d52 5061  ced by XplorMRPa
-00097dd0: 7273 6572 2363 6f75 705f 6173 7369 676e  rser#coup_assign
-00097de0: 5f6c 6f6f 702e 0a20 2020 2064 6566 2065  _loop..    def e
-00097df0: 6e74 6572 436f 7570 5f61 7373 6967 6e5f  nterCoup_assign_
-00097e00: 6c6f 6f70 2873 656c 662c 2063 7478 3a20  loop(self, ctx: 
-00097e10: 5870 6c6f 724d 5250 6172 7365 722e 436f  XplorMRParser.Co
-00097e20: 7570 5f61 7373 6967 6e5f 6c6f 6f70 436f  up_assign_loopCo
-00097e30: 6e74 6578 7429 3a0a 2020 2020 2020 2020  ntext):.        
-00097e40: 7379 6d62 6f6c 5f6e 616d 6520 3d20 4e6f  symbol_name = No
-00097e50: 6e65 0a20 2020 2020 2020 2069 6620 6374  ne.        if ct
-00097e60: 782e 5379 6d62 6f6c 5f6e 616d 655f 4346  x.Symbol_name_CF
-00097e70: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-00097e80: 7379 6d62 6f6c 5f6e 616d 6520 3d20 7374  symbol_name = st
-00097e90: 7228 6374 782e 5379 6d62 6f6c 5f6e 616d  r(ctx.Symbol_nam
-00097ea0: 655f 4346 2829 290a 0a20 2020 2020 2020  e_CF())..       
-00097eb0: 2069 6620 6374 782e 496e 7465 6765 725f   if ctx.Integer_
-00097ec0: 4346 2830 293a 0a20 2020 2020 2020 2020  CF(0):.         
-00097ed0: 2020 2069 6e74 5f6c 6973 7420 3d20 5b5d     int_list = []
-00097ee0: 0a20 2020 2020 2020 2020 2020 2069 6478  .            idx
-00097ef0: 203d 2030 0a20 2020 2020 2020 2020 2020   = 0.           
-00097f00: 2077 6869 6c65 2054 7275 653a 0a20 2020   while True:.   
-00097f10: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00097f20: 6374 782e 496e 7465 6765 725f 4346 2869  ctx.Integer_CF(i
-00097f30: 6478 293a 0a20 2020 2020 2020 2020 2020  dx):.           
-00097f40: 2020 2020 2020 2020 2069 6e74 5f6c 6973           int_lis
-00097f50: 742e 6170 7065 6e64 2869 6e74 2873 7472  t.append(int(str
-00097f60: 2863 7478 2e49 6e74 6567 6572 5f43 4628  (ctx.Integer_CF(
-00097f70: 6964 7829 2929 290a 2020 2020 2020 2020  idx)))).        
-00097f80: 2020 2020 2020 2020 2020 2020 6964 7820              idx 
-00097f90: 2b3d 2031 0a20 2020 2020 2020 2020 2020  += 1.           
-00097fa0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00097fb0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-00097fc0: 7265 616b 0a20 2020 2020 2020 2020 2020  reak.           
-00097fd0: 2069 6620 7379 6d62 6f6c 5f6e 616d 6520   if symbol_name 
-00097fe0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-00097ff0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00098000: 662e 6576 616c 7561 7465 466f 725b 7379  f.evaluateFor[sy
-00098010: 6d62 6f6c 5f6e 616d 655d 203d 2069 6e74  mbol_name] = int
-00098020: 5f6c 6973 740a 0a20 2020 2020 2020 2069  _list..        i
-00098030: 6620 6374 782e 5265 616c 5f43 4628 3029  f ctx.Real_CF(0)
-00098040: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00098050: 616c 5f6c 6973 7420 3d20 5b5d 0a20 2020  al_list = [].   
-00098060: 2020 2020 2020 2020 2069 6478 203d 2030           idx = 0
-00098070: 0a20 2020 2020 2020 2020 2020 2077 6869  .            whi
-00098080: 6c65 2054 7275 653a 0a20 2020 2020 2020  le True:.       
-00098090: 2020 2020 2020 2020 2069 6620 6374 782e           if ctx.
-000980a0: 5265 616c 5f43 4628 6964 7829 3a0a 2020  Real_CF(idx):.  
-000980b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000980c0: 2020 7265 616c 5f6c 6973 742e 6170 7065    real_list.appe
-000980d0: 6e64 2866 6c6f 6174 2873 7472 2863 7478  nd(float(str(ctx
-000980e0: 2e52 6561 6c5f 4346 2869 6478 2929 2929  .Real_CF(idx))))
-000980f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00098100: 2020 2020 2069 6478 202b 3d20 310a 2020       idx += 1.  
-00098110: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00098120: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00098130: 2020 2020 2020 2020 6272 6561 6b0a 2020          break.  
-00098140: 2020 2020 2020 2020 2020 6966 2073 796d            if sym
-00098150: 626f 6c5f 6e61 6d65 5b30 5d20 6973 206e  bol_name[0] is n
-00098160: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-00098170: 2020 2020 2020 2020 2073 656c 662e 6576           self.ev
-00098180: 616c 7561 7465 466f 725b 7379 6d62 6f6c  aluateFor[symbol
-00098190: 5f6e 616d 655d 203d 2072 6561 6c5f 6c69  _name] = real_li
-000981a0: 7374 0a0a 2020 2020 2020 2020 6966 2063  st..        if c
-000981b0: 7478 2e53 696d 706c 655f 6e61 6d65 5f43  tx.Simple_name_C
-000981c0: 4628 3029 3a0a 2020 2020 2020 2020 2020  F(0):.          
-000981d0: 2020 7374 725f 6c69 7374 203d 205b 5d0a    str_list = [].
-000981e0: 2020 2020 2020 2020 2020 2020 6964 7820              idx 
-000981f0: 3d20 300a 2020 2020 2020 2020 2020 2020  = 0.            
-00098200: 7768 696c 6520 5472 7565 3a0a 2020 2020  while True:.    
-00098210: 2020 2020 2020 2020 2020 2020 6966 2063              if c
-00098220: 7478 2e53 696d 706c 655f 6e61 6d65 5f43  tx.Simple_name_C
-00098230: 4628 6964 7829 3a0a 2020 2020 2020 2020  F(idx):.        
-00098240: 2020 2020 2020 2020 2020 2020 7374 725f              str_
-00098250: 6c69 7374 2e61 7070 656e 6428 7374 7228  list.append(str(
-00098260: 6374 782e 5369 6d70 6c65 5f6e 616d 655f  ctx.Simple_name_
-00098270: 4346 2869 6478 2929 290a 2020 2020 2020  CF(idx))).      
-00098280: 2020 2020 2020 2020 2020 2020 2020 6964                id
-00098290: 7820 2b3d 2031 0a20 2020 2020 2020 2020  x += 1.         
-000982a0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-000982b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000982c0: 2062 7265 616b 0a20 2020 2020 2020 2020   break.         
-000982d0: 2020 2069 6620 7379 6d62 6f6c 5f6e 616d     if symbol_nam
-000982e0: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
-000982f0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00098300: 656c 662e 6576 616c 7561 7465 466f 725b  elf.evaluateFor[
-00098310: 7379 6d62 6f6c 5f6e 616d 655d 203d 2073  symbol_name] = s
-00098320: 7472 5f6c 6973 740a 0a20 2020 2023 2045  tr_list..    # E
-00098330: 7869 7420 6120 7061 7273 6520 7472 6565  xit a parse tree
-00098340: 2070 726f 6475 6365 6420 6279 2058 706c   produced by Xpl
-00098350: 6f72 4d52 5061 7273 6572 2363 6f75 705f  orMRParser#coup_
-00098360: 6173 7369 676e 5f6c 6f6f 702e 0a20 2020  assign_loop..   
-00098370: 2064 6566 2065 7869 7443 6f75 705f 6173   def exitCoup_as
-00098380: 7369 676e 5f6c 6f6f 7028 7365 6c66 2c20  sign_loop(self, 
-00098390: 6374 783a 2058 706c 6f72 4d52 5061 7273  ctx: XplorMRPars
-000983a0: 6572 2e43 6f75 705f 6173 7369 676e 5f6c  er.Coup_assign_l
-000983b0: 6f6f 7043 6f6e 7465 7874 293a 0a20 2020  oopContext):.   
-000983c0: 2020 2020 2069 6620 6374 782e 5379 6d62       if ctx.Symb
-000983d0: 6f6c 5f6e 616d 655f 4346 2829 3a0a 2020  ol_name_CF():.  
-000983e0: 2020 2020 2020 2020 2020 7379 6d62 6f6c            symbol
-000983f0: 5f6e 616d 6520 3d20 7374 7228 6374 782e  _name = str(ctx.
-00098400: 5379 6d62 6f6c 5f6e 616d 655f 4346 2829  Symbol_name_CF()
-00098410: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-00098420: 2073 796d 626f 6c5f 6e61 6d65 2069 6e20   symbol_name in 
-00098430: 7365 6c66 2e65 7661 6c75 6174 6546 6f72  self.evaluateFor
-00098440: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00098450: 2020 6465 6c20 7365 6c66 2e65 7661 6c75    del self.evalu
-00098460: 6174 6546 6f72 5b73 796d 626f 6c5f 6e61  ateFor[symbol_na
-00098470: 6d65 5d0a 0a20 2020 2023 2045 6e74 6572  me]..    # Enter
-00098480: 2061 2070 6172 7365 2074 7265 6520 7072   a parse tree pr
-00098490: 6f64 7563 6564 2062 7920 5870 6c6f 724d  oduced by XplorM
-000984a0: 5250 6172 7365 7223 636f 6c6c 5f61 7373  RParser#coll_ass
-000984b0: 6967 6e5f 6c6f 6f70 2e0a 2020 2020 6465  ign_loop..    de
-000984c0: 6620 656e 7465 7243 6f6c 6c5f 6173 7369  f enterColl_assi
-000984d0: 676e 5f6c 6f6f 7028 7365 6c66 2c20 6374  gn_loop(self, ct
-000984e0: 783a 2058 706c 6f72 4d52 5061 7273 6572  x: XplorMRParser
-000984f0: 2e43 6f6c 6c5f 6173 7369 676e 5f6c 6f6f  .Coll_assign_loo
-00098500: 7043 6f6e 7465 7874 293a 0a20 2020 2020  pContext):.     
-00098510: 2020 2073 796d 626f 6c5f 6e61 6d65 203d     symbol_name =
-00098520: 204e 6f6e 650a 2020 2020 2020 2020 6966   None.        if
-00098530: 2063 7478 2e53 796d 626f 6c5f 6e61 6d65   ctx.Symbol_name
-00098540: 5f43 4628 293a 0a20 2020 2020 2020 2020  _CF():.         
-00098550: 2020 2073 796d 626f 6c5f 6e61 6d65 203d     symbol_name =
-00098560: 2073 7472 2863 7478 2e53 796d 626f 6c5f   str(ctx.Symbol_
-00098570: 6e61 6d65 5f43 4628 2929 0a0a 2020 2020  name_CF())..    
-00098580: 2020 2020 6966 2063 7478 2e49 6e74 6567      if ctx.Integ
-00098590: 6572 5f43 4628 3029 3a0a 2020 2020 2020  er_CF(0):.      
-000985a0: 2020 2020 2020 696e 745f 6c69 7374 203d        int_list =
-000985b0: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
-000985c0: 6964 7820 3d20 300a 2020 2020 2020 2020  idx = 0.        
-000985d0: 2020 2020 7768 696c 6520 5472 7565 3a0a      while True:.
-000985e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000985f0: 6966 2063 7478 2e49 6e74 6567 6572 5f43  if ctx.Integer_C
-00098600: 4628 6964 7829 3a0a 2020 2020 2020 2020  F(idx):.        
-00098610: 2020 2020 2020 2020 2020 2020 696e 745f              int_
-00098620: 6c69 7374 2e61 7070 656e 6428 696e 7428  list.append(int(
-00098630: 7374 7228 6374 782e 496e 7465 6765 725f  str(ctx.Integer_
-00098640: 4346 2869 6478 2929 2929 0a20 2020 2020  CF(idx)))).     
-00098650: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00098660: 6478 202b 3d20 310a 2020 2020 2020 2020  dx += 1.        
-00098670: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00098680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00098690: 2020 6272 6561 6b0a 2020 2020 2020 2020    break.        
-000986a0: 2020 2020 6966 2073 796d 626f 6c5f 6e61      if symbol_na
-000986b0: 6d65 2069 7320 6e6f 7420 4e6f 6e65 3a0a  me is not None:.
-000986c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000986d0: 7365 6c66 2e65 7661 6c75 6174 6546 6f72  self.evaluateFor
-000986e0: 5b73 796d 626f 6c5f 6e61 6d65 5d20 3d20  [symbol_name] = 
-000986f0: 696e 745f 6c69 7374 0a0a 2020 2020 2020  int_list..      
-00098700: 2020 6966 2063 7478 2e52 6561 6c5f 4346    if ctx.Real_CF
-00098710: 2830 293a 0a20 2020 2020 2020 2020 2020  (0):.           
-00098720: 2072 6561 6c5f 6c69 7374 203d 205b 5d0a   real_list = [].
-00098730: 2020 2020 2020 2020 2020 2020 6964 7820              idx 
-00098740: 3d20 300a 2020 2020 2020 2020 2020 2020  = 0.            
-00098750: 7768 696c 6520 5472 7565 3a0a 2020 2020  while True:.    
-00098760: 2020 2020 2020 2020 2020 2020 6966 2063              if c
-00098770: 7478 2e52 6561 6c5f 4346 2869 6478 293a  tx.Real_CF(idx):
-00098780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00098790: 2020 2020 2072 6561 6c5f 6c69 7374 2e61       real_list.a
-000987a0: 7070 656e 6428 666c 6f61 7428 7374 7228  ppend(float(str(
-000987b0: 6374 782e 5265 616c 5f43 4628 6964 7829  ctx.Real_CF(idx)
-000987c0: 2929 290a 2020 2020 2020 2020 2020 2020  ))).            
-000987d0: 2020 2020 2020 2020 6964 7820 2b3d 2031          idx += 1
-000987e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000987f0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00098800: 2020 2020 2020 2020 2020 2062 7265 616b             break
-00098810: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00098820: 7379 6d62 6f6c 5f6e 616d 655b 305d 2069  symbol_name[0] i
-00098830: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-00098840: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00098850: 2e65 7661 6c75 6174 6546 6f72 5b73 796d  .evaluateFor[sym
-00098860: 626f 6c5f 6e61 6d65 5d20 3d20 7265 616c  bol_name] = real
-00098870: 5f6c 6973 740a 0a20 2020 2020 2020 2069  _list..        i
-00098880: 6620 6374 782e 5369 6d70 6c65 5f6e 616d  f ctx.Simple_nam
-00098890: 655f 4346 2830 293a 0a20 2020 2020 2020  e_CF(0):.       
-000988a0: 2020 2020 2073 7472 5f6c 6973 7420 3d20       str_list = 
-000988b0: 5b5d 0a20 2020 2020 2020 2020 2020 2069  [].            i
-000988c0: 6478 203d 2030 0a20 2020 2020 2020 2020  dx = 0.         
-000988d0: 2020 2077 6869 6c65 2054 7275 653a 0a20     while True:. 
-000988e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000988f0: 6620 6374 782e 5369 6d70 6c65 5f6e 616d  f ctx.Simple_nam
-00098900: 655f 4346 2869 6478 293a 0a20 2020 2020  e_CF(idx):.     
-00098910: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00098920: 7472 5f6c 6973 742e 6170 7065 6e64 2873  tr_list.append(s
-00098930: 7472 2863 7478 2e53 696d 706c 655f 6e61  tr(ctx.Simple_na
-00098940: 6d65 5f43 4628 6964 7829 2929 0a20 2020  me_CF(idx))).   
-00098950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00098960: 2069 6478 202b 3d20 310a 2020 2020 2020   idx += 1.      
-00098970: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00098980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00098990: 2020 2020 6272 6561 6b0a 2020 2020 2020      break.      
-000989a0: 2020 2020 2020 6966 2073 796d 626f 6c5f        if symbol_
-000989b0: 6e61 6d65 2069 7320 6e6f 7420 4e6f 6e65  name is not None
-000989c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000989d0: 2020 7365 6c66 2e65 7661 6c75 6174 6546    self.evaluateF
-000989e0: 6f72 5b73 796d 626f 6c5f 6e61 6d65 5d20  or[symbol_name] 
-000989f0: 3d20 7374 725f 6c69 7374 0a0a 2020 2020  = str_list..    
-00098a00: 2320 4578 6974 2061 2070 6172 7365 2074  # Exit a parse t
-00098a10: 7265 6520 7072 6f64 7563 6564 2062 7920  ree produced by 
-00098a20: 5870 6c6f 724d 5250 6172 7365 7223 636f  XplorMRParser#co
-00098a30: 6c6c 5f61 7373 6967 6e5f 6c6f 6f70 2e0a  ll_assign_loop..
-00098a40: 2020 2020 6465 6620 6578 6974 436f 6c6c      def exitColl
-00098a50: 5f61 7373 6967 6e5f 6c6f 6f70 2873 656c  _assign_loop(sel
-00098a60: 662c 2063 7478 3a20 5870 6c6f 724d 5250  f, ctx: XplorMRP
-00098a70: 6172 7365 722e 436f 6c6c 5f61 7373 6967  arser.Coll_assig
-00098a80: 6e5f 6c6f 6f70 436f 6e74 6578 7429 3a0a  n_loopContext):.
-00098a90: 2020 2020 2020 2020 6966 2063 7478 2e53          if ctx.S
-00098aa0: 796d 626f 6c5f 6e61 6d65 5f43 4628 293a  ymbol_name_CF():
-00098ab0: 0a20 2020 2020 2020 2020 2020 2073 796d  .            sym
-00098ac0: 626f 6c5f 6e61 6d65 203d 2073 7472 2863  bol_name = str(c
-00098ad0: 7478 2e53 796d 626f 6c5f 6e61 6d65 5f43  tx.Symbol_name_C
-00098ae0: 4628 2929 0a20 2020 2020 2020 2020 2020  F()).           
-00098af0: 2069 6620 7379 6d62 6f6c 5f6e 616d 6520   if symbol_name 
-00098b00: 696e 2073 656c 662e 6576 616c 7561 7465  in self.evaluate
-00098b10: 466f 723a 0a20 2020 2020 2020 2020 2020  For:.           
-00098b20: 2020 2020 2064 656c 2073 656c 662e 6576       del self.ev
-00098b30: 616c 7561 7465 466f 725b 7379 6d62 6f6c  aluateFor[symbol
-00098b40: 5f6e 616d 655d 0a0a 2020 2020 2320 456e  _name]..    # En
-00098b50: 7465 7220 6120 7061 7273 6520 7472 6565  ter a parse tree
-00098b60: 2070 726f 6475 6365 6420 6279 2058 706c   produced by Xpl
-00098b70: 6f72 4d52 5061 7273 6572 2363 7361 5f61  orMRParser#csa_a
-00098b80: 7373 6967 6e5f 6c6f 6f70 2e0a 2020 2020  ssign_loop..    
-00098b90: 6465 6620 656e 7465 7243 7361 5f61 7373  def enterCsa_ass
-00098ba0: 6967 6e5f 6c6f 6f70 2873 656c 662c 2063  ign_loop(self, c
-00098bb0: 7478 3a20 5870 6c6f 724d 5250 6172 7365  tx: XplorMRParse
-00098bc0: 722e 4373 615f 6173 7369 676e 5f6c 6f6f  r.Csa_assign_loo
-00098bd0: 7043 6f6e 7465 7874 293a 0a20 2020 2020  pContext):.     
-00098be0: 2020 2073 796d 626f 6c5f 6e61 6d65 203d     symbol_name =
-00098bf0: 204e 6f6e 650a 2020 2020 2020 2020 6966   None.        if
-00098c00: 2063 7478 2e53 796d 626f 6c5f 6e61 6d65   ctx.Symbol_name
-00098c10: 5f43 4628 293a 0a20 2020 2020 2020 2020  _CF():.         
-00098c20: 2020 2073 796d 626f 6c5f 6e61 6d65 203d     symbol_name =
-00098c30: 2073 7472 2863 7478 2e53 796d 626f 6c5f   str(ctx.Symbol_
-00098c40: 6e61 6d65 5f43 4628 2929 0a0a 2020 2020  name_CF())..    
-00098c50: 2020 2020 6966 2063 7478 2e49 6e74 6567      if ctx.Integ
-00098c60: 6572 5f43 4628 3029 3a0a 2020 2020 2020  er_CF(0):.      
-00098c70: 2020 2020 2020 696e 745f 6c69 7374 203d        int_list =
-00098c80: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
-00098c90: 6964 7820 3d20 300a 2020 2020 2020 2020  idx = 0.        
-00098ca0: 2020 2020 7768 696c 6520 5472 7565 3a0a      while True:.
-00098cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00098cc0: 6966 2063 7478 2e49 6e74 6567 6572 5f43  if ctx.Integer_C
-00098cd0: 4628 6964 7829 3a0a 2020 2020 2020 2020  F(idx):.        
-00098ce0: 2020 2020 2020 2020 2020 2020 696e 745f              int_
-00098cf0: 6c69 7374 2e61 7070 656e 6428 696e 7428  list.append(int(
-00098d00: 7374 7228 6374 782e 496e 7465 6765 725f  str(ctx.Integer_
-00098d10: 4346 2869 6478 2929 2929 0a20 2020 2020  CF(idx)))).     
-00098d20: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00098d30: 6478 202b 3d20 310a 2020 2020 2020 2020  dx += 1.        
-00098d40: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00098d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00098d60: 2020 6272 6561 6b0a 2020 2020 2020 2020    break.        
-00098d70: 2020 2020 6966 2073 796d 626f 6c5f 6e61      if symbol_na
-00098d80: 6d65 2069 7320 6e6f 7420 4e6f 6e65 3a0a  me is not None:.
-00098d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00098da0: 7365 6c66 2e65 7661 6c75 6174 6546 6f72  self.evaluateFor
-00098db0: 5b73 796d 626f 6c5f 6e61 6d65 5d20 3d20  [symbol_name] = 
-00098dc0: 696e 745f 6c69 7374 0a0a 2020 2020 2020  int_list..      
-00098dd0: 2020 6966 2063 7478 2e52 6561 6c5f 4346    if ctx.Real_CF
-00098de0: 2830 293a 0a20 2020 2020 2020 2020 2020  (0):.           
-00098df0: 2072 6561 6c5f 6c69 7374 203d 205b 5d0a   real_list = [].
-00098e00: 2020 2020 2020 2020 2020 2020 6964 7820              idx 
-00098e10: 3d20 300a 2020 2020 2020 2020 2020 2020  = 0.            
-00098e20: 7768 696c 6520 5472 7565 3a0a 2020 2020  while True:.    
-00098e30: 2020 2020 2020 2020 2020 2020 6966 2063              if c
-00098e40: 7478 2e52 6561 6c5f 4346 2869 6478 293a  tx.Real_CF(idx):
-00098e50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00098e60: 2020 2020 2072 6561 6c5f 6c69 7374 2e61       real_list.a
-00098e70: 7070 656e 6428 666c 6f61 7428 7374 7228  ppend(float(str(
-00098e80: 6374 782e 5265 616c 5f43 4628 6964 7829  ctx.Real_CF(idx)
-00098e90: 2929 290a 2020 2020 2020 2020 2020 2020  ))).            
-00098ea0: 2020 2020 2020 2020 6964 7820 2b3d 2031          idx += 1
-00098eb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00098ec0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00098ed0: 2020 2020 2020 2020 2020 2062 7265 616b             break
-00098ee0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00098ef0: 7379 6d62 6f6c 5f6e 616d 655b 305d 2069  symbol_name[0] i
-00098f00: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-00098f10: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00098f20: 2e65 7661 6c75 6174 6546 6f72 5b73 796d  .evaluateFor[sym
-00098f30: 626f 6c5f 6e61 6d65 5d20 3d20 7265 616c  bol_name] = real
-00098f40: 5f6c 6973 740a 0a20 2020 2020 2020 2069  _list..        i
-00098f50: 6620 6374 782e 5369 6d70 6c65 5f6e 616d  f ctx.Simple_nam
-00098f60: 655f 4346 2830 293a 0a20 2020 2020 2020  e_CF(0):.       
-00098f70: 2020 2020 2073 7472 5f6c 6973 7420 3d20       str_list = 
-00098f80: 5b5d 0a20 2020 2020 2020 2020 2020 2069  [].            i
-00098f90: 6478 203d 2030 0a20 2020 2020 2020 2020  dx = 0.         
-00098fa0: 2020 2077 6869 6c65 2054 7275 653a 0a20     while True:. 
-00098fb0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00098fc0: 6620 6374 782e 5369 6d70 6c65 5f6e 616d  f ctx.Simple_nam
-00098fd0: 655f 4346 2869 6478 293a 0a20 2020 2020  e_CF(idx):.     
-00098fe0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00098ff0: 7472 5f6c 6973 742e 6170 7065 6e64 2873  tr_list.append(s
-00099000: 7472 2863 7478 2e53 696d 706c 655f 6e61  tr(ctx.Simple_na
-00099010: 6d65 5f43 4628 6964 7829 2929 0a20 2020  me_CF(idx))).   
-00099020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00099030: 2069 6478 202b 3d20 310a 2020 2020 2020   idx += 1.      
-00099040: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00099050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00099060: 2020 2020 6272 6561 6b0a 2020 2020 2020      break.      
-00099070: 2020 2020 2020 6966 2073 796d 626f 6c5f        if symbol_
-00099080: 6e61 6d65 2069 7320 6e6f 7420 4e6f 6e65  name is not None
-00099090: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000990a0: 2020 7365 6c66 2e65 7661 6c75 6174 6546    self.evaluateF
-000990b0: 6f72 5b73 796d 626f 6c5f 6e61 6d65 5d20  or[symbol_name] 
-000990c0: 3d20 7374 725f 6c69 7374 0a0a 2020 2020  = str_list..    
-000990d0: 2320 4578 6974 2061 2070 6172 7365 2074  # Exit a parse t
-000990e0: 7265 6520 7072 6f64 7563 6564 2062 7920  ree produced by 
-000990f0: 5870 6c6f 724d 5250 6172 7365 7223 6373  XplorMRParser#cs
-00099100: 615f 6173 7369 676e 5f6c 6f6f 702e 0a20  a_assign_loop.. 
-00099110: 2020 2064 6566 2065 7869 7443 7361 5f61     def exitCsa_a
-00099120: 7373 6967 6e5f 6c6f 6f70 2873 656c 662c  ssign_loop(self,
-00099130: 2063 7478 3a20 5870 6c6f 724d 5250 6172   ctx: XplorMRPar
-00099140: 7365 722e 4373 615f 6173 7369 676e 5f6c  ser.Csa_assign_l
-00099150: 6f6f 7043 6f6e 7465 7874 293a 0a20 2020  oopContext):.   
-00099160: 2020 2020 2069 6620 6374 782e 5379 6d62       if ctx.Symb
-00099170: 6f6c 5f6e 616d 655f 4346 2829 3a0a 2020  ol_name_CF():.  
-00099180: 2020 2020 2020 2020 2020 7379 6d62 6f6c            symbol
-00099190: 5f6e 616d 6520 3d20 7374 7228 6374 782e  _name = str(ctx.
-000991a0: 5379 6d62 6f6c 5f6e 616d 655f 4346 2829  Symbol_name_CF()
-000991b0: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-000991c0: 2073 796d 626f 6c5f 6e61 6d65 2069 6e20   symbol_name in 
-000991d0: 7365 6c66 2e65 7661 6c75 6174 6546 6f72  self.evaluateFor
-000991e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000991f0: 2020 6465 6c20 7365 6c66 2e65 7661 6c75    del self.evalu
-00099200: 6174 6546 6f72 5b73 796d 626f 6c5f 6e61  ateFor[symbol_na
-00099210: 6d65 5d0a 0a20 2020 2023 2045 6e74 6572  me]..    # Enter
-00099220: 2061 2070 6172 7365 2074 7265 6520 7072   a parse tree pr
-00099230: 6f64 7563 6564 2062 7920 5870 6c6f 724d  oduced by XplorM
-00099240: 5250 6172 7365 7223 7072 655f 6173 7369  RParser#pre_assi
-00099250: 676e 5f6c 6f6f 702e 0a20 2020 2064 6566  gn_loop..    def
-00099260: 2065 6e74 6572 5072 655f 6173 7369 676e   enterPre_assign
-00099270: 5f6c 6f6f 7028 7365 6c66 2c20 6374 783a  _loop(self, ctx:
-00099280: 2058 706c 6f72 4d52 5061 7273 6572 2e50   XplorMRParser.P
-00099290: 7265 5f61 7373 6967 6e5f 6c6f 6f70 436f  re_assign_loopCo
-000992a0: 6e74 6578 7429 3a0a 2020 2020 2020 2020  ntext):.        
-000992b0: 7379 6d62 6f6c 5f6e 616d 6520 3d20 4e6f  symbol_name = No
-000992c0: 6e65 0a20 2020 2020 2020 2069 6620 6374  ne.        if ct
-000992d0: 782e 5379 6d62 6f6c 5f6e 616d 655f 4346  x.Symbol_name_CF
-000992e0: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-000992f0: 7379 6d62 6f6c 5f6e 616d 6520 3d20 7374  symbol_name = st
-00099300: 7228 6374 782e 5379 6d62 6f6c 5f6e 616d  r(ctx.Symbol_nam
-00099310: 655f 4346 2829 290a 0a20 2020 2020 2020  e_CF())..       
-00099320: 2069 6620 6374 782e 496e 7465 6765 725f   if ctx.Integer_
-00099330: 4346 2830 293a 0a20 2020 2020 2020 2020  CF(0):.         
-00099340: 2020 2069 6e74 5f6c 6973 7420 3d20 5b5d     int_list = []
-00099350: 0a20 2020 2020 2020 2020 2020 2069 6478  .            idx
-00099360: 203d 2030 0a20 2020 2020 2020 2020 2020   = 0.           
-00099370: 2077 6869 6c65 2054 7275 653a 0a20 2020   while True:.   
-00099380: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00099390: 6374 782e 496e 7465 6765 725f 4346 2869  ctx.Integer_CF(i
-000993a0: 6478 293a 0a20 2020 2020 2020 2020 2020  dx):.           
-000993b0: 2020 2020 2020 2020 2069 6e74 5f6c 6973           int_lis
-000993c0: 742e 6170 7065 6e64 2869 6e74 2873 7472  t.append(int(str
-000993d0: 2863 7478 2e49 6e74 6567 6572 5f43 4628  (ctx.Integer_CF(
-000993e0: 6964 7829 2929 290a 2020 2020 2020 2020  idx)))).        
-000993f0: 2020 2020 2020 2020 2020 2020 6964 7820              idx 
-00099400: 2b3d 2031 0a20 2020 2020 2020 2020 2020  += 1.           
-00099410: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00099420: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-00099430: 7265 616b 0a20 2020 2020 2020 2020 2020  reak.           
-00099440: 2069 6620 7379 6d62 6f6c 5f6e 616d 6520   if symbol_name 
-00099450: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-00099460: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00099470: 662e 6576 616c 7561 7465 466f 725b 7379  f.evaluateFor[sy
-00099480: 6d62 6f6c 5f6e 616d 655d 203d 2069 6e74  mbol_name] = int
-00099490: 5f6c 6973 740a 0a20 2020 2020 2020 2069  _list..        i
-000994a0: 6620 6374 782e 5265 616c 5f43 4628 3029  f ctx.Real_CF(0)
-000994b0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-000994c0: 616c 5f6c 6973 7420 3d20 5b5d 0a20 2020  al_list = [].   
-000994d0: 2020 2020 2020 2020 2069 6478 203d 2030           idx = 0
-000994e0: 0a20 2020 2020 2020 2020 2020 2077 6869  .            whi
-000994f0: 6c65 2054 7275 653a 0a20 2020 2020 2020  le True:.       
-00099500: 2020 2020 2020 2020 2069 6620 6374 782e           if ctx.
-00099510: 5265 616c 5f43 4628 6964 7829 3a0a 2020  Real_CF(idx):.  
-00099520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00099530: 2020 7265 616c 5f6c 6973 742e 6170 7065    real_list.appe
-00099540: 6e64 2866 6c6f 6174 2873 7472 2863 7478  nd(float(str(ctx
-00099550: 2e52 6561 6c5f 4346 2869 6478 2929 2929  .Real_CF(idx))))
-00099560: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00099570: 2020 2020 2069 6478 202b 3d20 310a 2020       idx += 1.  
-00099580: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00099590: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-000995a0: 2020 2020 2020 2020 6272 6561 6b0a 2020          break.  
-000995b0: 2020 2020 2020 2020 2020 6966 2073 796d            if sym
-000995c0: 626f 6c5f 6e61 6d65 5b30 5d20 6973 206e  bol_name[0] is n
-000995d0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-000995e0: 2020 2020 2020 2020 2073 656c 662e 6576           self.ev
-000995f0: 616c 7561 7465 466f 725b 7379 6d62 6f6c  aluateFor[symbol
-00099600: 5f6e 616d 655d 203d 2072 6561 6c5f 6c69  _name] = real_li
-00099610: 7374 0a0a 2020 2020 2020 2020 6966 2063  st..        if c
-00099620: 7478 2e53 696d 706c 655f 6e61 6d65 5f43  tx.Simple_name_C
-00099630: 4628 3029 3a0a 2020 2020 2020 2020 2020  F(0):.          
-00099640: 2020 7374 725f 6c69 7374 203d 205b 5d0a    str_list = [].
-00099650: 2020 2020 2020 2020 2020 2020 6964 7820              idx 
-00099660: 3d20 300a 2020 2020 2020 2020 2020 2020  = 0.            
-00099670: 7768 696c 6520 5472 7565 3a0a 2020 2020  while True:.    
-00099680: 2020 2020 2020 2020 2020 2020 6966 2063              if c
-00099690: 7478 2e53 696d 706c 655f 6e61 6d65 5f43  tx.Simple_name_C
-000996a0: 4628 6964 7829 3a0a 2020 2020 2020 2020  F(idx):.        
-000996b0: 2020 2020 2020 2020 2020 2020 7374 725f              str_
-000996c0: 6c69 7374 2e61 7070 656e 6428 7374 7228  list.append(str(
-000996d0: 6374 782e 5369 6d70 6c65 5f6e 616d 655f  ctx.Simple_name_
-000996e0: 4346 2869 6478 2929 290a 2020 2020 2020  CF(idx))).      
-000996f0: 2020 2020 2020 2020 2020 2020 2020 6964                id
-00099700: 7820 2b3d 2031 0a20 2020 2020 2020 2020  x += 1.         
-00099710: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00099720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00099730: 2062 7265 616b 0a20 2020 2020 2020 2020   break.         
-00099740: 2020 2069 6620 7379 6d62 6f6c 5f6e 616d     if symbol_nam
-00099750: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
-00099760: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00099770: 656c 662e 6576 616c 7561 7465 466f 725b  elf.evaluateFor[
-00099780: 7379 6d62 6f6c 5f6e 616d 655d 203d 2073  symbol_name] = s
-00099790: 7472 5f6c 6973 740a 0a20 2020 2023 2045  tr_list..    # E
-000997a0: 7869 7420 6120 7061 7273 6520 7472 6565  xit a parse tree
-000997b0: 2070 726f 6475 6365 6420 6279 2058 706c   produced by Xpl
-000997c0: 6f72 4d52 5061 7273 6572 2370 7265 5f61  orMRParser#pre_a
-000997d0: 7373 6967 6e5f 6c6f 6f70 2e0a 2020 2020  ssign_loop..    
-000997e0: 6465 6620 6578 6974 5072 655f 6173 7369  def exitPre_assi
-000997f0: 676e 5f6c 6f6f 7028 7365 6c66 2c20 6374  gn_loop(self, ct
-00099800: 783a 2058 706c 6f72 4d52 5061 7273 6572  x: XplorMRParser
-00099810: 2e50 7265 5f61 7373 6967 6e5f 6c6f 6f70  .Pre_assign_loop
-00099820: 436f 6e74 6578 7429 3a0a 2020 2020 2020  Context):.      
-00099830: 2020 6966 2063 7478 2e53 796d 626f 6c5f    if ctx.Symbol_
-00099840: 6e61 6d65 5f43 4628 293a 0a20 2020 2020  name_CF():.     
-00099850: 2020 2020 2020 2073 796d 626f 6c5f 6e61         symbol_na
-00099860: 6d65 203d 2073 7472 2863 7478 2e53 796d  me = str(ctx.Sym
-00099870: 626f 6c5f 6e61 6d65 5f43 4628 2929 0a20  bol_name_CF()). 
-00099880: 2020 2020 2020 2020 2020 2069 6620 7379             if sy
-00099890: 6d62 6f6c 5f6e 616d 6520 696e 2073 656c  mbol_name in sel
-000998a0: 662e 6576 616c 7561 7465 466f 723a 0a20  f.evaluateFor:. 
-000998b0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-000998c0: 656c 2073 656c 662e 6576 616c 7561 7465  el self.evaluate
-000998d0: 466f 725b 7379 6d62 6f6c 5f6e 616d 655d  For[symbol_name]
-000998e0: 0a0a 2020 2020 2320 456e 7465 7220 6120  ..    # Enter a 
-000998f0: 7061 7273 6520 7472 6565 2070 726f 6475  parse tree produ
-00099900: 6365 6420 6279 2058 706c 6f72 4d52 5061  ced by XplorMRPa
-00099910: 7273 6572 2370 6373 5f61 7373 6967 6e5f  rser#pcs_assign_
-00099920: 6c6f 6f70 2e0a 2020 2020 6465 6620 656e  loop..    def en
-00099930: 7465 7250 6373 5f61 7373 6967 6e5f 6c6f  terPcs_assign_lo
-00099940: 6f70 2873 656c 662c 2063 7478 3a20 5870  op(self, ctx: Xp
-00099950: 6c6f 724d 5250 6172 7365 722e 5063 735f  lorMRParser.Pcs_
-00099960: 6173 7369 676e 5f6c 6f6f 7043 6f6e 7465  assign_loopConte
-00099970: 7874 293a 0a20 2020 2020 2020 2073 796d  xt):.        sym
-00099980: 626f 6c5f 6e61 6d65 203d 204e 6f6e 650a  bol_name = None.
-00099990: 2020 2020 2020 2020 6966 2063 7478 2e53          if ctx.S
-000999a0: 796d 626f 6c5f 6e61 6d65 5f43 4628 293a  ymbol_name_CF():
-000999b0: 0a20 2020 2020 2020 2020 2020 2073 796d  .            sym
-000999c0: 626f 6c5f 6e61 6d65 203d 2073 7472 2863  bol_name = str(c
-000999d0: 7478 2e53 796d 626f 6c5f 6e61 6d65 5f43  tx.Symbol_name_C
-000999e0: 4628 2929 0a0a 2020 2020 2020 2020 6966  F())..        if
-000999f0: 2063 7478 2e49 6e74 6567 6572 5f43 4628   ctx.Integer_CF(
-00099a00: 3029 3a0a 2020 2020 2020 2020 2020 2020  0):.            
-00099a10: 696e 745f 6c69 7374 203d 205b 5d0a 2020  int_list = [].  
-00099a20: 2020 2020 2020 2020 2020 6964 7820 3d20            idx = 
-00099a30: 300a 2020 2020 2020 2020 2020 2020 7768  0.            wh
-00099a40: 696c 6520 5472 7565 3a0a 2020 2020 2020  ile True:.      
-00099a50: 2020 2020 2020 2020 2020 6966 2063 7478            if ctx
-00099a60: 2e49 6e74 6567 6572 5f43 4628 6964 7829  .Integer_CF(idx)
-00099a70: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00099a80: 2020 2020 2020 696e 745f 6c69 7374 2e61        int_list.a
-00099a90: 7070 656e 6428 696e 7428 7374 7228 6374  ppend(int(str(ct
-00099aa0: 782e 496e 7465 6765 725f 4346 2869 6478  x.Integer_CF(idx
-00099ab0: 2929 2929 0a20 2020 2020 2020 2020 2020  )))).           
-00099ac0: 2020 2020 2020 2020 2069 6478 202b 3d20           idx += 
-00099ad0: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
-00099ae0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00099af0: 2020 2020 2020 2020 2020 2020 6272 6561              brea
-00099b00: 6b0a 2020 2020 2020 2020 2020 2020 6966  k.            if
-00099b10: 2073 796d 626f 6c5f 6e61 6d65 2069 7320   symbol_name is 
-00099b20: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-00099b30: 2020 2020 2020 2020 2020 7365 6c66 2e65            self.e
-00099b40: 7661 6c75 6174 6546 6f72 5b73 796d 626f  valuateFor[symbo
-00099b50: 6c5f 6e61 6d65 5d20 3d20 696e 745f 6c69  l_name] = int_li
-00099b60: 7374 0a0a 2020 2020 2020 2020 6966 2063  st..        if c
-00099b70: 7478 2e52 6561 6c5f 4346 2830 293a 0a20  tx.Real_CF(0):. 
-00099b80: 2020 2020 2020 2020 2020 2072 6561 6c5f             real_
-00099b90: 6c69 7374 203d 205b 5d0a 2020 2020 2020  list = [].      
-00099ba0: 2020 2020 2020 6964 7820 3d20 300a 2020        idx = 0.  
-00099bb0: 2020 2020 2020 2020 2020 7768 696c 6520            while 
-00099bc0: 5472 7565 3a0a 2020 2020 2020 2020 2020  True:.          
-00099bd0: 2020 2020 2020 6966 2063 7478 2e52 6561        if ctx.Rea
-00099be0: 6c5f 4346 2869 6478 293a 0a20 2020 2020  l_CF(idx):.     
-00099bf0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00099c00: 6561 6c5f 6c69 7374 2e61 7070 656e 6428  eal_list.append(
-00099c10: 666c 6f61 7428 7374 7228 6374 782e 5265  float(str(ctx.Re
-00099c20: 616c 5f43 4628 6964 7829 2929 290a 2020  al_CF(idx)))).  
-00099c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00099c40: 2020 6964 7820 2b3d 2031 0a20 2020 2020    idx += 1.     
-00099c50: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00099c60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00099c70: 2020 2020 2062 7265 616b 0a20 2020 2020       break.     
-00099c80: 2020 2020 2020 2069 6620 7379 6d62 6f6c         if symbol
-00099c90: 5f6e 616d 655b 305d 2069 7320 6e6f 7420  _name[0] is not 
-00099ca0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00099cb0: 2020 2020 2020 7365 6c66 2e65 7661 6c75        self.evalu
-00099cc0: 6174 6546 6f72 5b73 796d 626f 6c5f 6e61  ateFor[symbol_na
-00099cd0: 6d65 5d20 3d20 7265 616c 5f6c 6973 740a  me] = real_list.
-00099ce0: 0a20 2020 2020 2020 2069 6620 6374 782e  .        if ctx.
-00099cf0: 5369 6d70 6c65 5f6e 616d 655f 4346 2830  Simple_name_CF(0
-00099d00: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
-00099d10: 7472 5f6c 6973 7420 3d20 5b5d 0a20 2020  tr_list = [].   
-00099d20: 2020 2020 2020 2020 2069 6478 203d 2030           idx = 0
-00099d30: 0a20 2020 2020 2020 2020 2020 2077 6869  .            whi
-00099d40: 6c65 2054 7275 653a 0a20 2020 2020 2020  le True:.       
-00099d50: 2020 2020 2020 2020 2069 6620 6374 782e           if ctx.
-00099d60: 5369 6d70 6c65 5f6e 616d 655f 4346 2869  Simple_name_CF(i
-00099d70: 6478 293a 0a20 2020 2020 2020 2020 2020  dx):.           
-00099d80: 2020 2020 2020 2020 2073 7472 5f6c 6973           str_lis
-00099d90: 742e 6170 7065 6e64 2873 7472 2863 7478  t.append(str(ctx
-00099da0: 2e53 696d 706c 655f 6e61 6d65 5f43 4628  .Simple_name_CF(
-00099db0: 6964 7829 2929 0a20 2020 2020 2020 2020  idx))).         
-00099dc0: 2020 2020 2020 2020 2020 2069 6478 202b             idx +
-00099dd0: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
-00099de0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00099df0: 2020 2020 2020 2020 2020 2020 2020 6272                br
-00099e00: 6561 6b0a 2020 2020 2020 2020 2020 2020  eak.            
-00099e10: 6966 2073 796d 626f 6c5f 6e61 6d65 2069  if symbol_name i
-00099e20: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-00099e30: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00099e40: 2e65 7661 6c75 6174 6546 6f72 5b73 796d  .evaluateFor[sym
-00099e50: 626f 6c5f 6e61 6d65 5d20 3d20 7374 725f  bol_name] = str_
-00099e60: 6c69 7374 0a0a 2020 2020 2320 4578 6974  list..    # Exit
-00099e70: 2061 2070 6172 7365 2074 7265 6520 7072   a parse tree pr
-00099e80: 6f64 7563 6564 2062 7920 5870 6c6f 724d  oduced by XplorM
-00099e90: 5250 6172 7365 7223 7063 735f 6173 7369  RParser#pcs_assi
-00099ea0: 676e 5f6c 6f6f 702e 0a20 2020 2064 6566  gn_loop..    def
-00099eb0: 2065 7869 7450 6373 5f61 7373 6967 6e5f   exitPcs_assign_
-00099ec0: 6c6f 6f70 2873 656c 662c 2063 7478 3a20  loop(self, ctx: 
-00099ed0: 5870 6c6f 724d 5250 6172 7365 722e 5063  XplorMRParser.Pc
-00099ee0: 735f 6173 7369 676e 5f6c 6f6f 7043 6f6e  s_assign_loopCon
-00099ef0: 7465 7874 293a 0a20 2020 2020 2020 2069  text):.        i
-00099f00: 6620 6374 782e 5379 6d62 6f6c 5f6e 616d  f ctx.Symbol_nam
-00099f10: 655f 4346 2829 3a0a 2020 2020 2020 2020  e_CF():.        
-00099f20: 2020 2020 7379 6d62 6f6c 5f6e 616d 6520      symbol_name 
-00099f30: 3d20 7374 7228 6374 782e 5379 6d62 6f6c  = str(ctx.Symbol
-00099f40: 5f6e 616d 655f 4346 2829 290a 2020 2020  _name_CF()).    
-00099f50: 2020 2020 2020 2020 6966 2073 796d 626f          if symbo
-00099f60: 6c5f 6e61 6d65 2069 6e20 7365 6c66 2e65  l_name in self.e
-00099f70: 7661 6c75 6174 6546 6f72 3a0a 2020 2020  valuateFor:.    
-00099f80: 2020 2020 2020 2020 2020 2020 6465 6c20              del 
-00099f90: 7365 6c66 2e65 7661 6c75 6174 6546 6f72  self.evaluateFor
-00099fa0: 5b73 796d 626f 6c5f 6e61 6d65 5d0a 0a20  [symbol_name].. 
-00099fb0: 2020 2023 2045 6e74 6572 2061 2070 6172     # Enter a par
-00099fc0: 7365 2074 7265 6520 7072 6f64 7563 6564  se tree produced
-00099fd0: 2062 7920 5870 6c6f 724d 5250 6172 7365   by XplorMRParse
-00099fe0: 7223 6862 6f6e 645f 6173 7369 676e 5f6c  r#hbond_assign_l
-00099ff0: 6f6f 702e 0a20 2020 2064 6566 2065 6e74  oop..    def ent
-0009a000: 6572 4862 6f6e 645f 6173 7369 676e 5f6c  erHbond_assign_l
-0009a010: 6f6f 7028 7365 6c66 2c20 6374 783a 2058  oop(self, ctx: X
-0009a020: 706c 6f72 4d52 5061 7273 6572 2e48 626f  plorMRParser.Hbo
-0009a030: 6e64 5f61 7373 6967 6e5f 6c6f 6f70 436f  nd_assign_loopCo
-0009a040: 6e74 6578 7429 3a0a 2020 2020 2020 2020  ntext):.        
-0009a050: 7379 6d62 6f6c 5f6e 616d 6520 3d20 4e6f  symbol_name = No
-0009a060: 6e65 0a20 2020 2020 2020 2069 6620 6374  ne.        if ct
-0009a070: 782e 5379 6d62 6f6c 5f6e 616d 655f 4346  x.Symbol_name_CF
-0009a080: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-0009a090: 7379 6d62 6f6c 5f6e 616d 6520 3d20 7374  symbol_name = st
-0009a0a0: 7228 6374 782e 5379 6d62 6f6c 5f6e 616d  r(ctx.Symbol_nam
-0009a0b0: 655f 4346 2829 290a 0a20 2020 2020 2020  e_CF())..       
-0009a0c0: 2069 6620 6374 782e 496e 7465 6765 725f   if ctx.Integer_
-0009a0d0: 4346 2830 293a 0a20 2020 2020 2020 2020  CF(0):.         
-0009a0e0: 2020 2069 6e74 5f6c 6973 7420 3d20 5b5d     int_list = []
-0009a0f0: 0a20 2020 2020 2020 2020 2020 2069 6478  .            idx
-0009a100: 203d 2030 0a20 2020 2020 2020 2020 2020   = 0.           
-0009a110: 2077 6869 6c65 2054 7275 653a 0a20 2020   while True:.   
-0009a120: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0009a130: 6374 782e 496e 7465 6765 725f 4346 2869  ctx.Integer_CF(i
-0009a140: 6478 293a 0a20 2020 2020 2020 2020 2020  dx):.           
-0009a150: 2020 2020 2020 2020 2069 6e74 5f6c 6973           int_lis
-0009a160: 742e 6170 7065 6e64 2869 6e74 2873 7472  t.append(int(str
-0009a170: 2863 7478 2e49 6e74 6567 6572 5f43 4628  (ctx.Integer_CF(
-0009a180: 6964 7829 2929 290a 2020 2020 2020 2020  idx)))).        
-0009a190: 2020 2020 2020 2020 2020 2020 6964 7820              idx 
-0009a1a0: 2b3d 2031 0a20 2020 2020 2020 2020 2020  += 1.           
-0009a1b0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0009a1c0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-0009a1d0: 7265 616b 0a20 2020 2020 2020 2020 2020  reak.           
-0009a1e0: 2069 6620 7379 6d62 6f6c 5f6e 616d 6520   if symbol_name 
-0009a1f0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-0009a200: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0009a210: 662e 6576 616c 7561 7465 466f 725b 7379  f.evaluateFor[sy
-0009a220: 6d62 6f6c 5f6e 616d 655d 203d 2069 6e74  mbol_name] = int
-0009a230: 5f6c 6973 740a 0a20 2020 2020 2020 2069  _list..        i
-0009a240: 6620 6374 782e 5265 616c 5f43 4628 3029  f ctx.Real_CF(0)
-0009a250: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0009a260: 616c 5f6c 6973 7420 3d20 5b5d 0a20 2020  al_list = [].   
-0009a270: 2020 2020 2020 2020 2069 6478 203d 2030           idx = 0
-0009a280: 0a20 2020 2020 2020 2020 2020 2077 6869  .            whi
-0009a290: 6c65 2054 7275 653a 0a20 2020 2020 2020  le True:.       
-0009a2a0: 2020 2020 2020 2020 2069 6620 6374 782e           if ctx.
-0009a2b0: 5265 616c 5f43 4628 6964 7829 3a0a 2020  Real_CF(idx):.  
-0009a2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009a2d0: 2020 7265 616c 5f6c 6973 742e 6170 7065    real_list.appe
-0009a2e0: 6e64 2866 6c6f 6174 2873 7472 2863 7478  nd(float(str(ctx
-0009a2f0: 2e52 6561 6c5f 4346 2869 6478 2929 2929  .Real_CF(idx))))
-0009a300: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0009a310: 2020 2020 2069 6478 202b 3d20 310a 2020       idx += 1.  
-0009a320: 2020 2020 2020 2020 2020 2020 2020 656c                el
-0009a330: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0009a340: 2020 2020 2020 2020 6272 6561 6b0a 2020          break.  
-0009a350: 2020 2020 2020 2020 2020 6966 2073 796d            if sym
-0009a360: 626f 6c5f 6e61 6d65 5b30 5d20 6973 206e  bol_name[0] is n
-0009a370: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-0009a380: 2020 2020 2020 2020 2073 656c 662e 6576           self.ev
-0009a390: 616c 7561 7465 466f 725b 7379 6d62 6f6c  aluateFor[symbol
-0009a3a0: 5f6e 616d 655d 203d 2072 6561 6c5f 6c69  _name] = real_li
-0009a3b0: 7374 0a0a 2020 2020 2020 2020 6966 2063  st..        if c
-0009a3c0: 7478 2e53 696d 706c 655f 6e61 6d65 5f43  tx.Simple_name_C
-0009a3d0: 4628 3029 3a0a 2020 2020 2020 2020 2020  F(0):.          
-0009a3e0: 2020 7374 725f 6c69 7374 203d 205b 5d0a    str_list = [].
-0009a3f0: 2020 2020 2020 2020 2020 2020 6964 7820              idx 
-0009a400: 3d20 300a 2020 2020 2020 2020 2020 2020  = 0.            
-0009a410: 7768 696c 6520 5472 7565 3a0a 2020 2020  while True:.    
-0009a420: 2020 2020 2020 2020 2020 2020 6966 2063              if c
-0009a430: 7478 2e53 696d 706c 655f 6e61 6d65 5f43  tx.Simple_name_C
-0009a440: 4628 6964 7829 3a0a 2020 2020 2020 2020  F(idx):.        
-0009a450: 2020 2020 2020 2020 2020 2020 7374 725f              str_
-0009a460: 6c69 7374 2e61 7070 656e 6428 7374 7228  list.append(str(
-0009a470: 6374 782e 5369 6d70 6c65 5f6e 616d 655f  ctx.Simple_name_
-0009a480: 4346 2869 6478 2929 290a 2020 2020 2020  CF(idx))).      
-0009a490: 2020 2020 2020 2020 2020 2020 2020 6964                id
-0009a4a0: 7820 2b3d 2031 0a20 2020 2020 2020 2020  x += 1.         
-0009a4b0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0009a4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009a4d0: 2062 7265 616b 0a20 2020 2020 2020 2020   break.         
-0009a4e0: 2020 2069 6620 7379 6d62 6f6c 5f6e 616d     if symbol_nam
-0009a4f0: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
-0009a500: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0009a510: 656c 662e 6576 616c 7561 7465 466f 725b  elf.evaluateFor[
-0009a520: 7379 6d62 6f6c 5f6e 616d 655d 203d 2073  symbol_name] = s
-0009a530: 7472 5f6c 6973 740a 0a20 2020 2023 2045  tr_list..    # E
-0009a540: 7869 7420 6120 7061 7273 6520 7472 6565  xit a parse tree
-0009a550: 2070 726f 6475 6365 6420 6279 2058 706c   produced by Xpl
-0009a560: 6f72 4d52 5061 7273 6572 2368 626f 6e64  orMRParser#hbond
-0009a570: 5f61 7373 6967 6e5f 6c6f 6f70 2e0a 2020  _assign_loop..  
-0009a580: 2020 6465 6620 6578 6974 4862 6f6e 645f    def exitHbond_
-0009a590: 6173 7369 676e 5f6c 6f6f 7028 7365 6c66  assign_loop(self
-0009a5a0: 2c20 6374 783a 2058 706c 6f72 4d52 5061  , ctx: XplorMRPa
-0009a5b0: 7273 6572 2e48 626f 6e64 5f61 7373 6967  rser.Hbond_assig
-0009a5c0: 6e5f 6c6f 6f70 436f 6e74 6578 7429 3a0a  n_loopContext):.
-0009a5d0: 2020 2020 2020 2020 6966 2063 7478 2e53          if ctx.S
-0009a5e0: 796d 626f 6c5f 6e61 6d65 5f43 4628 293a  ymbol_name_CF():
-0009a5f0: 0a20 2020 2020 2020 2020 2020 2073 796d  .            sym
-0009a600: 626f 6c5f 6e61 6d65 203d 2073 7472 2863  bol_name = str(c
-0009a610: 7478 2e53 796d 626f 6c5f 6e61 6d65 5f43  tx.Symbol_name_C
-0009a620: 4628 2929 0a20 2020 2020 2020 2020 2020  F()).           
-0009a630: 2069 6620 7379 6d62 6f6c 5f6e 616d 6520   if symbol_name 
-0009a640: 696e 2073 656c 662e 6576 616c 7561 7465  in self.evaluate
-0009a650: 466f 723a 0a20 2020 2020 2020 2020 2020  For:.           
-0009a660: 2020 2020 2064 656c 2073 656c 662e 6576       del self.ev
-0009a670: 616c 7561 7465 466f 725b 7379 6d62 6f6c  aluateFor[symbol
-0009a680: 5f6e 616d 655d 0a0a 2020 2020 2320 456e  _name]..    # En
-0009a690: 7465 7220 6120 7061 7273 6520 7472 6565  ter a parse tree
-0009a6a0: 2070 726f 6475 6365 6420 6279 2058 706c   produced by Xpl
-0009a6b0: 6f72 4d52 5061 7273 6572 2368 626f 6e64  orMRParser#hbond
-0009a6c0: 5f64 625f 6173 7369 676e 5f6c 6f6f 702e  _db_assign_loop.
-0009a6d0: 0a20 2020 2064 6566 2065 6e74 6572 4862  .    def enterHb
-0009a6e0: 6f6e 645f 6462 5f61 7373 6967 6e5f 6c6f  ond_db_assign_lo
-0009a6f0: 6f70 2873 656c 662c 2063 7478 3a20 5870  op(self, ctx: Xp
-0009a700: 6c6f 724d 5250 6172 7365 722e 4862 6f6e  lorMRParser.Hbon
-0009a710: 645f 6462 5f61 7373 6967 6e5f 6c6f 6f70  d_db_assign_loop
-0009a720: 436f 6e74 6578 7429 3a0a 2020 2020 2020  Context):.      
-0009a730: 2020 7379 6d62 6f6c 5f6e 616d 6520 3d20    symbol_name = 
-0009a740: 4e6f 6e65 0a20 2020 2020 2020 2069 6620  None.        if 
-0009a750: 6374 782e 5379 6d62 6f6c 5f6e 616d 655f  ctx.Symbol_name_
-0009a760: 4346 2829 3a0a 2020 2020 2020 2020 2020  CF():.          
-0009a770: 2020 7379 6d62 6f6c 5f6e 616d 6520 3d20    symbol_name = 
-0009a780: 7374 7228 6374 782e 5379 6d62 6f6c 5f6e  str(ctx.Symbol_n
-0009a790: 616d 655f 4346 2829 290a 0a20 2020 2020  ame_CF())..     
-0009a7a0: 2020 2069 6620 6374 782e 496e 7465 6765     if ctx.Intege
-0009a7b0: 725f 4346 2830 293a 0a20 2020 2020 2020  r_CF(0):.       
-0009a7c0: 2020 2020 2069 6e74 5f6c 6973 7420 3d20       int_list = 
-0009a7d0: 5b5d 0a20 2020 2020 2020 2020 2020 2069  [].            i
-0009a7e0: 6478 203d 2030 0a20 2020 2020 2020 2020  dx = 0.         
-0009a7f0: 2020 2077 6869 6c65 2054 7275 653a 0a20     while True:. 
-0009a800: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0009a810: 6620 6374 782e 496e 7465 6765 725f 4346  f ctx.Integer_CF
-0009a820: 2869 6478 293a 0a20 2020 2020 2020 2020  (idx):.         
-0009a830: 2020 2020 2020 2020 2020 2069 6e74 5f6c             int_l
-0009a840: 6973 742e 6170 7065 6e64 2869 6e74 2873  ist.append(int(s
-0009a850: 7472 2863 7478 2e49 6e74 6567 6572 5f43  tr(ctx.Integer_C
-0009a860: 4628 6964 7829 2929 290a 2020 2020 2020  F(idx)))).      
-0009a870: 2020 2020 2020 2020 2020 2020 2020 6964                id
-0009a880: 7820 2b3d 2031 0a20 2020 2020 2020 2020  x += 1.         
-0009a890: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0009a8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009a8b0: 2062 7265 616b 0a20 2020 2020 2020 2020   break.         
-0009a8c0: 2020 2069 6620 7379 6d62 6f6c 5f6e 616d     if symbol_nam
-0009a8d0: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
-0009a8e0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0009a8f0: 656c 662e 6576 616c 7561 7465 466f 725b  elf.evaluateFor[
-0009a900: 7379 6d62 6f6c 5f6e 616d 655d 203d 2069  symbol_name] = i
-0009a910: 6e74 5f6c 6973 740a 0a20 2020 2020 2020  nt_list..       
-0009a920: 2069 6620 6374 782e 5265 616c 5f43 4628   if ctx.Real_CF(
-0009a930: 3029 3a0a 2020 2020 2020 2020 2020 2020  0):.            
-0009a940: 7265 616c 5f6c 6973 7420 3d20 5b5d 0a20  real_list = []. 
-0009a950: 2020 2020 2020 2020 2020 2069 6478 203d             idx =
-0009a960: 2030 0a20 2020 2020 2020 2020 2020 2077   0.            w
-0009a970: 6869 6c65 2054 7275 653a 0a20 2020 2020  hile True:.     
-0009a980: 2020 2020 2020 2020 2020 2069 6620 6374             if ct
-0009a990: 782e 5265 616c 5f43 4628 6964 7829 3a0a  x.Real_CF(idx):.
-0009a9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009a9b0: 2020 2020 7265 616c 5f6c 6973 742e 6170      real_list.ap
-0009a9c0: 7065 6e64 2866 6c6f 6174 2873 7472 2863  pend(float(str(c
-0009a9d0: 7478 2e52 6561 6c5f 4346 2869 6478 2929  tx.Real_CF(idx))
-0009a9e0: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
-0009a9f0: 2020 2020 2020 2069 6478 202b 3d20 310a         idx += 1.
-0009aa00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009aa10: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0009aa20: 2020 2020 2020 2020 2020 6272 6561 6b0a            break.
-0009aa30: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0009aa40: 796d 626f 6c5f 6e61 6d65 5b30 5d20 6973  ymbol_name[0] is
-0009aa50: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-0009aa60: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0009aa70: 6576 616c 7561 7465 466f 725b 7379 6d62  evaluateFor[symb
-0009aa80: 6f6c 5f6e 616d 655d 203d 2072 6561 6c5f  ol_name] = real_
-0009aa90: 6c69 7374 0a0a 2020 2020 2020 2020 6966  list..        if
-0009aaa0: 2063 7478 2e53 696d 706c 655f 6e61 6d65   ctx.Simple_name
-0009aab0: 5f43 4628 3029 3a0a 2020 2020 2020 2020  _CF(0):.        
-0009aac0: 2020 2020 7374 725f 6c69 7374 203d 205b      str_list = [
-0009aad0: 5d0a 2020 2020 2020 2020 2020 2020 6964  ].            id
-0009aae0: 7820 3d20 300a 2020 2020 2020 2020 2020  x = 0.          
-0009aaf0: 2020 7768 696c 6520 5472 7565 3a0a 2020    while True:.  
-0009ab00: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0009ab10: 2063 7478 2e53 696d 706c 655f 6e61 6d65   ctx.Simple_name
-0009ab20: 5f43 4628 6964 7829 3a0a 2020 2020 2020  _CF(idx):.      
-0009ab30: 2020 2020 2020 2020 2020 2020 2020 7374                st
-0009ab40: 725f 6c69 7374 2e61 7070 656e 6428 7374  r_list.append(st
-0009ab50: 7228 6374 782e 5369 6d70 6c65 5f6e 616d  r(ctx.Simple_nam
-0009ab60: 655f 4346 2869 6478 2929 290a 2020 2020  e_CF(idx))).    
-0009ab70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009ab80: 6964 7820 2b3d 2031 0a20 2020 2020 2020  idx += 1.       
-0009ab90: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-0009aba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009abb0: 2020 2062 7265 616b 0a20 2020 2020 2020     break.       
-0009abc0: 2020 2020 2069 6620 7379 6d62 6f6c 5f6e       if symbol_n
-0009abd0: 616d 6520 6973 206e 6f74 204e 6f6e 653a  ame is not None:
-0009abe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0009abf0: 2073 656c 662e 6576 616c 7561 7465 466f   self.evaluateFo
-0009ac00: 725b 7379 6d62 6f6c 5f6e 616d 655d 203d  r[symbol_name] =
-0009ac10: 2073 7472 5f6c 6973 740a 0a20 2020 2023   str_list..    #
-0009ac20: 2045 7869 7420 6120 7061 7273 6520 7472   Exit a parse tr
-0009ac30: 6565 2070 726f 6475 6365 6420 6279 2058  ee produced by X
-0009ac40: 706c 6f72 4d52 5061 7273 6572 2368 626f  plorMRParser#hbo
-0009ac50: 6e64 5f64 625f 6173 7369 676e 5f6c 6f6f  nd_db_assign_loo
-0009ac60: 702e 0a20 2020 2064 6566 2065 7869 7448  p..    def exitH
-0009ac70: 626f 6e64 5f64 625f 6173 7369 676e 5f6c  bond_db_assign_l
-0009ac80: 6f6f 7028 7365 6c66 2c20 6374 783a 2058  oop(self, ctx: X
-0009ac90: 706c 6f72 4d52 5061 7273 6572 2e48 626f  plorMRParser.Hbo
-0009aca0: 6e64 5f64 625f 6173 7369 676e 5f6c 6f6f  nd_db_assign_loo
-0009acb0: 7043 6f6e 7465 7874 293a 0a20 2020 2020  pContext):.     
-0009acc0: 2020 2069 6620 6374 782e 5379 6d62 6f6c     if ctx.Symbol
-0009acd0: 5f6e 616d 655f 4346 2829 3a0a 2020 2020  _name_CF():.    
-0009ace0: 2020 2020 2020 2020 7379 6d62 6f6c 5f6e          symbol_n
-0009acf0: 616d 6520 3d20 7374 7228 6374 782e 5379  ame = str(ctx.Sy
-0009ad00: 6d62 6f6c 5f6e 616d 655f 4346 2829 290a  mbol_name_CF()).
-0009ad10: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0009ad20: 796d 626f 6c5f 6e61 6d65 2069 6e20 7365  ymbol_name in se
-0009ad30: 6c66 2e65 7661 6c75 6174 6546 6f72 3a0a  lf.evaluateFor:.
-0009ad40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009ad50: 6465 6c20 7365 6c66 2e65 7661 6c75 6174  del self.evaluat
-0009ad60: 6546 6f72 5b73 796d 626f 6c5f 6e61 6d65  eFor[symbol_name
-0009ad70: 5d0a 0a20 2020 2023 2045 6e74 6572 2061  ]..    # Enter a
-0009ad80: 2070 6172 7365 2074 7265 6520 7072 6f64   parse tree prod
-0009ad90: 7563 6564 2062 7920 5870 6c6f 724d 5250  uced by XplorMRP
-0009ada0: 6172 7365 7223 706c 616e 6172 5f67 726f  arser#planar_gro
-0009adb0: 7570 5f6c 6f6f 702e 0a20 2020 2064 6566  up_loop..    def
-0009adc0: 2065 6e74 6572 506c 616e 6172 5f67 726f   enterPlanar_gro
-0009add0: 7570 5f6c 6f6f 7028 7365 6c66 2c20 6374  up_loop(self, ct
-0009ade0: 783a 2058 706c 6f72 4d52 5061 7273 6572  x: XplorMRParser
-0009adf0: 2e50 6c61 6e61 725f 6772 6f75 705f 6c6f  .Planar_group_lo
-0009ae00: 6f70 436f 6e74 6578 7429 3a0a 2020 2020  opContext):.    
-0009ae10: 2020 2020 7379 6d62 6f6c 5f6e 616d 6520      symbol_name 
-0009ae20: 3d20 4e6f 6e65 0a20 2020 2020 2020 2069  = None.        i
-0009ae30: 6620 6374 782e 5379 6d62 6f6c 5f6e 616d  f ctx.Symbol_nam
-0009ae40: 655f 4346 2829 3a0a 2020 2020 2020 2020  e_CF():.        
-0009ae50: 2020 2020 7379 6d62 6f6c 5f6e 616d 6520      symbol_name 
-0009ae60: 3d20 7374 7228 6374 782e 5379 6d62 6f6c  = str(ctx.Symbol
-0009ae70: 5f6e 616d 655f 4346 2829 290a 0a20 2020  _name_CF())..   
-0009ae80: 2020 2020 2069 6620 6374 782e 496e 7465       if ctx.Inte
-0009ae90: 6765 725f 4346 2830 293a 0a20 2020 2020  ger_CF(0):.     
-0009aea0: 2020 2020 2020 2069 6e74 5f6c 6973 7420         int_list 
-0009aeb0: 3d20 5b5d 0a20 2020 2020 2020 2020 2020  = [].           
-0009aec0: 2069 6478 203d 2030 0a20 2020 2020 2020   idx = 0.       
-0009aed0: 2020 2020 2077 6869 6c65 2054 7275 653a       while True:
-0009aee0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0009aef0: 2069 6620 6374 782e 496e 7465 6765 725f   if ctx.Integer_
-0009af00: 4346 2869 6478 293a 0a20 2020 2020 2020  CF(idx):.       
-0009af10: 2020 2020 2020 2020 2020 2020 2069 6e74               int
-0009af20: 5f6c 6973 742e 6170 7065 6e64 2869 6e74  _list.append(int
-0009af30: 2873 7472 2863 7478 2e49 6e74 6567 6572  (str(ctx.Integer
-0009af40: 5f43 4628 6964 7829 2929 290a 2020 2020  _CF(idx)))).    
-0009af50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009af60: 6964 7820 2b3d 2031 0a20 2020 2020 2020  idx += 1.       
-0009af70: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-0009af80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009af90: 2020 2062 7265 616b 0a20 2020 2020 2020     break.       
-0009afa0: 2020 2020 2069 6620 7379 6d62 6f6c 5f6e       if symbol_n
-0009afb0: 616d 6520 6973 206e 6f74 204e 6f6e 653a  ame is not None:
-0009afc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0009afd0: 2073 656c 662e 6576 616c 7561 7465 466f   self.evaluateFo
-0009afe0: 725b 7379 6d62 6f6c 5f6e 616d 655d 203d  r[symbol_name] =
-0009aff0: 2069 6e74 5f6c 6973 740a 0a20 2020 2020   int_list..     
-0009b000: 2020 2069 6620 6374 782e 5265 616c 5f43     if ctx.Real_C
-0009b010: 4628 3029 3a0a 2020 2020 2020 2020 2020  F(0):.          
-0009b020: 2020 7265 616c 5f6c 6973 7420 3d20 5b5d    real_list = []
-0009b030: 0a20 2020 2020 2020 2020 2020 2069 6478  .            idx
-0009b040: 203d 2030 0a20 2020 2020 2020 2020 2020   = 0.           
-0009b050: 2077 6869 6c65 2054 7275 653a 0a20 2020   while True:.   
-0009b060: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0009b070: 6374 782e 5265 616c 5f43 4628 6964 7829  ctx.Real_CF(idx)
-0009b080: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0009b090: 2020 2020 2020 7265 616c 5f6c 6973 742e        real_list.
-0009b0a0: 6170 7065 6e64 2866 6c6f 6174 2873 7472  append(float(str
-0009b0b0: 2863 7478 2e52 6561 6c5f 4346 2869 6478  (ctx.Real_CF(idx
-0009b0c0: 2929 2929 0a20 2020 2020 2020 2020 2020  )))).           
-0009b0d0: 2020 2020 2020 2020 2069 6478 202b 3d20           idx += 
-0009b0e0: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
-0009b0f0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0009b100: 2020 2020 2020 2020 2020 2020 6272 6561              brea
-0009b110: 6b0a 2020 2020 2020 2020 2020 2020 6966  k.            if
-0009b120: 2073 796d 626f 6c5f 6e61 6d65 5b30 5d20   symbol_name[0] 
-0009b130: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-0009b140: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0009b150: 662e 6576 616c 7561 7465 466f 725b 7379  f.evaluateFor[sy
-0009b160: 6d62 6f6c 5f6e 616d 655d 203d 2072 6561  mbol_name] = rea
-0009b170: 6c5f 6c69 7374 0a0a 2020 2020 2020 2020  l_list..        
-0009b180: 6966 2063 7478 2e53 696d 706c 655f 6e61  if ctx.Simple_na
-0009b190: 6d65 5f43 4628 3029 3a0a 2020 2020 2020  me_CF(0):.      
-0009b1a0: 2020 2020 2020 7374 725f 6c69 7374 203d        str_list =
-0009b1b0: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
-0009b1c0: 6964 7820 3d20 300a 2020 2020 2020 2020  idx = 0.        
-0009b1d0: 2020 2020 7768 696c 6520 5472 7565 3a0a      while True:.
-0009b1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009b1f0: 6966 2063 7478 2e53 696d 706c 655f 6e61  if ctx.Simple_na
-0009b200: 6d65 5f43 4628 6964 7829 3a0a 2020 2020  me_CF(idx):.    
-0009b210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009b220: 7374 725f 6c69 7374 2e61 7070 656e 6428  str_list.append(
-0009b230: 7374 7228 6374 782e 5369 6d70 6c65 5f6e  str(ctx.Simple_n
-0009b240: 616d 655f 4346 2869 6478 2929 290a 2020  ame_CF(idx))).  
-0009b250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009b260: 2020 6964 7820 2b3d 2031 0a20 2020 2020    idx += 1.     
-0009b270: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0009b280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0009b290: 2020 2020 2062 7265 616b 0a20 2020 2020       break.     
-0009b2a0: 2020 2020 2020 2069 6620 7379 6d62 6f6c         if symbol
-0009b2b0: 5f6e 616d 6520 6973 206e 6f74 204e 6f6e  _name is not Non
-0009b2c0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0009b2d0: 2020 2073 656c 662e 6576 616c 7561 7465     self.evaluate
-0009b2e0: 466f 725b 7379 6d62 6f6c 5f6e 616d 655d  For[symbol_name]
-0009b2f0: 203d 2073 7472 5f6c 6973 740a 0a20 2020   = str_list..   
-0009b300: 2023 2045 7869 7420 6120 7061 7273 6520   # Exit a parse 
-0009b310: 7472 6565 2070 726f 6475 6365 6420 6279  tree produced by
-0009b320: 2058 706c 6f72 4d52 5061 7273 6572 2370   XplorMRParser#p
-0009b330: 6c61 6e61 725f 6772 6f75 705f 6c6f 6f70  lanar_group_loop
-0009b340: 2e0a 2020 2020 6465 6620 6578 6974 506c  ..    def exitPl
-0009b350: 616e 6172 5f67 726f 7570 5f6c 6f6f 7028  anar_group_loop(
-0009b360: 7365 6c66 2c20 6374 783a 2058 706c 6f72  self, ctx: Xplor
-0009b370: 4d52 5061 7273 6572 2e50 6c61 6e61 725f  MRParser.Planar_
-0009b380: 6772 6f75 705f 6c6f 6f70 436f 6e74 6578  group_loopContex
-0009b390: 7429 3a0a 2020 2020 2020 2020 6966 2063  t):.        if c
-0009b3a0: 7478 2e53 796d 626f 6c5f 6e61 6d65 5f43  tx.Symbol_name_C
-0009b3b0: 4628 293a 0a20 2020 2020 2020 2020 2020  F():.           
-0009b3c0: 2073 796d 626f 6c5f 6e61 6d65 203d 2073   symbol_name = s
-0009b3d0: 7472 2863 7478 2e53 796d 626f 6c5f 6e61  tr(ctx.Symbol_na
-0009b3e0: 6d65 5f43 4628 2929 0a20 2020 2020 2020  me_CF()).       
-0009b3f0: 2020 2020 2069 6620 7379 6d62 6f6c 5f6e       if symbol_n
-0009b400: 616d 6520 696e 2073 656c 662e 6576 616c  ame in self.eval
-0009b410: 7561 7465 466f 723a 0a20 2020 2020 2020  uateFor:.       
-0009b420: 2020 2020 2020 2020 2064 656c 2073 656c           del sel
-0009b430: 662e 6576 616c 7561 7465 466f 725b 7379  f.evaluateFor[sy
-0009b440: 6d62 6f6c 5f6e 616d 655d 0a0a 2020 2020  mbol_name]..    
-0009b450: 6465 6620 5f5f 6765 7443 7572 7265 6e74  def __getCurrent
-0009b460: 5265 7374 7261 696e 7428 7365 6c66 293a  Restraint(self):
-0009b470: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-0009b480: 2e5f 5f63 7572 5f73 7562 7479 7065 203d  .__cur_subtype =
-0009b490: 3d20 2764 6973 7427 3a0a 2020 2020 2020  = 'dist':.      
-0009b4a0: 2020 2020 2020 7265 7475 726e 2066 225b        return f"[
-0009b4b0: 4368 6563 6b20 7468 6520 7b73 656c 662e  Check the {self.
-0009b4c0: 6469 7374 5265 7374 7261 696e 7473 7d74  distRestraints}t
-0009b4d0: 6820 726f 7720 6f66 2064 6973 7461 6e63  h row of distanc
-0009b4e0: 6520 7265 7374 7261 696e 7473 5d20 220a  e restraints] ".
-0009b4f0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0009b500: 5f5f 6375 725f 7375 6274 7970 6520 3d3d  __cur_subtype ==
-0009b510: 2027 6469 6865 6427 3a0a 2020 2020 2020   'dihed':.      
-0009b520: 2020 2020 2020 7265 7475 726e 2066 225b        return f"[
-0009b530: 4368 6563 6b20 7468 6520 7b73 656c 662e  Check the {self.
-0009b540: 6469 6865 6452 6573 7472 6169 6e74 737d  dihedRestraints}
-0009b550: 7468 2072 6f77 206f 6620 6469 6865 6472  th row of dihedr
-0009b560: 616c 2061 6e67 6c65 2072 6573 7472 6169  al angle restrai
-0009b570: 6e74 735d 2022 0a20 2020 2020 2020 2069  nts] ".        i
-0009b580: 6620 7365 6c66 2e5f 5f63 7572 5f73 7562  f self.__cur_sub
-0009b590: 7479 7065 203d 3d20 2772 6463 273a 0a20  type == 'rdc':. 
-0009b5a0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0009b5b0: 6e20 6622 5b43 6865 636b 2074 6865 207b  n f"[Check the {
-0009b5c0: 7365 6c66 2e72 6463 5265 7374 7261 696e  self.rdcRestrain
-0009b5d0: 7473 7d74 6820 726f 7720 6f66 2072 6573  ts}th row of res
-0009b5e0: 6964 7561 6c20 6469 706f 6c61 7220 636f  idual dipolar co
-0009b5f0: 7570 6c69 6e67 2072 6573 7472 6169 6e74  upling restraint
-0009b600: 735d 2022 0a20 2020 2020 2020 2069 6620  s] ".        if 
-0009b610: 7365 6c66 2e5f 5f63 7572 5f73 7562 7479  self.__cur_subty
-0009b620: 7065 203d 3d20 2770 6c61 6e65 273a 0a20  pe == 'plane':. 
-0009b630: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0009b640: 6e20 6622 5b43 6865 636b 2074 6865 207b  n f"[Check the {
-0009b650: 7365 6c66 2e70 6c61 6e65 5265 7374 7261  self.planeRestra
-0009b660: 696e 7473 7d74 6820 726f 7720 6f66 2070  ints}th row of p
-0009b670: 6c61 6e61 6c69 7479 2072 6573 7472 6169  lanality restrai
-0009b680: 6e74 735d 2022 0a20 2020 2020 2020 2069  nts] ".        i
-0009b690: 6620 7365 6c66 2e5f 5f63 7572 5f73 7562  f self.__cur_sub
-0009b6a0: 7479 7065 203d 3d20 2761 6469 7374 273a  type == 'adist':
-0009b6b0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0009b6c0: 7572 6e20 6622 5b43 6865 636b 2074 6865  urn f"[Check the
-0009b6d0: 207b 7365 6c66 2e61 6469 7374 5265 7374   {self.adistRest
-0009b6e0: 7261 696e 7473 7d74 6820 726f 7720 6f66  raints}th row of
-0009b6f0: 2061 6e74 6964 6973 7461 6e63 6520 7265   antidistance re
-0009b700: 7374 7261 696e 7473 5d20 220a 2020 2020  straints] ".    
-0009b710: 2020 2020 6966 2073 656c 662e 5f5f 6375      if self.__cu
-0009b720: 725f 7375 6274 7970 6520 3d3d 2027 6a63  r_subtype == 'jc
-0009b730: 6f75 7027 3a0a 2020 2020 2020 2020 2020  oup':.          
-0009b740: 2020 7265 7475 726e 2066 225b 4368 6563    return f"[Chec
-0009b750: 6b20 7468 6520 7b73 656c 662e 6a63 6f75  k the {self.jcou
-0009b760: 7052 6573 7472 6169 6e74 737d 7468 2072  pRestraints}th r
-0009b770: 6f77 206f 6620 7363 616c 6172 204a 2d63  ow of scalar J-c
-0009b780: 6f75 706c 696e 6720 7265 7374 7261 696e  oupling restrain
-0009b790: 7473 5d20 220a 2020 2020 2020 2020 6966  ts] ".        if
-0009b7a0: 2073 656c 662e 5f5f 6375 725f 7375 6274   self.__cur_subt
-0009b7b0: 7970 6520 3d3d 2027 6876 7963 7327 3a0a  ype == 'hvycs':.
-0009b7c0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0009b7d0: 726e 2066 225b 4368 6563 6b20 7468 6520  rn f"[Check the 
-0009b7e0: 7b73 656c 662e 6876 7963 7352 6573 7472  {self.hvycsRestr
-0009b7f0: 6169 6e74 737d 7468 2072 6f77 206f 6620  aints}th row of 
-0009b800: 6361 7262 6f6e 2063 6865 6d69 6361 6c20  carbon chemical 
-0009b810: 7368 6966 7420 7265 7374 7261 696e 7473  shift restraints
-0009b820: 5d20 220a 2020 2020 2020 2020 6966 2073  ] ".        if s
-0009b830: 656c 662e 5f5f 6375 725f 7375 6274 7970  elf.__cur_subtyp
-0009b840: 6520 3d3d 2027 7072 6f63 7327 3a0a 2020  e == 'procs':.  
-0009b850: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0009b860: 2066 225b 4368 6563 6b20 7468 6520 7b73   f"[Check the {s
-0009b870: 656c 662e 7072 6f63 7352 6573 7472 6169  elf.procsRestrai
-0009b880: 6e74 737d 7468 2072 6f77 206f 6620 7072  nts}th row of pr
-0009b890: 6f74 6f6e 2063 6865 6d69 6361 6c20 7368  oton chemical sh
-0009b8a0: 6966 7420 7265 7374 7261 696e 7473 5d20  ift restraints] 
-0009b8b0: 220a 2020 2020 2020 2020 6966 2073 656c  ".        if sel
-0009b8c0: 662e 5f5f 6375 725f 7375 6274 7970 6520  f.__cur_subtype 
-0009b8d0: 3d3d 2027 7261 6d61 273a 0a20 2020 2020  == 'rama':.     
-0009b8e0: 2020 2020 2020 2072 6574 7572 6e20 6622         return f"
-0009b8f0: 5b43 6865 636b 2074 6865 207b 7365 6c66  [Check the {self
-0009b900: 2e72 616d 6152 6573 7472 6169 6e74 737d  .ramaRestraints}
-0009b910: 7468 2072 6f77 206f 6620 6469 6865 6472  th row of dihedr
-0009b920: 616c 2061 6e67 6c65 2064 6174 6162 6173  al angle databas
-0009b930: 6520 7265 7374 7261 696e 7473 5d20 220a  e restraints] ".
-0009b940: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0009b950: 5f5f 6375 725f 7375 6274 7970 6520 3d3d  __cur_subtype ==
-0009b960: 2027 7261 6469 273a 0a20 2020 2020 2020   'radi':.       
-0009b970: 2020 2020 2072 6574 7572 6e20 6622 5b43       return f"[C
-0009b980: 6865 636b 2074 6865 207b 7365 6c66 2e72  heck the {self.r
-0009b990: 6164 6952 6573 7472 6169 6e74 737d 7468  adiRestraints}th
-0009b9a0: 2072 6f77 206f 6620 7261 6469 7573 206f   row of radius o
-0009b9b0: 6620 6779 7261 7469 6f6e 2072 6573 7472  f gyration restr
-0009b9c0: 6169 6e74 735d 2022 0a20 2020 2020 2020  aints] ".       
-0009b9d0: 2069 6620 7365 6c66 2e5f 5f63 7572 5f73   if self.__cur_s
-0009b9e0: 7562 7479 7065 203d 3d20 2764 6966 6627  ubtype == 'diff'
-0009b9f0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0009ba00: 7475 726e 2066 225b 4368 6563 6b20 7468  turn f"[Check th
-0009ba10: 6520 7b73 656c 662e 6469 6666 5265 7374  e {self.diffRest
-0009ba20: 7261 696e 7473 7d74 6820 726f 7720 6f66  raints}th row of
-0009ba30: 2064 7566 6675 7369 6f6e 2061 6e69 736f   duffusion aniso
-0009ba40: 7472 6f70 7920 7265 7374 7261 696e 7473  tropy restraints
-0009ba50: 5d20 220a 2020 2020 2020 2020 6966 2073  ] ".        if s
-0009ba60: 656c 662e 5f5f 6375 725f 7375 6274 7970  elf.__cur_subtyp
-0009ba70: 6520 3d3d 2027 6e62 6173 6527 3a0a 2020  e == 'nbase':.  
-0009ba80: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0009ba90: 2066 225b 4368 6563 6b20 7468 6520 7b73   f"[Check the {s
-0009baa0: 656c 662e 6e62 6173 6552 6573 7472 6169  elf.nbaseRestrai
-0009bab0: 6e74 737d 7468 2072 6f77 206f 6620 7265  nts}th row of re
-0009bac0: 7369 6475 652d 7265 7369 6475 6520 706f  sidue-residue po
-0009bad0: 7369 7469 6f6e 2f6f 7269 656e 7461 7469  sition/orientati
-0009bae0: 6f6e 2064 6174 6162 6173 6520 7265 7374  on database rest
-0009baf0: 7261 696e 7473 5d20 220a 2020 2020 2020  raints] ".      
-0009bb00: 2020 6966 2073 656c 662e 5f5f 6375 725f    if self.__cur_
-0009bb10: 7375 6274 7970 6520 3d3d 2027 6373 6127  subtype == 'csa'
-0009bb20: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0009bb30: 7475 726e 2066 225b 4368 6563 6b20 7468  turn f"[Check th
-0009bb40: 6520 7b73 656c 662e 6373 6152 6573 7472  e {self.csaRestr
-0009bb50: 6169 6e74 737d 7468 2072 6f77 206f 6620  aints}th row of 
-0009bb60: 2870 7365 7564 6f29 2063 6865 6d69 6361  (pseudo) chemica
-0009bb70: 6c20 7368 6966 7420 616e 6973 6f74 726f  l shift anisotro
-0009bb80: 7079 2072 6573 7472 6169 6e74 735d 2022  py restraints] "
-0009bb90: 0a20 2020 2020 2020 2023 2069 6620 7365  .        # if se
-0009bba0: 6c66 2e5f 5f63 7572 5f73 7562 7479 7065  lf.__cur_subtype
-0009bbb0: 203d 3d20 2761 6e67 273a 0a20 2020 2020   == 'ang':.     
-0009bbc0: 2020 2023 2020 2020 2072 6574 7572 6e20     #     return 
-0009bbd0: 6622 5b43 6865 636b 2074 6865 207b 7365  f"[Check the {se
-0009bbe0: 6c66 2e61 6e67 5265 7374 7261 696e 7473  lf.angRestraints
-0009bbf0: 7d74 6820 726f 7720 6f66 2061 6e67 6c65  }th row of angle
-0009bc00: 2064 6174 6162 6173 6520 7265 7374 7261   database restra
-0009bc10: 696e 7473 5d20 220a 2020 2020 2020 2020  ints] ".        
-0009bc20: 6966 2073 656c 662e 5f5f 6375 725f 7375  if self.__cur_su
-0009bc30: 6274 7970 6520 3d3d 2027 7072 6527 3a0a  btype == 'pre':.
-0009bc40: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0009bc50: 726e 2066 225b 4368 6563 6b20 7468 6520  rn f"[Check the 
-0009bc60: 7b73 656c 662e 7072 6552 6573 7472 6169  {self.preRestrai
-0009bc70: 6e74 737d 7468 2072 6f77 206f 6620 7061  nts}th row of pa
-0009bc80: 7261 6d61 676e 6574 6963 2072 656c 6178  ramagnetic relax
-0009bc90: 6174 696f 6e20 656e 6861 6e63 656d 656e  ation enhancemen
-0009bca0: 7420 7265 7374 7261 696e 7473 5d20 220a  t restraints] ".
-0009bcb0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0009bcc0: 5f5f 6375 725f 7375 6274 7970 6520 3d3d  __cur_subtype ==
-0009bcd0: 2027 7063 7327 3a0a 2020 2020 2020 2020   'pcs':.        
-0009bce0: 2020 2020 7265 7475 726e 2066 225b 4368      return f"[Ch
-0009bcf0: 6563 6b20 7468 6520 7b73 656c 662e 7063  eck the {self.pc
-0009bd00: 7352 6573 7472 6169 6e74 737d 7468 2072  sRestraints}th r
-0009bd10: 6f77 206f 6620 7061 7261 6d61 676e 6574  ow of paramagnet
-0009bd20: 6963 2070 7365 7564 6f63 6f6e 7461 6374  ic pseudocontact
-0009bd30: 2073 6869 6674 2072 6573 7472 6169 6e74   shift restraint
-0009bd40: 735d 2022 0a20 2020 2020 2020 2069 6620  s] ".        if 
-0009bd50: 7365 6c66 2e5f 5f63 7572 5f73 7562 7479  self.__cur_subty
-0009bd60: 7065 203d 3d20 2770 7264 6327 3a0a 2020  pe == 'prdc':.  
-0009bd70: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0009bd80: 2066 225b 4368 6563 6b20 7468 6520 7b73   f"[Check the {s
-0009bd90: 656c 662e 7072 6463 5265 7374 7261 696e  elf.prdcRestrain
-0009bda0: 7473 7d74 6820 726f 7720 6f66 2070 6172  ts}th row of par
-0009bdb0: 616d 6167 6e65 7469 6320 7265 7369 6475  amagnetic residu
-0009bdc0: 616c 2064 6970 6f6c 6172 2063 6f75 706c  al dipolar coupl
-0009bdd0: 696e 6720 7265 7374 7261 696e 7473 5d20  ing restraints] 
-0009bde0: 220a 2020 2020 2020 2020 6966 2073 656c  ".        if sel
-0009bdf0: 662e 5f5f 6375 725f 7375 6274 7970 6520  f.__cur_subtype 
-0009be00: 3d3d 2027 7061 6e67 273a 0a20 2020 2020  == 'pang':.     
-0009be10: 2020 2020 2020 2072 6574 7572 6e20 6622         return f"
-0009be20: 5b43 6865 636b 2074 6865 207b 7365 6c66  [Check the {self
-0009be30: 2e70 616e 6752 6573 7472 6169 6e74 737d  .pangRestraints}
-0009be40: 7468 2072 6f77 206f 6620 7061 7261 6d61  th row of parama
-0009be50: 676e 6574 6963 206f 7269 656e 7461 7469  gnetic orientati
-0009be60: 6f6e 2072 6573 7472 6169 6e74 735d 2022  on restraints] "
-0009be70: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-0009be80: 2e5f 5f63 7572 5f73 7562 7479 7065 203d  .__cur_subtype =
-0009be90: 3d20 2770 6363 7227 3a0a 2020 2020 2020  = 'pccr':.      
-0009bea0: 2020 2020 2020 7265 7475 726e 2066 225b        return f"[
-0009beb0: 4368 6563 6b20 7468 6520 7b73 656c 662e  Check the {self.
-0009bec0: 7063 6372 5265 7374 7261 696e 7473 7d74  pccrRestraints}t
-0009bed0: 6820 726f 7720 6f66 2070 6172 616d 6167  h row of paramag
-0009bee0: 6e65 7469 6320 6372 6f73 732d 636f 7272  netic cross-corr
-0009bef0: 656c 6174 696f 6e20 7261 7465 2072 6573  elation rate res
-0009bf00: 7472 6169 6e74 735d 2022 0a20 2020 2020  traints] ".     
-0009bf10: 2020 2069 6620 7365 6c66 2e5f 5f63 7572     if self.__cur
-0009bf20: 5f73 7562 7479 7065 203d 3d20 2768 626f  _subtype == 'hbo
-0009bf30: 6e64 273a 0a20 2020 2020 2020 2020 2020  nd':.           
-0009bf40: 2072 6574 7572 6e20 6622 5b43 6865 636b   return f"[Check
-0009bf50: 2074 6865 207b 7365 6c66 2e68 626f 6e64   the {self.hbond
-0009bf60: 5265 7374 7261 696e 7473 7d74 6820 726f  Restraints}th ro
-0009bf70: 7720 6f66 2068 7964 726f 6765 6e20 626f  w of hydrogen bo
-0009bf80: 6e64 2067 656f 6d65 7472 7920 7265 7374  nd geometry rest
-0009bf90: 7261 696e 7473 5d20 220a 2020 2020 2020  raints] ".      
-0009bfa0: 2020 6966 2073 656c 662e 5f5f 6375 725f    if self.__cur_
-0009bfb0: 7375 6274 7970 6520 3d3d 2027 6765 6f27  subtype == 'geo'
-0009bfc0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0009bfd0: 7475 726e 2066 225b 4368 6563 6b20 7468  turn f"[Check th
-0009bfe0: 6520 7b73 656c 662e 6765 6f52 6573 7472  e {self.geoRestr
-0009bff0: 6169 6e74 737d 7468 2072 6f77 206f 6620  aints}th row of 
-0009c000: 6861 726d 6f6e 6963 2063 6f6f 7264 696e  harmonic coordin
-0009c010: 6174 652f 4e43 5320 7265 7374 7261 696e  ate/NCS restrain
-0009c020: 7473 5d20 220a 2020 2020 2020 2020 7265  ts] ".        re
-0009c030: 7475 726e 2027 270a 0a20 2020 2064 6566  turn ''..    def
-0009c040: 205f 5f73 6574 4c6f 6361 6c53 6571 5363   __setLocalSeqSc
-0009c050: 6865 6d65 2873 656c 6629 3a0a 2020 2020  heme(self):.    
-0009c060: 2020 2020 6966 2027 6c6f 6361 6c5f 7365      if 'local_se
-0009c070: 715f 7363 6865 6d65 2720 6e6f 7420 696e  q_scheme' not in
-0009c080: 2073 656c 662e 7265 6173 6f6e 7346 6f72   self.reasonsFor
-0009c090: 5265 5061 7273 696e 673a 0a20 2020 2020  ReParsing:.     
-0009c0a0: 2020 2020 2020 2073 656c 662e 7265 6173         self.reas
-0009c0b0: 6f6e 7346 6f72 5265 5061 7273 696e 675b  onsForReParsing[
-0009c0c0: 276c 6f63 616c 5f73 6571 5f73 6368 656d  'local_seq_schem
-0009c0d0: 6527 5d20 3d20 7b7d 0a20 2020 2020 2020  e'] = {}.       
-0009c0e0: 2069 6620 7365 6c66 2e5f 5f63 7572 5f73   if self.__cur_s
-0009c0f0: 7562 7479 7065 203d 3d20 2764 6973 7427  ubtype == 'dist'
-0009c100: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-0009c110: 6c66 2e72 6561 736f 6e73 466f 7252 6550  lf.reasonsForReP
-0009c120: 6172 7369 6e67 5b27 6c6f 6361 6c5f 7365  arsing['local_se
-0009c130: 715f 7363 6865 6d65 275d 5b28 7365 6c66  q_scheme'][(self
-0009c140: 2e5f 5f63 7572 5f73 7562 7479 7065 2c20  .__cur_subtype, 
-0009c150: 7365 6c66 2e64 6973 7452 6573 7472 6169  self.distRestrai
-0009c160: 6e74 7329 5d20 3d20 7365 6c66 2e5f 5f70  nts)] = self.__p
-0009c170: 7265 6665 7241 7574 6853 6571 0a20 2020  referAuthSeq.   
-0009c180: 2020 2020 2065 6c69 6620 7365 6c66 2e5f       elif self._
-0009c190: 5f63 7572 5f73 7562 7479 7065 203d 3d20  _cur_subtype == 
-0009c1a0: 2764 6968 6564 273a 0a20 2020 2020 2020  'dihed':.       
-0009c1b0: 2020 2020 2073 656c 662e 7265 6173 6f6e       self.reason
-0009c1c0: 7346 6f72 5265 5061 7273 696e 675b 276c  sForReParsing['l
-0009c1d0: 6f63 616c 5f73 6571 5f73 6368 656d 6527  ocal_seq_scheme'
-0009c1e0: 5d5b 2873 656c 662e 5f5f 6375 725f 7375  ][(self.__cur_su
-0009c1f0: 6274 7970 652c 2073 656c 662e 6469 6865  btype, self.dihe
-0009c200: 6452 6573 7472 6169 6e74 7329 5d20 3d20  dRestraints)] = 
-0009c210: 7365 6c66 2e5f 5f70 7265 6665 7241 7574  self.__preferAut
-0009c220: 6853 6571 0a20 2020 2020 2020 2065 6c69  hSeq.        eli
-0009c230: 6620 7365 6c66 2e5f 5f63 7572 5f73 7562  f self.__cur_sub
-0009c240: 7479 7065 203d 3d20 2772 6463 273a 0a20  type == 'rdc':. 
-0009c250: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0009c260: 7265 6173 6f6e 7346 6f72 5265 5061 7273  reasonsForRePars
-0009c270: 696e 675b 276c 6f63 616c 5f73 6571 5f73  ing['local_seq_s
-0009c280: 6368 656d 6527 5d5b 2873 656c 662e 5f5f  cheme'][(self.__
-0009c290: 6375 725f 7375 6274 7970 652c 2073 656c  cur_subtype, sel
-0009c2a0: 662e 7264 6352 6573 7472 6169 6e74 7329  f.rdcRestraints)
-0009c2b0: 5d20 3d20 7365 6c66 2e5f 5f70 7265 6665  ] = self.__prefe
-0009c2c0: 7241 7574 6853 6571 0a20 2020 2020 2020  rAuthSeq.       
-0009c2d0: 2065 6c69 6620 7365 6c66 2e5f 5f63 7572   elif self.__cur
-0009c2e0: 5f73 7562 7479 7065 203d 3d20 2770 6c61  _subtype == 'pla
-0009c2f0: 6e65 273a 0a20 2020 2020 2020 2020 2020  ne':.           
-0009c300: 2073 656c 662e 7265 6173 6f6e 7346 6f72   self.reasonsFor
-0009c310: 5265 5061 7273 696e 675b 276c 6f63 615f  ReParsing['loca_
-0009c320: 7365 715f 7363 6865 6d65 275d 5b28 7365  seq_scheme'][(se
-0009c330: 6c66 2e5f 5f63 7572 5f73 7562 7479 7065  lf.__cur_subtype
-0009c340: 2c20 7365 6c66 2e70 6c61 6e65 5265 7374  , self.planeRest
-0009c350: 7261 696e 7473 295d 203d 2073 656c 662e  raints)] = self.
-0009c360: 5f5f 7072 6566 6572 4175 7468 5365 710a  __preferAuthSeq.
-0009c370: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
-0009c380: 662e 5f5f 6375 725f 7375 6274 7970 6520  f.__cur_subtype 
-0009c390: 3d3d 2027 6164 6973 7427 3a0a 2020 2020  == 'adist':.    
-0009c3a0: 2020 2020 2020 2020 7365 6c66 2e72 6561          self.rea
-0009c3b0: 736f 6e73 466f 7252 6550 6172 7369 6e67  sonsForReParsing
-0009c3c0: 5b27 6c6f 6361 6c5f 7365 715f 7363 6865  ['local_seq_sche
-0009c3d0: 6d65 275d 5b28 7365 6c66 2e5f 5f63 7572  me'][(self.__cur
-0009c3e0: 5f73 7562 7479 7065 2c20 7365 6c66 2e61  _subtype, self.a
-0009c3f0: 6469 7374 5265 7374 7261 696e 7473 295d  distRestraints)]
-0009c400: 203d 2073 656c 662e 5f5f 7072 6566 6572   = self.__prefer
-0009c410: 4175 7468 5365 710a 2020 2020 2020 2020  AuthSeq.        
-0009c420: 656c 6966 2073 656c 662e 5f5f 6375 725f  elif self.__cur_
-0009c430: 7375 6274 7970 6520 3d3d 2027 6a63 6f75  subtype == 'jcou
-0009c440: 7027 3a0a 2020 2020 2020 2020 2020 2020  p':.            
-0009c450: 7365 6c66 2e72 6561 736f 6e73 466f 7252  self.reasonsForR
-0009c460: 6550 6172 7369 6e67 5b27 6c6f 6361 6c5f  eParsing['local_
-0009c470: 7365 715f 7363 6865 6d65 275d 5b28 7365  seq_scheme'][(se
-0009c480: 6c66 2e5f 5f63 7572 5f73 7562 7479 7065  lf.__cur_subtype
-0009c490: 2c20 7365 6c66 2e6a 636f 7570 5265 7374  , self.jcoupRest
-0009c4a0: 7261 696e 7473 295d 203d 2073 656c 662e  raints)] = self.
-0009c4b0: 5f5f 7072 6566 6572 4175 7468 5365 710a  __preferAuthSeq.
-0009c4c0: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
-0009c4d0: 662e 5f5f 6375 725f 7375 6274 7970 6520  f.__cur_subtype 
-0009c4e0: 3d3d 2027 6876 7963 7327 3a0a 2020 2020  == 'hvycs':.    
-0009c4f0: 2020 2020 2020 2020 7365 6c66 2e72 6561          self.rea
-0009c500: 736f 6e73 466f 7252 6550 6172 7369 6e67  sonsForReParsing
-0009c510: 5b27 6c6f 6361 6c5f 7365 715f 7363 6865  ['local_seq_sche
-0009c520: 6d65 275d 5b28 7365 6c66 2e5f 5f63 7572  me'][(self.__cur
-0009c530: 5f73 7562 7479 7065 2c20 7365 6c66 2e68  _subtype, self.h
-0009c540: 7679 6373 5265 7374 7261 696e 7473 295d  vycsRestraints)]
-0009c550: 203d 2073 656c 662e 5f5f 7072 6566 6572   = self.__prefer
-0009c560: 4175 7468 5365 710a 2020 2020 2020 2020  AuthSeq.        
-0009c570: 656c 6966 2073 656c 662e 5f5f 6375 725f  elif self.__cur_
-0009c580: 7375 6274 7970 6520 3d3d 2027 7072 6f63  subtype == 'proc
-0009c590: 7327 3a0a 2020 2020 2020 2020 2020 2020  s':.            
-0009c5a0: 7365 6c66 2e72 6561 736f 6e73 466f 7252  self.reasonsForR
-0009c5b0: 6550 6172 7369 6e67 5b27 6c6f 6361 6c5f  eParsing['local_
-0009c5c0: 7365 715f 7363 6865 6d65 275d 5b28 7365  seq_scheme'][(se
-0009c5d0: 6c66 2e5f 5f63 7572 5f73 7562 7479 7065  lf.__cur_subtype
-0009c5e0: 2c20 7365 6c66 2e70 726f 6373 5265 7374  , self.procsRest
-0009c5f0: 7261 696e 7473 295d 203d 2073 656c 662e  raints)] = self.
-0009c600: 5f5f 7072 6566 6572 4175 7468 5365 710a  __preferAuthSeq.
-0009c610: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
-0009c620: 662e 5f5f 6375 725f 7375 6274 7970 6520  f.__cur_subtype 
-0009c630: 3d3d 2027 7261 6d61 273a 0a20 2020 2020  == 'rama':.     
-0009c640: 2020 2020 2020 2073 656c 662e 7265 6173         self.reas
-0009c650: 6f6e 7346 6f72 5265 5061 7273 696e 675b  onsForReParsing[
-0009c660: 276c 6f63 616c 5f73 6571 5f73 6368 656d  'local_seq_schem
-0009c670: 6527 5d5b 2873 656c 662e 5f5f 6375 725f  e'][(self.__cur_
-0009c680: 7375 6274 7970 652c 2073 656c 662e 7261  subtype, self.ra
-0009c690: 6d61 5265 7374 7261 696e 7473 295d 203d  maRestraints)] =
-0009c6a0: 2073 656c 662e 5f5f 7072 6566 6572 4175   self.__preferAu
-0009c6b0: 7468 5365 710a 2020 2020 2020 2020 656c  thSeq.        el
-0009c6c0: 6966 2073 656c 662e 5f5f 6375 725f 7375  if self.__cur_su
-0009c6d0: 6274 7970 6520 3d3d 2027 7261 6469 273a  btype == 'radi':
-0009c6e0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0009c6f0: 662e 7265 6173 6f6e 7346 6f72 5265 5061  f.reasonsForRePa
-0009c700: 7273 696e 675b 276c 6f63 616c 5f73 6571  rsing['local_seq
-0009c710: 5f73 6368 656d 6527 5d5b 2873 656c 662e  _scheme'][(self.
-0009c720: 5f5f 6375 725f 7375 6274 7970 652c 2073  __cur_subtype, s
-0009c730: 656c 662e 7261 6469 5265 7374 7261 696e  elf.radiRestrain
-0009c740: 7473 295d 203d 2073 656c 662e 5f5f 7072  ts)] = self.__pr
-0009c750: 6566 6572 4175 7468 5365 710a 2020 2020  eferAuthSeq.    
-0009c760: 2020 2020 656c 6966 2073 656c 662e 5f5f      elif self.__
-0009c770: 6375 725f 7375 6274 7970 6520 3d3d 2027  cur_subtype == '
-0009c780: 6469 6666 273a 0a20 2020 2020 2020 2020  diff':.         
-0009c790: 2020 2073 656c 662e 7265 6173 6f6e 7346     self.reasonsF
-0009c7a0: 6f72 5265 5061 7273 696e 675b 276c 6f63  orReParsing['loc
-0009c7b0: 616c 5f73 6571 5f73 6368 656d 6527 5d5b  al_seq_scheme'][
-0009c7c0: 2873 656c 662e 5f5f 6375 725f 7375 6274  (self.__cur_subt
-0009c7d0: 7970 652c 2073 656c 662e 6469 6666 5265  ype, self.diffRe
-0009c7e0: 7374 7261 696e 7473 295d 203d 2073 656c  straints)] = sel
-0009c7f0: 662e 5f5f 7072 6566 6572 4175 7468 5365  f.__preferAuthSe
-0009c800: 710a 2020 2020 2020 2020 656c 6966 2073  q.        elif s
-0009c810: 656c 662e 5f5f 6375 725f 7375 6274 7970  elf.__cur_subtyp
-0009c820: 6520 3d3d 2027 6e62 6173 6527 3a0a 2020  e == 'nbase':.  
-0009c830: 2020 2020 2020 2020 2020 7365 6c66 2e72            self.r
-0009c840: 6561 736f 6e73 466f 7252 6550 6172 7369  easonsForReParsi
-0009c850: 6e67 5b27 6c6f 6361 6c5f 7365 715f 7363  ng['local_seq_sc
-0009c860: 6865 6d65 275d 5b28 7365 6c66 2e5f 5f63  heme'][(self.__c
-0009c870: 7572 5f73 7562 7479 7065 2c20 7365 6c66  ur_subtype, self
-0009c880: 2e6e 6261 7365 5265 7374 7261 696e 7473  .nbaseRestraints
-0009c890: 295d 203d 2073 656c 662e 5f5f 7072 6566  )] = self.__pref
-0009c8a0: 6572 4175 7468 5365 710a 2020 2020 2020  erAuthSeq.      
-0009c8b0: 2020 656c 6966 2073 656c 662e 5f5f 6375    elif self.__cu
-0009c8c0: 725f 7375 6274 7970 6520 3d3d 2027 6373  r_subtype == 'cs
-0009c8d0: 6127 3a0a 2020 2020 2020 2020 2020 2020  a':.            
-0009c8e0: 7365 6c66 2e72 6561 736f 6e73 466f 7252  self.reasonsForR
-0009c8f0: 6550 6172 7369 6e67 5b27 6c6f 6361 6c5f  eParsing['local_
-0009c900: 7365 715f 7363 6865 6d65 275d 5b28 7365  seq_scheme'][(se
-0009c910: 6c66 2e5f 5f63 7572 5f73 7562 7479 7065  lf.__cur_subtype
-0009c920: 2c20 7365 6c66 2e63 7361 5265 7374 7261  , self.csaRestra
-0009c930: 696e 7473 295d 203d 2073 656c 662e 5f5f  ints)] = self.__
-0009c940: 7072 6566 6572 4175 7468 5365 710a 2020  preferAuthSeq.  
-0009c950: 2020 2020 2020 2320 656c 6966 2073 656c        # elif sel
-0009c960: 662e 5f5f 6375 725f 7375 6274 7970 6520  f.__cur_subtype 
-0009c970: 3d3d 2027 616e 6727 3a0a 2020 2020 2020  == 'ang':.      
-0009c980: 2020 2320 2020 2020 7365 6c66 2e72 6561    #     self.rea
-0009c990: 736f 6e73 466f 7252 6550 6172 7369 6e67  sonsForReParsing
-0009c9a0: 5b27 6c6f 6361 6c5f 7365 715f 7363 6865  ['local_seq_sche
-0009c9b0: 6d65 275d 5b28 7365 6c66 2e5f 5f63 7572  me'][(self.__cur
-0009c9c0: 5f73 7562 7479 7065 2c20 7365 6c66 2e61  _subtype, self.a
-0009c9d0: 6e67 5265 7374 7261 696e 7473 295d 203d  ngRestraints)] =
-0009c9e0: 2073 656c 662e 5f5f 7072 6566 6572 4175   self.__preferAu
-0009c9f0: 7468 5365 710a 2020 2020 2020 2020 656c  thSeq.        el
-0009ca00: 6966 2073 656c 662e 5f5f 6375 725f 7375  if self.__cur_su
-0009ca10: 6274 7970 6520 3d3d 2027 7072 6527 3a0a  btype == 'pre':.
-0009ca20: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0009ca30: 2e72 6561 736f 6e73 466f 7252 6550 6172  .reasonsForRePar
-0009ca40: 7369 6e67 5b27 6c6f 6361 6c5f 7365 715f  sing['local_seq_
-0009ca50: 7363 6865 6d65 275d 5b28 7365 6c66 2e5f  scheme'][(self._
-0009ca60: 5f63 7572 5f73 7562 7479 7065 2c20 7365  _cur_subtype, se
-0009ca70: 6c66 2e70 7265 5265 7374 7261 696e 7473  lf.preRestraints
-0009ca80: 295d 203d 2073 656c 662e 5f5f 7072 6566  )] = self.__pref
-0009ca90: 6572 4175 7468 5365 710a 2020 2020 2020  erAuthSeq.      
-0009caa0: 2020 656c 6966 2073 656c 662e 5f5f 6375    elif self.__cu
-0009cab0: 725f 7375 6274 7970 6520 3d3d 2027 7063  r_subtype == 'pc
-0009cac0: 7327 3a0a 2020 2020 2020 2020 2020 2020  s':.            
-0009cad0: 7365 6c66 2e72 6561 736f 6e73 466f 7252  self.reasonsForR
-0009cae0: 6550 6172 7369 6e67 5b27 6c6f 6361 6c5f  eParsing['local_
-0009caf0: 7365 715f 7363 6865 6d65 275d 5b28 7365  seq_scheme'][(se
-0009cb00: 6c66 2e5f 5f63 7572 5f73 7562 7479 7065  lf.__cur_subtype
-0009cb10: 2c20 7365 6c66 2e70 6373 5265 7374 7261  , self.pcsRestra
-0009cb20: 696e 7473 295d 203d 2073 656c 662e 5f5f  ints)] = self.__
-0009cb30: 7072 6566 6572 4175 7468 5365 710a 2020  preferAuthSeq.  
-0009cb40: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
-0009cb50: 5f5f 6375 725f 7375 6274 7970 6520 3d3d  __cur_subtype ==
-0009cb60: 2027 7072 6463 273a 0a20 2020 2020 2020   'prdc':.       
-0009cb70: 2020 2020 2073 656c 662e 7265 6173 6f6e       self.reason
-0009cb80: 7346 6f72 5265 5061 7273 696e 675b 276c  sForReParsing['l
-0009cb90: 6f63 616c 5f73 6571 5f73 6368 656d 6527  ocal_seq_scheme'
-0009cba0: 5d5b 2873 656c 662e 5f5f 6375 725f 7375  ][(self.__cur_su
-0009cbb0: 6274 7970 652c 2073 656c 662e 7072 6463  btype, self.prdc
-0009cbc0: 5265 7374 7261 696e 7473 295d 203d 2073  Restraints)] = s
-0009cbd0: 656c 662e 5f5f 7072 6566 6572 4175 7468  elf.__preferAuth
-0009cbe0: 5365 710a 2020 2020 2020 2020 656c 6966  Seq.        elif
-0009cbf0: 2073 656c 662e 5f5f 6375 725f 7375 6274   self.__cur_subt
-0009cc00: 7970 6520 3d3d 2027 7061 6e67 273a 0a20  ype == 'pang':. 
-0009cc10: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0009cc20: 7265 6173 6f6e 7346 6f72 5265 5061 7273  reasonsForRePars
-0009cc30: 696e 675b 276c 6f63 616c 5f73 6571 5f73  ing['local_seq_s
-0009cc40: 6368 656d 6527 5d5b 2873 656c 662e 5f5f  cheme'][(self.__
-0009cc50: 6375 725f 7375 6274 7970 652c 2073 656c  cur_subtype, sel
-0009cc60: 662e 7061 6e67 5265 7374 7261 696e 7473  f.pangRestraints
-0009cc70: 295d 203d 2073 656c 662e 5f5f 7072 6566  )] = self.__pref
-0009cc80: 6572 4175 7468 5365 710a 2020 2020 2020  erAuthSeq.      
-0009cc90: 2020 656c 6966 2073 656c 662e 5f5f 6375    elif self.__cu
-0009cca0: 725f 7375 6274 7970 6520 3d3d 2027 7063  r_subtype == 'pc
-0009ccb0: 6372 273a 0a20 2020 2020 2020 2020 2020  cr':.           
-0009ccc0: 2073 656c 662e 7265 6173 6f6e 7346 6f72   self.reasonsFor
-0009ccd0: 5265 5061 7273 696e 675b 276c 6f63 616c  ReParsing['local
-0009cce0: 5f73 6571 5f73 6368 656d 6527 5d5b 2873  _seq_scheme'][(s
-0009ccf0: 656c 662e 5f5f 6375 725f 7375 6274 7970  elf.__cur_subtyp
-0009cd00: 652c 2073 656c 662e 7063 6372 5265 7374  e, self.pccrRest
-0009cd10: 7261 696e 7473 295d 203d 2073 656c 662e  raints)] = self.
-0009cd20: 5f5f 7072 6566 6572 4175 7468 5365 710a  __preferAuthSeq.
-0009cd30: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
-0009cd40: 662e 5f5f 6375 725f 7375 6274 7970 6520  f.__cur_subtype 
-0009cd50: 3d3d 2027 6862 6f6e 6427 3a0a 2020 2020  == 'hbond':.    
-0009cd60: 2020 2020 2020 2020 7365 6c66 2e72 6561          self.rea
-0009cd70: 736f 6e73 466f 7252 6550 6172 7369 6e67  sonsForReParsing
-0009cd80: 5b27 6c6f 6361 6c5f 7365 715f 7363 6865  ['local_seq_sche
-0009cd90: 6d65 275d 5b28 7365 6c66 2e5f 5f63 7572  me'][(self.__cur
-0009cda0: 5f73 7562 7479 7065 2c20 7365 6c66 2e68  _subtype, self.h
-0009cdb0: 626f 6e64 5265 7374 7261 696e 7473 295d  bondRestraints)]
-0009cdc0: 203d 2073 656c 662e 5f5f 7072 6566 6572   = self.__prefer
-0009cdd0: 4175 7468 5365 710a 2020 2020 2020 2020  AuthSeq.        
-0009cde0: 656c 6966 2073 656c 662e 5f5f 6375 725f  elif self.__cur_
-0009cdf0: 7375 6274 7970 6520 3d3d 2027 6765 6f27  subtype == 'geo'
-0009ce00: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-0009ce10: 6c66 2e72 6561 736f 6e73 466f 7252 6550  lf.reasonsForReP
-0009ce20: 6172 7369 6e67 5b27 6c6f 6361 6c5f 7365  arsing['local_se
-0009ce30: 715f 7363 6865 6d65 275d 5b28 7365 6c66  q_scheme'][(self
-0009ce40: 2e5f 5f63 7572 5f73 7562 7479 7065 2c20  .__cur_subtype, 
-0009ce50: 7365 6c66 2e67 656f 5265 7374 7261 696e  self.geoRestrain
-0009ce60: 7473 295d 203d 2073 656c 662e 5f5f 7072  ts)] = self.__pr
-0009ce70: 6566 6572 4175 7468 5365 710a 2020 2020  eferAuthSeq.    
-0009ce80: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
-0009ce90: 5f5f 7072 6566 6572 4175 7468 5365 713a  __preferAuthSeq:
-0009cea0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0009ceb0: 662e 5f5f 7072 6566 6572 4c61 6265 6c53  f.__preferLabelS
-0009cec0: 6571 436f 756e 7420 2b3d 2031 0a20 2020  eqCount += 1.   
-0009ced0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-0009cee0: 2e5f 5f70 7265 6665 724c 6162 656c 5365  .__preferLabelSe
-0009cef0: 7143 6f75 6e74 203e 204d 4158 5f50 5245  qCount > MAX_PRE
-0009cf00: 465f 4c41 4245 4c5f 5343 4845 4d45 5f43  F_LABEL_SCHEME_C
-0009cf10: 4f55 4e54 3a0a 2020 2020 2020 2020 2020  OUNT:.          
-0009cf20: 2020 2020 2020 7365 6c66 2e72 6561 736f        self.reaso
-0009cf30: 6e73 466f 7252 6550 6172 7369 6e67 5b27  nsForReParsing['
-0009cf40: 6c61 6265 6c5f 7365 715f 7363 6865 6d65  label_seq_scheme
-0009cf50: 275d 203d 2054 7275 650a 0a20 2020 2064  '] = True..    d
-0009cf60: 6566 205f 5f72 6574 7269 6576 654c 6f63  ef __retrieveLoc
-0009cf70: 616c 5365 7153 6368 656d 6528 7365 6c66  alSeqScheme(self
-0009cf80: 293a 0a20 2020 2020 2020 2069 6620 7365  ):.        if se
-0009cf90: 6c66 2e5f 5f72 6561 736f 6e73 2069 7320  lf.__reasons is 
-0009cfa0: 4e6f 6e65 206f 7220 276c 6f63 616c 5f73  None or 'local_s
-0009cfb0: 6571 5f73 6368 656d 6527 206e 6f74 2069  eq_scheme' not i
-0009cfc0: 6e20 7365 6c66 2e5f 5f72 6561 736f 6e73  n self.__reasons
-0009cfd0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0009cfe0: 7475 726e 0a20 2020 2020 2020 2069 6620  turn.        if 
-0009cff0: 276c 6162 656c 5f73 6571 5f73 6368 656d  'label_seq_schem
-0009d000: 6527 2069 6e20 7365 6c66 2e5f 5f72 6561  e' in self.__rea
-0009d010: 736f 6e73 2061 6e64 2073 656c 662e 5f5f  sons and self.__
-0009d020: 7265 6173 6f6e 735b 276c 6162 656c 5f73  reasons['label_s
-0009d030: 6571 5f73 6368 656d 6527 5d3a 0a20 2020  eq_scheme']:.   
-0009d040: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
-0009d050: 7072 6566 6572 4175 7468 5365 7120 3d20  preferAuthSeq = 
-0009d060: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
-0009d070: 2020 7365 6c66 2e5f 5f61 7574 6853 6571    self.__authSeq
-0009d080: 4964 203d 2027 6c61 6265 6c5f 7365 715f  Id = 'label_seq_
-0009d090: 6964 270a 2020 2020 2020 2020 2020 2020  id'.            
-0009d0a0: 7265 7475 726e 0a20 2020 2020 2020 2069  return.        i
-0009d0b0: 6620 7365 6c66 2e5f 5f63 7572 5f73 7562  f self.__cur_sub
-0009d0c0: 7479 7065 203d 3d20 2764 6973 7427 3a0a  type == 'dist':.
-0009d0d0: 2020 2020 2020 2020 2020 2020 6b65 7920              key 
-0009d0e0: 3d20 2873 656c 662e 5f5f 6375 725f 7375  = (self.__cur_su
-0009d0f0: 6274 7970 652c 2073 656c 662e 6469 7374  btype, self.dist
-0009d100: 5265 7374 7261 696e 7473 290a 2020 2020  Restraints).    
-0009d110: 2020 2020 656c 6966 2073 656c 662e 5f5f      elif self.__
-0009d120: 6375 725f 7375 6274 7970 6520 3d3d 2027  cur_subtype == '
-0009d130: 6469 6865 6427 3a0a 2020 2020 2020 2020  dihed':.        
-0009d140: 2020 2020 6b65 7920 3d20 2873 656c 662e      key = (self.
-0009d150: 5f5f 6375 725f 7375 6274 7970 652c 2073  __cur_subtype, s
-0009d160: 656c 662e 6469 6865 6452 6573 7472 6169  elf.dihedRestrai
-0009d170: 6e74 7329 0a20 2020 2020 2020 2065 6c69  nts).        eli
-0009d180: 6620 7365 6c66 2e5f 5f63 7572 5f73 7562  f self.__cur_sub
-0009d190: 7479 7065 203d 3d20 2772 6463 273a 0a20  type == 'rdc':. 
-0009d1a0: 2020 2020 2020 2020 2020 206b 6579 203d             key =
-0009d1b0: 2028 7365 6c66 2e5f 5f63 7572 5f73 7562   (self.__cur_sub
-0009d1c0: 7479 7065 2c20 7365 6c66 2e72 6463 5265  type, self.rdcRe
-0009d1d0: 7374 7261 696e 7473 290a 2020 2020 2020  straints).      
-0009d1e0: 2020 656c 6966 2073 656c 662e 5f5f 6375    elif self.__cu
-0009d1f0: 725f 7375 6274 7970 6520 3d3d 2027 706c  r_subtype == 'pl
-0009d200: 616e 6527 3a0a 2020 2020 2020 2020 2020  ane':.          
-0009d210: 2020 6b65 7920 3d20 2873 656c 662e 5f5f    key = (self.__
-0009d220: 6375 725f 7375 6274 7970 652c 2073 656c  cur_subtype, sel
-0009d230: 662e 706c 616e 6552 6573 7472 6169 6e74  f.planeRestraint
-0009d240: 7329 0a20 2020 2020 2020 2065 6c69 6620  s).        elif 
-0009d250: 7365 6c66 2e5f 5f63 7572 5f73 7562 7479  self.__cur_subty
-0009d260: 7065 203d 3d20 2761 6469 7374 273a 0a20  pe == 'adist':. 
-0009d270: 2020 2020 2020 2020 2020 206b 6579 203d             key =
-0009d280: 2028 7365 6c66 2e5f 5f63 7572 5f73 7562   (self.__cur_sub
-0009d290: 7479 7065 2c20 7365 6c66 2e61 6469 7374  type, self.adist
-0009d2a0: 5265 7374 7261 696e 7473 290a 2020 2020  Restraints).    
-0009d2b0: 2020 2020 656c 6966 2073 656c 662e 5f5f      elif self.__
-0009d2c0: 6375 725f 7375 6274 7970 6520 3d3d 2027  cur_subtype == '
-0009d2d0: 6a63 6f75 7027 3a0a 2020 2020 2020 2020  jcoup':.        
-0009d2e0: 2020 2020 6b65 7920 3d20 2873 656c 662e      key = (self.
-0009d2f0: 5f5f 6375 725f 7375 6274 7970 652c 2073  __cur_subtype, s
-0009d300: 656c 662e 6a63 6f75 7052 6573 7472 6169  elf.jcoupRestrai
-0009d310: 6e74 7329 0a20 2020 2020 2020 2065 6c69  nts).        eli
+000923b0: 2020 2020 2020 636f 6e74 696e 7565 0a0a        continue..
+000923c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000923d0: 2020 2020 2020 2020 6174 6f6d 5365 6c65          atomSele
+000923e0: 6374 696f 6e2e 6170 7065 6e64 285f 6174  ction.append(_at
+000923f0: 6f6d 290a 2020 2020 2020 2020 2020 2020  om).            
+00092400: 2020 2020 2020 2020 2020 2020 5f73 6571              _seq
+00092410: 7565 6e63 6553 656c 6563 742e 6170 7065  uenceSelect.appe
+00092420: 6e64 285f 7365 7175 656e 6365 290a 0a20  nd(_sequence).. 
+00092430: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00092440: 7863 6570 7420 4578 6365 7074 696f 6e20  xcept Exception 
+00092450: 6173 2065 3a0a 2020 2020 2020 2020 2020  as e:.          
+00092460: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00092470: 662e 5f5f 7665 7262 6f73 653a 0a20 2020  f.__verbose:.   
+00092480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00092490: 2020 2020 2073 656c 662e 5f5f 6c66 682e       self.__lfh.
+000924a0: 7772 6974 6528 6622 2b58 706c 6f72 4d52  write(f"+XplorMR
+000924b0: 5061 7273 6572 4c69 7374 656e 6572 2e65  ParserListener.e
+000924c0: 7869 7446 6163 746f 7228 2920 2b2b 2045  xitFactor() ++ E
+000924d0: 7272 6f72 2020 2d20 7b73 7472 2865 297d  rror  - {str(e)}
+000924e0: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
+000924f0: 2020 2020 7365 6c66 2e69 6e74 6572 7365      self.interse
+00092500: 6374 696f 6e46 6163 746f 725f 6578 7072  ctionFactor_expr
+00092510: 6573 7369 6f6e 7328 6174 6f6d 5365 6c65  essions(atomSele
+00092520: 6374 696f 6e29 0a0a 2020 2020 2020 2020  ction)..        
+00092530: 2020 2020 2020 2020 6966 206c 656e 2873          if len(s
+00092540: 656c 662e 6661 6374 6f72 5b27 6174 6f6d  elf.factor['atom
+00092550: 5f73 656c 6563 7469 6f6e 275d 2920 3d3d  _selection']) ==
+00092560: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+00092570: 2020 2020 2020 2020 7365 6c66 2e66 6163          self.fac
+00092580: 746f 725b 2761 746f 6d5f 6964 275d 203d  tor['atom_id'] =
+00092590: 205b 4e6f 6e65 5d0a 2020 2020 2020 2020   [None].        
+000925a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000925b0: 2e5f 5f66 2e61 7070 656e 6428 6622 5b49  .__f.append(f"[I
+000925c0: 6e73 7566 6669 6369 656e 7420 6174 6f6d  nsufficient atom
+000925d0: 2073 656c 6563 7469 6f6e 5d20 7b73 656c   selection] {sel
+000925e0: 662e 5f5f 6765 7443 7572 7265 6e74 5265  f.__getCurrentRe
+000925f0: 7374 7261 696e 7428 297d 220a 2020 2020  straint()}".    
+00092600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00092610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00092620: 2254 6865 2027 7461 6727 2063 6c61 7573  "The 'tag' claus
+00092630: 6520 6861 7320 6e6f 2065 6666 6563 742e  e has no effect.
+00092640: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
+00092650: 656c 6966 2063 7478 2e44 6f6e 6f72 2829  elif ctx.Donor()
+00092660: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00092670: 2020 7365 6c66 2e64 6f6e 6f72 5f63 6f6c    self.donor_col
+00092680: 756d 6e53 656c 203d 206c 656e 2873 656c  umnSel = len(sel
+00092690: 662e 6174 6f6d 5365 6c65 6374 696f 6e53  f.atomSelectionS
+000926a0: 6574 290a 0a20 2020 2020 2020 2020 2020  et)..           
+000926b0: 2065 6c69 6620 6374 782e 4163 6365 7074   elif ctx.Accept
+000926c0: 6f72 2829 3a0a 2020 2020 2020 2020 2020  or():.          
+000926d0: 2020 2020 2020 7365 6c66 2e61 6363 6570        self.accep
+000926e0: 746f 725f 636f 6c75 6d6e 5365 6c20 3d20  tor_columnSel = 
+000926f0: 6c65 6e28 7365 6c66 2e61 746f 6d53 656c  len(self.atomSel
+00092700: 6563 7469 6f6e 5365 7429 0a0a 2020 2020  ectionSet)..    
+00092710: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00092720: 6465 7074 6820 3e20 3020 616e 6420 7365  depth > 0 and se
+00092730: 6c66 2e5f 5f63 7572 5f75 6e69 6f6e 5f65  lf.__cur_union_e
+00092740: 7870 723a 0a20 2020 2020 2020 2020 2020  xpr:.           
+00092750: 2020 2020 2073 656c 662e 756e 696f 6e46       self.unionF
+00092760: 6163 746f 7220 3d20 7365 6c66 2e66 6163  actor = self.fac
+00092770: 746f 720a 2020 2020 2020 2020 2020 2020  tor.            
+00092780: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00092790: 2020 2020 2020 7365 6c66 2e73 7461 636b        self.stack
+000927a0: 4661 6374 6f72 732e 6170 7065 6e64 2873  Factors.append(s
+000927b0: 656c 662e 6661 6374 6f72 290a 0a20 2020  elf.factor)..   
+000927c0: 2020 2020 2066 696e 616c 6c79 3a0a 2020       finally:.  
+000927d0: 2020 2020 2020 2020 2020 7365 6c66 2e6e            self.n
+000927e0: 756d 6265 7246 5365 6c65 6374 696f 6e2e  umberFSelection.
+000927f0: 636c 6561 7228 290a 0a20 2020 2023 2045  clear()..    # E
+00092800: 6e74 6572 2061 2070 6172 7365 2074 7265  nter a parse tre
+00092810: 6520 7072 6f64 7563 6564 2062 7920 5870  e produced by Xp
+00092820: 6c6f 724d 5250 6172 7365 7223 6e75 6d62  lorMRParser#numb
+00092830: 6572 2e0a 2020 2020 6465 6620 656e 7465  er..    def ente
+00092840: 724e 756d 6265 7228 7365 6c66 2c20 6374  rNumber(self, ct
+00092850: 783a 2058 706c 6f72 4d52 5061 7273 6572  x: XplorMRParser
+00092860: 2e4e 756d 6265 7243 6f6e 7465 7874 293a  .NumberContext):
+00092870: 2020 2320 7079 6c69 6e74 3a20 6469 7361    # pylint: disa
+00092880: 626c 653d 756e 7573 6564 2d61 7267 756d  ble=unused-argum
+00092890: 656e 740a 2020 2020 2020 2020 7061 7373  ent.        pass
+000928a0: 0a0a 2020 2020 2320 4578 6974 2061 2070  ..    # Exit a p
+000928b0: 6172 7365 2074 7265 6520 7072 6f64 7563  arse tree produc
+000928c0: 6564 2062 7920 5870 6c6f 724d 5250 6172  ed by XplorMRPar
+000928d0: 7365 7223 6e75 6d62 6572 2e0a 2020 2020  ser#number..    
+000928e0: 6465 6620 6578 6974 4e75 6d62 6572 2873  def exitNumber(s
+000928f0: 656c 662c 2063 7478 3a20 5870 6c6f 724d  elf, ctx: XplorM
+00092900: 5250 6172 7365 722e 4e75 6d62 6572 436f  RParser.NumberCo
+00092910: 6e74 6578 7429 3a0a 2020 2020 2020 2020  ntext):.        
+00092920: 6966 2063 7478 2e52 6561 6c28 293a 0a20  if ctx.Real():. 
+00092930: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00092940: 6e75 6d62 6572 5365 6c65 6374 696f 6e2e  numberSelection.
+00092950: 6170 7065 6e64 2866 6c6f 6174 2873 7472  append(float(str
+00092960: 2863 7478 2e52 6561 6c28 2929 2929 0a0a  (ctx.Real())))..
+00092970: 2020 2020 2020 2020 656c 6966 2063 7478          elif ctx
+00092980: 2e49 6e74 6567 6572 2829 3a0a 2020 2020  .Integer():.    
+00092990: 2020 2020 2020 2020 7365 6c66 2e6e 756d          self.num
+000929a0: 6265 7253 656c 6563 7469 6f6e 2e61 7070  berSelection.app
+000929b0: 656e 6428 666c 6f61 7428 7374 7228 6374  end(float(str(ct
+000929c0: 782e 496e 7465 6765 7228 2929 2929 0a0a  x.Integer())))..
+000929d0: 2020 2020 2020 2020 656c 6966 2063 7478          elif ctx
+000929e0: 2e53 796d 626f 6c5f 6e61 6d65 2829 3a0a  .Symbol_name():.
+000929f0: 2020 2020 2020 2020 2020 2020 7379 6d62              symb
+00092a00: 6f6c 5f6e 616d 6520 3d20 7374 7228 6374  ol_name = str(ct
+00092a10: 782e 5379 6d62 6f6c 5f6e 616d 6528 2929  x.Symbol_name())
+00092a20: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00092a30: 7379 6d62 6f6c 5f6e 616d 6520 696e 2073  symbol_name in s
+00092a40: 656c 662e 6576 616c 7561 7465 3a0a 2020  elf.evaluate:.  
+00092a50: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00092a60: 6c66 2e6e 756d 6265 7253 656c 6563 7469  lf.numberSelecti
+00092a70: 6f6e 2e61 7070 656e 6428 666c 6f61 7428  on.append(float(
+00092a80: 7365 6c66 2e65 7661 6c75 6174 655b 7379  self.evaluate[sy
+00092a90: 6d62 6f6c 5f6e 616d 655d 2929 0a20 2020  mbol_name])).   
+00092aa0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00092ab0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00092ac0: 656c 662e 5f5f 662e 6170 7065 6e64 2866  elf.__f.append(f
+00092ad0: 225b 556e 7375 7070 6f72 7465 6420 6461  "[Unsupported da
+00092ae0: 7461 5d20 7b73 656c 662e 5f5f 6765 7443  ta] {self.__getC
+00092af0: 7572 7265 6e74 5265 7374 7261 696e 7428  urrentRestraint(
+00092b00: 297d 220a 2020 2020 2020 2020 2020 2020  )}".            
+00092b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00092b20: 2020 2020 6622 5468 6520 7379 6d62 6f6c      f"The symbol
+00092b30: 207b 7379 6d62 6f6c 5f6e 616d 6521 727d   {symbol_name!r}
+00092b40: 2069 7320 6e6f 7420 6465 6669 6e65 642e   is not defined.
+00092b50: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+00092b60: 2020 2073 656c 662e 6e75 6d62 6572 5365     self.numberSe
+00092b70: 6c65 6374 696f 6e2e 6170 7065 6e64 284e  lection.append(N
+00092b80: 6f6e 6529 0a0a 2020 2020 2020 2020 656c  one)..        el
+00092b90: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00092ba0: 7365 6c66 2e6e 756d 6265 7253 656c 6563  self.numberSelec
+00092bb0: 7469 6f6e 2e61 7070 656e 6428 4e6f 6e65  tion.append(None
+00092bc0: 290a 0a20 2020 2023 2045 6e74 6572 2061  )..    # Enter a
+00092bd0: 2070 6172 7365 2074 7265 6520 7072 6f64   parse tree prod
+00092be0: 7563 6564 2062 7920 5870 6c6f 724d 5250  uced by XplorMRP
+00092bf0: 6172 7365 7223 6e75 6d62 6572 5f66 2e0a  arser#number_f..
+00092c00: 2020 2020 6465 6620 656e 7465 724e 756d      def enterNum
+00092c10: 6265 725f 6628 7365 6c66 2c20 6374 783a  ber_f(self, ctx:
+00092c20: 2058 706c 6f72 4d52 5061 7273 6572 2e4e   XplorMRParser.N
+00092c30: 756d 6265 725f 6643 6f6e 7465 7874 293a  umber_fContext):
+00092c40: 2020 2320 7079 6c69 6e74 3a20 6469 7361    # pylint: disa
+00092c50: 626c 653d 756e 7573 6564 2d61 7267 756d  ble=unused-argum
+00092c60: 656e 740a 2020 2020 2020 2020 7061 7373  ent.        pass
+00092c70: 0a0a 2020 2020 2320 4578 6974 2061 2070  ..    # Exit a p
+00092c80: 6172 7365 2074 7265 6520 7072 6f64 7563  arse tree produc
+00092c90: 6564 2062 7920 5870 6c6f 724d 5250 6172  ed by XplorMRPar
+00092ca0: 7365 7223 6e75 6d62 6572 5f66 2e0a 2020  ser#number_f..  
+00092cb0: 2020 6465 6620 6578 6974 4e75 6d62 6572    def exitNumber
+00092cc0: 5f66 2873 656c 662c 2063 7478 3a20 5870  _f(self, ctx: Xp
+00092cd0: 6c6f 724d 5250 6172 7365 722e 4e75 6d62  lorMRParser.Numb
+00092ce0: 6572 5f66 436f 6e74 6578 7429 3a0a 2020  er_fContext):.  
+00092cf0: 2020 2020 2020 6966 2063 7478 2e52 6561        if ctx.Rea
+00092d00: 6c28 293a 0a20 2020 2020 2020 2020 2020  l():.           
+00092d10: 2073 656c 662e 6e75 6d62 6572 4653 656c   self.numberFSel
+00092d20: 6563 7469 6f6e 2e61 7070 656e 6428 666c  ection.append(fl
+00092d30: 6f61 7428 7374 7228 6374 782e 5265 616c  oat(str(ctx.Real
+00092d40: 2829 2929 290a 0a20 2020 2020 2020 2065  ())))..        e
+00092d50: 6c69 6620 6374 782e 496e 7465 6765 7228  lif ctx.Integer(
+00092d60: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
+00092d70: 656c 662e 6e75 6d62 6572 4653 656c 6563  elf.numberFSelec
+00092d80: 7469 6f6e 2e61 7070 656e 6428 666c 6f61  tion.append(floa
+00092d90: 7428 7374 7228 6374 782e 496e 7465 6765  t(str(ctx.Intege
+00092da0: 7228 2929 2929 0a0a 2020 2020 2020 2020  r())))..        
+00092db0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00092dc0: 2020 7365 6c66 2e6e 756d 6265 7246 5365    self.numberFSe
+00092dd0: 6c65 6374 696f 6e2e 6170 7065 6e64 284e  lection.append(N
+00092de0: 6f6e 6529 0a0a 2020 2020 2320 456e 7465  one)..    # Ente
+00092df0: 7220 6120 7061 7273 6520 7472 6565 2070  r a parse tree p
+00092e00: 726f 6475 6365 6420 6279 2058 706c 6f72  roduced by Xplor
+00092e10: 4d52 5061 7273 6572 236e 756d 6265 725f  MRParser#number_
+00092e20: 732e 0a20 2020 2064 6566 2065 6e74 6572  s..    def enter
+00092e30: 4e75 6d62 6572 5f73 2873 656c 662c 2063  Number_s(self, c
+00092e40: 7478 3a20 5870 6c6f 724d 5250 6172 7365  tx: XplorMRParse
+00092e50: 722e 4e75 6d62 6572 5f73 436f 6e74 6578  r.Number_sContex
+00092e60: 7429 3a20 2023 2070 796c 696e 743a 2064  t):  # pylint: d
+00092e70: 6973 6162 6c65 3d75 6e75 7365 642d 6172  isable=unused-ar
+00092e80: 6775 6d65 6e74 0a20 2020 2020 2020 2070  gument.        p
+00092e90: 6173 730a 0a20 2020 2023 2045 7869 7420  ass..    # Exit 
+00092ea0: 6120 7061 7273 6520 7472 6565 2070 726f  a parse tree pro
+00092eb0: 6475 6365 6420 6279 2058 706c 6f72 4d52  duced by XplorMR
+00092ec0: 5061 7273 6572 236e 756d 6265 725f 732e  Parser#number_s.
+00092ed0: 0a20 2020 2064 6566 2065 7869 744e 756d  .    def exitNum
+00092ee0: 6265 725f 7328 7365 6c66 2c20 6374 783a  ber_s(self, ctx:
+00092ef0: 2058 706c 6f72 4d52 5061 7273 6572 2e4e   XplorMRParser.N
+00092f00: 756d 6265 725f 7343 6f6e 7465 7874 293a  umber_sContext):
+00092f10: 2020 2320 7079 6c69 6e74 3a20 6469 7361    # pylint: disa
+00092f20: 626c 653d 756e 7573 6564 2d61 7267 756d  ble=unused-argum
+00092f30: 656e 740a 2020 2020 2020 2020 7061 7373  ent.        pass
+00092f40: 0a0a 2020 2020 6465 6620 6765 744e 756d  ..    def getNum
+00092f50: 6265 725f 7328 7365 6c66 2c20 6374 783a  ber_s(self, ctx:
+00092f60: 2058 706c 6f72 4d52 5061 7273 6572 2e4e   XplorMRParser.N
+00092f70: 756d 6265 725f 7343 6f6e 7465 7874 293a  umber_sContext):
+00092f80: 2020 2320 7079 6c69 6e74 3a20 6469 7361    # pylint: disa
+00092f90: 626c 653d 6e6f 2d73 656c 662d 7573 650a  ble=no-self-use.
+00092fa0: 2020 2020 2020 2020 6966 2063 7478 2069          if ctx i
+00092fb0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+00092fc0: 2020 2020 7265 7475 726e 204e 6f6e 650a      return None.
+00092fd0: 0a20 2020 2020 2020 2069 6620 6374 782e  .        if ctx.
+00092fe0: 5265 616c 2829 3a0a 2020 2020 2020 2020  Real():.        
+00092ff0: 2020 2020 7265 7475 726e 2066 6c6f 6174      return float
+00093000: 2873 7472 2863 7478 2e52 6561 6c28 2929  (str(ctx.Real())
+00093010: 290a 0a20 2020 2020 2020 2069 6620 6374  )..        if ct
+00093020: 782e 496e 7465 6765 7228 293a 0a20 2020  x.Integer():.   
+00093030: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00093040: 666c 6f61 7428 7374 7228 6374 782e 496e  float(str(ctx.In
+00093050: 7465 6765 7228 2929 290a 0a20 2020 2020  teger()))..     
+00093060: 2020 2069 6620 6374 782e 5379 6d62 6f6c     if ctx.Symbol
+00093070: 5f6e 616d 6528 293a 0a20 2020 2020 2020  _name():.       
+00093080: 2020 2020 2072 6574 7572 6e20 7374 7228       return str(
+00093090: 6374 782e 5379 6d62 6f6c 5f6e 616d 6528  ctx.Symbol_name(
+000930a0: 2929 0a0a 2020 2020 2020 2020 7265 7475  ))..        retu
+000930b0: 726e 204e 6f6e 650a 0a20 2020 2023 2045  rn None..    # E
+000930c0: 6e74 6572 2061 2070 6172 7365 2074 7265  nter a parse tre
+000930d0: 6520 7072 6f64 7563 6564 2062 7920 5870  e produced by Xp
+000930e0: 6c6f 724d 5250 6172 7365 7223 6e75 6d62  lorMRParser#numb
+000930f0: 6572 5f61 2e0a 2020 2020 6465 6620 656e  er_a..    def en
+00093100: 7465 724e 756d 6265 725f 6128 7365 6c66  terNumber_a(self
+00093110: 2c20 6374 783a 2058 706c 6f72 4d52 5061  , ctx: XplorMRPa
+00093120: 7273 6572 2e4e 756d 6265 725f 6143 6f6e  rser.Number_aCon
+00093130: 7465 7874 293a 2020 2320 7079 6c69 6e74  text):  # pylint
+00093140: 3a20 6469 7361 626c 653d 756e 7573 6564  : disable=unused
+00093150: 2d61 7267 756d 656e 740a 2020 2020 2020  -argument.      
+00093160: 2020 7061 7373 0a0a 2020 2020 2320 4578    pass..    # Ex
+00093170: 6974 2061 2070 6172 7365 2074 7265 6520  it a parse tree 
+00093180: 7072 6f64 7563 6564 2062 7920 5870 6c6f  produced by Xplo
+00093190: 724d 5250 6172 7365 7223 6e75 6d62 6572  rMRParser#number
+000931a0: 5f61 2e0a 2020 2020 6465 6620 6578 6974  _a..    def exit
+000931b0: 4e75 6d62 6572 5f61 2873 656c 662c 2063  Number_a(self, c
+000931c0: 7478 3a20 5870 6c6f 724d 5250 6172 7365  tx: XplorMRParse
+000931d0: 722e 4e75 6d62 6572 5f61 436f 6e74 6578  r.Number_aContex
+000931e0: 7429 3a20 2023 2070 796c 696e 743a 2064  t):  # pylint: d
+000931f0: 6973 6162 6c65 3d75 6e75 7365 642d 6172  isable=unused-ar
+00093200: 6775 6d65 6e74 0a20 2020 2020 2020 2070  gument.        p
+00093210: 6173 730a 0a20 2020 2064 6566 2067 6574  ass..    def get
+00093220: 4e75 6d62 6572 5f61 2873 656c 662c 2063  Number_a(self, c
+00093230: 7478 3a20 5870 6c6f 724d 5250 6172 7365  tx: XplorMRParse
+00093240: 722e 4e75 6d62 6572 5f61 436f 6e74 6578  r.Number_aContex
+00093250: 7429 3a20 2023 2070 796c 696e 743a 2064  t):  # pylint: d
+00093260: 6973 6162 6c65 3d6e 6f2d 7365 6c66 2d75  isable=no-self-u
+00093270: 7365 0a20 2020 2020 2020 2069 6620 6374  se.        if ct
+00093280: 7820 6973 204e 6f6e 653a 0a20 2020 2020  x is None:.     
+00093290: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
+000932a0: 6e65 0a0a 2020 2020 2020 2020 6966 2063  ne..        if c
+000932b0: 7478 2e52 6561 6c28 293a 0a20 2020 2020  tx.Real():.     
+000932c0: 2020 2020 2020 2072 6574 7572 6e20 666c         return fl
+000932d0: 6f61 7428 7374 7228 6374 782e 5265 616c  oat(str(ctx.Real
+000932e0: 2829 2929 0a0a 2020 2020 2020 2020 6966  ()))..        if
+000932f0: 2063 7478 2e49 6e74 6567 6572 2829 3a0a   ctx.Integer():.
+00093300: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00093310: 726e 2066 6c6f 6174 2873 7472 2863 7478  rn float(str(ctx
+00093320: 2e49 6e74 6567 6572 2829 2929 0a0a 2020  .Integer()))..  
+00093330: 2020 2020 2020 7265 7475 726e 204e 6f6e        return Non
+00093340: 650a 0a20 2020 2023 2045 6e74 6572 2061  e..    # Enter a
+00093350: 2070 6172 7365 2074 7265 6520 7072 6f64   parse tree prod
+00093360: 7563 6564 2062 7920 5870 6c6f 724d 5250  uced by XplorMRP
+00093370: 6172 7365 7223 636c 6173 7369 6669 6361  arser#classifica
+00093380: 7469 6f6e 2e0a 2020 2020 6465 6620 656e  tion..    def en
+00093390: 7465 7243 6c61 7373 6966 6963 6174 696f  terClassificatio
+000933a0: 6e28 7365 6c66 2c20 6374 783a 2058 706c  n(self, ctx: Xpl
+000933b0: 6f72 4d52 5061 7273 6572 2e43 6c61 7373  orMRParser.Class
+000933c0: 6966 6963 6174 696f 6e43 6f6e 7465 7874  ificationContext
+000933d0: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
+000933e0: 636c 6173 7369 6669 6361 7469 6f6e 203d  classification =
+000933f0: 2073 656c 662e 6765 7443 6c61 7373 5f6e   self.getClass_n
+00093400: 616d 6528 6374 782e 636c 6173 735f 6e61  ame(ctx.class_na
+00093410: 6d65 2829 290a 0a20 2020 2023 2045 7869  me())..    # Exi
+00093420: 7420 6120 7061 7273 6520 7472 6565 2070  t a parse tree p
+00093430: 726f 6475 6365 6420 6279 2058 706c 6f72  roduced by Xplor
+00093440: 4d52 5061 7273 6572 2363 6c61 7373 6966  MRParser#classif
+00093450: 6963 6174 696f 6e2e 0a20 2020 2064 6566  ication..    def
+00093460: 2065 7869 7443 6c61 7373 6966 6963 6174   exitClassificat
+00093470: 696f 6e28 7365 6c66 2c20 6374 783a 2058  ion(self, ctx: X
+00093480: 706c 6f72 4d52 5061 7273 6572 2e43 6c61  plorMRParser.Cla
+00093490: 7373 6966 6963 6174 696f 6e43 6f6e 7465  ssificationConte
+000934a0: 7874 293a 2020 2320 7079 6c69 6e74 3a20  xt):  # pylint: 
+000934b0: 6469 7361 626c 653d 756e 7573 6564 2d61  disable=unused-a
+000934c0: 7267 756d 656e 740a 2020 2020 2020 2020  rgument.        
+000934d0: 7061 7373 0a0a 2020 2020 2320 456e 7465  pass..    # Ente
+000934e0: 7220 6120 7061 7273 6520 7472 6565 2070  r a parse tree p
+000934f0: 726f 6475 6365 6420 6279 2058 706c 6f72  roduced by Xplor
+00093500: 4d52 5061 7273 6572 2363 6c61 7373 5f6e  MRParser#class_n
+00093510: 616d 652e 0a20 2020 2064 6566 2065 6e74  ame..    def ent
+00093520: 6572 436c 6173 735f 6e61 6d65 2873 656c  erClass_name(sel
+00093530: 662c 2063 7478 3a20 5870 6c6f 724d 5250  f, ctx: XplorMRP
+00093540: 6172 7365 722e 436c 6173 735f 6e61 6d65  arser.Class_name
+00093550: 436f 6e74 6578 7429 3a20 2023 2070 796c  Context):  # pyl
+00093560: 696e 743a 2064 6973 6162 6c65 3d75 6e75  int: disable=unu
+00093570: 7365 642d 6172 6775 6d65 6e74 0a20 2020  sed-argument.   
+00093580: 2020 2020 2070 6173 730a 0a20 2020 2023       pass..    #
+00093590: 2045 7869 7420 6120 7061 7273 6520 7472   Exit a parse tr
+000935a0: 6565 2070 726f 6475 6365 6420 6279 2058  ee produced by X
+000935b0: 706c 6f72 4d52 5061 7273 6572 2363 6c61  plorMRParser#cla
+000935c0: 7373 5f6e 616d 652e 0a20 2020 2064 6566  ss_name..    def
+000935d0: 2065 7869 7443 6c61 7373 5f6e 616d 6528   exitClass_name(
+000935e0: 7365 6c66 2c20 6374 783a 2058 706c 6f72  self, ctx: Xplor
+000935f0: 4d52 5061 7273 6572 2e43 6c61 7373 5f6e  MRParser.Class_n
+00093600: 616d 6543 6f6e 7465 7874 293a 2020 2320  ameContext):  # 
+00093610: 7079 6c69 6e74 3a20 6469 7361 626c 653d  pylint: disable=
+00093620: 756e 7573 6564 2d61 7267 756d 656e 740a  unused-argument.
+00093630: 2020 2020 2020 2020 7061 7373 0a0a 2020          pass..  
+00093640: 2020 6465 6620 6765 7443 6c61 7373 5f6e    def getClass_n
+00093650: 616d 6528 7365 6c66 2c20 6374 783a 2058  ame(self, ctx: X
+00093660: 706c 6f72 4d52 5061 7273 6572 2e43 6c61  plorMRParser.Cla
+00093670: 7373 5f6e 616d 6543 6f6e 7465 7874 293a  ss_nameContext):
+00093680: 2020 2320 7079 6c69 6e74 3a20 6469 7361    # pylint: disa
+00093690: 626c 653d 6e6f 2d73 656c 662d 7573 650a  ble=no-self-use.
+000936a0: 2020 2020 2020 2020 6966 2063 7478 2069          if ctx i
+000936b0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+000936c0: 2020 2020 7265 7475 726e 204e 6f6e 650a      return None.
+000936d0: 0a20 2020 2020 2020 2069 6620 6374 782e  .        if ctx.
+000936e0: 5369 6d70 6c65 5f6e 616d 6528 293a 0a20  Simple_name():. 
+000936f0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00093700: 6e20 7374 7228 6374 782e 5369 6d70 6c65  n str(ctx.Simple
+00093710: 5f6e 616d 6528 2929 0a0a 2020 2020 2020  _name())..      
+00093720: 2020 6966 2063 7478 2e4e 6f65 2829 3a0a    if ctx.Noe():.
+00093730: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00093740: 726e 2073 7472 2863 7478 2e4e 6f65 2829  rn str(ctx.Noe()
+00093750: 290a 0a20 2020 2020 2020 2069 6620 6374  )..        if ct
+00093760: 782e 5265 7374 7261 696e 7473 2829 3a0a  x.Restraints():.
+00093770: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00093780: 726e 2073 7472 2863 7478 2e52 6573 7472  rn str(ctx.Restr
+00093790: 6169 6e74 7328 2929 0a0a 2020 2020 2020  aints())..      
+000937a0: 2020 6966 2063 7478 2e41 6e67 6c65 4462    if ctx.AngleDb
+000937b0: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+000937c0: 7265 7475 726e 2073 7472 2863 7478 2e41  return str(ctx.A
+000937d0: 6e67 6c65 4462 2829 290a 0a20 2020 2020  ngleDb())..     
+000937e0: 2020 2069 6620 6374 782e 4842 6f6e 6465     if ctx.HBonde
+000937f0: 6428 293a 0a20 2020 2020 2020 2020 2020  d():.           
+00093800: 2072 6574 7572 6e20 7374 7228 6374 782e   return str(ctx.
+00093810: 4842 6f6e 6465 6428 2929 0a0a 2020 2020  HBonded())..    
+00093820: 2020 2020 6966 2063 7478 2e44 6968 6564      if ctx.Dihed
+00093830: 7261 6c28 293a 0a20 2020 2020 2020 2020  ral():.         
+00093840: 2020 2072 6574 7572 6e20 7374 7228 6374     return str(ct
+00093850: 782e 4469 6865 6472 616c 2829 290a 0a20  x.Dihedral()).. 
+00093860: 2020 2020 2020 2069 6620 6374 782e 496d         if ctx.Im
+00093870: 7072 6f70 6572 2829 3a0a 2020 2020 2020  proper():.      
+00093880: 2020 2020 2020 7265 7475 726e 2073 7472        return str
+00093890: 2863 7478 2e49 6d70 726f 7065 7228 2929  (ctx.Improper())
+000938a0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+000938b0: 204e 6f6e 650a 0a20 2020 2023 2045 6e74   None..    # Ent
+000938c0: 6572 2061 2070 6172 7365 2074 7265 6520  er a parse tree 
+000938d0: 7072 6f64 7563 6564 2062 7920 5870 6c6f  produced by Xplo
+000938e0: 724d 5250 6172 7365 7223 666c 6167 5f73  rMRParser#flag_s
+000938f0: 7461 7465 6d65 6e74 2e0a 2020 2020 6465  tatement..    de
+00093900: 6620 656e 7465 7246 6c61 675f 7374 6174  f enterFlag_stat
+00093910: 656d 656e 7428 7365 6c66 2c20 6374 783a  ement(self, ctx:
+00093920: 2058 706c 6f72 4d52 5061 7273 6572 2e46   XplorMRParser.F
+00093930: 6c61 675f 7374 6174 656d 656e 7443 6f6e  lag_statementCon
+00093940: 7465 7874 293a 2020 2320 7079 6c69 6e74  text):  # pylint
+00093950: 3a20 6469 7361 626c 653d 756e 7573 6564  : disable=unused
+00093960: 2d61 7267 756d 656e 740a 2020 2020 2020  -argument.      
+00093970: 2020 7061 7373 0a0a 2020 2020 2320 4578    pass..    # Ex
+00093980: 6974 2061 2070 6172 7365 2074 7265 6520  it a parse tree 
+00093990: 7072 6f64 7563 6564 2062 7920 5870 6c6f  produced by Xplo
+000939a0: 724d 5250 6172 7365 7223 666c 6167 5f73  rMRParser#flag_s
+000939b0: 7461 7465 6d65 6e74 2e0a 2020 2020 6465  tatement..    de
+000939c0: 6620 6578 6974 466c 6167 5f73 7461 7465  f exitFlag_state
+000939d0: 6d65 6e74 2873 656c 662c 2063 7478 3a20  ment(self, ctx: 
+000939e0: 5870 6c6f 724d 5250 6172 7365 722e 466c  XplorMRParser.Fl
+000939f0: 6167 5f73 7461 7465 6d65 6e74 436f 6e74  ag_statementCont
+00093a00: 6578 7429 3a20 2023 2070 796c 696e 743a  ext):  # pylint:
+00093a10: 2064 6973 6162 6c65 3d75 6e75 7365 642d   disable=unused-
+00093a20: 6172 6775 6d65 6e74 0a20 2020 2020 2020  argument.       
+00093a30: 2070 6173 730a 0a20 2020 2023 2045 6e74   pass..    # Ent
+00093a40: 6572 2061 2070 6172 7365 2074 7265 6520  er a parse tree 
+00093a50: 7072 6f64 7563 6564 2062 7920 5870 6c6f  produced by Xplo
+00093a60: 724d 5250 6172 7365 7223 7665 6374 6f72  rMRParser#vector
+00093a70: 5f73 7461 7465 6d65 6e74 2e0a 2020 2020  _statement..    
+00093a80: 6465 6620 656e 7465 7256 6563 746f 725f  def enterVector_
+00093a90: 7374 6174 656d 656e 7428 7365 6c66 2c20  statement(self, 
+00093aa0: 6374 783a 2058 706c 6f72 4d52 5061 7273  ctx: XplorMRPars
+00093ab0: 6572 2e56 6563 746f 725f 7374 6174 656d  er.Vector_statem
+00093ac0: 656e 7443 6f6e 7465 7874 293a 2020 2320  entContext):  # 
+00093ad0: 7079 6c69 6e74 3a20 6469 7361 626c 653d  pylint: disable=
+00093ae0: 756e 7573 6564 2d61 7267 756d 656e 740a  unused-argument.
+00093af0: 2020 2020 2020 2020 7365 6c66 2e5f 5f63          self.__c
+00093b00: 7572 5f76 6563 746f 725f 6d6f 6465 203d  ur_vector_mode =
+00093b10: 2027 270a 2020 2020 2020 2020 7365 6c66   ''.        self
+00093b20: 2e5f 5f63 7572 5f76 6563 746f 725f 6174  .__cur_vector_at
+00093b30: 6f6d 5f70 726f 705f 7479 7065 203d 2027  om_prop_type = '
+00093b40: 270a 0a20 2020 2020 2020 2073 656c 662e  '..        self.
+00093b50: 5f5f 6375 725f 7666 6c63 5f6f 705f 636f  __cur_vflc_op_co
+00093b60: 6465 203d 2027 270a 2020 2020 2020 2020  de = ''.        
+00093b70: 7365 6c66 2e73 7461 636b 5666 6c63 203d  self.stackVflc =
+00093b80: 205b 5d0a 0a20 2020 2020 2020 2073 656c   []..        sel
+00093b90: 662e 6174 6f6d 5365 6c65 6374 696f 6e53  f.atomSelectionS
+00093ba0: 6574 2e63 6c65 6172 2829 0a20 2020 2020  et.clear().     
+00093bb0: 2020 2073 656c 662e 5f5f 672e 636c 6561     self.__g.clea
+00093bc0: 7228 290a 0a20 2020 2023 2045 7869 7420  r()..    # Exit 
+00093bd0: 6120 7061 7273 6520 7472 6565 2070 726f  a parse tree pro
+00093be0: 6475 6365 6420 6279 2058 706c 6f72 4d52  duced by XplorMR
+00093bf0: 5061 7273 6572 2376 6563 746f 725f 7374  Parser#vector_st
+00093c00: 6174 656d 656e 742e 0a20 2020 2064 6566  atement..    def
+00093c10: 2065 7869 7456 6563 746f 725f 7374 6174   exitVector_stat
+00093c20: 656d 656e 7428 7365 6c66 2c20 6374 783a  ement(self, ctx:
+00093c30: 2058 706c 6f72 4d52 5061 7273 6572 2e56   XplorMRParser.V
+00093c40: 6563 746f 725f 7374 6174 656d 656e 7443  ector_statementC
+00093c50: 6f6e 7465 7874 293a 2020 2320 7079 6c69  ontext):  # pyli
+00093c60: 6e74 3a20 6469 7361 626c 653d 756e 7573  nt: disable=unus
+00093c70: 6564 2d61 7267 756d 656e 740a 2020 2020  ed-argument.    
+00093c80: 2020 2020 6966 2073 656c 662e 5f5f 6375      if self.__cu
+00093c90: 725f 7665 6374 6f72 5f6d 6f64 6520 3d3d  r_vector_mode ==
+00093ca0: 2027 6964 656e 7469 7479 273a 0a20 2020   'identity':.   
+00093cb0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00093cc0: 2e5f 5f63 7572 5f76 6563 746f 725f 6174  .__cur_vector_at
+00093cd0: 6f6d 5f70 726f 705f 7479 7065 2e73 7461  om_prop_type.sta
+00093ce0: 7274 7377 6974 6828 2773 746f 7265 2729  rtswith('store')
+00093cf0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00093d00: 2020 7365 6c66 2e73 746f 7265 5365 745b    self.storeSet[
+00093d10: 696e 7428 7365 6c66 2e5f 5f63 7572 5f76  int(self.__cur_v
+00093d20: 6563 746f 725f 6174 6f6d 5f70 726f 705f  ector_atom_prop_
+00093d30: 7479 7065 5b2d 315d 295d 203d 207b 2761  type[-1])] = {'a
+00093d40: 746f 6d5f 7365 6c65 6374 696f 6e27 3a20  tom_selection': 
+00093d50: 636f 7079 2e63 6f70 7928 7365 6c66 2e61  copy.copy(self.a
+00093d60: 746f 6d53 656c 6563 7469 6f6e 5365 745b  tomSelectionSet[
+00093d70: 305d 297d 0a0a 2020 2020 2020 2020 656c  0])}..        el
+00093d80: 6966 2073 656c 662e 5f5f 6375 725f 7665  if self.__cur_ve
+00093d90: 6374 6f72 5f6d 6f64 6520 3d3d 2027 646f  ctor_mode == 'do
+00093da0: 273a 0a20 2020 2020 2020 2020 2020 2069  ':.            i
+00093db0: 6620 6c65 6e28 7365 6c66 2e5f 5f63 7572  f len(self.__cur
+00093dc0: 5f76 6563 746f 725f 6174 6f6d 5f70 726f  _vector_atom_pro
+00093dd0: 705f 7479 7065 2920 3e20 303a 0a20 2020  p_type) > 0:.   
+00093de0: 2020 2020 2020 2020 2020 2020 2076 6563               vec
+00093df0: 746f 725f 6e61 6d65 203d 2073 656c 662e  tor_name = self.
+00093e00: 5f5f 6375 725f 7665 6374 6f72 5f61 746f  __cur_vector_ato
+00093e10: 6d5f 7072 6f70 5f74 7970 650a 2020 2020  m_prop_type.    
+00093e20: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+00093e30: 656e 2876 6563 746f 725f 6e61 6d65 2920  en(vector_name) 
+00093e40: 3e20 343a 0a20 2020 2020 2020 2020 2020  > 4:.           
+00093e50: 2020 2020 2020 2020 2076 6563 746f 725f           vector_
+00093e60: 6e61 6d65 203d 2076 6563 746f 725f 6e61  name = vector_na
+00093e70: 6d65 5b3a 345d 0a20 2020 2020 2020 2020  me[:4].         
+00093e80: 2020 2020 2020 2069 6620 7665 6374 6f72         if vector
+00093e90: 5f6e 616d 6520 6e6f 7420 696e 2073 656c  _name not in sel
+00093ea0: 662e 7665 6374 6f72 446f 3a0a 2020 2020  f.vectorDo:.    
+00093eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00093ec0: 7365 6c66 2e76 6563 746f 7244 6f5b 7665  self.vectorDo[ve
+00093ed0: 6374 6f72 5f6e 616d 655d 203d 205b 5d0a  ctor_name] = [].
+00093ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00093ef0: 7665 6374 6f72 203d 207b 2761 746f 6d5f  vector = {'atom_
+00093f00: 7365 6c65 6374 696f 6e27 3a20 636f 7079  selection': copy
+00093f10: 2e63 6f70 7928 7365 6c66 2e61 746f 6d53  .copy(self.atomS
+00093f20: 656c 6563 7469 6f6e 5365 745b 305d 297d  electionSet[0])}
+00093f30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00093f40: 2077 6869 6c65 2073 656c 662e 7374 6163   while self.stac
+00093f50: 6b56 666c 633a 0a20 2020 2020 2020 2020  kVflc:.         
+00093f60: 2020 2020 2020 2020 2020 2076 6563 746f             vecto
+00093f70: 725b 2776 616c 7565 275d 203d 2073 656c  r['value'] = sel
+00093f80: 662e 7374 6163 6b56 666c 632e 706f 7028  f.stackVflc.pop(
+00093f90: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00093fa0: 2020 7365 6c66 2e76 6563 746f 7244 6f5b    self.vectorDo[
+00093fb0: 7665 6374 6f72 5f6e 616d 655d 2e61 7070  vector_name].app
+00093fc0: 656e 6428 7665 6374 6f72 290a 0a20 2020  end(vector)..   
+00093fd0: 2023 2045 6e74 6572 2061 2070 6172 7365   # Enter a parse
+00093fe0: 2074 7265 6520 7072 6f64 7563 6564 2062   tree produced b
+00093ff0: 7920 5870 6c6f 724d 5250 6172 7365 7223  y XplorMRParser#
+00094000: 7665 6374 6f72 5f6d 6f64 652e 0a20 2020  vector_mode..   
+00094010: 2064 6566 2065 6e74 6572 5665 6374 6f72   def enterVector
+00094020: 5f6d 6f64 6528 7365 6c66 2c20 6374 783a  _mode(self, ctx:
+00094030: 2058 706c 6f72 4d52 5061 7273 6572 2e56   XplorMRParser.V
+00094040: 6563 746f 725f 6d6f 6465 436f 6e74 6578  ector_modeContex
+00094050: 7429 3a0a 2020 2020 2020 2020 6966 2063  t):.        if c
+00094060: 7478 2e49 6465 6e74 6974 795f 4c70 2829  tx.Identity_Lp()
+00094070: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00094080: 6c66 2e5f 5f63 7572 5f76 6563 746f 725f  lf.__cur_vector_
+00094090: 6d6f 6465 203d 2027 6964 656e 7469 7479  mode = 'identity
+000940a0: 270a 0a20 2020 2020 2020 2065 6c69 6620  '..        elif 
+000940b0: 6374 782e 446f 5f4c 7028 293a 0a20 2020  ctx.Do_Lp():.   
+000940c0: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
+000940d0: 6375 725f 7665 6374 6f72 5f6d 6f64 6520  cur_vector_mode 
+000940e0: 3d20 2764 6f27 0a0a 2020 2020 2020 2020  = 'do'..        
+000940f0: 656c 6966 2063 7478 2e53 686f 7728 293a  elif ctx.Show():
+00094100: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00094110: 662e 5f5f 6375 725f 7665 6374 6f72 5f6d  f.__cur_vector_m
+00094120: 6f64 6520 3d20 2773 686f 7727 0a0a 2020  ode = 'show'..  
+00094130: 2020 2320 4578 6974 2061 2070 6172 7365    # Exit a parse
+00094140: 2074 7265 6520 7072 6f64 7563 6564 2062   tree produced b
+00094150: 7920 5870 6c6f 724d 5250 6172 7365 7223  y XplorMRParser#
+00094160: 7665 6374 6f72 5f6d 6f64 652e 0a20 2020  vector_mode..   
+00094170: 2064 6566 2065 7869 7456 6563 746f 725f   def exitVector_
+00094180: 6d6f 6465 2873 656c 662c 2063 7478 3a20  mode(self, ctx: 
+00094190: 5870 6c6f 724d 5250 6172 7365 722e 5665  XplorMRParser.Ve
+000941a0: 6374 6f72 5f6d 6f64 6543 6f6e 7465 7874  ctor_modeContext
+000941b0: 293a 2020 2320 7079 6c69 6e74 3a20 6469  ):  # pylint: di
+000941c0: 7361 626c 653d 756e 7573 6564 2d61 7267  sable=unused-arg
+000941d0: 756d 656e 740a 2020 2020 2020 2020 7061  ument.        pa
+000941e0: 7373 0a0a 2020 2020 2320 456e 7465 7220  ss..    # Enter 
+000941f0: 6120 7061 7273 6520 7472 6565 2070 726f  a parse tree pro
+00094200: 6475 6365 6420 6279 2058 706c 6f72 4d52  duced by XplorMR
+00094210: 5061 7273 6572 2376 6563 746f 725f 6578  Parser#vector_ex
+00094220: 7072 6573 7369 6f6e 2e0a 2020 2020 6465  pression..    de
+00094230: 6620 656e 7465 7256 6563 746f 725f 6578  f enterVector_ex
+00094240: 7072 6573 7369 6f6e 2873 656c 662c 2063  pression(self, c
+00094250: 7478 3a20 5870 6c6f 724d 5250 6172 7365  tx: XplorMRParse
+00094260: 722e 5665 6374 6f72 5f65 7870 7265 7373  r.Vector_express
+00094270: 696f 6e43 6f6e 7465 7874 293a 2020 2320  ionContext):  # 
+00094280: 7079 6c69 6e74 3a20 6469 7361 626c 653d  pylint: disable=
+00094290: 756e 7573 6564 2d61 7267 756d 656e 740a  unused-argument.
+000942a0: 2020 2020 2020 2020 7061 7373 0a0a 2020          pass..  
+000942b0: 2020 2320 4578 6974 2061 2070 6172 7365    # Exit a parse
+000942c0: 2074 7265 6520 7072 6f64 7563 6564 2062   tree produced b
+000942d0: 7920 5870 6c6f 724d 5250 6172 7365 7223  y XplorMRParser#
+000942e0: 7665 6374 6f72 5f65 7870 7265 7373 696f  vector_expressio
+000942f0: 6e2e 0a20 2020 2064 6566 2065 7869 7456  n..    def exitV
+00094300: 6563 746f 725f 6578 7072 6573 7369 6f6e  ector_expression
+00094310: 2873 656c 662c 2063 7478 3a20 5870 6c6f  (self, ctx: Xplo
+00094320: 724d 5250 6172 7365 722e 5665 6374 6f72  rMRParser.Vector
+00094330: 5f65 7870 7265 7373 696f 6e43 6f6e 7465  _expressionConte
+00094340: 7874 293a 0a20 2020 2020 2020 2069 6620  xt):.        if 
+00094350: 6374 782e 4174 6f6d 5f70 726f 7065 7274  ctx.Atom_propert
+00094360: 6965 735f 5645 2829 3a0a 2020 2020 2020  ies_VE():.      
+00094370: 2020 2020 2020 7365 6c66 2e5f 5f63 7572        self.__cur
+00094380: 5f76 6563 746f 725f 6174 6f6d 5f70 726f  _vector_atom_pro
+00094390: 705f 7479 7065 203d 2073 7472 2863 7478  p_type = str(ctx
+000943a0: 2e41 746f 6d5f 7072 6f70 6572 7469 6573  .Atom_properties
+000943b0: 5f56 4528 2929 2e6c 6f77 6572 2829 0a0a  _VE()).lower()..
+000943c0: 2020 2020 2320 456e 7465 7220 6120 7061      # Enter a pa
+000943d0: 7273 6520 7472 6565 2070 726f 6475 6365  rse tree produce
+000943e0: 6420 6279 2058 706c 6f72 4d52 5061 7273  d by XplorMRPars
+000943f0: 6572 2376 6563 746f 725f 6f70 6572 6174  er#vector_operat
+00094400: 696f 6e2e 0a20 2020 2064 6566 2065 6e74  ion..    def ent
+00094410: 6572 5665 6374 6f72 5f6f 7065 7261 7469  erVector_operati
+00094420: 6f6e 2873 656c 662c 2063 7478 3a20 5870  on(self, ctx: Xp
+00094430: 6c6f 724d 5250 6172 7365 722e 5665 6374  lorMRParser.Vect
+00094440: 6f72 5f6f 7065 7261 7469 6f6e 436f 6e74  or_operationCont
+00094450: 6578 7429 3a20 2023 2070 796c 696e 743a  ext):  # pylint:
+00094460: 2064 6973 6162 6c65 3d75 6e75 7365 642d   disable=unused-
+00094470: 6172 6775 6d65 6e74 0a20 2020 2020 2020  argument.       
+00094480: 2070 6173 730a 0a20 2020 2023 2045 7869   pass..    # Exi
+00094490: 7420 6120 7061 7273 6520 7472 6565 2070  t a parse tree p
+000944a0: 726f 6475 6365 6420 6279 2058 706c 6f72  roduced by Xplor
+000944b0: 4d52 5061 7273 6572 2376 6563 746f 725f  MRParser#vector_
+000944c0: 6f70 6572 6174 696f 6e2e 0a20 2020 2064  operation..    d
+000944d0: 6566 2065 7869 7456 6563 746f 725f 6f70  ef exitVector_op
+000944e0: 6572 6174 696f 6e28 7365 6c66 2c20 6374  eration(self, ct
+000944f0: 783a 2058 706c 6f72 4d52 5061 7273 6572  x: XplorMRParser
+00094500: 2e56 6563 746f 725f 6f70 6572 6174 696f  .Vector_operatio
+00094510: 6e43 6f6e 7465 7874 293a 2020 2320 7079  nContext):  # py
+00094520: 6c69 6e74 3a20 6469 7361 626c 653d 756e  lint: disable=un
+00094530: 7573 6564 2d61 7267 756d 656e 740a 2020  used-argument.  
+00094540: 2020 2020 2020 7061 7373 0a0a 2020 2020        pass..    
+00094550: 2320 456e 7465 7220 6120 7061 7273 6520  # Enter a parse 
+00094560: 7472 6565 2070 726f 6475 6365 6420 6279  tree produced by
+00094570: 2058 706c 6f72 4d52 5061 7273 6572 2376   XplorMRParser#v
+00094580: 666c 632e 0a20 2020 2064 6566 2065 6e74  flc..    def ent
+00094590: 6572 5666 6c63 2873 656c 662c 2063 7478  erVflc(self, ctx
+000945a0: 3a20 5870 6c6f 724d 5250 6172 7365 722e  : XplorMRParser.
+000945b0: 5666 6c63 436f 6e74 6578 7429 3a20 2023  VflcContext):  #
+000945c0: 2070 796c 696e 743a 2064 6973 6162 6c65   pylint: disable
+000945d0: 3d75 6e75 7365 642d 6172 6775 6d65 6e74  =unused-argument
+000945e0: 0a20 2020 2020 2020 2070 6173 730a 0a20  .        pass.. 
+000945f0: 2020 2023 2045 7869 7420 6120 7061 7273     # Exit a pars
+00094600: 6520 7472 6565 2070 726f 6475 6365 6420  e tree produced 
+00094610: 6279 2058 706c 6f72 4d52 5061 7273 6572  by XplorMRParser
+00094620: 2376 666c 632e 0a20 2020 2064 6566 2065  #vflc..    def e
+00094630: 7869 7456 666c 6328 7365 6c66 2c20 6374  xitVflc(self, ct
+00094640: 783a 2058 706c 6f72 4d52 5061 7273 6572  x: XplorMRParser
+00094650: 2e56 666c 6343 6f6e 7465 7874 293a 0a20  .VflcContext):. 
+00094660: 2020 2020 2020 2069 6620 6374 782e 496e         if ctx.In
+00094670: 7465 6765 725f 5645 2829 3a0a 2020 2020  teger_VE():.    
+00094680: 2020 2020 2020 2020 7365 6c66 2e73 7461          self.sta
+00094690: 636b 5666 6c63 2e61 7070 656e 6428 696e  ckVflc.append(in
+000946a0: 7428 7374 7228 6374 782e 496e 7465 6765  t(str(ctx.Intege
+000946b0: 725f 5645 2829 2929 290a 2020 2020 2020  r_VE()))).      
+000946c0: 2020 656c 6966 2063 7478 2e52 6561 6c5f    elif ctx.Real_
+000946d0: 5645 2829 3a0a 2020 2020 2020 2020 2020  VE():.          
+000946e0: 2020 7365 6c66 2e73 7461 636b 5666 6c63    self.stackVflc
+000946f0: 2e61 7070 656e 6428 666c 6f61 7428 7374  .append(float(st
+00094700: 7228 6374 782e 5265 616c 5f56 4528 2929  r(ctx.Real_VE())
+00094710: 2929 0a20 2020 2020 2020 2065 6c69 6620  )).        elif 
+00094720: 6374 782e 5369 6d70 6c65 5f6e 616d 655f  ctx.Simple_name_
+00094730: 5645 2829 3a0a 2020 2020 2020 2020 2020  VE():.          
+00094740: 2020 7365 6c66 2e73 7461 636b 5666 6c63    self.stackVflc
+00094750: 2e61 7070 656e 6428 7374 7228 6374 782e  .append(str(ctx.
+00094760: 5369 6d70 6c65 5f6e 616d 655f 5645 2829  Simple_name_VE()
+00094770: 2929 0a20 2020 2020 2020 2065 6c69 6620  )).        elif 
+00094780: 6374 782e 446f 7562 6c65 5f71 756f 7465  ctx.Double_quote
+00094790: 5f73 7472 696e 675f 5645 2829 3a0a 2020  _string_VE():.  
+000947a0: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
+000947b0: 7461 636b 5666 6c63 2e61 7070 656e 6428  tackVflc.append(
+000947c0: 7374 7228 6374 782e 446f 7562 6c65 5f71  str(ctx.Double_q
+000947d0: 756f 7465 5f73 7472 696e 675f 5645 2829  uote_string_VE()
+000947e0: 292e 7374 7269 7028 2722 2729 2e73 7472  ).strip('"').str
+000947f0: 6970 2829 290a 2020 2020 2020 2020 656c  ip()).        el
+00094800: 6966 2063 7478 2e53 796d 626f 6c5f 6e61  if ctx.Symbol_na
+00094810: 6d65 5f56 4528 293a 0a20 2020 2020 2020  me_VE():.       
+00094820: 2020 2020 2073 796d 626f 6c5f 6e61 6d65       symbol_name
+00094830: 203d 2073 7472 2863 7478 2e53 796d 626f   = str(ctx.Symbo
+00094840: 6c5f 6e61 6d65 5f56 4528 2929 0a20 2020  l_name_VE()).   
+00094850: 2020 2020 2020 2020 2069 6620 7379 6d62           if symb
+00094860: 6f6c 5f6e 616d 6520 696e 2073 656c 662e  ol_name in self.
+00094870: 6576 616c 7561 7465 3a0a 2020 2020 2020  evaluate:.      
+00094880: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
+00094890: 7461 636b 5666 6c63 2e61 7070 656e 6428  tackVflc.append(
+000948a0: 7365 6c66 2e65 7661 6c75 6174 655b 7379  self.evaluate[sy
+000948b0: 6d62 6f6c 5f6e 616d 655d 290a 2020 2020  mbol_name]).    
+000948c0: 2020 2020 2020 2020 656c 6966 2073 796d          elif sym
+000948d0: 626f 6c5f 6e61 6d65 2069 6e20 7365 6c66  bol_name in self
+000948e0: 2e65 7661 6c75 6174 6546 6f72 3a0a 2020  .evaluateFor:.  
+000948f0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00094900: 6c66 2e73 7461 636b 5666 6c63 2e61 7070  lf.stackVflc.app
+00094910: 656e 6428 7365 6c66 2e65 7661 6c75 6174  end(self.evaluat
+00094920: 6546 6f72 5b73 796d 626f 6c5f 6e61 6d65  eFor[symbol_name
+00094930: 5d29 0a20 2020 2020 2020 2020 2020 2065  ]).            e
+00094940: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00094950: 2020 2020 2073 656c 662e 5f5f 662e 6170       self.__f.ap
+00094960: 7065 6e64 2866 225b 556e 7375 7070 6f72  pend(f"[Unsuppor
+00094970: 7465 6420 6461 7461 5d20 7b73 656c 662e  ted data] {self.
+00094980: 5f5f 6765 7443 7572 7265 6e74 5265 7374  __getCurrentRest
+00094990: 7261 696e 7428 297d 220a 2020 2020 2020  raint()}".      
+000949a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000949b0: 2020 2020 2020 2020 2020 6622 5468 6520            f"The 
+000949c0: 7379 6d62 6f6c 207b 7379 6d62 6f6c 5f6e  symbol {symbol_n
+000949d0: 616d 6521 727d 2069 7320 6e6f 7420 6465  ame!r} is not de
+000949e0: 6669 6e65 642e 2229 0a20 2020 2020 2020  fined.").       
+000949f0: 2065 6c69 6620 6374 782e 4174 6f6d 5f70   elif ctx.Atom_p
+00094a00: 726f 7065 7274 6965 735f 5645 2829 3a0a  roperties_VE():.
+00094a10: 2020 2020 2020 2020 2020 2020 7061 7373              pass
+00094a20: 0a20 2020 2020 2020 2065 6c69 6620 6374  .        elif ct
+00094a30: 782e 7665 6374 6f72 5f66 756e 635f 6361  x.vector_func_ca
+00094a40: 6c6c 2829 3a0a 2020 2020 2020 2020 2020  ll():.          
+00094a50: 2020 7061 7373 0a0a 2020 2020 2320 456e    pass..    # En
+00094a60: 7465 7220 6120 7061 7273 6520 7472 6565  ter a parse tree
+00094a70: 2070 726f 6475 6365 6420 6279 2058 706c   produced by Xpl
+00094a80: 6f72 4d52 5061 7273 6572 2376 6563 746f  orMRParser#vecto
+00094a90: 725f 6675 6e63 5f63 616c 6c2e 0a20 2020  r_func_call..   
+00094aa0: 2064 6566 2065 6e74 6572 5665 6374 6f72   def enterVector
+00094ab0: 5f66 756e 635f 6361 6c6c 2873 656c 662c  _func_call(self,
+00094ac0: 2063 7478 3a20 5870 6c6f 724d 5250 6172   ctx: XplorMRPar
+00094ad0: 7365 722e 5665 6374 6f72 5f66 756e 635f  ser.Vector_func_
+00094ae0: 6361 6c6c 436f 6e74 6578 7429 3a20 2023  callContext):  #
+00094af0: 2070 796c 696e 743a 2064 6973 6162 6c65   pylint: disable
+00094b00: 3d75 6e75 7365 642d 6172 6775 6d65 6e74  =unused-argument
+00094b10: 0a20 2020 2020 2020 2070 6173 730a 0a20  .        pass.. 
+00094b20: 2020 2023 2045 7869 7420 6120 7061 7273     # Exit a pars
+00094b30: 6520 7472 6565 2070 726f 6475 6365 6420  e tree produced 
+00094b40: 6279 2058 706c 6f72 4d52 5061 7273 6572  by XplorMRParser
+00094b50: 2376 6563 746f 725f 6675 6e63 5f63 616c  #vector_func_cal
+00094b60: 6c2e 0a20 2020 2064 6566 2065 7869 7456  l..    def exitV
+00094b70: 6563 746f 725f 6675 6e63 5f63 616c 6c28  ector_func_call(
+00094b80: 7365 6c66 2c20 6374 783a 2058 706c 6f72  self, ctx: Xplor
+00094b90: 4d52 5061 7273 6572 2e56 6563 746f 725f  MRParser.Vector_
+00094ba0: 6675 6e63 5f63 616c 6c43 6f6e 7465 7874  func_callContext
+00094bb0: 293a 2020 2320 7079 6c69 6e74 3a20 6469  ):  # pylint: di
+00094bc0: 7361 626c 653d 756e 7573 6564 2d61 7267  sable=unused-arg
+00094bd0: 756d 656e 740a 2020 2020 2020 2020 7061  ument.        pa
+00094be0: 7373 0a0a 2020 2020 2320 456e 7465 7220  ss..    # Enter 
+00094bf0: 6120 7061 7273 6520 7472 6565 2070 726f  a parse tree pro
+00094c00: 6475 6365 6420 6279 2058 706c 6f72 4d52  duced by XplorMR
+00094c10: 5061 7273 6572 2376 6563 746f 725f 7368  Parser#vector_sh
+00094c20: 6f77 5f70 726f 7065 7274 792e 0a20 2020  ow_property..   
+00094c30: 2064 6566 2065 6e74 6572 5665 6374 6f72   def enterVector
+00094c40: 5f73 686f 775f 7072 6f70 6572 7479 2873  _show_property(s
+00094c50: 656c 662c 2063 7478 3a20 5870 6c6f 724d  elf, ctx: XplorM
+00094c60: 5250 6172 7365 722e 5665 6374 6f72 5f73  RParser.Vector_s
+00094c70: 686f 775f 7072 6f70 6572 7479 436f 6e74  how_propertyCont
+00094c80: 6578 7429 3a20 2023 2070 796c 696e 743a  ext):  # pylint:
+00094c90: 2064 6973 6162 6c65 3d75 6e75 7365 642d   disable=unused-
+00094ca0: 6172 6775 6d65 6e74 0a20 2020 2020 2020  argument.       
+00094cb0: 2070 6173 730a 0a20 2020 2023 2045 7869   pass..    # Exi
+00094cc0: 7420 6120 7061 7273 6520 7472 6565 2070  t a parse tree p
+00094cd0: 726f 6475 6365 6420 6279 2058 706c 6f72  roduced by Xplor
+00094ce0: 4d52 5061 7273 6572 2376 6563 746f 725f  MRParser#vector_
+00094cf0: 7368 6f77 5f70 726f 7065 7274 792e 0a20  show_property.. 
+00094d00: 2020 2064 6566 2065 7869 7456 6563 746f     def exitVecto
+00094d10: 725f 7368 6f77 5f70 726f 7065 7274 7928  r_show_property(
+00094d20: 7365 6c66 2c20 6374 783a 2058 706c 6f72  self, ctx: Xplor
+00094d30: 4d52 5061 7273 6572 2e56 6563 746f 725f  MRParser.Vector_
+00094d40: 7368 6f77 5f70 726f 7065 7274 7943 6f6e  show_propertyCon
+00094d50: 7465 7874 293a 2020 2320 7079 6c69 6e74  text):  # pylint
+00094d60: 3a20 6469 7361 626c 653d 756e 7573 6564  : disable=unused
+00094d70: 2d61 7267 756d 656e 740a 2020 2020 2020  -argument.      
+00094d80: 2020 7061 7373 0a0a 2020 2020 2320 456e    pass..    # En
+00094d90: 7465 7220 6120 7061 7273 6520 7472 6565  ter a parse tree
+00094da0: 2070 726f 6475 6365 6420 6279 2058 706c   produced by Xpl
+00094db0: 6f72 4d52 5061 7273 6572 2365 7661 6c75  orMRParser#evalu
+00094dc0: 6174 655f 7374 6174 656d 656e 742e 0a20  ate_statement.. 
+00094dd0: 2020 2064 6566 2065 6e74 6572 4576 616c     def enterEval
+00094de0: 7561 7465 5f73 7461 7465 6d65 6e74 2873  uate_statement(s
+00094df0: 656c 662c 2063 7478 3a20 5870 6c6f 724d  elf, ctx: XplorM
+00094e00: 5250 6172 7365 722e 4576 616c 7561 7465  RParser.Evaluate
+00094e10: 5f73 7461 7465 6d65 6e74 436f 6e74 6578  _statementContex
+00094e20: 7429 3a0a 2020 2020 2020 2020 6966 2063  t):.        if c
+00094e30: 7478 2e53 796d 626f 6c5f 6e61 6d65 5f56  tx.Symbol_name_V
+00094e40: 4528 293a 0a20 2020 2020 2020 2020 2020  E():.           
+00094e50: 2073 656c 662e 5f5f 6375 725f 7379 6d62   self.__cur_symb
+00094e60: 6f6c 5f6e 616d 6520 3d20 7374 7228 6374  ol_name = str(ct
+00094e70: 782e 5379 6d62 6f6c 5f6e 616d 655f 5645  x.Symbol_name_VE
+00094e80: 2829 290a 0a20 2020 2020 2020 2073 656c  ())..        sel
+00094e90: 662e 5f5f 6375 725f 7666 6c63 5f6f 705f  f.__cur_vflc_op_
+00094ea0: 636f 6465 203d 2027 270a 2020 2020 2020  code = ''.      
+00094eb0: 2020 7365 6c66 2e73 7461 636b 5666 6c63    self.stackVflc
+00094ec0: 203d 205b 5d0a 0a20 2020 2023 2045 7869   = []..    # Exi
+00094ed0: 7420 6120 7061 7273 6520 7472 6565 2070  t a parse tree p
+00094ee0: 726f 6475 6365 6420 6279 2058 706c 6f72  roduced by Xplor
+00094ef0: 4d52 5061 7273 6572 2365 7661 6c75 6174  MRParser#evaluat
+00094f00: 655f 7374 6174 656d 656e 742e 0a20 2020  e_statement..   
+00094f10: 2064 6566 2065 7869 7445 7661 6c75 6174   def exitEvaluat
+00094f20: 655f 7374 6174 656d 656e 7428 7365 6c66  e_statement(self
+00094f30: 2c20 6374 783a 2058 706c 6f72 4d52 5061  , ctx: XplorMRPa
+00094f40: 7273 6572 2e45 7661 6c75 6174 655f 7374  rser.Evaluate_st
+00094f50: 6174 656d 656e 7443 6f6e 7465 7874 293a  atementContext):
+00094f60: 2020 2320 7079 6c69 6e74 3a20 6469 7361    # pylint: disa
+00094f70: 626c 653d 756e 7573 6564 2d61 7267 756d  ble=unused-argum
+00094f80: 656e 740a 2020 2020 2020 2020 6966 2073  ent.        if s
+00094f90: 656c 662e 7374 6163 6b56 666c 633a 0a20  elf.stackVflc:. 
+00094fa0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00094fb0: 6576 616c 7561 7465 5b73 656c 662e 5f5f  evaluate[self.__
+00094fc0: 6375 725f 7379 6d62 6f6c 5f6e 616d 655d  cur_symbol_name]
+00094fd0: 203d 2073 656c 662e 7374 6163 6b56 666c   = self.stackVfl
+00094fe0: 635b 305d 0a0a 2020 2020 2020 2020 2020  c[0]..          
+00094ff0: 2020 6966 2073 656c 662e 5f5f 6375 725f    if self.__cur_
+00095000: 7666 6c63 5f6f 705f 636f 6465 2069 6e20  vflc_op_code in 
+00095010: 2827 2b27 2c20 272d 272c 2027 2a27 2c20  ('+', '-', '*', 
+00095020: 272f 272c 2027 5e27 293a 0a20 2020 2020  '/', '^'):.     
+00095030: 2020 2020 2020 2020 2020 2073 203d 2073             s = s
+00095040: 656c 662e 7374 6163 6b56 666c 635b 305d  elf.stackVflc[0]
+00095050: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00095060: 206e 203d 2073 656c 662e 7374 6163 6b56   n = self.stackV
+00095070: 666c 635b 315d 0a20 2020 2020 2020 2020  flc[1].         
+00095080: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00095090: 616e 6365 2873 2c20 6c69 7374 2920 616e  ance(s, list) an
+000950a0: 6420 6e6f 7420 6973 696e 7374 616e 6365  d not isinstance
+000950b0: 286e 2c20 6c69 7374 293a 0a20 2020 2020  (n, list):.     
+000950c0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000950d0: 6620 7365 6c66 2e5f 5f63 7572 5f76 666c  f self.__cur_vfl
+000950e0: 635f 6f70 5f63 6f64 6520 3d3d 2027 2b27  c_op_code == '+'
+000950f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00095100: 2020 2020 2020 2020 2020 7365 6c66 2e65            self.e
+00095110: 7661 6c75 6174 655b 7365 6c66 2e5f 5f63  valuate[self.__c
+00095120: 7572 5f73 796d 626f 6c5f 6e61 6d65 5d20  ur_symbol_name] 
+00095130: 3d20 5b5f 7320 2b20 6e20 666f 7220 5f73  = [_s + n for _s
+00095140: 2069 6e20 735d 0a20 2020 2020 2020 2020   in s].         
+00095150: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00095160: 7365 6c66 2e5f 5f63 7572 5f76 666c 635f  self.__cur_vflc_
+00095170: 6f70 5f63 6f64 6520 3d3d 2027 2d27 3a0a  op_code == '-':.
+00095180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00095190: 2020 2020 2020 2020 7365 6c66 2e65 7661          self.eva
+000951a0: 6c75 6174 655b 7365 6c66 2e5f 5f63 7572  luate[self.__cur
+000951b0: 5f73 796d 626f 6c5f 6e61 6d65 5d20 3d20  _symbol_name] = 
+000951c0: 5b5f 7320 2d20 6e20 666f 7220 5f73 2069  [_s - n for _s i
+000951d0: 6e20 735d 0a20 2020 2020 2020 2020 2020  n s].           
+000951e0: 2020 2020 2020 2020 2065 6c69 6620 7365           elif se
+000951f0: 6c66 2e5f 5f63 7572 5f76 666c 635f 6f70  lf.__cur_vflc_op
+00095200: 5f63 6f64 6520 3d3d 2027 2a27 3a0a 2020  _code == '*':.  
+00095210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00095220: 2020 2020 2020 7365 6c66 2e65 7661 6c75        self.evalu
+00095230: 6174 655b 7365 6c66 2e5f 5f63 7572 5f73  ate[self.__cur_s
+00095240: 796d 626f 6c5f 6e61 6d65 5d20 3d20 5b5f  ymbol_name] = [_
+00095250: 7320 2a20 6e20 666f 7220 5f73 2069 6e20  s * n for _s in 
+00095260: 735d 0a20 2020 2020 2020 2020 2020 2020  s].             
+00095270: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
+00095280: 2e5f 5f63 7572 5f76 666c 635f 6f70 5f63  .__cur_vflc_op_c
+00095290: 6f64 6520 3d3d 2027 2f27 3a0a 2020 2020  ode == '/':.    
+000952a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000952b0: 2020 2020 7365 6c66 2e65 7661 6c75 6174      self.evaluat
+000952c0: 655b 7365 6c66 2e5f 5f63 7572 5f73 796d  e[self.__cur_sym
+000952d0: 626f 6c5f 6e61 6d65 5d20 3d20 5b5f 7320  bol_name] = [_s 
+000952e0: 2f20 6e20 666f 7220 5f73 2069 6e20 735d  / n for _s in s]
+000952f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00095300: 2020 2020 2065 6c69 6620 7365 6c66 2e5f       elif self._
+00095310: 5f63 7572 5f76 666c 635f 6f70 5f63 6f64  _cur_vflc_op_cod
+00095320: 6520 3d3d 2027 5e27 3a0a 2020 2020 2020  e == '^':.      
+00095330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00095340: 2020 7365 6c66 2e65 7661 6c75 6174 655b    self.evaluate[
+00095350: 7365 6c66 2e5f 5f63 7572 5f73 796d 626f  self.__cur_symbo
+00095360: 6c5f 6e61 6d65 5d20 3d20 5b5f 7320 2a2a  l_name] = [_s **
+00095370: 206e 2066 6f72 205f 7320 696e 2073 5d0a   n for _s in s].
+00095380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00095390: 656c 6966 206e 6f74 2069 7369 6e73 7461  elif not isinsta
+000953a0: 6e63 6528 732c 206c 6973 7429 2061 6e64  nce(s, list) and
+000953b0: 2069 7369 6e73 7461 6e63 6528 6e2c 206c   isinstance(n, l
+000953c0: 6973 7429 3a0a 2020 2020 2020 2020 2020  ist):.          
+000953d0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+000953e0: 662e 5f5f 6375 725f 7666 6c63 5f6f 705f  f.__cur_vflc_op_
+000953f0: 636f 6465 203d 3d20 272b 273a 0a20 2020  code == '+':.   
+00095400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00095410: 2020 2020 2073 656c 662e 6576 616c 7561       self.evalua
+00095420: 7465 5b73 656c 662e 5f5f 6375 725f 7379  te[self.__cur_sy
+00095430: 6d62 6f6c 5f6e 616d 655d 203d 205b 7320  mbol_name] = [s 
+00095440: 2b20 5f6e 2066 6f72 205f 6e20 696e 206e  + _n for _n in n
+00095450: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00095460: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
+00095470: 5f5f 6375 725f 7666 6c63 5f6f 705f 636f  __cur_vflc_op_co
+00095480: 6465 203d 3d20 272d 273a 0a20 2020 2020  de == '-':.     
+00095490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000954a0: 2020 2073 656c 662e 6576 616c 7561 7465     self.evaluate
+000954b0: 5b73 656c 662e 5f5f 6375 725f 7379 6d62  [self.__cur_symb
+000954c0: 6f6c 5f6e 616d 655d 203d 205b 7320 2d20  ol_name] = [s - 
+000954d0: 5f6e 2066 6f72 205f 6e20 696e 206e 5d0a  _n for _n in n].
+000954e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000954f0: 2020 2020 656c 6966 2073 656c 662e 5f5f      elif self.__
+00095500: 6375 725f 7666 6c63 5f6f 705f 636f 6465  cur_vflc_op_code
+00095510: 203d 3d20 272a 273a 0a20 2020 2020 2020   == '*':.       
+00095520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00095530: 2073 656c 662e 6576 616c 7561 7465 5b73   self.evaluate[s
+00095540: 656c 662e 5f5f 6375 725f 7379 6d62 6f6c  elf.__cur_symbol
+00095550: 5f6e 616d 655d 203d 205b 7320 2a20 5f6e  _name] = [s * _n
+00095560: 2066 6f72 205f 6e20 696e 206e 5d0a 2020   for _n in n].  
+00095570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00095580: 2020 656c 6966 2073 656c 662e 5f5f 6375    elif self.__cu
+00095590: 725f 7666 6c63 5f6f 705f 636f 6465 203d  r_vflc_op_code =
+000955a0: 3d20 272f 273a 0a20 2020 2020 2020 2020  = '/':.         
+000955b0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000955c0: 656c 662e 6576 616c 7561 7465 5b73 656c  elf.evaluate[sel
+000955d0: 662e 5f5f 6375 725f 7379 6d62 6f6c 5f6e  f.__cur_symbol_n
+000955e0: 616d 655d 203d 205b 7320 2f20 5f6e 2066  ame] = [s / _n f
+000955f0: 6f72 205f 6e20 696e 206e 5d0a 2020 2020  or _n in n].    
+00095600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00095610: 656c 6966 2073 656c 662e 5f5f 6375 725f  elif self.__cur_
+00095620: 7666 6c63 5f6f 705f 636f 6465 203d 3d20  vflc_op_code == 
+00095630: 275e 273a 0a20 2020 2020 2020 2020 2020  '^':.           
+00095640: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00095650: 662e 6576 616c 7561 7465 5b73 656c 662e  f.evaluate[self.
+00095660: 5f5f 6375 725f 7379 6d62 6f6c 5f6e 616d  __cur_symbol_nam
+00095670: 655d 203d 205b 7320 2a2a 205f 6e20 666f  e] = [s ** _n fo
+00095680: 7220 5f6e 2069 6e20 6e5d 0a20 2020 2020  r _n in n].     
+00095690: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+000956a0: 6973 696e 7374 616e 6365 2873 2c20 6c69  isinstance(s, li
+000956b0: 7374 2920 616e 6420 6973 696e 7374 616e  st) and isinstan
+000956c0: 6365 286e 2c20 6c69 7374 293a 0a20 2020  ce(n, list):.   
+000956d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000956e0: 2069 6620 7365 6c66 2e5f 5f63 7572 5f76   if self.__cur_v
+000956f0: 666c 635f 6f70 5f63 6f64 6520 3d3d 2027  flc_op_code == '
+00095700: 2b27 3a0a 2020 2020 2020 2020 2020 2020  +':.            
+00095710: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00095720: 2e65 7661 6c75 6174 655b 7365 6c66 2e5f  .evaluate[self._
+00095730: 5f63 7572 5f73 796d 626f 6c5f 6e61 6d65  _cur_symbol_name
+00095740: 5d20 3d20 5b5f 7320 2b20 5f6e 2066 6f72  ] = [_s + _n for
+00095750: 205f 732c 205f 6e20 696e 207a 6970 2873   _s, _n in zip(s
+00095760: 2c20 6e29 5d0a 2020 2020 2020 2020 2020  , n)].          
+00095770: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
+00095780: 656c 662e 5f5f 6375 725f 7666 6c63 5f6f  elf.__cur_vflc_o
+00095790: 705f 636f 6465 203d 3d20 272d 273a 0a20  p_code == '-':. 
+000957a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000957b0: 2020 2020 2020 2073 656c 662e 6576 616c         self.eval
+000957c0: 7561 7465 5b73 656c 662e 5f5f 6375 725f  uate[self.__cur_
+000957d0: 7379 6d62 6f6c 5f6e 616d 655d 203d 205b  symbol_name] = [
+000957e0: 5f73 202d 205f 6e20 666f 7220 5f73 2c20  _s - _n for _s, 
+000957f0: 5f6e 2069 6e20 7a69 7028 732c 206e 295d  _n in zip(s, n)]
+00095800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00095810: 2020 2020 2065 6c69 6620 7365 6c66 2e5f       elif self._
+00095820: 5f63 7572 5f76 666c 635f 6f70 5f63 6f64  _cur_vflc_op_cod
+00095830: 6520 3d3d 2027 2a27 3a0a 2020 2020 2020  e == '*':.      
+00095840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00095850: 2020 7365 6c66 2e65 7661 6c75 6174 655b    self.evaluate[
+00095860: 7365 6c66 2e5f 5f63 7572 5f73 796d 626f  self.__cur_symbo
+00095870: 6c5f 6e61 6d65 5d20 3d20 5b5f 7320 2a20  l_name] = [_s * 
+00095880: 5f6e 2066 6f72 205f 732c 205f 6e20 696e  _n for _s, _n in
+00095890: 207a 6970 2873 2c20 6e29 5d0a 2020 2020   zip(s, n)].    
+000958a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000958b0: 656c 6966 2073 656c 662e 5f5f 6375 725f  elif self.__cur_
+000958c0: 7666 6c63 5f6f 705f 636f 6465 203d 3d20  vflc_op_code == 
+000958d0: 272f 273a 0a20 2020 2020 2020 2020 2020  '/':.           
+000958e0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000958f0: 662e 6576 616c 7561 7465 5b73 656c 662e  f.evaluate[self.
+00095900: 5f5f 6375 725f 7379 6d62 6f6c 5f6e 616d  __cur_symbol_nam
+00095910: 655d 203d 205b 5f73 202f 205f 6e20 666f  e] = [_s / _n fo
+00095920: 7220 5f73 2c20 5f6e 2069 6e20 7a69 7028  r _s, _n in zip(
+00095930: 732c 206e 295d 0a20 2020 2020 2020 2020  s, n)].         
+00095940: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00095950: 7365 6c66 2e5f 5f63 7572 5f76 666c 635f  self.__cur_vflc_
+00095960: 6f70 5f63 6f64 6520 3d3d 2027 5e27 3a0a  op_code == '^':.
+00095970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00095980: 2020 2020 2020 2020 7365 6c66 2e65 7661          self.eva
+00095990: 6c75 6174 655b 7365 6c66 2e5f 5f63 7572  luate[self.__cur
+000959a0: 5f73 796d 626f 6c5f 6e61 6d65 5d20 3d20  _symbol_name] = 
+000959b0: 5b5f 7320 2a2a 205f 6e20 666f 7220 5f73  [_s ** _n for _s
+000959c0: 2c20 5f6e 2069 6e20 7a69 7028 732c 206e  , _n in zip(s, n
+000959d0: 295d 0a20 2020 2020 2020 2020 2020 2020  )].             
+000959e0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+000959f0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00095a00: 7365 6c66 2e5f 5f63 7572 5f76 666c 635f  self.__cur_vflc_
+00095a10: 6f70 5f63 6f64 6520 3d3d 2027 2b27 3a0a  op_code == '+':.
+00095a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00095a30: 2020 2020 2020 2020 7365 6c66 2e65 7661          self.eva
+00095a40: 6c75 6174 655b 7365 6c66 2e5f 5f63 7572  luate[self.__cur
+00095a50: 5f73 796d 626f 6c5f 6e61 6d65 5d20 3d20  _symbol_name] = 
+00095a60: 7320 2b20 6e0a 2020 2020 2020 2020 2020  s + n.          
+00095a70: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
+00095a80: 656c 662e 5f5f 6375 725f 7666 6c63 5f6f  elf.__cur_vflc_o
+00095a90: 705f 636f 6465 203d 3d20 272d 273a 0a20  p_code == '-':. 
+00095aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00095ab0: 2020 2020 2020 2073 656c 662e 6576 616c         self.eval
+00095ac0: 7561 7465 5b73 656c 662e 5f5f 6375 725f  uate[self.__cur_
+00095ad0: 7379 6d62 6f6c 5f6e 616d 655d 203d 2073  symbol_name] = s
+00095ae0: 202d 206e 0a20 2020 2020 2020 2020 2020   - n.           
+00095af0: 2020 2020 2020 2020 2065 6c69 6620 7365           elif se
+00095b00: 6c66 2e5f 5f63 7572 5f76 666c 635f 6f70  lf.__cur_vflc_op
+00095b10: 5f63 6f64 6520 3d3d 2027 2a27 3a0a 2020  _code == '*':.  
+00095b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00095b30: 2020 2020 2020 7365 6c66 2e65 7661 6c75        self.evalu
+00095b40: 6174 655b 7365 6c66 2e5f 5f63 7572 5f73  ate[self.__cur_s
+00095b50: 796d 626f 6c5f 6e61 6d65 5d20 3d20 7320  ymbol_name] = s 
+00095b60: 2a20 6e0a 2020 2020 2020 2020 2020 2020  * n.            
+00095b70: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
+00095b80: 662e 5f5f 6375 725f 7666 6c63 5f6f 705f  f.__cur_vflc_op_
+00095b90: 636f 6465 203d 3d20 272f 273a 0a20 2020  code == '/':.   
+00095ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00095bb0: 2020 2020 2073 656c 662e 6576 616c 7561       self.evalua
+00095bc0: 7465 5b73 656c 662e 5f5f 6375 725f 7379  te[self.__cur_sy
+00095bd0: 6d62 6f6c 5f6e 616d 655d 203d 2073 202f  mbol_name] = s /
+00095be0: 206e 0a20 2020 2020 2020 2020 2020 2020   n.             
+00095bf0: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
+00095c00: 2e5f 5f63 7572 5f76 666c 635f 6f70 5f63  .__cur_vflc_op_c
+00095c10: 6f64 6520 3d3d 2027 5e27 3a0a 2020 2020  ode == '^':.    
+00095c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00095c30: 2020 2020 7365 6c66 2e65 7661 6c75 6174      self.evaluat
+00095c40: 655b 7365 6c66 2e5f 5f63 7572 5f73 796d  e[self.__cur_sym
+00095c50: 626f 6c5f 6e61 6d65 5d20 3d20 7320 2a2a  bol_name] = s **
+00095c60: 206e 0a0a 2020 2020 2020 2020 7365 6c66   n..        self
+00095c70: 2e73 7461 636b 5666 6c63 2e63 6c65 6172  .stackVflc.clear
+00095c80: 2829 0a0a 2020 2020 2320 456e 7465 7220  ()..    # Enter 
+00095c90: 6120 7061 7273 6520 7472 6565 2070 726f  a parse tree pro
+00095ca0: 6475 6365 6420 6279 2058 706c 6f72 4d52  duced by XplorMR
+00095cb0: 5061 7273 6572 2365 7661 6c75 6174 655f  Parser#evaluate_
+00095cc0: 6f70 6572 6174 696f 6e2e 0a20 2020 2064  operation..    d
+00095cd0: 6566 2065 6e74 6572 4576 616c 7561 7465  ef enterEvaluate
+00095ce0: 5f6f 7065 7261 7469 6f6e 2873 656c 662c  _operation(self,
+00095cf0: 2063 7478 3a20 5870 6c6f 724d 5250 6172   ctx: XplorMRPar
+00095d00: 7365 722e 4576 616c 7561 7465 5f6f 7065  ser.Evaluate_ope
+00095d10: 7261 7469 6f6e 436f 6e74 6578 7429 3a20  rationContext): 
+00095d20: 2023 2070 796c 696e 743a 2064 6973 6162   # pylint: disab
+00095d30: 6c65 3d75 6e75 7365 642d 6172 6775 6d65  le=unused-argume
+00095d40: 6e74 0a20 2020 2020 2020 2070 6173 730a  nt.        pass.
+00095d50: 0a20 2020 2023 2045 7869 7420 6120 7061  .    # Exit a pa
+00095d60: 7273 6520 7472 6565 2070 726f 6475 6365  rse tree produce
+00095d70: 6420 6279 2058 706c 6f72 4d52 5061 7273  d by XplorMRPars
+00095d80: 6572 2365 7661 6c75 6174 655f 6f70 6572  er#evaluate_oper
+00095d90: 6174 696f 6e2e 0a20 2020 2064 6566 2065  ation..    def e
+00095da0: 7869 7445 7661 6c75 6174 655f 6f70 6572  xitEvaluate_oper
+00095db0: 6174 696f 6e28 7365 6c66 2c20 6374 783a  ation(self, ctx:
+00095dc0: 2058 706c 6f72 4d52 5061 7273 6572 2e45   XplorMRParser.E
+00095dd0: 7661 6c75 6174 655f 6f70 6572 6174 696f  valuate_operatio
+00095de0: 6e43 6f6e 7465 7874 293a 0a20 2020 2020  nContext):.     
+00095df0: 2020 2069 6620 6374 782e 4164 645f 6f70     if ctx.Add_op
+00095e00: 5f56 4528 293a 0a20 2020 2020 2020 2020  _VE():.         
+00095e10: 2020 2073 656c 662e 5f5f 6375 725f 7666     self.__cur_vf
+00095e20: 6c63 5f6f 705f 636f 6465 203d 2027 2b27  lc_op_code = '+'
+00095e30: 0a20 2020 2020 2020 2065 6c69 6620 6374  .        elif ct
+00095e40: 782e 5375 625f 6f70 5f56 4528 293a 0a20  x.Sub_op_VE():. 
+00095e50: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00095e60: 5f5f 6375 725f 7666 6c63 5f6f 705f 636f  __cur_vflc_op_co
+00095e70: 6465 203d 2027 2d27 0a20 2020 2020 2020  de = '-'.       
+00095e80: 2065 6c69 6620 6374 782e 4d75 6c5f 6f70   elif ctx.Mul_op
+00095e90: 5f56 4528 293a 0a20 2020 2020 2020 2020  _VE():.         
+00095ea0: 2020 2073 656c 662e 5f5f 6375 725f 7666     self.__cur_vf
+00095eb0: 6c63 5f6f 705f 636f 6465 203d 2027 2a27  lc_op_code = '*'
+00095ec0: 0a20 2020 2020 2020 2065 6c69 6620 6374  .        elif ct
+00095ed0: 782e 4469 765f 6f70 5f56 4528 293a 0a20  x.Div_op_VE():. 
+00095ee0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00095ef0: 5f5f 6375 725f 7666 6c63 5f6f 705f 636f  __cur_vflc_op_co
+00095f00: 6465 203d 2027 2f27 0a20 2020 2020 2020  de = '/'.       
+00095f10: 2065 6c69 6620 6374 782e 4578 705f 6f70   elif ctx.Exp_op
+00095f20: 5f56 4528 293a 0a20 2020 2020 2020 2020  _VE():.         
+00095f30: 2020 2073 656c 662e 5f5f 6375 725f 7666     self.__cur_vf
+00095f40: 6c63 5f6f 705f 636f 6465 203d 2027 5e27  lc_op_code = '^'
+00095f50: 0a0a 2020 2020 2320 456e 7465 7220 6120  ..    # Enter a 
+00095f60: 7061 7273 6520 7472 6565 2070 726f 6475  parse tree produ
+00095f70: 6365 6420 6279 2058 706c 6f72 4d52 5061  ced by XplorMRPa
+00095f80: 7273 6572 2370 6174 6368 5f73 7461 7465  rser#patch_state
+00095f90: 6d65 6e74 2e0a 2020 2020 6465 6620 656e  ment..    def en
+00095fa0: 7465 7250 6174 6368 5f73 7461 7465 6d65  terPatch_stateme
+00095fb0: 6e74 2873 656c 662c 2063 7478 3a20 5870  nt(self, ctx: Xp
+00095fc0: 6c6f 724d 5250 6172 7365 722e 5061 7463  lorMRParser.Patc
+00095fd0: 685f 7374 6174 656d 656e 7443 6f6e 7465  h_statementConte
+00095fe0: 7874 293a 2020 2320 7079 6c69 6e74 3a20  xt):  # pylint: 
+00095ff0: 6469 7361 626c 653d 756e 7573 6564 2d61  disable=unused-a
+00096000: 7267 756d 656e 740a 2020 2020 2020 2020  rgument.        
+00096010: 7365 6c66 2e67 656f 5265 7374 7261 696e  self.geoRestrain
+00096020: 7473 202b 3d20 310a 2020 2020 2020 2020  ts += 1.        
+00096030: 7365 6c66 2e5f 5f63 7572 5f73 7562 7479  self.__cur_subty
+00096040: 7065 203d 2027 6765 6f27 0a0a 2020 2020  pe = 'geo'..    
+00096050: 2020 2020 7365 6c66 2e61 746f 6d53 656c      self.atomSel
+00096060: 6563 7469 6f6e 5365 742e 636c 6561 7228  ectionSet.clear(
+00096070: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
+00096080: 5f67 2e63 6c65 6172 2829 0a0a 2020 2020  _g.clear()..    
+00096090: 2320 4578 6974 2061 2070 6172 7365 2074  # Exit a parse t
+000960a0: 7265 6520 7072 6f64 7563 6564 2062 7920  ree produced by 
+000960b0: 5870 6c6f 724d 5250 6172 7365 7223 7061  XplorMRParser#pa
+000960c0: 7463 685f 7374 6174 656d 656e 742e 0a20  tch_statement.. 
+000960d0: 2020 2064 6566 2065 7869 7450 6174 6368     def exitPatch
+000960e0: 5f73 7461 7465 6d65 6e74 2873 656c 662c  _statement(self,
+000960f0: 2063 7478 3a20 5870 6c6f 724d 5250 6172   ctx: XplorMRPar
+00096100: 7365 722e 5061 7463 685f 7374 6174 656d  ser.Patch_statem
+00096110: 656e 7443 6f6e 7465 7874 293a 2020 2320  entContext):  # 
+00096120: 7079 6c69 6e74 3a20 6469 7361 626c 653d  pylint: disable=
+00096130: 756e 7573 6564 2d61 7267 756d 656e 740a  unused-argument.
+00096140: 2020 2020 2020 2020 7061 7373 0a0a 2020          pass..  
+00096150: 2020 2320 456e 7465 7220 6120 7061 7273    # Enter a pars
+00096160: 6520 7472 6565 2070 726f 6475 6365 6420  e tree produced 
+00096170: 6279 2058 706c 6f72 4d52 5061 7273 6572  by XplorMRParser
+00096180: 2370 6172 616d 6574 6572 5f73 6574 7469  #parameter_setti
+00096190: 6e67 2e0a 2020 2020 6465 6620 656e 7465  ng..    def ente
+000961a0: 7250 6172 616d 6574 6572 5f73 6574 7469  rParameter_setti
+000961b0: 6e67 2873 656c 662c 2063 7478 3a20 5870  ng(self, ctx: Xp
+000961c0: 6c6f 724d 5250 6172 7365 722e 5061 7261  lorMRParser.Para
+000961d0: 6d65 7465 725f 7365 7474 696e 6743 6f6e  meter_settingCon
+000961e0: 7465 7874 293a 2020 2320 7079 6c69 6e74  text):  # pylint
+000961f0: 3a20 6469 7361 626c 653d 756e 7573 6564  : disable=unused
+00096200: 2d61 7267 756d 656e 740a 2020 2020 2020  -argument.      
+00096210: 2020 7061 7373 0a0a 2020 2020 2320 4578    pass..    # Ex
+00096220: 6974 2061 2070 6172 7365 2074 7265 6520  it a parse tree 
+00096230: 7072 6f64 7563 6564 2062 7920 5870 6c6f  produced by Xplo
+00096240: 724d 5250 6172 7365 7223 7061 7261 6d65  rMRParser#parame
+00096250: 7465 725f 7365 7474 696e 672e 0a20 2020  ter_setting..   
+00096260: 2064 6566 2065 7869 7450 6172 616d 6574   def exitParamet
+00096270: 6572 5f73 6574 7469 6e67 2873 656c 662c  er_setting(self,
+00096280: 2063 7478 3a20 5870 6c6f 724d 5250 6172   ctx: XplorMRPar
+00096290: 7365 722e 5061 7261 6d65 7465 725f 7365  ser.Parameter_se
+000962a0: 7474 696e 6743 6f6e 7465 7874 293a 2020  ttingContext):  
+000962b0: 2320 7079 6c69 6e74 3a20 6469 7361 626c  # pylint: disabl
+000962c0: 653d 756e 7573 6564 2d61 7267 756d 656e  e=unused-argumen
+000962d0: 740a 2020 2020 2020 2020 7061 7373 0a0a  t.        pass..
+000962e0: 2020 2020 2320 456e 7465 7220 6120 7061      # Enter a pa
+000962f0: 7273 6520 7472 6565 2070 726f 6475 6365  rse tree produce
+00096300: 6420 6279 2058 706c 6f72 4d52 5061 7273  d by XplorMRPars
+00096310: 6572 2370 6172 616d 6574 6572 5f73 7461  er#parameter_sta
+00096320: 7465 6d65 6e74 2e0a 2020 2020 6465 6620  tement..    def 
+00096330: 656e 7465 7250 6172 616d 6574 6572 5f73  enterParameter_s
+00096340: 7461 7465 6d65 6e74 2873 656c 662c 2063  tatement(self, c
+00096350: 7478 3a20 5870 6c6f 724d 5250 6172 7365  tx: XplorMRParse
+00096360: 722e 5061 7261 6d65 7465 725f 7374 6174  r.Parameter_stat
+00096370: 656d 656e 7443 6f6e 7465 7874 293a 2020  ementContext):  
+00096380: 2320 7079 6c69 6e74 3a20 6469 7361 626c  # pylint: disabl
+00096390: 653d 756e 7573 6564 2d61 7267 756d 656e  e=unused-argumen
+000963a0: 740a 2020 2020 2020 2020 7365 6c66 2e67  t.        self.g
+000963b0: 656f 5265 7374 7261 696e 7473 202b 3d20  eoRestraints += 
+000963c0: 310a 2020 2020 2020 2020 7365 6c66 2e5f  1.        self._
+000963d0: 5f63 7572 5f73 7562 7479 7065 203d 2027  _cur_subtype = '
+000963e0: 6765 6f27 0a0a 2020 2020 2320 4578 6974  geo'..    # Exit
+000963f0: 2061 2070 6172 7365 2074 7265 6520 7072   a parse tree pr
+00096400: 6f64 7563 6564 2062 7920 5870 6c6f 724d  oduced by XplorM
+00096410: 5250 6172 7365 7223 7061 7261 6d65 7465  RParser#paramete
+00096420: 725f 7374 6174 656d 656e 742e 0a20 2020  r_statement..   
+00096430: 2064 6566 2065 7869 7450 6172 616d 6574   def exitParamet
+00096440: 6572 5f73 7461 7465 6d65 6e74 2873 656c  er_statement(sel
+00096450: 662c 2063 7478 3a20 5870 6c6f 724d 5250  f, ctx: XplorMRP
+00096460: 6172 7365 722e 5061 7261 6d65 7465 725f  arser.Parameter_
+00096470: 7374 6174 656d 656e 7443 6f6e 7465 7874  statementContext
+00096480: 293a 2020 2320 7079 6c69 6e74 3a20 6469  ):  # pylint: di
+00096490: 7361 626c 653d 756e 7573 6564 2d61 7267  sable=unused-arg
+000964a0: 756d 656e 740a 2020 2020 2020 2020 7061  ument.        pa
+000964b0: 7373 0a0a 2020 2020 2320 456e 7465 7220  ss..    # Enter 
+000964c0: 6120 7061 7273 6520 7472 6565 2070 726f  a parse tree pro
+000964d0: 6475 6365 6420 6279 2058 706c 6f72 4d52  duced by XplorMR
+000964e0: 5061 7273 6572 236e 6f65 5f61 7373 6967  Parser#noe_assig
+000964f0: 6e5f 6c6f 6f70 2e0a 2020 2020 6465 6620  n_loop..    def 
+00096500: 656e 7465 724e 6f65 5f61 7373 6967 6e5f  enterNoe_assign_
+00096510: 6c6f 6f70 2873 656c 662c 2063 7478 3a20  loop(self, ctx: 
+00096520: 5870 6c6f 724d 5250 6172 7365 722e 4e6f  XplorMRParser.No
+00096530: 655f 6173 7369 676e 5f6c 6f6f 7043 6f6e  e_assign_loopCon
+00096540: 7465 7874 293a 0a20 2020 2020 2020 2073  text):.        s
+00096550: 796d 626f 6c5f 6e61 6d65 203d 204e 6f6e  ymbol_name = Non
+00096560: 650a 2020 2020 2020 2020 6966 2063 7478  e.        if ctx
+00096570: 2e53 796d 626f 6c5f 6e61 6d65 5f43 4628  .Symbol_name_CF(
+00096580: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
+00096590: 796d 626f 6c5f 6e61 6d65 203d 2073 7472  ymbol_name = str
+000965a0: 2863 7478 2e53 796d 626f 6c5f 6e61 6d65  (ctx.Symbol_name
+000965b0: 5f43 4628 2929 0a0a 2020 2020 2020 2020  _CF())..        
+000965c0: 6966 2063 7478 2e49 6e74 6567 6572 5f43  if ctx.Integer_C
+000965d0: 4628 3029 3a0a 2020 2020 2020 2020 2020  F(0):.          
+000965e0: 2020 696e 745f 6c69 7374 203d 205b 5d0a    int_list = [].
+000965f0: 2020 2020 2020 2020 2020 2020 6964 7820              idx 
+00096600: 3d20 300a 2020 2020 2020 2020 2020 2020  = 0.            
+00096610: 7768 696c 6520 5472 7565 3a0a 2020 2020  while True:.    
+00096620: 2020 2020 2020 2020 2020 2020 6966 2063              if c
+00096630: 7478 2e49 6e74 6567 6572 5f43 4628 6964  tx.Integer_CF(id
+00096640: 7829 3a0a 2020 2020 2020 2020 2020 2020  x):.            
+00096650: 2020 2020 2020 2020 696e 745f 6c69 7374          int_list
+00096660: 2e61 7070 656e 6428 696e 7428 7374 7228  .append(int(str(
+00096670: 6374 782e 496e 7465 6765 725f 4346 2869  ctx.Integer_CF(i
+00096680: 6478 2929 2929 0a20 2020 2020 2020 2020  dx)))).         
+00096690: 2020 2020 2020 2020 2020 2069 6478 202b             idx +
+000966a0: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
+000966b0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000966c0: 2020 2020 2020 2020 2020 2020 2020 6272                br
+000966d0: 6561 6b0a 2020 2020 2020 2020 2020 2020  eak.            
+000966e0: 6966 2073 796d 626f 6c5f 6e61 6d65 2069  if symbol_name i
+000966f0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+00096700: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00096710: 2e65 7661 6c75 6174 6546 6f72 5b73 796d  .evaluateFor[sym
+00096720: 626f 6c5f 6e61 6d65 5d20 3d20 696e 745f  bol_name] = int_
+00096730: 6c69 7374 0a0a 2020 2020 2020 2020 6966  list..        if
+00096740: 2063 7478 2e52 6561 6c5f 4346 2830 293a   ctx.Real_CF(0):
+00096750: 0a20 2020 2020 2020 2020 2020 2072 6561  .            rea
+00096760: 6c5f 6c69 7374 203d 205b 5d0a 2020 2020  l_list = [].    
+00096770: 2020 2020 2020 2020 6964 7820 3d20 300a          idx = 0.
+00096780: 2020 2020 2020 2020 2020 2020 7768 696c              whil
+00096790: 6520 5472 7565 3a0a 2020 2020 2020 2020  e True:.        
+000967a0: 2020 2020 2020 2020 6966 2063 7478 2e52          if ctx.R
+000967b0: 6561 6c5f 4346 2869 6478 293a 0a20 2020  eal_CF(idx):.   
+000967c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000967d0: 2072 6561 6c5f 6c69 7374 2e61 7070 656e   real_list.appen
+000967e0: 6428 666c 6f61 7428 7374 7228 6374 782e  d(float(str(ctx.
+000967f0: 5265 616c 5f43 4628 6964 7829 2929 290a  Real_CF(idx)))).
+00096800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00096810: 2020 2020 6964 7820 2b3d 2031 0a20 2020      idx += 1.   
+00096820: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00096830: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00096840: 2020 2020 2020 2062 7265 616b 0a20 2020         break.   
+00096850: 2020 2020 2020 2020 2069 6620 7379 6d62           if symb
+00096860: 6f6c 5f6e 616d 655b 305d 2069 7320 6e6f  ol_name[0] is no
+00096870: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+00096880: 2020 2020 2020 2020 7365 6c66 2e65 7661          self.eva
+00096890: 6c75 6174 6546 6f72 5b73 796d 626f 6c5f  luateFor[symbol_
+000968a0: 6e61 6d65 5d20 3d20 7265 616c 5f6c 6973  name] = real_lis
+000968b0: 740a 0a20 2020 2020 2020 2069 6620 6374  t..        if ct
+000968c0: 782e 5369 6d70 6c65 5f6e 616d 655f 4346  x.Simple_name_CF
+000968d0: 2830 293a 0a20 2020 2020 2020 2020 2020  (0):.           
+000968e0: 2073 7472 5f6c 6973 7420 3d20 5b5d 0a20   str_list = []. 
+000968f0: 2020 2020 2020 2020 2020 2069 6478 203d             idx =
+00096900: 2030 0a20 2020 2020 2020 2020 2020 2077   0.            w
+00096910: 6869 6c65 2054 7275 653a 0a20 2020 2020  hile True:.     
+00096920: 2020 2020 2020 2020 2020 2069 6620 6374             if ct
+00096930: 782e 5369 6d70 6c65 5f6e 616d 655f 4346  x.Simple_name_CF
+00096940: 2869 6478 293a 0a20 2020 2020 2020 2020  (idx):.         
+00096950: 2020 2020 2020 2020 2020 2073 7472 5f6c             str_l
+00096960: 6973 742e 6170 7065 6e64 2873 7472 2863  ist.append(str(c
+00096970: 7478 2e53 696d 706c 655f 6e61 6d65 5f43  tx.Simple_name_C
+00096980: 4628 6964 7829 2929 0a20 2020 2020 2020  F(idx))).       
+00096990: 2020 2020 2020 2020 2020 2020 2069 6478               idx
+000969a0: 202b 3d20 310a 2020 2020 2020 2020 2020   += 1.          
+000969b0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+000969c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000969d0: 6272 6561 6b0a 2020 2020 2020 2020 2020  break.          
+000969e0: 2020 6966 2073 796d 626f 6c5f 6e61 6d65    if symbol_name
+000969f0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+00096a00: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00096a10: 6c66 2e65 7661 6c75 6174 6546 6f72 5b73  lf.evaluateFor[s
+00096a20: 796d 626f 6c5f 6e61 6d65 5d20 3d20 7374  ymbol_name] = st
+00096a30: 725f 6c69 7374 0a0a 2020 2020 2320 4578  r_list..    # Ex
+00096a40: 6974 2061 2070 6172 7365 2074 7265 6520  it a parse tree 
+00096a50: 7072 6f64 7563 6564 2062 7920 5870 6c6f  produced by Xplo
+00096a60: 724d 5250 6172 7365 7223 6e6f 655f 6173  rMRParser#noe_as
+00096a70: 7369 676e 5f6c 6f6f 702e 0a20 2020 2064  sign_loop..    d
+00096a80: 6566 2065 7869 744e 6f65 5f61 7373 6967  ef exitNoe_assig
+00096a90: 6e5f 6c6f 6f70 2873 656c 662c 2063 7478  n_loop(self, ctx
+00096aa0: 3a20 5870 6c6f 724d 5250 6172 7365 722e  : XplorMRParser.
+00096ab0: 4e6f 655f 6173 7369 676e 5f6c 6f6f 7043  Noe_assign_loopC
+00096ac0: 6f6e 7465 7874 293a 0a20 2020 2020 2020  ontext):.       
+00096ad0: 2069 6620 6374 782e 5379 6d62 6f6c 5f6e   if ctx.Symbol_n
+00096ae0: 616d 655f 4346 2829 3a0a 2020 2020 2020  ame_CF():.      
+00096af0: 2020 2020 2020 7379 6d62 6f6c 5f6e 616d        symbol_nam
+00096b00: 6520 3d20 7374 7228 6374 782e 5379 6d62  e = str(ctx.Symb
+00096b10: 6f6c 5f6e 616d 655f 4346 2829 290a 2020  ol_name_CF()).  
+00096b20: 2020 2020 2020 2020 2020 6966 2073 796d            if sym
+00096b30: 626f 6c5f 6e61 6d65 2069 6e20 7365 6c66  bol_name in self
+00096b40: 2e65 7661 6c75 6174 6546 6f72 3a0a 2020  .evaluateFor:.  
+00096b50: 2020 2020 2020 2020 2020 2020 2020 6465                de
+00096b60: 6c20 7365 6c66 2e65 7661 6c75 6174 6546  l self.evaluateF
+00096b70: 6f72 5b73 796d 626f 6c5f 6e61 6d65 5d0a  or[symbol_name].
+00096b80: 0a20 2020 2023 2045 6e74 6572 2061 2070  .    # Enter a p
+00096b90: 6172 7365 2074 7265 6520 7072 6f64 7563  arse tree produc
+00096ba0: 6564 2062 7920 5870 6c6f 724d 5250 6172  ed by XplorMRPar
+00096bb0: 7365 7223 6469 6865 6472 616c 5f61 7373  ser#dihedral_ass
+00096bc0: 6967 6e5f 6c6f 6f70 2e0a 2020 2020 6465  ign_loop..    de
+00096bd0: 6620 656e 7465 7244 6968 6564 7261 6c5f  f enterDihedral_
+00096be0: 6173 7369 676e 5f6c 6f6f 7028 7365 6c66  assign_loop(self
+00096bf0: 2c20 6374 783a 2058 706c 6f72 4d52 5061  , ctx: XplorMRPa
+00096c00: 7273 6572 2e44 6968 6564 7261 6c5f 6173  rser.Dihedral_as
+00096c10: 7369 676e 5f6c 6f6f 7043 6f6e 7465 7874  sign_loopContext
+00096c20: 293a 0a20 2020 2020 2020 2073 796d 626f  ):.        symbo
+00096c30: 6c5f 6e61 6d65 203d 204e 6f6e 650a 2020  l_name = None.  
+00096c40: 2020 2020 2020 6966 2063 7478 2e53 796d        if ctx.Sym
+00096c50: 626f 6c5f 6e61 6d65 5f43 4628 293a 0a20  bol_name_CF():. 
+00096c60: 2020 2020 2020 2020 2020 2073 796d 626f             symbo
+00096c70: 6c5f 6e61 6d65 203d 2073 7472 2863 7478  l_name = str(ctx
+00096c80: 2e53 796d 626f 6c5f 6e61 6d65 5f43 4628  .Symbol_name_CF(
+00096c90: 2929 0a0a 2020 2020 2020 2020 6966 2063  ))..        if c
+00096ca0: 7478 2e49 6e74 6567 6572 5f43 4628 3029  tx.Integer_CF(0)
+00096cb0: 3a0a 2020 2020 2020 2020 2020 2020 696e  :.            in
+00096cc0: 745f 6c69 7374 203d 205b 5d0a 2020 2020  t_list = [].    
+00096cd0: 2020 2020 2020 2020 6964 7820 3d20 300a          idx = 0.
+00096ce0: 2020 2020 2020 2020 2020 2020 7768 696c              whil
+00096cf0: 6520 5472 7565 3a0a 2020 2020 2020 2020  e True:.        
+00096d00: 2020 2020 2020 2020 6966 2063 7478 2e49          if ctx.I
+00096d10: 6e74 6567 6572 5f43 4628 6964 7829 3a0a  nteger_CF(idx):.
+00096d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00096d30: 2020 2020 696e 745f 6c69 7374 2e61 7070      int_list.app
+00096d40: 656e 6428 696e 7428 7374 7228 6374 782e  end(int(str(ctx.
+00096d50: 496e 7465 6765 725f 4346 2869 6478 2929  Integer_CF(idx))
+00096d60: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+00096d70: 2020 2020 2020 2069 6478 202b 3d20 310a         idx += 1.
+00096d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00096d90: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00096da0: 2020 2020 2020 2020 2020 6272 6561 6b0a            break.
+00096db0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00096dc0: 796d 626f 6c5f 6e61 6d65 2069 7320 6e6f  ymbol_name is no
+00096dd0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+00096de0: 2020 2020 2020 2020 7365 6c66 2e65 7661          self.eva
+00096df0: 6c75 6174 6546 6f72 5b73 796d 626f 6c5f  luateFor[symbol_
+00096e00: 6e61 6d65 5d20 3d20 696e 745f 6c69 7374  name] = int_list
+00096e10: 0a0a 2020 2020 2020 2020 6966 2063 7478  ..        if ctx
+00096e20: 2e52 6561 6c5f 4346 2830 293a 0a20 2020  .Real_CF(0):.   
+00096e30: 2020 2020 2020 2020 2072 6561 6c5f 6c69           real_li
+00096e40: 7374 203d 205b 5d0a 2020 2020 2020 2020  st = [].        
+00096e50: 2020 2020 6964 7820 3d20 300a 2020 2020      idx = 0.    
+00096e60: 2020 2020 2020 2020 7768 696c 6520 5472          while Tr
+00096e70: 7565 3a0a 2020 2020 2020 2020 2020 2020  ue:.            
+00096e80: 2020 2020 6966 2063 7478 2e52 6561 6c5f      if ctx.Real_
+00096e90: 4346 2869 6478 293a 0a20 2020 2020 2020  CF(idx):.       
+00096ea0: 2020 2020 2020 2020 2020 2020 2072 6561               rea
+00096eb0: 6c5f 6c69 7374 2e61 7070 656e 6428 666c  l_list.append(fl
+00096ec0: 6f61 7428 7374 7228 6374 782e 5265 616c  oat(str(ctx.Real
+00096ed0: 5f43 4628 6964 7829 2929 290a 2020 2020  _CF(idx)))).    
+00096ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00096ef0: 6964 7820 2b3d 2031 0a20 2020 2020 2020  idx += 1.       
+00096f00: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00096f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00096f20: 2020 2062 7265 616b 0a20 2020 2020 2020     break.       
+00096f30: 2020 2020 2069 6620 7379 6d62 6f6c 5f6e       if symbol_n
+00096f40: 616d 655b 305d 2069 7320 6e6f 7420 4e6f  ame[0] is not No
+00096f50: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00096f60: 2020 2020 7365 6c66 2e65 7661 6c75 6174      self.evaluat
+00096f70: 6546 6f72 5b73 796d 626f 6c5f 6e61 6d65  eFor[symbol_name
+00096f80: 5d20 3d20 7265 616c 5f6c 6973 740a 0a20  ] = real_list.. 
+00096f90: 2020 2020 2020 2069 6620 6374 782e 5369         if ctx.Si
+00096fa0: 6d70 6c65 5f6e 616d 655f 4346 2830 293a  mple_name_CF(0):
+00096fb0: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
+00096fc0: 5f6c 6973 7420 3d20 5b5d 0a20 2020 2020  _list = [].     
+00096fd0: 2020 2020 2020 2069 6478 203d 2030 0a20         idx = 0. 
+00096fe0: 2020 2020 2020 2020 2020 2077 6869 6c65             while
+00096ff0: 2054 7275 653a 0a20 2020 2020 2020 2020   True:.         
+00097000: 2020 2020 2020 2069 6620 6374 782e 5369         if ctx.Si
+00097010: 6d70 6c65 5f6e 616d 655f 4346 2869 6478  mple_name_CF(idx
+00097020: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00097030: 2020 2020 2020 2073 7472 5f6c 6973 742e         str_list.
+00097040: 6170 7065 6e64 2873 7472 2863 7478 2e53  append(str(ctx.S
+00097050: 696d 706c 655f 6e61 6d65 5f43 4628 6964  imple_name_CF(id
+00097060: 7829 2929 0a20 2020 2020 2020 2020 2020  x))).           
+00097070: 2020 2020 2020 2020 2069 6478 202b 3d20           idx += 
+00097080: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
+00097090: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000970a0: 2020 2020 2020 2020 2020 2020 6272 6561              brea
+000970b0: 6b0a 2020 2020 2020 2020 2020 2020 6966  k.            if
+000970c0: 2073 796d 626f 6c5f 6e61 6d65 2069 7320   symbol_name is 
+000970d0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+000970e0: 2020 2020 2020 2020 2020 7365 6c66 2e65            self.e
+000970f0: 7661 6c75 6174 6546 6f72 5b73 796d 626f  valuateFor[symbo
+00097100: 6c5f 6e61 6d65 5d20 3d20 7374 725f 6c69  l_name] = str_li
+00097110: 7374 0a0a 2020 2020 2320 4578 6974 2061  st..    # Exit a
+00097120: 2070 6172 7365 2074 7265 6520 7072 6f64   parse tree prod
+00097130: 7563 6564 2062 7920 5870 6c6f 724d 5250  uced by XplorMRP
+00097140: 6172 7365 7223 6469 6865 6472 616c 5f61  arser#dihedral_a
+00097150: 7373 6967 6e5f 6c6f 6f70 2e0a 2020 2020  ssign_loop..    
+00097160: 6465 6620 6578 6974 4469 6865 6472 616c  def exitDihedral
+00097170: 5f61 7373 6967 6e5f 6c6f 6f70 2873 656c  _assign_loop(sel
+00097180: 662c 2063 7478 3a20 5870 6c6f 724d 5250  f, ctx: XplorMRP
+00097190: 6172 7365 722e 4469 6865 6472 616c 5f61  arser.Dihedral_a
+000971a0: 7373 6967 6e5f 6c6f 6f70 436f 6e74 6578  ssign_loopContex
+000971b0: 7429 3a0a 2020 2020 2020 2020 6966 2063  t):.        if c
+000971c0: 7478 2e53 796d 626f 6c5f 6e61 6d65 5f43  tx.Symbol_name_C
+000971d0: 4628 293a 0a20 2020 2020 2020 2020 2020  F():.           
+000971e0: 2073 796d 626f 6c5f 6e61 6d65 203d 2073   symbol_name = s
+000971f0: 7472 2863 7478 2e53 796d 626f 6c5f 6e61  tr(ctx.Symbol_na
+00097200: 6d65 5f43 4628 2929 0a20 2020 2020 2020  me_CF()).       
+00097210: 2020 2020 2069 6620 7379 6d62 6f6c 5f6e       if symbol_n
+00097220: 616d 6520 696e 2073 656c 662e 6576 616c  ame in self.eval
+00097230: 7561 7465 466f 723a 0a20 2020 2020 2020  uateFor:.       
+00097240: 2020 2020 2020 2020 2064 656c 2073 656c           del sel
+00097250: 662e 6576 616c 7561 7465 466f 725b 7379  f.evaluateFor[sy
+00097260: 6d62 6f6c 5f6e 616d 655d 0a0a 2020 2020  mbol_name]..    
+00097270: 2320 456e 7465 7220 6120 7061 7273 6520  # Enter a parse 
+00097280: 7472 6565 2070 726f 6475 6365 6420 6279  tree produced by
+00097290: 2058 706c 6f72 4d52 5061 7273 6572 2373   XplorMRParser#s
+000972a0: 616e 695f 6173 7369 676e 5f6c 6f6f 702e  ani_assign_loop.
+000972b0: 0a20 2020 2064 6566 2065 6e74 6572 5361  .    def enterSa
+000972c0: 6e69 5f61 7373 6967 6e5f 6c6f 6f70 2873  ni_assign_loop(s
+000972d0: 656c 662c 2063 7478 3a20 5870 6c6f 724d  elf, ctx: XplorM
+000972e0: 5250 6172 7365 722e 5361 6e69 5f61 7373  RParser.Sani_ass
+000972f0: 6967 6e5f 6c6f 6f70 436f 6e74 6578 7429  ign_loopContext)
+00097300: 3a0a 2020 2020 2020 2020 7379 6d62 6f6c  :.        symbol
+00097310: 5f6e 616d 6520 3d20 4e6f 6e65 0a20 2020  _name = None.   
+00097320: 2020 2020 2069 6620 6374 782e 5379 6d62       if ctx.Symb
+00097330: 6f6c 5f6e 616d 655f 4346 2829 3a0a 2020  ol_name_CF():.  
+00097340: 2020 2020 2020 2020 2020 7379 6d62 6f6c            symbol
+00097350: 5f6e 616d 6520 3d20 7374 7228 6374 782e  _name = str(ctx.
+00097360: 5379 6d62 6f6c 5f6e 616d 655f 4346 2829  Symbol_name_CF()
+00097370: 290a 0a20 2020 2020 2020 2069 6620 6374  )..        if ct
+00097380: 782e 496e 7465 6765 725f 4346 2830 293a  x.Integer_CF(0):
+00097390: 0a20 2020 2020 2020 2020 2020 2069 6e74  .            int
+000973a0: 5f6c 6973 7420 3d20 5b5d 0a20 2020 2020  _list = [].     
+000973b0: 2020 2020 2020 2069 6478 203d 2030 0a20         idx = 0. 
+000973c0: 2020 2020 2020 2020 2020 2077 6869 6c65             while
+000973d0: 2054 7275 653a 0a20 2020 2020 2020 2020   True:.         
+000973e0: 2020 2020 2020 2069 6620 6374 782e 496e         if ctx.In
+000973f0: 7465 6765 725f 4346 2869 6478 293a 0a20  teger_CF(idx):. 
+00097400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00097410: 2020 2069 6e74 5f6c 6973 742e 6170 7065     int_list.appe
+00097420: 6e64 2869 6e74 2873 7472 2863 7478 2e49  nd(int(str(ctx.I
+00097430: 6e74 6567 6572 5f43 4628 6964 7829 2929  nteger_CF(idx)))
+00097440: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00097450: 2020 2020 2020 6964 7820 2b3d 2031 0a20        idx += 1. 
+00097460: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00097470: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00097480: 2020 2020 2020 2020 2062 7265 616b 0a20           break. 
+00097490: 2020 2020 2020 2020 2020 2069 6620 7379             if sy
+000974a0: 6d62 6f6c 5f6e 616d 6520 6973 206e 6f74  mbol_name is not
+000974b0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+000974c0: 2020 2020 2020 2073 656c 662e 6576 616c         self.eval
+000974d0: 7561 7465 466f 725b 7379 6d62 6f6c 5f6e  uateFor[symbol_n
+000974e0: 616d 655d 203d 2069 6e74 5f6c 6973 740a  ame] = int_list.
+000974f0: 0a20 2020 2020 2020 2069 6620 6374 782e  .        if ctx.
+00097500: 5265 616c 5f43 4628 3029 3a0a 2020 2020  Real_CF(0):.    
+00097510: 2020 2020 2020 2020 7265 616c 5f6c 6973          real_lis
+00097520: 7420 3d20 5b5d 0a20 2020 2020 2020 2020  t = [].         
+00097530: 2020 2069 6478 203d 2030 0a20 2020 2020     idx = 0.     
+00097540: 2020 2020 2020 2077 6869 6c65 2054 7275         while Tru
+00097550: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00097560: 2020 2069 6620 6374 782e 5265 616c 5f43     if ctx.Real_C
+00097570: 4628 6964 7829 3a0a 2020 2020 2020 2020  F(idx):.        
+00097580: 2020 2020 2020 2020 2020 2020 7265 616c              real
+00097590: 5f6c 6973 742e 6170 7065 6e64 2866 6c6f  _list.append(flo
+000975a0: 6174 2873 7472 2863 7478 2e52 6561 6c5f  at(str(ctx.Real_
+000975b0: 4346 2869 6478 2929 2929 0a20 2020 2020  CF(idx)))).     
+000975c0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000975d0: 6478 202b 3d20 310a 2020 2020 2020 2020  dx += 1.        
+000975e0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+000975f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00097600: 2020 6272 6561 6b0a 2020 2020 2020 2020    break.        
+00097610: 2020 2020 6966 2073 796d 626f 6c5f 6e61      if symbol_na
+00097620: 6d65 5b30 5d20 6973 206e 6f74 204e 6f6e  me[0] is not Non
+00097630: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00097640: 2020 2073 656c 662e 6576 616c 7561 7465     self.evaluate
+00097650: 466f 725b 7379 6d62 6f6c 5f6e 616d 655d  For[symbol_name]
+00097660: 203d 2072 6561 6c5f 6c69 7374 0a0a 2020   = real_list..  
+00097670: 2020 2020 2020 6966 2063 7478 2e53 696d        if ctx.Sim
+00097680: 706c 655f 6e61 6d65 5f43 4628 3029 3a0a  ple_name_CF(0):.
+00097690: 2020 2020 2020 2020 2020 2020 7374 725f              str_
+000976a0: 6c69 7374 203d 205b 5d0a 2020 2020 2020  list = [].      
+000976b0: 2020 2020 2020 6964 7820 3d20 300a 2020        idx = 0.  
+000976c0: 2020 2020 2020 2020 2020 7768 696c 6520            while 
+000976d0: 5472 7565 3a0a 2020 2020 2020 2020 2020  True:.          
+000976e0: 2020 2020 2020 6966 2063 7478 2e53 696d        if ctx.Sim
+000976f0: 706c 655f 6e61 6d65 5f43 4628 6964 7829  ple_name_CF(idx)
+00097700: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00097710: 2020 2020 2020 7374 725f 6c69 7374 2e61        str_list.a
+00097720: 7070 656e 6428 7374 7228 6374 782e 5369  ppend(str(ctx.Si
+00097730: 6d70 6c65 5f6e 616d 655f 4346 2869 6478  mple_name_CF(idx
+00097740: 2929 290a 2020 2020 2020 2020 2020 2020  ))).            
+00097750: 2020 2020 2020 2020 6964 7820 2b3d 2031          idx += 1
+00097760: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00097770: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00097780: 2020 2020 2020 2020 2020 2062 7265 616b             break
+00097790: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000977a0: 7379 6d62 6f6c 5f6e 616d 6520 6973 206e  symbol_name is n
+000977b0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+000977c0: 2020 2020 2020 2020 2073 656c 662e 6576           self.ev
+000977d0: 616c 7561 7465 466f 725b 7379 6d62 6f6c  aluateFor[symbol
+000977e0: 5f6e 616d 655d 203d 2073 7472 5f6c 6973  _name] = str_lis
+000977f0: 740a 0a20 2020 2023 2045 7869 7420 6120  t..    # Exit a 
+00097800: 7061 7273 6520 7472 6565 2070 726f 6475  parse tree produ
+00097810: 6365 6420 6279 2058 706c 6f72 4d52 5061  ced by XplorMRPa
+00097820: 7273 6572 2373 616e 695f 6173 7369 676e  rser#sani_assign
+00097830: 5f6c 6f6f 702e 0a20 2020 2064 6566 2065  _loop..    def e
+00097840: 7869 7453 616e 695f 6173 7369 676e 5f6c  xitSani_assign_l
+00097850: 6f6f 7028 7365 6c66 2c20 6374 783a 2058  oop(self, ctx: X
+00097860: 706c 6f72 4d52 5061 7273 6572 2e53 616e  plorMRParser.San
+00097870: 695f 6173 7369 676e 5f6c 6f6f 7043 6f6e  i_assign_loopCon
+00097880: 7465 7874 293a 0a20 2020 2020 2020 2069  text):.        i
+00097890: 6620 6374 782e 5379 6d62 6f6c 5f6e 616d  f ctx.Symbol_nam
+000978a0: 655f 4346 2829 3a0a 2020 2020 2020 2020  e_CF():.        
+000978b0: 2020 2020 7379 6d62 6f6c 5f6e 616d 6520      symbol_name 
+000978c0: 3d20 7374 7228 6374 782e 5379 6d62 6f6c  = str(ctx.Symbol
+000978d0: 5f6e 616d 655f 4346 2829 290a 2020 2020  _name_CF()).    
+000978e0: 2020 2020 2020 2020 6966 2073 796d 626f          if symbo
+000978f0: 6c5f 6e61 6d65 2069 6e20 7365 6c66 2e65  l_name in self.e
+00097900: 7661 6c75 6174 6546 6f72 3a0a 2020 2020  valuateFor:.    
+00097910: 2020 2020 2020 2020 2020 2020 6465 6c20              del 
+00097920: 7365 6c66 2e65 7661 6c75 6174 6546 6f72  self.evaluateFor
+00097930: 5b73 796d 626f 6c5f 6e61 6d65 5d0a 0a20  [symbol_name].. 
+00097940: 2020 2023 2045 6e74 6572 2061 2070 6172     # Enter a par
+00097950: 7365 2074 7265 6520 7072 6f64 7563 6564  se tree produced
+00097960: 2062 7920 5870 6c6f 724d 5250 6172 7365   by XplorMRParse
+00097970: 7223 7861 6463 5f61 7373 6967 6e5f 6c6f  r#xadc_assign_lo
+00097980: 6f70 2e0a 2020 2020 6465 6620 656e 7465  op..    def ente
+00097990: 7258 6164 635f 6173 7369 676e 5f6c 6f6f  rXadc_assign_loo
+000979a0: 7028 7365 6c66 2c20 6374 783a 2058 706c  p(self, ctx: Xpl
+000979b0: 6f72 4d52 5061 7273 6572 2e58 6164 635f  orMRParser.Xadc_
+000979c0: 6173 7369 676e 5f6c 6f6f 7043 6f6e 7465  assign_loopConte
+000979d0: 7874 293a 0a20 2020 2020 2020 2073 796d  xt):.        sym
+000979e0: 626f 6c5f 6e61 6d65 203d 204e 6f6e 650a  bol_name = None.
+000979f0: 2020 2020 2020 2020 6966 2063 7478 2e53          if ctx.S
+00097a00: 796d 626f 6c5f 6e61 6d65 5f43 4628 293a  ymbol_name_CF():
+00097a10: 0a20 2020 2020 2020 2020 2020 2073 796d  .            sym
+00097a20: 626f 6c5f 6e61 6d65 203d 2073 7472 2863  bol_name = str(c
+00097a30: 7478 2e53 796d 626f 6c5f 6e61 6d65 5f43  tx.Symbol_name_C
+00097a40: 4628 2929 0a0a 2020 2020 2020 2020 6966  F())..        if
+00097a50: 2063 7478 2e49 6e74 6567 6572 5f43 4628   ctx.Integer_CF(
+00097a60: 3029 3a0a 2020 2020 2020 2020 2020 2020  0):.            
+00097a70: 696e 745f 6c69 7374 203d 205b 5d0a 2020  int_list = [].  
+00097a80: 2020 2020 2020 2020 2020 6964 7820 3d20            idx = 
+00097a90: 300a 2020 2020 2020 2020 2020 2020 7768  0.            wh
+00097aa0: 696c 6520 5472 7565 3a0a 2020 2020 2020  ile True:.      
+00097ab0: 2020 2020 2020 2020 2020 6966 2063 7478            if ctx
+00097ac0: 2e49 6e74 6567 6572 5f43 4628 6964 7829  .Integer_CF(idx)
+00097ad0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00097ae0: 2020 2020 2020 696e 745f 6c69 7374 2e61        int_list.a
+00097af0: 7070 656e 6428 696e 7428 7374 7228 6374  ppend(int(str(ct
+00097b00: 782e 496e 7465 6765 725f 4346 2869 6478  x.Integer_CF(idx
+00097b10: 2929 2929 0a20 2020 2020 2020 2020 2020  )))).           
+00097b20: 2020 2020 2020 2020 2069 6478 202b 3d20           idx += 
+00097b30: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
+00097b40: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00097b50: 2020 2020 2020 2020 2020 2020 6272 6561              brea
+00097b60: 6b0a 2020 2020 2020 2020 2020 2020 6966  k.            if
+00097b70: 2073 796d 626f 6c5f 6e61 6d65 2069 7320   symbol_name is 
+00097b80: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00097b90: 2020 2020 2020 2020 2020 7365 6c66 2e65            self.e
+00097ba0: 7661 6c75 6174 6546 6f72 5b73 796d 626f  valuateFor[symbo
+00097bb0: 6c5f 6e61 6d65 5d20 3d20 696e 745f 6c69  l_name] = int_li
+00097bc0: 7374 0a0a 2020 2020 2020 2020 6966 2063  st..        if c
+00097bd0: 7478 2e52 6561 6c5f 4346 2830 293a 0a20  tx.Real_CF(0):. 
+00097be0: 2020 2020 2020 2020 2020 2072 6561 6c5f             real_
+00097bf0: 6c69 7374 203d 205b 5d0a 2020 2020 2020  list = [].      
+00097c00: 2020 2020 2020 6964 7820 3d20 300a 2020        idx = 0.  
+00097c10: 2020 2020 2020 2020 2020 7768 696c 6520            while 
+00097c20: 5472 7565 3a0a 2020 2020 2020 2020 2020  True:.          
+00097c30: 2020 2020 2020 6966 2063 7478 2e52 6561        if ctx.Rea
+00097c40: 6c5f 4346 2869 6478 293a 0a20 2020 2020  l_CF(idx):.     
+00097c50: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00097c60: 6561 6c5f 6c69 7374 2e61 7070 656e 6428  eal_list.append(
+00097c70: 666c 6f61 7428 7374 7228 6374 782e 5265  float(str(ctx.Re
+00097c80: 616c 5f43 4628 6964 7829 2929 290a 2020  al_CF(idx)))).  
+00097c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00097ca0: 2020 6964 7820 2b3d 2031 0a20 2020 2020    idx += 1.     
+00097cb0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00097cc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00097cd0: 2020 2020 2062 7265 616b 0a20 2020 2020       break.     
+00097ce0: 2020 2020 2020 2069 6620 7379 6d62 6f6c         if symbol
+00097cf0: 5f6e 616d 655b 305d 2069 7320 6e6f 7420  _name[0] is not 
+00097d00: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00097d10: 2020 2020 2020 7365 6c66 2e65 7661 6c75        self.evalu
+00097d20: 6174 6546 6f72 5b73 796d 626f 6c5f 6e61  ateFor[symbol_na
+00097d30: 6d65 5d20 3d20 7265 616c 5f6c 6973 740a  me] = real_list.
+00097d40: 0a20 2020 2020 2020 2069 6620 6374 782e  .        if ctx.
+00097d50: 5369 6d70 6c65 5f6e 616d 655f 4346 2830  Simple_name_CF(0
+00097d60: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
+00097d70: 7472 5f6c 6973 7420 3d20 5b5d 0a20 2020  tr_list = [].   
+00097d80: 2020 2020 2020 2020 2069 6478 203d 2030           idx = 0
+00097d90: 0a20 2020 2020 2020 2020 2020 2077 6869  .            whi
+00097da0: 6c65 2054 7275 653a 0a20 2020 2020 2020  le True:.       
+00097db0: 2020 2020 2020 2020 2069 6620 6374 782e           if ctx.
+00097dc0: 5369 6d70 6c65 5f6e 616d 655f 4346 2869  Simple_name_CF(i
+00097dd0: 6478 293a 0a20 2020 2020 2020 2020 2020  dx):.           
+00097de0: 2020 2020 2020 2020 2073 7472 5f6c 6973           str_lis
+00097df0: 742e 6170 7065 6e64 2873 7472 2863 7478  t.append(str(ctx
+00097e00: 2e53 696d 706c 655f 6e61 6d65 5f43 4628  .Simple_name_CF(
+00097e10: 6964 7829 2929 0a20 2020 2020 2020 2020  idx))).         
+00097e20: 2020 2020 2020 2020 2020 2069 6478 202b             idx +
+00097e30: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
+00097e40: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00097e50: 2020 2020 2020 2020 2020 2020 2020 6272                br
+00097e60: 6561 6b0a 2020 2020 2020 2020 2020 2020  eak.            
+00097e70: 6966 2073 796d 626f 6c5f 6e61 6d65 2069  if symbol_name i
+00097e80: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+00097e90: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00097ea0: 2e65 7661 6c75 6174 6546 6f72 5b73 796d  .evaluateFor[sym
+00097eb0: 626f 6c5f 6e61 6d65 5d20 3d20 7374 725f  bol_name] = str_
+00097ec0: 6c69 7374 0a0a 2020 2020 2320 4578 6974  list..    # Exit
+00097ed0: 2061 2070 6172 7365 2074 7265 6520 7072   a parse tree pr
+00097ee0: 6f64 7563 6564 2062 7920 5870 6c6f 724d  oduced by XplorM
+00097ef0: 5250 6172 7365 7223 7861 6463 5f61 7373  RParser#xadc_ass
+00097f00: 6967 6e5f 6c6f 6f70 2e0a 2020 2020 6465  ign_loop..    de
+00097f10: 6620 6578 6974 5861 6463 5f61 7373 6967  f exitXadc_assig
+00097f20: 6e5f 6c6f 6f70 2873 656c 662c 2063 7478  n_loop(self, ctx
+00097f30: 3a20 5870 6c6f 724d 5250 6172 7365 722e  : XplorMRParser.
+00097f40: 5861 6463 5f61 7373 6967 6e5f 6c6f 6f70  Xadc_assign_loop
+00097f50: 436f 6e74 6578 7429 3a0a 2020 2020 2020  Context):.      
+00097f60: 2020 6966 2063 7478 2e53 796d 626f 6c5f    if ctx.Symbol_
+00097f70: 6e61 6d65 5f43 4628 293a 0a20 2020 2020  name_CF():.     
+00097f80: 2020 2020 2020 2073 796d 626f 6c5f 6e61         symbol_na
+00097f90: 6d65 203d 2073 7472 2863 7478 2e53 796d  me = str(ctx.Sym
+00097fa0: 626f 6c5f 6e61 6d65 5f43 4628 2929 0a20  bol_name_CF()). 
+00097fb0: 2020 2020 2020 2020 2020 2069 6620 7379             if sy
+00097fc0: 6d62 6f6c 5f6e 616d 6520 696e 2073 656c  mbol_name in sel
+00097fd0: 662e 6576 616c 7561 7465 466f 723a 0a20  f.evaluateFor:. 
+00097fe0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00097ff0: 656c 2073 656c 662e 6576 616c 7561 7465  el self.evaluate
+00098000: 466f 725b 7379 6d62 6f6c 5f6e 616d 655d  For[symbol_name]
+00098010: 0a0a 2020 2020 2320 456e 7465 7220 6120  ..    # Enter a 
+00098020: 7061 7273 6520 7472 6565 2070 726f 6475  parse tree produ
+00098030: 6365 6420 6279 2058 706c 6f72 4d52 5061  ced by XplorMRPa
+00098040: 7273 6572 2363 6f75 705f 6173 7369 676e  rser#coup_assign
+00098050: 5f6c 6f6f 702e 0a20 2020 2064 6566 2065  _loop..    def e
+00098060: 6e74 6572 436f 7570 5f61 7373 6967 6e5f  nterCoup_assign_
+00098070: 6c6f 6f70 2873 656c 662c 2063 7478 3a20  loop(self, ctx: 
+00098080: 5870 6c6f 724d 5250 6172 7365 722e 436f  XplorMRParser.Co
+00098090: 7570 5f61 7373 6967 6e5f 6c6f 6f70 436f  up_assign_loopCo
+000980a0: 6e74 6578 7429 3a0a 2020 2020 2020 2020  ntext):.        
+000980b0: 7379 6d62 6f6c 5f6e 616d 6520 3d20 4e6f  symbol_name = No
+000980c0: 6e65 0a20 2020 2020 2020 2069 6620 6374  ne.        if ct
+000980d0: 782e 5379 6d62 6f6c 5f6e 616d 655f 4346  x.Symbol_name_CF
+000980e0: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+000980f0: 7379 6d62 6f6c 5f6e 616d 6520 3d20 7374  symbol_name = st
+00098100: 7228 6374 782e 5379 6d62 6f6c 5f6e 616d  r(ctx.Symbol_nam
+00098110: 655f 4346 2829 290a 0a20 2020 2020 2020  e_CF())..       
+00098120: 2069 6620 6374 782e 496e 7465 6765 725f   if ctx.Integer_
+00098130: 4346 2830 293a 0a20 2020 2020 2020 2020  CF(0):.         
+00098140: 2020 2069 6e74 5f6c 6973 7420 3d20 5b5d     int_list = []
+00098150: 0a20 2020 2020 2020 2020 2020 2069 6478  .            idx
+00098160: 203d 2030 0a20 2020 2020 2020 2020 2020   = 0.           
+00098170: 2077 6869 6c65 2054 7275 653a 0a20 2020   while True:.   
+00098180: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00098190: 6374 782e 496e 7465 6765 725f 4346 2869  ctx.Integer_CF(i
+000981a0: 6478 293a 0a20 2020 2020 2020 2020 2020  dx):.           
+000981b0: 2020 2020 2020 2020 2069 6e74 5f6c 6973           int_lis
+000981c0: 742e 6170 7065 6e64 2869 6e74 2873 7472  t.append(int(str
+000981d0: 2863 7478 2e49 6e74 6567 6572 5f43 4628  (ctx.Integer_CF(
+000981e0: 6964 7829 2929 290a 2020 2020 2020 2020  idx)))).        
+000981f0: 2020 2020 2020 2020 2020 2020 6964 7820              idx 
+00098200: 2b3d 2031 0a20 2020 2020 2020 2020 2020  += 1.           
+00098210: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00098220: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00098230: 7265 616b 0a20 2020 2020 2020 2020 2020  reak.           
+00098240: 2069 6620 7379 6d62 6f6c 5f6e 616d 6520   if symbol_name 
+00098250: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+00098260: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00098270: 662e 6576 616c 7561 7465 466f 725b 7379  f.evaluateFor[sy
+00098280: 6d62 6f6c 5f6e 616d 655d 203d 2069 6e74  mbol_name] = int
+00098290: 5f6c 6973 740a 0a20 2020 2020 2020 2069  _list..        i
+000982a0: 6620 6374 782e 5265 616c 5f43 4628 3029  f ctx.Real_CF(0)
+000982b0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+000982c0: 616c 5f6c 6973 7420 3d20 5b5d 0a20 2020  al_list = [].   
+000982d0: 2020 2020 2020 2020 2069 6478 203d 2030           idx = 0
+000982e0: 0a20 2020 2020 2020 2020 2020 2077 6869  .            whi
+000982f0: 6c65 2054 7275 653a 0a20 2020 2020 2020  le True:.       
+00098300: 2020 2020 2020 2020 2069 6620 6374 782e           if ctx.
+00098310: 5265 616c 5f43 4628 6964 7829 3a0a 2020  Real_CF(idx):.  
+00098320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00098330: 2020 7265 616c 5f6c 6973 742e 6170 7065    real_list.appe
+00098340: 6e64 2866 6c6f 6174 2873 7472 2863 7478  nd(float(str(ctx
+00098350: 2e52 6561 6c5f 4346 2869 6478 2929 2929  .Real_CF(idx))))
+00098360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00098370: 2020 2020 2069 6478 202b 3d20 310a 2020       idx += 1.  
+00098380: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00098390: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+000983a0: 2020 2020 2020 2020 6272 6561 6b0a 2020          break.  
+000983b0: 2020 2020 2020 2020 2020 6966 2073 796d            if sym
+000983c0: 626f 6c5f 6e61 6d65 5b30 5d20 6973 206e  bol_name[0] is n
+000983d0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+000983e0: 2020 2020 2020 2020 2073 656c 662e 6576           self.ev
+000983f0: 616c 7561 7465 466f 725b 7379 6d62 6f6c  aluateFor[symbol
+00098400: 5f6e 616d 655d 203d 2072 6561 6c5f 6c69  _name] = real_li
+00098410: 7374 0a0a 2020 2020 2020 2020 6966 2063  st..        if c
+00098420: 7478 2e53 696d 706c 655f 6e61 6d65 5f43  tx.Simple_name_C
+00098430: 4628 3029 3a0a 2020 2020 2020 2020 2020  F(0):.          
+00098440: 2020 7374 725f 6c69 7374 203d 205b 5d0a    str_list = [].
+00098450: 2020 2020 2020 2020 2020 2020 6964 7820              idx 
+00098460: 3d20 300a 2020 2020 2020 2020 2020 2020  = 0.            
+00098470: 7768 696c 6520 5472 7565 3a0a 2020 2020  while True:.    
+00098480: 2020 2020 2020 2020 2020 2020 6966 2063              if c
+00098490: 7478 2e53 696d 706c 655f 6e61 6d65 5f43  tx.Simple_name_C
+000984a0: 4628 6964 7829 3a0a 2020 2020 2020 2020  F(idx):.        
+000984b0: 2020 2020 2020 2020 2020 2020 7374 725f              str_
+000984c0: 6c69 7374 2e61 7070 656e 6428 7374 7228  list.append(str(
+000984d0: 6374 782e 5369 6d70 6c65 5f6e 616d 655f  ctx.Simple_name_
+000984e0: 4346 2869 6478 2929 290a 2020 2020 2020  CF(idx))).      
+000984f0: 2020 2020 2020 2020 2020 2020 2020 6964                id
+00098500: 7820 2b3d 2031 0a20 2020 2020 2020 2020  x += 1.         
+00098510: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00098520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00098530: 2062 7265 616b 0a20 2020 2020 2020 2020   break.         
+00098540: 2020 2069 6620 7379 6d62 6f6c 5f6e 616d     if symbol_nam
+00098550: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
+00098560: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00098570: 656c 662e 6576 616c 7561 7465 466f 725b  elf.evaluateFor[
+00098580: 7379 6d62 6f6c 5f6e 616d 655d 203d 2073  symbol_name] = s
+00098590: 7472 5f6c 6973 740a 0a20 2020 2023 2045  tr_list..    # E
+000985a0: 7869 7420 6120 7061 7273 6520 7472 6565  xit a parse tree
+000985b0: 2070 726f 6475 6365 6420 6279 2058 706c   produced by Xpl
+000985c0: 6f72 4d52 5061 7273 6572 2363 6f75 705f  orMRParser#coup_
+000985d0: 6173 7369 676e 5f6c 6f6f 702e 0a20 2020  assign_loop..   
+000985e0: 2064 6566 2065 7869 7443 6f75 705f 6173   def exitCoup_as
+000985f0: 7369 676e 5f6c 6f6f 7028 7365 6c66 2c20  sign_loop(self, 
+00098600: 6374 783a 2058 706c 6f72 4d52 5061 7273  ctx: XplorMRPars
+00098610: 6572 2e43 6f75 705f 6173 7369 676e 5f6c  er.Coup_assign_l
+00098620: 6f6f 7043 6f6e 7465 7874 293a 0a20 2020  oopContext):.   
+00098630: 2020 2020 2069 6620 6374 782e 5379 6d62       if ctx.Symb
+00098640: 6f6c 5f6e 616d 655f 4346 2829 3a0a 2020  ol_name_CF():.  
+00098650: 2020 2020 2020 2020 2020 7379 6d62 6f6c            symbol
+00098660: 5f6e 616d 6520 3d20 7374 7228 6374 782e  _name = str(ctx.
+00098670: 5379 6d62 6f6c 5f6e 616d 655f 4346 2829  Symbol_name_CF()
+00098680: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+00098690: 2073 796d 626f 6c5f 6e61 6d65 2069 6e20   symbol_name in 
+000986a0: 7365 6c66 2e65 7661 6c75 6174 6546 6f72  self.evaluateFor
+000986b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000986c0: 2020 6465 6c20 7365 6c66 2e65 7661 6c75    del self.evalu
+000986d0: 6174 6546 6f72 5b73 796d 626f 6c5f 6e61  ateFor[symbol_na
+000986e0: 6d65 5d0a 0a20 2020 2023 2045 6e74 6572  me]..    # Enter
+000986f0: 2061 2070 6172 7365 2074 7265 6520 7072   a parse tree pr
+00098700: 6f64 7563 6564 2062 7920 5870 6c6f 724d  oduced by XplorM
+00098710: 5250 6172 7365 7223 636f 6c6c 5f61 7373  RParser#coll_ass
+00098720: 6967 6e5f 6c6f 6f70 2e0a 2020 2020 6465  ign_loop..    de
+00098730: 6620 656e 7465 7243 6f6c 6c5f 6173 7369  f enterColl_assi
+00098740: 676e 5f6c 6f6f 7028 7365 6c66 2c20 6374  gn_loop(self, ct
+00098750: 783a 2058 706c 6f72 4d52 5061 7273 6572  x: XplorMRParser
+00098760: 2e43 6f6c 6c5f 6173 7369 676e 5f6c 6f6f  .Coll_assign_loo
+00098770: 7043 6f6e 7465 7874 293a 0a20 2020 2020  pContext):.     
+00098780: 2020 2073 796d 626f 6c5f 6e61 6d65 203d     symbol_name =
+00098790: 204e 6f6e 650a 2020 2020 2020 2020 6966   None.        if
+000987a0: 2063 7478 2e53 796d 626f 6c5f 6e61 6d65   ctx.Symbol_name
+000987b0: 5f43 4628 293a 0a20 2020 2020 2020 2020  _CF():.         
+000987c0: 2020 2073 796d 626f 6c5f 6e61 6d65 203d     symbol_name =
+000987d0: 2073 7472 2863 7478 2e53 796d 626f 6c5f   str(ctx.Symbol_
+000987e0: 6e61 6d65 5f43 4628 2929 0a0a 2020 2020  name_CF())..    
+000987f0: 2020 2020 6966 2063 7478 2e49 6e74 6567      if ctx.Integ
+00098800: 6572 5f43 4628 3029 3a0a 2020 2020 2020  er_CF(0):.      
+00098810: 2020 2020 2020 696e 745f 6c69 7374 203d        int_list =
+00098820: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
+00098830: 6964 7820 3d20 300a 2020 2020 2020 2020  idx = 0.        
+00098840: 2020 2020 7768 696c 6520 5472 7565 3a0a      while True:.
+00098850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00098860: 6966 2063 7478 2e49 6e74 6567 6572 5f43  if ctx.Integer_C
+00098870: 4628 6964 7829 3a0a 2020 2020 2020 2020  F(idx):.        
+00098880: 2020 2020 2020 2020 2020 2020 696e 745f              int_
+00098890: 6c69 7374 2e61 7070 656e 6428 696e 7428  list.append(int(
+000988a0: 7374 7228 6374 782e 496e 7465 6765 725f  str(ctx.Integer_
+000988b0: 4346 2869 6478 2929 2929 0a20 2020 2020  CF(idx)))).     
+000988c0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000988d0: 6478 202b 3d20 310a 2020 2020 2020 2020  dx += 1.        
+000988e0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+000988f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00098900: 2020 6272 6561 6b0a 2020 2020 2020 2020    break.        
+00098910: 2020 2020 6966 2073 796d 626f 6c5f 6e61      if symbol_na
+00098920: 6d65 2069 7320 6e6f 7420 4e6f 6e65 3a0a  me is not None:.
+00098930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00098940: 7365 6c66 2e65 7661 6c75 6174 6546 6f72  self.evaluateFor
+00098950: 5b73 796d 626f 6c5f 6e61 6d65 5d20 3d20  [symbol_name] = 
+00098960: 696e 745f 6c69 7374 0a0a 2020 2020 2020  int_list..      
+00098970: 2020 6966 2063 7478 2e52 6561 6c5f 4346    if ctx.Real_CF
+00098980: 2830 293a 0a20 2020 2020 2020 2020 2020  (0):.           
+00098990: 2072 6561 6c5f 6c69 7374 203d 205b 5d0a   real_list = [].
+000989a0: 2020 2020 2020 2020 2020 2020 6964 7820              idx 
+000989b0: 3d20 300a 2020 2020 2020 2020 2020 2020  = 0.            
+000989c0: 7768 696c 6520 5472 7565 3a0a 2020 2020  while True:.    
+000989d0: 2020 2020 2020 2020 2020 2020 6966 2063              if c
+000989e0: 7478 2e52 6561 6c5f 4346 2869 6478 293a  tx.Real_CF(idx):
+000989f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00098a00: 2020 2020 2072 6561 6c5f 6c69 7374 2e61       real_list.a
+00098a10: 7070 656e 6428 666c 6f61 7428 7374 7228  ppend(float(str(
+00098a20: 6374 782e 5265 616c 5f43 4628 6964 7829  ctx.Real_CF(idx)
+00098a30: 2929 290a 2020 2020 2020 2020 2020 2020  ))).            
+00098a40: 2020 2020 2020 2020 6964 7820 2b3d 2031          idx += 1
+00098a50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00098a60: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00098a70: 2020 2020 2020 2020 2020 2062 7265 616b             break
+00098a80: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00098a90: 7379 6d62 6f6c 5f6e 616d 655b 305d 2069  symbol_name[0] i
+00098aa0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+00098ab0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00098ac0: 2e65 7661 6c75 6174 6546 6f72 5b73 796d  .evaluateFor[sym
+00098ad0: 626f 6c5f 6e61 6d65 5d20 3d20 7265 616c  bol_name] = real
+00098ae0: 5f6c 6973 740a 0a20 2020 2020 2020 2069  _list..        i
+00098af0: 6620 6374 782e 5369 6d70 6c65 5f6e 616d  f ctx.Simple_nam
+00098b00: 655f 4346 2830 293a 0a20 2020 2020 2020  e_CF(0):.       
+00098b10: 2020 2020 2073 7472 5f6c 6973 7420 3d20       str_list = 
+00098b20: 5b5d 0a20 2020 2020 2020 2020 2020 2069  [].            i
+00098b30: 6478 203d 2030 0a20 2020 2020 2020 2020  dx = 0.         
+00098b40: 2020 2077 6869 6c65 2054 7275 653a 0a20     while True:. 
+00098b50: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00098b60: 6620 6374 782e 5369 6d70 6c65 5f6e 616d  f ctx.Simple_nam
+00098b70: 655f 4346 2869 6478 293a 0a20 2020 2020  e_CF(idx):.     
+00098b80: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00098b90: 7472 5f6c 6973 742e 6170 7065 6e64 2873  tr_list.append(s
+00098ba0: 7472 2863 7478 2e53 696d 706c 655f 6e61  tr(ctx.Simple_na
+00098bb0: 6d65 5f43 4628 6964 7829 2929 0a20 2020  me_CF(idx))).   
+00098bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00098bd0: 2069 6478 202b 3d20 310a 2020 2020 2020   idx += 1.      
+00098be0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00098bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00098c00: 2020 2020 6272 6561 6b0a 2020 2020 2020      break.      
+00098c10: 2020 2020 2020 6966 2073 796d 626f 6c5f        if symbol_
+00098c20: 6e61 6d65 2069 7320 6e6f 7420 4e6f 6e65  name is not None
+00098c30: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00098c40: 2020 7365 6c66 2e65 7661 6c75 6174 6546    self.evaluateF
+00098c50: 6f72 5b73 796d 626f 6c5f 6e61 6d65 5d20  or[symbol_name] 
+00098c60: 3d20 7374 725f 6c69 7374 0a0a 2020 2020  = str_list..    
+00098c70: 2320 4578 6974 2061 2070 6172 7365 2074  # Exit a parse t
+00098c80: 7265 6520 7072 6f64 7563 6564 2062 7920  ree produced by 
+00098c90: 5870 6c6f 724d 5250 6172 7365 7223 636f  XplorMRParser#co
+00098ca0: 6c6c 5f61 7373 6967 6e5f 6c6f 6f70 2e0a  ll_assign_loop..
+00098cb0: 2020 2020 6465 6620 6578 6974 436f 6c6c      def exitColl
+00098cc0: 5f61 7373 6967 6e5f 6c6f 6f70 2873 656c  _assign_loop(sel
+00098cd0: 662c 2063 7478 3a20 5870 6c6f 724d 5250  f, ctx: XplorMRP
+00098ce0: 6172 7365 722e 436f 6c6c 5f61 7373 6967  arser.Coll_assig
+00098cf0: 6e5f 6c6f 6f70 436f 6e74 6578 7429 3a0a  n_loopContext):.
+00098d00: 2020 2020 2020 2020 6966 2063 7478 2e53          if ctx.S
+00098d10: 796d 626f 6c5f 6e61 6d65 5f43 4628 293a  ymbol_name_CF():
+00098d20: 0a20 2020 2020 2020 2020 2020 2073 796d  .            sym
+00098d30: 626f 6c5f 6e61 6d65 203d 2073 7472 2863  bol_name = str(c
+00098d40: 7478 2e53 796d 626f 6c5f 6e61 6d65 5f43  tx.Symbol_name_C
+00098d50: 4628 2929 0a20 2020 2020 2020 2020 2020  F()).           
+00098d60: 2069 6620 7379 6d62 6f6c 5f6e 616d 6520   if symbol_name 
+00098d70: 696e 2073 656c 662e 6576 616c 7561 7465  in self.evaluate
+00098d80: 466f 723a 0a20 2020 2020 2020 2020 2020  For:.           
+00098d90: 2020 2020 2064 656c 2073 656c 662e 6576       del self.ev
+00098da0: 616c 7561 7465 466f 725b 7379 6d62 6f6c  aluateFor[symbol
+00098db0: 5f6e 616d 655d 0a0a 2020 2020 2320 456e  _name]..    # En
+00098dc0: 7465 7220 6120 7061 7273 6520 7472 6565  ter a parse tree
+00098dd0: 2070 726f 6475 6365 6420 6279 2058 706c   produced by Xpl
+00098de0: 6f72 4d52 5061 7273 6572 2363 7361 5f61  orMRParser#csa_a
+00098df0: 7373 6967 6e5f 6c6f 6f70 2e0a 2020 2020  ssign_loop..    
+00098e00: 6465 6620 656e 7465 7243 7361 5f61 7373  def enterCsa_ass
+00098e10: 6967 6e5f 6c6f 6f70 2873 656c 662c 2063  ign_loop(self, c
+00098e20: 7478 3a20 5870 6c6f 724d 5250 6172 7365  tx: XplorMRParse
+00098e30: 722e 4373 615f 6173 7369 676e 5f6c 6f6f  r.Csa_assign_loo
+00098e40: 7043 6f6e 7465 7874 293a 0a20 2020 2020  pContext):.     
+00098e50: 2020 2073 796d 626f 6c5f 6e61 6d65 203d     symbol_name =
+00098e60: 204e 6f6e 650a 2020 2020 2020 2020 6966   None.        if
+00098e70: 2063 7478 2e53 796d 626f 6c5f 6e61 6d65   ctx.Symbol_name
+00098e80: 5f43 4628 293a 0a20 2020 2020 2020 2020  _CF():.         
+00098e90: 2020 2073 796d 626f 6c5f 6e61 6d65 203d     symbol_name =
+00098ea0: 2073 7472 2863 7478 2e53 796d 626f 6c5f   str(ctx.Symbol_
+00098eb0: 6e61 6d65 5f43 4628 2929 0a0a 2020 2020  name_CF())..    
+00098ec0: 2020 2020 6966 2063 7478 2e49 6e74 6567      if ctx.Integ
+00098ed0: 6572 5f43 4628 3029 3a0a 2020 2020 2020  er_CF(0):.      
+00098ee0: 2020 2020 2020 696e 745f 6c69 7374 203d        int_list =
+00098ef0: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
+00098f00: 6964 7820 3d20 300a 2020 2020 2020 2020  idx = 0.        
+00098f10: 2020 2020 7768 696c 6520 5472 7565 3a0a      while True:.
+00098f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00098f30: 6966 2063 7478 2e49 6e74 6567 6572 5f43  if ctx.Integer_C
+00098f40: 4628 6964 7829 3a0a 2020 2020 2020 2020  F(idx):.        
+00098f50: 2020 2020 2020 2020 2020 2020 696e 745f              int_
+00098f60: 6c69 7374 2e61 7070 656e 6428 696e 7428  list.append(int(
+00098f70: 7374 7228 6374 782e 496e 7465 6765 725f  str(ctx.Integer_
+00098f80: 4346 2869 6478 2929 2929 0a20 2020 2020  CF(idx)))).     
+00098f90: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00098fa0: 6478 202b 3d20 310a 2020 2020 2020 2020  dx += 1.        
+00098fb0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00098fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00098fd0: 2020 6272 6561 6b0a 2020 2020 2020 2020    break.        
+00098fe0: 2020 2020 6966 2073 796d 626f 6c5f 6e61      if symbol_na
+00098ff0: 6d65 2069 7320 6e6f 7420 4e6f 6e65 3a0a  me is not None:.
+00099000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00099010: 7365 6c66 2e65 7661 6c75 6174 6546 6f72  self.evaluateFor
+00099020: 5b73 796d 626f 6c5f 6e61 6d65 5d20 3d20  [symbol_name] = 
+00099030: 696e 745f 6c69 7374 0a0a 2020 2020 2020  int_list..      
+00099040: 2020 6966 2063 7478 2e52 6561 6c5f 4346    if ctx.Real_CF
+00099050: 2830 293a 0a20 2020 2020 2020 2020 2020  (0):.           
+00099060: 2072 6561 6c5f 6c69 7374 203d 205b 5d0a   real_list = [].
+00099070: 2020 2020 2020 2020 2020 2020 6964 7820              idx 
+00099080: 3d20 300a 2020 2020 2020 2020 2020 2020  = 0.            
+00099090: 7768 696c 6520 5472 7565 3a0a 2020 2020  while True:.    
+000990a0: 2020 2020 2020 2020 2020 2020 6966 2063              if c
+000990b0: 7478 2e52 6561 6c5f 4346 2869 6478 293a  tx.Real_CF(idx):
+000990c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000990d0: 2020 2020 2072 6561 6c5f 6c69 7374 2e61       real_list.a
+000990e0: 7070 656e 6428 666c 6f61 7428 7374 7228  ppend(float(str(
+000990f0: 6374 782e 5265 616c 5f43 4628 6964 7829  ctx.Real_CF(idx)
+00099100: 2929 290a 2020 2020 2020 2020 2020 2020  ))).            
+00099110: 2020 2020 2020 2020 6964 7820 2b3d 2031          idx += 1
+00099120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00099130: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00099140: 2020 2020 2020 2020 2020 2062 7265 616b             break
+00099150: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00099160: 7379 6d62 6f6c 5f6e 616d 655b 305d 2069  symbol_name[0] i
+00099170: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+00099180: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00099190: 2e65 7661 6c75 6174 6546 6f72 5b73 796d  .evaluateFor[sym
+000991a0: 626f 6c5f 6e61 6d65 5d20 3d20 7265 616c  bol_name] = real
+000991b0: 5f6c 6973 740a 0a20 2020 2020 2020 2069  _list..        i
+000991c0: 6620 6374 782e 5369 6d70 6c65 5f6e 616d  f ctx.Simple_nam
+000991d0: 655f 4346 2830 293a 0a20 2020 2020 2020  e_CF(0):.       
+000991e0: 2020 2020 2073 7472 5f6c 6973 7420 3d20       str_list = 
+000991f0: 5b5d 0a20 2020 2020 2020 2020 2020 2069  [].            i
+00099200: 6478 203d 2030 0a20 2020 2020 2020 2020  dx = 0.         
+00099210: 2020 2077 6869 6c65 2054 7275 653a 0a20     while True:. 
+00099220: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00099230: 6620 6374 782e 5369 6d70 6c65 5f6e 616d  f ctx.Simple_nam
+00099240: 655f 4346 2869 6478 293a 0a20 2020 2020  e_CF(idx):.     
+00099250: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00099260: 7472 5f6c 6973 742e 6170 7065 6e64 2873  tr_list.append(s
+00099270: 7472 2863 7478 2e53 696d 706c 655f 6e61  tr(ctx.Simple_na
+00099280: 6d65 5f43 4628 6964 7829 2929 0a20 2020  me_CF(idx))).   
+00099290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000992a0: 2069 6478 202b 3d20 310a 2020 2020 2020   idx += 1.      
+000992b0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+000992c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000992d0: 2020 2020 6272 6561 6b0a 2020 2020 2020      break.      
+000992e0: 2020 2020 2020 6966 2073 796d 626f 6c5f        if symbol_
+000992f0: 6e61 6d65 2069 7320 6e6f 7420 4e6f 6e65  name is not None
+00099300: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00099310: 2020 7365 6c66 2e65 7661 6c75 6174 6546    self.evaluateF
+00099320: 6f72 5b73 796d 626f 6c5f 6e61 6d65 5d20  or[symbol_name] 
+00099330: 3d20 7374 725f 6c69 7374 0a0a 2020 2020  = str_list..    
+00099340: 2320 4578 6974 2061 2070 6172 7365 2074  # Exit a parse t
+00099350: 7265 6520 7072 6f64 7563 6564 2062 7920  ree produced by 
+00099360: 5870 6c6f 724d 5250 6172 7365 7223 6373  XplorMRParser#cs
+00099370: 615f 6173 7369 676e 5f6c 6f6f 702e 0a20  a_assign_loop.. 
+00099380: 2020 2064 6566 2065 7869 7443 7361 5f61     def exitCsa_a
+00099390: 7373 6967 6e5f 6c6f 6f70 2873 656c 662c  ssign_loop(self,
+000993a0: 2063 7478 3a20 5870 6c6f 724d 5250 6172   ctx: XplorMRPar
+000993b0: 7365 722e 4373 615f 6173 7369 676e 5f6c  ser.Csa_assign_l
+000993c0: 6f6f 7043 6f6e 7465 7874 293a 0a20 2020  oopContext):.   
+000993d0: 2020 2020 2069 6620 6374 782e 5379 6d62       if ctx.Symb
+000993e0: 6f6c 5f6e 616d 655f 4346 2829 3a0a 2020  ol_name_CF():.  
+000993f0: 2020 2020 2020 2020 2020 7379 6d62 6f6c            symbol
+00099400: 5f6e 616d 6520 3d20 7374 7228 6374 782e  _name = str(ctx.
+00099410: 5379 6d62 6f6c 5f6e 616d 655f 4346 2829  Symbol_name_CF()
+00099420: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+00099430: 2073 796d 626f 6c5f 6e61 6d65 2069 6e20   symbol_name in 
+00099440: 7365 6c66 2e65 7661 6c75 6174 6546 6f72  self.evaluateFor
+00099450: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00099460: 2020 6465 6c20 7365 6c66 2e65 7661 6c75    del self.evalu
+00099470: 6174 6546 6f72 5b73 796d 626f 6c5f 6e61  ateFor[symbol_na
+00099480: 6d65 5d0a 0a20 2020 2023 2045 6e74 6572  me]..    # Enter
+00099490: 2061 2070 6172 7365 2074 7265 6520 7072   a parse tree pr
+000994a0: 6f64 7563 6564 2062 7920 5870 6c6f 724d  oduced by XplorM
+000994b0: 5250 6172 7365 7223 7072 655f 6173 7369  RParser#pre_assi
+000994c0: 676e 5f6c 6f6f 702e 0a20 2020 2064 6566  gn_loop..    def
+000994d0: 2065 6e74 6572 5072 655f 6173 7369 676e   enterPre_assign
+000994e0: 5f6c 6f6f 7028 7365 6c66 2c20 6374 783a  _loop(self, ctx:
+000994f0: 2058 706c 6f72 4d52 5061 7273 6572 2e50   XplorMRParser.P
+00099500: 7265 5f61 7373 6967 6e5f 6c6f 6f70 436f  re_assign_loopCo
+00099510: 6e74 6578 7429 3a0a 2020 2020 2020 2020  ntext):.        
+00099520: 7379 6d62 6f6c 5f6e 616d 6520 3d20 4e6f  symbol_name = No
+00099530: 6e65 0a20 2020 2020 2020 2069 6620 6374  ne.        if ct
+00099540: 782e 5379 6d62 6f6c 5f6e 616d 655f 4346  x.Symbol_name_CF
+00099550: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+00099560: 7379 6d62 6f6c 5f6e 616d 6520 3d20 7374  symbol_name = st
+00099570: 7228 6374 782e 5379 6d62 6f6c 5f6e 616d  r(ctx.Symbol_nam
+00099580: 655f 4346 2829 290a 0a20 2020 2020 2020  e_CF())..       
+00099590: 2069 6620 6374 782e 496e 7465 6765 725f   if ctx.Integer_
+000995a0: 4346 2830 293a 0a20 2020 2020 2020 2020  CF(0):.         
+000995b0: 2020 2069 6e74 5f6c 6973 7420 3d20 5b5d     int_list = []
+000995c0: 0a20 2020 2020 2020 2020 2020 2069 6478  .            idx
+000995d0: 203d 2030 0a20 2020 2020 2020 2020 2020   = 0.           
+000995e0: 2077 6869 6c65 2054 7275 653a 0a20 2020   while True:.   
+000995f0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00099600: 6374 782e 496e 7465 6765 725f 4346 2869  ctx.Integer_CF(i
+00099610: 6478 293a 0a20 2020 2020 2020 2020 2020  dx):.           
+00099620: 2020 2020 2020 2020 2069 6e74 5f6c 6973           int_lis
+00099630: 742e 6170 7065 6e64 2869 6e74 2873 7472  t.append(int(str
+00099640: 2863 7478 2e49 6e74 6567 6572 5f43 4628  (ctx.Integer_CF(
+00099650: 6964 7829 2929 290a 2020 2020 2020 2020  idx)))).        
+00099660: 2020 2020 2020 2020 2020 2020 6964 7820              idx 
+00099670: 2b3d 2031 0a20 2020 2020 2020 2020 2020  += 1.           
+00099680: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00099690: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+000996a0: 7265 616b 0a20 2020 2020 2020 2020 2020  reak.           
+000996b0: 2069 6620 7379 6d62 6f6c 5f6e 616d 6520   if symbol_name 
+000996c0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+000996d0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000996e0: 662e 6576 616c 7561 7465 466f 725b 7379  f.evaluateFor[sy
+000996f0: 6d62 6f6c 5f6e 616d 655d 203d 2069 6e74  mbol_name] = int
+00099700: 5f6c 6973 740a 0a20 2020 2020 2020 2069  _list..        i
+00099710: 6620 6374 782e 5265 616c 5f43 4628 3029  f ctx.Real_CF(0)
+00099720: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00099730: 616c 5f6c 6973 7420 3d20 5b5d 0a20 2020  al_list = [].   
+00099740: 2020 2020 2020 2020 2069 6478 203d 2030           idx = 0
+00099750: 0a20 2020 2020 2020 2020 2020 2077 6869  .            whi
+00099760: 6c65 2054 7275 653a 0a20 2020 2020 2020  le True:.       
+00099770: 2020 2020 2020 2020 2069 6620 6374 782e           if ctx.
+00099780: 5265 616c 5f43 4628 6964 7829 3a0a 2020  Real_CF(idx):.  
+00099790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000997a0: 2020 7265 616c 5f6c 6973 742e 6170 7065    real_list.appe
+000997b0: 6e64 2866 6c6f 6174 2873 7472 2863 7478  nd(float(str(ctx
+000997c0: 2e52 6561 6c5f 4346 2869 6478 2929 2929  .Real_CF(idx))))
+000997d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000997e0: 2020 2020 2069 6478 202b 3d20 310a 2020       idx += 1.  
+000997f0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00099800: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00099810: 2020 2020 2020 2020 6272 6561 6b0a 2020          break.  
+00099820: 2020 2020 2020 2020 2020 6966 2073 796d            if sym
+00099830: 626f 6c5f 6e61 6d65 5b30 5d20 6973 206e  bol_name[0] is n
+00099840: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+00099850: 2020 2020 2020 2020 2073 656c 662e 6576           self.ev
+00099860: 616c 7561 7465 466f 725b 7379 6d62 6f6c  aluateFor[symbol
+00099870: 5f6e 616d 655d 203d 2072 6561 6c5f 6c69  _name] = real_li
+00099880: 7374 0a0a 2020 2020 2020 2020 6966 2063  st..        if c
+00099890: 7478 2e53 696d 706c 655f 6e61 6d65 5f43  tx.Simple_name_C
+000998a0: 4628 3029 3a0a 2020 2020 2020 2020 2020  F(0):.          
+000998b0: 2020 7374 725f 6c69 7374 203d 205b 5d0a    str_list = [].
+000998c0: 2020 2020 2020 2020 2020 2020 6964 7820              idx 
+000998d0: 3d20 300a 2020 2020 2020 2020 2020 2020  = 0.            
+000998e0: 7768 696c 6520 5472 7565 3a0a 2020 2020  while True:.    
+000998f0: 2020 2020 2020 2020 2020 2020 6966 2063              if c
+00099900: 7478 2e53 696d 706c 655f 6e61 6d65 5f43  tx.Simple_name_C
+00099910: 4628 6964 7829 3a0a 2020 2020 2020 2020  F(idx):.        
+00099920: 2020 2020 2020 2020 2020 2020 7374 725f              str_
+00099930: 6c69 7374 2e61 7070 656e 6428 7374 7228  list.append(str(
+00099940: 6374 782e 5369 6d70 6c65 5f6e 616d 655f  ctx.Simple_name_
+00099950: 4346 2869 6478 2929 290a 2020 2020 2020  CF(idx))).      
+00099960: 2020 2020 2020 2020 2020 2020 2020 6964                id
+00099970: 7820 2b3d 2031 0a20 2020 2020 2020 2020  x += 1.         
+00099980: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00099990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000999a0: 2062 7265 616b 0a20 2020 2020 2020 2020   break.         
+000999b0: 2020 2069 6620 7379 6d62 6f6c 5f6e 616d     if symbol_nam
+000999c0: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
+000999d0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000999e0: 656c 662e 6576 616c 7561 7465 466f 725b  elf.evaluateFor[
+000999f0: 7379 6d62 6f6c 5f6e 616d 655d 203d 2073  symbol_name] = s
+00099a00: 7472 5f6c 6973 740a 0a20 2020 2023 2045  tr_list..    # E
+00099a10: 7869 7420 6120 7061 7273 6520 7472 6565  xit a parse tree
+00099a20: 2070 726f 6475 6365 6420 6279 2058 706c   produced by Xpl
+00099a30: 6f72 4d52 5061 7273 6572 2370 7265 5f61  orMRParser#pre_a
+00099a40: 7373 6967 6e5f 6c6f 6f70 2e0a 2020 2020  ssign_loop..    
+00099a50: 6465 6620 6578 6974 5072 655f 6173 7369  def exitPre_assi
+00099a60: 676e 5f6c 6f6f 7028 7365 6c66 2c20 6374  gn_loop(self, ct
+00099a70: 783a 2058 706c 6f72 4d52 5061 7273 6572  x: XplorMRParser
+00099a80: 2e50 7265 5f61 7373 6967 6e5f 6c6f 6f70  .Pre_assign_loop
+00099a90: 436f 6e74 6578 7429 3a0a 2020 2020 2020  Context):.      
+00099aa0: 2020 6966 2063 7478 2e53 796d 626f 6c5f    if ctx.Symbol_
+00099ab0: 6e61 6d65 5f43 4628 293a 0a20 2020 2020  name_CF():.     
+00099ac0: 2020 2020 2020 2073 796d 626f 6c5f 6e61         symbol_na
+00099ad0: 6d65 203d 2073 7472 2863 7478 2e53 796d  me = str(ctx.Sym
+00099ae0: 626f 6c5f 6e61 6d65 5f43 4628 2929 0a20  bol_name_CF()). 
+00099af0: 2020 2020 2020 2020 2020 2069 6620 7379             if sy
+00099b00: 6d62 6f6c 5f6e 616d 6520 696e 2073 656c  mbol_name in sel
+00099b10: 662e 6576 616c 7561 7465 466f 723a 0a20  f.evaluateFor:. 
+00099b20: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00099b30: 656c 2073 656c 662e 6576 616c 7561 7465  el self.evaluate
+00099b40: 466f 725b 7379 6d62 6f6c 5f6e 616d 655d  For[symbol_name]
+00099b50: 0a0a 2020 2020 2320 456e 7465 7220 6120  ..    # Enter a 
+00099b60: 7061 7273 6520 7472 6565 2070 726f 6475  parse tree produ
+00099b70: 6365 6420 6279 2058 706c 6f72 4d52 5061  ced by XplorMRPa
+00099b80: 7273 6572 2370 6373 5f61 7373 6967 6e5f  rser#pcs_assign_
+00099b90: 6c6f 6f70 2e0a 2020 2020 6465 6620 656e  loop..    def en
+00099ba0: 7465 7250 6373 5f61 7373 6967 6e5f 6c6f  terPcs_assign_lo
+00099bb0: 6f70 2873 656c 662c 2063 7478 3a20 5870  op(self, ctx: Xp
+00099bc0: 6c6f 724d 5250 6172 7365 722e 5063 735f  lorMRParser.Pcs_
+00099bd0: 6173 7369 676e 5f6c 6f6f 7043 6f6e 7465  assign_loopConte
+00099be0: 7874 293a 0a20 2020 2020 2020 2073 796d  xt):.        sym
+00099bf0: 626f 6c5f 6e61 6d65 203d 204e 6f6e 650a  bol_name = None.
+00099c00: 2020 2020 2020 2020 6966 2063 7478 2e53          if ctx.S
+00099c10: 796d 626f 6c5f 6e61 6d65 5f43 4628 293a  ymbol_name_CF():
+00099c20: 0a20 2020 2020 2020 2020 2020 2073 796d  .            sym
+00099c30: 626f 6c5f 6e61 6d65 203d 2073 7472 2863  bol_name = str(c
+00099c40: 7478 2e53 796d 626f 6c5f 6e61 6d65 5f43  tx.Symbol_name_C
+00099c50: 4628 2929 0a0a 2020 2020 2020 2020 6966  F())..        if
+00099c60: 2063 7478 2e49 6e74 6567 6572 5f43 4628   ctx.Integer_CF(
+00099c70: 3029 3a0a 2020 2020 2020 2020 2020 2020  0):.            
+00099c80: 696e 745f 6c69 7374 203d 205b 5d0a 2020  int_list = [].  
+00099c90: 2020 2020 2020 2020 2020 6964 7820 3d20            idx = 
+00099ca0: 300a 2020 2020 2020 2020 2020 2020 7768  0.            wh
+00099cb0: 696c 6520 5472 7565 3a0a 2020 2020 2020  ile True:.      
+00099cc0: 2020 2020 2020 2020 2020 6966 2063 7478            if ctx
+00099cd0: 2e49 6e74 6567 6572 5f43 4628 6964 7829  .Integer_CF(idx)
+00099ce0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00099cf0: 2020 2020 2020 696e 745f 6c69 7374 2e61        int_list.a
+00099d00: 7070 656e 6428 696e 7428 7374 7228 6374  ppend(int(str(ct
+00099d10: 782e 496e 7465 6765 725f 4346 2869 6478  x.Integer_CF(idx
+00099d20: 2929 2929 0a20 2020 2020 2020 2020 2020  )))).           
+00099d30: 2020 2020 2020 2020 2069 6478 202b 3d20           idx += 
+00099d40: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
+00099d50: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00099d60: 2020 2020 2020 2020 2020 2020 6272 6561              brea
+00099d70: 6b0a 2020 2020 2020 2020 2020 2020 6966  k.            if
+00099d80: 2073 796d 626f 6c5f 6e61 6d65 2069 7320   symbol_name is 
+00099d90: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00099da0: 2020 2020 2020 2020 2020 7365 6c66 2e65            self.e
+00099db0: 7661 6c75 6174 6546 6f72 5b73 796d 626f  valuateFor[symbo
+00099dc0: 6c5f 6e61 6d65 5d20 3d20 696e 745f 6c69  l_name] = int_li
+00099dd0: 7374 0a0a 2020 2020 2020 2020 6966 2063  st..        if c
+00099de0: 7478 2e52 6561 6c5f 4346 2830 293a 0a20  tx.Real_CF(0):. 
+00099df0: 2020 2020 2020 2020 2020 2072 6561 6c5f             real_
+00099e00: 6c69 7374 203d 205b 5d0a 2020 2020 2020  list = [].      
+00099e10: 2020 2020 2020 6964 7820 3d20 300a 2020        idx = 0.  
+00099e20: 2020 2020 2020 2020 2020 7768 696c 6520            while 
+00099e30: 5472 7565 3a0a 2020 2020 2020 2020 2020  True:.          
+00099e40: 2020 2020 2020 6966 2063 7478 2e52 6561        if ctx.Rea
+00099e50: 6c5f 4346 2869 6478 293a 0a20 2020 2020  l_CF(idx):.     
+00099e60: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00099e70: 6561 6c5f 6c69 7374 2e61 7070 656e 6428  eal_list.append(
+00099e80: 666c 6f61 7428 7374 7228 6374 782e 5265  float(str(ctx.Re
+00099e90: 616c 5f43 4628 6964 7829 2929 290a 2020  al_CF(idx)))).  
+00099ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00099eb0: 2020 6964 7820 2b3d 2031 0a20 2020 2020    idx += 1.     
+00099ec0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00099ed0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00099ee0: 2020 2020 2062 7265 616b 0a20 2020 2020       break.     
+00099ef0: 2020 2020 2020 2069 6620 7379 6d62 6f6c         if symbol
+00099f00: 5f6e 616d 655b 305d 2069 7320 6e6f 7420  _name[0] is not 
+00099f10: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00099f20: 2020 2020 2020 7365 6c66 2e65 7661 6c75        self.evalu
+00099f30: 6174 6546 6f72 5b73 796d 626f 6c5f 6e61  ateFor[symbol_na
+00099f40: 6d65 5d20 3d20 7265 616c 5f6c 6973 740a  me] = real_list.
+00099f50: 0a20 2020 2020 2020 2069 6620 6374 782e  .        if ctx.
+00099f60: 5369 6d70 6c65 5f6e 616d 655f 4346 2830  Simple_name_CF(0
+00099f70: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
+00099f80: 7472 5f6c 6973 7420 3d20 5b5d 0a20 2020  tr_list = [].   
+00099f90: 2020 2020 2020 2020 2069 6478 203d 2030           idx = 0
+00099fa0: 0a20 2020 2020 2020 2020 2020 2077 6869  .            whi
+00099fb0: 6c65 2054 7275 653a 0a20 2020 2020 2020  le True:.       
+00099fc0: 2020 2020 2020 2020 2069 6620 6374 782e           if ctx.
+00099fd0: 5369 6d70 6c65 5f6e 616d 655f 4346 2869  Simple_name_CF(i
+00099fe0: 6478 293a 0a20 2020 2020 2020 2020 2020  dx):.           
+00099ff0: 2020 2020 2020 2020 2073 7472 5f6c 6973           str_lis
+0009a000: 742e 6170 7065 6e64 2873 7472 2863 7478  t.append(str(ctx
+0009a010: 2e53 696d 706c 655f 6e61 6d65 5f43 4628  .Simple_name_CF(
+0009a020: 6964 7829 2929 0a20 2020 2020 2020 2020  idx))).         
+0009a030: 2020 2020 2020 2020 2020 2069 6478 202b             idx +
+0009a040: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
+0009a050: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0009a060: 2020 2020 2020 2020 2020 2020 2020 6272                br
+0009a070: 6561 6b0a 2020 2020 2020 2020 2020 2020  eak.            
+0009a080: 6966 2073 796d 626f 6c5f 6e61 6d65 2069  if symbol_name i
+0009a090: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+0009a0a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0009a0b0: 2e65 7661 6c75 6174 6546 6f72 5b73 796d  .evaluateFor[sym
+0009a0c0: 626f 6c5f 6e61 6d65 5d20 3d20 7374 725f  bol_name] = str_
+0009a0d0: 6c69 7374 0a0a 2020 2020 2320 4578 6974  list..    # Exit
+0009a0e0: 2061 2070 6172 7365 2074 7265 6520 7072   a parse tree pr
+0009a0f0: 6f64 7563 6564 2062 7920 5870 6c6f 724d  oduced by XplorM
+0009a100: 5250 6172 7365 7223 7063 735f 6173 7369  RParser#pcs_assi
+0009a110: 676e 5f6c 6f6f 702e 0a20 2020 2064 6566  gn_loop..    def
+0009a120: 2065 7869 7450 6373 5f61 7373 6967 6e5f   exitPcs_assign_
+0009a130: 6c6f 6f70 2873 656c 662c 2063 7478 3a20  loop(self, ctx: 
+0009a140: 5870 6c6f 724d 5250 6172 7365 722e 5063  XplorMRParser.Pc
+0009a150: 735f 6173 7369 676e 5f6c 6f6f 7043 6f6e  s_assign_loopCon
+0009a160: 7465 7874 293a 0a20 2020 2020 2020 2069  text):.        i
+0009a170: 6620 6374 782e 5379 6d62 6f6c 5f6e 616d  f ctx.Symbol_nam
+0009a180: 655f 4346 2829 3a0a 2020 2020 2020 2020  e_CF():.        
+0009a190: 2020 2020 7379 6d62 6f6c 5f6e 616d 6520      symbol_name 
+0009a1a0: 3d20 7374 7228 6374 782e 5379 6d62 6f6c  = str(ctx.Symbol
+0009a1b0: 5f6e 616d 655f 4346 2829 290a 2020 2020  _name_CF()).    
+0009a1c0: 2020 2020 2020 2020 6966 2073 796d 626f          if symbo
+0009a1d0: 6c5f 6e61 6d65 2069 6e20 7365 6c66 2e65  l_name in self.e
+0009a1e0: 7661 6c75 6174 6546 6f72 3a0a 2020 2020  valuateFor:.    
+0009a1f0: 2020 2020 2020 2020 2020 2020 6465 6c20              del 
+0009a200: 7365 6c66 2e65 7661 6c75 6174 6546 6f72  self.evaluateFor
+0009a210: 5b73 796d 626f 6c5f 6e61 6d65 5d0a 0a20  [symbol_name].. 
+0009a220: 2020 2023 2045 6e74 6572 2061 2070 6172     # Enter a par
+0009a230: 7365 2074 7265 6520 7072 6f64 7563 6564  se tree produced
+0009a240: 2062 7920 5870 6c6f 724d 5250 6172 7365   by XplorMRParse
+0009a250: 7223 6862 6f6e 645f 6173 7369 676e 5f6c  r#hbond_assign_l
+0009a260: 6f6f 702e 0a20 2020 2064 6566 2065 6e74  oop..    def ent
+0009a270: 6572 4862 6f6e 645f 6173 7369 676e 5f6c  erHbond_assign_l
+0009a280: 6f6f 7028 7365 6c66 2c20 6374 783a 2058  oop(self, ctx: X
+0009a290: 706c 6f72 4d52 5061 7273 6572 2e48 626f  plorMRParser.Hbo
+0009a2a0: 6e64 5f61 7373 6967 6e5f 6c6f 6f70 436f  nd_assign_loopCo
+0009a2b0: 6e74 6578 7429 3a0a 2020 2020 2020 2020  ntext):.        
+0009a2c0: 7379 6d62 6f6c 5f6e 616d 6520 3d20 4e6f  symbol_name = No
+0009a2d0: 6e65 0a20 2020 2020 2020 2069 6620 6374  ne.        if ct
+0009a2e0: 782e 5379 6d62 6f6c 5f6e 616d 655f 4346  x.Symbol_name_CF
+0009a2f0: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+0009a300: 7379 6d62 6f6c 5f6e 616d 6520 3d20 7374  symbol_name = st
+0009a310: 7228 6374 782e 5379 6d62 6f6c 5f6e 616d  r(ctx.Symbol_nam
+0009a320: 655f 4346 2829 290a 0a20 2020 2020 2020  e_CF())..       
+0009a330: 2069 6620 6374 782e 496e 7465 6765 725f   if ctx.Integer_
+0009a340: 4346 2830 293a 0a20 2020 2020 2020 2020  CF(0):.         
+0009a350: 2020 2069 6e74 5f6c 6973 7420 3d20 5b5d     int_list = []
+0009a360: 0a20 2020 2020 2020 2020 2020 2069 6478  .            idx
+0009a370: 203d 2030 0a20 2020 2020 2020 2020 2020   = 0.           
+0009a380: 2077 6869 6c65 2054 7275 653a 0a20 2020   while True:.   
+0009a390: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0009a3a0: 6374 782e 496e 7465 6765 725f 4346 2869  ctx.Integer_CF(i
+0009a3b0: 6478 293a 0a20 2020 2020 2020 2020 2020  dx):.           
+0009a3c0: 2020 2020 2020 2020 2069 6e74 5f6c 6973           int_lis
+0009a3d0: 742e 6170 7065 6e64 2869 6e74 2873 7472  t.append(int(str
+0009a3e0: 2863 7478 2e49 6e74 6567 6572 5f43 4628  (ctx.Integer_CF(
+0009a3f0: 6964 7829 2929 290a 2020 2020 2020 2020  idx)))).        
+0009a400: 2020 2020 2020 2020 2020 2020 6964 7820              idx 
+0009a410: 2b3d 2031 0a20 2020 2020 2020 2020 2020  += 1.           
+0009a420: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0009a430: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+0009a440: 7265 616b 0a20 2020 2020 2020 2020 2020  reak.           
+0009a450: 2069 6620 7379 6d62 6f6c 5f6e 616d 6520   if symbol_name 
+0009a460: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0009a470: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0009a480: 662e 6576 616c 7561 7465 466f 725b 7379  f.evaluateFor[sy
+0009a490: 6d62 6f6c 5f6e 616d 655d 203d 2069 6e74  mbol_name] = int
+0009a4a0: 5f6c 6973 740a 0a20 2020 2020 2020 2069  _list..        i
+0009a4b0: 6620 6374 782e 5265 616c 5f43 4628 3029  f ctx.Real_CF(0)
+0009a4c0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0009a4d0: 616c 5f6c 6973 7420 3d20 5b5d 0a20 2020  al_list = [].   
+0009a4e0: 2020 2020 2020 2020 2069 6478 203d 2030           idx = 0
+0009a4f0: 0a20 2020 2020 2020 2020 2020 2077 6869  .            whi
+0009a500: 6c65 2054 7275 653a 0a20 2020 2020 2020  le True:.       
+0009a510: 2020 2020 2020 2020 2069 6620 6374 782e           if ctx.
+0009a520: 5265 616c 5f43 4628 6964 7829 3a0a 2020  Real_CF(idx):.  
+0009a530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009a540: 2020 7265 616c 5f6c 6973 742e 6170 7065    real_list.appe
+0009a550: 6e64 2866 6c6f 6174 2873 7472 2863 7478  nd(float(str(ctx
+0009a560: 2e52 6561 6c5f 4346 2869 6478 2929 2929  .Real_CF(idx))))
+0009a570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0009a580: 2020 2020 2069 6478 202b 3d20 310a 2020       idx += 1.  
+0009a590: 2020 2020 2020 2020 2020 2020 2020 656c                el
+0009a5a0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0009a5b0: 2020 2020 2020 2020 6272 6561 6b0a 2020          break.  
+0009a5c0: 2020 2020 2020 2020 2020 6966 2073 796d            if sym
+0009a5d0: 626f 6c5f 6e61 6d65 5b30 5d20 6973 206e  bol_name[0] is n
+0009a5e0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+0009a5f0: 2020 2020 2020 2020 2073 656c 662e 6576           self.ev
+0009a600: 616c 7561 7465 466f 725b 7379 6d62 6f6c  aluateFor[symbol
+0009a610: 5f6e 616d 655d 203d 2072 6561 6c5f 6c69  _name] = real_li
+0009a620: 7374 0a0a 2020 2020 2020 2020 6966 2063  st..        if c
+0009a630: 7478 2e53 696d 706c 655f 6e61 6d65 5f43  tx.Simple_name_C
+0009a640: 4628 3029 3a0a 2020 2020 2020 2020 2020  F(0):.          
+0009a650: 2020 7374 725f 6c69 7374 203d 205b 5d0a    str_list = [].
+0009a660: 2020 2020 2020 2020 2020 2020 6964 7820              idx 
+0009a670: 3d20 300a 2020 2020 2020 2020 2020 2020  = 0.            
+0009a680: 7768 696c 6520 5472 7565 3a0a 2020 2020  while True:.    
+0009a690: 2020 2020 2020 2020 2020 2020 6966 2063              if c
+0009a6a0: 7478 2e53 696d 706c 655f 6e61 6d65 5f43  tx.Simple_name_C
+0009a6b0: 4628 6964 7829 3a0a 2020 2020 2020 2020  F(idx):.        
+0009a6c0: 2020 2020 2020 2020 2020 2020 7374 725f              str_
+0009a6d0: 6c69 7374 2e61 7070 656e 6428 7374 7228  list.append(str(
+0009a6e0: 6374 782e 5369 6d70 6c65 5f6e 616d 655f  ctx.Simple_name_
+0009a6f0: 4346 2869 6478 2929 290a 2020 2020 2020  CF(idx))).      
+0009a700: 2020 2020 2020 2020 2020 2020 2020 6964                id
+0009a710: 7820 2b3d 2031 0a20 2020 2020 2020 2020  x += 1.         
+0009a720: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0009a730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009a740: 2062 7265 616b 0a20 2020 2020 2020 2020   break.         
+0009a750: 2020 2069 6620 7379 6d62 6f6c 5f6e 616d     if symbol_nam
+0009a760: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
+0009a770: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0009a780: 656c 662e 6576 616c 7561 7465 466f 725b  elf.evaluateFor[
+0009a790: 7379 6d62 6f6c 5f6e 616d 655d 203d 2073  symbol_name] = s
+0009a7a0: 7472 5f6c 6973 740a 0a20 2020 2023 2045  tr_list..    # E
+0009a7b0: 7869 7420 6120 7061 7273 6520 7472 6565  xit a parse tree
+0009a7c0: 2070 726f 6475 6365 6420 6279 2058 706c   produced by Xpl
+0009a7d0: 6f72 4d52 5061 7273 6572 2368 626f 6e64  orMRParser#hbond
+0009a7e0: 5f61 7373 6967 6e5f 6c6f 6f70 2e0a 2020  _assign_loop..  
+0009a7f0: 2020 6465 6620 6578 6974 4862 6f6e 645f    def exitHbond_
+0009a800: 6173 7369 676e 5f6c 6f6f 7028 7365 6c66  assign_loop(self
+0009a810: 2c20 6374 783a 2058 706c 6f72 4d52 5061  , ctx: XplorMRPa
+0009a820: 7273 6572 2e48 626f 6e64 5f61 7373 6967  rser.Hbond_assig
+0009a830: 6e5f 6c6f 6f70 436f 6e74 6578 7429 3a0a  n_loopContext):.
+0009a840: 2020 2020 2020 2020 6966 2063 7478 2e53          if ctx.S
+0009a850: 796d 626f 6c5f 6e61 6d65 5f43 4628 293a  ymbol_name_CF():
+0009a860: 0a20 2020 2020 2020 2020 2020 2073 796d  .            sym
+0009a870: 626f 6c5f 6e61 6d65 203d 2073 7472 2863  bol_name = str(c
+0009a880: 7478 2e53 796d 626f 6c5f 6e61 6d65 5f43  tx.Symbol_name_C
+0009a890: 4628 2929 0a20 2020 2020 2020 2020 2020  F()).           
+0009a8a0: 2069 6620 7379 6d62 6f6c 5f6e 616d 6520   if symbol_name 
+0009a8b0: 696e 2073 656c 662e 6576 616c 7561 7465  in self.evaluate
+0009a8c0: 466f 723a 0a20 2020 2020 2020 2020 2020  For:.           
+0009a8d0: 2020 2020 2064 656c 2073 656c 662e 6576       del self.ev
+0009a8e0: 616c 7561 7465 466f 725b 7379 6d62 6f6c  aluateFor[symbol
+0009a8f0: 5f6e 616d 655d 0a0a 2020 2020 2320 456e  _name]..    # En
+0009a900: 7465 7220 6120 7061 7273 6520 7472 6565  ter a parse tree
+0009a910: 2070 726f 6475 6365 6420 6279 2058 706c   produced by Xpl
+0009a920: 6f72 4d52 5061 7273 6572 2368 626f 6e64  orMRParser#hbond
+0009a930: 5f64 625f 6173 7369 676e 5f6c 6f6f 702e  _db_assign_loop.
+0009a940: 0a20 2020 2064 6566 2065 6e74 6572 4862  .    def enterHb
+0009a950: 6f6e 645f 6462 5f61 7373 6967 6e5f 6c6f  ond_db_assign_lo
+0009a960: 6f70 2873 656c 662c 2063 7478 3a20 5870  op(self, ctx: Xp
+0009a970: 6c6f 724d 5250 6172 7365 722e 4862 6f6e  lorMRParser.Hbon
+0009a980: 645f 6462 5f61 7373 6967 6e5f 6c6f 6f70  d_db_assign_loop
+0009a990: 436f 6e74 6578 7429 3a0a 2020 2020 2020  Context):.      
+0009a9a0: 2020 7379 6d62 6f6c 5f6e 616d 6520 3d20    symbol_name = 
+0009a9b0: 4e6f 6e65 0a20 2020 2020 2020 2069 6620  None.        if 
+0009a9c0: 6374 782e 5379 6d62 6f6c 5f6e 616d 655f  ctx.Symbol_name_
+0009a9d0: 4346 2829 3a0a 2020 2020 2020 2020 2020  CF():.          
+0009a9e0: 2020 7379 6d62 6f6c 5f6e 616d 6520 3d20    symbol_name = 
+0009a9f0: 7374 7228 6374 782e 5379 6d62 6f6c 5f6e  str(ctx.Symbol_n
+0009aa00: 616d 655f 4346 2829 290a 0a20 2020 2020  ame_CF())..     
+0009aa10: 2020 2069 6620 6374 782e 496e 7465 6765     if ctx.Intege
+0009aa20: 725f 4346 2830 293a 0a20 2020 2020 2020  r_CF(0):.       
+0009aa30: 2020 2020 2069 6e74 5f6c 6973 7420 3d20       int_list = 
+0009aa40: 5b5d 0a20 2020 2020 2020 2020 2020 2069  [].            i
+0009aa50: 6478 203d 2030 0a20 2020 2020 2020 2020  dx = 0.         
+0009aa60: 2020 2077 6869 6c65 2054 7275 653a 0a20     while True:. 
+0009aa70: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0009aa80: 6620 6374 782e 496e 7465 6765 725f 4346  f ctx.Integer_CF
+0009aa90: 2869 6478 293a 0a20 2020 2020 2020 2020  (idx):.         
+0009aaa0: 2020 2020 2020 2020 2020 2069 6e74 5f6c             int_l
+0009aab0: 6973 742e 6170 7065 6e64 2869 6e74 2873  ist.append(int(s
+0009aac0: 7472 2863 7478 2e49 6e74 6567 6572 5f43  tr(ctx.Integer_C
+0009aad0: 4628 6964 7829 2929 290a 2020 2020 2020  F(idx)))).      
+0009aae0: 2020 2020 2020 2020 2020 2020 2020 6964                id
+0009aaf0: 7820 2b3d 2031 0a20 2020 2020 2020 2020  x += 1.         
+0009ab00: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0009ab10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009ab20: 2062 7265 616b 0a20 2020 2020 2020 2020   break.         
+0009ab30: 2020 2069 6620 7379 6d62 6f6c 5f6e 616d     if symbol_nam
+0009ab40: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
+0009ab50: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0009ab60: 656c 662e 6576 616c 7561 7465 466f 725b  elf.evaluateFor[
+0009ab70: 7379 6d62 6f6c 5f6e 616d 655d 203d 2069  symbol_name] = i
+0009ab80: 6e74 5f6c 6973 740a 0a20 2020 2020 2020  nt_list..       
+0009ab90: 2069 6620 6374 782e 5265 616c 5f43 4628   if ctx.Real_CF(
+0009aba0: 3029 3a0a 2020 2020 2020 2020 2020 2020  0):.            
+0009abb0: 7265 616c 5f6c 6973 7420 3d20 5b5d 0a20  real_list = []. 
+0009abc0: 2020 2020 2020 2020 2020 2069 6478 203d             idx =
+0009abd0: 2030 0a20 2020 2020 2020 2020 2020 2077   0.            w
+0009abe0: 6869 6c65 2054 7275 653a 0a20 2020 2020  hile True:.     
+0009abf0: 2020 2020 2020 2020 2020 2069 6620 6374             if ct
+0009ac00: 782e 5265 616c 5f43 4628 6964 7829 3a0a  x.Real_CF(idx):.
+0009ac10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009ac20: 2020 2020 7265 616c 5f6c 6973 742e 6170      real_list.ap
+0009ac30: 7065 6e64 2866 6c6f 6174 2873 7472 2863  pend(float(str(c
+0009ac40: 7478 2e52 6561 6c5f 4346 2869 6478 2929  tx.Real_CF(idx))
+0009ac50: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+0009ac60: 2020 2020 2020 2069 6478 202b 3d20 310a         idx += 1.
+0009ac70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009ac80: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0009ac90: 2020 2020 2020 2020 2020 6272 6561 6b0a            break.
+0009aca0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0009acb0: 796d 626f 6c5f 6e61 6d65 5b30 5d20 6973  ymbol_name[0] is
+0009acc0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+0009acd0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0009ace0: 6576 616c 7561 7465 466f 725b 7379 6d62  evaluateFor[symb
+0009acf0: 6f6c 5f6e 616d 655d 203d 2072 6561 6c5f  ol_name] = real_
+0009ad00: 6c69 7374 0a0a 2020 2020 2020 2020 6966  list..        if
+0009ad10: 2063 7478 2e53 696d 706c 655f 6e61 6d65   ctx.Simple_name
+0009ad20: 5f43 4628 3029 3a0a 2020 2020 2020 2020  _CF(0):.        
+0009ad30: 2020 2020 7374 725f 6c69 7374 203d 205b      str_list = [
+0009ad40: 5d0a 2020 2020 2020 2020 2020 2020 6964  ].            id
+0009ad50: 7820 3d20 300a 2020 2020 2020 2020 2020  x = 0.          
+0009ad60: 2020 7768 696c 6520 5472 7565 3a0a 2020    while True:.  
+0009ad70: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0009ad80: 2063 7478 2e53 696d 706c 655f 6e61 6d65   ctx.Simple_name
+0009ad90: 5f43 4628 6964 7829 3a0a 2020 2020 2020  _CF(idx):.      
+0009ada0: 2020 2020 2020 2020 2020 2020 2020 7374                st
+0009adb0: 725f 6c69 7374 2e61 7070 656e 6428 7374  r_list.append(st
+0009adc0: 7228 6374 782e 5369 6d70 6c65 5f6e 616d  r(ctx.Simple_nam
+0009add0: 655f 4346 2869 6478 2929 290a 2020 2020  e_CF(idx))).    
+0009ade0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009adf0: 6964 7820 2b3d 2031 0a20 2020 2020 2020  idx += 1.       
+0009ae00: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0009ae10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009ae20: 2020 2062 7265 616b 0a20 2020 2020 2020     break.       
+0009ae30: 2020 2020 2069 6620 7379 6d62 6f6c 5f6e       if symbol_n
+0009ae40: 616d 6520 6973 206e 6f74 204e 6f6e 653a  ame is not None:
+0009ae50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0009ae60: 2073 656c 662e 6576 616c 7561 7465 466f   self.evaluateFo
+0009ae70: 725b 7379 6d62 6f6c 5f6e 616d 655d 203d  r[symbol_name] =
+0009ae80: 2073 7472 5f6c 6973 740a 0a20 2020 2023   str_list..    #
+0009ae90: 2045 7869 7420 6120 7061 7273 6520 7472   Exit a parse tr
+0009aea0: 6565 2070 726f 6475 6365 6420 6279 2058  ee produced by X
+0009aeb0: 706c 6f72 4d52 5061 7273 6572 2368 626f  plorMRParser#hbo
+0009aec0: 6e64 5f64 625f 6173 7369 676e 5f6c 6f6f  nd_db_assign_loo
+0009aed0: 702e 0a20 2020 2064 6566 2065 7869 7448  p..    def exitH
+0009aee0: 626f 6e64 5f64 625f 6173 7369 676e 5f6c  bond_db_assign_l
+0009aef0: 6f6f 7028 7365 6c66 2c20 6374 783a 2058  oop(self, ctx: X
+0009af00: 706c 6f72 4d52 5061 7273 6572 2e48 626f  plorMRParser.Hbo
+0009af10: 6e64 5f64 625f 6173 7369 676e 5f6c 6f6f  nd_db_assign_loo
+0009af20: 7043 6f6e 7465 7874 293a 0a20 2020 2020  pContext):.     
+0009af30: 2020 2069 6620 6374 782e 5379 6d62 6f6c     if ctx.Symbol
+0009af40: 5f6e 616d 655f 4346 2829 3a0a 2020 2020  _name_CF():.    
+0009af50: 2020 2020 2020 2020 7379 6d62 6f6c 5f6e          symbol_n
+0009af60: 616d 6520 3d20 7374 7228 6374 782e 5379  ame = str(ctx.Sy
+0009af70: 6d62 6f6c 5f6e 616d 655f 4346 2829 290a  mbol_name_CF()).
+0009af80: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0009af90: 796d 626f 6c5f 6e61 6d65 2069 6e20 7365  ymbol_name in se
+0009afa0: 6c66 2e65 7661 6c75 6174 6546 6f72 3a0a  lf.evaluateFor:.
+0009afb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009afc0: 6465 6c20 7365 6c66 2e65 7661 6c75 6174  del self.evaluat
+0009afd0: 6546 6f72 5b73 796d 626f 6c5f 6e61 6d65  eFor[symbol_name
+0009afe0: 5d0a 0a20 2020 2023 2045 6e74 6572 2061  ]..    # Enter a
+0009aff0: 2070 6172 7365 2074 7265 6520 7072 6f64   parse tree prod
+0009b000: 7563 6564 2062 7920 5870 6c6f 724d 5250  uced by XplorMRP
+0009b010: 6172 7365 7223 706c 616e 6172 5f67 726f  arser#planar_gro
+0009b020: 7570 5f6c 6f6f 702e 0a20 2020 2064 6566  up_loop..    def
+0009b030: 2065 6e74 6572 506c 616e 6172 5f67 726f   enterPlanar_gro
+0009b040: 7570 5f6c 6f6f 7028 7365 6c66 2c20 6374  up_loop(self, ct
+0009b050: 783a 2058 706c 6f72 4d52 5061 7273 6572  x: XplorMRParser
+0009b060: 2e50 6c61 6e61 725f 6772 6f75 705f 6c6f  .Planar_group_lo
+0009b070: 6f70 436f 6e74 6578 7429 3a0a 2020 2020  opContext):.    
+0009b080: 2020 2020 7379 6d62 6f6c 5f6e 616d 6520      symbol_name 
+0009b090: 3d20 4e6f 6e65 0a20 2020 2020 2020 2069  = None.        i
+0009b0a0: 6620 6374 782e 5379 6d62 6f6c 5f6e 616d  f ctx.Symbol_nam
+0009b0b0: 655f 4346 2829 3a0a 2020 2020 2020 2020  e_CF():.        
+0009b0c0: 2020 2020 7379 6d62 6f6c 5f6e 616d 6520      symbol_name 
+0009b0d0: 3d20 7374 7228 6374 782e 5379 6d62 6f6c  = str(ctx.Symbol
+0009b0e0: 5f6e 616d 655f 4346 2829 290a 0a20 2020  _name_CF())..   
+0009b0f0: 2020 2020 2069 6620 6374 782e 496e 7465       if ctx.Inte
+0009b100: 6765 725f 4346 2830 293a 0a20 2020 2020  ger_CF(0):.     
+0009b110: 2020 2020 2020 2069 6e74 5f6c 6973 7420         int_list 
+0009b120: 3d20 5b5d 0a20 2020 2020 2020 2020 2020  = [].           
+0009b130: 2069 6478 203d 2030 0a20 2020 2020 2020   idx = 0.       
+0009b140: 2020 2020 2077 6869 6c65 2054 7275 653a       while True:
+0009b150: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0009b160: 2069 6620 6374 782e 496e 7465 6765 725f   if ctx.Integer_
+0009b170: 4346 2869 6478 293a 0a20 2020 2020 2020  CF(idx):.       
+0009b180: 2020 2020 2020 2020 2020 2020 2069 6e74               int
+0009b190: 5f6c 6973 742e 6170 7065 6e64 2869 6e74  _list.append(int
+0009b1a0: 2873 7472 2863 7478 2e49 6e74 6567 6572  (str(ctx.Integer
+0009b1b0: 5f43 4628 6964 7829 2929 290a 2020 2020  _CF(idx)))).    
+0009b1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009b1d0: 6964 7820 2b3d 2031 0a20 2020 2020 2020  idx += 1.       
+0009b1e0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0009b1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009b200: 2020 2062 7265 616b 0a20 2020 2020 2020     break.       
+0009b210: 2020 2020 2069 6620 7379 6d62 6f6c 5f6e       if symbol_n
+0009b220: 616d 6520 6973 206e 6f74 204e 6f6e 653a  ame is not None:
+0009b230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0009b240: 2073 656c 662e 6576 616c 7561 7465 466f   self.evaluateFo
+0009b250: 725b 7379 6d62 6f6c 5f6e 616d 655d 203d  r[symbol_name] =
+0009b260: 2069 6e74 5f6c 6973 740a 0a20 2020 2020   int_list..     
+0009b270: 2020 2069 6620 6374 782e 5265 616c 5f43     if ctx.Real_C
+0009b280: 4628 3029 3a0a 2020 2020 2020 2020 2020  F(0):.          
+0009b290: 2020 7265 616c 5f6c 6973 7420 3d20 5b5d    real_list = []
+0009b2a0: 0a20 2020 2020 2020 2020 2020 2069 6478  .            idx
+0009b2b0: 203d 2030 0a20 2020 2020 2020 2020 2020   = 0.           
+0009b2c0: 2077 6869 6c65 2054 7275 653a 0a20 2020   while True:.   
+0009b2d0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0009b2e0: 6374 782e 5265 616c 5f43 4628 6964 7829  ctx.Real_CF(idx)
+0009b2f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0009b300: 2020 2020 2020 7265 616c 5f6c 6973 742e        real_list.
+0009b310: 6170 7065 6e64 2866 6c6f 6174 2873 7472  append(float(str
+0009b320: 2863 7478 2e52 6561 6c5f 4346 2869 6478  (ctx.Real_CF(idx
+0009b330: 2929 2929 0a20 2020 2020 2020 2020 2020  )))).           
+0009b340: 2020 2020 2020 2020 2069 6478 202b 3d20           idx += 
+0009b350: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
+0009b360: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0009b370: 2020 2020 2020 2020 2020 2020 6272 6561              brea
+0009b380: 6b0a 2020 2020 2020 2020 2020 2020 6966  k.            if
+0009b390: 2073 796d 626f 6c5f 6e61 6d65 5b30 5d20   symbol_name[0] 
+0009b3a0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0009b3b0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0009b3c0: 662e 6576 616c 7561 7465 466f 725b 7379  f.evaluateFor[sy
+0009b3d0: 6d62 6f6c 5f6e 616d 655d 203d 2072 6561  mbol_name] = rea
+0009b3e0: 6c5f 6c69 7374 0a0a 2020 2020 2020 2020  l_list..        
+0009b3f0: 6966 2063 7478 2e53 696d 706c 655f 6e61  if ctx.Simple_na
+0009b400: 6d65 5f43 4628 3029 3a0a 2020 2020 2020  me_CF(0):.      
+0009b410: 2020 2020 2020 7374 725f 6c69 7374 203d        str_list =
+0009b420: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
+0009b430: 6964 7820 3d20 300a 2020 2020 2020 2020  idx = 0.        
+0009b440: 2020 2020 7768 696c 6520 5472 7565 3a0a      while True:.
+0009b450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009b460: 6966 2063 7478 2e53 696d 706c 655f 6e61  if ctx.Simple_na
+0009b470: 6d65 5f43 4628 6964 7829 3a0a 2020 2020  me_CF(idx):.    
+0009b480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009b490: 7374 725f 6c69 7374 2e61 7070 656e 6428  str_list.append(
+0009b4a0: 7374 7228 6374 782e 5369 6d70 6c65 5f6e  str(ctx.Simple_n
+0009b4b0: 616d 655f 4346 2869 6478 2929 290a 2020  ame_CF(idx))).  
+0009b4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009b4d0: 2020 6964 7820 2b3d 2031 0a20 2020 2020    idx += 1.     
+0009b4e0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0009b4f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0009b500: 2020 2020 2062 7265 616b 0a20 2020 2020       break.     
+0009b510: 2020 2020 2020 2069 6620 7379 6d62 6f6c         if symbol
+0009b520: 5f6e 616d 6520 6973 206e 6f74 204e 6f6e  _name is not Non
+0009b530: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0009b540: 2020 2073 656c 662e 6576 616c 7561 7465     self.evaluate
+0009b550: 466f 725b 7379 6d62 6f6c 5f6e 616d 655d  For[symbol_name]
+0009b560: 203d 2073 7472 5f6c 6973 740a 0a20 2020   = str_list..   
+0009b570: 2023 2045 7869 7420 6120 7061 7273 6520   # Exit a parse 
+0009b580: 7472 6565 2070 726f 6475 6365 6420 6279  tree produced by
+0009b590: 2058 706c 6f72 4d52 5061 7273 6572 2370   XplorMRParser#p
+0009b5a0: 6c61 6e61 725f 6772 6f75 705f 6c6f 6f70  lanar_group_loop
+0009b5b0: 2e0a 2020 2020 6465 6620 6578 6974 506c  ..    def exitPl
+0009b5c0: 616e 6172 5f67 726f 7570 5f6c 6f6f 7028  anar_group_loop(
+0009b5d0: 7365 6c66 2c20 6374 783a 2058 706c 6f72  self, ctx: Xplor
+0009b5e0: 4d52 5061 7273 6572 2e50 6c61 6e61 725f  MRParser.Planar_
+0009b5f0: 6772 6f75 705f 6c6f 6f70 436f 6e74 6578  group_loopContex
+0009b600: 7429 3a0a 2020 2020 2020 2020 6966 2063  t):.        if c
+0009b610: 7478 2e53 796d 626f 6c5f 6e61 6d65 5f43  tx.Symbol_name_C
+0009b620: 4628 293a 0a20 2020 2020 2020 2020 2020  F():.           
+0009b630: 2073 796d 626f 6c5f 6e61 6d65 203d 2073   symbol_name = s
+0009b640: 7472 2863 7478 2e53 796d 626f 6c5f 6e61  tr(ctx.Symbol_na
+0009b650: 6d65 5f43 4628 2929 0a20 2020 2020 2020  me_CF()).       
+0009b660: 2020 2020 2069 6620 7379 6d62 6f6c 5f6e       if symbol_n
+0009b670: 616d 6520 696e 2073 656c 662e 6576 616c  ame in self.eval
+0009b680: 7561 7465 466f 723a 0a20 2020 2020 2020  uateFor:.       
+0009b690: 2020 2020 2020 2020 2064 656c 2073 656c           del sel
+0009b6a0: 662e 6576 616c 7561 7465 466f 725b 7379  f.evaluateFor[sy
+0009b6b0: 6d62 6f6c 5f6e 616d 655d 0a0a 2020 2020  mbol_name]..    
+0009b6c0: 6465 6620 5f5f 6765 7443 7572 7265 6e74  def __getCurrent
+0009b6d0: 5265 7374 7261 696e 7428 7365 6c66 293a  Restraint(self):
+0009b6e0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+0009b6f0: 2e5f 5f63 7572 5f73 7562 7479 7065 203d  .__cur_subtype =
+0009b700: 3d20 2764 6973 7427 3a0a 2020 2020 2020  = 'dist':.      
+0009b710: 2020 2020 2020 7265 7475 726e 2066 225b        return f"[
+0009b720: 4368 6563 6b20 7468 6520 7b73 656c 662e  Check the {self.
+0009b730: 6469 7374 5265 7374 7261 696e 7473 7d74  distRestraints}t
+0009b740: 6820 726f 7720 6f66 2064 6973 7461 6e63  h row of distanc
+0009b750: 6520 7265 7374 7261 696e 7473 5d20 220a  e restraints] ".
+0009b760: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0009b770: 5f5f 6375 725f 7375 6274 7970 6520 3d3d  __cur_subtype ==
+0009b780: 2027 6469 6865 6427 3a0a 2020 2020 2020   'dihed':.      
+0009b790: 2020 2020 2020 7265 7475 726e 2066 225b        return f"[
+0009b7a0: 4368 6563 6b20 7468 6520 7b73 656c 662e  Check the {self.
+0009b7b0: 6469 6865 6452 6573 7472 6169 6e74 737d  dihedRestraints}
+0009b7c0: 7468 2072 6f77 206f 6620 6469 6865 6472  th row of dihedr
+0009b7d0: 616c 2061 6e67 6c65 2072 6573 7472 6169  al angle restrai
+0009b7e0: 6e74 735d 2022 0a20 2020 2020 2020 2069  nts] ".        i
+0009b7f0: 6620 7365 6c66 2e5f 5f63 7572 5f73 7562  f self.__cur_sub
+0009b800: 7479 7065 203d 3d20 2772 6463 273a 0a20  type == 'rdc':. 
+0009b810: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0009b820: 6e20 6622 5b43 6865 636b 2074 6865 207b  n f"[Check the {
+0009b830: 7365 6c66 2e72 6463 5265 7374 7261 696e  self.rdcRestrain
+0009b840: 7473 7d74 6820 726f 7720 6f66 2072 6573  ts}th row of res
+0009b850: 6964 7561 6c20 6469 706f 6c61 7220 636f  idual dipolar co
+0009b860: 7570 6c69 6e67 2072 6573 7472 6169 6e74  upling restraint
+0009b870: 735d 2022 0a20 2020 2020 2020 2069 6620  s] ".        if 
+0009b880: 7365 6c66 2e5f 5f63 7572 5f73 7562 7479  self.__cur_subty
+0009b890: 7065 203d 3d20 2770 6c61 6e65 273a 0a20  pe == 'plane':. 
+0009b8a0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0009b8b0: 6e20 6622 5b43 6865 636b 2074 6865 207b  n f"[Check the {
+0009b8c0: 7365 6c66 2e70 6c61 6e65 5265 7374 7261  self.planeRestra
+0009b8d0: 696e 7473 7d74 6820 726f 7720 6f66 2070  ints}th row of p
+0009b8e0: 6c61 6e61 6c69 7479 2072 6573 7472 6169  lanality restrai
+0009b8f0: 6e74 735d 2022 0a20 2020 2020 2020 2069  nts] ".        i
+0009b900: 6620 7365 6c66 2e5f 5f63 7572 5f73 7562  f self.__cur_sub
+0009b910: 7479 7065 203d 3d20 2761 6469 7374 273a  type == 'adist':
+0009b920: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0009b930: 7572 6e20 6622 5b43 6865 636b 2074 6865  urn f"[Check the
+0009b940: 207b 7365 6c66 2e61 6469 7374 5265 7374   {self.adistRest
+0009b950: 7261 696e 7473 7d74 6820 726f 7720 6f66  raints}th row of
+0009b960: 2061 6e74 6964 6973 7461 6e63 6520 7265   antidistance re
+0009b970: 7374 7261 696e 7473 5d20 220a 2020 2020  straints] ".    
+0009b980: 2020 2020 6966 2073 656c 662e 5f5f 6375      if self.__cu
+0009b990: 725f 7375 6274 7970 6520 3d3d 2027 6a63  r_subtype == 'jc
+0009b9a0: 6f75 7027 3a0a 2020 2020 2020 2020 2020  oup':.          
+0009b9b0: 2020 7265 7475 726e 2066 225b 4368 6563    return f"[Chec
+0009b9c0: 6b20 7468 6520 7b73 656c 662e 6a63 6f75  k the {self.jcou
+0009b9d0: 7052 6573 7472 6169 6e74 737d 7468 2072  pRestraints}th r
+0009b9e0: 6f77 206f 6620 7363 616c 6172 204a 2d63  ow of scalar J-c
+0009b9f0: 6f75 706c 696e 6720 7265 7374 7261 696e  oupling restrain
+0009ba00: 7473 5d20 220a 2020 2020 2020 2020 6966  ts] ".        if
+0009ba10: 2073 656c 662e 5f5f 6375 725f 7375 6274   self.__cur_subt
+0009ba20: 7970 6520 3d3d 2027 6876 7963 7327 3a0a  ype == 'hvycs':.
+0009ba30: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0009ba40: 726e 2066 225b 4368 6563 6b20 7468 6520  rn f"[Check the 
+0009ba50: 7b73 656c 662e 6876 7963 7352 6573 7472  {self.hvycsRestr
+0009ba60: 6169 6e74 737d 7468 2072 6f77 206f 6620  aints}th row of 
+0009ba70: 6361 7262 6f6e 2063 6865 6d69 6361 6c20  carbon chemical 
+0009ba80: 7368 6966 7420 7265 7374 7261 696e 7473  shift restraints
+0009ba90: 5d20 220a 2020 2020 2020 2020 6966 2073  ] ".        if s
+0009baa0: 656c 662e 5f5f 6375 725f 7375 6274 7970  elf.__cur_subtyp
+0009bab0: 6520 3d3d 2027 7072 6f63 7327 3a0a 2020  e == 'procs':.  
+0009bac0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0009bad0: 2066 225b 4368 6563 6b20 7468 6520 7b73   f"[Check the {s
+0009bae0: 656c 662e 7072 6f63 7352 6573 7472 6169  elf.procsRestrai
+0009baf0: 6e74 737d 7468 2072 6f77 206f 6620 7072  nts}th row of pr
+0009bb00: 6f74 6f6e 2063 6865 6d69 6361 6c20 7368  oton chemical sh
+0009bb10: 6966 7420 7265 7374 7261 696e 7473 5d20  ift restraints] 
+0009bb20: 220a 2020 2020 2020 2020 6966 2073 656c  ".        if sel
+0009bb30: 662e 5f5f 6375 725f 7375 6274 7970 6520  f.__cur_subtype 
+0009bb40: 3d3d 2027 7261 6d61 273a 0a20 2020 2020  == 'rama':.     
+0009bb50: 2020 2020 2020 2072 6574 7572 6e20 6622         return f"
+0009bb60: 5b43 6865 636b 2074 6865 207b 7365 6c66  [Check the {self
+0009bb70: 2e72 616d 6152 6573 7472 6169 6e74 737d  .ramaRestraints}
+0009bb80: 7468 2072 6f77 206f 6620 6469 6865 6472  th row of dihedr
+0009bb90: 616c 2061 6e67 6c65 2064 6174 6162 6173  al angle databas
+0009bba0: 6520 7265 7374 7261 696e 7473 5d20 220a  e restraints] ".
+0009bbb0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0009bbc0: 5f5f 6375 725f 7375 6274 7970 6520 3d3d  __cur_subtype ==
+0009bbd0: 2027 7261 6469 273a 0a20 2020 2020 2020   'radi':.       
+0009bbe0: 2020 2020 2072 6574 7572 6e20 6622 5b43       return f"[C
+0009bbf0: 6865 636b 2074 6865 207b 7365 6c66 2e72  heck the {self.r
+0009bc00: 6164 6952 6573 7472 6169 6e74 737d 7468  adiRestraints}th
+0009bc10: 2072 6f77 206f 6620 7261 6469 7573 206f   row of radius o
+0009bc20: 6620 6779 7261 7469 6f6e 2072 6573 7472  f gyration restr
+0009bc30: 6169 6e74 735d 2022 0a20 2020 2020 2020  aints] ".       
+0009bc40: 2069 6620 7365 6c66 2e5f 5f63 7572 5f73   if self.__cur_s
+0009bc50: 7562 7479 7065 203d 3d20 2764 6966 6627  ubtype == 'diff'
+0009bc60: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0009bc70: 7475 726e 2066 225b 4368 6563 6b20 7468  turn f"[Check th
+0009bc80: 6520 7b73 656c 662e 6469 6666 5265 7374  e {self.diffRest
+0009bc90: 7261 696e 7473 7d74 6820 726f 7720 6f66  raints}th row of
+0009bca0: 2064 7566 6675 7369 6f6e 2061 6e69 736f   duffusion aniso
+0009bcb0: 7472 6f70 7920 7265 7374 7261 696e 7473  tropy restraints
+0009bcc0: 5d20 220a 2020 2020 2020 2020 6966 2073  ] ".        if s
+0009bcd0: 656c 662e 5f5f 6375 725f 7375 6274 7970  elf.__cur_subtyp
+0009bce0: 6520 3d3d 2027 6e62 6173 6527 3a0a 2020  e == 'nbase':.  
+0009bcf0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0009bd00: 2066 225b 4368 6563 6b20 7468 6520 7b73   f"[Check the {s
+0009bd10: 656c 662e 6e62 6173 6552 6573 7472 6169  elf.nbaseRestrai
+0009bd20: 6e74 737d 7468 2072 6f77 206f 6620 7265  nts}th row of re
+0009bd30: 7369 6475 652d 7265 7369 6475 6520 706f  sidue-residue po
+0009bd40: 7369 7469 6f6e 2f6f 7269 656e 7461 7469  sition/orientati
+0009bd50: 6f6e 2064 6174 6162 6173 6520 7265 7374  on database rest
+0009bd60: 7261 696e 7473 5d20 220a 2020 2020 2020  raints] ".      
+0009bd70: 2020 6966 2073 656c 662e 5f5f 6375 725f    if self.__cur_
+0009bd80: 7375 6274 7970 6520 3d3d 2027 6373 6127  subtype == 'csa'
+0009bd90: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0009bda0: 7475 726e 2066 225b 4368 6563 6b20 7468  turn f"[Check th
+0009bdb0: 6520 7b73 656c 662e 6373 6152 6573 7472  e {self.csaRestr
+0009bdc0: 6169 6e74 737d 7468 2072 6f77 206f 6620  aints}th row of 
+0009bdd0: 2870 7365 7564 6f29 2063 6865 6d69 6361  (pseudo) chemica
+0009bde0: 6c20 7368 6966 7420 616e 6973 6f74 726f  l shift anisotro
+0009bdf0: 7079 2072 6573 7472 6169 6e74 735d 2022  py restraints] "
+0009be00: 0a20 2020 2020 2020 2023 2069 6620 7365  .        # if se
+0009be10: 6c66 2e5f 5f63 7572 5f73 7562 7479 7065  lf.__cur_subtype
+0009be20: 203d 3d20 2761 6e67 273a 0a20 2020 2020   == 'ang':.     
+0009be30: 2020 2023 2020 2020 2072 6574 7572 6e20     #     return 
+0009be40: 6622 5b43 6865 636b 2074 6865 207b 7365  f"[Check the {se
+0009be50: 6c66 2e61 6e67 5265 7374 7261 696e 7473  lf.angRestraints
+0009be60: 7d74 6820 726f 7720 6f66 2061 6e67 6c65  }th row of angle
+0009be70: 2064 6174 6162 6173 6520 7265 7374 7261   database restra
+0009be80: 696e 7473 5d20 220a 2020 2020 2020 2020  ints] ".        
+0009be90: 6966 2073 656c 662e 5f5f 6375 725f 7375  if self.__cur_su
+0009bea0: 6274 7970 6520 3d3d 2027 7072 6527 3a0a  btype == 'pre':.
+0009beb0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0009bec0: 726e 2066 225b 4368 6563 6b20 7468 6520  rn f"[Check the 
+0009bed0: 7b73 656c 662e 7072 6552 6573 7472 6169  {self.preRestrai
+0009bee0: 6e74 737d 7468 2072 6f77 206f 6620 7061  nts}th row of pa
+0009bef0: 7261 6d61 676e 6574 6963 2072 656c 6178  ramagnetic relax
+0009bf00: 6174 696f 6e20 656e 6861 6e63 656d 656e  ation enhancemen
+0009bf10: 7420 7265 7374 7261 696e 7473 5d20 220a  t restraints] ".
+0009bf20: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0009bf30: 5f5f 6375 725f 7375 6274 7970 6520 3d3d  __cur_subtype ==
+0009bf40: 2027 7063 7327 3a0a 2020 2020 2020 2020   'pcs':.        
+0009bf50: 2020 2020 7265 7475 726e 2066 225b 4368      return f"[Ch
+0009bf60: 6563 6b20 7468 6520 7b73 656c 662e 7063  eck the {self.pc
+0009bf70: 7352 6573 7472 6169 6e74 737d 7468 2072  sRestraints}th r
+0009bf80: 6f77 206f 6620 7061 7261 6d61 676e 6574  ow of paramagnet
+0009bf90: 6963 2070 7365 7564 6f63 6f6e 7461 6374  ic pseudocontact
+0009bfa0: 2073 6869 6674 2072 6573 7472 6169 6e74   shift restraint
+0009bfb0: 735d 2022 0a20 2020 2020 2020 2069 6620  s] ".        if 
+0009bfc0: 7365 6c66 2e5f 5f63 7572 5f73 7562 7479  self.__cur_subty
+0009bfd0: 7065 203d 3d20 2770 7264 6327 3a0a 2020  pe == 'prdc':.  
+0009bfe0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0009bff0: 2066 225b 4368 6563 6b20 7468 6520 7b73   f"[Check the {s
+0009c000: 656c 662e 7072 6463 5265 7374 7261 696e  elf.prdcRestrain
+0009c010: 7473 7d74 6820 726f 7720 6f66 2070 6172  ts}th row of par
+0009c020: 616d 6167 6e65 7469 6320 7265 7369 6475  amagnetic residu
+0009c030: 616c 2064 6970 6f6c 6172 2063 6f75 706c  al dipolar coupl
+0009c040: 696e 6720 7265 7374 7261 696e 7473 5d20  ing restraints] 
+0009c050: 220a 2020 2020 2020 2020 6966 2073 656c  ".        if sel
+0009c060: 662e 5f5f 6375 725f 7375 6274 7970 6520  f.__cur_subtype 
+0009c070: 3d3d 2027 7061 6e67 273a 0a20 2020 2020  == 'pang':.     
+0009c080: 2020 2020 2020 2072 6574 7572 6e20 6622         return f"
+0009c090: 5b43 6865 636b 2074 6865 207b 7365 6c66  [Check the {self
+0009c0a0: 2e70 616e 6752 6573 7472 6169 6e74 737d  .pangRestraints}
+0009c0b0: 7468 2072 6f77 206f 6620 7061 7261 6d61  th row of parama
+0009c0c0: 676e 6574 6963 206f 7269 656e 7461 7469  gnetic orientati
+0009c0d0: 6f6e 2072 6573 7472 6169 6e74 735d 2022  on restraints] "
+0009c0e0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+0009c0f0: 2e5f 5f63 7572 5f73 7562 7479 7065 203d  .__cur_subtype =
+0009c100: 3d20 2770 6363 7227 3a0a 2020 2020 2020  = 'pccr':.      
+0009c110: 2020 2020 2020 7265 7475 726e 2066 225b        return f"[
+0009c120: 4368 6563 6b20 7468 6520 7b73 656c 662e  Check the {self.
+0009c130: 7063 6372 5265 7374 7261 696e 7473 7d74  pccrRestraints}t
+0009c140: 6820 726f 7720 6f66 2070 6172 616d 6167  h row of paramag
+0009c150: 6e65 7469 6320 6372 6f73 732d 636f 7272  netic cross-corr
+0009c160: 656c 6174 696f 6e20 7261 7465 2072 6573  elation rate res
+0009c170: 7472 6169 6e74 735d 2022 0a20 2020 2020  traints] ".     
+0009c180: 2020 2069 6620 7365 6c66 2e5f 5f63 7572     if self.__cur
+0009c190: 5f73 7562 7479 7065 203d 3d20 2768 626f  _subtype == 'hbo
+0009c1a0: 6e64 273a 0a20 2020 2020 2020 2020 2020  nd':.           
+0009c1b0: 2072 6574 7572 6e20 6622 5b43 6865 636b   return f"[Check
+0009c1c0: 2074 6865 207b 7365 6c66 2e68 626f 6e64   the {self.hbond
+0009c1d0: 5265 7374 7261 696e 7473 7d74 6820 726f  Restraints}th ro
+0009c1e0: 7720 6f66 2068 7964 726f 6765 6e20 626f  w of hydrogen bo
+0009c1f0: 6e64 2067 656f 6d65 7472 7920 7265 7374  nd geometry rest
+0009c200: 7261 696e 7473 5d20 220a 2020 2020 2020  raints] ".      
+0009c210: 2020 6966 2073 656c 662e 5f5f 6375 725f    if self.__cur_
+0009c220: 7375 6274 7970 6520 3d3d 2027 6765 6f27  subtype == 'geo'
+0009c230: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0009c240: 7475 726e 2066 225b 4368 6563 6b20 7468  turn f"[Check th
+0009c250: 6520 7b73 656c 662e 6765 6f52 6573 7472  e {self.geoRestr
+0009c260: 6169 6e74 737d 7468 2072 6f77 206f 6620  aints}th row of 
+0009c270: 6861 726d 6f6e 6963 2063 6f6f 7264 696e  harmonic coordin
+0009c280: 6174 652f 4e43 5320 7265 7374 7261 696e  ate/NCS restrain
+0009c290: 7473 5d20 220a 2020 2020 2020 2020 7265  ts] ".        re
+0009c2a0: 7475 726e 2027 270a 0a20 2020 2064 6566  turn ''..    def
+0009c2b0: 205f 5f73 6574 4c6f 6361 6c53 6571 5363   __setLocalSeqSc
+0009c2c0: 6865 6d65 2873 656c 6629 3a0a 2020 2020  heme(self):.    
+0009c2d0: 2020 2020 6966 2027 6c6f 6361 6c5f 7365      if 'local_se
+0009c2e0: 715f 7363 6865 6d65 2720 6e6f 7420 696e  q_scheme' not in
+0009c2f0: 2073 656c 662e 7265 6173 6f6e 7346 6f72   self.reasonsFor
+0009c300: 5265 5061 7273 696e 673a 0a20 2020 2020  ReParsing:.     
+0009c310: 2020 2020 2020 2073 656c 662e 7265 6173         self.reas
+0009c320: 6f6e 7346 6f72 5265 5061 7273 696e 675b  onsForReParsing[
+0009c330: 276c 6f63 616c 5f73 6571 5f73 6368 656d  'local_seq_schem
+0009c340: 6527 5d20 3d20 7b7d 0a20 2020 2020 2020  e'] = {}.       
+0009c350: 2069 6620 7365 6c66 2e5f 5f63 7572 5f73   if self.__cur_s
+0009c360: 7562 7479 7065 203d 3d20 2764 6973 7427  ubtype == 'dist'
+0009c370: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+0009c380: 6c66 2e72 6561 736f 6e73 466f 7252 6550  lf.reasonsForReP
+0009c390: 6172 7369 6e67 5b27 6c6f 6361 6c5f 7365  arsing['local_se
+0009c3a0: 715f 7363 6865 6d65 275d 5b28 7365 6c66  q_scheme'][(self
+0009c3b0: 2e5f 5f63 7572 5f73 7562 7479 7065 2c20  .__cur_subtype, 
+0009c3c0: 7365 6c66 2e64 6973 7452 6573 7472 6169  self.distRestrai
+0009c3d0: 6e74 7329 5d20 3d20 7365 6c66 2e5f 5f70  nts)] = self.__p
+0009c3e0: 7265 6665 7241 7574 6853 6571 0a20 2020  referAuthSeq.   
+0009c3f0: 2020 2020 2065 6c69 6620 7365 6c66 2e5f       elif self._
+0009c400: 5f63 7572 5f73 7562 7479 7065 203d 3d20  _cur_subtype == 
+0009c410: 2764 6968 6564 273a 0a20 2020 2020 2020  'dihed':.       
+0009c420: 2020 2020 2073 656c 662e 7265 6173 6f6e       self.reason
+0009c430: 7346 6f72 5265 5061 7273 696e 675b 276c  sForReParsing['l
+0009c440: 6f63 616c 5f73 6571 5f73 6368 656d 6527  ocal_seq_scheme'
+0009c450: 5d5b 2873 656c 662e 5f5f 6375 725f 7375  ][(self.__cur_su
+0009c460: 6274 7970 652c 2073 656c 662e 6469 6865  btype, self.dihe
+0009c470: 6452 6573 7472 6169 6e74 7329 5d20 3d20  dRestraints)] = 
+0009c480: 7365 6c66 2e5f 5f70 7265 6665 7241 7574  self.__preferAut
+0009c490: 6853 6571 0a20 2020 2020 2020 2065 6c69  hSeq.        eli
+0009c4a0: 6620 7365 6c66 2e5f 5f63 7572 5f73 7562  f self.__cur_sub
+0009c4b0: 7479 7065 203d 3d20 2772 6463 273a 0a20  type == 'rdc':. 
+0009c4c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0009c4d0: 7265 6173 6f6e 7346 6f72 5265 5061 7273  reasonsForRePars
+0009c4e0: 696e 675b 276c 6f63 616c 5f73 6571 5f73  ing['local_seq_s
+0009c4f0: 6368 656d 6527 5d5b 2873 656c 662e 5f5f  cheme'][(self.__
+0009c500: 6375 725f 7375 6274 7970 652c 2073 656c  cur_subtype, sel
+0009c510: 662e 7264 6352 6573 7472 6169 6e74 7329  f.rdcRestraints)
+0009c520: 5d20 3d20 7365 6c66 2e5f 5f70 7265 6665  ] = self.__prefe
+0009c530: 7241 7574 6853 6571 0a20 2020 2020 2020  rAuthSeq.       
+0009c540: 2065 6c69 6620 7365 6c66 2e5f 5f63 7572   elif self.__cur
+0009c550: 5f73 7562 7479 7065 203d 3d20 2770 6c61  _subtype == 'pla
+0009c560: 6e65 273a 0a20 2020 2020 2020 2020 2020  ne':.           
+0009c570: 2073 656c 662e 7265 6173 6f6e 7346 6f72   self.reasonsFor
+0009c580: 5265 5061 7273 696e 675b 276c 6f63 615f  ReParsing['loca_
+0009c590: 7365 715f 7363 6865 6d65 275d 5b28 7365  seq_scheme'][(se
+0009c5a0: 6c66 2e5f 5f63 7572 5f73 7562 7479 7065  lf.__cur_subtype
+0009c5b0: 2c20 7365 6c66 2e70 6c61 6e65 5265 7374  , self.planeRest
+0009c5c0: 7261 696e 7473 295d 203d 2073 656c 662e  raints)] = self.
+0009c5d0: 5f5f 7072 6566 6572 4175 7468 5365 710a  __preferAuthSeq.
+0009c5e0: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
+0009c5f0: 662e 5f5f 6375 725f 7375 6274 7970 6520  f.__cur_subtype 
+0009c600: 3d3d 2027 6164 6973 7427 3a0a 2020 2020  == 'adist':.    
+0009c610: 2020 2020 2020 2020 7365 6c66 2e72 6561          self.rea
+0009c620: 736f 6e73 466f 7252 6550 6172 7369 6e67  sonsForReParsing
+0009c630: 5b27 6c6f 6361 6c5f 7365 715f 7363 6865  ['local_seq_sche
+0009c640: 6d65 275d 5b28 7365 6c66 2e5f 5f63 7572  me'][(self.__cur
+0009c650: 5f73 7562 7479 7065 2c20 7365 6c66 2e61  _subtype, self.a
+0009c660: 6469 7374 5265 7374 7261 696e 7473 295d  distRestraints)]
+0009c670: 203d 2073 656c 662e 5f5f 7072 6566 6572   = self.__prefer
+0009c680: 4175 7468 5365 710a 2020 2020 2020 2020  AuthSeq.        
+0009c690: 656c 6966 2073 656c 662e 5f5f 6375 725f  elif self.__cur_
+0009c6a0: 7375 6274 7970 6520 3d3d 2027 6a63 6f75  subtype == 'jcou
+0009c6b0: 7027 3a0a 2020 2020 2020 2020 2020 2020  p':.            
+0009c6c0: 7365 6c66 2e72 6561 736f 6e73 466f 7252  self.reasonsForR
+0009c6d0: 6550 6172 7369 6e67 5b27 6c6f 6361 6c5f  eParsing['local_
+0009c6e0: 7365 715f 7363 6865 6d65 275d 5b28 7365  seq_scheme'][(se
+0009c6f0: 6c66 2e5f 5f63 7572 5f73 7562 7479 7065  lf.__cur_subtype
+0009c700: 2c20 7365 6c66 2e6a 636f 7570 5265 7374  , self.jcoupRest
+0009c710: 7261 696e 7473 295d 203d 2073 656c 662e  raints)] = self.
+0009c720: 5f5f 7072 6566 6572 4175 7468 5365 710a  __preferAuthSeq.
+0009c730: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
+0009c740: 662e 5f5f 6375 725f 7375 6274 7970 6520  f.__cur_subtype 
+0009c750: 3d3d 2027 6876 7963 7327 3a0a 2020 2020  == 'hvycs':.    
+0009c760: 2020 2020 2020 2020 7365 6c66 2e72 6561          self.rea
+0009c770: 736f 6e73 466f 7252 6550 6172 7369 6e67  sonsForReParsing
+0009c780: 5b27 6c6f 6361 6c5f 7365 715f 7363 6865  ['local_seq_sche
+0009c790: 6d65 275d 5b28 7365 6c66 2e5f 5f63 7572  me'][(self.__cur
+0009c7a0: 5f73 7562 7479 7065 2c20 7365 6c66 2e68  _subtype, self.h
+0009c7b0: 7679 6373 5265 7374 7261 696e 7473 295d  vycsRestraints)]
+0009c7c0: 203d 2073 656c 662e 5f5f 7072 6566 6572   = self.__prefer
+0009c7d0: 4175 7468 5365 710a 2020 2020 2020 2020  AuthSeq.        
+0009c7e0: 656c 6966 2073 656c 662e 5f5f 6375 725f  elif self.__cur_
+0009c7f0: 7375 6274 7970 6520 3d3d 2027 7072 6f63  subtype == 'proc
+0009c800: 7327 3a0a 2020 2020 2020 2020 2020 2020  s':.            
+0009c810: 7365 6c66 2e72 6561 736f 6e73 466f 7252  self.reasonsForR
+0009c820: 6550 6172 7369 6e67 5b27 6c6f 6361 6c5f  eParsing['local_
+0009c830: 7365 715f 7363 6865 6d65 275d 5b28 7365  seq_scheme'][(se
+0009c840: 6c66 2e5f 5f63 7572 5f73 7562 7479 7065  lf.__cur_subtype
+0009c850: 2c20 7365 6c66 2e70 726f 6373 5265 7374  , self.procsRest
+0009c860: 7261 696e 7473 295d 203d 2073 656c 662e  raints)] = self.
+0009c870: 5f5f 7072 6566 6572 4175 7468 5365 710a  __preferAuthSeq.
+0009c880: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
+0009c890: 662e 5f5f 6375 725f 7375 6274 7970 6520  f.__cur_subtype 
+0009c8a0: 3d3d 2027 7261 6d61 273a 0a20 2020 2020  == 'rama':.     
+0009c8b0: 2020 2020 2020 2073 656c 662e 7265 6173         self.reas
+0009c8c0: 6f6e 7346 6f72 5265 5061 7273 696e 675b  onsForReParsing[
+0009c8d0: 276c 6f63 616c 5f73 6571 5f73 6368 656d  'local_seq_schem
+0009c8e0: 6527 5d5b 2873 656c 662e 5f5f 6375 725f  e'][(self.__cur_
+0009c8f0: 7375 6274 7970 652c 2073 656c 662e 7261  subtype, self.ra
+0009c900: 6d61 5265 7374 7261 696e 7473 295d 203d  maRestraints)] =
+0009c910: 2073 656c 662e 5f5f 7072 6566 6572 4175   self.__preferAu
+0009c920: 7468 5365 710a 2020 2020 2020 2020 656c  thSeq.        el
+0009c930: 6966 2073 656c 662e 5f5f 6375 725f 7375  if self.__cur_su
+0009c940: 6274 7970 6520 3d3d 2027 7261 6469 273a  btype == 'radi':
+0009c950: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0009c960: 662e 7265 6173 6f6e 7346 6f72 5265 5061  f.reasonsForRePa
+0009c970: 7273 696e 675b 276c 6f63 616c 5f73 6571  rsing['local_seq
+0009c980: 5f73 6368 656d 6527 5d5b 2873 656c 662e  _scheme'][(self.
+0009c990: 5f5f 6375 725f 7375 6274 7970 652c 2073  __cur_subtype, s
+0009c9a0: 656c 662e 7261 6469 5265 7374 7261 696e  elf.radiRestrain
+0009c9b0: 7473 295d 203d 2073 656c 662e 5f5f 7072  ts)] = self.__pr
+0009c9c0: 6566 6572 4175 7468 5365 710a 2020 2020  eferAuthSeq.    
+0009c9d0: 2020 2020 656c 6966 2073 656c 662e 5f5f      elif self.__
+0009c9e0: 6375 725f 7375 6274 7970 6520 3d3d 2027  cur_subtype == '
+0009c9f0: 6469 6666 273a 0a20 2020 2020 2020 2020  diff':.         
+0009ca00: 2020 2073 656c 662e 7265 6173 6f6e 7346     self.reasonsF
+0009ca10: 6f72 5265 5061 7273 696e 675b 276c 6f63  orReParsing['loc
+0009ca20: 616c 5f73 6571 5f73 6368 656d 6527 5d5b  al_seq_scheme'][
+0009ca30: 2873 656c 662e 5f5f 6375 725f 7375 6274  (self.__cur_subt
+0009ca40: 7970 652c 2073 656c 662e 6469 6666 5265  ype, self.diffRe
+0009ca50: 7374 7261 696e 7473 295d 203d 2073 656c  straints)] = sel
+0009ca60: 662e 5f5f 7072 6566 6572 4175 7468 5365  f.__preferAuthSe
+0009ca70: 710a 2020 2020 2020 2020 656c 6966 2073  q.        elif s
+0009ca80: 656c 662e 5f5f 6375 725f 7375 6274 7970  elf.__cur_subtyp
+0009ca90: 6520 3d3d 2027 6e62 6173 6527 3a0a 2020  e == 'nbase':.  
+0009caa0: 2020 2020 2020 2020 2020 7365 6c66 2e72            self.r
+0009cab0: 6561 736f 6e73 466f 7252 6550 6172 7369  easonsForReParsi
+0009cac0: 6e67 5b27 6c6f 6361 6c5f 7365 715f 7363  ng['local_seq_sc
+0009cad0: 6865 6d65 275d 5b28 7365 6c66 2e5f 5f63  heme'][(self.__c
+0009cae0: 7572 5f73 7562 7479 7065 2c20 7365 6c66  ur_subtype, self
+0009caf0: 2e6e 6261 7365 5265 7374 7261 696e 7473  .nbaseRestraints
+0009cb00: 295d 203d 2073 656c 662e 5f5f 7072 6566  )] = self.__pref
+0009cb10: 6572 4175 7468 5365 710a 2020 2020 2020  erAuthSeq.      
+0009cb20: 2020 656c 6966 2073 656c 662e 5f5f 6375    elif self.__cu
+0009cb30: 725f 7375 6274 7970 6520 3d3d 2027 6373  r_subtype == 'cs
+0009cb40: 6127 3a0a 2020 2020 2020 2020 2020 2020  a':.            
+0009cb50: 7365 6c66 2e72 6561 736f 6e73 466f 7252  self.reasonsForR
+0009cb60: 6550 6172 7369 6e67 5b27 6c6f 6361 6c5f  eParsing['local_
+0009cb70: 7365 715f 7363 6865 6d65 275d 5b28 7365  seq_scheme'][(se
+0009cb80: 6c66 2e5f 5f63 7572 5f73 7562 7479 7065  lf.__cur_subtype
+0009cb90: 2c20 7365 6c66 2e63 7361 5265 7374 7261  , self.csaRestra
+0009cba0: 696e 7473 295d 203d 2073 656c 662e 5f5f  ints)] = self.__
+0009cbb0: 7072 6566 6572 4175 7468 5365 710a 2020  preferAuthSeq.  
+0009cbc0: 2020 2020 2020 2320 656c 6966 2073 656c        # elif sel
+0009cbd0: 662e 5f5f 6375 725f 7375 6274 7970 6520  f.__cur_subtype 
+0009cbe0: 3d3d 2027 616e 6727 3a0a 2020 2020 2020  == 'ang':.      
+0009cbf0: 2020 2320 2020 2020 7365 6c66 2e72 6561    #     self.rea
+0009cc00: 736f 6e73 466f 7252 6550 6172 7369 6e67  sonsForReParsing
+0009cc10: 5b27 6c6f 6361 6c5f 7365 715f 7363 6865  ['local_seq_sche
+0009cc20: 6d65 275d 5b28 7365 6c66 2e5f 5f63 7572  me'][(self.__cur
+0009cc30: 5f73 7562 7479 7065 2c20 7365 6c66 2e61  _subtype, self.a
+0009cc40: 6e67 5265 7374 7261 696e 7473 295d 203d  ngRestraints)] =
+0009cc50: 2073 656c 662e 5f5f 7072 6566 6572 4175   self.__preferAu
+0009cc60: 7468 5365 710a 2020 2020 2020 2020 656c  thSeq.        el
+0009cc70: 6966 2073 656c 662e 5f5f 6375 725f 7375  if self.__cur_su
+0009cc80: 6274 7970 6520 3d3d 2027 7072 6527 3a0a  btype == 'pre':.
+0009cc90: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0009cca0: 2e72 6561 736f 6e73 466f 7252 6550 6172  .reasonsForRePar
+0009ccb0: 7369 6e67 5b27 6c6f 6361 6c5f 7365 715f  sing['local_seq_
+0009ccc0: 7363 6865 6d65 275d 5b28 7365 6c66 2e5f  scheme'][(self._
+0009ccd0: 5f63 7572 5f73 7562 7479 7065 2c20 7365  _cur_subtype, se
+0009cce0: 6c66 2e70 7265 5265 7374 7261 696e 7473  lf.preRestraints
+0009ccf0: 295d 203d 2073 656c 662e 5f5f 7072 6566  )] = self.__pref
+0009cd00: 6572 4175 7468 5365 710a 2020 2020 2020  erAuthSeq.      
+0009cd10: 2020 656c 6966 2073 656c 662e 5f5f 6375    elif self.__cu
+0009cd20: 725f 7375 6274 7970 6520 3d3d 2027 7063  r_subtype == 'pc
+0009cd30: 7327 3a0a 2020 2020 2020 2020 2020 2020  s':.            
+0009cd40: 7365 6c66 2e72 6561 736f 6e73 466f 7252  self.reasonsForR
+0009cd50: 6550 6172 7369 6e67 5b27 6c6f 6361 6c5f  eParsing['local_
+0009cd60: 7365 715f 7363 6865 6d65 275d 5b28 7365  seq_scheme'][(se
+0009cd70: 6c66 2e5f 5f63 7572 5f73 7562 7479 7065  lf.__cur_subtype
+0009cd80: 2c20 7365 6c66 2e70 6373 5265 7374 7261  , self.pcsRestra
+0009cd90: 696e 7473 295d 203d 2073 656c 662e 5f5f  ints)] = self.__
+0009cda0: 7072 6566 6572 4175 7468 5365 710a 2020  preferAuthSeq.  
+0009cdb0: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
+0009cdc0: 5f5f 6375 725f 7375 6274 7970 6520 3d3d  __cur_subtype ==
+0009cdd0: 2027 7072 6463 273a 0a20 2020 2020 2020   'prdc':.       
+0009cde0: 2020 2020 2073 656c 662e 7265 6173 6f6e       self.reason
+0009cdf0: 7346 6f72 5265 5061 7273 696e 675b 276c  sForReParsing['l
+0009ce00: 6f63 616c 5f73 6571 5f73 6368 656d 6527  ocal_seq_scheme'
+0009ce10: 5d5b 2873 656c 662e 5f5f 6375 725f 7375  ][(self.__cur_su
+0009ce20: 6274 7970 652c 2073 656c 662e 7072 6463  btype, self.prdc
+0009ce30: 5265 7374 7261 696e 7473 295d 203d 2073  Restraints)] = s
+0009ce40: 656c 662e 5f5f 7072 6566 6572 4175 7468  elf.__preferAuth
+0009ce50: 5365 710a 2020 2020 2020 2020 656c 6966  Seq.        elif
+0009ce60: 2073 656c 662e 5f5f 6375 725f 7375 6274   self.__cur_subt
+0009ce70: 7970 6520 3d3d 2027 7061 6e67 273a 0a20  ype == 'pang':. 
+0009ce80: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0009ce90: 7265 6173 6f6e 7346 6f72 5265 5061 7273  reasonsForRePars
+0009cea0: 696e 675b 276c 6f63 616c 5f73 6571 5f73  ing['local_seq_s
+0009ceb0: 6368 656d 6527 5d5b 2873 656c 662e 5f5f  cheme'][(self.__
+0009cec0: 6375 725f 7375 6274 7970 652c 2073 656c  cur_subtype, sel
+0009ced0: 662e 7061 6e67 5265 7374 7261 696e 7473  f.pangRestraints
+0009cee0: 295d 203d 2073 656c 662e 5f5f 7072 6566  )] = self.__pref
+0009cef0: 6572 4175 7468 5365 710a 2020 2020 2020  erAuthSeq.      
+0009cf00: 2020 656c 6966 2073 656c 662e 5f5f 6375    elif self.__cu
+0009cf10: 725f 7375 6274 7970 6520 3d3d 2027 7063  r_subtype == 'pc
+0009cf20: 6372 273a 0a20 2020 2020 2020 2020 2020  cr':.           
+0009cf30: 2073 656c 662e 7265 6173 6f6e 7346 6f72   self.reasonsFor
+0009cf40: 5265 5061 7273 696e 675b 276c 6f63 616c  ReParsing['local
+0009cf50: 5f73 6571 5f73 6368 656d 6527 5d5b 2873  _seq_scheme'][(s
+0009cf60: 656c 662e 5f5f 6375 725f 7375 6274 7970  elf.__cur_subtyp
+0009cf70: 652c 2073 656c 662e 7063 6372 5265 7374  e, self.pccrRest
+0009cf80: 7261 696e 7473 295d 203d 2073 656c 662e  raints)] = self.
+0009cf90: 5f5f 7072 6566 6572 4175 7468 5365 710a  __preferAuthSeq.
+0009cfa0: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
+0009cfb0: 662e 5f5f 6375 725f 7375 6274 7970 6520  f.__cur_subtype 
+0009cfc0: 3d3d 2027 6862 6f6e 6427 3a0a 2020 2020  == 'hbond':.    
+0009cfd0: 2020 2020 2020 2020 7365 6c66 2e72 6561          self.rea
+0009cfe0: 736f 6e73 466f 7252 6550 6172 7369 6e67  sonsForReParsing
+0009cff0: 5b27 6c6f 6361 6c5f 7365 715f 7363 6865  ['local_seq_sche
+0009d000: 6d65 275d 5b28 7365 6c66 2e5f 5f63 7572  me'][(self.__cur
+0009d010: 5f73 7562 7479 7065 2c20 7365 6c66 2e68  _subtype, self.h
+0009d020: 626f 6e64 5265 7374 7261 696e 7473 295d  bondRestraints)]
+0009d030: 203d 2073 656c 662e 5f5f 7072 6566 6572   = self.__prefer
+0009d040: 4175 7468 5365 710a 2020 2020 2020 2020  AuthSeq.        
+0009d050: 656c 6966 2073 656c 662e 5f5f 6375 725f  elif self.__cur_
+0009d060: 7375 6274 7970 6520 3d3d 2027 6765 6f27  subtype == 'geo'
+0009d070: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+0009d080: 6c66 2e72 6561 736f 6e73 466f 7252 6550  lf.reasonsForReP
+0009d090: 6172 7369 6e67 5b27 6c6f 6361 6c5f 7365  arsing['local_se
+0009d0a0: 715f 7363 6865 6d65 275d 5b28 7365 6c66  q_scheme'][(self
+0009d0b0: 2e5f 5f63 7572 5f73 7562 7479 7065 2c20  .__cur_subtype, 
+0009d0c0: 7365 6c66 2e67 656f 5265 7374 7261 696e  self.geoRestrain
+0009d0d0: 7473 295d 203d 2073 656c 662e 5f5f 7072  ts)] = self.__pr
+0009d0e0: 6566 6572 4175 7468 5365 710a 2020 2020  eferAuthSeq.    
+0009d0f0: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
+0009d100: 5f5f 7072 6566 6572 4175 7468 5365 713a  __preferAuthSeq:
+0009d110: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0009d120: 662e 5f5f 7072 6566 6572 4c61 6265 6c53  f.__preferLabelS
+0009d130: 6571 436f 756e 7420 2b3d 2031 0a20 2020  eqCount += 1.   
+0009d140: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+0009d150: 2e5f 5f70 7265 6665 724c 6162 656c 5365  .__preferLabelSe
+0009d160: 7143 6f75 6e74 203e 204d 4158 5f50 5245  qCount > MAX_PRE
+0009d170: 465f 4c41 4245 4c5f 5343 4845 4d45 5f43  F_LABEL_SCHEME_C
+0009d180: 4f55 4e54 3a0a 2020 2020 2020 2020 2020  OUNT:.          
+0009d190: 2020 2020 2020 7365 6c66 2e72 6561 736f        self.reaso
+0009d1a0: 6e73 466f 7252 6550 6172 7369 6e67 5b27  nsForReParsing['
+0009d1b0: 6c61 6265 6c5f 7365 715f 7363 6865 6d65  label_seq_scheme
+0009d1c0: 275d 203d 2054 7275 650a 0a20 2020 2064  '] = True..    d
+0009d1d0: 6566 205f 5f72 6574 7269 6576 654c 6f63  ef __retrieveLoc
+0009d1e0: 616c 5365 7153 6368 656d 6528 7365 6c66  alSeqScheme(self
+0009d1f0: 293a 0a20 2020 2020 2020 2069 6620 7365  ):.        if se
+0009d200: 6c66 2e5f 5f72 6561 736f 6e73 2069 7320  lf.__reasons is 
+0009d210: 4e6f 6e65 206f 7220 276c 6f63 616c 5f73  None or 'local_s
+0009d220: 6571 5f73 6368 656d 6527 206e 6f74 2069  eq_scheme' not i
+0009d230: 6e20 7365 6c66 2e5f 5f72 6561 736f 6e73  n self.__reasons
+0009d240: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0009d250: 7475 726e 0a20 2020 2020 2020 2069 6620  turn.        if 
+0009d260: 276c 6162 656c 5f73 6571 5f73 6368 656d  'label_seq_schem
+0009d270: 6527 2069 6e20 7365 6c66 2e5f 5f72 6561  e' in self.__rea
+0009d280: 736f 6e73 2061 6e64 2073 656c 662e 5f5f  sons and self.__
+0009d290: 7265 6173 6f6e 735b 276c 6162 656c 5f73  reasons['label_s
+0009d2a0: 6571 5f73 6368 656d 6527 5d3a 0a20 2020  eq_scheme']:.   
+0009d2b0: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
+0009d2c0: 7072 6566 6572 4175 7468 5365 7120 3d20  preferAuthSeq = 
+0009d2d0: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
+0009d2e0: 2020 7365 6c66 2e5f 5f61 7574 6853 6571    self.__authSeq
+0009d2f0: 4964 203d 2027 6c61 6265 6c5f 7365 715f  Id = 'label_seq_
+0009d300: 6964 270a 2020 2020 2020 2020 2020 2020  id'.            
+0009d310: 7265 7475 726e 0a20 2020 2020 2020 2069  return.        i
 0009d320: 6620 7365 6c66 2e5f 5f63 7572 5f73 7562  f self.__cur_sub
-0009d330: 7479 7065 203d 3d20 2768 7679 6373 273a  type == 'hvycs':
-0009d340: 0a20 2020 2020 2020 2020 2020 206b 6579  .            key
-0009d350: 203d 2028 7365 6c66 2e5f 5f63 7572 5f73   = (self.__cur_s
-0009d360: 7562 7479 7065 2c20 7365 6c66 2e68 7679  ubtype, self.hvy
-0009d370: 6373 5265 7374 7261 696e 7473 290a 2020  csRestraints).  
-0009d380: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
-0009d390: 5f5f 6375 725f 7375 6274 7970 6520 3d3d  __cur_subtype ==
-0009d3a0: 2027 7072 6f63 7327 3a0a 2020 2020 2020   'procs':.      
-0009d3b0: 2020 2020 2020 6b65 7920 3d20 2873 656c        key = (sel
-0009d3c0: 662e 5f5f 6375 725f 7375 6274 7970 652c  f.__cur_subtype,
-0009d3d0: 2073 656c 662e 7072 6f63 7352 6573 7472   self.procsRestr
-0009d3e0: 6169 6e74 7329 0a20 2020 2020 2020 2065  aints).        e
-0009d3f0: 6c69 6620 7365 6c66 2e5f 5f63 7572 5f73  lif self.__cur_s
-0009d400: 7562 7479 7065 203d 3d20 2772 616d 6127  ubtype == 'rama'
-0009d410: 3a0a 2020 2020 2020 2020 2020 2020 6b65  :.            ke
-0009d420: 7920 3d20 2873 656c 662e 5f5f 6375 725f  y = (self.__cur_
-0009d430: 7375 6274 7970 652c 2073 656c 662e 7261  subtype, self.ra
-0009d440: 6d61 5265 7374 7261 696e 7473 290a 2020  maRestraints).  
-0009d450: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
-0009d460: 5f5f 6375 725f 7375 6274 7970 6520 3d3d  __cur_subtype ==
-0009d470: 2027 7261 6469 273a 0a20 2020 2020 2020   'radi':.       
-0009d480: 2020 2020 206b 6579 203d 2028 7365 6c66       key = (self
-0009d490: 2e5f 5f63 7572 5f73 7562 7479 7065 2c20  .__cur_subtype, 
-0009d4a0: 7365 6c66 2e72 6164 6952 6573 7472 6169  self.radiRestrai
-0009d4b0: 6e74 7329 0a20 2020 2020 2020 2065 6c69  nts).        eli
-0009d4c0: 6620 7365 6c66 2e5f 5f63 7572 5f73 7562  f self.__cur_sub
-0009d4d0: 7479 7065 203d 3d20 2764 6966 6627 3a0a  type == 'diff':.
-0009d4e0: 2020 2020 2020 2020 2020 2020 6b65 7920              key 
-0009d4f0: 3d20 2873 656c 662e 5f5f 6375 725f 7375  = (self.__cur_su
-0009d500: 6274 7970 652c 2073 656c 662e 6469 6666  btype, self.diff
+0009d330: 7479 7065 203d 3d20 2764 6973 7427 3a0a  type == 'dist':.
+0009d340: 2020 2020 2020 2020 2020 2020 6b65 7920              key 
+0009d350: 3d20 2873 656c 662e 5f5f 6375 725f 7375  = (self.__cur_su
+0009d360: 6274 7970 652c 2073 656c 662e 6469 7374  btype, self.dist
+0009d370: 5265 7374 7261 696e 7473 290a 2020 2020  Restraints).    
+0009d380: 2020 2020 656c 6966 2073 656c 662e 5f5f      elif self.__
+0009d390: 6375 725f 7375 6274 7970 6520 3d3d 2027  cur_subtype == '
+0009d3a0: 6469 6865 6427 3a0a 2020 2020 2020 2020  dihed':.        
+0009d3b0: 2020 2020 6b65 7920 3d20 2873 656c 662e      key = (self.
+0009d3c0: 5f5f 6375 725f 7375 6274 7970 652c 2073  __cur_subtype, s
+0009d3d0: 656c 662e 6469 6865 6452 6573 7472 6169  elf.dihedRestrai
+0009d3e0: 6e74 7329 0a20 2020 2020 2020 2065 6c69  nts).        eli
+0009d3f0: 6620 7365 6c66 2e5f 5f63 7572 5f73 7562  f self.__cur_sub
+0009d400: 7479 7065 203d 3d20 2772 6463 273a 0a20  type == 'rdc':. 
+0009d410: 2020 2020 2020 2020 2020 206b 6579 203d             key =
+0009d420: 2028 7365 6c66 2e5f 5f63 7572 5f73 7562   (self.__cur_sub
+0009d430: 7479 7065 2c20 7365 6c66 2e72 6463 5265  type, self.rdcRe
+0009d440: 7374 7261 696e 7473 290a 2020 2020 2020  straints).      
+0009d450: 2020 656c 6966 2073 656c 662e 5f5f 6375    elif self.__cu
+0009d460: 725f 7375 6274 7970 6520 3d3d 2027 706c  r_subtype == 'pl
+0009d470: 616e 6527 3a0a 2020 2020 2020 2020 2020  ane':.          
+0009d480: 2020 6b65 7920 3d20 2873 656c 662e 5f5f    key = (self.__
+0009d490: 6375 725f 7375 6274 7970 652c 2073 656c  cur_subtype, sel
+0009d4a0: 662e 706c 616e 6552 6573 7472 6169 6e74  f.planeRestraint
+0009d4b0: 7329 0a20 2020 2020 2020 2065 6c69 6620  s).        elif 
+0009d4c0: 7365 6c66 2e5f 5f63 7572 5f73 7562 7479  self.__cur_subty
+0009d4d0: 7065 203d 3d20 2761 6469 7374 273a 0a20  pe == 'adist':. 
+0009d4e0: 2020 2020 2020 2020 2020 206b 6579 203d             key =
+0009d4f0: 2028 7365 6c66 2e5f 5f63 7572 5f73 7562   (self.__cur_sub
+0009d500: 7479 7065 2c20 7365 6c66 2e61 6469 7374  type, self.adist
 0009d510: 5265 7374 7261 696e 7473 290a 2020 2020  Restraints).    
 0009d520: 2020 2020 656c 6966 2073 656c 662e 5f5f      elif self.__
 0009d530: 6375 725f 7375 6274 7970 6520 3d3d 2027  cur_subtype == '
-0009d540: 6e62 6173 6527 3a0a 2020 2020 2020 2020  nbase':.        
+0009d540: 6a63 6f75 7027 3a0a 2020 2020 2020 2020  jcoup':.        
 0009d550: 2020 2020 6b65 7920 3d20 2873 656c 662e      key = (self.
 0009d560: 5f5f 6375 725f 7375 6274 7970 652c 2073  __cur_subtype, s
-0009d570: 656c 662e 6e62 6173 6552 6573 7472 6169  elf.nbaseRestrai
+0009d570: 656c 662e 6a63 6f75 7052 6573 7472 6169  elf.jcoupRestrai
 0009d580: 6e74 7329 0a20 2020 2020 2020 2065 6c69  nts).        eli
 0009d590: 6620 7365 6c66 2e5f 5f63 7572 5f73 7562  f self.__cur_sub
-0009d5a0: 7479 7065 203d 3d20 2763 7361 273a 0a20  type == 'csa':. 
-0009d5b0: 2020 2020 2020 2020 2020 206b 6579 203d             key =
-0009d5c0: 2028 7365 6c66 2e5f 5f63 7572 5f73 7562   (self.__cur_sub
-0009d5d0: 7479 7065 2c20 7365 6c66 2e63 7361 5265  type, self.csaRe
-0009d5e0: 7374 7261 696e 7473 290a 2020 2020 2020  straints).      
-0009d5f0: 2020 2320 656c 6966 2073 656c 662e 5f5f    # elif self.__
-0009d600: 6375 725f 7375 6274 7970 6520 3d3d 2027  cur_subtype == '
-0009d610: 616e 6727 3a0a 2020 2020 2020 2020 2320  ang':.        # 
-0009d620: 2020 2020 6b65 7920 3d20 2873 656c 662e      key = (self.
-0009d630: 5f5f 6375 725f 7375 6274 7970 652c 2073  __cur_subtype, s
-0009d640: 656c 662e 616e 6752 6573 7472 6169 6e74  elf.angRestraint
-0009d650: 7329 0a20 2020 2020 2020 2065 6c69 6620  s).        elif 
-0009d660: 7365 6c66 2e5f 5f63 7572 5f73 7562 7479  self.__cur_subty
-0009d670: 7065 203d 3d20 2770 7265 273a 0a20 2020  pe == 'pre':.   
-0009d680: 2020 2020 2020 2020 206b 6579 203d 2028           key = (
-0009d690: 7365 6c66 2e5f 5f63 7572 5f73 7562 7479  self.__cur_subty
-0009d6a0: 7065 2c20 7365 6c66 2e70 7265 5265 7374  pe, self.preRest
-0009d6b0: 7261 696e 7473 290a 2020 2020 2020 2020  raints).        
-0009d6c0: 656c 6966 2073 656c 662e 5f5f 6375 725f  elif self.__cur_
-0009d6d0: 7375 6274 7970 6520 3d3d 2027 7063 7327  subtype == 'pcs'
-0009d6e0: 3a0a 2020 2020 2020 2020 2020 2020 6b65  :.            ke
-0009d6f0: 7920 3d20 2873 656c 662e 5f5f 6375 725f  y = (self.__cur_
-0009d700: 7375 6274 7970 652c 2073 656c 662e 7063  subtype, self.pc
-0009d710: 7352 6573 7472 6169 6e74 7329 0a20 2020  sRestraints).   
-0009d720: 2020 2020 2065 6c69 6620 7365 6c66 2e5f       elif self._
-0009d730: 5f63 7572 5f73 7562 7479 7065 203d 3d20  _cur_subtype == 
-0009d740: 2770 7264 6327 3a0a 2020 2020 2020 2020  'prdc':.        
-0009d750: 2020 2020 6b65 7920 3d20 2873 656c 662e      key = (self.
-0009d760: 5f5f 6375 725f 7375 6274 7970 652c 2073  __cur_subtype, s
-0009d770: 656c 662e 7072 6463 5265 7374 7261 696e  elf.prdcRestrain
-0009d780: 7473 290a 2020 2020 2020 2020 656c 6966  ts).        elif
-0009d790: 2073 656c 662e 5f5f 6375 725f 7375 6274   self.__cur_subt
-0009d7a0: 7970 6520 3d3d 2027 7061 6e67 273a 0a20  ype == 'pang':. 
-0009d7b0: 2020 2020 2020 2020 2020 206b 6579 203d             key =
-0009d7c0: 2028 7365 6c66 2e5f 5f63 7572 5f73 7562   (self.__cur_sub
-0009d7d0: 7479 7065 2c20 7365 6c66 2e70 616e 6752  type, self.pangR
-0009d7e0: 6573 7472 6169 6e74 7329 0a20 2020 2020  estraints).     
-0009d7f0: 2020 2065 6c69 6620 7365 6c66 2e5f 5f63     elif self.__c
-0009d800: 7572 5f73 7562 7479 7065 203d 3d20 2770  ur_subtype == 'p
-0009d810: 6363 7227 3a0a 2020 2020 2020 2020 2020  ccr':.          
-0009d820: 2020 6b65 7920 3d20 2873 656c 662e 5f5f    key = (self.__
-0009d830: 6375 725f 7375 6274 7970 652c 2073 656c  cur_subtype, sel
-0009d840: 662e 7063 6372 5265 7374 7261 696e 7473  f.pccrRestraints
-0009d850: 290a 2020 2020 2020 2020 656c 6966 2073  ).        elif s
-0009d860: 656c 662e 5f5f 6375 725f 7375 6274 7970  elf.__cur_subtyp
-0009d870: 6520 3d3d 2027 6862 6f6e 6427 3a0a 2020  e == 'hbond':.  
-0009d880: 2020 2020 2020 2020 2020 6b65 7920 3d20            key = 
-0009d890: 2873 656c 662e 5f5f 6375 725f 7375 6274  (self.__cur_subt
-0009d8a0: 7970 652c 2073 656c 662e 6862 6f6e 6452  ype, self.hbondR
-0009d8b0: 6573 7472 6169 6e74 7329 0a20 2020 2020  estraints).     
-0009d8c0: 2020 2065 6c69 6620 7365 6c66 2e5f 5f63     elif self.__c
-0009d8d0: 7572 5f73 7562 7479 7065 203d 3d20 2767  ur_subtype == 'g
-0009d8e0: 656f 273a 0a20 2020 2020 2020 2020 2020  eo':.           
-0009d8f0: 206b 6579 203d 2028 7365 6c66 2e5f 5f63   key = (self.__c
-0009d900: 7572 5f73 7562 7479 7065 2c20 7365 6c66  ur_subtype, self
-0009d910: 2e67 656f 5265 7374 7261 696e 7473 290a  .geoRestraints).
-0009d920: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0009d930: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0009d940: 0a0a 2020 2020 2020 2020 6966 206b 6579  ..        if key
-0009d950: 2069 6e20 7365 6c66 2e5f 5f72 6561 736f   in self.__reaso
-0009d960: 6e73 5b27 6c6f 6361 6c5f 7365 715f 7363  ns['local_seq_sc
-0009d970: 6865 6d65 275d 3a0a 2020 2020 2020 2020  heme']:.        
-0009d980: 2020 2020 7365 6c66 2e5f 5f70 7265 6665      self.__prefe
-0009d990: 7241 7574 6853 6571 203d 2073 656c 662e  rAuthSeq = self.
-0009d9a0: 5f5f 7265 6173 6f6e 735b 276c 6f63 616c  __reasons['local
-0009d9b0: 5f73 6571 5f73 6368 656d 6527 5d5b 6b65  _seq_scheme'][ke
-0009d9c0: 795d 0a0a 2020 2020 6465 6620 5f5f 6164  y]..    def __ad
-0009d9d0: 6453 6628 7365 6c66 2c20 636f 6e73 7472  dSf(self, constr
-0009d9e0: 6169 6e74 5479 7065 3d4e 6f6e 652c 2070  aintType=None, p
-0009d9f0: 6f74 656e 7469 616c 5479 7065 3d4e 6f6e  otentialType=Non
-0009da00: 652c 2072 6463 436f 6465 3d4e 6f6e 652c  e, rdcCode=None,
-0009da10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0009da20: 2061 6c69 676e 4365 6e74 6572 3d4e 6f6e   alignCenter=Non
-0009da30: 6529 3a0a 2020 2020 2020 2020 636f 6e74  e):.        cont
-0009da40: 656e 745f 7375 6274 7970 6520 3d20 636f  ent_subtype = co
-0009da50: 6e74 656e 7453 7562 7479 7065 4f66 2873  ntentSubtypeOf(s
-0009da60: 656c 662e 5f5f 6375 725f 7375 6274 7970  elf.__cur_subtyp
-0009da70: 6529 0a0a 2020 2020 2020 2020 6966 2063  e)..        if c
-0009da80: 6f6e 7465 6e74 5f73 7562 7479 7065 2069  ontent_subtype i
-0009da90: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-0009daa0: 2020 2020 7265 7475 726e 0a0a 2020 2020      return..    
-0009dab0: 2020 2020 7365 6c66 2e5f 5f63 7572 5f63      self.__cur_c
-0009dac0: 6f6e 7374 7261 696e 745f 7479 7065 203d  onstraint_type =
-0009dad0: 2063 6f6e 7374 7261 696e 7454 7970 650a   constraintType.
-0009dae0: 0a20 2020 2020 2020 2073 656c 662e 5f5f  .        self.__
-0009daf0: 6c69 7374 4964 436f 756e 7465 7220 3d20  listIdCounter = 
-0009db00: 696e 634c 6973 7449 6443 6f75 6e74 6572  incListIdCounter
-0009db10: 2873 656c 662e 5f5f 6375 725f 7375 6274  (self.__cur_subt
-0009db20: 7970 652c 2073 656c 662e 5f5f 6c69 7374  ype, self.__list
-0009db30: 4964 436f 756e 7465 7229 0a0a 2020 2020  IdCounter)..    
-0009db40: 2020 2020 6b65 7920 3d20 2873 656c 662e      key = (self.
-0009db50: 5f5f 6375 725f 7375 6274 7970 652c 2063  __cur_subtype, c
-0009db60: 6f6e 7374 7261 696e 7454 7970 652c 2070  onstraintType, p
-0009db70: 6f74 656e 7469 616c 5479 7065 2c20 7264  otentialType, rd
-0009db80: 6343 6f64 652c 204e 6f6e 6520 6966 2061  cCode, None if a
-0009db90: 6c69 676e 4365 6e74 6572 2069 7320 4e6f  lignCenter is No
-0009dba0: 6e65 2065 6c73 6520 7374 7228 616c 6967  ne else str(alig
-0009dbb0: 6e43 656e 7465 7229 290a 0a20 2020 2020  nCenter))..     
-0009dbc0: 2020 2069 6620 7365 6c66 2e5f 5f63 7572     if self.__cur
-0009dbd0: 5f73 7562 7479 7065 206e 6f74 2069 6e20  _subtype not in 
-0009dbe0: 7365 6c66 2e73 6644 6963 743a 0a20 2020  self.sfDict:.   
-0009dbf0: 2020 2020 2020 2020 2073 656c 662e 7366           self.sf
-0009dc00: 4469 6374 5b6b 6579 5d20 3d20 5b5d 0a0a  Dict[key] = []..
-0009dc10: 2020 2020 2020 2020 6c69 7374 5f69 6420          list_id 
-0009dc20: 3d20 7365 6c66 2e5f 5f6c 6973 7449 6443  = self.__listIdC
-0009dc30: 6f75 6e74 6572 5b63 6f6e 7465 6e74 5f73  ounter[content_s
-0009dc40: 7562 7479 7065 5d0a 0a20 2020 2020 2020  ubtype]..       
-0009dc50: 2063 6e73 5f63 6f6d 7061 7469 626c 655f   cns_compatible_
-0009dc60: 7479 7065 7320 3d20 5b27 6469 7374 272c  types = ['dist',
-0009dc70: 2027 6469 6865 6427 2c20 2772 6463 272c   'dihed', 'rdc',
-0009dc80: 2027 706c 616e 6527 2c20 276a 636f 7570   'plane', 'jcoup
-0009dc90: 272c 2027 6876 7963 7327 2c20 2770 726f  ', 'hvycs', 'pro
-0009dca0: 6373 272c 2027 7261 6d61 272c 2027 6469  cs', 'rama', 'di
-0009dcb0: 6666 272c 2027 6e62 6173 6527 2c20 2767  ff', 'nbase', 'g
-0009dcc0: 656f 275d 0a0a 2020 2020 2020 2020 7265  eo']..        re
-0009dcd0: 7374 7261 696e 745f 6e61 6d65 203d 2067  straint_name = g
-0009dce0: 6574 5265 7374 7261 696e 744e 616d 6528  etRestraintName(
-0009dcf0: 7365 6c66 2e5f 5f63 7572 5f73 7562 7479  self.__cur_subty
-0009dd00: 7065 290a 0a20 2020 2020 2020 2073 665f  pe)..        sf_
-0009dd10: 6672 616d 6563 6f64 6520 3d20 2827 5850  framecode = ('XP
-0009dd20: 4c4f 522d 4e49 482f 434e 5327 2069 6620  LOR-NIH/CNS' if 
-0009dd30: 7365 6c66 2e5f 5f72 656d 6564 6961 7465  self.__remediate
-0009dd40: 2061 6e64 2073 656c 662e 5f5f 6375 725f   and self.__cur_
-0009dd50: 7375 6274 7970 6520 696e 2063 6e73 5f63  subtype in cns_c
-0009dd60: 6f6d 7061 7469 626c 655f 7479 7065 7320  ompatible_types 
-0009dd70: 656c 7365 2027 5850 4c4f 522d 4e49 4827  else 'XPLOR-NIH'
-0009dd80: 295c 0a20 2020 2020 2020 2020 2020 202b  )\.            +
-0009dd90: 2027 5f27 202b 2072 6573 7472 6169 6e74   '_' + restraint
-0009dda0: 5f6e 616d 652e 7265 706c 6163 6528 2720  _name.replace(' 
-0009ddb0: 272c 2027 5f27 2920 2b20 6627 5f7b 6c69  ', '_') + f'_{li
-0009ddc0: 7374 5f69 647d 270a 0a20 2020 2020 2020  st_id}'..       
-0009ddd0: 2073 6620 3d20 6765 7453 6176 6566 7261   sf = getSavefra
-0009dde0: 6d65 2873 656c 662e 5f5f 6375 725f 7375  me(self.__cur_su
-0009ddf0: 6274 7970 652c 2073 665f 6672 616d 6563  btype, sf_framec
-0009de00: 6f64 652c 206c 6973 745f 6964 2c20 7365  ode, list_id, se
-0009de10: 6c66 2e5f 5f65 6e74 7279 4964 2c20 7365  lf.__entryId, se
-0009de20: 6c66 2e5f 5f6f 7269 6769 6e61 6c46 696c  lf.__originalFil
-0009de30: 654e 616d 652c 0a20 2020 2020 2020 2020  eName,.         
-0009de40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009de50: 2063 6f6e 7374 7261 696e 7454 7970 653d   constraintType=
-0009de60: 636f 6e73 7472 6169 6e74 5479 7065 2c20  constraintType, 
-0009de70: 706f 7465 6e74 6961 6c54 7970 653d 706f  potentialType=po
-0009de80: 7465 6e74 6961 6c54 7970 652c 2072 6463  tentialType, rdc
-0009de90: 436f 6465 3d72 6463 436f 6465 2c0a 2020  Code=rdcCode,.  
-0009dea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009deb0: 2020 2020 2020 2020 616c 6967 6e43 656e          alignCen
-0009dec0: 7465 723d 616c 6967 6e43 656e 7465 7229  ter=alignCenter)
-0009ded0: 0a0a 2020 2020 2020 2020 6e6f 745f 7661  ..        not_va
-0009dee0: 6c69 6420 3d20 5472 7565 0a0a 2020 2020  lid = True..    
-0009def0: 2020 2020 6c70 203d 2067 6574 4c6f 6f70      lp = getLoop
-0009df00: 2873 656c 662e 5f5f 6375 725f 7375 6274  (self.__cur_subt
-0009df10: 7970 652c 2068 6173 496e 7343 6f64 653d  ype, hasInsCode=
-0009df20: 2873 656c 662e 5f5f 6175 7468 546f 496e  (self.__authToIn
-0009df30: 7343 6f64 6520 6973 206e 6f74 204e 6f6e  sCode is not Non
-0009df40: 6529 290a 2020 2020 2020 2020 6966 206e  e)).        if n
-0009df50: 6f74 2069 7369 6e73 7461 6e63 6528 6c70  ot isinstance(lp
-0009df60: 2c20 6469 6374 293a 0a20 2020 2020 2020  , dict):.       
-0009df70: 2020 2020 2073 662e 6164 645f 6c6f 6f70       sf.add_loop
-0009df80: 286c 7029 0a20 2020 2020 2020 2020 2020  (lp).           
-0009df90: 206e 6f74 5f76 616c 6964 203d 2046 616c   not_valid = Fal
-0009dfa0: 7365 0a0a 2020 2020 2020 2020 5f72 6573  se..        _res
-0009dfb0: 7472 6169 6e74 5f6e 616d 6520 3d20 7265  traint_name = re
-0009dfc0: 7374 7261 696e 745f 6e61 6d65 2e73 706c  straint_name.spl
-0009dfd0: 6974 2829 0a0a 2020 2020 2020 2020 6974  it()..        it
-0009dfe0: 656d 203d 207b 2766 696c 655f 7479 7065  em = {'file_type
-0009dff0: 273a 2073 656c 662e 5f5f 6669 6c65 5f74  ': self.__file_t
-0009e000: 7970 652c 2027 7361 7665 6672 616d 6527  ype, 'saveframe'
-0009e010: 3a20 7366 2c20 276c 6f6f 7027 3a20 6c70  : sf, 'loop': lp
-0009e020: 2c20 276c 6973 745f 6964 273a 206c 6973  , 'list_id': lis
-0009e030: 745f 6964 2c0a 2020 2020 2020 2020 2020  t_id,.          
-0009e040: 2020 2020 2020 2769 6427 3a20 302c 2027        'id': 0, '
-0009e050: 696e 6465 785f 6964 273a 2030 2c0a 2020  index_id': 0,.  
-0009e060: 2020 2020 2020 2020 2020 2020 2020 2763                'c
-0009e070: 6f6e 7374 7261 696e 745f 7479 7065 273a  onstraint_type':
-0009e080: 2027 2027 2e6a 6f69 6e28 5f72 6573 7472   ' '.join(_restr
-0009e090: 6169 6e74 5f6e 616d 655b 3a2d 315d 297d  aint_name[:-1])}
-0009e0a0: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-0009e0b0: 5f76 616c 6964 3a0a 2020 2020 2020 2020  _valid:.        
-0009e0c0: 2020 2020 6974 656d 5b27 7461 6773 275d      item['tags']
-0009e0d0: 203d 205b 5d0a 0a20 2020 2020 2020 2069   = []..        i
-0009e0e0: 6620 7365 6c66 2e5f 5f63 7572 5f73 7562  f self.__cur_sub
-0009e0f0: 7479 7065 203d 3d20 2764 6973 7427 3a0a  type == 'dist':.
-0009e100: 2020 2020 2020 2020 2020 2020 6974 656d              item
-0009e110: 5b27 636f 6e73 7472 6169 6e74 5f73 7562  ['constraint_sub
-0009e120: 7375 6274 7970 6527 5d20 3d20 2773 696d  subtype'] = 'sim
-0009e130: 706c 6527 0a20 2020 2020 2020 2020 2020  ple'.           
-0009e140: 2069 6620 636f 6e73 7472 6169 6e74 5479   if constraintTy
-0009e150: 7065 2069 7320 4e6f 6e65 3a0a 2020 2020  pe is None:.    
-0009e160: 2020 2020 2020 2020 2020 2020 6974 656d              item
-0009e170: 5b27 4e4f 455f 6469 7374 5f61 7665 7261  ['NOE_dist_avera
-0009e180: 6769 6e67 5f6d 6574 686f 6427 5d20 3d20  ging_method'] = 
-0009e190: 7365 6c66 2e6e 6f65 4176 6572 6167 650a  self.noeAverage.
-0009e1a0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-0009e1b0: 2027 524f 4527 2069 6e20 636f 6e73 7472   'ROE' in constr
-0009e1c0: 6169 6e74 5479 7065 3a0a 2020 2020 2020  aintType:.      
-0009e1d0: 2020 2020 2020 2020 2020 6974 656d 5b27            item['
-0009e1e0: 524f 455f 6469 7374 5f61 7665 7261 6769  ROE_dist_averagi
-0009e1f0: 6e67 5f6d 6574 686f 6427 5d20 3d20 7365  ng_method'] = se
-0009e200: 6c66 2e6e 6f65 4176 6572 6167 650a 0a20  lf.noeAverage.. 
-0009e210: 2020 2020 2020 2073 656c 662e 5f5f 6c61         self.__la
-0009e220: 7374 5366 4469 6374 5b73 656c 662e 5f5f  stSfDict[self.__
-0009e230: 6375 725f 7375 6274 7970 655d 203d 2069  cur_subtype] = i
-0009e240: 7465 6d0a 0a20 2020 2020 2020 2073 656c  tem..        sel
-0009e250: 662e 7366 4469 6374 5b6b 6579 5d2e 6170  f.sfDict[key].ap
-0009e260: 7065 6e64 2869 7465 6d29 0a0a 2020 2020  pend(item)..    
-0009e270: 6465 6620 5f5f 6765 7453 6628 7365 6c66  def __getSf(self
-0009e280: 2c20 636f 6e73 7472 6169 6e74 5479 7065  , constraintType
-0009e290: 3d4e 6f6e 652c 2070 6f74 656e 7469 616c  =None, potential
-0009e2a0: 5479 7065 3d4e 6f6e 652c 2072 6463 436f  Type=None, rdcCo
-0009e2b0: 6465 3d4e 6f6e 652c 0a20 2020 2020 2020  de=None,.       
-0009e2c0: 2020 2020 2020 2020 2061 6c69 676e 4365           alignCe
-0009e2d0: 6e74 6572 3d4e 6f6e 6529 3a0a 2020 2020  nter=None):.    
-0009e2e0: 2020 2020 6b65 7920 3d20 2873 656c 662e      key = (self.
-0009e2f0: 5f5f 6375 725f 7375 6274 7970 652c 2063  __cur_subtype, c
-0009e300: 6f6e 7374 7261 696e 7454 7970 652c 2070  onstraintType, p
-0009e310: 6f74 656e 7469 616c 5479 7065 2c20 7264  otentialType, rd
-0009e320: 6343 6f64 652c 204e 6f6e 6520 6966 2061  cCode, None if a
-0009e330: 6c69 676e 4365 6e74 6572 2069 7320 4e6f  lignCenter is No
-0009e340: 6e65 2065 6c73 6520 7374 7228 616c 6967  ne else str(alig
-0009e350: 6e43 656e 7465 7229 290a 0a20 2020 2020  nCenter))..     
-0009e360: 2020 2069 6620 6b65 7920 6e6f 7420 696e     if key not in
-0009e370: 2073 656c 662e 7366 4469 6374 3a0a 2020   self.sfDict:.  
-0009e380: 2020 2020 2020 2020 2020 7265 706c 6163            replac
-0009e390: 6564 203d 2046 616c 7365 0a20 2020 2020  ed = False.     
-0009e3a0: 2020 2020 2020 2069 6620 706f 7465 6e74         if potent
-0009e3b0: 6961 6c54 7970 6520 6973 206e 6f74 204e  ialType is not N
-0009e3c0: 6f6e 6520 6f72 2072 6463 436f 6465 2069  one or rdcCode i
-0009e3d0: 7320 6e6f 7420 4e6f 6e65 206f 7220 616c  s not None or al
-0009e3e0: 6967 6e43 656e 7465 7220 6973 206e 6f74  ignCenter is not
-0009e3f0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-0009e400: 2020 2020 2020 206f 6c64 5f6b 6579 203d         old_key =
-0009e410: 2028 7365 6c66 2e5f 5f63 7572 5f73 7562   (self.__cur_sub
-0009e420: 7479 7065 2c20 7365 6c66 2e5f 5f63 7572  type, self.__cur
-0009e430: 5f63 6f6e 7374 7261 696e 745f 7479 7065  _constraint_type
-0009e440: 2c20 4e6f 6e65 2c20 4e6f 6e65 2c20 4e6f  , None, None, No
-0009e450: 6e65 290a 2020 2020 2020 2020 2020 2020  ne).            
-0009e460: 2020 2020 6966 206f 6c64 5f6b 6579 2069      if old_key i
-0009e470: 6e20 7365 6c66 2e73 6644 6963 743a 0a20  n self.sfDict:. 
-0009e480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009e490: 2020 2072 6570 6c61 6365 6420 3d20 5472     replaced = Tr
-0009e4a0: 7565 0a20 2020 2020 2020 2020 2020 2020  ue.             
-0009e4b0: 2020 2020 2020 2073 656c 662e 7366 4469         self.sfDi
-0009e4c0: 6374 5b6b 6579 5d20 3d20 5b73 656c 662e  ct[key] = [self.
-0009e4d0: 7366 4469 6374 5b6f 6c64 5f6b 6579 5d2e  sfDict[old_key].
-0009e4e0: 706f 7028 2d31 295d 0a20 2020 2020 2020  pop(-1)].       
-0009e4f0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0009e500: 6c65 6e28 7365 6c66 2e73 6644 6963 745b  len(self.sfDict[
-0009e510: 6f6c 645f 6b65 795d 2920 3d3d 2030 3a0a  old_key]) == 0:.
-0009e520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009e530: 2020 2020 2020 2020 6465 6c20 7365 6c66          del self
-0009e540: 2e73 6644 6963 745b 6f6c 645f 6b65 795d  .sfDict[old_key]
-0009e550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0009e560: 2020 2020 2073 6620 3d20 7365 6c66 2e73       sf = self.s
-0009e570: 6644 6963 745b 6b65 795d 5b2d 315d 5b27  fDict[key][-1]['
-0009e580: 7361 7665 6672 616d 6527 5d0a 2020 2020  saveframe'].    
-0009e590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009e5a0: 6964 7820 3d20 6e65 7874 2828 6964 7820  idx = next((idx 
-0009e5b0: 666f 7220 6964 782c 2074 2069 6e20 656e  for idx, t in en
-0009e5c0: 756d 6572 6174 6528 7366 2e74 6167 7329  umerate(sf.tags)
-0009e5d0: 2069 6620 745b 305d 203d 3d20 2750 6f74   if t[0] == 'Pot
-0009e5e0: 656e 7469 616c 5f74 7970 6527 292c 202d  ential_type'), -
-0009e5f0: 3129 0a20 2020 2020 2020 2020 2020 2020  1).             
-0009e600: 2020 2020 2020 2069 6620 6964 7820 213d         if idx !=
-0009e610: 202d 313a 0a20 2020 2020 2020 2020 2020   -1:.           
-0009e620: 2020 2020 2020 2020 2020 2020 2073 662e               sf.
-0009e630: 7461 6773 5b69 6478 5d5b 315d 203d 2070  tags[idx][1] = p
-0009e640: 6f74 656e 7469 616c 5479 7065 0a20 2020  otentialType.   
-0009e650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009e660: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0009e670: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0009e680: 662e 6164 645f 7461 6728 2750 6f74 656e  f.add_tag('Poten
-0009e690: 7469 616c 5f74 7970 6527 2c20 706f 7465  tial_type', pote
-0009e6a0: 6e74 6961 6c54 7970 6529 0a20 2020 2020  ntialType).     
-0009e6b0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0009e6c0: 6620 7264 6343 6f64 6520 6973 206e 6f74  f rdcCode is not
-0009e6d0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-0009e6e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0009e6f0: 6478 203d 206e 6578 7428 2869 6478 2066  dx = next((idx f
-0009e700: 6f72 2069 6478 2c20 7420 696e 2065 6e75  or idx, t in enu
-0009e710: 6d65 7261 7465 2873 662e 7461 6773 2920  merate(sf.tags) 
-0009e720: 6966 2074 5b30 5d20 3d3d 2027 4465 7461  if t[0] == 'Deta
-0009e730: 696c 7327 292c 202d 3129 0a20 2020 2020  ils'), -1).     
-0009e740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009e750: 2020 2069 6620 6964 7820 213d 202d 313a     if idx != -1:
-0009e760: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0009e770: 2020 2020 2020 2020 2020 2020 2073 662e               sf.
-0009e780: 7461 6773 5b69 6478 5d5b 315d 203d 2072  tags[idx][1] = r
-0009e790: 6463 436f 6465 0a20 2020 2020 2020 2020  dcCode.         
-0009e7a0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0009e7b0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0009e7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009e7d0: 2073 662e 6164 645f 7461 6728 2744 6574   sf.add_tag('Det
-0009e7e0: 6169 6c73 272c 2072 6463 436f 6465 290a  ails', rdcCode).
-0009e7f0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-0009e800: 6f74 2072 6570 6c61 6365 643a 0a20 2020  ot replaced:.   
-0009e810: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0009e820: 662e 5f5f 6164 6453 6628 636f 6e73 7472  f.__addSf(constr
-0009e830: 6169 6e74 5479 7065 3d63 6f6e 7374 7261  aintType=constra
-0009e840: 696e 7454 7970 652c 2070 6f74 656e 7469  intType, potenti
-0009e850: 616c 5479 7065 3d70 6f74 656e 7469 616c  alType=potential
-0009e860: 5479 7065 2c20 7264 6343 6f64 653d 7264  Type, rdcCode=rd
-0009e870: 6343 6f64 652c 0a20 2020 2020 2020 2020  cCode,.         
-0009e880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009e890: 2020 2020 616c 6967 6e43 656e 7465 723d      alignCenter=
-0009e8a0: 616c 6967 6e43 656e 7465 7229 0a0a 2020  alignCenter)..  
-0009e8b0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0009e8c0: 662e 7366 4469 6374 5b6b 6579 5d5b 2d31  f.sfDict[key][-1
-0009e8d0: 5d0a 0a20 2020 2064 6566 205f 5f74 7269  ]..    def __tri
-0009e8e0: 6d53 6657 6f4c 7028 7365 6c66 293a 0a20  mSfWoLp(self):. 
-0009e8f0: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
-0009e900: 5f63 7572 5f73 7562 7479 7065 206e 6f74  _cur_subtype not
-0009e910: 2069 6e20 7365 6c66 2e5f 5f6c 6173 7453   in self.__lastS
-0009e920: 6644 6963 743a 0a20 2020 2020 2020 2020  fDict:.         
-0009e930: 2020 2072 6574 7572 6e0a 2020 2020 2020     return.      
-0009e940: 2020 6966 2073 656c 662e 5f5f 6c61 7374    if self.__last
-0009e950: 5366 4469 6374 5b73 656c 662e 5f5f 6375  SfDict[self.__cu
-0009e960: 725f 7375 6274 7970 655d 5b27 696e 6465  r_subtype]['inde
-0009e970: 785f 6964 275d 203e 2030 3a0a 2020 2020  x_id'] > 0:.    
-0009e980: 2020 2020 2020 2020 7265 7475 726e 0a20          return. 
-0009e990: 2020 2020 2020 2066 6f72 206b 2c20 7620         for k, v 
-0009e9a0: 696e 2073 656c 662e 7366 4469 6374 2e69  in self.sfDict.i
-0009e9b0: 7465 6d73 2829 3a0a 2020 2020 2020 2020  tems():.        
-0009e9c0: 2020 2020 666f 7220 6974 656d 2069 6e20      for item in 
-0009e9d0: 7265 7665 7273 6564 2876 293a 0a20 2020  reversed(v):.   
-0009e9e0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0009e9f0: 6974 656d 203d 3d20 7365 6c66 2e5f 5f6c  item == self.__l
-0009ea00: 6173 7453 6644 6963 743a 0a20 2020 2020  astSfDict:.     
-0009ea10: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-0009ea20: 2e72 656d 6f76 6528 6974 656d 290a 2020  .remove(item).  
+0009d5a0: 7479 7065 203d 3d20 2768 7679 6373 273a  type == 'hvycs':
+0009d5b0: 0a20 2020 2020 2020 2020 2020 206b 6579  .            key
+0009d5c0: 203d 2028 7365 6c66 2e5f 5f63 7572 5f73   = (self.__cur_s
+0009d5d0: 7562 7479 7065 2c20 7365 6c66 2e68 7679  ubtype, self.hvy
+0009d5e0: 6373 5265 7374 7261 696e 7473 290a 2020  csRestraints).  
+0009d5f0: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
+0009d600: 5f5f 6375 725f 7375 6274 7970 6520 3d3d  __cur_subtype ==
+0009d610: 2027 7072 6f63 7327 3a0a 2020 2020 2020   'procs':.      
+0009d620: 2020 2020 2020 6b65 7920 3d20 2873 656c        key = (sel
+0009d630: 662e 5f5f 6375 725f 7375 6274 7970 652c  f.__cur_subtype,
+0009d640: 2073 656c 662e 7072 6f63 7352 6573 7472   self.procsRestr
+0009d650: 6169 6e74 7329 0a20 2020 2020 2020 2065  aints).        e
+0009d660: 6c69 6620 7365 6c66 2e5f 5f63 7572 5f73  lif self.__cur_s
+0009d670: 7562 7479 7065 203d 3d20 2772 616d 6127  ubtype == 'rama'
+0009d680: 3a0a 2020 2020 2020 2020 2020 2020 6b65  :.            ke
+0009d690: 7920 3d20 2873 656c 662e 5f5f 6375 725f  y = (self.__cur_
+0009d6a0: 7375 6274 7970 652c 2073 656c 662e 7261  subtype, self.ra
+0009d6b0: 6d61 5265 7374 7261 696e 7473 290a 2020  maRestraints).  
+0009d6c0: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
+0009d6d0: 5f5f 6375 725f 7375 6274 7970 6520 3d3d  __cur_subtype ==
+0009d6e0: 2027 7261 6469 273a 0a20 2020 2020 2020   'radi':.       
+0009d6f0: 2020 2020 206b 6579 203d 2028 7365 6c66       key = (self
+0009d700: 2e5f 5f63 7572 5f73 7562 7479 7065 2c20  .__cur_subtype, 
+0009d710: 7365 6c66 2e72 6164 6952 6573 7472 6169  self.radiRestrai
+0009d720: 6e74 7329 0a20 2020 2020 2020 2065 6c69  nts).        eli
+0009d730: 6620 7365 6c66 2e5f 5f63 7572 5f73 7562  f self.__cur_sub
+0009d740: 7479 7065 203d 3d20 2764 6966 6627 3a0a  type == 'diff':.
+0009d750: 2020 2020 2020 2020 2020 2020 6b65 7920              key 
+0009d760: 3d20 2873 656c 662e 5f5f 6375 725f 7375  = (self.__cur_su
+0009d770: 6274 7970 652c 2073 656c 662e 6469 6666  btype, self.diff
+0009d780: 5265 7374 7261 696e 7473 290a 2020 2020  Restraints).    
+0009d790: 2020 2020 656c 6966 2073 656c 662e 5f5f      elif self.__
+0009d7a0: 6375 725f 7375 6274 7970 6520 3d3d 2027  cur_subtype == '
+0009d7b0: 6e62 6173 6527 3a0a 2020 2020 2020 2020  nbase':.        
+0009d7c0: 2020 2020 6b65 7920 3d20 2873 656c 662e      key = (self.
+0009d7d0: 5f5f 6375 725f 7375 6274 7970 652c 2073  __cur_subtype, s
+0009d7e0: 656c 662e 6e62 6173 6552 6573 7472 6169  elf.nbaseRestrai
+0009d7f0: 6e74 7329 0a20 2020 2020 2020 2065 6c69  nts).        eli
+0009d800: 6620 7365 6c66 2e5f 5f63 7572 5f73 7562  f self.__cur_sub
+0009d810: 7479 7065 203d 3d20 2763 7361 273a 0a20  type == 'csa':. 
+0009d820: 2020 2020 2020 2020 2020 206b 6579 203d             key =
+0009d830: 2028 7365 6c66 2e5f 5f63 7572 5f73 7562   (self.__cur_sub
+0009d840: 7479 7065 2c20 7365 6c66 2e63 7361 5265  type, self.csaRe
+0009d850: 7374 7261 696e 7473 290a 2020 2020 2020  straints).      
+0009d860: 2020 2320 656c 6966 2073 656c 662e 5f5f    # elif self.__
+0009d870: 6375 725f 7375 6274 7970 6520 3d3d 2027  cur_subtype == '
+0009d880: 616e 6727 3a0a 2020 2020 2020 2020 2320  ang':.        # 
+0009d890: 2020 2020 6b65 7920 3d20 2873 656c 662e      key = (self.
+0009d8a0: 5f5f 6375 725f 7375 6274 7970 652c 2073  __cur_subtype, s
+0009d8b0: 656c 662e 616e 6752 6573 7472 6169 6e74  elf.angRestraint
+0009d8c0: 7329 0a20 2020 2020 2020 2065 6c69 6620  s).        elif 
+0009d8d0: 7365 6c66 2e5f 5f63 7572 5f73 7562 7479  self.__cur_subty
+0009d8e0: 7065 203d 3d20 2770 7265 273a 0a20 2020  pe == 'pre':.   
+0009d8f0: 2020 2020 2020 2020 206b 6579 203d 2028           key = (
+0009d900: 7365 6c66 2e5f 5f63 7572 5f73 7562 7479  self.__cur_subty
+0009d910: 7065 2c20 7365 6c66 2e70 7265 5265 7374  pe, self.preRest
+0009d920: 7261 696e 7473 290a 2020 2020 2020 2020  raints).        
+0009d930: 656c 6966 2073 656c 662e 5f5f 6375 725f  elif self.__cur_
+0009d940: 7375 6274 7970 6520 3d3d 2027 7063 7327  subtype == 'pcs'
+0009d950: 3a0a 2020 2020 2020 2020 2020 2020 6b65  :.            ke
+0009d960: 7920 3d20 2873 656c 662e 5f5f 6375 725f  y = (self.__cur_
+0009d970: 7375 6274 7970 652c 2073 656c 662e 7063  subtype, self.pc
+0009d980: 7352 6573 7472 6169 6e74 7329 0a20 2020  sRestraints).   
+0009d990: 2020 2020 2065 6c69 6620 7365 6c66 2e5f       elif self._
+0009d9a0: 5f63 7572 5f73 7562 7479 7065 203d 3d20  _cur_subtype == 
+0009d9b0: 2770 7264 6327 3a0a 2020 2020 2020 2020  'prdc':.        
+0009d9c0: 2020 2020 6b65 7920 3d20 2873 656c 662e      key = (self.
+0009d9d0: 5f5f 6375 725f 7375 6274 7970 652c 2073  __cur_subtype, s
+0009d9e0: 656c 662e 7072 6463 5265 7374 7261 696e  elf.prdcRestrain
+0009d9f0: 7473 290a 2020 2020 2020 2020 656c 6966  ts).        elif
+0009da00: 2073 656c 662e 5f5f 6375 725f 7375 6274   self.__cur_subt
+0009da10: 7970 6520 3d3d 2027 7061 6e67 273a 0a20  ype == 'pang':. 
+0009da20: 2020 2020 2020 2020 2020 206b 6579 203d             key =
+0009da30: 2028 7365 6c66 2e5f 5f63 7572 5f73 7562   (self.__cur_sub
+0009da40: 7479 7065 2c20 7365 6c66 2e70 616e 6752  type, self.pangR
+0009da50: 6573 7472 6169 6e74 7329 0a20 2020 2020  estraints).     
+0009da60: 2020 2065 6c69 6620 7365 6c66 2e5f 5f63     elif self.__c
+0009da70: 7572 5f73 7562 7479 7065 203d 3d20 2770  ur_subtype == 'p
+0009da80: 6363 7227 3a0a 2020 2020 2020 2020 2020  ccr':.          
+0009da90: 2020 6b65 7920 3d20 2873 656c 662e 5f5f    key = (self.__
+0009daa0: 6375 725f 7375 6274 7970 652c 2073 656c  cur_subtype, sel
+0009dab0: 662e 7063 6372 5265 7374 7261 696e 7473  f.pccrRestraints
+0009dac0: 290a 2020 2020 2020 2020 656c 6966 2073  ).        elif s
+0009dad0: 656c 662e 5f5f 6375 725f 7375 6274 7970  elf.__cur_subtyp
+0009dae0: 6520 3d3d 2027 6862 6f6e 6427 3a0a 2020  e == 'hbond':.  
+0009daf0: 2020 2020 2020 2020 2020 6b65 7920 3d20            key = 
+0009db00: 2873 656c 662e 5f5f 6375 725f 7375 6274  (self.__cur_subt
+0009db10: 7970 652c 2073 656c 662e 6862 6f6e 6452  ype, self.hbondR
+0009db20: 6573 7472 6169 6e74 7329 0a20 2020 2020  estraints).     
+0009db30: 2020 2065 6c69 6620 7365 6c66 2e5f 5f63     elif self.__c
+0009db40: 7572 5f73 7562 7479 7065 203d 3d20 2767  ur_subtype == 'g
+0009db50: 656f 273a 0a20 2020 2020 2020 2020 2020  eo':.           
+0009db60: 206b 6579 203d 2028 7365 6c66 2e5f 5f63   key = (self.__c
+0009db70: 7572 5f73 7562 7479 7065 2c20 7365 6c66  ur_subtype, self
+0009db80: 2e67 656f 5265 7374 7261 696e 7473 290a  .geoRestraints).
+0009db90: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0009dba0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0009dbb0: 0a0a 2020 2020 2020 2020 6966 206b 6579  ..        if key
+0009dbc0: 2069 6e20 7365 6c66 2e5f 5f72 6561 736f   in self.__reaso
+0009dbd0: 6e73 5b27 6c6f 6361 6c5f 7365 715f 7363  ns['local_seq_sc
+0009dbe0: 6865 6d65 275d 3a0a 2020 2020 2020 2020  heme']:.        
+0009dbf0: 2020 2020 7365 6c66 2e5f 5f70 7265 6665      self.__prefe
+0009dc00: 7241 7574 6853 6571 203d 2073 656c 662e  rAuthSeq = self.
+0009dc10: 5f5f 7265 6173 6f6e 735b 276c 6f63 616c  __reasons['local
+0009dc20: 5f73 6571 5f73 6368 656d 6527 5d5b 6b65  _seq_scheme'][ke
+0009dc30: 795d 0a0a 2020 2020 6465 6620 5f5f 6164  y]..    def __ad
+0009dc40: 6453 6628 7365 6c66 2c20 636f 6e73 7472  dSf(self, constr
+0009dc50: 6169 6e74 5479 7065 3d4e 6f6e 652c 2070  aintType=None, p
+0009dc60: 6f74 656e 7469 616c 5479 7065 3d4e 6f6e  otentialType=Non
+0009dc70: 652c 2072 6463 436f 6465 3d4e 6f6e 652c  e, rdcCode=None,
+0009dc80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0009dc90: 2061 6c69 676e 4365 6e74 6572 3d4e 6f6e   alignCenter=Non
+0009dca0: 6529 3a0a 2020 2020 2020 2020 636f 6e74  e):.        cont
+0009dcb0: 656e 745f 7375 6274 7970 6520 3d20 636f  ent_subtype = co
+0009dcc0: 6e74 656e 7453 7562 7479 7065 4f66 2873  ntentSubtypeOf(s
+0009dcd0: 656c 662e 5f5f 6375 725f 7375 6274 7970  elf.__cur_subtyp
+0009dce0: 6529 0a0a 2020 2020 2020 2020 6966 2063  e)..        if c
+0009dcf0: 6f6e 7465 6e74 5f73 7562 7479 7065 2069  ontent_subtype i
+0009dd00: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+0009dd10: 2020 2020 7265 7475 726e 0a0a 2020 2020      return..    
+0009dd20: 2020 2020 7365 6c66 2e5f 5f63 7572 5f63      self.__cur_c
+0009dd30: 6f6e 7374 7261 696e 745f 7479 7065 203d  onstraint_type =
+0009dd40: 2063 6f6e 7374 7261 696e 7454 7970 650a   constraintType.
+0009dd50: 0a20 2020 2020 2020 2073 656c 662e 5f5f  .        self.__
+0009dd60: 6c69 7374 4964 436f 756e 7465 7220 3d20  listIdCounter = 
+0009dd70: 696e 634c 6973 7449 6443 6f75 6e74 6572  incListIdCounter
+0009dd80: 2873 656c 662e 5f5f 6375 725f 7375 6274  (self.__cur_subt
+0009dd90: 7970 652c 2073 656c 662e 5f5f 6c69 7374  ype, self.__list
+0009dda0: 4964 436f 756e 7465 7229 0a0a 2020 2020  IdCounter)..    
+0009ddb0: 2020 2020 6b65 7920 3d20 2873 656c 662e      key = (self.
+0009ddc0: 5f5f 6375 725f 7375 6274 7970 652c 2063  __cur_subtype, c
+0009ddd0: 6f6e 7374 7261 696e 7454 7970 652c 2070  onstraintType, p
+0009dde0: 6f74 656e 7469 616c 5479 7065 2c20 7264  otentialType, rd
+0009ddf0: 6343 6f64 652c 204e 6f6e 6520 6966 2061  cCode, None if a
+0009de00: 6c69 676e 4365 6e74 6572 2069 7320 4e6f  lignCenter is No
+0009de10: 6e65 2065 6c73 6520 7374 7228 616c 6967  ne else str(alig
+0009de20: 6e43 656e 7465 7229 290a 0a20 2020 2020  nCenter))..     
+0009de30: 2020 2069 6620 7365 6c66 2e5f 5f63 7572     if self.__cur
+0009de40: 5f73 7562 7479 7065 206e 6f74 2069 6e20  _subtype not in 
+0009de50: 7365 6c66 2e73 6644 6963 743a 0a20 2020  self.sfDict:.   
+0009de60: 2020 2020 2020 2020 2073 656c 662e 7366           self.sf
+0009de70: 4469 6374 5b6b 6579 5d20 3d20 5b5d 0a0a  Dict[key] = []..
+0009de80: 2020 2020 2020 2020 6c69 7374 5f69 6420          list_id 
+0009de90: 3d20 7365 6c66 2e5f 5f6c 6973 7449 6443  = self.__listIdC
+0009dea0: 6f75 6e74 6572 5b63 6f6e 7465 6e74 5f73  ounter[content_s
+0009deb0: 7562 7479 7065 5d0a 0a20 2020 2020 2020  ubtype]..       
+0009dec0: 2063 6e73 5f63 6f6d 7061 7469 626c 655f   cns_compatible_
+0009ded0: 7479 7065 7320 3d20 5b27 6469 7374 272c  types = ['dist',
+0009dee0: 2027 6469 6865 6427 2c20 2772 6463 272c   'dihed', 'rdc',
+0009def0: 2027 706c 616e 6527 2c20 276a 636f 7570   'plane', 'jcoup
+0009df00: 272c 2027 6876 7963 7327 2c20 2770 726f  ', 'hvycs', 'pro
+0009df10: 6373 272c 2027 7261 6d61 272c 2027 6469  cs', 'rama', 'di
+0009df20: 6666 272c 2027 6e62 6173 6527 2c20 2767  ff', 'nbase', 'g
+0009df30: 656f 275d 0a0a 2020 2020 2020 2020 7265  eo']..        re
+0009df40: 7374 7261 696e 745f 6e61 6d65 203d 2067  straint_name = g
+0009df50: 6574 5265 7374 7261 696e 744e 616d 6528  etRestraintName(
+0009df60: 7365 6c66 2e5f 5f63 7572 5f73 7562 7479  self.__cur_subty
+0009df70: 7065 290a 0a20 2020 2020 2020 2073 665f  pe)..        sf_
+0009df80: 6672 616d 6563 6f64 6520 3d20 2827 5850  framecode = ('XP
+0009df90: 4c4f 522d 4e49 482f 434e 5327 2069 6620  LOR-NIH/CNS' if 
+0009dfa0: 7365 6c66 2e5f 5f72 656d 6564 6961 7465  self.__remediate
+0009dfb0: 2061 6e64 2073 656c 662e 5f5f 6375 725f   and self.__cur_
+0009dfc0: 7375 6274 7970 6520 696e 2063 6e73 5f63  subtype in cns_c
+0009dfd0: 6f6d 7061 7469 626c 655f 7479 7065 7320  ompatible_types 
+0009dfe0: 656c 7365 2027 5850 4c4f 522d 4e49 4827  else 'XPLOR-NIH'
+0009dff0: 295c 0a20 2020 2020 2020 2020 2020 202b  )\.            +
+0009e000: 2027 5f27 202b 2072 6573 7472 6169 6e74   '_' + restraint
+0009e010: 5f6e 616d 652e 7265 706c 6163 6528 2720  _name.replace(' 
+0009e020: 272c 2027 5f27 2920 2b20 6627 5f7b 6c69  ', '_') + f'_{li
+0009e030: 7374 5f69 647d 270a 0a20 2020 2020 2020  st_id}'..       
+0009e040: 2073 6620 3d20 6765 7453 6176 6566 7261   sf = getSavefra
+0009e050: 6d65 2873 656c 662e 5f5f 6375 725f 7375  me(self.__cur_su
+0009e060: 6274 7970 652c 2073 665f 6672 616d 6563  btype, sf_framec
+0009e070: 6f64 652c 206c 6973 745f 6964 2c20 7365  ode, list_id, se
+0009e080: 6c66 2e5f 5f65 6e74 7279 4964 2c20 7365  lf.__entryId, se
+0009e090: 6c66 2e5f 5f6f 7269 6769 6e61 6c46 696c  lf.__originalFil
+0009e0a0: 654e 616d 652c 0a20 2020 2020 2020 2020  eName,.         
+0009e0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009e0c0: 2063 6f6e 7374 7261 696e 7454 7970 653d   constraintType=
+0009e0d0: 636f 6e73 7472 6169 6e74 5479 7065 2c20  constraintType, 
+0009e0e0: 706f 7465 6e74 6961 6c54 7970 653d 706f  potentialType=po
+0009e0f0: 7465 6e74 6961 6c54 7970 652c 2072 6463  tentialType, rdc
+0009e100: 436f 6465 3d72 6463 436f 6465 2c0a 2020  Code=rdcCode,.  
+0009e110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009e120: 2020 2020 2020 2020 616c 6967 6e43 656e          alignCen
+0009e130: 7465 723d 616c 6967 6e43 656e 7465 7229  ter=alignCenter)
+0009e140: 0a0a 2020 2020 2020 2020 6e6f 745f 7661  ..        not_va
+0009e150: 6c69 6420 3d20 5472 7565 0a0a 2020 2020  lid = True..    
+0009e160: 2020 2020 6c70 203d 2067 6574 4c6f 6f70      lp = getLoop
+0009e170: 2873 656c 662e 5f5f 6375 725f 7375 6274  (self.__cur_subt
+0009e180: 7970 652c 2068 6173 496e 7343 6f64 653d  ype, hasInsCode=
+0009e190: 2873 656c 662e 5f5f 6175 7468 546f 496e  (self.__authToIn
+0009e1a0: 7343 6f64 6520 6973 206e 6f74 204e 6f6e  sCode is not Non
+0009e1b0: 6529 290a 2020 2020 2020 2020 6966 206e  e)).        if n
+0009e1c0: 6f74 2069 7369 6e73 7461 6e63 6528 6c70  ot isinstance(lp
+0009e1d0: 2c20 6469 6374 293a 0a20 2020 2020 2020  , dict):.       
+0009e1e0: 2020 2020 2073 662e 6164 645f 6c6f 6f70       sf.add_loop
+0009e1f0: 286c 7029 0a20 2020 2020 2020 2020 2020  (lp).           
+0009e200: 206e 6f74 5f76 616c 6964 203d 2046 616c   not_valid = Fal
+0009e210: 7365 0a0a 2020 2020 2020 2020 5f72 6573  se..        _res
+0009e220: 7472 6169 6e74 5f6e 616d 6520 3d20 7265  traint_name = re
+0009e230: 7374 7261 696e 745f 6e61 6d65 2e73 706c  straint_name.spl
+0009e240: 6974 2829 0a0a 2020 2020 2020 2020 6974  it()..        it
+0009e250: 656d 203d 207b 2766 696c 655f 7479 7065  em = {'file_type
+0009e260: 273a 2073 656c 662e 5f5f 6669 6c65 5f74  ': self.__file_t
+0009e270: 7970 652c 2027 7361 7665 6672 616d 6527  ype, 'saveframe'
+0009e280: 3a20 7366 2c20 276c 6f6f 7027 3a20 6c70  : sf, 'loop': lp
+0009e290: 2c20 276c 6973 745f 6964 273a 206c 6973  , 'list_id': lis
+0009e2a0: 745f 6964 2c0a 2020 2020 2020 2020 2020  t_id,.          
+0009e2b0: 2020 2020 2020 2769 6427 3a20 302c 2027        'id': 0, '
+0009e2c0: 696e 6465 785f 6964 273a 2030 2c0a 2020  index_id': 0,.  
+0009e2d0: 2020 2020 2020 2020 2020 2020 2020 2763                'c
+0009e2e0: 6f6e 7374 7261 696e 745f 7479 7065 273a  onstraint_type':
+0009e2f0: 2027 2027 2e6a 6f69 6e28 5f72 6573 7472   ' '.join(_restr
+0009e300: 6169 6e74 5f6e 616d 655b 3a2d 315d 297d  aint_name[:-1])}
+0009e310: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+0009e320: 5f76 616c 6964 3a0a 2020 2020 2020 2020  _valid:.        
+0009e330: 2020 2020 6974 656d 5b27 7461 6773 275d      item['tags']
+0009e340: 203d 205b 5d0a 0a20 2020 2020 2020 2069   = []..        i
+0009e350: 6620 7365 6c66 2e5f 5f63 7572 5f73 7562  f self.__cur_sub
+0009e360: 7479 7065 203d 3d20 2764 6973 7427 3a0a  type == 'dist':.
+0009e370: 2020 2020 2020 2020 2020 2020 6974 656d              item
+0009e380: 5b27 636f 6e73 7472 6169 6e74 5f73 7562  ['constraint_sub
+0009e390: 7375 6274 7970 6527 5d20 3d20 2773 696d  subtype'] = 'sim
+0009e3a0: 706c 6527 0a20 2020 2020 2020 2020 2020  ple'.           
+0009e3b0: 2069 6620 636f 6e73 7472 6169 6e74 5479   if constraintTy
+0009e3c0: 7065 2069 7320 4e6f 6e65 3a0a 2020 2020  pe is None:.    
+0009e3d0: 2020 2020 2020 2020 2020 2020 6974 656d              item
+0009e3e0: 5b27 4e4f 455f 6469 7374 5f61 7665 7261  ['NOE_dist_avera
+0009e3f0: 6769 6e67 5f6d 6574 686f 6427 5d20 3d20  ging_method'] = 
+0009e400: 7365 6c66 2e6e 6f65 4176 6572 6167 650a  self.noeAverage.
+0009e410: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+0009e420: 2027 524f 4527 2069 6e20 636f 6e73 7472   'ROE' in constr
+0009e430: 6169 6e74 5479 7065 3a0a 2020 2020 2020  aintType:.      
+0009e440: 2020 2020 2020 2020 2020 6974 656d 5b27            item['
+0009e450: 524f 455f 6469 7374 5f61 7665 7261 6769  ROE_dist_averagi
+0009e460: 6e67 5f6d 6574 686f 6427 5d20 3d20 7365  ng_method'] = se
+0009e470: 6c66 2e6e 6f65 4176 6572 6167 650a 0a20  lf.noeAverage.. 
+0009e480: 2020 2020 2020 2073 656c 662e 5f5f 6c61         self.__la
+0009e490: 7374 5366 4469 6374 5b73 656c 662e 5f5f  stSfDict[self.__
+0009e4a0: 6375 725f 7375 6274 7970 655d 203d 2069  cur_subtype] = i
+0009e4b0: 7465 6d0a 0a20 2020 2020 2020 2073 656c  tem..        sel
+0009e4c0: 662e 7366 4469 6374 5b6b 6579 5d2e 6170  f.sfDict[key].ap
+0009e4d0: 7065 6e64 2869 7465 6d29 0a0a 2020 2020  pend(item)..    
+0009e4e0: 6465 6620 5f5f 6765 7453 6628 7365 6c66  def __getSf(self
+0009e4f0: 2c20 636f 6e73 7472 6169 6e74 5479 7065  , constraintType
+0009e500: 3d4e 6f6e 652c 2070 6f74 656e 7469 616c  =None, potential
+0009e510: 5479 7065 3d4e 6f6e 652c 2072 6463 436f  Type=None, rdcCo
+0009e520: 6465 3d4e 6f6e 652c 0a20 2020 2020 2020  de=None,.       
+0009e530: 2020 2020 2020 2020 2061 6c69 676e 4365           alignCe
+0009e540: 6e74 6572 3d4e 6f6e 6529 3a0a 2020 2020  nter=None):.    
+0009e550: 2020 2020 6b65 7920 3d20 2873 656c 662e      key = (self.
+0009e560: 5f5f 6375 725f 7375 6274 7970 652c 2063  __cur_subtype, c
+0009e570: 6f6e 7374 7261 696e 7454 7970 652c 2070  onstraintType, p
+0009e580: 6f74 656e 7469 616c 5479 7065 2c20 7264  otentialType, rd
+0009e590: 6343 6f64 652c 204e 6f6e 6520 6966 2061  cCode, None if a
+0009e5a0: 6c69 676e 4365 6e74 6572 2069 7320 4e6f  lignCenter is No
+0009e5b0: 6e65 2065 6c73 6520 7374 7228 616c 6967  ne else str(alig
+0009e5c0: 6e43 656e 7465 7229 290a 0a20 2020 2020  nCenter))..     
+0009e5d0: 2020 2069 6620 6b65 7920 6e6f 7420 696e     if key not in
+0009e5e0: 2073 656c 662e 7366 4469 6374 3a0a 2020   self.sfDict:.  
+0009e5f0: 2020 2020 2020 2020 2020 7265 706c 6163            replac
+0009e600: 6564 203d 2046 616c 7365 0a20 2020 2020  ed = False.     
+0009e610: 2020 2020 2020 2069 6620 706f 7465 6e74         if potent
+0009e620: 6961 6c54 7970 6520 6973 206e 6f74 204e  ialType is not N
+0009e630: 6f6e 6520 6f72 2072 6463 436f 6465 2069  one or rdcCode i
+0009e640: 7320 6e6f 7420 4e6f 6e65 206f 7220 616c  s not None or al
+0009e650: 6967 6e43 656e 7465 7220 6973 206e 6f74  ignCenter is not
+0009e660: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0009e670: 2020 2020 2020 206f 6c64 5f6b 6579 203d         old_key =
+0009e680: 2028 7365 6c66 2e5f 5f63 7572 5f73 7562   (self.__cur_sub
+0009e690: 7479 7065 2c20 7365 6c66 2e5f 5f63 7572  type, self.__cur
+0009e6a0: 5f63 6f6e 7374 7261 696e 745f 7479 7065  _constraint_type
+0009e6b0: 2c20 4e6f 6e65 2c20 4e6f 6e65 2c20 4e6f  , None, None, No
+0009e6c0: 6e65 290a 2020 2020 2020 2020 2020 2020  ne).            
+0009e6d0: 2020 2020 6966 206f 6c64 5f6b 6579 2069      if old_key i
+0009e6e0: 6e20 7365 6c66 2e73 6644 6963 743a 0a20  n self.sfDict:. 
+0009e6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009e700: 2020 2072 6570 6c61 6365 6420 3d20 5472     replaced = Tr
+0009e710: 7565 0a20 2020 2020 2020 2020 2020 2020  ue.             
+0009e720: 2020 2020 2020 2073 656c 662e 7366 4469         self.sfDi
+0009e730: 6374 5b6b 6579 5d20 3d20 5b73 656c 662e  ct[key] = [self.
+0009e740: 7366 4469 6374 5b6f 6c64 5f6b 6579 5d2e  sfDict[old_key].
+0009e750: 706f 7028 2d31 295d 0a20 2020 2020 2020  pop(-1)].       
+0009e760: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0009e770: 6c65 6e28 7365 6c66 2e73 6644 6963 745b  len(self.sfDict[
+0009e780: 6f6c 645f 6b65 795d 2920 3d3d 2030 3a0a  old_key]) == 0:.
+0009e790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009e7a0: 2020 2020 2020 2020 6465 6c20 7365 6c66          del self
+0009e7b0: 2e73 6644 6963 745b 6f6c 645f 6b65 795d  .sfDict[old_key]
+0009e7c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0009e7d0: 2020 2020 2073 6620 3d20 7365 6c66 2e73       sf = self.s
+0009e7e0: 6644 6963 745b 6b65 795d 5b2d 315d 5b27  fDict[key][-1]['
+0009e7f0: 7361 7665 6672 616d 6527 5d0a 2020 2020  saveframe'].    
+0009e800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009e810: 6964 7820 3d20 6e65 7874 2828 6964 7820  idx = next((idx 
+0009e820: 666f 7220 6964 782c 2074 2069 6e20 656e  for idx, t in en
+0009e830: 756d 6572 6174 6528 7366 2e74 6167 7329  umerate(sf.tags)
+0009e840: 2069 6620 745b 305d 203d 3d20 2750 6f74   if t[0] == 'Pot
+0009e850: 656e 7469 616c 5f74 7970 6527 292c 202d  ential_type'), -
+0009e860: 3129 0a20 2020 2020 2020 2020 2020 2020  1).             
+0009e870: 2020 2020 2020 2069 6620 6964 7820 213d         if idx !=
+0009e880: 202d 313a 0a20 2020 2020 2020 2020 2020   -1:.           
+0009e890: 2020 2020 2020 2020 2020 2020 2073 662e               sf.
+0009e8a0: 7461 6773 5b69 6478 5d5b 315d 203d 2070  tags[idx][1] = p
+0009e8b0: 6f74 656e 7469 616c 5479 7065 0a20 2020  otentialType.   
+0009e8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009e8d0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0009e8e0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0009e8f0: 662e 6164 645f 7461 6728 2750 6f74 656e  f.add_tag('Poten
+0009e900: 7469 616c 5f74 7970 6527 2c20 706f 7465  tial_type', pote
+0009e910: 6e74 6961 6c54 7970 6529 0a20 2020 2020  ntialType).     
+0009e920: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0009e930: 6620 7264 6343 6f64 6520 6973 206e 6f74  f rdcCode is not
+0009e940: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0009e950: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0009e960: 6478 203d 206e 6578 7428 2869 6478 2066  dx = next((idx f
+0009e970: 6f72 2069 6478 2c20 7420 696e 2065 6e75  or idx, t in enu
+0009e980: 6d65 7261 7465 2873 662e 7461 6773 2920  merate(sf.tags) 
+0009e990: 6966 2074 5b30 5d20 3d3d 2027 4465 7461  if t[0] == 'Deta
+0009e9a0: 696c 7327 292c 202d 3129 0a20 2020 2020  ils'), -1).     
+0009e9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009e9c0: 2020 2069 6620 6964 7820 213d 202d 313a     if idx != -1:
+0009e9d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0009e9e0: 2020 2020 2020 2020 2020 2020 2073 662e               sf.
+0009e9f0: 7461 6773 5b69 6478 5d5b 315d 203d 2072  tags[idx][1] = r
+0009ea00: 6463 436f 6465 0a20 2020 2020 2020 2020  dcCode.         
+0009ea10: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0009ea20: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
 0009ea30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009ea40: 2020 6966 206c 656e 2876 2920 3d3d 2030    if len(v) == 0
-0009ea50: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0009ea60: 2020 2020 2020 2020 2020 6465 6c20 7365            del se
-0009ea70: 6c66 2e73 6644 6963 745b 6b5d 0a20 2020  lf.sfDict[k].   
-0009ea80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009ea90: 2073 656c 662e 5f5f 6c69 7374 4964 436f   self.__listIdCo
-0009eaa0: 756e 7465 7220 3d20 6465 634c 6973 7449  unter = decListI
-0009eab0: 6443 6f75 6e74 6572 286b 5b30 5d2c 2073  dCounter(k[0], s
-0009eac0: 656c 662e 5f5f 6c69 7374 4964 436f 756e  elf.__listIdCoun
-0009ead0: 7465 7229 0a20 2020 2020 2020 2020 2020  ter).           
-0009eae0: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
-0009eaf0: 0a20 2020 2064 6566 2067 6574 436f 6e74  .    def getCont
-0009eb00: 656e 7453 7562 7479 7065 2873 656c 6629  entSubtype(self)
-0009eb10: 3a0a 2020 2020 2020 2020 2222 2220 5265  :.        """ Re
-0009eb20: 7475 726e 2063 6f6e 7465 6e74 2073 7562  turn content sub
-0009eb30: 7479 7065 206f 6620 5850 4c4f 522d 4e49  type of XPLOR-NI
-0009eb40: 4820 4d52 2066 696c 652e 0a20 2020 2020  H MR file..     
-0009eb50: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
-0009eb60: 6966 2073 656c 662e 6469 7374 5374 6174  if self.distStat
-0009eb70: 656d 656e 7473 203d 3d20 3020 616e 6420  ements == 0 and 
-0009eb80: 7365 6c66 2e64 6973 7452 6573 7472 6169  self.distRestrai
-0009eb90: 6e74 7320 3e20 303a 0a20 2020 2020 2020  nts > 0:.       
-0009eba0: 2020 2020 2073 656c 662e 6469 7374 5374       self.distSt
-0009ebb0: 6174 656d 656e 7473 203d 2031 0a0a 2020  atements = 1..  
-0009ebc0: 2020 2020 2020 6966 2073 656c 662e 6469        if self.di
-0009ebd0: 6865 6453 7461 7465 6d65 6e74 7320 3d3d  hedStatements ==
-0009ebe0: 2030 2061 6e64 2073 656c 662e 6469 6865   0 and self.dihe
-0009ebf0: 6452 6573 7472 6169 6e74 7320 3e20 303a  dRestraints > 0:
-0009ec00: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0009ec10: 662e 6469 6865 6453 7461 7465 6d65 6e74  f.dihedStatement
-0009ec20: 7320 3d20 310a 0a20 2020 2020 2020 2069  s = 1..        i
-0009ec30: 6620 7365 6c66 2e72 6463 5374 6174 656d  f self.rdcStatem
-0009ec40: 656e 7473 203d 3d20 3020 616e 6420 7365  ents == 0 and se
-0009ec50: 6c66 2e72 6463 5265 7374 7261 696e 7473  lf.rdcRestraints
-0009ec60: 203e 2030 3a0a 2020 2020 2020 2020 2020   > 0:.          
-0009ec70: 2020 7365 6c66 2e72 6463 5374 6174 656d    self.rdcStatem
-0009ec80: 656e 7473 203d 2031 0a0a 2020 2020 2020  ents = 1..      
-0009ec90: 2020 6966 2073 656c 662e 706c 616e 6553    if self.planeS
-0009eca0: 7461 7465 6d65 6e74 7320 3d3d 2030 2061  tatements == 0 a
-0009ecb0: 6e64 2073 656c 662e 706c 616e 6552 6573  nd self.planeRes
-0009ecc0: 7472 6169 6e74 7320 3e20 303a 0a20 2020  traints > 0:.   
-0009ecd0: 2020 2020 2020 2020 2073 656c 662e 706c           self.pl
-0009ece0: 616e 6553 7461 7465 6d65 6e74 7320 3d20  aneStatements = 
-0009ecf0: 310a 0a20 2020 2020 2020 2069 6620 7365  1..        if se
-0009ed00: 6c66 2e61 6469 7374 5374 6174 656d 656e  lf.adistStatemen
-0009ed10: 7473 203d 3d20 3020 616e 6420 7365 6c66  ts == 0 and self
-0009ed20: 2e61 6469 7374 5265 7374 7261 696e 7473  .adistRestraints
-0009ed30: 203e 2030 3a0a 2020 2020 2020 2020 2020   > 0:.          
-0009ed40: 2020 7365 6c66 2e61 6469 7374 5374 6174    self.adistStat
-0009ed50: 656d 656e 7473 203d 2031 0a0a 2020 2020  ements = 1..    
-0009ed60: 2020 2020 6966 2073 656c 662e 6a63 6f75      if self.jcou
-0009ed70: 7053 7461 7465 6d65 6e74 7320 3d3d 2030  pStatements == 0
-0009ed80: 2061 6e64 2073 656c 662e 6a63 6f75 7052   and self.jcoupR
-0009ed90: 6573 7472 6169 6e74 7320 3e20 303a 0a20  estraints > 0:. 
-0009eda0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0009edb0: 6a63 6f75 7053 7461 7465 6d65 6e74 7320  jcoupStatements 
-0009edc0: 3d20 310a 0a20 2020 2020 2020 2069 6620  = 1..        if 
-0009edd0: 7365 6c66 2e68 7679 6373 5374 6174 656d  self.hvycsStatem
-0009ede0: 656e 7473 203d 3d20 3020 616e 6420 7365  ents == 0 and se
-0009edf0: 6c66 2e68 7679 6373 5265 7374 7261 696e  lf.hvycsRestrain
-0009ee00: 7473 203e 2030 3a0a 2020 2020 2020 2020  ts > 0:.        
-0009ee10: 2020 2020 7365 6c66 2e68 7679 6373 5374      self.hvycsSt
+0009ea40: 2073 662e 6164 645f 7461 6728 2744 6574   sf.add_tag('Det
+0009ea50: 6169 6c73 272c 2072 6463 436f 6465 290a  ails', rdcCode).
+0009ea60: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+0009ea70: 6f74 2072 6570 6c61 6365 643a 0a20 2020  ot replaced:.   
+0009ea80: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0009ea90: 662e 5f5f 6164 6453 6628 636f 6e73 7472  f.__addSf(constr
+0009eaa0: 6169 6e74 5479 7065 3d63 6f6e 7374 7261  aintType=constra
+0009eab0: 696e 7454 7970 652c 2070 6f74 656e 7469  intType, potenti
+0009eac0: 616c 5479 7065 3d70 6f74 656e 7469 616c  alType=potential
+0009ead0: 5479 7065 2c20 7264 6343 6f64 653d 7264  Type, rdcCode=rd
+0009eae0: 6343 6f64 652c 0a20 2020 2020 2020 2020  cCode,.         
+0009eaf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009eb00: 2020 2020 616c 6967 6e43 656e 7465 723d      alignCenter=
+0009eb10: 616c 6967 6e43 656e 7465 7229 0a0a 2020  alignCenter)..  
+0009eb20: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0009eb30: 662e 7366 4469 6374 5b6b 6579 5d5b 2d31  f.sfDict[key][-1
+0009eb40: 5d0a 0a20 2020 2064 6566 205f 5f74 7269  ]..    def __tri
+0009eb50: 6d53 6657 6f4c 7028 7365 6c66 293a 0a20  mSfWoLp(self):. 
+0009eb60: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
+0009eb70: 5f63 7572 5f73 7562 7479 7065 206e 6f74  _cur_subtype not
+0009eb80: 2069 6e20 7365 6c66 2e5f 5f6c 6173 7453   in self.__lastS
+0009eb90: 6644 6963 743a 0a20 2020 2020 2020 2020  fDict:.         
+0009eba0: 2020 2072 6574 7572 6e0a 2020 2020 2020     return.      
+0009ebb0: 2020 6966 2073 656c 662e 5f5f 6c61 7374    if self.__last
+0009ebc0: 5366 4469 6374 5b73 656c 662e 5f5f 6375  SfDict[self.__cu
+0009ebd0: 725f 7375 6274 7970 655d 5b27 696e 6465  r_subtype]['inde
+0009ebe0: 785f 6964 275d 203e 2030 3a0a 2020 2020  x_id'] > 0:.    
+0009ebf0: 2020 2020 2020 2020 7265 7475 726e 0a20          return. 
+0009ec00: 2020 2020 2020 2066 6f72 206b 2c20 7620         for k, v 
+0009ec10: 696e 2073 656c 662e 7366 4469 6374 2e69  in self.sfDict.i
+0009ec20: 7465 6d73 2829 3a0a 2020 2020 2020 2020  tems():.        
+0009ec30: 2020 2020 666f 7220 6974 656d 2069 6e20      for item in 
+0009ec40: 7265 7665 7273 6564 2876 293a 0a20 2020  reversed(v):.   
+0009ec50: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0009ec60: 6974 656d 203d 3d20 7365 6c66 2e5f 5f6c  item == self.__l
+0009ec70: 6173 7453 6644 6963 743a 0a20 2020 2020  astSfDict:.     
+0009ec80: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+0009ec90: 2e72 656d 6f76 6528 6974 656d 290a 2020  .remove(item).  
+0009eca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009ecb0: 2020 6966 206c 656e 2876 2920 3d3d 2030    if len(v) == 0
+0009ecc0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0009ecd0: 2020 2020 2020 2020 2020 6465 6c20 7365            del se
+0009ece0: 6c66 2e73 6644 6963 745b 6b5d 0a20 2020  lf.sfDict[k].   
+0009ecf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009ed00: 2073 656c 662e 5f5f 6c69 7374 4964 436f   self.__listIdCo
+0009ed10: 756e 7465 7220 3d20 6465 634c 6973 7449  unter = decListI
+0009ed20: 6443 6f75 6e74 6572 286b 5b30 5d2c 2073  dCounter(k[0], s
+0009ed30: 656c 662e 5f5f 6c69 7374 4964 436f 756e  elf.__listIdCoun
+0009ed40: 7465 7229 0a20 2020 2020 2020 2020 2020  ter).           
+0009ed50: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
+0009ed60: 0a20 2020 2064 6566 2067 6574 436f 6e74  .    def getCont
+0009ed70: 656e 7453 7562 7479 7065 2873 656c 6629  entSubtype(self)
+0009ed80: 3a0a 2020 2020 2020 2020 2222 2220 5265  :.        """ Re
+0009ed90: 7475 726e 2063 6f6e 7465 6e74 2073 7562  turn content sub
+0009eda0: 7479 7065 206f 6620 5850 4c4f 522d 4e49  type of XPLOR-NI
+0009edb0: 4820 4d52 2066 696c 652e 0a20 2020 2020  H MR file..     
+0009edc0: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+0009edd0: 6966 2073 656c 662e 6469 7374 5374 6174  if self.distStat
+0009ede0: 656d 656e 7473 203d 3d20 3020 616e 6420  ements == 0 and 
+0009edf0: 7365 6c66 2e64 6973 7452 6573 7472 6169  self.distRestrai
+0009ee00: 6e74 7320 3e20 303a 0a20 2020 2020 2020  nts > 0:.       
+0009ee10: 2020 2020 2073 656c 662e 6469 7374 5374       self.distSt
 0009ee20: 6174 656d 656e 7473 203d 2031 0a0a 2020  atements = 1..  
-0009ee30: 2020 2020 2020 6966 2073 656c 662e 7072        if self.pr
-0009ee40: 6f63 7353 7461 7465 6d65 6e74 7320 3d3d  ocsStatements ==
-0009ee50: 2030 2061 6e64 2073 656c 662e 7072 6f63   0 and self.proc
-0009ee60: 7352 6573 7472 6169 6e74 7320 3e20 303a  sRestraints > 0:
+0009ee30: 2020 2020 2020 6966 2073 656c 662e 6469        if self.di
+0009ee40: 6865 6453 7461 7465 6d65 6e74 7320 3d3d  hedStatements ==
+0009ee50: 2030 2061 6e64 2073 656c 662e 6469 6865   0 and self.dihe
+0009ee60: 6452 6573 7472 6169 6e74 7320 3e20 303a  dRestraints > 0:
 0009ee70: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0009ee80: 662e 7072 6f63 7353 7461 7465 6d65 6e74  f.procsStatement
+0009ee80: 662e 6469 6865 6453 7461 7465 6d65 6e74  f.dihedStatement
 0009ee90: 7320 3d20 310a 0a20 2020 2020 2020 2069  s = 1..        i
-0009eea0: 6620 7365 6c66 2e72 616d 6153 7461 7465  f self.ramaState
-0009eeb0: 6d65 6e74 7320 3d3d 2030 2061 6e64 2073  ments == 0 and s
-0009eec0: 656c 662e 7261 6d61 5265 7374 7261 696e  elf.ramaRestrain
-0009eed0: 7473 203e 2030 3a0a 2020 2020 2020 2020  ts > 0:.        
-0009eee0: 2020 2020 7365 6c66 2e72 616d 6153 7461      self.ramaSta
-0009eef0: 7465 6d65 6e74 7320 3d20 310a 0a20 2020  tements = 1..   
-0009ef00: 2020 2020 2069 6620 7365 6c66 2e72 6164       if self.rad
-0009ef10: 6953 7461 7465 6d65 6e74 7320 3d3d 2030  iStatements == 0
-0009ef20: 2061 6e64 2073 656c 662e 7261 6469 5265   and self.radiRe
-0009ef30: 7374 7261 696e 7473 203e 2030 3a0a 2020  straints > 0:.  
-0009ef40: 2020 2020 2020 2020 2020 7365 6c66 2e72            self.r
-0009ef50: 6164 6953 7461 7465 6d65 6e74 7320 3d20  adiStatements = 
+0009eea0: 6620 7365 6c66 2e72 6463 5374 6174 656d  f self.rdcStatem
+0009eeb0: 656e 7473 203d 3d20 3020 616e 6420 7365  ents == 0 and se
+0009eec0: 6c66 2e72 6463 5265 7374 7261 696e 7473  lf.rdcRestraints
+0009eed0: 203e 2030 3a0a 2020 2020 2020 2020 2020   > 0:.          
+0009eee0: 2020 7365 6c66 2e72 6463 5374 6174 656d    self.rdcStatem
+0009eef0: 656e 7473 203d 2031 0a0a 2020 2020 2020  ents = 1..      
+0009ef00: 2020 6966 2073 656c 662e 706c 616e 6553    if self.planeS
+0009ef10: 7461 7465 6d65 6e74 7320 3d3d 2030 2061  tatements == 0 a
+0009ef20: 6e64 2073 656c 662e 706c 616e 6552 6573  nd self.planeRes
+0009ef30: 7472 6169 6e74 7320 3e20 303a 0a20 2020  traints > 0:.   
+0009ef40: 2020 2020 2020 2020 2073 656c 662e 706c           self.pl
+0009ef50: 616e 6553 7461 7465 6d65 6e74 7320 3d20  aneStatements = 
 0009ef60: 310a 0a20 2020 2020 2020 2069 6620 7365  1..        if se
-0009ef70: 6c66 2e64 6966 6653 7461 7465 6d65 6e74  lf.diffStatement
-0009ef80: 7320 3d3d 2030 2061 6e64 2073 656c 662e  s == 0 and self.
-0009ef90: 6469 6666 5265 7374 7261 696e 7473 203e  diffRestraints >
-0009efa0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-0009efb0: 7365 6c66 2e64 6966 6653 7461 7465 6d65  self.diffStateme
-0009efc0: 6e74 7320 3d20 310a 0a20 2020 2020 2020  nts = 1..       
-0009efd0: 2069 6620 7365 6c66 2e6e 6261 7365 5374   if self.nbaseSt
-0009efe0: 6174 656d 656e 7473 203d 3d20 3020 616e  atements == 0 an
-0009eff0: 6420 7365 6c66 2e6e 6261 7365 5265 7374  d self.nbaseRest
-0009f000: 7261 696e 7473 203e 2030 3a0a 2020 2020  raints > 0:.    
-0009f010: 2020 2020 2020 2020 7365 6c66 2e6e 6261          self.nba
-0009f020: 7365 5374 6174 656d 656e 7473 203d 2031  seStatements = 1
-0009f030: 0a0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-0009f040: 662e 6373 6153 7461 7465 6d65 6e74 7320  f.csaStatements 
-0009f050: 3d3d 2030 2061 6e64 2073 656c 662e 6373  == 0 and self.cs
-0009f060: 6152 6573 7472 6169 6e74 7320 3e20 303a  aRestraints > 0:
-0009f070: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0009f080: 662e 6373 6153 7461 7465 6d65 6e74 7320  f.csaStatements 
-0009f090: 3d20 310a 0a20 2020 2020 2020 2023 2069  = 1..        # i
-0009f0a0: 6620 7365 6c66 2e61 6e67 5374 6174 656d  f self.angStatem
-0009f0b0: 656e 7473 203d 3d20 3020 616e 6420 7365  ents == 0 and se
-0009f0c0: 6c66 2e61 6e67 5265 7374 7261 696e 7473  lf.angRestraints
-0009f0d0: 203e 2030 3a0a 2020 2020 2020 2020 2320   > 0:.        # 
-0009f0e0: 2020 2020 7365 6c66 2e61 6e67 5374 6174      self.angStat
-0009f0f0: 656d 656e 7473 203d 2031 0a0a 2020 2020  ements = 1..    
-0009f100: 2020 2020 6966 2073 656c 662e 7072 6553      if self.preS
-0009f110: 7461 7465 6d65 6e74 7320 3d3d 2030 2061  tatements == 0 a
-0009f120: 6e64 2073 656c 662e 7072 6552 6573 7472  nd self.preRestr
-0009f130: 6169 6e74 7320 3e20 303a 0a20 2020 2020  aints > 0:.     
-0009f140: 2020 2020 2020 2073 656c 662e 7072 6553         self.preS
-0009f150: 7461 7465 6d65 6e74 7320 3d20 310a 0a20  tatements = 1.. 
-0009f160: 2020 2020 2020 2069 6620 7365 6c66 2e70         if self.p
-0009f170: 6373 5374 6174 656d 656e 7473 203d 3d20  csStatements == 
-0009f180: 3020 616e 6420 7365 6c66 2e70 6373 5265  0 and self.pcsRe
-0009f190: 7374 7261 696e 7473 203e 2030 3a0a 2020  straints > 0:.  
-0009f1a0: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-0009f1b0: 6373 5374 6174 656d 656e 7473 203d 2031  csStatements = 1
-0009f1c0: 0a0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-0009f1d0: 662e 7072 6463 5374 6174 656d 656e 7473  f.prdcStatements
-0009f1e0: 203d 3d20 3020 616e 6420 7365 6c66 2e70   == 0 and self.p
-0009f1f0: 7264 6352 6573 7472 6169 6e74 7320 3e20  rdcRestraints > 
-0009f200: 303a 0a20 2020 2020 2020 2020 2020 2073  0:.            s
-0009f210: 656c 662e 7072 6463 5374 6174 656d 656e  elf.prdcStatemen
-0009f220: 7473 203d 2031 0a0a 2020 2020 2020 2020  ts = 1..        
-0009f230: 6966 2073 656c 662e 7061 6e67 5374 6174  if self.pangStat
-0009f240: 656d 656e 7473 203d 3d20 3020 616e 6420  ements == 0 and 
-0009f250: 7365 6c66 2e70 616e 6752 6573 7472 6169  self.pangRestrai
-0009f260: 6e74 7320 3e20 303a 0a20 2020 2020 2020  nts > 0:.       
-0009f270: 2020 2020 2073 656c 662e 7061 6e67 5374       self.pangSt
-0009f280: 6174 656d 656e 7473 203d 2031 0a0a 2020  atements = 1..  
-0009f290: 2020 2020 2020 6966 2073 656c 662e 7063        if self.pc
-0009f2a0: 6372 5374 6174 656d 656e 7473 203d 3d20  crStatements == 
-0009f2b0: 3020 616e 6420 7365 6c66 2e70 6363 7252  0 and self.pccrR
-0009f2c0: 6573 7472 6169 6e74 7320 3e20 303a 0a20  estraints > 0:. 
-0009f2d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0009f2e0: 7063 6372 5374 6174 656d 656e 7473 203d  pccrStatements =
-0009f2f0: 2031 0a0a 2020 2020 2020 2020 6966 2073   1..        if s
-0009f300: 656c 662e 6862 6f6e 6453 7461 7465 6d65  elf.hbondStateme
-0009f310: 6e74 7320 3d3d 2030 2061 6e64 2073 656c  nts == 0 and sel
-0009f320: 662e 6862 6f6e 6452 6573 7472 6169 6e74  f.hbondRestraint
-0009f330: 7320 3e20 303a 0a20 2020 2020 2020 2020  s > 0:.         
-0009f340: 2020 2073 656c 662e 6862 6f6e 6453 7461     self.hbondSta
-0009f350: 7465 6d65 6e74 7320 3d20 310a 0a20 2020  tements = 1..   
-0009f360: 2020 2020 2069 6620 7365 6c66 2e67 656f       if self.geo
-0009f370: 5374 6174 656d 656e 7473 203d 3d20 3020  Statements == 0 
-0009f380: 616e 6420 7365 6c66 2e67 656f 5265 7374  and self.geoRest
-0009f390: 7261 696e 7473 203e 2030 3a0a 2020 2020  raints > 0:.    
-0009f3a0: 2020 2020 2020 2020 7365 6c66 2e67 656f          self.geo
-0009f3b0: 5374 6174 656d 656e 7473 203d 2031 0a0a  Statements = 1..
-0009f3c0: 2020 2020 2020 2020 636f 6e74 656e 7453          contentS
-0009f3d0: 7562 7479 7065 203d 207b 2764 6973 745f  ubtype = {'dist_
-0009f3e0: 7265 7374 7261 696e 7427 3a20 7365 6c66  restraint': self
-0009f3f0: 2e64 6973 7453 7461 7465 6d65 6e74 732c  .distStatements,
-0009f400: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0009f410: 2020 2020 2020 2020 2020 2027 6469 6865             'dihe
-0009f420: 645f 7265 7374 7261 696e 7427 3a20 7365  d_restraint': se
-0009f430: 6c66 2e64 6968 6564 5374 6174 656d 656e  lf.dihedStatemen
-0009f440: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
-0009f450: 2020 2020 2020 2020 2020 2020 2020 2772                'r
-0009f460: 6463 5f72 6573 7472 6169 6e74 273a 2073  dc_restraint': s
-0009f470: 656c 662e 7264 6353 7461 7465 6d65 6e74  elf.rdcStatement
-0009f480: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-0009f490: 2020 2020 2020 2020 2020 2020 2027 706c               'pl
-0009f4a0: 616e 655f 7265 7374 7261 696e 7427 3a20  ane_restraint': 
-0009f4b0: 7365 6c66 2e70 6c61 6e65 5374 6174 656d  self.planeStatem
-0009f4c0: 656e 7473 2c0a 2020 2020 2020 2020 2020  ents,.          
-0009f4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009f4e0: 2761 6469 7374 5f72 6573 7472 6169 6e74  'adist_restraint
-0009f4f0: 273a 2073 656c 662e 6164 6973 7453 7461  ': self.adistSta
-0009f500: 7465 6d65 6e74 732c 0a20 2020 2020 2020  tements,.       
-0009f510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009f520: 2020 2027 6a63 6f75 705f 7265 7374 7261     'jcoup_restra
-0009f530: 696e 7427 3a20 7365 6c66 2e6a 636f 7570  int': self.jcoup
-0009f540: 5374 6174 656d 656e 7473 2c0a 2020 2020  Statements,.    
-0009f550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009f560: 2020 2020 2020 2768 7679 6373 5f72 6573        'hvycs_res
-0009f570: 7472 6169 6e74 273a 2073 656c 662e 6876  traint': self.hv
-0009f580: 7963 7353 7461 7465 6d65 6e74 732c 0a20  ycsStatements,. 
-0009f590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009f5a0: 2020 2020 2020 2020 2027 7072 6f63 735f           'procs_
-0009f5b0: 7265 7374 7261 696e 7427 3a20 7365 6c66  restraint': self
-0009f5c0: 2e70 726f 6373 5374 6174 656d 656e 7473  .procsStatements
-0009f5d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0009f5e0: 2020 2020 2020 2020 2020 2020 2772 616d              'ram
-0009f5f0: 615f 7265 7374 7261 696e 7427 3a20 7365  a_restraint': se
-0009f600: 6c66 2e72 616d 6153 7461 7465 6d65 6e74  lf.ramaStatement
-0009f610: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-0009f620: 2020 2020 2020 2020 2020 2020 2027 7261               'ra
-0009f630: 6469 5f72 6573 7472 6169 6e74 273a 2073  di_restraint': s
-0009f640: 656c 662e 7261 6469 5374 6174 656d 656e  elf.radiStatemen
-0009f650: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
-0009f660: 2020 2020 2020 2020 2020 2020 2020 2764                'd
-0009f670: 6966 665f 7265 7374 7261 696e 7427 3a20  iff_restraint': 
-0009f680: 7365 6c66 2e64 6966 6653 7461 7465 6d65  self.diffStateme
-0009f690: 6e74 732c 0a20 2020 2020 2020 2020 2020  nts,.           
-0009f6a0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0009f6b0: 6e62 6173 655f 7265 7374 7261 696e 7427  nbase_restraint'
-0009f6c0: 3a20 7365 6c66 2e6e 6261 7365 5374 6174  : self.nbaseStat
-0009f6d0: 656d 656e 7473 2c0a 2020 2020 2020 2020  ements,.        
-0009f6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009f6f0: 2020 2763 7361 5f72 6573 7472 6169 6e74    'csa_restraint
-0009f700: 273a 2073 656c 662e 6373 6153 7461 7465  ': self.csaState
-0009f710: 6d65 6e74 732c 0a20 2020 2020 2020 2020  ments,.         
-0009f720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009f730: 2023 2027 616e 675f 7265 7374 7261 696e   # 'ang_restrain
-0009f740: 7427 3a20 7365 6c66 2e61 6e67 5374 6174  t': self.angStat
-0009f750: 656d 656e 7473 2c0a 2020 2020 2020 2020  ements,.        
-0009f760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009f770: 2020 2770 7265 5f72 6573 7472 6169 6e74    'pre_restraint
-0009f780: 273a 2073 656c 662e 7072 6553 7461 7465  ': self.preState
-0009f790: 6d65 6e74 732c 0a20 2020 2020 2020 2020  ments,.         
-0009f7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009f7b0: 2027 7063 735f 7265 7374 7261 696e 7427   'pcs_restraint'
-0009f7c0: 3a20 7365 6c66 2e70 6373 5374 6174 656d  : self.pcsStatem
-0009f7d0: 656e 7473 2c0a 2020 2020 2020 2020 2020  ents,.          
-0009f7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009f7f0: 2770 7264 635f 7265 7374 7261 696e 7427  'prdc_restraint'
-0009f800: 3a20 7365 6c66 2e70 7264 6353 7461 7465  : self.prdcState
-0009f810: 6d65 6e74 732c 0a20 2020 2020 2020 2020  ments,.         
-0009f820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009f830: 2027 7061 6e67 5f72 6573 7472 6169 6e74   'pang_restraint
-0009f840: 273a 2073 656c 662e 7061 6e67 5374 6174  ': self.pangStat
-0009f850: 656d 656e 7473 2c0a 2020 2020 2020 2020  ements,.        
-0009f860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009f870: 2020 2770 6363 725f 7265 7374 7261 696e    'pccr_restrain
-0009f880: 7427 3a20 7365 6c66 2e70 6363 7253 7461  t': self.pccrSta
-0009f890: 7465 6d65 6e74 732c 0a20 2020 2020 2020  tements,.       
-0009f8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009f8b0: 2020 2027 6862 6f6e 645f 7265 7374 7261     'hbond_restra
-0009f8c0: 696e 7427 3a20 7365 6c66 2e68 626f 6e64  int': self.hbond
-0009f8d0: 5374 6174 656d 656e 7473 2c0a 2020 2020  Statements,.    
-0009f8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009f8f0: 2020 2020 2020 2767 656f 5f72 6573 7472        'geo_restr
-0009f900: 6169 6e74 273a 2073 656c 662e 6765 6f53  aint': self.geoS
-0009f910: 7461 7465 6d65 6e74 730a 2020 2020 2020  tatements.      
-0009f920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009f930: 2020 2020 7d0a 0a20 2020 2020 2020 2072      }..        r
-0009f940: 6574 7572 6e20 7b6b 3a20 7620 666f 7220  eturn {k: v for 
-0009f950: 6b2c 2076 2069 6e20 636f 6e74 656e 7453  k, v in contentS
-0009f960: 7562 7479 7065 2e69 7465 6d73 2829 2069  ubtype.items() i
-0009f970: 6620 7620 3e20 307d 0a0a 2020 2020 6465  f v > 0}..    de
-0009f980: 6620 6765 7450 6f6c 796d 6572 5365 7175  f getPolymerSequ
-0009f990: 656e 6365 2873 656c 6629 3a0a 2020 2020  ence(self):.    
-0009f9a0: 2020 2020 2222 2220 5265 7475 726e 2070      """ Return p
-0009f9b0: 6f6c 796d 6572 2073 6571 7565 6e63 6520  olymer sequence 
-0009f9c0: 6f66 2058 504c 4f52 2d4e 4948 204d 5220  of XPLOR-NIH MR 
-0009f9d0: 6669 6c65 2e0a 2020 2020 2020 2020 2222  file..        ""
-0009f9e0: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
-0009f9f0: 204e 6f6e 6520 6966 2073 656c 662e 5f5f   None if self.__
-0009fa00: 706f 6c79 5365 7152 7374 2069 7320 4e6f  polySeqRst is No
-0009fa10: 6e65 206f 7220 6c65 6e28 7365 6c66 2e5f  ne or len(self._
-0009fa20: 5f70 6f6c 7953 6571 5273 7429 203d 3d20  _polySeqRst) == 
-0009fa30: 3020 656c 7365 2073 656c 662e 5f5f 706f  0 else self.__po
-0009fa40: 6c79 5365 7152 7374 0a0a 2020 2020 6465  lySeqRst..    de
-0009fa50: 6620 6765 7453 6571 7565 6e63 6541 6c69  f getSequenceAli
-0009fa60: 676e 6d65 6e74 2873 656c 6629 3a0a 2020  gnment(self):.  
-0009fa70: 2020 2020 2020 2222 2220 5265 7475 726e        """ Return
-0009fa80: 2073 6571 7565 6e63 6520 616c 6967 6e6d   sequence alignm
-0009fa90: 656e 7420 6265 7477 6565 6e20 636f 6f72  ent between coor
-0009faa0: 6469 6e61 7465 7320 616e 6420 5850 4c4f  dinates and XPLO
-0009fab0: 522d 4e49 4820 4d52 2e0a 2020 2020 2020  R-NIH MR..      
-0009fac0: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
-0009fad0: 7475 726e 204e 6f6e 6520 6966 2073 656c  turn None if sel
-0009fae0: 662e 5f5f 7365 7141 6c69 676e 2069 7320  f.__seqAlign is 
-0009faf0: 4e6f 6e65 206f 7220 6c65 6e28 7365 6c66  None or len(self
-0009fb00: 2e5f 5f73 6571 416c 6967 6e29 203d 3d20  .__seqAlign) == 
-0009fb10: 3020 656c 7365 2073 656c 662e 5f5f 7365  0 else self.__se
-0009fb20: 7141 6c69 676e 0a0a 2020 2020 6465 6620  qAlign..    def 
-0009fb30: 6765 7443 6861 696e 4173 7369 676e 6d65  getChainAssignme
-0009fb40: 6e74 2873 656c 6629 3a0a 2020 2020 2020  nt(self):.      
-0009fb50: 2020 2222 2220 5265 7475 726e 2063 6861    """ Return cha
-0009fb60: 696e 2061 7373 6967 6e6d 656e 7420 6265  in assignment be
-0009fb70: 7477 6565 6e20 636f 6f72 6469 6e61 7465  tween coordinate
-0009fb80: 7320 616e 6420 5850 4c4f 522d 4e49 4820  s and XPLOR-NIH 
-0009fb90: 4d52 2e0a 2020 2020 2020 2020 2222 220a  MR..        """.
-0009fba0: 2020 2020 2020 2020 7265 7475 726e 204e          return N
-0009fbb0: 6f6e 6520 6966 2073 656c 662e 5f5f 6368  one if self.__ch
-0009fbc0: 6169 6e41 7373 6967 6e20 6973 204e 6f6e  ainAssign is Non
-0009fbd0: 6520 6f72 206c 656e 2873 656c 662e 5f5f  e or len(self.__
-0009fbe0: 6368 6169 6e41 7373 6967 6e29 203d 3d20  chainAssign) == 
-0009fbf0: 3020 656c 7365 2073 656c 662e 5f5f 6368  0 else self.__ch
-0009fc00: 6169 6e41 7373 6967 6e0a 0a20 2020 2064  ainAssign..    d
-0009fc10: 6566 2067 6574 5265 6173 6f6e 7346 6f72  ef getReasonsFor
-0009fc20: 5265 7061 7273 696e 6728 7365 6c66 293a  Reparsing(self):
-0009fc30: 0a20 2020 2020 2020 2022 2222 2052 6574  .        """ Ret
-0009fc40: 7572 6e20 7265 6173 6f6e 7320 666f 7220  urn reasons for 
-0009fc50: 7265 2d70 6172 7369 6e67 2058 504c 4f52  re-parsing XPLOR
-0009fc60: 2d4e 4948 204d 5220 6669 6c65 2e0a 2020  -NIH MR file..  
-0009fc70: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0009fc80: 2020 7265 7475 726e 204e 6f6e 6520 6966    return None if
-0009fc90: 206c 656e 2873 656c 662e 7265 6173 6f6e   len(self.reason
-0009fca0: 7346 6f72 5265 5061 7273 696e 6729 203d  sForReParsing) =
-0009fcb0: 3d20 3020 656c 7365 2073 656c 662e 7265  = 0 else self.re
-0009fcc0: 6173 6f6e 7346 6f72 5265 5061 7273 696e  asonsForReParsin
-0009fcd0: 670a 0a20 2020 2064 6566 2067 6574 5366  g..    def getSf
-0009fce0: 4469 6374 2873 656c 6629 3a0a 2020 2020  Dict(self):.    
-0009fcf0: 2020 2020 2222 2220 5265 7475 726e 2061      """ Return a
-0009fd00: 2064 6963 7469 6f6e 6172 7920 6f66 2070   dictionary of p
-0009fd10: 796e 6d72 7374 6172 2073 6176 6566 7261  ynmrstar savefra
-0009fd20: 6d65 732e 0a20 2020 2020 2020 2022 2222  mes..        """
-0009fd30: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
-0009fd40: 7365 6c66 2e73 6644 6963 7429 203d 3d20  self.sfDict) == 
-0009fd50: 303a 0a20 2020 2020 2020 2020 2020 2072  0:.            r
-0009fd60: 6574 7572 6e20 7365 6c66 2e5f 5f6c 6973  eturn self.__lis
-0009fd70: 7449 6443 6f75 6e74 6572 2c20 4e6f 6e65  tIdCounter, None
-0009fd80: 0a20 2020 2020 2020 2069 676e 5f6b 6579  .        ign_key
-0009fd90: 7320 3d20 5b5d 0a20 2020 2020 2020 2066  s = [].        f
-0009fda0: 6f72 206b 2c20 7620 696e 2073 656c 662e  or k, v in self.
-0009fdb0: 7366 4469 6374 2e69 7465 6d73 2829 3a0a  sfDict.items():.
-0009fdc0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0009fdd0: 6974 656d 2069 6e20 7265 7665 7273 6564  item in reversed
-0009fde0: 2876 293a 0a20 2020 2020 2020 2020 2020  (v):.           
-0009fdf0: 2020 2020 2069 6620 6974 656d 5b27 696e       if item['in
-0009fe00: 6465 785f 6964 275d 203d 3d20 303a 0a20  dex_id'] == 0:. 
-0009fe10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0009fe20: 2020 2076 2e72 656d 6f76 6528 6974 656d     v.remove(item
-0009fe30: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0009fe40: 2020 2020 2020 6966 206c 656e 2876 2920        if len(v) 
-0009fe50: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
-0009fe60: 2020 2020 2020 2020 2020 2020 2020 6967                ig
-0009fe70: 6e5f 6b65 7973 2e61 7070 656e 6428 6b29  n_keys.append(k)
-0009fe80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0009fe90: 2020 2020 2073 656c 662e 5f5f 6c69 7374       self.__list
-0009fea0: 4964 436f 756e 7465 7220 3d20 6465 634c  IdCounter = decL
-0009feb0: 6973 7449 6443 6f75 6e74 6572 286b 5b30  istIdCounter(k[0
-0009fec0: 5d2c 2073 656c 662e 5f5f 6c69 7374 4964  ], self.__listId
-0009fed0: 436f 756e 7465 7229 0a20 2020 2020 2020  Counter).       
-0009fee0: 2066 6f72 206b 2069 6e20 6967 6e5f 6b65   for k in ign_ke
-0009fef0: 7973 3a0a 2020 2020 2020 2020 2020 2020  ys:.            
-0009ff00: 6465 6c20 7365 6c66 2e73 6644 6963 745b  del self.sfDict[
-0009ff10: 6b5d 0a20 2020 2020 2020 2072 6574 7572  k].        retur
-0009ff20: 6e20 7365 6c66 2e5f 5f6c 6973 7449 6443  n self.__listIdC
-0009ff30: 6f75 6e74 6572 2c20 4e6f 6e65 2069 6620  ounter, None if 
-0009ff40: 6c65 6e28 7365 6c66 2e73 6644 6963 7429  len(self.sfDict)
-0009ff50: 203d 3d20 3020 656c 7365 2073 656c 662e   == 0 else self.
-0009ff60: 7366 4469 6374 0a0a 2320 6465 6c20 5870  sfDict..# del Xp
-0009ff70: 6c6f 724d 5250 6172 7365 720a            lorMRParser.
+0009ef70: 6c66 2e61 6469 7374 5374 6174 656d 656e  lf.adistStatemen
+0009ef80: 7473 203d 3d20 3020 616e 6420 7365 6c66  ts == 0 and self
+0009ef90: 2e61 6469 7374 5265 7374 7261 696e 7473  .adistRestraints
+0009efa0: 203e 2030 3a0a 2020 2020 2020 2020 2020   > 0:.          
+0009efb0: 2020 7365 6c66 2e61 6469 7374 5374 6174    self.adistStat
+0009efc0: 656d 656e 7473 203d 2031 0a0a 2020 2020  ements = 1..    
+0009efd0: 2020 2020 6966 2073 656c 662e 6a63 6f75      if self.jcou
+0009efe0: 7053 7461 7465 6d65 6e74 7320 3d3d 2030  pStatements == 0
+0009eff0: 2061 6e64 2073 656c 662e 6a63 6f75 7052   and self.jcoupR
+0009f000: 6573 7472 6169 6e74 7320 3e20 303a 0a20  estraints > 0:. 
+0009f010: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0009f020: 6a63 6f75 7053 7461 7465 6d65 6e74 7320  jcoupStatements 
+0009f030: 3d20 310a 0a20 2020 2020 2020 2069 6620  = 1..        if 
+0009f040: 7365 6c66 2e68 7679 6373 5374 6174 656d  self.hvycsStatem
+0009f050: 656e 7473 203d 3d20 3020 616e 6420 7365  ents == 0 and se
+0009f060: 6c66 2e68 7679 6373 5265 7374 7261 696e  lf.hvycsRestrain
+0009f070: 7473 203e 2030 3a0a 2020 2020 2020 2020  ts > 0:.        
+0009f080: 2020 2020 7365 6c66 2e68 7679 6373 5374      self.hvycsSt
+0009f090: 6174 656d 656e 7473 203d 2031 0a0a 2020  atements = 1..  
+0009f0a0: 2020 2020 2020 6966 2073 656c 662e 7072        if self.pr
+0009f0b0: 6f63 7353 7461 7465 6d65 6e74 7320 3d3d  ocsStatements ==
+0009f0c0: 2030 2061 6e64 2073 656c 662e 7072 6f63   0 and self.proc
+0009f0d0: 7352 6573 7472 6169 6e74 7320 3e20 303a  sRestraints > 0:
+0009f0e0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0009f0f0: 662e 7072 6f63 7353 7461 7465 6d65 6e74  f.procsStatement
+0009f100: 7320 3d20 310a 0a20 2020 2020 2020 2069  s = 1..        i
+0009f110: 6620 7365 6c66 2e72 616d 6153 7461 7465  f self.ramaState
+0009f120: 6d65 6e74 7320 3d3d 2030 2061 6e64 2073  ments == 0 and s
+0009f130: 656c 662e 7261 6d61 5265 7374 7261 696e  elf.ramaRestrain
+0009f140: 7473 203e 2030 3a0a 2020 2020 2020 2020  ts > 0:.        
+0009f150: 2020 2020 7365 6c66 2e72 616d 6153 7461      self.ramaSta
+0009f160: 7465 6d65 6e74 7320 3d20 310a 0a20 2020  tements = 1..   
+0009f170: 2020 2020 2069 6620 7365 6c66 2e72 6164       if self.rad
+0009f180: 6953 7461 7465 6d65 6e74 7320 3d3d 2030  iStatements == 0
+0009f190: 2061 6e64 2073 656c 662e 7261 6469 5265   and self.radiRe
+0009f1a0: 7374 7261 696e 7473 203e 2030 3a0a 2020  straints > 0:.  
+0009f1b0: 2020 2020 2020 2020 2020 7365 6c66 2e72            self.r
+0009f1c0: 6164 6953 7461 7465 6d65 6e74 7320 3d20  adiStatements = 
+0009f1d0: 310a 0a20 2020 2020 2020 2069 6620 7365  1..        if se
+0009f1e0: 6c66 2e64 6966 6653 7461 7465 6d65 6e74  lf.diffStatement
+0009f1f0: 7320 3d3d 2030 2061 6e64 2073 656c 662e  s == 0 and self.
+0009f200: 6469 6666 5265 7374 7261 696e 7473 203e  diffRestraints >
+0009f210: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+0009f220: 7365 6c66 2e64 6966 6653 7461 7465 6d65  self.diffStateme
+0009f230: 6e74 7320 3d20 310a 0a20 2020 2020 2020  nts = 1..       
+0009f240: 2069 6620 7365 6c66 2e6e 6261 7365 5374   if self.nbaseSt
+0009f250: 6174 656d 656e 7473 203d 3d20 3020 616e  atements == 0 an
+0009f260: 6420 7365 6c66 2e6e 6261 7365 5265 7374  d self.nbaseRest
+0009f270: 7261 696e 7473 203e 2030 3a0a 2020 2020  raints > 0:.    
+0009f280: 2020 2020 2020 2020 7365 6c66 2e6e 6261          self.nba
+0009f290: 7365 5374 6174 656d 656e 7473 203d 2031  seStatements = 1
+0009f2a0: 0a0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+0009f2b0: 662e 6373 6153 7461 7465 6d65 6e74 7320  f.csaStatements 
+0009f2c0: 3d3d 2030 2061 6e64 2073 656c 662e 6373  == 0 and self.cs
+0009f2d0: 6152 6573 7472 6169 6e74 7320 3e20 303a  aRestraints > 0:
+0009f2e0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0009f2f0: 662e 6373 6153 7461 7465 6d65 6e74 7320  f.csaStatements 
+0009f300: 3d20 310a 0a20 2020 2020 2020 2023 2069  = 1..        # i
+0009f310: 6620 7365 6c66 2e61 6e67 5374 6174 656d  f self.angStatem
+0009f320: 656e 7473 203d 3d20 3020 616e 6420 7365  ents == 0 and se
+0009f330: 6c66 2e61 6e67 5265 7374 7261 696e 7473  lf.angRestraints
+0009f340: 203e 2030 3a0a 2020 2020 2020 2020 2320   > 0:.        # 
+0009f350: 2020 2020 7365 6c66 2e61 6e67 5374 6174      self.angStat
+0009f360: 656d 656e 7473 203d 2031 0a0a 2020 2020  ements = 1..    
+0009f370: 2020 2020 6966 2073 656c 662e 7072 6553      if self.preS
+0009f380: 7461 7465 6d65 6e74 7320 3d3d 2030 2061  tatements == 0 a
+0009f390: 6e64 2073 656c 662e 7072 6552 6573 7472  nd self.preRestr
+0009f3a0: 6169 6e74 7320 3e20 303a 0a20 2020 2020  aints > 0:.     
+0009f3b0: 2020 2020 2020 2073 656c 662e 7072 6553         self.preS
+0009f3c0: 7461 7465 6d65 6e74 7320 3d20 310a 0a20  tatements = 1.. 
+0009f3d0: 2020 2020 2020 2069 6620 7365 6c66 2e70         if self.p
+0009f3e0: 6373 5374 6174 656d 656e 7473 203d 3d20  csStatements == 
+0009f3f0: 3020 616e 6420 7365 6c66 2e70 6373 5265  0 and self.pcsRe
+0009f400: 7374 7261 696e 7473 203e 2030 3a0a 2020  straints > 0:.  
+0009f410: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+0009f420: 6373 5374 6174 656d 656e 7473 203d 2031  csStatements = 1
+0009f430: 0a0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+0009f440: 662e 7072 6463 5374 6174 656d 656e 7473  f.prdcStatements
+0009f450: 203d 3d20 3020 616e 6420 7365 6c66 2e70   == 0 and self.p
+0009f460: 7264 6352 6573 7472 6169 6e74 7320 3e20  rdcRestraints > 
+0009f470: 303a 0a20 2020 2020 2020 2020 2020 2073  0:.            s
+0009f480: 656c 662e 7072 6463 5374 6174 656d 656e  elf.prdcStatemen
+0009f490: 7473 203d 2031 0a0a 2020 2020 2020 2020  ts = 1..        
+0009f4a0: 6966 2073 656c 662e 7061 6e67 5374 6174  if self.pangStat
+0009f4b0: 656d 656e 7473 203d 3d20 3020 616e 6420  ements == 0 and 
+0009f4c0: 7365 6c66 2e70 616e 6752 6573 7472 6169  self.pangRestrai
+0009f4d0: 6e74 7320 3e20 303a 0a20 2020 2020 2020  nts > 0:.       
+0009f4e0: 2020 2020 2073 656c 662e 7061 6e67 5374       self.pangSt
+0009f4f0: 6174 656d 656e 7473 203d 2031 0a0a 2020  atements = 1..  
+0009f500: 2020 2020 2020 6966 2073 656c 662e 7063        if self.pc
+0009f510: 6372 5374 6174 656d 656e 7473 203d 3d20  crStatements == 
+0009f520: 3020 616e 6420 7365 6c66 2e70 6363 7252  0 and self.pccrR
+0009f530: 6573 7472 6169 6e74 7320 3e20 303a 0a20  estraints > 0:. 
+0009f540: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0009f550: 7063 6372 5374 6174 656d 656e 7473 203d  pccrStatements =
+0009f560: 2031 0a0a 2020 2020 2020 2020 6966 2073   1..        if s
+0009f570: 656c 662e 6862 6f6e 6453 7461 7465 6d65  elf.hbondStateme
+0009f580: 6e74 7320 3d3d 2030 2061 6e64 2073 656c  nts == 0 and sel
+0009f590: 662e 6862 6f6e 6452 6573 7472 6169 6e74  f.hbondRestraint
+0009f5a0: 7320 3e20 303a 0a20 2020 2020 2020 2020  s > 0:.         
+0009f5b0: 2020 2073 656c 662e 6862 6f6e 6453 7461     self.hbondSta
+0009f5c0: 7465 6d65 6e74 7320 3d20 310a 0a20 2020  tements = 1..   
+0009f5d0: 2020 2020 2069 6620 7365 6c66 2e67 656f       if self.geo
+0009f5e0: 5374 6174 656d 656e 7473 203d 3d20 3020  Statements == 0 
+0009f5f0: 616e 6420 7365 6c66 2e67 656f 5265 7374  and self.geoRest
+0009f600: 7261 696e 7473 203e 2030 3a0a 2020 2020  raints > 0:.    
+0009f610: 2020 2020 2020 2020 7365 6c66 2e67 656f          self.geo
+0009f620: 5374 6174 656d 656e 7473 203d 2031 0a0a  Statements = 1..
+0009f630: 2020 2020 2020 2020 636f 6e74 656e 7453          contentS
+0009f640: 7562 7479 7065 203d 207b 2764 6973 745f  ubtype = {'dist_
+0009f650: 7265 7374 7261 696e 7427 3a20 7365 6c66  restraint': self
+0009f660: 2e64 6973 7453 7461 7465 6d65 6e74 732c  .distStatements,
+0009f670: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0009f680: 2020 2020 2020 2020 2020 2027 6469 6865             'dihe
+0009f690: 645f 7265 7374 7261 696e 7427 3a20 7365  d_restraint': se
+0009f6a0: 6c66 2e64 6968 6564 5374 6174 656d 656e  lf.dihedStatemen
+0009f6b0: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
+0009f6c0: 2020 2020 2020 2020 2020 2020 2020 2772                'r
+0009f6d0: 6463 5f72 6573 7472 6169 6e74 273a 2073  dc_restraint': s
+0009f6e0: 656c 662e 7264 6353 7461 7465 6d65 6e74  elf.rdcStatement
+0009f6f0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+0009f700: 2020 2020 2020 2020 2020 2020 2027 706c               'pl
+0009f710: 616e 655f 7265 7374 7261 696e 7427 3a20  ane_restraint': 
+0009f720: 7365 6c66 2e70 6c61 6e65 5374 6174 656d  self.planeStatem
+0009f730: 656e 7473 2c0a 2020 2020 2020 2020 2020  ents,.          
+0009f740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009f750: 2761 6469 7374 5f72 6573 7472 6169 6e74  'adist_restraint
+0009f760: 273a 2073 656c 662e 6164 6973 7453 7461  ': self.adistSta
+0009f770: 7465 6d65 6e74 732c 0a20 2020 2020 2020  tements,.       
+0009f780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009f790: 2020 2027 6a63 6f75 705f 7265 7374 7261     'jcoup_restra
+0009f7a0: 696e 7427 3a20 7365 6c66 2e6a 636f 7570  int': self.jcoup
+0009f7b0: 5374 6174 656d 656e 7473 2c0a 2020 2020  Statements,.    
+0009f7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009f7d0: 2020 2020 2020 2768 7679 6373 5f72 6573        'hvycs_res
+0009f7e0: 7472 6169 6e74 273a 2073 656c 662e 6876  traint': self.hv
+0009f7f0: 7963 7353 7461 7465 6d65 6e74 732c 0a20  ycsStatements,. 
+0009f800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009f810: 2020 2020 2020 2020 2027 7072 6f63 735f           'procs_
+0009f820: 7265 7374 7261 696e 7427 3a20 7365 6c66  restraint': self
+0009f830: 2e70 726f 6373 5374 6174 656d 656e 7473  .procsStatements
+0009f840: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0009f850: 2020 2020 2020 2020 2020 2020 2772 616d              'ram
+0009f860: 615f 7265 7374 7261 696e 7427 3a20 7365  a_restraint': se
+0009f870: 6c66 2e72 616d 6153 7461 7465 6d65 6e74  lf.ramaStatement
+0009f880: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+0009f890: 2020 2020 2020 2020 2020 2020 2027 7261               'ra
+0009f8a0: 6469 5f72 6573 7472 6169 6e74 273a 2073  di_restraint': s
+0009f8b0: 656c 662e 7261 6469 5374 6174 656d 656e  elf.radiStatemen
+0009f8c0: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
+0009f8d0: 2020 2020 2020 2020 2020 2020 2020 2764                'd
+0009f8e0: 6966 665f 7265 7374 7261 696e 7427 3a20  iff_restraint': 
+0009f8f0: 7365 6c66 2e64 6966 6653 7461 7465 6d65  self.diffStateme
+0009f900: 6e74 732c 0a20 2020 2020 2020 2020 2020  nts,.           
+0009f910: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0009f920: 6e62 6173 655f 7265 7374 7261 696e 7427  nbase_restraint'
+0009f930: 3a20 7365 6c66 2e6e 6261 7365 5374 6174  : self.nbaseStat
+0009f940: 656d 656e 7473 2c0a 2020 2020 2020 2020  ements,.        
+0009f950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009f960: 2020 2763 7361 5f72 6573 7472 6169 6e74    'csa_restraint
+0009f970: 273a 2073 656c 662e 6373 6153 7461 7465  ': self.csaState
+0009f980: 6d65 6e74 732c 0a20 2020 2020 2020 2020  ments,.         
+0009f990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009f9a0: 2023 2027 616e 675f 7265 7374 7261 696e   # 'ang_restrain
+0009f9b0: 7427 3a20 7365 6c66 2e61 6e67 5374 6174  t': self.angStat
+0009f9c0: 656d 656e 7473 2c0a 2020 2020 2020 2020  ements,.        
+0009f9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009f9e0: 2020 2770 7265 5f72 6573 7472 6169 6e74    'pre_restraint
+0009f9f0: 273a 2073 656c 662e 7072 6553 7461 7465  ': self.preState
+0009fa00: 6d65 6e74 732c 0a20 2020 2020 2020 2020  ments,.         
+0009fa10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009fa20: 2027 7063 735f 7265 7374 7261 696e 7427   'pcs_restraint'
+0009fa30: 3a20 7365 6c66 2e70 6373 5374 6174 656d  : self.pcsStatem
+0009fa40: 656e 7473 2c0a 2020 2020 2020 2020 2020  ents,.          
+0009fa50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009fa60: 2770 7264 635f 7265 7374 7261 696e 7427  'prdc_restraint'
+0009fa70: 3a20 7365 6c66 2e70 7264 6353 7461 7465  : self.prdcState
+0009fa80: 6d65 6e74 732c 0a20 2020 2020 2020 2020  ments,.         
+0009fa90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009faa0: 2027 7061 6e67 5f72 6573 7472 6169 6e74   'pang_restraint
+0009fab0: 273a 2073 656c 662e 7061 6e67 5374 6174  ': self.pangStat
+0009fac0: 656d 656e 7473 2c0a 2020 2020 2020 2020  ements,.        
+0009fad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009fae0: 2020 2770 6363 725f 7265 7374 7261 696e    'pccr_restrain
+0009faf0: 7427 3a20 7365 6c66 2e70 6363 7253 7461  t': self.pccrSta
+0009fb00: 7465 6d65 6e74 732c 0a20 2020 2020 2020  tements,.       
+0009fb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009fb20: 2020 2027 6862 6f6e 645f 7265 7374 7261     'hbond_restra
+0009fb30: 696e 7427 3a20 7365 6c66 2e68 626f 6e64  int': self.hbond
+0009fb40: 5374 6174 656d 656e 7473 2c0a 2020 2020  Statements,.    
+0009fb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009fb60: 2020 2020 2020 2767 656f 5f72 6573 7472        'geo_restr
+0009fb70: 6169 6e74 273a 2073 656c 662e 6765 6f53  aint': self.geoS
+0009fb80: 7461 7465 6d65 6e74 730a 2020 2020 2020  tatements.      
+0009fb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0009fba0: 2020 2020 7d0a 0a20 2020 2020 2020 2072      }..        r
+0009fbb0: 6574 7572 6e20 7b6b 3a20 7620 666f 7220  eturn {k: v for 
+0009fbc0: 6b2c 2076 2069 6e20 636f 6e74 656e 7453  k, v in contentS
+0009fbd0: 7562 7479 7065 2e69 7465 6d73 2829 2069  ubtype.items() i
+0009fbe0: 6620 7620 3e20 307d 0a0a 2020 2020 6465  f v > 0}..    de
+0009fbf0: 6620 6765 7450 6f6c 796d 6572 5365 7175  f getPolymerSequ
+0009fc00: 656e 6365 2873 656c 6629 3a0a 2020 2020  ence(self):.    
+0009fc10: 2020 2020 2222 2220 5265 7475 726e 2070      """ Return p
+0009fc20: 6f6c 796d 6572 2073 6571 7565 6e63 6520  olymer sequence 
+0009fc30: 6f66 2058 504c 4f52 2d4e 4948 204d 5220  of XPLOR-NIH MR 
+0009fc40: 6669 6c65 2e0a 2020 2020 2020 2020 2222  file..        ""
+0009fc50: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+0009fc60: 204e 6f6e 6520 6966 2073 656c 662e 5f5f   None if self.__
+0009fc70: 706f 6c79 5365 7152 7374 2069 7320 4e6f  polySeqRst is No
+0009fc80: 6e65 206f 7220 6c65 6e28 7365 6c66 2e5f  ne or len(self._
+0009fc90: 5f70 6f6c 7953 6571 5273 7429 203d 3d20  _polySeqRst) == 
+0009fca0: 3020 656c 7365 2073 656c 662e 5f5f 706f  0 else self.__po
+0009fcb0: 6c79 5365 7152 7374 0a0a 2020 2020 6465  lySeqRst..    de
+0009fcc0: 6620 6765 7453 6571 7565 6e63 6541 6c69  f getSequenceAli
+0009fcd0: 676e 6d65 6e74 2873 656c 6629 3a0a 2020  gnment(self):.  
+0009fce0: 2020 2020 2020 2222 2220 5265 7475 726e        """ Return
+0009fcf0: 2073 6571 7565 6e63 6520 616c 6967 6e6d   sequence alignm
+0009fd00: 656e 7420 6265 7477 6565 6e20 636f 6f72  ent between coor
+0009fd10: 6469 6e61 7465 7320 616e 6420 5850 4c4f  dinates and XPLO
+0009fd20: 522d 4e49 4820 4d52 2e0a 2020 2020 2020  R-NIH MR..      
+0009fd30: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
+0009fd40: 7475 726e 204e 6f6e 6520 6966 2073 656c  turn None if sel
+0009fd50: 662e 5f5f 7365 7141 6c69 676e 2069 7320  f.__seqAlign is 
+0009fd60: 4e6f 6e65 206f 7220 6c65 6e28 7365 6c66  None or len(self
+0009fd70: 2e5f 5f73 6571 416c 6967 6e29 203d 3d20  .__seqAlign) == 
+0009fd80: 3020 656c 7365 2073 656c 662e 5f5f 7365  0 else self.__se
+0009fd90: 7141 6c69 676e 0a0a 2020 2020 6465 6620  qAlign..    def 
+0009fda0: 6765 7443 6861 696e 4173 7369 676e 6d65  getChainAssignme
+0009fdb0: 6e74 2873 656c 6629 3a0a 2020 2020 2020  nt(self):.      
+0009fdc0: 2020 2222 2220 5265 7475 726e 2063 6861    """ Return cha
+0009fdd0: 696e 2061 7373 6967 6e6d 656e 7420 6265  in assignment be
+0009fde0: 7477 6565 6e20 636f 6f72 6469 6e61 7465  tween coordinate
+0009fdf0: 7320 616e 6420 5850 4c4f 522d 4e49 4820  s and XPLOR-NIH 
+0009fe00: 4d52 2e0a 2020 2020 2020 2020 2222 220a  MR..        """.
+0009fe10: 2020 2020 2020 2020 7265 7475 726e 204e          return N
+0009fe20: 6f6e 6520 6966 2073 656c 662e 5f5f 6368  one if self.__ch
+0009fe30: 6169 6e41 7373 6967 6e20 6973 204e 6f6e  ainAssign is Non
+0009fe40: 6520 6f72 206c 656e 2873 656c 662e 5f5f  e or len(self.__
+0009fe50: 6368 6169 6e41 7373 6967 6e29 203d 3d20  chainAssign) == 
+0009fe60: 3020 656c 7365 2073 656c 662e 5f5f 6368  0 else self.__ch
+0009fe70: 6169 6e41 7373 6967 6e0a 0a20 2020 2064  ainAssign..    d
+0009fe80: 6566 2067 6574 5265 6173 6f6e 7346 6f72  ef getReasonsFor
+0009fe90: 5265 7061 7273 696e 6728 7365 6c66 293a  Reparsing(self):
+0009fea0: 0a20 2020 2020 2020 2022 2222 2052 6574  .        """ Ret
+0009feb0: 7572 6e20 7265 6173 6f6e 7320 666f 7220  urn reasons for 
+0009fec0: 7265 2d70 6172 7369 6e67 2058 504c 4f52  re-parsing XPLOR
+0009fed0: 2d4e 4948 204d 5220 6669 6c65 2e0a 2020  -NIH MR file..  
+0009fee0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0009fef0: 2020 7265 7475 726e 204e 6f6e 6520 6966    return None if
+0009ff00: 206c 656e 2873 656c 662e 7265 6173 6f6e   len(self.reason
+0009ff10: 7346 6f72 5265 5061 7273 696e 6729 203d  sForReParsing) =
+0009ff20: 3d20 3020 656c 7365 2073 656c 662e 7265  = 0 else self.re
+0009ff30: 6173 6f6e 7346 6f72 5265 5061 7273 696e  asonsForReParsin
+0009ff40: 670a 0a20 2020 2064 6566 2067 6574 5366  g..    def getSf
+0009ff50: 4469 6374 2873 656c 6629 3a0a 2020 2020  Dict(self):.    
+0009ff60: 2020 2020 2222 2220 5265 7475 726e 2061      """ Return a
+0009ff70: 2064 6963 7469 6f6e 6172 7920 6f66 2070   dictionary of p
+0009ff80: 796e 6d72 7374 6172 2073 6176 6566 7261  ynmrstar savefra
+0009ff90: 6d65 732e 0a20 2020 2020 2020 2022 2222  mes..        """
+0009ffa0: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+0009ffb0: 7365 6c66 2e73 6644 6963 7429 203d 3d20  self.sfDict) == 
+0009ffc0: 303a 0a20 2020 2020 2020 2020 2020 2072  0:.            r
+0009ffd0: 6574 7572 6e20 7365 6c66 2e5f 5f6c 6973  eturn self.__lis
+0009ffe0: 7449 6443 6f75 6e74 6572 2c20 4e6f 6e65  tIdCounter, None
+0009fff0: 0a20 2020 2020 2020 2069 676e 5f6b 6579  .        ign_key
+000a0000: 7320 3d20 5b5d 0a20 2020 2020 2020 2066  s = [].        f
+000a0010: 6f72 206b 2c20 7620 696e 2073 656c 662e  or k, v in self.
+000a0020: 7366 4469 6374 2e69 7465 6d73 2829 3a0a  sfDict.items():.
+000a0030: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+000a0040: 6974 656d 2069 6e20 7265 7665 7273 6564  item in reversed
+000a0050: 2876 293a 0a20 2020 2020 2020 2020 2020  (v):.           
+000a0060: 2020 2020 2069 6620 6974 656d 5b27 696e       if item['in
+000a0070: 6465 785f 6964 275d 203d 3d20 303a 0a20  dex_id'] == 0:. 
+000a0080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000a0090: 2020 2076 2e72 656d 6f76 6528 6974 656d     v.remove(item
+000a00a0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000a00b0: 2020 2020 2020 6966 206c 656e 2876 2920        if len(v) 
+000a00c0: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
+000a00d0: 2020 2020 2020 2020 2020 2020 2020 6967                ig
+000a00e0: 6e5f 6b65 7973 2e61 7070 656e 6428 6b29  n_keys.append(k)
+000a00f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000a0100: 2020 2020 2073 656c 662e 5f5f 6c69 7374       self.__list
+000a0110: 4964 436f 756e 7465 7220 3d20 6465 634c  IdCounter = decL
+000a0120: 6973 7449 6443 6f75 6e74 6572 286b 5b30  istIdCounter(k[0
+000a0130: 5d2c 2073 656c 662e 5f5f 6c69 7374 4964  ], self.__listId
+000a0140: 436f 756e 7465 7229 0a20 2020 2020 2020  Counter).       
+000a0150: 2066 6f72 206b 2069 6e20 6967 6e5f 6b65   for k in ign_ke
+000a0160: 7973 3a0a 2020 2020 2020 2020 2020 2020  ys:.            
+000a0170: 6465 6c20 7365 6c66 2e73 6644 6963 745b  del self.sfDict[
+000a0180: 6b5d 0a20 2020 2020 2020 2072 6574 7572  k].        retur
+000a0190: 6e20 7365 6c66 2e5f 5f6c 6973 7449 6443  n self.__listIdC
+000a01a0: 6f75 6e74 6572 2c20 4e6f 6e65 2069 6620  ounter, None if 
+000a01b0: 6c65 6e28 7365 6c66 2e73 6644 6963 7429  len(self.sfDict)
+000a01c0: 203d 3d20 3020 656c 7365 2073 656c 662e   == 0 else self.
+000a01d0: 7366 4469 6374 0a0a 2320 6465 6c20 5870  sfDict..# del Xp
+000a01e0: 6c6f 724d 5250 6172 7365 720a            lorMRParser.
```

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/mr/XplorMRReader.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/mr/XplorMRReader.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb/utils/nmr/rci/RCI.py` & `wwpdb.utils.nmr-0.26.1/wwpdb/utils/nmr/rci/RCI.py`

 * *Files identical despite different names*

### Comparing `wwpdb.utils.nmr-0.26/wwpdb.utils.nmr.egg-info/PKG-INFO` & `wwpdb.utils.nmr-0.26.1/wwpdb.utils.nmr.egg-info/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: wwpdb.utils.nmr
-Version: 0.26
+Version: 0.26.1
 Summary: wwPDB NMR utilities
 Home-page: https://github.com/wwpdb/py-wwpdb_utils_nmr
 Author: Ezra Peisach
 Author-email: ezra.peisach@rcsb.org
 License: Apache 2.0
 Classifier: Development Status :: 3 - Alpha
 Classifier: Intended Audience :: Developers
```

### Comparing `wwpdb.utils.nmr-0.26/wwpdb.utils.nmr.egg-info/SOURCES.txt` & `wwpdb.utils.nmr-0.26.1/wwpdb.utils.nmr.egg-info/SOURCES.txt`

 * *Files identical despite different names*

