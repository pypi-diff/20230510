# Comparing `tmp/rayfed_nightly-0.1.0b20230429.dev0-py3-none-any.whl.zip` & `tmp/rayfed_nightly-0.1.0b20230510.dev0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,27 +1,27 @@
-Zip file size: 38323 bytes, number of entries: 25
--rw-r--r--  2.0 unx      853 b- defN 23-Apr-29 01:23 fed/__init__.py
--rw-r--r--  2.0 unx    15904 b- defN 23-Apr-29 01:23 fed/api.py
--rw-r--r--  2.0 unx    16086 b- defN 23-Apr-29 01:23 fed/barriers.py
--rw-r--r--  2.0 unx     2933 b- defN 23-Apr-29 01:23 fed/cleanup.py
--rw-r--r--  2.0 unx     2280 b- defN 23-Apr-29 01:23 fed/config.py
--rw-r--r--  2.0 unx     2877 b- defN 23-Apr-29 01:23 fed/fed_object.py
--rw-r--r--  2.0 unx     7908 b- defN 23-Apr-29 01:23 fed/tree_util.py
--rw-r--r--  2.0 unx     5254 b- defN 23-Apr-29 01:23 fed/utils.py
--rw-r--r--  2.0 unx      581 b- defN 23-Apr-29 01:23 fed/_private/__init__.py
--rw-r--r--  2.0 unx      581 b- defN 23-Apr-29 01:23 fed/_private/api.py
--rw-r--r--  2.0 unx     4487 b- defN 23-Apr-29 01:23 fed/_private/compatible_utils.py
--rw-r--r--  2.0 unx     1268 b- defN 23-Apr-29 01:23 fed/_private/constants.py
--rw-r--r--  2.0 unx     3837 b- defN 23-Apr-29 01:23 fed/_private/fed_actor.py
--rw-r--r--  2.0 unx     3825 b- defN 23-Apr-29 01:23 fed/_private/fed_call_holder.py
--rw-r--r--  2.0 unx     1017 b- defN 23-Apr-29 01:23 fed/_private/global_context.py
--rw-r--r--  2.0 unx     2859 b- defN 23-Apr-29 01:23 fed/_private/grpc_options.py
--rw-r--r--  2.0 unx     2386 b- defN 23-Apr-29 01:23 fed/_private/serialization_utils.py
--rw-r--r--  2.0 unx      581 b- defN 23-Apr-29 01:23 fed/grpc/__init__.py
--rw-r--r--  2.0 unx     5608 b- defN 23-Apr-29 01:23 fed/grpc/fed_pb2.py
--rw-r--r--  2.0 unx     2955 b- defN 23-Apr-29 01:23 fed/grpc/fed_pb2_grpc.py
--rw-r--r--  2.0 unx    11356 b- defN 23-Apr-29 01:25 rayfed_nightly-0.1.0b20230429.dev0.dist-info/LICENSE
--rw-r--r--  2.0 unx     7243 b- defN 23-Apr-29 01:25 rayfed_nightly-0.1.0b20230429.dev0.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Apr-29 01:25 rayfed_nightly-0.1.0b20230429.dev0.dist-info/WHEEL
--rw-r--r--  2.0 unx        4 b- defN 23-Apr-29 01:25 rayfed_nightly-0.1.0b20230429.dev0.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     2053 b- defN 23-Apr-29 01:25 rayfed_nightly-0.1.0b20230429.dev0.dist-info/RECORD
-25 files, 104828 bytes uncompressed, 35025 bytes compressed:  66.6%
+Zip file size: 38249 bytes, number of entries: 25
+-rw-r--r--  2.0 unx      853 b- defN 23-May-10 01:22 fed/__init__.py
+-rw-r--r--  2.0 unx    15899 b- defN 23-May-10 01:22 fed/api.py
+-rw-r--r--  2.0 unx    14926 b- defN 23-May-10 01:22 fed/barriers.py
+-rw-r--r--  2.0 unx     2933 b- defN 23-May-10 01:22 fed/cleanup.py
+-rw-r--r--  2.0 unx     2280 b- defN 23-May-10 01:22 fed/config.py
+-rw-r--r--  2.0 unx     2877 b- defN 23-May-10 01:22 fed/fed_object.py
+-rw-r--r--  2.0 unx     7908 b- defN 23-May-10 01:22 fed/tree_util.py
+-rw-r--r--  2.0 unx     5254 b- defN 23-May-10 01:22 fed/utils.py
+-rw-r--r--  2.0 unx      581 b- defN 23-May-10 01:22 fed/_private/__init__.py
+-rw-r--r--  2.0 unx      581 b- defN 23-May-10 01:22 fed/_private/api.py
+-rw-r--r--  2.0 unx     4487 b- defN 23-May-10 01:22 fed/_private/compatible_utils.py
+-rw-r--r--  2.0 unx     1268 b- defN 23-May-10 01:22 fed/_private/constants.py
+-rw-r--r--  2.0 unx     3837 b- defN 23-May-10 01:22 fed/_private/fed_actor.py
+-rw-r--r--  2.0 unx     3825 b- defN 23-May-10 01:22 fed/_private/fed_call_holder.py
+-rw-r--r--  2.0 unx     1017 b- defN 23-May-10 01:22 fed/_private/global_context.py
+-rw-r--r--  2.0 unx     2859 b- defN 23-May-10 01:22 fed/_private/grpc_options.py
+-rw-r--r--  2.0 unx     2386 b- defN 23-May-10 01:22 fed/_private/serialization_utils.py
+-rw-r--r--  2.0 unx      581 b- defN 23-May-10 01:22 fed/grpc/__init__.py
+-rw-r--r--  2.0 unx     5608 b- defN 23-May-10 01:22 fed/grpc/fed_pb2.py
+-rw-r--r--  2.0 unx     2955 b- defN 23-May-10 01:22 fed/grpc/fed_pb2_grpc.py
+-rw-r--r--  2.0 unx    11356 b- defN 23-May-10 01:24 rayfed_nightly-0.1.0b20230510.dev0.dist-info/LICENSE
+-rw-r--r--  2.0 unx     7243 b- defN 23-May-10 01:24 rayfed_nightly-0.1.0b20230510.dev0.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-May-10 01:24 rayfed_nightly-0.1.0b20230510.dev0.dist-info/WHEEL
+-rw-r--r--  2.0 unx        4 b- defN 23-May-10 01:24 rayfed_nightly-0.1.0b20230510.dev0.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     2053 b- defN 23-May-10 01:24 rayfed_nightly-0.1.0b20230510.dev0.dist-info/RECORD
+25 files, 103663 bytes uncompressed, 34951 bytes compressed:  66.3%
```

## zipnote {}

```diff
@@ -54,23 +54,23 @@
 
 Filename: fed/grpc/fed_pb2.py
 Comment: 
 
 Filename: fed/grpc/fed_pb2_grpc.py
 Comment: 
 
-Filename: rayfed_nightly-0.1.0b20230429.dev0.dist-info/LICENSE
+Filename: rayfed_nightly-0.1.0b20230510.dev0.dist-info/LICENSE
 Comment: 
 
-Filename: rayfed_nightly-0.1.0b20230429.dev0.dist-info/METADATA
+Filename: rayfed_nightly-0.1.0b20230510.dev0.dist-info/METADATA
 Comment: 
 
-Filename: rayfed_nightly-0.1.0b20230429.dev0.dist-info/WHEEL
+Filename: rayfed_nightly-0.1.0b20230510.dev0.dist-info/WHEEL
 Comment: 
 
-Filename: rayfed_nightly-0.1.0b20230429.dev0.dist-info/top_level.txt
+Filename: rayfed_nightly-0.1.0b20230510.dev0.dist-info/top_level.txt
 Comment: 
 
-Filename: rayfed_nightly-0.1.0b20230429.dev0.dist-info/RECORD
+Filename: rayfed_nightly-0.1.0b20230510.dev0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## fed/api.py

```diff
@@ -215,15 +215,15 @@
         tls_config=tls_config,
         retry_policy=cross_silo_grpc_retry_policy,
         max_retries=cross_silo_send_max_retries,
     )
 
     if enable_waiting_for_other_parties_ready:
         # TODO(zhouaihui): can be removed after we have a better retry strategy.
-        ping_others(cluster=cluster, self_party=party, tls_config=tls_config)
+        ping_others(cluster=cluster, self_party=party, max_retries=3600)
 
 
 def shutdown():
     """
     Shutdown a RayFed client.
     """
     wait_sending()
```

## fed/barriers.py

```diff
@@ -417,67 +417,33 @@
 
 def recv(party: str, src_party: str, upstream_seq_id, curr_seq_id):
     assert party, 'Party can not be None.'
     receiver_proxy = ray.get_actor(f"RecverProxyActor-{party}")
     return receiver_proxy.get_data.remote(src_party, upstream_seq_id, curr_seq_id)
 
 
-def _grpc_ping(party: str, dest: str, tls_config: Dict) -> bool:
-    try:
-        if tls_config:
-            ca_cert, private_key, cert_chain = fed_utils.load_cert_config(tls_config)
-            credentials = grpc.ssl_channel_credentials(
-                certificate_chain=cert_chain,
-                private_key=private_key,
-                root_certificates=ca_cert,
-            )
-
-            with grpc.secure_channel(
-                dest,
-                credentials,
-            ) as channel:
-                stub = fed_pb2_grpc.GrpcServiceStub(channel)
-                request = fed_pb2.SendDataRequest(
-                    data=b'ping',
-                    upstream_seq_id='ping',
-                    downstream_seq_id='ping',
-                )
-                response = stub.SendData(request)
-        else:
-            with grpc.insecure_channel(dest) as channel:
-                stub = fed_pb2_grpc.GrpcServiceStub(channel)
-                request = fed_pb2.SendDataRequest(
-                    data=b'ping',
-                    upstream_seq_id='ping',
-                    downstream_seq_id='ping',
-                )
-                response = stub.SendData(request)
-        logger.info(
-            f'Succeeded to ping {party} on {dest}, the result: {response.result}.'
-        )
-        return True
-    except Exception as e:
-        logger.info(
-            f'Failed to ping {party} on {dest}, this could be normal, '
-            f'the possible reason is {party} has not yet started.'
-        )
-        logger.debug(f'Ping error: {e}')
-        return False
-
-
-def ping_others(cluster: Dict[str, Dict], self_party: str, tls_config: Dict):
+def ping_others(cluster: Dict[str, Dict], self_party: str, max_retries=3600):
     """Ping other parties until all are ready or timeout."""
     others = [party for party in cluster if not party == self_party]
-    max_retries = 3600
     tried = 0
+
     while tried < max_retries and others:
         logger.info(
             f'Try ping {others} at {tried} attemp, up to {max_retries} attemps.'
         )
         tried += 1
-        others[:] = [
-            other
-            for other in others
-            if not _grpc_ping(other, cluster[other]['address'], tls_config)
+        _party_ping_obj = {}  # {$party_name: $ObjectRef}
+        # Batch ping all the other parties
+        for other in others:
+            _party_ping_obj[other] = send(other, b'data', 'ping', 'ping')
+        _, _unready = ray.wait(list(_party_ping_obj.values()), timeout=1)
+
+        # Keep the unready party for the next ping.
+        others = [
+            other for other in others if _party_ping_obj[other] in _unready
         ]
         if others:
             time.sleep(2)
+    if others:
+        raise RuntimeError(f"Failed to wait for parties: {others} to start, "
+                           "abort `fed.init`.")
+    return True
```

## Comparing `rayfed_nightly-0.1.0b20230429.dev0.dist-info/LICENSE` & `rayfed_nightly-0.1.0b20230510.dev0.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `rayfed_nightly-0.1.0b20230429.dev0.dist-info/METADATA` & `rayfed_nightly-0.1.0b20230510.dev0.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: rayfed-nightly
-Version: 0.1.0b20230429.dev0
+Version: 0.1.0b20230510.dev0
 Summary: A multiple parties joint, distributed execution engine based on Ray,to help build your own federated learning frameworks in minutes.
 Home-page: https://github.com/ray-project/rayfed
 Author: RayFed Team
 Author-email: rayfed-dev@googlegroups.com
 License: Apache 2.0
 Platform: UNKNOWN
 Description-Content-Type: text/markdown
```

## Comparing `rayfed_nightly-0.1.0b20230429.dev0.dist-info/RECORD` & `rayfed_nightly-0.1.0b20230510.dev0.dist-info/RECORD`

 * *Files 14% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 fed/__init__.py,sha256=6Xds1gLndBN-E4GBTuxnc7gf3Zw_D8iNejjA3JTjWnc,853
-fed/api.py,sha256=sf1JOAYRel6slaO3U4_X1WLz-siIHLTdNZI8rjFZDvk,15904
-fed/barriers.py,sha256=KnIDXzrWUx8HKGPCYO20GHy2s01u78HWPjIlN0wOpPA,16086
+fed/api.py,sha256=51vq0xwq2IVsGsEM9IVjoxpOEgTohTVQlmJEWvjJEZc,15899
+fed/barriers.py,sha256=YcbbiW7bIUOlRKMWqyDyQdrDGdjzBqqikZtZYaHyEwI,14926
 fed/cleanup.py,sha256=5P_Z6nX7GqB6WbHt1b8oVhNdUfYVRhclDdgUNt5weK0,2933
 fed/config.py,sha256=bpflURNHjH224XWM9BUgvMLzH-3BRzZJ_oX0PtdErrw,2280
 fed/fed_object.py,sha256=l2BRa9WZ3jqXSDjwFPURcAIK8XkH8A5UYA_OcY4TOD0,2877
 fed/tree_util.py,sha256=25LiGASBcreE34OsGsoeRWH4t6BuBk3QVcKjCe38jTI,7908
 fed/utils.py,sha256=gMJrnH9-EPkcWrwWyXRtnl5HOGeCl1kP2Gc0In7m5es,5254
 fed/_private/__init__.py,sha256=MDXwlZ-y7_o-tfqh8DVkjlO-6MlWqwLdbSIZUJfXtF0,581
 fed/_private/api.py,sha256=MDXwlZ-y7_o-tfqh8DVkjlO-6MlWqwLdbSIZUJfXtF0,581
@@ -14,12 +14,12 @@
 fed/_private/fed_call_holder.py,sha256=uJhmyq1nIn4nqJUg1bOqjgXrgFscZHsdpi5pXrXPF2M,3825
 fed/_private/global_context.py,sha256=dlfeqdp6C_5bGDvzHcxbR6xZGELfVyoQtDIZ4ampwZw,1017
 fed/_private/grpc_options.py,sha256=_r43xjQfg0JmD0T447wHV42EYhP0YpBubsGKG22TuN4,2859
 fed/_private/serialization_utils.py,sha256=l63nacVabcyKpys9tVT2zUMmKecimeVflsJ6v45AYvc,2386
 fed/grpc/__init__.py,sha256=MDXwlZ-y7_o-tfqh8DVkjlO-6MlWqwLdbSIZUJfXtF0,581
 fed/grpc/fed_pb2.py,sha256=CKRJyBIx8MG4XtqtARL9ETFEyIsX2ksO0IVU9JgBhWQ,5608
 fed/grpc/fed_pb2_grpc.py,sha256=PsTotUwY4gEHWV0gQnPwpoQWdNJCczNZti6bJBYFj5Q,2955
-rayfed_nightly-0.1.0b20230429.dev0.dist-info/LICENSE,sha256=QwcOLU5TJoTeUhuIXzhdCEEDDvorGiC6-3YTOl4TecE,11356
-rayfed_nightly-0.1.0b20230429.dev0.dist-info/METADATA,sha256=4Sn0SYbmA1U2UY3rglxZsBeNwqhnNagjSWzOLcjT-sA,7243
-rayfed_nightly-0.1.0b20230429.dev0.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-rayfed_nightly-0.1.0b20230429.dev0.dist-info/top_level.txt,sha256=5gd1qhbpzLAi36ONV8p_s65_-iAiOSwFljYh-ONEwts,4
-rayfed_nightly-0.1.0b20230429.dev0.dist-info/RECORD,,
+rayfed_nightly-0.1.0b20230510.dev0.dist-info/LICENSE,sha256=QwcOLU5TJoTeUhuIXzhdCEEDDvorGiC6-3YTOl4TecE,11356
+rayfed_nightly-0.1.0b20230510.dev0.dist-info/METADATA,sha256=xU28BaA_aAW1H8H8HpK_3C9HvxXWjA0odxwzhdp-EnE,7243
+rayfed_nightly-0.1.0b20230510.dev0.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+rayfed_nightly-0.1.0b20230510.dev0.dist-info/top_level.txt,sha256=5gd1qhbpzLAi36ONV8p_s65_-iAiOSwFljYh-ONEwts,4
+rayfed_nightly-0.1.0b20230510.dev0.dist-info/RECORD,,
```

